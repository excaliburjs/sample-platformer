{"version":3,"file":"main.js","mappings":"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,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,GAAM,IAAM,GACZ,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,GAAM,IAAM,GACZ,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO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","sources":["webpack://sample-platformer/./node_modules/excalibur/build/esm/excalibur.js","webpack://sample-platformer/./res/baddie.png","webpack://sample-platformer/./res/block.png","webpack://sample-platformer/./res/excalibot-red.png","webpack://sample-platformer/./res/excalibot.png","webpack://sample-platformer/./res/gottem.wav","webpack://sample-platformer/./res/hurt.wav","webpack://sample-platformer/./res/jump.wav","webpack://sample-platformer/./res/npc.png","webpack://sample-platformer/./src/baddie.ts","webpack://sample-platformer/./src/bot.ts","webpack://sample-platformer/./src/floor.ts","webpack://sample-platformer/./src/level.ts","webpack://sample-platformer/./src/main.ts","webpack://sample-platformer/./src/npc.ts","webpack://sample-platformer/./src/resources.ts","webpack://sample-platformer/webpack/bootstrap","webpack://sample-platformer/webpack/runtime/define property getters","webpack://sample-platformer/webpack/runtime/global","webpack://sample-platformer/webpack/runtime/hasOwnProperty shorthand","webpack://sample-platformer/webpack/runtime/make namespace object","webpack://sample-platformer/webpack/runtime/publicPath","webpack://sample-platformer/webpack/startup"],"sourcesContent":["/*!\n * excalibur - 0.25.2 - 2022-1-21\n * https://github.com/excaliburjs/Excalibur\n * Copyright (c) 2022 Excalibur.js <https://github.com/excaliburjs/Excalibur/graphs/contributors>\n * Licensed BSD-2-Clause\n * @preserve\n */\n/******/ var __webpack_modules__ = ({\n\n/***/ 4662:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n__webpack_require__(3430);\nvar entryUnbind = __webpack_require__(8791);\n\nmodule.exports = entryUnbind('Array', 'sort');\n\n\n/***/ }),\n\n/***/ 8343:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n__webpack_require__(4769);\nvar path = __webpack_require__(9276);\n\nmodule.exports = path.Object.keys;\n\n\n/***/ }),\n\n/***/ 7111:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar isCallable = __webpack_require__(6733);\nvar tryToString = __webpack_require__(9821);\n\nvar TypeError = global.TypeError;\n\n// `Assert: IsCallable(argument) is true`\nmodule.exports = function (argument) {\n  if (isCallable(argument)) return argument;\n  throw TypeError(tryToString(argument) + ' is not a function');\n};\n\n\n/***/ }),\n\n/***/ 1176:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar isObject = __webpack_require__(5052);\n\nvar String = global.String;\nvar TypeError = global.TypeError;\n\n// `Assert: Type(argument) is Object`\nmodule.exports = function (argument) {\n  if (isObject(argument)) return argument;\n  throw TypeError(String(argument) + ' is not an object');\n};\n\n\n/***/ }),\n\n/***/ 9540:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar toIndexedObject = __webpack_require__(905);\nvar toAbsoluteIndex = __webpack_require__(3231);\nvar lengthOfArrayLike = __webpack_require__(9646);\n\n// `Array.prototype.{ indexOf, includes }` methods implementation\nvar createMethod = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIndexedObject($this);\n    var length = lengthOfArrayLike(O);\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare -- NaN check\n    if (IS_INCLUDES && el != el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare -- NaN check\n      if (value != value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) {\n      if ((IS_INCLUDES || index in O) && O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.includes` method\n  // https://tc39.es/ecma262/#sec-array.prototype.includes\n  includes: createMethod(true),\n  // `Array.prototype.indexOf` method\n  // https://tc39.es/ecma262/#sec-array.prototype.indexof\n  indexOf: createMethod(false)\n};\n\n\n/***/ }),\n\n/***/ 6038:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar fails = __webpack_require__(4229);\n\nmodule.exports = function (METHOD_NAME, argument) {\n  var method = [][METHOD_NAME];\n  return !!method && fails(function () {\n    // eslint-disable-next-line no-useless-call,no-throw-literal -- required for testing\n    method.call(null, argument || function () { throw 1; }, 1);\n  });\n};\n\n\n/***/ }),\n\n/***/ 9794:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar toAbsoluteIndex = __webpack_require__(3231);\nvar lengthOfArrayLike = __webpack_require__(9646);\nvar createProperty = __webpack_require__(2324);\n\nvar Array = global.Array;\nvar max = Math.max;\n\nmodule.exports = function (O, start, end) {\n  var length = lengthOfArrayLike(O);\n  var k = toAbsoluteIndex(start, length);\n  var fin = toAbsoluteIndex(end === undefined ? length : end, length);\n  var result = Array(max(fin - k, 0));\n  for (var n = 0; k < fin; k++, n++) createProperty(result, n, O[k]);\n  result.length = n;\n  return result;\n};\n\n\n/***/ }),\n\n/***/ 3867:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar arraySlice = __webpack_require__(9794);\n\nvar floor = Math.floor;\n\nvar mergeSort = function (array, comparefn) {\n  var length = array.length;\n  var middle = floor(length / 2);\n  return length < 8 ? insertionSort(array, comparefn) : merge(\n    array,\n    mergeSort(arraySlice(array, 0, middle), comparefn),\n    mergeSort(arraySlice(array, middle), comparefn),\n    comparefn\n  );\n};\n\nvar insertionSort = function (array, comparefn) {\n  var length = array.length;\n  var i = 1;\n  var element, j;\n\n  while (i < length) {\n    j = i;\n    element = array[i];\n    while (j && comparefn(array[j - 1], element) > 0) {\n      array[j] = array[--j];\n    }\n    if (j !== i++) array[j] = element;\n  } return array;\n};\n\nvar merge = function (array, left, right, comparefn) {\n  var llength = left.length;\n  var rlength = right.length;\n  var lindex = 0;\n  var rindex = 0;\n\n  while (lindex < llength || rindex < rlength) {\n    array[lindex + rindex] = (lindex < llength && rindex < rlength)\n      ? comparefn(left[lindex], right[rindex]) <= 0 ? left[lindex++] : right[rindex++]\n      : lindex < llength ? left[lindex++] : right[rindex++];\n  } return array;\n};\n\nmodule.exports = mergeSort;\n\n\n/***/ }),\n\n/***/ 7079:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar uncurryThis = __webpack_require__(5968);\n\nvar toString = uncurryThis({}.toString);\nvar stringSlice = uncurryThis(''.slice);\n\nmodule.exports = function (it) {\n  return stringSlice(toString(it), 8, -1);\n};\n\n\n/***/ }),\n\n/***/ 1589:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar TO_STRING_TAG_SUPPORT = __webpack_require__(1601);\nvar isCallable = __webpack_require__(6733);\nvar classofRaw = __webpack_require__(7079);\nvar wellKnownSymbol = __webpack_require__(95);\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar Object = global.Object;\n\n// ES3 wrong here\nvar CORRECT_ARGUMENTS = classofRaw(function () { return arguments; }()) == 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (error) { /* empty */ }\n};\n\n// getting tag from ES6+ `Object.prototype.toString`\nmodule.exports = TO_STRING_TAG_SUPPORT ? classofRaw : function (it) {\n  var O, tag, result;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (tag = tryGet(O = Object(it), TO_STRING_TAG)) == 'string' ? tag\n    // builtinTag case\n    : CORRECT_ARGUMENTS ? classofRaw(O)\n    // ES3 arguments fallback\n    : (result = classofRaw(O)) == 'Object' && isCallable(O.callee) ? 'Arguments' : result;\n};\n\n\n/***/ }),\n\n/***/ 7081:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar hasOwn = __webpack_require__(8270);\nvar ownKeys = __webpack_require__(4826);\nvar getOwnPropertyDescriptorModule = __webpack_require__(7933);\nvar definePropertyModule = __webpack_require__(1787);\n\nmodule.exports = function (target, source, exceptions) {\n  var keys = ownKeys(source);\n  var defineProperty = definePropertyModule.f;\n  var getOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    if (!hasOwn(target, key) && !(exceptions && hasOwn(exceptions, key))) {\n      defineProperty(target, key, getOwnPropertyDescriptor(source, key));\n    }\n  }\n};\n\n\n/***/ }),\n\n/***/ 5762:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar DESCRIPTORS = __webpack_require__(7400);\nvar definePropertyModule = __webpack_require__(1787);\nvar createPropertyDescriptor = __webpack_require__(5358);\n\nmodule.exports = DESCRIPTORS ? function (object, key, value) {\n  return definePropertyModule.f(object, key, createPropertyDescriptor(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n\n\n/***/ }),\n\n/***/ 5358:\n/***/ ((module) => {\n\nmodule.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n\n\n/***/ }),\n\n/***/ 2324:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar toPropertyKey = __webpack_require__(9310);\nvar definePropertyModule = __webpack_require__(1787);\nvar createPropertyDescriptor = __webpack_require__(5358);\n\nmodule.exports = function (object, key, value) {\n  var propertyKey = toPropertyKey(key);\n  if (propertyKey in object) definePropertyModule.f(object, propertyKey, createPropertyDescriptor(0, value));\n  else object[propertyKey] = value;\n};\n\n\n/***/ }),\n\n/***/ 7400:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar fails = __webpack_require__(4229);\n\n// Detect IE8's incomplete defineProperty implementation\nmodule.exports = !fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- required for testing\n  return Object.defineProperty({}, 1, { get: function () { return 7; } })[1] != 7;\n});\n\n\n/***/ }),\n\n/***/ 2635:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar isObject = __webpack_require__(5052);\n\nvar document = global.document;\n// typeof document.createElement is 'object' in old IE\nvar EXISTS = isObject(document) && isObject(document.createElement);\n\nmodule.exports = function (it) {\n  return EXISTS ? document.createElement(it) : {};\n};\n\n\n/***/ }),\n\n/***/ 2671:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar userAgent = __webpack_require__(598);\n\nvar firefox = userAgent.match(/firefox\\/(\\d+)/i);\n\nmodule.exports = !!firefox && +firefox[1];\n\n\n/***/ }),\n\n/***/ 8506:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar UA = __webpack_require__(598);\n\nmodule.exports = /MSIE|Trident/.test(UA);\n\n\n/***/ }),\n\n/***/ 598:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar getBuiltIn = __webpack_require__(1333);\n\nmodule.exports = getBuiltIn('navigator', 'userAgent') || '';\n\n\n/***/ }),\n\n/***/ 6358:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar userAgent = __webpack_require__(598);\n\nvar process = global.process;\nvar Deno = global.Deno;\nvar versions = process && process.versions || Deno && Deno.version;\nvar v8 = versions && versions.v8;\nvar match, version;\n\nif (v8) {\n  match = v8.split('.');\n  // in old Chrome, versions of V8 isn't V8 = Chrome / 10\n  // but their correct versions are not interesting for us\n  version = match[0] > 0 && match[0] < 4 ? 1 : +(match[0] + match[1]);\n}\n\n// BrowserFS NodeJS `process` polyfill incorrectly set `.v8` to `0.0`\n// so check `userAgent` even if `.v8` exists, but 0\nif (!version && userAgent) {\n  match = userAgent.match(/Edge\\/(\\d+)/);\n  if (!match || match[1] >= 74) {\n    match = userAgent.match(/Chrome\\/(\\d+)/);\n    if (match) version = +match[1];\n  }\n}\n\nmodule.exports = version;\n\n\n/***/ }),\n\n/***/ 9811:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar userAgent = __webpack_require__(598);\n\nvar webkit = userAgent.match(/AppleWebKit\\/(\\d+)\\./);\n\nmodule.exports = !!webkit && +webkit[1];\n\n\n/***/ }),\n\n/***/ 8791:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar uncurryThis = __webpack_require__(5968);\n\nmodule.exports = function (CONSTRUCTOR, METHOD) {\n  return uncurryThis(global[CONSTRUCTOR].prototype[METHOD]);\n};\n\n\n/***/ }),\n\n/***/ 3837:\n/***/ ((module) => {\n\n// IE8- don't enum bug keys\nmodule.exports = [\n  'constructor',\n  'hasOwnProperty',\n  'isPrototypeOf',\n  'propertyIsEnumerable',\n  'toLocaleString',\n  'toString',\n  'valueOf'\n];\n\n\n/***/ }),\n\n/***/ 3103:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar getOwnPropertyDescriptor = (__webpack_require__(7933).f);\nvar createNonEnumerableProperty = __webpack_require__(5762);\nvar redefine = __webpack_require__(7487);\nvar setGlobal = __webpack_require__(2079);\nvar copyConstructorProperties = __webpack_require__(7081);\nvar isForced = __webpack_require__(6541);\n\n/*\n  options.target      - name of the target object\n  options.global      - target is the global object\n  options.stat        - export as static methods of target\n  options.proto       - export as prototype methods of target\n  options.real        - real prototype method for the `pure` version\n  options.forced      - export even if the native feature is available\n  options.bind        - bind methods to the target, required for the `pure` version\n  options.wrap        - wrap constructors to preventing global pollution, required for the `pure` version\n  options.unsafe      - use the simple assignment of property instead of delete + defineProperty\n  options.sham        - add a flag to not completely full polyfills\n  options.enumerable  - export as enumerable property\n  options.noTargetGet - prevent calling a getter on target\n  options.name        - the .name of the function if it does not match the key\n*/\nmodule.exports = function (options, source) {\n  var TARGET = options.target;\n  var GLOBAL = options.global;\n  var STATIC = options.stat;\n  var FORCED, target, key, targetProperty, sourceProperty, descriptor;\n  if (GLOBAL) {\n    target = global;\n  } else if (STATIC) {\n    target = global[TARGET] || setGlobal(TARGET, {});\n  } else {\n    target = (global[TARGET] || {}).prototype;\n  }\n  if (target) for (key in source) {\n    sourceProperty = source[key];\n    if (options.noTargetGet) {\n      descriptor = getOwnPropertyDescriptor(target, key);\n      targetProperty = descriptor && descriptor.value;\n    } else targetProperty = target[key];\n    FORCED = isForced(GLOBAL ? key : TARGET + (STATIC ? '.' : '#') + key, options.forced);\n    // contained in target\n    if (!FORCED && targetProperty !== undefined) {\n      if (typeof sourceProperty == typeof targetProperty) continue;\n      copyConstructorProperties(sourceProperty, targetProperty);\n    }\n    // add a flag to not completely full polyfills\n    if (options.sham || (targetProperty && targetProperty.sham)) {\n      createNonEnumerableProperty(sourceProperty, 'sham', true);\n    }\n    // extend global\n    redefine(target, key, sourceProperty, options);\n  }\n};\n\n\n/***/ }),\n\n/***/ 4229:\n/***/ ((module) => {\n\nmodule.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (error) {\n    return true;\n  }\n};\n\n\n/***/ }),\n\n/***/ 266:\n/***/ ((module) => {\n\nvar call = Function.prototype.call;\n\nmodule.exports = call.bind ? call.bind(call) : function () {\n  return call.apply(call, arguments);\n};\n\n\n/***/ }),\n\n/***/ 1805:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar DESCRIPTORS = __webpack_require__(7400);\nvar hasOwn = __webpack_require__(8270);\n\nvar FunctionPrototype = Function.prototype;\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar getDescriptor = DESCRIPTORS && Object.getOwnPropertyDescriptor;\n\nvar EXISTS = hasOwn(FunctionPrototype, 'name');\n// additional protection from minified / mangled / dropped function names\nvar PROPER = EXISTS && (function something() { /* empty */ }).name === 'something';\nvar CONFIGURABLE = EXISTS && (!DESCRIPTORS || (DESCRIPTORS && getDescriptor(FunctionPrototype, 'name').configurable));\n\nmodule.exports = {\n  EXISTS: EXISTS,\n  PROPER: PROPER,\n  CONFIGURABLE: CONFIGURABLE\n};\n\n\n/***/ }),\n\n/***/ 5968:\n/***/ ((module) => {\n\nvar FunctionPrototype = Function.prototype;\nvar bind = FunctionPrototype.bind;\nvar call = FunctionPrototype.call;\nvar uncurryThis = bind && bind.bind(call, call);\n\nmodule.exports = bind ? function (fn) {\n  return fn && uncurryThis(fn);\n} : function (fn) {\n  return fn && function () {\n    return call.apply(fn, arguments);\n  };\n};\n\n\n/***/ }),\n\n/***/ 1333:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar isCallable = __webpack_require__(6733);\n\nvar aFunction = function (argument) {\n  return isCallable(argument) ? argument : undefined;\n};\n\nmodule.exports = function (namespace, method) {\n  return arguments.length < 2 ? aFunction(global[namespace]) : global[namespace] && global[namespace][method];\n};\n\n\n/***/ }),\n\n/***/ 5300:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar aCallable = __webpack_require__(7111);\n\n// `GetMethod` abstract operation\n// https://tc39.es/ecma262/#sec-getmethod\nmodule.exports = function (V, P) {\n  var func = V[P];\n  return func == null ? undefined : aCallable(func);\n};\n\n\n/***/ }),\n\n/***/ 9859:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar check = function (it) {\n  return it && it.Math == Math && it;\n};\n\n// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nmodule.exports =\n  // eslint-disable-next-line es/no-global-this -- safe\n  check(typeof globalThis == 'object' && globalThis) ||\n  check(typeof window == 'object' && window) ||\n  // eslint-disable-next-line no-restricted-globals -- safe\n  check(typeof self == 'object' && self) ||\n  check(typeof __webpack_require__.g == 'object' && __webpack_require__.g) ||\n  // eslint-disable-next-line no-new-func -- fallback\n  (function () { return this; })() || Function('return this')();\n\n\n/***/ }),\n\n/***/ 8270:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar uncurryThis = __webpack_require__(5968);\nvar toObject = __webpack_require__(2991);\n\nvar hasOwnProperty = uncurryThis({}.hasOwnProperty);\n\n// `HasOwnProperty` abstract operation\n// https://tc39.es/ecma262/#sec-hasownproperty\nmodule.exports = Object.hasOwn || function hasOwn(it, key) {\n  return hasOwnProperty(toObject(it), key);\n};\n\n\n/***/ }),\n\n/***/ 5977:\n/***/ ((module) => {\n\nmodule.exports = {};\n\n\n/***/ }),\n\n/***/ 4394:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar DESCRIPTORS = __webpack_require__(7400);\nvar fails = __webpack_require__(4229);\nvar createElement = __webpack_require__(2635);\n\n// Thank's IE8 for his funny defineProperty\nmodule.exports = !DESCRIPTORS && !fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- required for testing\n  return Object.defineProperty(createElement('div'), 'a', {\n    get: function () { return 7; }\n  }).a != 7;\n});\n\n\n/***/ }),\n\n/***/ 9337:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar uncurryThis = __webpack_require__(5968);\nvar fails = __webpack_require__(4229);\nvar classof = __webpack_require__(7079);\n\nvar Object = global.Object;\nvar split = uncurryThis(''.split);\n\n// fallback for non-array-like ES3 and non-enumerable old V8 strings\nmodule.exports = fails(function () {\n  // throws an error in rhino, see https://github.com/mozilla/rhino/issues/346\n  // eslint-disable-next-line no-prototype-builtins -- safe\n  return !Object('z').propertyIsEnumerable(0);\n}) ? function (it) {\n  return classof(it) == 'String' ? split(it, '') : Object(it);\n} : Object;\n\n\n/***/ }),\n\n/***/ 8511:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar uncurryThis = __webpack_require__(5968);\nvar isCallable = __webpack_require__(6733);\nvar store = __webpack_require__(5353);\n\nvar functionToString = uncurryThis(Function.toString);\n\n// this helper broken in `core-js@3.4.1-3.4.4`, so we can't use `shared` helper\nif (!isCallable(store.inspectSource)) {\n  store.inspectSource = function (it) {\n    return functionToString(it);\n  };\n}\n\nmodule.exports = store.inspectSource;\n\n\n/***/ }),\n\n/***/ 6407:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar NATIVE_WEAK_MAP = __webpack_require__(8694);\nvar global = __webpack_require__(9859);\nvar uncurryThis = __webpack_require__(5968);\nvar isObject = __webpack_require__(5052);\nvar createNonEnumerableProperty = __webpack_require__(5762);\nvar hasOwn = __webpack_require__(8270);\nvar shared = __webpack_require__(5353);\nvar sharedKey = __webpack_require__(4399);\nvar hiddenKeys = __webpack_require__(5977);\n\nvar OBJECT_ALREADY_INITIALIZED = 'Object already initialized';\nvar TypeError = global.TypeError;\nvar WeakMap = global.WeakMap;\nvar set, get, has;\n\nvar enforce = function (it) {\n  return has(it) ? get(it) : set(it, {});\n};\n\nvar getterFor = function (TYPE) {\n  return function (it) {\n    var state;\n    if (!isObject(it) || (state = get(it)).type !== TYPE) {\n      throw TypeError('Incompatible receiver, ' + TYPE + ' required');\n    } return state;\n  };\n};\n\nif (NATIVE_WEAK_MAP || shared.state) {\n  var store = shared.state || (shared.state = new WeakMap());\n  var wmget = uncurryThis(store.get);\n  var wmhas = uncurryThis(store.has);\n  var wmset = uncurryThis(store.set);\n  set = function (it, metadata) {\n    if (wmhas(store, it)) throw new TypeError(OBJECT_ALREADY_INITIALIZED);\n    metadata.facade = it;\n    wmset(store, it, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return wmget(store, it) || {};\n  };\n  has = function (it) {\n    return wmhas(store, it);\n  };\n} else {\n  var STATE = sharedKey('state');\n  hiddenKeys[STATE] = true;\n  set = function (it, metadata) {\n    if (hasOwn(it, STATE)) throw new TypeError(OBJECT_ALREADY_INITIALIZED);\n    metadata.facade = it;\n    createNonEnumerableProperty(it, STATE, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return hasOwn(it, STATE) ? it[STATE] : {};\n  };\n  has = function (it) {\n    return hasOwn(it, STATE);\n  };\n}\n\nmodule.exports = {\n  set: set,\n  get: get,\n  has: has,\n  enforce: enforce,\n  getterFor: getterFor\n};\n\n\n/***/ }),\n\n/***/ 6733:\n/***/ ((module) => {\n\n// `IsCallable` abstract operation\n// https://tc39.es/ecma262/#sec-iscallable\nmodule.exports = function (argument) {\n  return typeof argument == 'function';\n};\n\n\n/***/ }),\n\n/***/ 6541:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar fails = __webpack_require__(4229);\nvar isCallable = __webpack_require__(6733);\n\nvar replacement = /#|\\.prototype\\./;\n\nvar isForced = function (feature, detection) {\n  var value = data[normalize(feature)];\n  return value == POLYFILL ? true\n    : value == NATIVE ? false\n    : isCallable(detection) ? fails(detection)\n    : !!detection;\n};\n\nvar normalize = isForced.normalize = function (string) {\n  return String(string).replace(replacement, '.').toLowerCase();\n};\n\nvar data = isForced.data = {};\nvar NATIVE = isForced.NATIVE = 'N';\nvar POLYFILL = isForced.POLYFILL = 'P';\n\nmodule.exports = isForced;\n\n\n/***/ }),\n\n/***/ 5052:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar isCallable = __webpack_require__(6733);\n\nmodule.exports = function (it) {\n  return typeof it == 'object' ? it !== null : isCallable(it);\n};\n\n\n/***/ }),\n\n/***/ 4231:\n/***/ ((module) => {\n\nmodule.exports = false;\n\n\n/***/ }),\n\n/***/ 9395:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar getBuiltIn = __webpack_require__(1333);\nvar isCallable = __webpack_require__(6733);\nvar isPrototypeOf = __webpack_require__(1321);\nvar USE_SYMBOL_AS_UID = __webpack_require__(6969);\n\nvar Object = global.Object;\n\nmodule.exports = USE_SYMBOL_AS_UID ? function (it) {\n  return typeof it == 'symbol';\n} : function (it) {\n  var $Symbol = getBuiltIn('Symbol');\n  return isCallable($Symbol) && isPrototypeOf($Symbol.prototype, Object(it));\n};\n\n\n/***/ }),\n\n/***/ 9646:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar toLength = __webpack_require__(4237);\n\n// `LengthOfArrayLike` abstract operation\n// https://tc39.es/ecma262/#sec-lengthofarraylike\nmodule.exports = function (obj) {\n  return toLength(obj.length);\n};\n\n\n/***/ }),\n\n/***/ 3839:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n/* eslint-disable es/no-symbol -- required for testing */\nvar V8_VERSION = __webpack_require__(6358);\nvar fails = __webpack_require__(4229);\n\n// eslint-disable-next-line es/no-object-getownpropertysymbols -- required for testing\nmodule.exports = !!Object.getOwnPropertySymbols && !fails(function () {\n  var symbol = Symbol();\n  // Chrome 38 Symbol has incorrect toString conversion\n  // `get-own-property-symbols` polyfill symbols converted to object are not Symbol instances\n  return !String(symbol) || !(Object(symbol) instanceof Symbol) ||\n    // Chrome 38-40 symbols are not inherited from DOM collections prototypes to instances\n    !Symbol.sham && V8_VERSION && V8_VERSION < 41;\n});\n\n\n/***/ }),\n\n/***/ 8694:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar isCallable = __webpack_require__(6733);\nvar inspectSource = __webpack_require__(8511);\n\nvar WeakMap = global.WeakMap;\n\nmodule.exports = isCallable(WeakMap) && /native code/.test(inspectSource(WeakMap));\n\n\n/***/ }),\n\n/***/ 1787:\n/***/ ((__unused_webpack_module, exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar DESCRIPTORS = __webpack_require__(7400);\nvar IE8_DOM_DEFINE = __webpack_require__(4394);\nvar V8_PROTOTYPE_DEFINE_BUG = __webpack_require__(7137);\nvar anObject = __webpack_require__(1176);\nvar toPropertyKey = __webpack_require__(9310);\n\nvar TypeError = global.TypeError;\n// eslint-disable-next-line es/no-object-defineproperty -- safe\nvar $defineProperty = Object.defineProperty;\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar $getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\nvar ENUMERABLE = 'enumerable';\nvar CONFIGURABLE = 'configurable';\nvar WRITABLE = 'writable';\n\n// `Object.defineProperty` method\n// https://tc39.es/ecma262/#sec-object.defineproperty\nexports.f = DESCRIPTORS ? V8_PROTOTYPE_DEFINE_BUG ? function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPropertyKey(P);\n  anObject(Attributes);\n  if (typeof O === 'function' && P === 'prototype' && 'value' in Attributes && WRITABLE in Attributes && !Attributes[WRITABLE]) {\n    var current = $getOwnPropertyDescriptor(O, P);\n    if (current && current[WRITABLE]) {\n      O[P] = Attributes.value;\n      Attributes = {\n        configurable: CONFIGURABLE in Attributes ? Attributes[CONFIGURABLE] : current[CONFIGURABLE],\n        enumerable: ENUMERABLE in Attributes ? Attributes[ENUMERABLE] : current[ENUMERABLE],\n        writable: false\n      };\n    }\n  } return $defineProperty(O, P, Attributes);\n} : $defineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPropertyKey(P);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return $defineProperty(O, P, Attributes);\n  } catch (error) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n\n\n/***/ }),\n\n/***/ 7933:\n/***/ ((__unused_webpack_module, exports, __webpack_require__) => {\n\nvar DESCRIPTORS = __webpack_require__(7400);\nvar call = __webpack_require__(266);\nvar propertyIsEnumerableModule = __webpack_require__(9195);\nvar createPropertyDescriptor = __webpack_require__(5358);\nvar toIndexedObject = __webpack_require__(905);\nvar toPropertyKey = __webpack_require__(9310);\nvar hasOwn = __webpack_require__(8270);\nvar IE8_DOM_DEFINE = __webpack_require__(4394);\n\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar $getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// `Object.getOwnPropertyDescriptor` method\n// https://tc39.es/ecma262/#sec-object.getownpropertydescriptor\nexports.f = DESCRIPTORS ? $getOwnPropertyDescriptor : function getOwnPropertyDescriptor(O, P) {\n  O = toIndexedObject(O);\n  P = toPropertyKey(P);\n  if (IE8_DOM_DEFINE) try {\n    return $getOwnPropertyDescriptor(O, P);\n  } catch (error) { /* empty */ }\n  if (hasOwn(O, P)) return createPropertyDescriptor(!call(propertyIsEnumerableModule.f, O, P), O[P]);\n};\n\n\n/***/ }),\n\n/***/ 8151:\n/***/ ((__unused_webpack_module, exports, __webpack_require__) => {\n\nvar internalObjectKeys = __webpack_require__(140);\nvar enumBugKeys = __webpack_require__(3837);\n\nvar hiddenKeys = enumBugKeys.concat('length', 'prototype');\n\n// `Object.getOwnPropertyNames` method\n// https://tc39.es/ecma262/#sec-object.getownpropertynames\n// eslint-disable-next-line es/no-object-getownpropertynames -- safe\nexports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {\n  return internalObjectKeys(O, hiddenKeys);\n};\n\n\n/***/ }),\n\n/***/ 894:\n/***/ ((__unused_webpack_module, exports) => {\n\n// eslint-disable-next-line es/no-object-getownpropertysymbols -- safe\nexports.f = Object.getOwnPropertySymbols;\n\n\n/***/ }),\n\n/***/ 1321:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar uncurryThis = __webpack_require__(5968);\n\nmodule.exports = uncurryThis({}.isPrototypeOf);\n\n\n/***/ }),\n\n/***/ 140:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar uncurryThis = __webpack_require__(5968);\nvar hasOwn = __webpack_require__(8270);\nvar toIndexedObject = __webpack_require__(905);\nvar indexOf = (__webpack_require__(9540).indexOf);\nvar hiddenKeys = __webpack_require__(5977);\n\nvar push = uncurryThis([].push);\n\nmodule.exports = function (object, names) {\n  var O = toIndexedObject(object);\n  var i = 0;\n  var result = [];\n  var key;\n  for (key in O) !hasOwn(hiddenKeys, key) && hasOwn(O, key) && push(result, key);\n  // Don't enum bug & hidden keys\n  while (names.length > i) if (hasOwn(O, key = names[i++])) {\n    ~indexOf(result, key) || push(result, key);\n  }\n  return result;\n};\n\n\n/***/ }),\n\n/***/ 5632:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar internalObjectKeys = __webpack_require__(140);\nvar enumBugKeys = __webpack_require__(3837);\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n// eslint-disable-next-line es/no-object-keys -- safe\nmodule.exports = Object.keys || function keys(O) {\n  return internalObjectKeys(O, enumBugKeys);\n};\n\n\n/***/ }),\n\n/***/ 9195:\n/***/ ((__unused_webpack_module, exports) => {\n\n\nvar $propertyIsEnumerable = {}.propertyIsEnumerable;\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// Nashorn ~ JDK8 bug\nvar NASHORN_BUG = getOwnPropertyDescriptor && !$propertyIsEnumerable.call({ 1: 2 }, 1);\n\n// `Object.prototype.propertyIsEnumerable` method implementation\n// https://tc39.es/ecma262/#sec-object.prototype.propertyisenumerable\nexports.f = NASHORN_BUG ? function propertyIsEnumerable(V) {\n  var descriptor = getOwnPropertyDescriptor(this, V);\n  return !!descriptor && descriptor.enumerable;\n} : $propertyIsEnumerable;\n\n\n/***/ }),\n\n/***/ 2914:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar call = __webpack_require__(266);\nvar isCallable = __webpack_require__(6733);\nvar isObject = __webpack_require__(5052);\n\nvar TypeError = global.TypeError;\n\n// `OrdinaryToPrimitive` abstract operation\n// https://tc39.es/ecma262/#sec-ordinarytoprimitive\nmodule.exports = function (input, pref) {\n  var fn, val;\n  if (pref === 'string' && isCallable(fn = input.toString) && !isObject(val = call(fn, input))) return val;\n  if (isCallable(fn = input.valueOf) && !isObject(val = call(fn, input))) return val;\n  if (pref !== 'string' && isCallable(fn = input.toString) && !isObject(val = call(fn, input))) return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n\n\n/***/ }),\n\n/***/ 4826:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar getBuiltIn = __webpack_require__(1333);\nvar uncurryThis = __webpack_require__(5968);\nvar getOwnPropertyNamesModule = __webpack_require__(8151);\nvar getOwnPropertySymbolsModule = __webpack_require__(894);\nvar anObject = __webpack_require__(1176);\n\nvar concat = uncurryThis([].concat);\n\n// all object keys, includes non-enumerable and symbols\nmodule.exports = getBuiltIn('Reflect', 'ownKeys') || function ownKeys(it) {\n  var keys = getOwnPropertyNamesModule.f(anObject(it));\n  var getOwnPropertySymbols = getOwnPropertySymbolsModule.f;\n  return getOwnPropertySymbols ? concat(keys, getOwnPropertySymbols(it)) : keys;\n};\n\n\n/***/ }),\n\n/***/ 9276:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\n\nmodule.exports = global;\n\n\n/***/ }),\n\n/***/ 7487:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar isCallable = __webpack_require__(6733);\nvar hasOwn = __webpack_require__(8270);\nvar createNonEnumerableProperty = __webpack_require__(5762);\nvar setGlobal = __webpack_require__(2079);\nvar inspectSource = __webpack_require__(8511);\nvar InternalStateModule = __webpack_require__(6407);\nvar CONFIGURABLE_FUNCTION_NAME = (__webpack_require__(1805).CONFIGURABLE);\n\nvar getInternalState = InternalStateModule.get;\nvar enforceInternalState = InternalStateModule.enforce;\nvar TEMPLATE = String(String).split('String');\n\n(module.exports = function (O, key, value, options) {\n  var unsafe = options ? !!options.unsafe : false;\n  var simple = options ? !!options.enumerable : false;\n  var noTargetGet = options ? !!options.noTargetGet : false;\n  var name = options && options.name !== undefined ? options.name : key;\n  var state;\n  if (isCallable(value)) {\n    if (String(name).slice(0, 7) === 'Symbol(') {\n      name = '[' + String(name).replace(/^Symbol\\(([^)]*)\\)/, '$1') + ']';\n    }\n    if (!hasOwn(value, 'name') || (CONFIGURABLE_FUNCTION_NAME && value.name !== name)) {\n      createNonEnumerableProperty(value, 'name', name);\n    }\n    state = enforceInternalState(value);\n    if (!state.source) {\n      state.source = TEMPLATE.join(typeof name == 'string' ? name : '');\n    }\n  }\n  if (O === global) {\n    if (simple) O[key] = value;\n    else setGlobal(key, value);\n    return;\n  } else if (!unsafe) {\n    delete O[key];\n  } else if (!noTargetGet && O[key]) {\n    simple = true;\n  }\n  if (simple) O[key] = value;\n  else createNonEnumerableProperty(O, key, value);\n// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative\n})(Function.prototype, 'toString', function toString() {\n  return isCallable(this) && getInternalState(this).source || inspectSource(this);\n});\n\n\n/***/ }),\n\n/***/ 8885:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\n\nvar TypeError = global.TypeError;\n\n// `RequireObjectCoercible` abstract operation\n// https://tc39.es/ecma262/#sec-requireobjectcoercible\nmodule.exports = function (it) {\n  if (it == undefined) throw TypeError(\"Can't call method on \" + it);\n  return it;\n};\n\n\n/***/ }),\n\n/***/ 2079:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\n\n// eslint-disable-next-line es/no-object-defineproperty -- safe\nvar defineProperty = Object.defineProperty;\n\nmodule.exports = function (key, value) {\n  try {\n    defineProperty(global, key, { value: value, configurable: true, writable: true });\n  } catch (error) {\n    global[key] = value;\n  } return value;\n};\n\n\n/***/ }),\n\n/***/ 4399:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar shared = __webpack_require__(3036);\nvar uid = __webpack_require__(1441);\n\nvar keys = shared('keys');\n\nmodule.exports = function (key) {\n  return keys[key] || (keys[key] = uid(key));\n};\n\n\n/***/ }),\n\n/***/ 5353:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar setGlobal = __webpack_require__(2079);\n\nvar SHARED = '__core-js_shared__';\nvar store = global[SHARED] || setGlobal(SHARED, {});\n\nmodule.exports = store;\n\n\n/***/ }),\n\n/***/ 3036:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar IS_PURE = __webpack_require__(4231);\nvar store = __webpack_require__(5353);\n\n(module.exports = function (key, value) {\n  return store[key] || (store[key] = value !== undefined ? value : {});\n})('versions', []).push({\n  version: '3.20.2',\n  mode: IS_PURE ? 'pure' : 'global',\n  copyright: '© 2022 Denis Pushkarev (zloirock.ru)'\n});\n\n\n/***/ }),\n\n/***/ 3231:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar toIntegerOrInfinity = __webpack_require__(3329);\n\nvar max = Math.max;\nvar min = Math.min;\n\n// Helper for a popular repeating case of the spec:\n// Let integer be ? ToInteger(index).\n// If integer < 0, let result be max((length + integer), 0); else let result be min(integer, length).\nmodule.exports = function (index, length) {\n  var integer = toIntegerOrInfinity(index);\n  return integer < 0 ? max(integer + length, 0) : min(integer, length);\n};\n\n\n/***/ }),\n\n/***/ 905:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n// toObject with fallback for non-array-like ES3 strings\nvar IndexedObject = __webpack_require__(9337);\nvar requireObjectCoercible = __webpack_require__(8885);\n\nmodule.exports = function (it) {\n  return IndexedObject(requireObjectCoercible(it));\n};\n\n\n/***/ }),\n\n/***/ 3329:\n/***/ ((module) => {\n\nvar ceil = Math.ceil;\nvar floor = Math.floor;\n\n// `ToIntegerOrInfinity` abstract operation\n// https://tc39.es/ecma262/#sec-tointegerorinfinity\nmodule.exports = function (argument) {\n  var number = +argument;\n  // eslint-disable-next-line no-self-compare -- safe\n  return number !== number || number === 0 ? 0 : (number > 0 ? floor : ceil)(number);\n};\n\n\n/***/ }),\n\n/***/ 4237:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar toIntegerOrInfinity = __webpack_require__(3329);\n\nvar min = Math.min;\n\n// `ToLength` abstract operation\n// https://tc39.es/ecma262/#sec-tolength\nmodule.exports = function (argument) {\n  return argument > 0 ? min(toIntegerOrInfinity(argument), 0x1FFFFFFFFFFFFF) : 0; // 2 ** 53 - 1 == 9007199254740991\n};\n\n\n/***/ }),\n\n/***/ 2991:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar requireObjectCoercible = __webpack_require__(8885);\n\nvar Object = global.Object;\n\n// `ToObject` abstract operation\n// https://tc39.es/ecma262/#sec-toobject\nmodule.exports = function (argument) {\n  return Object(requireObjectCoercible(argument));\n};\n\n\n/***/ }),\n\n/***/ 2066:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar call = __webpack_require__(266);\nvar isObject = __webpack_require__(5052);\nvar isSymbol = __webpack_require__(9395);\nvar getMethod = __webpack_require__(5300);\nvar ordinaryToPrimitive = __webpack_require__(2914);\nvar wellKnownSymbol = __webpack_require__(95);\n\nvar TypeError = global.TypeError;\nvar TO_PRIMITIVE = wellKnownSymbol('toPrimitive');\n\n// `ToPrimitive` abstract operation\n// https://tc39.es/ecma262/#sec-toprimitive\nmodule.exports = function (input, pref) {\n  if (!isObject(input) || isSymbol(input)) return input;\n  var exoticToPrim = getMethod(input, TO_PRIMITIVE);\n  var result;\n  if (exoticToPrim) {\n    if (pref === undefined) pref = 'default';\n    result = call(exoticToPrim, input, pref);\n    if (!isObject(result) || isSymbol(result)) return result;\n    throw TypeError(\"Can't convert object to primitive value\");\n  }\n  if (pref === undefined) pref = 'number';\n  return ordinaryToPrimitive(input, pref);\n};\n\n\n/***/ }),\n\n/***/ 9310:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar toPrimitive = __webpack_require__(2066);\nvar isSymbol = __webpack_require__(9395);\n\n// `ToPropertyKey` abstract operation\n// https://tc39.es/ecma262/#sec-topropertykey\nmodule.exports = function (argument) {\n  var key = toPrimitive(argument, 'string');\n  return isSymbol(key) ? key : key + '';\n};\n\n\n/***/ }),\n\n/***/ 1601:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar wellKnownSymbol = __webpack_require__(95);\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar test = {};\n\ntest[TO_STRING_TAG] = 'z';\n\nmodule.exports = String(test) === '[object z]';\n\n\n/***/ }),\n\n/***/ 3326:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar classof = __webpack_require__(1589);\n\nvar String = global.String;\n\nmodule.exports = function (argument) {\n  if (classof(argument) === 'Symbol') throw TypeError('Cannot convert a Symbol value to a string');\n  return String(argument);\n};\n\n\n/***/ }),\n\n/***/ 9821:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\n\nvar String = global.String;\n\nmodule.exports = function (argument) {\n  try {\n    return String(argument);\n  } catch (error) {\n    return 'Object';\n  }\n};\n\n\n/***/ }),\n\n/***/ 1441:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar uncurryThis = __webpack_require__(5968);\n\nvar id = 0;\nvar postfix = Math.random();\nvar toString = uncurryThis(1.0.toString);\n\nmodule.exports = function (key) {\n  return 'Symbol(' + (key === undefined ? '' : key) + ')_' + toString(++id + postfix, 36);\n};\n\n\n/***/ }),\n\n/***/ 6969:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n/* eslint-disable es/no-symbol -- required for testing */\nvar NATIVE_SYMBOL = __webpack_require__(3839);\n\nmodule.exports = NATIVE_SYMBOL\n  && !Symbol.sham\n  && typeof Symbol.iterator == 'symbol';\n\n\n/***/ }),\n\n/***/ 7137:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar DESCRIPTORS = __webpack_require__(7400);\nvar fails = __webpack_require__(4229);\n\n// V8 ~ Chrome 36-\n// https://bugs.chromium.org/p/v8/issues/detail?id=3334\nmodule.exports = DESCRIPTORS && fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- required for testing\n  return Object.defineProperty(function () { /* empty */ }, 'prototype', {\n    value: 42,\n    writable: false\n  }).prototype != 42;\n});\n\n\n/***/ }),\n\n/***/ 95:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar shared = __webpack_require__(3036);\nvar hasOwn = __webpack_require__(8270);\nvar uid = __webpack_require__(1441);\nvar NATIVE_SYMBOL = __webpack_require__(3839);\nvar USE_SYMBOL_AS_UID = __webpack_require__(6969);\n\nvar WellKnownSymbolsStore = shared('wks');\nvar Symbol = global.Symbol;\nvar symbolFor = Symbol && Symbol['for'];\nvar createWellKnownSymbol = USE_SYMBOL_AS_UID ? Symbol : Symbol && Symbol.withoutSetter || uid;\n\nmodule.exports = function (name) {\n  if (!hasOwn(WellKnownSymbolsStore, name) || !(NATIVE_SYMBOL || typeof WellKnownSymbolsStore[name] == 'string')) {\n    var description = 'Symbol.' + name;\n    if (NATIVE_SYMBOL && hasOwn(Symbol, name)) {\n      WellKnownSymbolsStore[name] = Symbol[name];\n    } else if (USE_SYMBOL_AS_UID && symbolFor) {\n      WellKnownSymbolsStore[name] = symbolFor(description);\n    } else {\n      WellKnownSymbolsStore[name] = createWellKnownSymbol(description);\n    }\n  } return WellKnownSymbolsStore[name];\n};\n\n\n/***/ }),\n\n/***/ 3430:\n/***/ ((__unused_webpack_module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar $ = __webpack_require__(3103);\nvar uncurryThis = __webpack_require__(5968);\nvar aCallable = __webpack_require__(7111);\nvar toObject = __webpack_require__(2991);\nvar lengthOfArrayLike = __webpack_require__(9646);\nvar toString = __webpack_require__(3326);\nvar fails = __webpack_require__(4229);\nvar internalSort = __webpack_require__(3867);\nvar arrayMethodIsStrict = __webpack_require__(6038);\nvar FF = __webpack_require__(2671);\nvar IE_OR_EDGE = __webpack_require__(8506);\nvar V8 = __webpack_require__(6358);\nvar WEBKIT = __webpack_require__(9811);\n\nvar test = [];\nvar un$Sort = uncurryThis(test.sort);\nvar push = uncurryThis(test.push);\n\n// IE8-\nvar FAILS_ON_UNDEFINED = fails(function () {\n  test.sort(undefined);\n});\n// V8 bug\nvar FAILS_ON_NULL = fails(function () {\n  test.sort(null);\n});\n// Old WebKit\nvar STRICT_METHOD = arrayMethodIsStrict('sort');\n\nvar STABLE_SORT = !fails(function () {\n  // feature detection can be too slow, so check engines versions\n  if (V8) return V8 < 70;\n  if (FF && FF > 3) return;\n  if (IE_OR_EDGE) return true;\n  if (WEBKIT) return WEBKIT < 603;\n\n  var result = '';\n  var code, chr, value, index;\n\n  // generate an array with more 512 elements (Chakra and old V8 fails only in this case)\n  for (code = 65; code < 76; code++) {\n    chr = String.fromCharCode(code);\n\n    switch (code) {\n      case 66: case 69: case 70: case 72: value = 3; break;\n      case 68: case 71: value = 4; break;\n      default: value = 2;\n    }\n\n    for (index = 0; index < 47; index++) {\n      test.push({ k: chr + index, v: value });\n    }\n  }\n\n  test.sort(function (a, b) { return b.v - a.v; });\n\n  for (index = 0; index < test.length; index++) {\n    chr = test[index].k.charAt(0);\n    if (result.charAt(result.length - 1) !== chr) result += chr;\n  }\n\n  return result !== 'DGBEFHACIJK';\n});\n\nvar FORCED = FAILS_ON_UNDEFINED || !FAILS_ON_NULL || !STRICT_METHOD || !STABLE_SORT;\n\nvar getSortCompare = function (comparefn) {\n  return function (x, y) {\n    if (y === undefined) return -1;\n    if (x === undefined) return 1;\n    if (comparefn !== undefined) return +comparefn(x, y) || 0;\n    return toString(x) > toString(y) ? 1 : -1;\n  };\n};\n\n// `Array.prototype.sort` method\n// https://tc39.es/ecma262/#sec-array.prototype.sort\n$({ target: 'Array', proto: true, forced: FORCED }, {\n  sort: function sort(comparefn) {\n    if (comparefn !== undefined) aCallable(comparefn);\n\n    var array = toObject(this);\n\n    if (STABLE_SORT) return comparefn === undefined ? un$Sort(array) : un$Sort(array, comparefn);\n\n    var items = [];\n    var arrayLength = lengthOfArrayLike(array);\n    var itemsLength, index;\n\n    for (index = 0; index < arrayLength; index++) {\n      if (index in array) push(items, array[index]);\n    }\n\n    internalSort(items, getSortCompare(comparefn));\n\n    itemsLength = items.length;\n    index = 0;\n\n    while (index < itemsLength) array[index] = items[index++];\n    while (index < arrayLength) delete array[index++];\n\n    return array;\n  }\n});\n\n\n/***/ }),\n\n/***/ 4769:\n/***/ ((__unused_webpack_module, __unused_webpack_exports, __webpack_require__) => {\n\nvar $ = __webpack_require__(3103);\nvar toObject = __webpack_require__(2991);\nvar nativeKeys = __webpack_require__(5632);\nvar fails = __webpack_require__(4229);\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeKeys(1); });\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES }, {\n  keys: function keys(it) {\n    return nativeKeys(toObject(it));\n  }\n});\n\n\n/***/ }),\n\n/***/ 1388:\n/***/ ((module, __webpack_exports__, __webpack_require__) => {\n\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"Z\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(272);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(2609);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__);\n// Imports\n\n\nvar ___CSS_LOADER_EXPORT___ = _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default()((_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default()));\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"/* Buttons styles start */\\r\\n\\r\\nbutton#excalibur-play {\\r\\n  display: inline-block;\\r\\n  position: relative;\\r\\n  z-index: 999;\\r\\n  border-radius: 6px;\\r\\n  border: none;\\r\\n  /*border: 3px solid;\\r\\n    border-color: white;\\r\\n    box-shadow: 0 0 10px #ccc;*/\\r\\n  padding: 1rem 1.5rem 1rem 4rem;\\r\\n  margin: 0;\\r\\n  text-decoration: none;\\r\\n  background: #00b233;\\r\\n  color: #ffffff;\\r\\n  font-family: sans-serif;\\r\\n  font-size: 2rem;\\r\\n  white-space: nowrap;\\r\\n  line-height: 1;\\r\\n  cursor: pointer;\\r\\n  text-align: center;\\r\\n  transition: background 250ms ease-in-out, transform 150ms ease;\\r\\n  -webkit-appearance: none;\\r\\n  -moz-appearance: none;\\r\\n\\r\\n  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\\r\\n  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\\r\\n  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\\r\\n  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\\r\\n  animation: excalibur-button-fadein 200ms;\\r\\n}\\r\\n\\r\\n/*\\r\\nbutton#excalibur-play {\\r\\n  display: none;\\r\\n}*/\\r\\n\\r\\nbutton#excalibur-play:after {\\r\\n  position: absolute;\\r\\n  content: '';\\r\\n  border: 8px solid;\\r\\n  border-color: transparent transparent transparent white;\\r\\n  left: 35px;\\r\\n  top: 24px;\\r\\n  width: 0;\\r\\n  height: 0;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:before {\\r\\n  position: absolute;\\r\\n  content: '';\\r\\n  border: 3px solid;\\r\\n  left: 19px;\\r\\n  top: 14px;\\r\\n  border-radius: 20px;\\r\\n  width: 30px;\\r\\n  height: 30px;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:hover,\\r\\nbutton#excalibur-play:focus {\\r\\n  background: #00982c;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:focus {\\r\\n  outline: 1px solid #fff;\\r\\n  outline-offset: -4px;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:active {\\r\\n  transform: scale(0.99);\\r\\n}\\r\\n\\r\\n@keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Firefox < 16 */\\r\\n@-moz-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Safari, Chrome and Opera > 12.1 */\\r\\n@-webkit-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Internet Explorer */\\r\\n@-ms-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Opera < 12.1 */\\r\\n@-o-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./Loader.css\"],\"names\":[],\"mappings\":\"AAAA,yBAAyB;;AAEzB;EACE,qBAAqB;EACrB,kBAAkB;EAClB,YAAY;EACZ,kBAAkB;EAClB,YAAY;EACZ;;+BAE6B;EAC7B,8BAA8B;EAC9B,SAAS;EACT,qBAAqB;EACrB,mBAAmB;EACnB,cAAc;EACd,uBAAuB;EACvB,eAAe;EACf,mBAAmB;EACnB,cAAc;EACd,eAAe;EACf,kBAAkB;EAClB,8DAA8D;EAC9D,wBAAwB;EACxB,qBAAqB;;EAErB,gDAAgD,EAAE,oCAAoC;EACtF,6CAA6C,EAAE,iBAAiB;EAChE,4CAA4C,EAAE,sBAAsB;EACpE,2CAA2C,EAAE,iBAAiB;EAC9D,wCAAwC;AAC1C;;AAEA;;;EAGE;;AAEF;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,uDAAuD;EACvD,UAAU;EACV,SAAS;EACT,QAAQ;EACR,SAAS;AACX;;AAEA;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,UAAU;EACV,SAAS;EACT,mBAAmB;EACnB,WAAW;EACX,YAAY;AACd;;AAEA;;EAEE,mBAAmB;AACrB;;AAEA;EACE,uBAAuB;EACvB,oBAAoB;AACtB;;AAEA;EACE,sBAAsB;AACxB;;AAEA;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,oCAAoC;AACpC;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,sBAAsB;AACtB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF\",\"sourcesContent\":[\"/* Buttons styles start */\\r\\n\\r\\nbutton#excalibur-play {\\r\\n  display: inline-block;\\r\\n  position: relative;\\r\\n  z-index: 999;\\r\\n  border-radius: 6px;\\r\\n  border: none;\\r\\n  /*border: 3px solid;\\r\\n    border-color: white;\\r\\n    box-shadow: 0 0 10px #ccc;*/\\r\\n  padding: 1rem 1.5rem 1rem 4rem;\\r\\n  margin: 0;\\r\\n  text-decoration: none;\\r\\n  background: #00b233;\\r\\n  color: #ffffff;\\r\\n  font-family: sans-serif;\\r\\n  font-size: 2rem;\\r\\n  white-space: nowrap;\\r\\n  line-height: 1;\\r\\n  cursor: pointer;\\r\\n  text-align: center;\\r\\n  transition: background 250ms ease-in-out, transform 150ms ease;\\r\\n  -webkit-appearance: none;\\r\\n  -moz-appearance: none;\\r\\n\\r\\n  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\\r\\n  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\\r\\n  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\\r\\n  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\\r\\n  animation: excalibur-button-fadein 200ms;\\r\\n}\\r\\n\\r\\n/*\\r\\nbutton#excalibur-play {\\r\\n  display: none;\\r\\n}*/\\r\\n\\r\\nbutton#excalibur-play:after {\\r\\n  position: absolute;\\r\\n  content: '';\\r\\n  border: 8px solid;\\r\\n  border-color: transparent transparent transparent white;\\r\\n  left: 35px;\\r\\n  top: 24px;\\r\\n  width: 0;\\r\\n  height: 0;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:before {\\r\\n  position: absolute;\\r\\n  content: '';\\r\\n  border: 3px solid;\\r\\n  left: 19px;\\r\\n  top: 14px;\\r\\n  border-radius: 20px;\\r\\n  width: 30px;\\r\\n  height: 30px;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:hover,\\r\\nbutton#excalibur-play:focus {\\r\\n  background: #00982c;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:focus {\\r\\n  outline: 1px solid #fff;\\r\\n  outline-offset: -4px;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:active {\\r\\n  transform: scale(0.99);\\r\\n}\\r\\n\\r\\n@keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Firefox < 16 */\\r\\n@-moz-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Safari, Chrome and Opera > 12.1 */\\r\\n@-webkit-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Internet Explorer */\\r\\n@-ms-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Opera < 12.1 */\\r\\n@-o-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (___CSS_LOADER_EXPORT___);\n\n\n/***/ }),\n\n/***/ 2609:\n/***/ ((module) => {\n\n\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\nmodule.exports = function (cssWithMappingToString) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = \"\";\n      var needLayer = typeof item[5] !== \"undefined\";\n\n      if (item[4]) {\n        content += \"@supports (\".concat(item[4], \") {\");\n      }\n\n      if (item[2]) {\n        content += \"@media \".concat(item[2], \" {\");\n      }\n\n      if (needLayer) {\n        content += \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\");\n      }\n\n      content += cssWithMappingToString(item);\n\n      if (needLayer) {\n        content += \"}\";\n      }\n\n      if (item[2]) {\n        content += \"}\";\n      }\n\n      if (item[4]) {\n        content += \"}\";\n      }\n\n      return content;\n    }).join(\"\");\n  }; // import a list of modules into the list\n\n\n  list.i = function i(modules, media, dedupe, supports, layer) {\n    if (typeof modules === \"string\") {\n      modules = [[null, modules, undefined]];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var k = 0; k < this.length; k++) {\n        var id = this[k][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _k = 0; _k < modules.length; _k++) {\n      var item = [].concat(modules[_k]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        continue;\n      }\n\n      if (typeof layer !== \"undefined\") {\n        if (typeof item[5] === \"undefined\") {\n          item[5] = layer;\n        } else {\n          item[1] = \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\").concat(item[1], \"}\");\n          item[5] = layer;\n        }\n      }\n\n      if (media) {\n        if (!item[2]) {\n          item[2] = media;\n        } else {\n          item[1] = \"@media \".concat(item[2], \" {\").concat(item[1], \"}\");\n          item[2] = media;\n        }\n      }\n\n      if (supports) {\n        if (!item[4]) {\n          item[4] = \"\".concat(supports);\n        } else {\n          item[1] = \"@supports (\".concat(item[4], \") {\").concat(item[1], \"}\");\n          item[4] = supports;\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};\n\n/***/ }),\n\n/***/ 272:\n/***/ ((module) => {\n\n\n\nmodule.exports = function (item) {\n  var content = item[1];\n  var cssMapping = item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (typeof btoa === \"function\") {\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || \"\").concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join(\"\\n\");\n  }\n\n  return [content].join(\"\\n\");\n};\n\n/***/ })\n\n/******/ });\n/************************************************************************/\n/******/ // The module cache\n/******/ var __webpack_module_cache__ = {};\n/******/ \n/******/ // The require function\n/******/ function __webpack_require__(moduleId) {\n/******/ \t// Check if module is in cache\n/******/ \tvar cachedModule = __webpack_module_cache__[moduleId];\n/******/ \tif (cachedModule !== undefined) {\n/******/ \t\treturn cachedModule.exports;\n/******/ \t}\n/******/ \t// Create a new module (and put it into the cache)\n/******/ \tvar module = __webpack_module_cache__[moduleId] = {\n/******/ \t\tid: moduleId,\n/******/ \t\t// no module.loaded needed\n/******/ \t\texports: {}\n/******/ \t};\n/******/ \n/******/ \t// Execute the module function\n/******/ \t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n/******/ \n/******/ \t// Return the exports of the module\n/******/ \treturn module.exports;\n/******/ }\n/******/ \n/************************************************************************/\n/******/ /* webpack/runtime/compat get default export */\n/******/ (() => {\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = (module) => {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\t() => (module['default']) :\n/******/ \t\t\t() => (module);\n/******/ \t\t__webpack_require__.d(getter, { a: getter });\n/******/ \t\treturn getter;\n/******/ \t};\n/******/ })();\n/******/ \n/******/ /* webpack/runtime/define property getters */\n/******/ (() => {\n/******/ \t// define getter functions for harmony exports\n/******/ \t__webpack_require__.d = (exports, definition) => {\n/******/ \t\tfor(var key in definition) {\n/******/ \t\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n/******/ \t\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n/******/ \t\t\t}\n/******/ \t\t}\n/******/ \t};\n/******/ })();\n/******/ \n/******/ /* webpack/runtime/global */\n/******/ (() => {\n/******/ \t__webpack_require__.g = (function() {\n/******/ \t\tif (typeof globalThis === 'object') return globalThis;\n/******/ \t\ttry {\n/******/ \t\t\treturn this || new Function('return this')();\n/******/ \t\t} catch (e) {\n/******/ \t\t\tif (typeof window === 'object') return window;\n/******/ \t\t}\n/******/ \t})();\n/******/ })();\n/******/ \n/******/ /* webpack/runtime/hasOwnProperty shorthand */\n/******/ (() => {\n/******/ \t__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))\n/******/ })();\n/******/ \n/******/ /* webpack/runtime/make namespace object */\n/******/ (() => {\n/******/ \t// define __esModule on exports\n/******/ \t__webpack_require__.r = (exports) => {\n/******/ \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n/******/ \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n/******/ \t\t}\n/******/ \t\tObject.defineProperty(exports, '__esModule', { value: true });\n/******/ \t};\n/******/ })();\n/******/ \n/************************************************************************/\nvar __webpack_exports__ = {};\n// This entry need to be wrapped in an IIFE because it need to be isolated against other modules in the chunk.\n(() => {\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, {\n  \"fWn\": () => (/* reexport */ ActionContext),\n  \"Ia8\": () => (/* reexport */ ActionQueue),\n  \"hLI\": () => (/* reexport */ ActionsComponent),\n  \"yyv\": () => (/* reexport */ ActionsSystem),\n  \"tX5\": () => (/* reexport */ ActivateEvent),\n  \"vtX\": () => (/* reexport */ Actor),\n  \"r7K\": () => (/* reexport */ AddedComponent),\n  \"lCh\": () => (/* reexport */ AddedEntity),\n  \"fwF\": () => (/* reexport */ Animation),\n  \"sce\": () => (/* reexport */ AnimationDirection),\n  \"_c7\": () => (/* reexport */ AnimationStrategy),\n  \"KUs\": () => (/* reexport */ ArcadeSolver),\n  \"Ajp\": () => (/* reexport */ AudioContextFactory),\n  \"RDh\": () => (/* reexport */ Axis),\n  \"_H9\": () => (/* reexport */ BaseAlign),\n  \"Ulf\": () => (/* reexport */ BinaryTreeNode),\n  \"mxs\": () => (/* reexport */ Blink),\n  \"OmD\": () => (/* reexport */ BodyComponent),\n  \"kBf\": () => (/* reexport */ BoundingBox),\n  \"C4F\": () => (/* reexport */ BroadphaseStrategy),\n  \"NQt\": () => (/* reexport */ BrowserComponent),\n  \"JjN\": () => (/* reexport */ BrowserEvents),\n  \"V1s\": () => (/* reexport */ Camera),\n  \"Xz7\": () => (/* reexport */ Canvas),\n  \"bLd\": () => (/* reexport */ Cell),\n  \"Cdc\": () => (/* reexport */ Circle),\n  \"FKn\": () => (/* reexport */ CircleCollider),\n  \"wTW\": () => (/* reexport */ Class),\n  \"SUY\": () => (/* reexport */ Clock),\n  \"ab2\": () => (/* reexport */ ClosestLine),\n  \"GfZ\": () => (/* reexport */ ClosestLineJumpTable),\n  \"YMS\": () => (/* reexport */ Collider),\n  \"oyv\": () => (/* reexport */ ColliderComponent),\n  \"aUb\": () => (/* reexport */ CollisionContact),\n  \"SdD\": () => (/* reexport */ CollisionEndEvent),\n  \"JUv\": () => (/* reexport */ CollisionGroup),\n  \"jEj\": () => (/* reexport */ CollisionGroupManager),\n  \"TFq\": () => (/* reexport */ CollisionJumpTable),\n  \"HDU\": () => (/* reexport */ CollisionPostSolveEvent),\n  \"R_y\": () => (/* reexport */ CollisionPreSolveEvent),\n  \"ydN\": () => (/* reexport */ CollisionResolutionStrategy),\n  \"_N2\": () => (/* reexport */ CollisionSolver),\n  \"t50\": () => (/* reexport */ CollisionStartEvent),\n  \"s$$\": () => (/* reexport */ CollisionSystem),\n  \"v2G\": () => (/* reexport */ CollisionType),\n  \"Ilk\": () => (/* reexport */ Color),\n  \"s9i\": () => (/* reexport */ ColorBlindFlags),\n  \"dxL\": () => (/* reexport */ ColorBlindnessMode),\n  \"LLX\": () => (/* reexport */ ColorBlindnessPostProcessor),\n  \"wA2\": () => (/* reexport */ Component),\n  \"R_p\": () => (/* reexport */ CompositeCollider),\n  \"IQ$\": () => (/* reexport */ Configurable),\n  \"I5F\": () => (/* reexport */ ConsoleAppender),\n  \"X8$\": () => (/* reexport */ ContactConstraintPoint),\n  \"FR6\": () => (/* reexport */ ContactEndEvent),\n  \"U8o\": () => (/* reexport */ ContactStartEvent),\n  \"kbG\": () => (/* reexport */ CoordPlane),\n  \"oeJ\": () => (/* reexport */ CullingBox),\n  \"iS_\": () => (/* reexport */ DeactivateEvent),\n  \"cGG\": () => (/* reexport */ Debug),\n  \"RPN\": () => (/* reexport */ DebugGraphicsComponent),\n  \"skb\": () => (/* reexport */ DebugSystem),\n  \"SLU\": () => (/* reexport */ DebugText),\n  \"RdJ\": () => (/* reexport */ DegreeOfFreedom),\n  \"gU7\": () => (/* reexport */ Detector),\n  \"LSk\": () => (/* reexport */ Die),\n  \"Nmp\": () => (/* reexport */ Direction),\n  \"d1Y\": () => (/* reexport */ DisplayMode),\n  \"xrL\": () => (/* reexport */ DynamicTree),\n  \"sRW\": () => (/* reexport */ DynamicTreeCollisionProcessor),\n  \"cmV\": () => (/* binding */ EX_VERSION),\n  \"N0Q\": () => (/* reexport */ EaseTo),\n  \"q8b\": () => (/* reexport */ EasingFunctions),\n  \"ynB\": () => (/* reexport */ EdgeCollider),\n  \"jT9\": () => (/* reexport */ ElasticToActorStrategy),\n  \"wAz\": () => (/* reexport */ EmitterType),\n  \"D4V\": () => (/* reexport */ Engine),\n  \"N6H\": () => (/* reexport */ EnterTriggerEvent),\n  \"W1A\": () => (/* reexport */ EnterViewPortEvent),\n  \"JHW\": () => (/* reexport */ Entity),\n  \"v2K\": () => (/* reexport */ EntityManager),\n  \"pBf\": () => (/* reexport */ EventDispatcher),\n  \"GMl\": () => (/* reexport */ EventTypes),\n  \"zW2\": () => (/* reexport */ Events_namespaceObject),\n  \"B0K\": () => (/* reexport */ ExResponse),\n  \"Nv7\": () => (/* reexport */ ExcaliburGraphicsContext2DCanvas),\n  \"C_p\": () => (/* reexport */ ExcaliburGraphicsContextWebGL),\n  \"iqw\": () => (/* reexport */ ExcaliburWebGLContextAccessor),\n  \"MUA\": () => (/* reexport */ ExitTriggerEvent),\n  \"xqU\": () => (/* reexport */ ExitViewPortEvent),\n  \"peG\": () => (/* reexport */ Experiments),\n  \"pTp\": () => (/* reexport */ Fade),\n  \"vUK\": () => (/* reexport */ Flags),\n  \"j9l\": () => (/* reexport */ Follow),\n  \"Zxw\": () => (/* reexport */ Font),\n  \"Hdx\": () => (/* reexport */ FontStyle),\n  \"Z$d\": () => (/* reexport */ FontUnit),\n  \"iqV\": () => (/* reexport */ FpsSampler),\n  \"o$7\": () => (/* reexport */ FrameStats),\n  \"Zm$\": () => (/* reexport */ GameEvent),\n  \"$QH\": () => (/* reexport */ GameStartEvent),\n  \"i78\": () => (/* reexport */ GameStopEvent),\n  \"h6u\": () => (/* reexport */ GamepadAxisEvent),\n  \"hts\": () => (/* reexport */ GamepadButtonEvent),\n  \"j88\": () => (/* reexport */ GamepadConnectEvent),\n  \"VME\": () => (/* reexport */ GamepadDisconnectEvent),\n  \"nt\": () => (/* reexport */ Gif),\n  \"Ukr\": () => (/* reexport */ GlobalCoordinates),\n  \"zsu\": () => (/* reexport */ Graphic),\n  \"oA6\": () => (/* reexport */ GraphicsComponent),\n  \"TVh\": () => (/* reexport */ GraphicsGroup),\n  \"TwZ\": () => (/* reexport */ GraphicsLayer),\n  \"GTT\": () => (/* reexport */ GraphicsLayers),\n  \"xxj\": () => (/* reexport */ GraphicsSystem),\n  \"XdK\": () => (/* reexport */ HiddenEvent),\n  \"Jmb\": () => (/* reexport */ ImageFiltering),\n  \"cXo\": () => (/* reexport */ ImageSource),\n  \"Dm5\": () => (/* reexport */ InitializeEvent),\n  \"IIB\": () => (/* reexport */ Input_Index_namespaceObject),\n  \"zI0\": () => (/* reexport */ Integrator),\n  \"SKZ\": () => (/* reexport */ KillEvent),\n  \"__J\": () => (/* reexport */ Label_Label),\n  \"Dvr\": () => (/* reexport */ Legacy),\n  \"Tf9\": () => (/* reexport */ Drawing_Index_namespaceObject),\n  \"RI$\": () => (/* reexport */ LimitCameraBoundsStrategy),\n  \"x12\": () => (/* reexport */ Line),\n  \"aNw\": () => (/* reexport */ Loader),\n  \"xwn\": () => (/* reexport */ LockCameraToActorAxisStrategy),\n  \"dNK\": () => (/* reexport */ LockCameraToActorStrategy),\n  \"ini\": () => (/* reexport */ LogLevel),\n  \"YdH\": () => (/* reexport */ Logger),\n  \"y3G\": () => (/* reexport */ Matrix),\n  \"l57\": () => (/* reexport */ MatrixLocations),\n  \"xn0\": () => (/* reexport */ MediaEvent),\n  \"t2V\": () => (/* reexport */ Meet),\n  \"ZyS\": () => (/* reexport */ MockedElement),\n  \"uxB\": () => (/* reexport */ MotionComponent),\n  \"cpd\": () => (/* reexport */ MotionSystem),\n  \"fiy\": () => (/* reexport */ MoveBy),\n  \"$XZ\": () => (/* reexport */ MoveTo),\n  \"uqK\": () => (/* reexport */ NativeSoundEvent),\n  \"STE\": () => (/* reexport */ NativeSoundProcessedEvent),\n  \"y$z\": () => (/* reexport */ Observable),\n  \"sOq\": () => (/* reexport */ Pair),\n  \"Sqs\": () => (/* reexport */ ParseGif),\n  \"hpZ\": () => (/* reexport */ Particle),\n  \"Vol\": () => (/* reexport */ ParticleEmitter),\n  \"wIZ\": () => (/* reexport */ Physics),\n  \"cBi\": () => (/* reexport */ PhysicsStats),\n  \"RFv\": () => (/* reexport */ PointerComponent),\n  \"kfC\": () => (/* reexport */ PointerSystem),\n  \"mgq\": () => (/* reexport */ Polygon_Polygon),\n  \"YVA\": () => (/* reexport */ PolygonCollider),\n  \"Kgp\": () => (/* reexport */ Pool),\n  \"HH$\": () => (/* reexport */ PostCollisionEvent),\n  \"M_d\": () => (/* reexport */ PostDebugDrawEvent),\n  \"rgh\": () => (/* reexport */ PostDrawEvent),\n  \"Ra6\": () => (/* reexport */ PostFrameEvent),\n  \"KhR\": () => (/* reexport */ PostKillEvent),\n  \"BS5\": () => (/* reexport */ PostUpdateEvent),\n  \"xhz\": () => (/* reexport */ PreCollisionEvent),\n  \"xOq\": () => (/* reexport */ PreDebugDrawEvent),\n  \"a9j\": () => (/* reexport */ PreDrawEvent),\n  \"bHk\": () => (/* reexport */ PreFrameEvent),\n  \"CgK\": () => (/* reexport */ PreKillEvent),\n  \"cuY\": () => (/* reexport */ PreUpdateEvent),\n  \"kvE\": () => (/* reexport */ Projection),\n  \"JDb\": () => (/* reexport */ Promises_Promise),\n  \"Cbi\": () => (/* reexport */ PromiseState),\n  \"SBu\": () => (/* reexport */ QuadIndexBuffer),\n  \"AE_\": () => (/* reexport */ Query),\n  \"ctO\": () => (/* reexport */ QueryManager),\n  \"OLH\": () => (/* reexport */ RadiusAroundActorStrategy),\n  \"kky\": () => (/* reexport */ Random),\n  \"nSF\": () => (/* reexport */ Raster),\n  \"zHn\": () => (/* reexport */ Ray),\n  \"zwx\": () => (/* reexport */ RealisticSolver),\n  \"AeJ\": () => (/* reexport */ Rectangle),\n  \"hLz\": () => (/* reexport */ RemovedComponent),\n  \"D9g\": () => (/* reexport */ RemovedEntity),\n  \"wA\": () => (/* reexport */ Repeat),\n  \"jhr\": () => (/* reexport */ RepeatForever),\n  \"GVs\": () => (/* reexport */ Resolution),\n  \"_zO\": () => (/* reexport */ Resource),\n  \"w6$\": () => (/* reexport */ RotateBy),\n  \"mhV\": () => (/* reexport */ RotateTo),\n  \"MOD\": () => (/* reexport */ RotationType),\n  \"kwd\": () => (/* reexport */ ScaleBy),\n  \"Lmr\": () => (/* reexport */ ScaleTo),\n  \"xsS\": () => (/* reexport */ Scene),\n  \"lLr\": () => (/* reexport */ Screen),\n  \"Z$r\": () => (/* reexport */ ScreenAppender),\n  \"IXb\": () => (/* reexport */ ScreenElement_ScreenElement),\n  \"SGH\": () => (/* reexport */ ScreenShader),\n  \"SMj\": () => (/* reexport */ ScrollPreventionMode),\n  \"exe\": () => (/* reexport */ Shader),\n  \"bnF\": () => (/* reexport */ Shape),\n  \"MFA\": () => (/* reexport */ Side),\n  \"$XC\": () => (/* reexport */ SortedList),\n  \"$uU\": () => (/* reexport */ Sound),\n  \"jyi\": () => (/* reexport */ Sprite),\n  \"E03\": () => (/* reexport */ SpriteFont_SpriteFont),\n  \"V6q\": () => (/* reexport */ SpriteSheet),\n  \"rg2\": () => (/* reexport */ StandardClock),\n  \"nVo\": () => (/* reexport */ StrategyContainer),\n  \"F6N\": () => (/* reexport */ Stream),\n  \"ad3\": () => (/* reexport */ SubscribeEvent),\n  \"xP7\": () => (/* reexport */ System),\n  \"Odq\": () => (/* reexport */ SystemManager),\n  \"Zif\": () => (/* reexport */ SystemType),\n  \"ZGJ\": () => (/* reexport */ TagComponent),\n  \"MJk\": () => (/* reexport */ TestClock),\n  \"xvT\": () => (/* reexport */ Text),\n  \"PHM\": () => (/* reexport */ TextAlign),\n  \"dpR\": () => (/* reexport */ TextureLoader),\n  \"KwO\": () => (/* reexport */ TileMap),\n  \"B7y\": () => (/* reexport */ Timer),\n  \"SFp\": () => (/* reexport */ Traits_Index_namespaceObject),\n  \"Uvn\": () => (/* reexport */ TransformComponent),\n  \"OFT\": () => (/* reexport */ TreeNode),\n  \"xzN\": () => (/* reexport */ Trigger_Trigger),\n  \"M5Z\": () => (/* reexport */ TwoPI),\n  \"H6j\": () => (/* reexport */ UnsubscribeEvent),\n  \"ZrN\": () => (/* reexport */ Util_Index_namespaceObject),\n  \"OWs\": () => (/* reexport */ Vector),\n  \"dF9\": () => (/* reexport */ VectorView),\n  \"oZy\": () => (/* reexport */ VertexBuffer),\n  \"rD2\": () => (/* reexport */ VertexLayout),\n  \"VHo\": () => (/* reexport */ VisibleEvent),\n  \"ohE\": () => (/* reexport */ WebAudio),\n  \"R$E\": () => (/* reexport */ WebAudioInstance),\n  \"q3I\": () => (/* reexport */ World),\n  \"Pab\": () => (/* reexport */ canonicalizeAngle),\n  \"uZ5\": () => (/* reexport */ clamp),\n  \"McK\": () => (/* reexport */ createId),\n  \"F9c\": () => (/* reexport */ frac),\n  \"k0b\": () => (/* reexport */ hasGraphicsTick),\n  \"hnT\": () => (/* reexport */ hasOnInitialize),\n  \"RSJ\": () => (/* reexport */ hasOnPostUpdate),\n  \"Mku\": () => (/* reexport */ hasOnPreUpdate),\n  \"h90\": () => (/* reexport */ hasPostDraw),\n  \"rms\": () => (/* reexport */ hasPreDraw),\n  \"ErP\": () => (/* reexport */ has_initialize),\n  \"aVg\": () => (/* reexport */ has_postupdate),\n  \"lPc\": () => (/* reexport */ has_preupdate),\n  \"Z8E\": () => (/* reexport */ isAddedComponent),\n  \"NNA\": () => (/* reexport */ isAddedSystemEntity),\n  \"yFn\": () => (/* reexport */ isRemoveSystemEntity),\n  \"lNv\": () => (/* reexport */ isRemovedComponent),\n  \"MZQ\": () => (/* reexport */ maxMessages),\n  \"FUM\": () => (/* reexport */ obsolete),\n  \"vdf\": () => (/* reexport */ randomInRange),\n  \"iaL\": () => (/* reexport */ randomIntInRange),\n  \"w6H\": () => (/* reexport */ range),\n  \"Q4c\": () => (/* reexport */ resetObsoleteCounter),\n  \"Xxe\": () => (/* reexport */ sign),\n  \"Uxb\": () => (/* reexport */ toDegrees),\n  \"Yr5\": () => (/* reexport */ toRadians),\n  \"Bhw\": () => (/* reexport */ vec),\n  \"yOA\": () => (/* reexport */ webgl_util_namespaceObject)\n});\n\n// NAMESPACE OBJECT: ./Graphics/Context/webgl-util.ts\nvar webgl_util_namespaceObject = {};\n__webpack_require__.r(webgl_util_namespaceObject);\n__webpack_require__.d(webgl_util_namespaceObject, {\n  \"ensurePowerOfTwo\": () => (ensurePowerOfTwo),\n  \"getAttributeComponentSize\": () => (getAttributeComponentSize),\n  \"getAttributePointerType\": () => (getAttributePointerType),\n  \"getGlTypeSizeBytes\": () => (getGlTypeSizeBytes),\n  \"isPowerOfTwo\": () => (isPowerOfTwo),\n  \"nextHighestPowerOfTwo\": () => (nextHighestPowerOfTwo)\n});\n\n// NAMESPACE OBJECT: ./Events.ts\nvar Events_namespaceObject = {};\n__webpack_require__.r(Events_namespaceObject);\n__webpack_require__.d(Events_namespaceObject, {\n  \"ActivateEvent\": () => (ActivateEvent),\n  \"CollisionEndEvent\": () => (CollisionEndEvent),\n  \"CollisionPostSolveEvent\": () => (CollisionPostSolveEvent),\n  \"CollisionPreSolveEvent\": () => (CollisionPreSolveEvent),\n  \"CollisionStartEvent\": () => (CollisionStartEvent),\n  \"ContactEndEvent\": () => (ContactEndEvent),\n  \"ContactStartEvent\": () => (ContactStartEvent),\n  \"DeactivateEvent\": () => (DeactivateEvent),\n  \"EnterTriggerEvent\": () => (EnterTriggerEvent),\n  \"EnterViewPortEvent\": () => (EnterViewPortEvent),\n  \"EventTypes\": () => (EventTypes),\n  \"ExitTriggerEvent\": () => (ExitTriggerEvent),\n  \"ExitViewPortEvent\": () => (ExitViewPortEvent),\n  \"GameEvent\": () => (GameEvent),\n  \"GameStartEvent\": () => (GameStartEvent),\n  \"GameStopEvent\": () => (GameStopEvent),\n  \"GamepadAxisEvent\": () => (GamepadAxisEvent),\n  \"GamepadButtonEvent\": () => (GamepadButtonEvent),\n  \"GamepadConnectEvent\": () => (GamepadConnectEvent),\n  \"GamepadDisconnectEvent\": () => (GamepadDisconnectEvent),\n  \"HiddenEvent\": () => (HiddenEvent),\n  \"InitializeEvent\": () => (InitializeEvent),\n  \"KillEvent\": () => (KillEvent),\n  \"PostCollisionEvent\": () => (PostCollisionEvent),\n  \"PostDebugDrawEvent\": () => (PostDebugDrawEvent),\n  \"PostDrawEvent\": () => (PostDrawEvent),\n  \"PostFrameEvent\": () => (PostFrameEvent),\n  \"PostKillEvent\": () => (PostKillEvent),\n  \"PostUpdateEvent\": () => (PostUpdateEvent),\n  \"PreCollisionEvent\": () => (PreCollisionEvent),\n  \"PreDebugDrawEvent\": () => (PreDebugDrawEvent),\n  \"PreDrawEvent\": () => (PreDrawEvent),\n  \"PreFrameEvent\": () => (PreFrameEvent),\n  \"PreKillEvent\": () => (PreKillEvent),\n  \"PreUpdateEvent\": () => (PreUpdateEvent),\n  \"SubscribeEvent\": () => (SubscribeEvent),\n  \"UnsubscribeEvent\": () => (UnsubscribeEvent),\n  \"VisibleEvent\": () => (VisibleEvent)\n});\n\n// NAMESPACE OBJECT: ./Drawing/SpriteEffects.ts\nvar SpriteEffects_namespaceObject = {};\n__webpack_require__.r(SpriteEffects_namespaceObject);\n__webpack_require__.d(SpriteEffects_namespaceObject, {\n  \"Colorize\": () => (Colorize),\n  \"Darken\": () => (Darken),\n  \"Desaturate\": () => (Desaturate),\n  \"Fill\": () => (Fill),\n  \"Grayscale\": () => (Grayscale),\n  \"Invert\": () => (Invert),\n  \"Lighten\": () => (Lighten),\n  \"Opacity\": () => (Opacity),\n  \"Saturate\": () => (Saturate)\n});\n\n// NAMESPACE OBJECT: ./Util/DrawUtil.ts\nvar DrawUtil_namespaceObject = {};\n__webpack_require__.r(DrawUtil_namespaceObject);\n__webpack_require__.d(DrawUtil_namespaceObject, {\n  \"circle\": () => (circle),\n  \"line\": () => (line),\n  \"point\": () => (point),\n  \"roundRect\": () => (roundRect),\n  \"vector\": () => (vector)\n});\n\n// NAMESPACE OBJECT: ./Drawing/Index.ts\nvar Drawing_Index_namespaceObject = {};\n__webpack_require__.r(Drawing_Index_namespaceObject);\n__webpack_require__.d(Drawing_Index_namespaceObject, {\n  \"Animation\": () => (Animation_Animation),\n  \"CanvasDrawComponent\": () => (CanvasDrawComponent),\n  \"CanvasDrawingSystem\": () => (CanvasDrawingSystem),\n  \"Effects\": () => (SpriteEffects_namespaceObject),\n  \"Polygon\": () => (Polygon),\n  \"Sprite\": () => (Sprite_Sprite),\n  \"SpriteFont\": () => (SpriteFont),\n  \"SpriteSheet\": () => (SpriteSheet_SpriteSheet),\n  \"Texture\": () => (Texture)\n});\n\n// NAMESPACE OBJECT: ./Input/Index.ts\nvar Input_Index_namespaceObject = {};\n__webpack_require__.r(Input_Index_namespaceObject);\n__webpack_require__.d(Input_Index_namespaceObject, {\n  \"Axes\": () => (Axes),\n  \"Buttons\": () => (Buttons),\n  \"Gamepad\": () => (Gamepad),\n  \"Gamepads\": () => (Gamepads),\n  \"KeyEvent\": () => (KeyEvent),\n  \"Keyboard\": () => (Keyboard),\n  \"Keys\": () => (Keys),\n  \"NativePointerButton\": () => (NativePointerButton),\n  \"PointerButton\": () => (PointerButton),\n  \"PointerComponent\": () => (PointerComponent),\n  \"PointerEvent\": () => (PointerEvent),\n  \"PointerEventReceiver\": () => (PointerEventReceiver),\n  \"PointerScope\": () => (PointerScope),\n  \"PointerSystem\": () => (PointerSystem),\n  \"PointerType\": () => (PointerType),\n  \"WheelDeltaMode\": () => (WheelDeltaMode),\n  \"WheelEvent\": () => (WheelEvent)\n});\n\n// NAMESPACE OBJECT: ./Traits/Index.ts\nvar Traits_Index_namespaceObject = {};\n__webpack_require__.r(Traits_Index_namespaceObject);\n__webpack_require__.d(Traits_Index_namespaceObject, {\n  \"OffscreenCulling\": () => (OffscreenCulling)\n});\n\n// NAMESPACE OBJECT: ./Util/Index.ts\nvar Util_Index_namespaceObject = {};\n__webpack_require__.r(Util_Index_namespaceObject);\n__webpack_require__.d(Util_Index_namespaceObject, {\n  \"Collection\": () => (Collection),\n  \"ConsoleAppender\": () => (ConsoleAppender),\n  \"DrawUtil\": () => (DrawUtil_namespaceObject),\n  \"EasingFunctions\": () => (EasingFunctions),\n  \"LogLevel\": () => (LogLevel),\n  \"Logger\": () => (Logger),\n  \"Observable\": () => (Observable),\n  \"ScreenAppender\": () => (ScreenAppender),\n  \"TwoPI\": () => (Util_TwoPI),\n  \"addItemToArray\": () => (addItemToArray),\n  \"canonicalizeAngle\": () => (Util_canonicalizeAngle),\n  \"clamp\": () => (Util_clamp),\n  \"contains\": () => (contains),\n  \"delay\": () => (delay),\n  \"fail\": () => (fail),\n  \"getOppositeSide\": () => (getOppositeSide),\n  \"getPosition\": () => (getPosition),\n  \"getSideFromDirection\": () => (getSideFromDirection),\n  \"randomInRange\": () => (Util_randomInRange),\n  \"randomIntInRange\": () => (Util_randomIntInRange),\n  \"range\": () => (Util_range),\n  \"removeItemFromArray\": () => (removeItemFromArray),\n  \"toDegrees\": () => (Util_toDegrees),\n  \"toRadians\": () => (Util_toRadians)\n});\n\n// EXTERNAL MODULE: ../../node_modules/core-js/es/array/sort.js\nvar sort = __webpack_require__(4662);\n// EXTERNAL MODULE: ../../node_modules/core-js/es/object/keys.js\nvar keys = __webpack_require__(8343);\n;// CONCATENATED MODULE: ./Polyfill.ts\n\r\n\r\n/**\r\n * Polyfill adding function\r\n */\r\nfunction polyfill() {\r\n    /* istanbul ignore next */\r\n    if (typeof window === 'undefined') {\r\n        window = {\r\n            audioContext: function () {\r\n                return;\r\n            }\r\n        };\r\n    }\r\n    /* istanbul ignore next */\r\n    if (typeof window !== 'undefined' && !window.requestAnimationFrame) {\r\n        window.requestAnimationFrame =\r\n            window.webkitRequestAnimationFrame ||\r\n                window.mozRequestAnimationFrame ||\r\n                function (callback) {\r\n                    window.setInterval(callback, 1000 / 60);\r\n                };\r\n    }\r\n    /* istanbul ignore next */\r\n    if (typeof window !== 'undefined' && !window.cancelAnimationFrame) {\r\n        window.cancelAnimationFrame =\r\n            window.webkitCancelAnimationFrame ||\r\n                window.mozCancelAnimationFrame ||\r\n                function () {\r\n                    return;\r\n                };\r\n    }\r\n    /* istanbul ignore next */\r\n    if (typeof window !== 'undefined' && !window.AudioContext) {\r\n        if (window.webkitAudioContext) {\r\n            const ctx = window.webkitAudioContext;\r\n            const replaceMe = ctx.prototype.decodeAudioData;\r\n            window.webkitAudioContext.prototype.decodeAudioData = function (arrayBuffer) {\r\n                return new Promise((resolve, reject) => {\r\n                    replaceMe.call(this, arrayBuffer, resolve, reject);\r\n                });\r\n            };\r\n        }\r\n        window.AudioContext =\r\n            window.AudioContext ||\r\n                window.webkitAudioContext ||\r\n                window.mozAudioContext ||\r\n                window.msAudioContext ||\r\n                window.oAudioContext;\r\n    }\r\n    /* istanbul ignore next */\r\n    if (typeof window !== 'undefined' && !window.devicePixelRatio) {\r\n        window.devicePixelRatio = window.devicePixelRatio || 1;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Flags.ts\n/**\r\n * Features in preview\r\n */\r\nvar Experiments;\r\n(function (Experiments) {\r\n    Experiments[\"WebGL\"] = \"use-webgl\";\r\n})(Experiments || (Experiments = {}));\r\n/**\r\n * Legacy features that will go away\r\n */\r\nvar Legacy;\r\n(function (Legacy) {\r\n    Legacy[\"Canvas\"] = \"use-canvas-context\";\r\n    Legacy[\"LegacyDrawing\"] = \"use-legacy-drawing\";\r\n})(Legacy || (Legacy = {}));\r\n/**\r\n * Flags is a feature flag implementation for Excalibur. They can only be operated **before [[Engine]] construction**\r\n * after which they are frozen and are read-only.\r\n *\r\n * Flags are used to enable experimental or preview features in Excalibur.\r\n */\r\nclass Flags {\r\n    /**\r\n     * Freeze all flag modifications making them readonly\r\n     */\r\n    static freeze() {\r\n        Flags._FROZEN = true;\r\n    }\r\n    /**\r\n     * Resets internal flag state, not meant to be called by users. Only used for testing.\r\n     *\r\n     * Calling this in your game is UNSUPPORTED\r\n     * @internal\r\n     */\r\n    static _reset() {\r\n        Flags._FROZEN = false;\r\n        Flags._FLAGS = {};\r\n    }\r\n    /**\r\n     * Turn on webgl support\r\n     */\r\n    static useWebGL() {\r\n        Flags.enable(Experiments.WebGL);\r\n    }\r\n    static useCanvasGraphicsContext() {\r\n        Flags.enable(Legacy.Canvas);\r\n    }\r\n    /**\r\n     * @deprecated Recommended not to use legacy drawing, going away in v0.26.0\r\n     */\r\n    static useLegacyDrawing() {\r\n        Flags.enable(Legacy.LegacyDrawing);\r\n    }\r\n    /**\r\n     * Enable a specific feature flag by name. **Note: can only be set before [[Engine]] constructor time**\r\n     * @param flagName\r\n     */\r\n    static enable(flagName) {\r\n        if (this._FROZEN) {\r\n            throw Error('Feature flags can only be enabled before Engine constructor time');\r\n        }\r\n        Flags._FLAGS[flagName] = true;\r\n    }\r\n    /**\r\n     * Disable a specific feature flag by name. **Note: can only be set before [[Engine]] constructor time**\r\n     * @param flagName\r\n     */\r\n    static disable(flagName) {\r\n        if (this._FROZEN) {\r\n            throw Error('Feature flags can only be disabled before Engine constructor time');\r\n        }\r\n        Flags._FLAGS[flagName] = false;\r\n    }\r\n    /**\r\n     * Check if a flag is enabled. If the flag is disabled or does not exist `false` is returned\r\n     * @param flagName\r\n     */\r\n    static isEnabled(flagName) {\r\n        return !!Flags._FLAGS[flagName];\r\n    }\r\n    /**\r\n     * Show a list of currently known flags\r\n     */\r\n    static show() {\r\n        return Object.keys(Flags._FLAGS);\r\n    }\r\n}\r\nFlags._FROZEN = false;\r\nFlags._FLAGS = {};\r\n\n;// CONCATENATED MODULE: ./Id.ts\n/**\r\n * Create a branded ID type from a number\r\n */\r\nfunction createId(type, value) {\r\n    return { type, value };\r\n}\r\n;\r\n\n;// CONCATENATED MODULE: ./Util/Log.ts\n/* eslint-disable no-console */\r\n/**\r\n * Logging level that Excalibur will tag\r\n */\r\nvar LogLevel;\r\n(function (LogLevel) {\r\n    LogLevel[LogLevel[\"Debug\"] = 0] = \"Debug\";\r\n    LogLevel[LogLevel[\"Info\"] = 1] = \"Info\";\r\n    LogLevel[LogLevel[\"Warn\"] = 2] = \"Warn\";\r\n    LogLevel[LogLevel[\"Error\"] = 3] = \"Error\";\r\n    LogLevel[LogLevel[\"Fatal\"] = 4] = \"Fatal\";\r\n})(LogLevel || (LogLevel = {}));\r\n/**\r\n * Static singleton that represents the logging facility for Excalibur.\r\n * Excalibur comes built-in with a [[ConsoleAppender]] and [[ScreenAppender]].\r\n * Derive from [[Appender]] to create your own logging appenders.\r\n */\r\nclass Logger {\r\n    constructor() {\r\n        this._appenders = [];\r\n        /**\r\n         * Gets or sets the default logging level. Excalibur will only log\r\n         * messages if equal to or above this level. Default: [[LogLevel.Info]]\r\n         */\r\n        this.defaultLevel = LogLevel.Info;\r\n        if (Logger._INSTANCE) {\r\n            throw new Error('Logger is a singleton');\r\n        }\r\n        Logger._INSTANCE = this;\r\n        // Default console appender\r\n        Logger._INSTANCE.addAppender(new ConsoleAppender());\r\n        return Logger._INSTANCE;\r\n    }\r\n    /**\r\n     * Gets the current static instance of Logger\r\n     */\r\n    static getInstance() {\r\n        if (Logger._INSTANCE == null) {\r\n            Logger._INSTANCE = new Logger();\r\n        }\r\n        return Logger._INSTANCE;\r\n    }\r\n    /**\r\n     * Adds a new [[Appender]] to the list of appenders to write to\r\n     */\r\n    addAppender(appender) {\r\n        this._appenders.push(appender);\r\n    }\r\n    /**\r\n     * Clears all appenders from the logger\r\n     */\r\n    clearAppenders() {\r\n        this._appenders.length = 0;\r\n    }\r\n    /**\r\n     * Logs a message at a given LogLevel\r\n     * @param level  The LogLevel`to log the message at\r\n     * @param args   An array of arguments to write to an appender\r\n     */\r\n    _log(level, args) {\r\n        if (level == null) {\r\n            level = this.defaultLevel;\r\n        }\r\n        const len = this._appenders.length;\r\n        for (let i = 0; i < len; i++) {\r\n            if (level >= this.defaultLevel) {\r\n                this._appenders[i].log(level, args);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Writes a log message at the [[LogLevel.Debug]] level\r\n     * @param args  Accepts any number of arguments\r\n     */\r\n    debug(...args) {\r\n        this._log(LogLevel.Debug, args);\r\n    }\r\n    /**\r\n     * Writes a log message at the [[LogLevel.Info]] level\r\n     * @param args  Accepts any number of arguments\r\n     */\r\n    info(...args) {\r\n        this._log(LogLevel.Info, args);\r\n    }\r\n    /**\r\n     * Writes a log message at the [[LogLevel.Warn]] level\r\n     * @param args  Accepts any number of arguments\r\n     */\r\n    warn(...args) {\r\n        this._log(LogLevel.Warn, args);\r\n    }\r\n    /**\r\n     * Writes a log message at the [[LogLevel.Error]] level\r\n     * @param args  Accepts any number of arguments\r\n     */\r\n    error(...args) {\r\n        this._log(LogLevel.Error, args);\r\n    }\r\n    /**\r\n     * Writes a log message at the [[LogLevel.Fatal]] level\r\n     * @param args  Accepts any number of arguments\r\n     */\r\n    fatal(...args) {\r\n        this._log(LogLevel.Fatal, args);\r\n    }\r\n}\r\nLogger._INSTANCE = null;\r\n/**\r\n * Console appender for browsers (i.e. `console.log`)\r\n */\r\nclass ConsoleAppender {\r\n    /**\r\n     * Logs a message at the given [[LogLevel]]\r\n     * @param level  Level to log at\r\n     * @param args   Arguments to log\r\n     */\r\n    log(level, args) {\r\n        // Check for console support\r\n        if (!console && !console.log && console.warn && console.error) {\r\n            // todo maybe do something better than nothing\r\n            return;\r\n        }\r\n        // Create a new console args array\r\n        const consoleArgs = [];\r\n        consoleArgs.unshift.apply(consoleArgs, args);\r\n        consoleArgs.unshift('[' + LogLevel[level] + '] : ');\r\n        if (level < LogLevel.Warn) {\r\n            // Call .log for Debug/Info\r\n            if (console.log.apply) {\r\n                // this is required on some older browsers that don't support apply on console.log :(\r\n                console.log.apply(console, consoleArgs);\r\n            }\r\n            else {\r\n                console.log(consoleArgs.join(' '));\r\n            }\r\n        }\r\n        else if (level < LogLevel.Error) {\r\n            // Call .warn for Warn\r\n            if (console.warn.apply) {\r\n                console.warn.apply(console, consoleArgs);\r\n            }\r\n            else {\r\n                console.warn(consoleArgs.join(' '));\r\n            }\r\n        }\r\n        else {\r\n            // Call .error for Error/Fatal\r\n            if (console.error.apply) {\r\n                console.error.apply(console, consoleArgs);\r\n            }\r\n            else {\r\n                console.error(consoleArgs.join(' '));\r\n            }\r\n        }\r\n    }\r\n}\r\n/**\r\n * On-screen (canvas) appender\r\n */\r\nclass ScreenAppender {\r\n    /**\r\n     * @param width   Width of the screen appender in pixels\r\n     * @param height  Height of the screen appender in pixels\r\n     */\r\n    constructor(width, height) {\r\n        // @todo Clean this up\r\n        this._messages = [];\r\n        this._canvas = document.createElement('canvas');\r\n        this._canvas.width = width || window.innerWidth;\r\n        this._canvas.height = height || window.innerHeight;\r\n        this._canvas.style.position = 'absolute';\r\n        // eslint-disable-next-line\r\n        this._ctx = this._canvas.getContext('2d'); // eslint-disable-line\r\n        document.body.appendChild(this._canvas);\r\n    }\r\n    /**\r\n     * Logs a message at the given [[LogLevel]]\r\n     * @param level  Level to log at\r\n     * @param args   Arguments to log\r\n     */\r\n    log(level, args) {\r\n        const message = args.join(',');\r\n        this._ctx.clearRect(0, 0, this._canvas.width, this._canvas.height);\r\n        this._messages.unshift('[' + LogLevel[level] + '] : ' + message);\r\n        let pos = 10;\r\n        let opacity = 1.0;\r\n        for (let i = 0; i < this._messages.length; i++) {\r\n            this._ctx.fillStyle = 'rgba(255,255,255,' + opacity.toFixed(2) + ')';\r\n            this._ctx.fillText(this._messages[i], 200, pos);\r\n            pos += 10;\r\n            opacity = opacity > 0 ? opacity - 0.05 : 0;\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Decorators.ts\n\r\n\r\nconst maxMessages = 5;\r\nconst obsoleteMessage = {};\r\nconst resetObsoleteCounter = () => {\r\n    for (const message in obsoleteMessage) {\r\n        obsoleteMessage[message] = 0;\r\n    }\r\n};\r\nconst logMessage = (message, options) => {\r\n    const suppressObsoleteMessages = Flags.isEnabled('suppress-obsolete-message');\r\n    if (obsoleteMessage[message] < maxMessages && !suppressObsoleteMessages) {\r\n        Logger.getInstance().warn(message);\r\n        // tslint:disable-next-line: no-console\r\n        if (console.trace && options.showStackTrace) {\r\n            // tslint:disable-next-line: no-console\r\n            console.trace();\r\n        }\r\n    }\r\n    obsoleteMessage[message]++;\r\n};\r\n/**\r\n * Obsolete decorator for marking Excalibur methods obsolete, you can optionally specify a custom message and/or alternate replacement\r\n * method do the deprecated one. Inspired by https://github.com/jayphelps/core-decorators.js\r\n */\r\nfunction obsolete(options) {\r\n    options = {\r\n        message: 'This feature will be removed in future versions of Excalibur.',\r\n        alternateMethod: null,\r\n        showStackTrace: false,\r\n        ...options\r\n    };\r\n    return function (target, property, descriptor) {\r\n        if (descriptor &&\r\n            !(typeof descriptor.value === 'function' || typeof descriptor.get === 'function' || typeof descriptor.set === 'function')) {\r\n            throw new SyntaxError('Only classes/functions/getters/setters can be marked as obsolete');\r\n        }\r\n        const methodSignature = `${target.name || ''}${target.name && property ? '.' : ''}${property ? property : ''}`;\r\n        const message = `${methodSignature} is marked obsolete: ${options.message}` +\r\n            (options.alternateMethod ? ` Use ${options.alternateMethod} instead` : '');\r\n        if (!obsoleteMessage[message]) {\r\n            obsoleteMessage[message] = 0;\r\n        }\r\n        // If descriptor is null it is a class\r\n        const method = descriptor ? { ...descriptor } : target;\r\n        if (!descriptor) {\r\n            // with es2015 classes we need to change our decoration tactic\r\n            class DecoratedClass extends method {\r\n                constructor(...args) {\r\n                    logMessage(message, options);\r\n                    super(...args);\r\n                }\r\n            }\r\n            return DecoratedClass;\r\n        }\r\n        if (descriptor && descriptor.value) {\r\n            method.value = function () {\r\n                logMessage(message, options);\r\n                return descriptor.value.apply(this, arguments);\r\n            };\r\n            return method;\r\n        }\r\n        if (descriptor && descriptor.get) {\r\n            method.get = function () {\r\n                logMessage(message, options);\r\n                return descriptor.get.apply(this, arguments);\r\n            };\r\n        }\r\n        if (descriptor && descriptor.set) {\r\n            method.set = function () {\r\n                logMessage(message, options);\r\n                return descriptor.set.apply(this, arguments);\r\n            };\r\n        }\r\n        return method;\r\n    };\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/vector.ts\nvar __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\n/**\r\n * A 2D vector on a plane.\r\n */\r\nclass Vector {\r\n    /**\r\n     * @param x  X component of the Vector\r\n     * @param y  Y component of the Vector\r\n     */\r\n    constructor(x, y) {\r\n        this._x = 0;\r\n        this._y = 0;\r\n        this._x = x;\r\n        this._y = y;\r\n    }\r\n    /**\r\n     * A (0, 0) vector\r\n     */\r\n    static get Zero() {\r\n        return new Vector(0, 0);\r\n    }\r\n    /**\r\n     * A (1, 1) vector\r\n     */\r\n    static get One() {\r\n        return new Vector(1, 1);\r\n    }\r\n    /**\r\n     * A (0.5, 0.5) vector\r\n     */\r\n    static get Half() {\r\n        return new Vector(0.5, 0.5);\r\n    }\r\n    /**\r\n     * A unit vector pointing up (0, -1)\r\n     */\r\n    static get Up() {\r\n        return new Vector(0, -1);\r\n    }\r\n    /**\r\n     * A unit vector pointing down (0, 1)\r\n     */\r\n    static get Down() {\r\n        return new Vector(0, 1);\r\n    }\r\n    /**\r\n     * A unit vector pointing left (-1, 0)\r\n     */\r\n    static get Left() {\r\n        return new Vector(-1, 0);\r\n    }\r\n    /**\r\n     * A unit vector pointing right (1, 0)\r\n     */\r\n    static get Right() {\r\n        return new Vector(1, 0);\r\n    }\r\n    /**\r\n     * Returns a vector of unit length in the direction of the specified angle in Radians.\r\n     * @param angle The angle to generate the vector\r\n     */\r\n    static fromAngle(angle) {\r\n        return new Vector(Math.cos(angle), Math.sin(angle));\r\n    }\r\n    /**\r\n     * Checks if vector is not null, undefined, or if any of its components are NaN or Infinity.\r\n     */\r\n    static isValid(vec) {\r\n        if (vec === null || vec === undefined) {\r\n            return false;\r\n        }\r\n        if (isNaN(vec.x) || isNaN(vec.y)) {\r\n            return false;\r\n        }\r\n        if (vec.x === Infinity || vec.y === Infinity || vec.x === -Infinity || vec.y === -Infinity) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    /**\r\n     * Calculates distance between two Vectors\r\n     * @param vec1\r\n     * @param vec2\r\n     */\r\n    static distance(vec1, vec2) {\r\n        return Math.sqrt(Math.pow(vec1.x - vec2.x, 2) + Math.pow(vec1.y - vec2.y, 2));\r\n    }\r\n    /**\r\n     * Get the x component of the vector\r\n     */\r\n    get x() {\r\n        return this._x;\r\n    }\r\n    /**\r\n     * Set the x component, THIS MUTATES the current vector. It is usually better to create a new vector.\r\n     * @warning **Be very careful setting components on shared vectors, mutating shared vectors can cause hard to find bugs**\r\n     */\r\n    set x(val) {\r\n        this._x = val;\r\n    }\r\n    /**\r\n     * Get the y component of the vector\r\n     */\r\n    get y() {\r\n        return this._y;\r\n    }\r\n    /**\r\n     * Set the y component, THIS MUTATES the current vector. It is usually better to create a new vector.\r\n     * @warning **Be very careful setting components on shared vectors, mutating shared vectors can cause hard to find bugs**\r\n     */\r\n    set y(val) {\r\n        this._y = val;\r\n    }\r\n    /**\r\n     * Sets the x and y components at once, THIS MUTATES the current vector. It is usually better to create a new vector.\r\n     *\r\n     * @warning **Be very careful using this, mutating vectors can cause hard to find bugs**\r\n     */\r\n    setTo(x, y) {\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n    /**\r\n     * Compares this point against another and tests for equality\r\n     * @param vector The other point to compare to\r\n     * @param tolerance Amount of euclidean distance off we are willing to tolerate\r\n     */\r\n    equals(vector, tolerance = 0.001) {\r\n        return Math.abs(this.x - vector.x) <= tolerance && Math.abs(this.y - vector.y) <= tolerance;\r\n    }\r\n    /**\r\n     * The distance to another vector. If no other Vector is specified, this will return the [[magnitude]].\r\n     * @param v  The other vector. Leave blank to use origin vector.\r\n     */\r\n    distance(v) {\r\n        if (!v) {\r\n            v = Vector.Zero;\r\n        }\r\n        return Math.sqrt(Math.pow(this.x - v.x, 2) + Math.pow(this.y - v.y, 2));\r\n    }\r\n    squareDistance(v) {\r\n        if (!v) {\r\n            v = Vector.Zero;\r\n        }\r\n        return Math.pow(this.x - v.x, 2) + Math.pow(this.y - v.y, 2);\r\n    }\r\n    /**\r\n     * The magnitude (size) of the Vector\r\n     * @deprecated magnitude will be removed in favour of '.size' in version 0.25.0\r\n     */\r\n    magnitude() {\r\n        return this.distance();\r\n    }\r\n    /**\r\n     * The size (magnitude) of the Vector\r\n     */\r\n    get size() {\r\n        return this.distance();\r\n    }\r\n    /**\r\n     * Setting the size mutates the current vector\r\n     *\r\n     * @warning Can be used to set the size of the vector, **be very careful using this, mutating vectors can cause hard to find bugs**\r\n     */\r\n    set size(newLength) {\r\n        const v = this.normalize().scale(newLength);\r\n        this.setTo(v.x, v.y);\r\n    }\r\n    /**\r\n     * Normalizes a vector to have a magnitude of 1.\r\n     */\r\n    normalize() {\r\n        const d = this.distance();\r\n        if (d > 0) {\r\n            return new Vector(this.x / d, this.y / d);\r\n        }\r\n        else {\r\n            return new Vector(0, 1);\r\n        }\r\n    }\r\n    /**\r\n     * Returns the average (midpoint) between the current point and the specified\r\n     */\r\n    average(vec) {\r\n        return this.add(vec).scale(0.5);\r\n    }\r\n    scale(sizeOrScale) {\r\n        if (sizeOrScale instanceof Vector) {\r\n            return new Vector(this.x * sizeOrScale.x, this.y * sizeOrScale.y);\r\n        }\r\n        else {\r\n            return new Vector(this.x * sizeOrScale, this.y * sizeOrScale);\r\n        }\r\n    }\r\n    /**\r\n     * Adds one vector to another\r\n     * @param v The vector to add\r\n     */\r\n    add(v) {\r\n        return new Vector(this.x + v.x, this.y + v.y);\r\n    }\r\n    /**\r\n     * Subtracts a vector from another, if you subtract vector `B.sub(A)` the resulting vector points from A -> B\r\n     * @param v The vector to subtract\r\n     */\r\n    sub(v) {\r\n        return new Vector(this.x - v.x, this.y - v.y);\r\n    }\r\n    /**\r\n     * Adds one vector to this one modifying the original\r\n     * @param v The vector to add\r\n     * @warning Be very careful using this, mutating vectors can cause hard to find bugs\r\n     */\r\n    addEqual(v) {\r\n        this.setTo(this.x + v.x, this.y + v.y);\r\n        return this;\r\n    }\r\n    /**\r\n     * Subtracts a vector from this one modifying the original\r\n     * @param v The vector to subtract\r\n     * @warning Be very careful using this, mutating vectors can cause hard to find bugs\r\n     */\r\n    subEqual(v) {\r\n        this.setTo(this.x - v.x, this.y - v.y);\r\n        return this;\r\n    }\r\n    /**\r\n     * Scales this vector by a factor of size and modifies the original\r\n     * @warning Be very careful using this, mutating vectors can cause hard to find bugs\r\n     */\r\n    scaleEqual(size) {\r\n        this.setTo(this.x * size, this.y * size);\r\n        return this;\r\n    }\r\n    /**\r\n     * Performs a dot product with another vector\r\n     * @param v  The vector to dot\r\n     */\r\n    dot(v) {\r\n        return this.x * v.x + this.y * v.y;\r\n    }\r\n    cross(v) {\r\n        if (v instanceof Vector) {\r\n            return this.x * v.y - this.y * v.x;\r\n        }\r\n        else if (typeof v === 'number') {\r\n            return new Vector(v * this.y, -v * this.x);\r\n        }\r\n    }\r\n    static cross(num, vec) {\r\n        return new Vector(-num * vec.y, num * vec.x);\r\n    }\r\n    /**\r\n     * Returns the perpendicular vector to this one\r\n     */\r\n    perpendicular() {\r\n        return new Vector(this.y, -this.x);\r\n    }\r\n    /**\r\n     * Returns the normal vector to this one, same as the perpendicular of length 1\r\n     */\r\n    normal() {\r\n        return this.perpendicular().normalize();\r\n    }\r\n    /**\r\n     * Negate the current vector\r\n     */\r\n    negate() {\r\n        return this.scale(-1);\r\n    }\r\n    /**\r\n     * Returns the angle of this vector.\r\n     */\r\n    toAngle() {\r\n        return Math.atan2(this.y, this.x);\r\n    }\r\n    /**\r\n     * Rotates the current vector around a point by a certain number of\r\n     * degrees in radians\r\n     */\r\n    rotate(angle, anchor) {\r\n        if (!anchor) {\r\n            anchor = new Vector(0, 0);\r\n        }\r\n        const sinAngle = Math.sin(angle);\r\n        const cosAngle = Math.cos(angle);\r\n        const x = cosAngle * (this.x - anchor.x) - sinAngle * (this.y - anchor.y) + anchor.x;\r\n        const y = sinAngle * (this.x - anchor.x) + cosAngle * (this.y - anchor.y) + anchor.y;\r\n        return new Vector(x, y);\r\n    }\r\n    /**\r\n     * Creates new vector that has the same values as the previous.\r\n     */\r\n    clone() {\r\n        return new Vector(this.x, this.y);\r\n    }\r\n    /**\r\n     * Returns a string representation of the vector.\r\n     */\r\n    toString(fixed) {\r\n        if (fixed) {\r\n            return `(${this.x.toFixed(fixed)}, ${this.y.toFixed(fixed)})`;\r\n        }\r\n        return `(${this.x}, ${this.y})`;\r\n    }\r\n}\r\n__decorate([\r\n    obsolete({ message: 'will be removed in favour of `.size` in version 0.25.0' })\r\n], Vector.prototype, \"magnitude\", null);\r\n/**\r\n * Shorthand for creating new Vectors - returns a new Vector instance with the\r\n * provided X and Y components.\r\n *\r\n * @param x  X component of the Vector\r\n * @param y  Y component of the Vector\r\n */\r\nfunction vec(x, y) {\r\n    return new Vector(x, y);\r\n}\r\n\n;// CONCATENATED MODULE: ./Color.ts\nvar Color_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\n/**\r\n * Provides standard colors (e.g. [[Color.Black]])\r\n * but you can also create custom colors using RGB, HSL, or Hex. Also provides\r\n * useful color operations like [[Color.lighten]], [[Color.darken]], and more.\r\n */\r\nclass Color {\r\n    /**\r\n     * Creates a new instance of Color from an r, g, b, a\r\n     *\r\n     * @param r  The red component of color (0-255)\r\n     * @param g  The green component of color (0-255)\r\n     * @param b  The blue component of color (0-255)\r\n     * @param a  The alpha component of color (0-1.0)\r\n     */\r\n    constructor(r, g, b, a) {\r\n        this.r = r;\r\n        this.g = g;\r\n        this.b = b;\r\n        this.a = a != null ? a : 1;\r\n    }\r\n    /**\r\n     * Creates a new instance of Color from an r, g, b, a\r\n     *\r\n     * @param r  The red component of color (0-255)\r\n     * @param g  The green component of color (0-255)\r\n     * @param b  The blue component of color (0-255)\r\n     * @param a  The alpha component of color (0-1.0)\r\n     */\r\n    static fromRGB(r, g, b, a) {\r\n        return new Color(r, g, b, a);\r\n    }\r\n    /**\r\n     * Creates a new instance of Color from a rgb string\r\n     *\r\n     * @param string  CSS color string of the form rgba(255, 255, 255, 1) or rgb(255, 255, 255)\r\n     */\r\n    static fromRGBString(string) {\r\n        const rgbaRegEx = /^rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)(?:,\\s*(\\d+(?:\\.\\d+)?))?\\)/i;\r\n        let match = null;\r\n        if ((match = string.match(rgbaRegEx))) {\r\n            const r = parseInt(match[1], 10);\r\n            const g = parseInt(match[2], 10);\r\n            const b = parseInt(match[3], 10);\r\n            let a = 1;\r\n            if (match[4]) {\r\n                a = parseFloat(match[4]);\r\n            }\r\n            return new Color(r, g, b, a);\r\n        }\r\n        else {\r\n            throw new Error('Invalid rgb/a string: ' + string);\r\n        }\r\n    }\r\n    /**\r\n     * Creates a new instance of Color from a hex string\r\n     *\r\n     * @param hex  CSS color string of the form #ffffff, the alpha component is optional\r\n     */\r\n    static fromHex(hex) {\r\n        const hexRegEx = /^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i;\r\n        let match = null;\r\n        if ((match = hex.match(hexRegEx))) {\r\n            const r = parseInt(match[1], 16);\r\n            const g = parseInt(match[2], 16);\r\n            const b = parseInt(match[3], 16);\r\n            let a = 1;\r\n            if (match[4]) {\r\n                a = parseInt(match[4], 16) / 255;\r\n            }\r\n            return new Color(r, g, b, a);\r\n        }\r\n        else {\r\n            throw new Error('Invalid hex string: ' + hex);\r\n        }\r\n    }\r\n    /**\r\n     * Creates a new instance of Color from hsla values\r\n     *\r\n     * @param h  Hue is represented [0-1]\r\n     * @param s  Saturation is represented [0-1]\r\n     * @param l  Luminance is represented [0-1]\r\n     * @param a  Alpha is represented [0-1]\r\n     */\r\n    static fromHSL(h, s, l, a = 1.0) {\r\n        const temp = new HSLColor(h, s, l, a);\r\n        return temp.toRGBA();\r\n    }\r\n    /**\r\n     * Lightens the current color by a specified amount\r\n     *\r\n     * @param factor  The amount to lighten by [0-1]\r\n     */\r\n    lighten(factor = 0.1) {\r\n        const temp = HSLColor.fromRGBA(this.r, this.g, this.b, this.a);\r\n        temp.l += (1 - temp.l) * factor;\r\n        return temp.toRGBA();\r\n    }\r\n    /**\r\n     * Darkens the current color by a specified amount\r\n     *\r\n     * @param factor  The amount to darken by [0-1]\r\n     */\r\n    darken(factor = 0.1) {\r\n        const temp = HSLColor.fromRGBA(this.r, this.g, this.b, this.a);\r\n        temp.l -= temp.l * factor;\r\n        return temp.toRGBA();\r\n    }\r\n    /**\r\n     * Saturates the current color by a specified amount\r\n     *\r\n     * @param factor  The amount to saturate by [0-1]\r\n     */\r\n    saturate(factor = 0.1) {\r\n        const temp = HSLColor.fromRGBA(this.r, this.g, this.b, this.a);\r\n        temp.s += temp.s * factor;\r\n        return temp.toRGBA();\r\n    }\r\n    /**\r\n     * Desaturates the current color by a specified amount\r\n     *\r\n     * @param factor  The amount to desaturate by [0-1]\r\n     */\r\n    desaturate(factor = 0.1) {\r\n        const temp = HSLColor.fromRGBA(this.r, this.g, this.b, this.a);\r\n        temp.s -= temp.s * factor;\r\n        return temp.toRGBA();\r\n    }\r\n    /**\r\n     * Multiplies a color by another, results in a darker color\r\n     *\r\n     * @param color  The other color\r\n     */\r\n    multiply(color) {\r\n        const newR = (((color.r / 255) * this.r) / 255) * 255;\r\n        const newG = (((color.g / 255) * this.g) / 255) * 255;\r\n        const newB = (((color.b / 255) * this.b) / 255) * 255;\r\n        const newA = color.a * this.a;\r\n        return new Color(newR, newG, newB, newA);\r\n    }\r\n    /**\r\n     * Multiplies a color by another, results in a darker color\r\n     * @param color\r\n     * @deprecated Alias for incorrect spelling used in older versions, use multiply instead, will be removed in v0.25.0\r\n     */\r\n    mulitiply(color) {\r\n        return this.multiply(color);\r\n    }\r\n    /**\r\n     * Screens a color by another, results in a lighter color\r\n     *\r\n     * @param color  The other color\r\n     */\r\n    screen(color) {\r\n        const color1 = color.invert();\r\n        const color2 = color.invert();\r\n        return color1.multiply(color2).invert();\r\n    }\r\n    /**\r\n     * Inverts the current color\r\n     */\r\n    invert() {\r\n        return new Color(255 - this.r, 255 - this.g, 255 - this.b, 1.0 - this.a);\r\n    }\r\n    /**\r\n     * Averages the current color with another\r\n     *\r\n     * @param color  The other color\r\n     */\r\n    average(color) {\r\n        const newR = (color.r + this.r) / 2;\r\n        const newG = (color.g + this.g) / 2;\r\n        const newB = (color.b + this.b) / 2;\r\n        const newA = (color.a + this.a) / 2;\r\n        return new Color(newR, newG, newB, newA);\r\n    }\r\n    equal(color) {\r\n        return this.toString() === color.toString();\r\n    }\r\n    /**\r\n     * Returns a CSS string representation of a color.\r\n     *\r\n     * @param format Color representation, accepts: rgb, hsl, or hex\r\n     */\r\n    toString(format = 'rgb') {\r\n        switch (format) {\r\n            case 'rgb':\r\n                return this.toRGBA();\r\n            case 'hsl':\r\n                return this.toHSLA();\r\n            case 'hex':\r\n                return this.toHex();\r\n            default:\r\n                throw new Error('Invalid Color format');\r\n        }\r\n    }\r\n    /**\r\n     * Returns Hex Value of a color component\r\n     * @param c color component\r\n     * @see https://stackoverflow.com/questions/5623838/rgb-to-hex-and-hex-to-rgb\r\n     */\r\n    _componentToHex(c) {\r\n        const hex = c.toString(16);\r\n        return hex.length === 1 ? '0' + hex : hex;\r\n    }\r\n    /**\r\n     * Return Hex representation of a color.\r\n     */\r\n    toHex() {\r\n        return '#' + this._componentToHex(this.r) + this._componentToHex(this.g) + this._componentToHex(this.b);\r\n    }\r\n    /**\r\n     * Return RGBA representation of a color.\r\n     */\r\n    toRGBA() {\r\n        const result = String(this.r.toFixed(0)) + ', ' + String(this.g.toFixed(0)) + ', ' + String(this.b.toFixed(0));\r\n        if (this.a !== undefined || this.a !== null) {\r\n            return 'rgba(' + result + ', ' + String(this.a) + ')';\r\n        }\r\n        return 'rgb(' + result + ')';\r\n    }\r\n    /**\r\n     * Return HSLA representation of a color.\r\n     */\r\n    toHSLA() {\r\n        return HSLColor.fromRGBA(this.r, this.g, this.b, this.a).toString();\r\n    }\r\n    /**\r\n     * Returns a CSS string representation of a color.\r\n     */\r\n    fillStyle() {\r\n        return this.toString();\r\n    }\r\n    /**\r\n     * Returns a clone of the current color.\r\n     */\r\n    clone() {\r\n        return new Color(this.r, this.g, this.b, this.a);\r\n    }\r\n    /**\r\n     * Black (#000000)\r\n     */\r\n    static get Black() {\r\n        return Color.fromHex('#000000');\r\n    }\r\n    /**\r\n     * White (#FFFFFF)\r\n     */\r\n    static get White() {\r\n        return Color.fromHex('#FFFFFF');\r\n    }\r\n    /**\r\n     * Gray (#808080)\r\n     */\r\n    static get Gray() {\r\n        return Color.fromHex('#808080');\r\n    }\r\n    /**\r\n     * Light gray (#D3D3D3)\r\n     */\r\n    static get LightGray() {\r\n        return Color.fromHex('#D3D3D3');\r\n    }\r\n    /**\r\n     * Dark gray (#A9A9A9)\r\n     */\r\n    static get DarkGray() {\r\n        return Color.fromHex('#A9A9A9');\r\n    }\r\n    /**\r\n     * Yellow (#FFFF00)\r\n     */\r\n    static get Yellow() {\r\n        return Color.fromHex('#FFFF00');\r\n    }\r\n    /**\r\n     * Orange (#FFA500)\r\n     */\r\n    static get Orange() {\r\n        return Color.fromHex('#FFA500');\r\n    }\r\n    /**\r\n     * Red (#FF0000)\r\n     */\r\n    static get Red() {\r\n        return Color.fromHex('#FF0000');\r\n    }\r\n    /**\r\n     * Vermilion (#FF5B31)\r\n     */\r\n    static get Vermilion() {\r\n        return Color.fromHex('#FF5B31');\r\n    }\r\n    /**\r\n     * Vermilion (#FF5B31)\r\n     * @deprecated Alias for incorrect spelling used in older versions, use multiply instead, will be removed in v0.25.0\r\n     */\r\n    static get Vermillion() {\r\n        return Color.Vermilion;\r\n    }\r\n    /**\r\n     * Rose (#FF007F)\r\n     */\r\n    static get Rose() {\r\n        return Color.fromHex('#FF007F');\r\n    }\r\n    /**\r\n     * Magenta (#FF00FF)\r\n     */\r\n    static get Magenta() {\r\n        return Color.fromHex('#FF00FF');\r\n    }\r\n    /**\r\n     * Violet (#7F00FF)\r\n     */\r\n    static get Violet() {\r\n        return Color.fromHex('#7F00FF');\r\n    }\r\n    /**\r\n     * Blue (#0000FF)\r\n     */\r\n    static get Blue() {\r\n        return Color.fromHex('#0000FF');\r\n    }\r\n    /**\r\n     * Azure (#007FFF)\r\n     */\r\n    static get Azure() {\r\n        return Color.fromHex('#007FFF');\r\n    }\r\n    /**\r\n     * Cyan (#00FFFF)\r\n     */\r\n    static get Cyan() {\r\n        return Color.fromHex('#00FFFF');\r\n    }\r\n    /**\r\n     * Viridian (#59978F)\r\n     */\r\n    static get Viridian() {\r\n        return Color.fromHex('#59978F');\r\n    }\r\n    /**\r\n     * Green (#00FF00)\r\n     */\r\n    static get Green() {\r\n        return Color.fromHex('#00FF00');\r\n    }\r\n    /**\r\n     * Chartreuse (#7FFF00)\r\n     */\r\n    static get Chartreuse() {\r\n        return Color.fromHex('#7FFF00');\r\n    }\r\n    /**\r\n     * Transparent (#FFFFFF00)\r\n     */\r\n    static get Transparent() {\r\n        return Color.fromHex('#FFFFFF00');\r\n    }\r\n    /**\r\n     * ExcaliburBlue (#176BAA)\r\n     */\r\n    static get ExcaliburBlue() {\r\n        return Color.fromHex('#176BAA');\r\n    }\r\n}\r\nColor_decorate([\r\n    obsolete({ message: 'Alias for incorrect spelling used in older versions, use multiply instead, will be removed in v0.25.0' })\r\n], Color.prototype, \"mulitiply\", null);\r\nColor_decorate([\r\n    obsolete({\r\n        message: 'Alias for incorrect spelling used in older versions',\r\n        alternateMethod: 'Vermilion'\r\n    })\r\n], Color, \"Vermillion\", null);\r\n/**\r\n * Internal HSL Color representation\r\n *\r\n * http://en.wikipedia.org/wiki/HSL_and_HSV\r\n * http://axonflux.com/handy-rgb-to-hsl-and-rgb-to-hsv-color-model-c\r\n */\r\nclass HSLColor {\r\n    constructor(h, s, l, a) {\r\n        this.h = h;\r\n        this.s = s;\r\n        this.l = l;\r\n        this.a = a;\r\n    }\r\n    static hue2rgb(p, q, t) {\r\n        if (t < 0) {\r\n            t += 1;\r\n        }\r\n        if (t > 1) {\r\n            t -= 1;\r\n        }\r\n        if (t < 1 / 6) {\r\n            return p + (q - p) * 6 * t;\r\n        }\r\n        if (t < 1 / 2) {\r\n            return q;\r\n        }\r\n        if (t < 2 / 3) {\r\n            return p + (q - p) * (2 / 3 - t) * 6;\r\n        }\r\n        return p;\r\n    }\r\n    static fromRGBA(r, g, b, a) {\r\n        r /= 255;\r\n        g /= 255;\r\n        b /= 255;\r\n        const max = Math.max(r, g, b), min = Math.min(r, g, b);\r\n        let h, s;\r\n        const l = (max + min) / 2;\r\n        if (max === min) {\r\n            h = s = 0; // achromatic\r\n        }\r\n        else {\r\n            const d = max - min;\r\n            s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\r\n            switch (max) {\r\n                case r:\r\n                    h = (g - b) / d + (g < b ? 6 : 0);\r\n                    break;\r\n                case g:\r\n                    h = (b - r) / d + 2;\r\n                    break;\r\n                case b:\r\n                    h = (r - g) / d + 4;\r\n                    break;\r\n            }\r\n            h /= 6;\r\n        }\r\n        return new HSLColor(h, s, l, a);\r\n    }\r\n    toRGBA() {\r\n        let r, g, b;\r\n        if (this.s === 0) {\r\n            r = g = b = this.l; // achromatic\r\n        }\r\n        else {\r\n            const q = this.l < 0.5 ? this.l * (1 + this.s) : this.l + this.s - this.l * this.s;\r\n            const p = 2 * this.l - q;\r\n            r = HSLColor.hue2rgb(p, q, this.h + 1 / 3);\r\n            g = HSLColor.hue2rgb(p, q, this.h);\r\n            b = HSLColor.hue2rgb(p, q, this.h - 1 / 3);\r\n        }\r\n        return new Color(r * 255, g * 255, b * 255, this.a);\r\n    }\r\n    toString() {\r\n        const h = this.h.toFixed(0), s = this.s.toFixed(0), l = this.l.toFixed(0), a = this.a.toFixed(0);\r\n        return `hsla(${h}, ${s}, ${l}, ${a})`;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Side.ts\n\r\n/**\r\n * An enum that describes the sides of an axis aligned box for collision\r\n */\r\nvar Side;\r\n(function (Side) {\r\n    Side[\"None\"] = \"None\";\r\n    Side[\"Top\"] = \"Top\";\r\n    Side[\"Bottom\"] = \"Bottom\";\r\n    Side[\"Left\"] = \"Left\";\r\n    Side[\"Right\"] = \"Right\";\r\n})(Side || (Side = {}));\r\n(function (Side) {\r\n    /**\r\n     * Returns the opposite side from the current\r\n     */\r\n    function getOpposite(side) {\r\n        if (side === Side.Top) {\r\n            return Side.Bottom;\r\n        }\r\n        if (side === Side.Bottom) {\r\n            return Side.Top;\r\n        }\r\n        if (side === Side.Left) {\r\n            return Side.Right;\r\n        }\r\n        if (side === Side.Right) {\r\n            return Side.Left;\r\n        }\r\n        return Side.None;\r\n    }\r\n    Side.getOpposite = getOpposite;\r\n    /**\r\n     * Given a vector, return the Side most in that direction (via dot product)\r\n     */\r\n    function fromDirection(direction) {\r\n        const directions = [Vector.Left, Vector.Right, Vector.Up, Vector.Down];\r\n        const directionEnum = [Side.Left, Side.Right, Side.Top, Side.Bottom];\r\n        let max = -Number.MAX_VALUE;\r\n        let maxIndex = -1;\r\n        for (let i = 0; i < directions.length; i++) {\r\n            if (directions[i].dot(direction) > max) {\r\n                max = directions[i].dot(direction);\r\n                maxIndex = i;\r\n            }\r\n        }\r\n        return directionEnum[maxIndex];\r\n    }\r\n    Side.fromDirection = fromDirection;\r\n})(Side || (Side = {}));\r\n\n;// CONCATENATED MODULE: ./Collision/BoundingBox.ts\n\r\n\r\n\r\n/**\r\n * Axis Aligned collision primitive for Excalibur.\r\n */\r\nclass BoundingBox {\r\n    /**\r\n     * Constructor allows passing of either an object with all coordinate components,\r\n     * or the coordinate components passed separately.\r\n     * @param leftOrOptions    Either x coordinate of the left edge or an options object\r\n     * containing the four coordinate components.\r\n     * @param top     y coordinate of the top edge\r\n     * @param right   x coordinate of the right edge\r\n     * @param bottom  y coordinate of the bottom edge\r\n     */\r\n    constructor(leftOrOptions = 0, top = 0, right = 0, bottom = 0) {\r\n        if (typeof leftOrOptions === 'object') {\r\n            this.left = leftOrOptions.left;\r\n            this.top = leftOrOptions.top;\r\n            this.right = leftOrOptions.right;\r\n            this.bottom = leftOrOptions.bottom;\r\n        }\r\n        else if (typeof leftOrOptions === 'number') {\r\n            this.left = leftOrOptions;\r\n            this.top = top;\r\n            this.right = right;\r\n            this.bottom = bottom;\r\n        }\r\n    }\r\n    /**\r\n     * Given bounding box A & B, returns the side relative to A when intersection is performed.\r\n     * @param intersection Intersection vector between 2 bounding boxes\r\n     */\r\n    static getSideFromIntersection(intersection) {\r\n        if (!intersection) {\r\n            return Side.None;\r\n        }\r\n        if (intersection) {\r\n            if (Math.abs(intersection.x) > Math.abs(intersection.y)) {\r\n                if (intersection.x < 0) {\r\n                    return Side.Right;\r\n                }\r\n                return Side.Left;\r\n            }\r\n            else {\r\n                if (intersection.y < 0) {\r\n                    return Side.Bottom;\r\n                }\r\n                return Side.Top;\r\n            }\r\n        }\r\n        return Side.None;\r\n    }\r\n    static fromPoints(points) {\r\n        let minX = Infinity;\r\n        let minY = Infinity;\r\n        let maxX = -Infinity;\r\n        let maxY = -Infinity;\r\n        for (let i = 0; i < points.length; i++) {\r\n            if (points[i].x < minX) {\r\n                minX = points[i].x;\r\n            }\r\n            if (points[i].x > maxX) {\r\n                maxX = points[i].x;\r\n            }\r\n            if (points[i].y < minY) {\r\n                minY = points[i].y;\r\n            }\r\n            if (points[i].y > maxY) {\r\n                maxY = points[i].y;\r\n            }\r\n        }\r\n        return new BoundingBox(minX, minY, maxX, maxY);\r\n    }\r\n    static fromDimension(width, height, anchor = Vector.Half, pos = Vector.Zero) {\r\n        return new BoundingBox(-width * anchor.x + pos.x, -height * anchor.y + pos.y, width - width * anchor.x + pos.x, height - height * anchor.y + pos.y);\r\n    }\r\n    /**\r\n     * Returns the calculated width of the bounding box\r\n     */\r\n    get width() {\r\n        return this.right - this.left;\r\n    }\r\n    /**\r\n     * Returns the calculated height of the bounding box\r\n     */\r\n    get height() {\r\n        return this.bottom - this.top;\r\n    }\r\n    /**\r\n     * Return whether the bounding box has zero dimensions in height,width or both\r\n     */\r\n    hasZeroDimensions() {\r\n        return this.width === 0 || this.height === 0;\r\n    }\r\n    /**\r\n     * Returns the center of the bounding box\r\n     */\r\n    get center() {\r\n        return new Vector((this.left + this.right) / 2, (this.top + this.bottom) / 2);\r\n    }\r\n    translate(pos) {\r\n        return new BoundingBox(this.left + pos.x, this.top + pos.y, this.right + pos.x, this.bottom + pos.y);\r\n    }\r\n    /**\r\n     * Rotates a bounding box by and angle and around a point, if no point is specified (0, 0) is used by default. The resulting bounding\r\n     * box is also axis-align. This is useful when a new axis-aligned bounding box is needed for rotated geometry.\r\n     */\r\n    rotate(angle, point = Vector.Zero) {\r\n        const points = this.getPoints().map((p) => p.rotate(angle, point));\r\n        return BoundingBox.fromPoints(points);\r\n    }\r\n    scale(scale, point = Vector.Zero) {\r\n        const shifted = this.translate(point);\r\n        return new BoundingBox(shifted.left * scale.x, shifted.top * scale.y, shifted.right * scale.x, shifted.bottom * scale.y);\r\n    }\r\n    transform(matrix) {\r\n        const points = this.getPoints().map((p) => matrix.multv(p));\r\n        return BoundingBox.fromPoints(points);\r\n    }\r\n    /**\r\n     * Returns the perimeter of the bounding box\r\n     */\r\n    getPerimeter() {\r\n        const wx = this.width;\r\n        const wy = this.height;\r\n        return 2 * (wx + wy);\r\n    }\r\n    getPoints() {\r\n        const results = [];\r\n        results.push(new Vector(this.left, this.top));\r\n        results.push(new Vector(this.right, this.top));\r\n        results.push(new Vector(this.right, this.bottom));\r\n        results.push(new Vector(this.left, this.bottom));\r\n        return results;\r\n    }\r\n    /**\r\n     * Determines whether a ray intersects with a bounding box\r\n     */\r\n    rayCast(ray, farClipDistance = Infinity) {\r\n        // algorithm from https://tavianator.com/fast-branchless-raybounding-box-intersections/\r\n        let tmin = -Infinity;\r\n        let tmax = +Infinity;\r\n        const xinv = ray.dir.x === 0 ? Number.MAX_VALUE : 1 / ray.dir.x;\r\n        const yinv = ray.dir.y === 0 ? Number.MAX_VALUE : 1 / ray.dir.y;\r\n        const tx1 = (this.left - ray.pos.x) * xinv;\r\n        const tx2 = (this.right - ray.pos.x) * xinv;\r\n        tmin = Math.min(tx1, tx2);\r\n        tmax = Math.max(tx1, tx2);\r\n        const ty1 = (this.top - ray.pos.y) * yinv;\r\n        const ty2 = (this.bottom - ray.pos.y) * yinv;\r\n        tmin = Math.max(tmin, Math.min(ty1, ty2));\r\n        tmax = Math.min(tmax, Math.max(ty1, ty2));\r\n        return tmax >= Math.max(0, tmin) && tmin < farClipDistance;\r\n    }\r\n    rayCastTime(ray, farClipDistance = Infinity) {\r\n        // algorithm from https://tavianator.com/fast-branchless-raybounding-box-intersections/\r\n        let tmin = -Infinity;\r\n        let tmax = +Infinity;\r\n        const xinv = ray.dir.x === 0 ? Number.MAX_VALUE : 1 / ray.dir.x;\r\n        const yinv = ray.dir.y === 0 ? Number.MAX_VALUE : 1 / ray.dir.y;\r\n        const tx1 = (this.left - ray.pos.x) * xinv;\r\n        const tx2 = (this.right - ray.pos.x) * xinv;\r\n        tmin = Math.min(tx1, tx2);\r\n        tmax = Math.max(tx1, tx2);\r\n        const ty1 = (this.top - ray.pos.y) * yinv;\r\n        const ty2 = (this.bottom - ray.pos.y) * yinv;\r\n        tmin = Math.max(tmin, Math.min(ty1, ty2));\r\n        tmax = Math.min(tmax, Math.max(ty1, ty2));\r\n        if (tmax >= Math.max(0, tmin) && tmin < farClipDistance) {\r\n            return tmin;\r\n        }\r\n        return -1;\r\n    }\r\n    contains(val) {\r\n        if (val instanceof Vector) {\r\n            return this.left <= val.x && this.top <= val.y && this.bottom >= val.y && this.right >= val.x;\r\n        }\r\n        else if (val instanceof BoundingBox) {\r\n            if (this.left < val.left && this.top < val.top && val.bottom < this.bottom && val.right < this.right) {\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n        return false;\r\n    }\r\n    /**\r\n     * Combines this bounding box and another together returning a new bounding box\r\n     * @param other  The bounding box to combine\r\n     */\r\n    combine(other) {\r\n        const compositeBB = new BoundingBox(Math.min(this.left, other.left), Math.min(this.top, other.top), Math.max(this.right, other.right), Math.max(this.bottom, other.bottom));\r\n        return compositeBB;\r\n    }\r\n    get dimensions() {\r\n        return new Vector(this.width, this.height);\r\n    }\r\n    /**\r\n     * Test wether this bounding box intersects with another returning\r\n     * the intersection vector that can be used to resolve the collision. If there\r\n     * is no intersection null is returned.\r\n     *\r\n     * @param other  Other [[BoundingBox]] to test intersection with\r\n     * @returns A Vector in the direction of the current BoundingBox, this <- other\r\n     */\r\n    intersect(other) {\r\n        const totalBoundingBox = this.combine(other);\r\n        // If the total bounding box is less than or equal the sum of the 2 bounds then there is collision\r\n        if (totalBoundingBox.width < other.width + this.width &&\r\n            totalBoundingBox.height < other.height + this.height &&\r\n            !totalBoundingBox.dimensions.equals(other.dimensions) &&\r\n            !totalBoundingBox.dimensions.equals(this.dimensions)) {\r\n            // collision\r\n            let overlapX = 0;\r\n            // right edge is between the other's left and right edge\r\n            /**\r\n             *     +-this-+\r\n             *     |      |\r\n             *     |    +-other-+\r\n             *     +----|-+     |\r\n             *          |       |\r\n             *          +-------+\r\n             *         <---\r\n             *          ^ overlap\r\n             */\r\n            if (this.right >= other.left && this.right <= other.right) {\r\n                overlapX = other.left - this.right;\r\n                // right edge is past the other's right edge\r\n                /**\r\n                 *     +-other-+\r\n                 *     |       |\r\n                 *     |    +-this-+\r\n                 *     +----|--+   |\r\n                 *          |      |\r\n                 *          +------+\r\n                 *          --->\r\n                 *          ^ overlap\r\n                 */\r\n            }\r\n            else {\r\n                overlapX = other.right - this.left;\r\n            }\r\n            let overlapY = 0;\r\n            // top edge is between the other's top and bottom edge\r\n            /**\r\n             *     +-other-+\r\n             *     |       |\r\n             *     |    +-this-+   | <- overlap\r\n             *     +----|--+   |   |\r\n             *          |      |  \\ /\r\n             *          +------+   '\r\n             */\r\n            if (this.top <= other.bottom && this.top >= other.top) {\r\n                overlapY = other.bottom - this.top;\r\n                // top edge is above the other top edge\r\n                /**\r\n                 *     +-this-+         .\r\n                 *     |      |        / \\\r\n                 *     |    +-other-+   | <- overlap\r\n                 *     +----|-+     |   |\r\n                 *          |       |\r\n                 *          +-------+\r\n                 */\r\n            }\r\n            else {\r\n                overlapY = other.top - this.bottom;\r\n            }\r\n            if (Math.abs(overlapX) < Math.abs(overlapY)) {\r\n                return new Vector(overlapX, 0);\r\n            }\r\n            else {\r\n                return new Vector(0, overlapY);\r\n            }\r\n            // Case of total containment of one bounding box by another\r\n        }\r\n        else if (totalBoundingBox.dimensions.equals(other.dimensions) || totalBoundingBox.dimensions.equals(this.dimensions)) {\r\n            let overlapX = 0;\r\n            // this is wider than the other\r\n            if (this.width - other.width >= 0) {\r\n                // This right edge is closest to the others right edge\r\n                if (this.right - other.right <= other.left - this.left) {\r\n                    overlapX = other.left - this.right;\r\n                    // This left edge is closest to the others left edge\r\n                }\r\n                else {\r\n                    overlapX = other.right - this.left;\r\n                }\r\n                // other is wider than this\r\n            }\r\n            else {\r\n                // This right edge is closest to the others right edge\r\n                if (other.right - this.right <= this.left - other.left) {\r\n                    overlapX = this.left - other.right;\r\n                    // This left edge is closest to the others left edge\r\n                }\r\n                else {\r\n                    overlapX = this.right - other.left;\r\n                }\r\n            }\r\n            let overlapY = 0;\r\n            // this is taller than other\r\n            if (this.height - other.height >= 0) {\r\n                // The bottom edge is closest to the others bottom edge\r\n                if (this.bottom - other.bottom <= other.top - this.top) {\r\n                    overlapY = other.top - this.bottom;\r\n                }\r\n                else {\r\n                    overlapY = other.bottom - this.top;\r\n                }\r\n                // other is taller than this\r\n            }\r\n            else {\r\n                // The bottom edge is closest to the others bottom edge\r\n                if (other.bottom - this.bottom <= this.top - other.top) {\r\n                    overlapY = this.top - other.bottom;\r\n                }\r\n                else {\r\n                    overlapY = this.bottom - other.top;\r\n                }\r\n            }\r\n            if (Math.abs(overlapX) < Math.abs(overlapY)) {\r\n                return new Vector(overlapX, 0);\r\n            }\r\n            else {\r\n                return new Vector(0, overlapY);\r\n            }\r\n        }\r\n        else {\r\n            return null;\r\n        }\r\n    }\r\n    /**\r\n     * Test whether the bounding box has intersected with another bounding box, returns the side of the current bb that intersected.\r\n     * @param bb The other actor to test\r\n     */\r\n    intersectWithSide(bb) {\r\n        const intersect = this.intersect(bb);\r\n        return BoundingBox.getSideFromIntersection(intersect);\r\n    }\r\n    /**\r\n     *\r\n     * @deprecated signature will change in v0.26.0\r\n     * @param ctx\r\n     * @param color\r\n     */\r\n    /* istanbul ignore next */\r\n    debugDraw(ctx, color = Color.Yellow) {\r\n        ctx.strokeStyle = color.toString();\r\n        ctx.strokeRect(this.left, this.top, this.width, this.height);\r\n    }\r\n    /**\r\n     * Draw a debug bounding box\r\n     * @param ex\r\n     * @param color\r\n     */\r\n    draw(ex, color = Color.Yellow) {\r\n        ex.debug.drawRect(this.left, this.top, this.width, this.height, { color });\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/Random.ts\n/**\r\n * @module\r\n * Pseudo-Random Utility\r\n *\r\n * A pseudo-random utility to add seeded random support for help in\r\n * generating things like terrain or reproducible randomness. Uses the\r\n * [Mersenne Twister](https://en.wikipedia.org/wiki/Mersenne_Twister) algorithm.\r\n */\r\n/**\r\n * 32-bit mask\r\n */\r\nconst BITMASK32 = 0xffffffff;\r\n/**\r\n * Pseudo-random number generator following the Mersenne_Twister algorithm. Given a seed this generator will produce the same sequence\r\n * of numbers each time it is called.\r\n * See https://en.wikipedia.org/wiki/Mersenne_Twister for more details.\r\n * Uses the MT19937-32 (2002) implementation documented here http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/MT2002/emt19937ar.html\r\n *\r\n * Api inspired by http://chancejs.com/# https://github.com/chancejs/chancejs\r\n */\r\nclass Random {\r\n    /**\r\n     * If no seed is specified, the Date.now() is used\r\n     */\r\n    constructor(seed) {\r\n        this.seed = seed;\r\n        // Separation point of one one word, the number of bits in the lower bitmask 0 <= r <= w-1\r\n        this._lowerMask = 0x7fffffff; // 31 bits same as _r\r\n        this._upperMask = 0x80000000; // 34 high bits\r\n        // Word size, 64 bits\r\n        this._w = 32;\r\n        // Degree of recurrence\r\n        this._n = 624;\r\n        // Middle word, an offset used in the recurrence defining the series x, 1<=m<n\r\n        this._m = 397;\r\n        // coefficients of teh rational normal form twist matrix\r\n        this._a = 0x9908b0df;\r\n        // tempering bit shifts and masks\r\n        this._u = 11;\r\n        this._s = 7;\r\n        this._b = 0x9d2c5680;\r\n        this._t = 15;\r\n        this._c = 0xefc60000;\r\n        this._l = 18;\r\n        this._f = 1812433253;\r\n        this._mt = new Array(this._n);\r\n        // need to mask to support higher bit machines\r\n        this._mt[0] = (seed || Date.now()) >>> 0;\r\n        for (let i = 1; i < this._n; i++) {\r\n            const s = this._mt[i - 1] ^ (this._mt[i - 1] >>> (this._w - 2));\r\n            // numbers are bigger than the JS max safe int, add in 16-bit chunks to prevent IEEE rounding errors on high bits\r\n            this._mt[i] = (((this._f * ((s & 0xffff0000) >>> 16)) << 16) + this._f * (s & 0xffff) + i) >>> 0;\r\n        }\r\n        this._index = this._n;\r\n    }\r\n    /**\r\n     * Apply the twist\r\n     */\r\n    _twist() {\r\n        const mag01 = [0x0, this._a];\r\n        let y = 0, i = 0;\r\n        for (; i < this._n - this._m; i++) {\r\n            y = (this._mt[i] & this._upperMask) | (this._mt[i + 1] & this._lowerMask);\r\n            this._mt[i] = this._mt[i + this._m] ^ (y >>> 1) ^ (mag01[y & 0x1] & BITMASK32);\r\n        }\r\n        for (; i < this._n - 1; i++) {\r\n            y = (this._mt[i] & this._upperMask) | (this._mt[i + 1] & this._lowerMask);\r\n            this._mt[i] = this._mt[i + (this._m - this._n)] ^ (y >>> 1) ^ (mag01[y & 0x1] & BITMASK32);\r\n        }\r\n        y = (this._mt[this._n - 1] & this._upperMask) | (this._mt[0] & this._lowerMask);\r\n        this._mt[this._n - 1] = this._mt[this._m - 1] ^ (y >>> 1) ^ (mag01[y & 0x1] & BITMASK32);\r\n        this._index = 0;\r\n    }\r\n    /**\r\n     * Return next 32 bit integer number in sequence\r\n     */\r\n    nextInt() {\r\n        if (this._index >= this._n) {\r\n            this._twist();\r\n        }\r\n        let y = this._mt[this._index++];\r\n        y ^= y >>> this._u;\r\n        y ^= (y << this._s) & this._b;\r\n        y ^= (y << this._t) & this._c;\r\n        y ^= y >>> this._l;\r\n        return y >>> 0;\r\n    }\r\n    /**\r\n     * Return a random floating point number between [0, 1)\r\n     */\r\n    next() {\r\n        return this.nextInt() * (1.0 / 4294967296.0); // divided by 2^32\r\n    }\r\n    /**\r\n     * Return a random floating point in range [min, max) min is included, max is not included\r\n     */\r\n    floating(min, max) {\r\n        return (max - min) * this.next() + min;\r\n    }\r\n    /**\r\n     * Return a random integer in range [min, max] min is included, max is included.\r\n     * Implemented with rejection sampling, see https://medium.com/@betable/tifu-by-using-math-random-f1c308c4fd9d#.i13tdiu5a\r\n     */\r\n    integer(min, max) {\r\n        return Math.floor((max - min + 1) * this.next() + min);\r\n    }\r\n    /**\r\n     * Returns true or false randomly with 50/50 odds by default.\r\n     * By default the likelihood of returning a true is .5 (50%).\r\n     * @param likelihood takes values between [0, 1]\r\n     */\r\n    bool(likelihood = 0.5) {\r\n        return this.next() <= likelihood;\r\n    }\r\n    /**\r\n     * Returns one element from an array at random\r\n     */\r\n    pickOne(array) {\r\n        return array[this.integer(0, array.length - 1)];\r\n    }\r\n    /**\r\n     * Returns a new array random picking elements from the original\r\n     * @param array Original array to pick from\r\n     * @param numPicks can be any positive number\r\n     * @param allowDuplicates indicates whether the returned set is allowed duplicates (it does not mean there will always be duplicates\r\n     * just that it is possible)\r\n     */\r\n    pickSet(array, numPicks, allowDuplicates = false) {\r\n        if (allowDuplicates) {\r\n            return this._pickSetWithDuplicates(array, numPicks);\r\n        }\r\n        else {\r\n            return this._pickSetWithoutDuplicates(array, numPicks);\r\n        }\r\n    }\r\n    /**\r\n     * Returns a new array randomly picking elements in the original (not reused)\r\n     * @param array Array to pick elements out of\r\n     * @param numPicks must be less than or equal to the number of elements in the array.\r\n     */\r\n    _pickSetWithoutDuplicates(array, numPicks) {\r\n        if (numPicks > array.length || numPicks < 0) {\r\n            throw new Error('Invalid number of elements to pick, must pick a value 0 < n <= length');\r\n        }\r\n        if (numPicks === array.length) {\r\n            return array;\r\n        }\r\n        const result = new Array(numPicks);\r\n        let currentPick = 0;\r\n        const tempArray = array.slice(0);\r\n        while (currentPick < numPicks) {\r\n            const index = this.integer(0, tempArray.length - 1);\r\n            result[currentPick++] = tempArray[index];\r\n            tempArray.splice(index, 1);\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Returns a new array random picking elements from the original allowing duplicates\r\n     * @param array Array to pick elements out of\r\n     * @param numPicks can be any positive number\r\n     */\r\n    _pickSetWithDuplicates(array, numPicks) {\r\n        // Typescript numbers are all floating point, so do we add check for int? (or floor the input?)\r\n        if (numPicks < 0) {\r\n            throw new Error('Invalid number of elements to pick, must pick a value 0 <= n < MAX_INT');\r\n        }\r\n        const result = new Array(numPicks);\r\n        for (let i = 0; i < numPicks; i++) {\r\n            result[i] = this.pickOne(array);\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Returns a new array that has its elements shuffled. Using the Fisher/Yates method\r\n     * https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle\r\n     */\r\n    shuffle(array) {\r\n        const tempArray = array.slice(0);\r\n        let swap = null;\r\n        for (let i = 0; i < tempArray.length - 2; i++) {\r\n            const randomIndex = this.integer(i, tempArray.length - 1);\r\n            swap = tempArray[i];\r\n            tempArray[i] = tempArray[randomIndex];\r\n            tempArray[randomIndex] = swap;\r\n        }\r\n        return tempArray;\r\n    }\r\n    /**\r\n     * Generate a list of random integer numbers\r\n     * @param length the length of the final array\r\n     * @param min the minimum integer number to generate inclusive\r\n     * @param max the maximum integer number to generate inclusive\r\n     */\r\n    range(length, min, max) {\r\n        const result = new Array(length);\r\n        for (let i = 0; i < length; i++) {\r\n            result[i] = this.integer(min, max);\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Returns the result of a d4 dice roll\r\n     */\r\n    d4() {\r\n        return this.integer(1, 4);\r\n    }\r\n    /**\r\n     * Returns the result of a d6 dice roll\r\n     */\r\n    d6() {\r\n        return this.integer(1, 6);\r\n    }\r\n    /**\r\n     * Returns the result of a d8 dice roll\r\n     */\r\n    d8() {\r\n        return this.integer(1, 8);\r\n    }\r\n    /**\r\n     * Returns the result of a d10 dice roll\r\n     */\r\n    d10() {\r\n        return this.integer(1, 10);\r\n    }\r\n    /**\r\n     * Returns the result of a d12 dice roll\r\n     */\r\n    d12() {\r\n        return this.integer(1, 12);\r\n    }\r\n    /**\r\n     * Returns the result of a d20 dice roll\r\n     */\r\n    d20() {\r\n        return this.integer(1, 20);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/util.ts\n\r\n/**\r\n * Two PI constant\r\n */\r\nconst TwoPI = Math.PI * 2;\r\n/**\r\n * Returns the fractional part of a number\r\n * @param x\r\n */\r\nfunction frac(x) {\r\n    if (x >= 0) {\r\n        return x - Math.floor(x);\r\n    }\r\n    else {\r\n        return x - Math.ceil(x);\r\n    }\r\n}\r\n/**\r\n * Returns the sign of a number, if 0 returns 0\r\n */\r\nfunction sign(val) {\r\n    if (val === 0) {\r\n        return 0;\r\n    }\r\n    return val < 0 ? -1 : 1;\r\n}\r\n;\r\n/**\r\n * Clamps a value between a min and max inclusive\r\n */\r\nfunction clamp(val, min, max) {\r\n    return Math.min(Math.max(min, val), max);\r\n}\r\n/**\r\n * Convert an angle to be the equivalent in the range [0, 2PI]\r\n */\r\nfunction canonicalizeAngle(angle) {\r\n    let tmpAngle = angle;\r\n    if (angle > TwoPI) {\r\n        while (tmpAngle > TwoPI) {\r\n            tmpAngle -= TwoPI;\r\n        }\r\n    }\r\n    if (angle < 0) {\r\n        while (tmpAngle < 0) {\r\n            tmpAngle += TwoPI;\r\n        }\r\n    }\r\n    return tmpAngle;\r\n}\r\n/**\r\n * Convert radians to degrees\r\n */\r\nfunction toDegrees(radians) {\r\n    return (180 / Math.PI) * radians;\r\n}\r\n/**\r\n * Convert degrees to radians\r\n */\r\nfunction toRadians(degrees) {\r\n    return (degrees / 180) * Math.PI;\r\n}\r\n/**\r\n * Generate a range of numbers\r\n * For example: range(0, 5) -> [0, 1, 2, 3, 4, 5]\r\n * @param from inclusive\r\n * @param to inclusive\r\n */\r\nconst range = (from, to) => Array.from(new Array(to - from + 1), (_x, i) => i + from);\r\n/**\r\n * Find a random floating point number in range\r\n */\r\nfunction randomInRange(min, max, random = new Random()) {\r\n    return random ? random.floating(min, max) : min + Math.random() * (max - min);\r\n}\r\n/**\r\n * Find a random integer in a range\r\n */\r\nfunction randomIntInRange(min, max, random = new Random()) {\r\n    return random ? random.integer(min, max) : Math.round(randomInRange(min, max));\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Util.ts\n\r\n\r\n// TODO remove in v0.26.0\r\n// Re-export hack to deprecate import site gently\r\n\r\n/**\r\n * @deprecated ex.Util.TwoPI import site will be removed in v0.26.0, use ex.TwoPI\r\n */\r\nconst Util_TwoPI = TwoPI;\r\n/**\r\n * @deprecated ex.Util.clamp import site will be removed in v0.26.0, use ex.clamp\r\n */\r\nconst Util_clamp = clamp;\r\n/**\r\n * @deprecated ex.Util.randomInRange import site will be removed in v0.26.0, use ex.randomInRange\r\n */\r\nconst Util_randomInRange = randomInRange;\r\n/**\r\n * @deprecated ex.Util.randomIntInRange import site will be removed in v0.26.0, use ex.randomIntInRange\r\n */\r\nconst Util_randomIntInRange = randomIntInRange;\r\n/**\r\n * @deprecated ex.Util.canonicalizeAngle import site will be removed in v0.26.0, use ex.canonicalizeAngle\r\n */\r\nconst Util_canonicalizeAngle = canonicalizeAngle;\r\n/**\r\n * @deprecated ex.Util.toDegrees import site will be removed in v0.26.0, use ex.toDegrees\r\n */\r\nconst Util_toDegrees = toDegrees;\r\n/**\r\n * @deprecated ex.Util.toRadians import site will be removed in v0.26.0, use ex.toRadians\r\n */\r\nconst Util_toRadians = toRadians;\r\n/**\r\n * @deprecated ex.Util.range import site will be removed in v0.26.0, use ex.range\r\n */\r\nconst Util_range = range;\r\n// TODO END REMOVE in v0.26.0\r\n/**\r\n * Find the screen position of an HTML element\r\n */\r\nfunction getPosition(el) {\r\n    let oLeft = 0, oTop = 0;\r\n    const calcOffsetLeft = (parent) => {\r\n        oLeft += parent.offsetLeft;\r\n        if (parent.offsetParent) {\r\n            calcOffsetLeft(parent.offsetParent);\r\n        }\r\n    };\r\n    const calcOffsetTop = (parent) => {\r\n        oTop += parent.offsetTop;\r\n        if (parent.offsetParent) {\r\n            calcOffsetTop(parent.offsetParent);\r\n        }\r\n    };\r\n    calcOffsetLeft(el);\r\n    calcOffsetTop(el);\r\n    return new Vector(oLeft, oTop);\r\n}\r\n/**\r\n * Add an item to an array list if it doesn't already exist. Returns true if added, false if not and already exists in the array.\r\n * @deprecated Will be removed in v0.26.0\r\n */\r\nfunction addItemToArray(item, array) {\r\n    if (array.indexOf(item) === -1) {\r\n        array.push(item);\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * Remove an item from an list\r\n * @deprecated Will be removed in v0.26.0\r\n */\r\nfunction removeItemFromArray(item, array) {\r\n    let index = -1;\r\n    if ((index = array.indexOf(item)) > -1) {\r\n        array.splice(index, 1);\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * See if an array contains something\r\n */\r\nfunction contains(array, obj) {\r\n    for (let i = 0; i < array.length; i++) {\r\n        if (array[i] === obj) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * Get the opposite side\r\n * TODO: Move to Side type\r\n * @deprecated Will be removed in v0.26.0\r\n */\r\nfunction getOppositeSide(side) {\r\n    if (side === Side.Top) {\r\n        return Side.Bottom;\r\n    }\r\n    if (side === Side.Bottom) {\r\n        return Side.Top;\r\n    }\r\n    if (side === Side.Left) {\r\n        return Side.Right;\r\n    }\r\n    if (side === Side.Right) {\r\n        return Side.Left;\r\n    }\r\n    return Side.None;\r\n}\r\n/**\r\n * Returns the side in the direction of the vector supplied\r\n * @param direction Vector to check\r\n * @deprecated\r\n * TODO: Move to Side type\r\n */\r\nfunction getSideFromDirection(direction) {\r\n    const directions = [Vector.Left, Vector.Right, Vector.Up, Vector.Down];\r\n    const directionEnum = [Side.Left, Side.Right, Side.Top, Side.Bottom];\r\n    let max = -Number.MAX_VALUE;\r\n    let maxIndex = -1;\r\n    for (let i = 0; i < directions.length; i++) {\r\n        if (directions[i].dot(direction) > max) {\r\n            max = directions[i].dot(direction);\r\n            maxIndex = i;\r\n        }\r\n    }\r\n    return directionEnum[maxIndex];\r\n}\r\n/**\r\n * Excalibur's dynamically resizing collection\r\n * @deprecated Will be removed v0.26.0\r\n */\r\nclass Collection {\r\n    /**\r\n     * @param initialSize  Initial size of the internal backing array\r\n     */\r\n    constructor(initialSize = Collection.DefaultSize) {\r\n        this._internalArray = null;\r\n        this._endPointer = 0;\r\n        this._internalArray = new Array(initialSize);\r\n    }\r\n    _resize() {\r\n        const newSize = this._internalArray.length * 2;\r\n        const newArray = new Array(newSize);\r\n        const count = this.count();\r\n        for (let i = 0; i < count; i++) {\r\n            newArray[i] = this._internalArray[i];\r\n        }\r\n        delete this._internalArray;\r\n        this._internalArray = newArray;\r\n    }\r\n    /**\r\n     * Push elements to the end of the collection\r\n     */\r\n    push(element) {\r\n        if (this._endPointer === this._internalArray.length) {\r\n            this._resize();\r\n        }\r\n        return (this._internalArray[this._endPointer++] = element);\r\n    }\r\n    /**\r\n     * Removes elements from the end of the collection\r\n     */\r\n    pop() {\r\n        this._endPointer = this._endPointer - 1 < 0 ? 0 : this._endPointer - 1;\r\n        return this._internalArray[this._endPointer];\r\n    }\r\n    /**\r\n     * Returns the count of the collection\r\n     */\r\n    count() {\r\n        return this._endPointer;\r\n    }\r\n    /**\r\n     * Empties the collection\r\n     */\r\n    clear() {\r\n        this._endPointer = 0;\r\n    }\r\n    /**\r\n     * Returns the size of the internal backing array\r\n     */\r\n    internalSize() {\r\n        return this._internalArray.length;\r\n    }\r\n    /**\r\n     * Returns an element at a specific index\r\n     * @param index  Index of element to retrieve\r\n     */\r\n    elementAt(index) {\r\n        if (index >= this.count()) {\r\n            //Logger.getInstance().error('Invalid parameter: ' + index);\r\n            throw new Error('Invalid index ' + index);\r\n        }\r\n        return this._internalArray[index];\r\n    }\r\n    /**\r\n     * Inserts an element at a specific index\r\n     * @param index  Index to insert the element\r\n     * @param value  Element to insert\r\n     */\r\n    insert(index, value) {\r\n        if (index >= this.count()) {\r\n            this._resize();\r\n        }\r\n        return (this._internalArray[index] = value);\r\n    }\r\n    /**\r\n     * Removes an element at a specific index\r\n     * @param index  Index of element to remove\r\n     */\r\n    remove(index) {\r\n        const count = this.count();\r\n        if (count === 0) {\r\n            //Logger.getInstance().error('Invalid parameter: ' + index);\r\n            throw new Error('Invalid parameter ' + index);\r\n        }\r\n        // O(n) Shift\r\n        const removed = this._internalArray[index];\r\n        for (let i = index; i < count; i++) {\r\n            this._internalArray[i] = this._internalArray[i + 1];\r\n        }\r\n        this._endPointer--;\r\n        return removed;\r\n    }\r\n    /**\r\n     * Removes an element by reference\r\n     * @param element  Element to retrieve\r\n     */\r\n    removeElement(element) {\r\n        const index = this._internalArray.indexOf(element);\r\n        this.remove(index);\r\n    }\r\n    /**\r\n     * Returns a array representing the collection\r\n     */\r\n    toArray() {\r\n        return this._internalArray.slice(0, this._endPointer);\r\n    }\r\n    /**\r\n     * Iterate over every element in the collection\r\n     * @param func  Callback to call for each element passing a reference to the element and its index, returned values are ignored\r\n     */\r\n    forEach(func) {\r\n        let i = 0;\r\n        const count = this.count();\r\n        for (i; i < count; i++) {\r\n            func.call(this, this._internalArray[i], i);\r\n        }\r\n    }\r\n    /**\r\n     * Mutate every element in the collection\r\n     * @param func  Callback to call for each element passing a reference to the element and its index, any values returned mutate\r\n     * the collection\r\n     */\r\n    map(func) {\r\n        const count = this.count();\r\n        for (let i = 0; i < count; i++) {\r\n            this._internalArray[i] = func.call(this, this._internalArray[i], i);\r\n        }\r\n    }\r\n}\r\n/**\r\n * Default collection size\r\n */\r\nCollection.DefaultSize = 200;\r\n/**\r\n * Used for exhaustive checks at compile time\r\n */\r\nfunction fail(message) {\r\n    throw new Error(message);\r\n}\r\n/**\r\n * Create a promise that resolves after a certain number of milliseconds\r\n *\r\n * It is strongly recommended you pass the excalibur clock so delays are bound to the\r\n * excalibur clock which would be unaffected by stop/pause.\r\n * @param milliseconds\r\n * @param clock\r\n */\r\nfunction delay(milliseconds, clock) {\r\n    var _a;\r\n    const schedule = (_a = clock === null || clock === void 0 ? void 0 : clock.schedule.bind(clock)) !== null && _a !== void 0 ? _a : setTimeout;\r\n    return new Promise(resolve => {\r\n        schedule(() => {\r\n            resolve();\r\n        }, milliseconds);\r\n    });\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/matrix.ts\n\r\n\r\n\r\nvar MatrixLocations;\r\n(function (MatrixLocations) {\r\n    MatrixLocations[MatrixLocations[\"X\"] = 12] = \"X\";\r\n    MatrixLocations[MatrixLocations[\"Y\"] = 13] = \"Y\";\r\n})(MatrixLocations || (MatrixLocations = {}));\r\n/**\r\n * Excalibur Matrix helper for 4x4 matrices\r\n *\r\n * Useful for webgl 4x4 matrices\r\n */\r\nclass Matrix {\r\n    constructor() {\r\n        /**\r\n         *  4x4 matrix in column major order\r\n         *\r\n         * |         |         |          |          |\r\n         * | ------- | ------- | -------- |          |\r\n         * | data[0] | data[4] | data[8]  | data[12] |\r\n         * | data[1] | data[5] | data[9]  | data[13] |\r\n         * | data[2] | data[6] | data[10] | data[14] |\r\n         * | data[3] | data[7] | data[11] | data[15] |\r\n         *\r\n         */\r\n        this.data = new Float32Array(16);\r\n        this._scaleSignX = 1;\r\n        this._scaleSignY = 1;\r\n    }\r\n    /**\r\n     * Creates an orthographic (flat non-perspective) projection\r\n     * https://en.wikipedia.org/wiki/Orthographic_projection\r\n     * @param left\r\n     * @param right\r\n     * @param bottom\r\n     * @param top\r\n     * @param near\r\n     * @param far\r\n     */\r\n    static ortho(left, right, bottom, top, near, far) {\r\n        const mat = new Matrix();\r\n        mat.data[0] = 2 / (right - left);\r\n        mat.data[1] = 0;\r\n        mat.data[2] = 0;\r\n        mat.data[3] = 0;\r\n        mat.data[4] = 0;\r\n        mat.data[5] = 2 / (top - bottom);\r\n        mat.data[6] = 0;\r\n        mat.data[7] = 0;\r\n        mat.data[8] = 0;\r\n        mat.data[9] = 0;\r\n        mat.data[10] = -2 / (far - near);\r\n        mat.data[11] = 0;\r\n        mat.data[12] = -(right + left) / (right - left);\r\n        mat.data[13] = -(top + bottom) / (top - bottom);\r\n        mat.data[14] = -(far + near) / (far - near);\r\n        mat.data[15] = 1;\r\n        return mat;\r\n    }\r\n    /**\r\n     * Creates a new Matrix with the same data as the current 4x4\r\n     */\r\n    clone() {\r\n        const mat = new Matrix();\r\n        mat.data[0] = this.data[0];\r\n        mat.data[1] = this.data[1];\r\n        mat.data[2] = this.data[2];\r\n        mat.data[3] = this.data[3];\r\n        mat.data[4] = this.data[4];\r\n        mat.data[5] = this.data[5];\r\n        mat.data[6] = this.data[6];\r\n        mat.data[7] = this.data[7];\r\n        mat.data[8] = this.data[8];\r\n        mat.data[9] = this.data[9];\r\n        mat.data[10] = this.data[10];\r\n        mat.data[11] = this.data[11];\r\n        mat.data[12] = this.data[12];\r\n        mat.data[13] = this.data[13];\r\n        mat.data[14] = this.data[14];\r\n        mat.data[15] = this.data[15];\r\n        return mat;\r\n    }\r\n    /**\r\n     * Converts the current matrix into a DOMMatrix\r\n     *\r\n     * This is useful when working with the browser Canvas context\r\n     * @returns {DOMMatrix} DOMMatrix\r\n     */\r\n    toDOMMatrix() {\r\n        return new DOMMatrix([...this.data]);\r\n    }\r\n    /**\r\n     * Creates a new identity matrix (a matrix that when applied does nothing)\r\n     */\r\n    static identity() {\r\n        const mat = new Matrix();\r\n        mat.data[0] = 1;\r\n        mat.data[1] = 0;\r\n        mat.data[2] = 0;\r\n        mat.data[3] = 0;\r\n        mat.data[4] = 0;\r\n        mat.data[5] = 1;\r\n        mat.data[6] = 0;\r\n        mat.data[7] = 0;\r\n        mat.data[8] = 0;\r\n        mat.data[9] = 0;\r\n        mat.data[10] = 1;\r\n        mat.data[11] = 0;\r\n        mat.data[12] = 0;\r\n        mat.data[13] = 0;\r\n        mat.data[14] = 0;\r\n        mat.data[15] = 1;\r\n        return mat;\r\n    }\r\n    /**\r\n     * Resets the current matrix to the identity matrix, mutating it\r\n     * @returns {Matrix} Current matrix as identity\r\n     */\r\n    reset() {\r\n        const mat = this;\r\n        mat.data[0] = 1;\r\n        mat.data[1] = 0;\r\n        mat.data[2] = 0;\r\n        mat.data[3] = 0;\r\n        mat.data[4] = 0;\r\n        mat.data[5] = 1;\r\n        mat.data[6] = 0;\r\n        mat.data[7] = 0;\r\n        mat.data[8] = 0;\r\n        mat.data[9] = 0;\r\n        mat.data[10] = 1;\r\n        mat.data[11] = 0;\r\n        mat.data[12] = 0;\r\n        mat.data[13] = 0;\r\n        mat.data[14] = 0;\r\n        mat.data[15] = 1;\r\n        return mat;\r\n    }\r\n    /**\r\n     * Creates a brand new translation matrix at the specified 3d point\r\n     * @param x\r\n     * @param y\r\n     */\r\n    static translation(x, y) {\r\n        const mat = Matrix.identity();\r\n        mat.data[12] = x;\r\n        mat.data[13] = y;\r\n        return mat;\r\n    }\r\n    /**\r\n     * Creates a brand new scaling matrix with the specified scaling factor\r\n     * @param sx\r\n     * @param sy\r\n     */\r\n    static scale(sx, sy) {\r\n        const mat = Matrix.identity();\r\n        mat.data[0] = sx;\r\n        mat.data[5] = sy;\r\n        mat.data[10] = 1;\r\n        mat.data[15] = 1;\r\n        return mat;\r\n    }\r\n    /**\r\n     * Creates a brand new rotation matrix with the specified angle\r\n     * @param angleRadians\r\n     */\r\n    static rotation(angleRadians) {\r\n        const mat = Matrix.identity();\r\n        mat.data[0] = Math.cos(angleRadians);\r\n        mat.data[4] = -Math.sin(angleRadians);\r\n        mat.data[1] = Math.sin(angleRadians);\r\n        mat.data[5] = Math.cos(angleRadians);\r\n        return mat;\r\n    }\r\n    multv(other) {\r\n        const z = 0;\r\n        if (other instanceof Vector) {\r\n            return new Vector(other.x * this.data[0] + other.y * this.data[4] + z * this.data[6] + 1 * this.data[12], other.x * this.data[1] + other.y * this.data[5] + z * this.data[9] + 1 * this.data[13]);\r\n        }\r\n        else {\r\n            const dest = [\r\n                other[0] * this.data[0] + other[1] * this.data[4] + z * this.data[6] + 1 * this.data[12],\r\n                other[0] * this.data[1] + other[1] * this.data[5] + z * this.data[9] + 1 * this.data[13]\r\n            ];\r\n            return dest;\r\n        }\r\n    }\r\n    /**\r\n     * Multiplies the current matrix by another and returns the resulting matrix\r\n     * @param other\r\n     */\r\n    multm(other) {\r\n        const dest = new Matrix();\r\n        const a11 = this.data[0];\r\n        const a21 = this.data[1];\r\n        const a31 = this.data[2];\r\n        const a41 = this.data[3];\r\n        const a12 = this.data[4];\r\n        const a22 = this.data[5];\r\n        const a32 = this.data[6];\r\n        const a42 = this.data[7];\r\n        const a13 = this.data[8];\r\n        const a23 = this.data[9];\r\n        const a33 = this.data[10];\r\n        const a43 = this.data[11];\r\n        const a14 = this.data[12];\r\n        const a24 = this.data[13];\r\n        const a34 = this.data[14];\r\n        const a44 = this.data[15];\r\n        const b11 = other.data[0];\r\n        const b21 = other.data[1];\r\n        const b31 = other.data[2];\r\n        const b41 = other.data[3];\r\n        const b12 = other.data[4];\r\n        const b22 = other.data[5];\r\n        const b32 = other.data[6];\r\n        const b42 = other.data[7];\r\n        const b13 = other.data[8];\r\n        const b23 = other.data[9];\r\n        const b33 = other.data[10];\r\n        const b43 = other.data[11];\r\n        const b14 = other.data[12];\r\n        const b24 = other.data[13];\r\n        const b34 = other.data[14];\r\n        const b44 = other.data[15];\r\n        dest.data[0] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;\r\n        dest.data[1] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;\r\n        dest.data[2] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;\r\n        dest.data[3] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;\r\n        dest.data[4] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;\r\n        dest.data[5] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;\r\n        dest.data[6] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;\r\n        dest.data[7] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;\r\n        dest.data[8] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;\r\n        dest.data[9] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;\r\n        dest.data[10] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;\r\n        dest.data[11] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;\r\n        dest.data[12] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;\r\n        dest.data[13] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;\r\n        dest.data[14] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;\r\n        dest.data[15] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;\r\n        const s = this.getScale();\r\n        dest._scaleSignX = sign(s.x) * sign(dest._scaleSignX);\r\n        dest._scaleSignY = sign(s.y) * sign(dest._scaleSignY);\r\n        return dest;\r\n    }\r\n    /**\r\n     * Applies translation to the current matrix mutating it\r\n     * @param x\r\n     * @param y\r\n     */\r\n    translate(x, y) {\r\n        const a11 = this.data[0];\r\n        const a21 = this.data[1];\r\n        const a31 = this.data[2];\r\n        const a41 = this.data[3];\r\n        const a12 = this.data[4];\r\n        const a22 = this.data[5];\r\n        const a32 = this.data[6];\r\n        const a42 = this.data[7];\r\n        const a13 = this.data[8];\r\n        const a23 = this.data[9];\r\n        const a33 = this.data[10];\r\n        const a43 = this.data[11];\r\n        const a14 = this.data[12];\r\n        const a24 = this.data[13];\r\n        const a34 = this.data[14];\r\n        const a44 = this.data[15];\r\n        // Doesn't change z\r\n        const z = 0;\r\n        const w = 1;\r\n        this.data[12] = a11 * x + a12 * y + a13 * z + a14 * w;\r\n        this.data[13] = a21 * x + a22 * y + a23 * z + a24 * w;\r\n        this.data[14] = a31 * x + a32 * y + a33 * z + a34 * w;\r\n        this.data[15] = a41 * x + a42 * y + a43 * z + a44 * w;\r\n        return this;\r\n    }\r\n    setPosition(x, y) {\r\n        this.data[12] = x;\r\n        this.data[13] = y;\r\n    }\r\n    getPosition() {\r\n        return vec(this.data[12], this.data[13]);\r\n    }\r\n    /**\r\n     * Applies rotation to the current matrix mutating it\r\n     * @param angle in Radians\r\n     */\r\n    rotate(angle) {\r\n        const a11 = this.data[0];\r\n        const a21 = this.data[1];\r\n        const a31 = this.data[2];\r\n        const a41 = this.data[3];\r\n        const a12 = this.data[4];\r\n        const a22 = this.data[5];\r\n        const a32 = this.data[6];\r\n        const a42 = this.data[7];\r\n        const sine = Math.sin(angle);\r\n        const cosine = Math.cos(angle);\r\n        this.data[0] = cosine * a11 + sine * a12;\r\n        this.data[1] = cosine * a21 + sine * a22;\r\n        this.data[2] = cosine * a31 + sine * a32;\r\n        this.data[3] = cosine * a41 + sine * a42;\r\n        this.data[4] = cosine * a12 - sine * a11;\r\n        this.data[5] = cosine * a22 - sine * a21;\r\n        this.data[6] = cosine * a32 - sine * a31;\r\n        this.data[7] = cosine * a42 - sine * a41;\r\n        return this;\r\n    }\r\n    /**\r\n     * Applies scaling to the current matrix mutating it\r\n     * @param x\r\n     * @param y\r\n     */\r\n    scale(x, y) {\r\n        const a11 = this.data[0];\r\n        const a21 = this.data[1];\r\n        const a31 = this.data[2];\r\n        const a41 = this.data[3];\r\n        const a12 = this.data[4];\r\n        const a22 = this.data[5];\r\n        const a32 = this.data[6];\r\n        const a42 = this.data[7];\r\n        this.data[0] = a11 * x;\r\n        this.data[1] = a21 * x;\r\n        this.data[2] = a31 * x;\r\n        this.data[3] = a41 * x;\r\n        this.data[4] = a12 * y;\r\n        this.data[5] = a22 * y;\r\n        this.data[6] = a32 * y;\r\n        this.data[7] = a42 * y;\r\n        return this;\r\n    }\r\n    setRotation(angle) {\r\n        const currentScale = this.getScale();\r\n        const sine = Math.sin(angle);\r\n        const cosine = Math.cos(angle);\r\n        this.data[0] = cosine * currentScale.x;\r\n        this.data[1] = sine * currentScale.y;\r\n        this.data[4] = -sine * currentScale.x;\r\n        this.data[5] = cosine * currentScale.y;\r\n    }\r\n    getRotation() {\r\n        const angle = Math.atan2(this.data[1] / this.getScaleY(), this.data[0] / this.getScaleX());\r\n        return canonicalizeAngle(angle);\r\n    }\r\n    getScaleX() {\r\n        // absolute scale of the matrix (we lose sign so need to add it back)\r\n        const xscale = vec(this.data[0], this.data[4]).size;\r\n        return this._scaleSignX * xscale;\r\n    }\r\n    getScaleY() {\r\n        // absolute scale of the matrix (we lose sign so need to add it back)\r\n        const yscale = vec(this.data[1], this.data[5]).size;\r\n        return this._scaleSignY * yscale;\r\n    }\r\n    /**\r\n     * Get the scale of the matrix\r\n     */\r\n    getScale() {\r\n        return vec(this.getScaleX(), this.getScaleY());\r\n    }\r\n    setScaleX(val) {\r\n        this._scaleSignX = sign(val);\r\n        // negative scale acts like a 180 rotation, so flip\r\n        const xscale = vec(this.data[0] * this._scaleSignX, this.data[4] * this._scaleSignX).normalize();\r\n        this.data[0] = xscale.x * val;\r\n        this.data[4] = xscale.y * val;\r\n    }\r\n    setScaleY(val) {\r\n        this._scaleSignY = sign(val);\r\n        // negative scale acts like a 180 rotation, so flip\r\n        const yscale = vec(this.data[1] * this._scaleSignY, this.data[5] * this._scaleSignY).normalize();\r\n        this.data[1] = yscale.x * val;\r\n        this.data[5] = yscale.y * val;\r\n    }\r\n    setScale(scale) {\r\n        this.setScaleX(scale.x);\r\n        this.setScaleY(scale.y);\r\n    }\r\n    /**\r\n     * Determinant of the upper left 2x2 matrix\r\n     */\r\n    getBasisDeterminant() {\r\n        return this.data[0] * this.data[5] - this.data[1] * this.data[4];\r\n    }\r\n    /**\r\n     * Return the affine inverse, optionally store it in a target matrix.\r\n     *\r\n     * It's recommended you call .reset() the target unless you know what you're doing\r\n     * @param target\r\n     */\r\n    getAffineInverse(target) {\r\n        // See http://negativeprobability.blogspot.com/2011/11/affine-transformations-and-their.html\r\n        // See https://www.mathsisfun.com/algebra/matrix-inverse.html\r\n        // Since we are actually only doing 2D transformations we can use this hack\r\n        // We don't actually use the 3rd or 4th dimension\r\n        const det = this.getBasisDeterminant();\r\n        const inverseDet = 1 / det; // todo zero check\r\n        const a = this.data[0];\r\n        const b = this.data[4];\r\n        const c = this.data[1];\r\n        const d = this.data[5];\r\n        const m = target || Matrix.identity();\r\n        // inverts rotation and scale\r\n        m.data[0] = d * inverseDet;\r\n        m.data[1] = -c * inverseDet;\r\n        m.data[4] = -b * inverseDet;\r\n        m.data[5] = a * inverseDet;\r\n        const tx = this.data[12];\r\n        const ty = this.data[13];\r\n        // invert translation\r\n        // transform translation into the matrix basis created by rot/scale\r\n        m.data[12] = -(tx * m.data[0] + ty * m.data[4]);\r\n        m.data[13] = -(tx * m.data[1] + ty * m.data[5]);\r\n        return m;\r\n    }\r\n    isIdentity() {\r\n        return (this.data[0] === 1 &&\r\n            this.data[1] === 0 &&\r\n            this.data[2] === 0 &&\r\n            this.data[3] === 0 &&\r\n            this.data[4] === 0 &&\r\n            this.data[5] === 1 &&\r\n            this.data[6] === 0 &&\r\n            this.data[7] === 0 &&\r\n            this.data[8] === 0 &&\r\n            this.data[9] === 0 &&\r\n            this.data[10] === 1 &&\r\n            this.data[11] === 0 &&\r\n            this.data[12] === 0 &&\r\n            this.data[13] === 0 &&\r\n            this.data[14] === 0 &&\r\n            this.data[15] === 1);\r\n    }\r\n    toString() {\r\n        return `\r\n[${this.data[0]} ${this.data[4]} ${this.data[8]} ${this.data[12]}]\r\n[${this.data[1]} ${this.data[5]} ${this.data[9]} ${this.data[13]}]\r\n[${this.data[2]} ${this.data[6]} ${this.data[10]} ${this.data[14]}]\r\n[${this.data[3]} ${this.data[7]} ${this.data[11]} ${this.data[15]}]\r\n`;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/transform-stack.ts\n\r\nclass TransformStack {\r\n    constructor() {\r\n        this._transforms = [];\r\n        this._currentTransform = Matrix.identity();\r\n    }\r\n    save() {\r\n        this._transforms.push(this._currentTransform);\r\n        this._currentTransform = this._currentTransform.clone();\r\n    }\r\n    restore() {\r\n        this._currentTransform = this._transforms.pop();\r\n    }\r\n    translate(x, y) {\r\n        return this._currentTransform.translate(x, y);\r\n    }\r\n    rotate(angle) {\r\n        return this._currentTransform.rotate(angle);\r\n    }\r\n    scale(x, y) {\r\n        return this._currentTransform.scale(x, y);\r\n    }\r\n    set current(matrix) {\r\n        this._currentTransform = matrix;\r\n    }\r\n    get current() {\r\n        return this._currentTransform;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/state-stack.ts\nclass StateStack {\r\n    constructor() {\r\n        this._states = [];\r\n        this._currentState = this._getDefaultState();\r\n    }\r\n    _getDefaultState() {\r\n        return {\r\n            opacity: 1\r\n        };\r\n    }\r\n    _cloneState() {\r\n        return {\r\n            opacity: this._currentState.opacity\r\n        };\r\n    }\r\n    save() {\r\n        this._states.push(this._currentState);\r\n        this._currentState = this._cloneState();\r\n    }\r\n    restore() {\r\n        this._currentState = this._states.pop();\r\n    }\r\n    get current() {\r\n        return this._currentState;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Watch.ts\n/**\r\n * Watch an object with a proxy, only fires if property value is different\r\n */\r\nfunction watch(type, change) {\r\n    if (!type) {\r\n        return type;\r\n    }\r\n    if (type.__isProxy === undefined) {\r\n        // expando hack to mark a proxy\r\n        return new Proxy(type, {\r\n            set: (obj, prop, value) => {\r\n                // The default behavior to store the value\r\n                if (obj[prop] !== value) {\r\n                    obj[prop] = value;\r\n                    // Avoid watching private junk\r\n                    if (typeof prop === 'string') {\r\n                        if (prop[0] !== '_') {\r\n                            change(obj);\r\n                        }\r\n                    }\r\n                }\r\n                // Indicate success\r\n                return true;\r\n            },\r\n            get: (obj, prop) => {\r\n                if (prop !== '__isProxy') {\r\n                    return obj[prop];\r\n                }\r\n                return true;\r\n            }\r\n        });\r\n    }\r\n    return type;\r\n}\r\n/**\r\n * Watch an object with a proxy, fires change on any property value change\r\n */\r\nfunction watchAny(type, change) {\r\n    if (!type) {\r\n        return type;\r\n    }\r\n    if (type.__isProxy === undefined) {\r\n        // expando hack to mark a proxy\r\n        return new Proxy(type, {\r\n            set: (obj, prop, value) => {\r\n                // The default behavior to store the value\r\n                obj[prop] = value;\r\n                // Avoid watching private junk\r\n                if (typeof prop === 'string') {\r\n                    if (prop[0] !== '_') {\r\n                        change(obj);\r\n                    }\r\n                }\r\n                // Indicate success\r\n                return true;\r\n            },\r\n            get: (obj, prop) => {\r\n                if (prop !== '__isProxy') {\r\n                    return obj[prop];\r\n                }\r\n                return true;\r\n            }\r\n        });\r\n    }\r\n    return type;\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Graphic.ts\n\r\n\r\n\r\n\r\n/**\r\n * A Graphic is the base Excalibur primitive for something that can be drawn to the [[ExcaliburGraphicsContext]].\r\n * [[Sprite]], [[Animation]], [[GraphicsGroup]], [[Canvas]], [[Rectangle]], [[Circle]], and [[Polygon]] all derive from the\r\n * [[Graphic]] abstract class.\r\n *\r\n * Implementors of a Graphic must override the abstract [[Graphic._drawImage]] method to render an image to the graphics context. Graphic\r\n * handles all the position, rotation, and scale transformations in [[Graphic._preDraw]] and [[Graphic._postDraw]]\r\n */\r\nclass Graphic {\r\n    constructor(options) {\r\n        var _a, _b, _c, _d, _e, _f;\r\n        this.id = Graphic._ID++;\r\n        this.transform = Matrix.identity();\r\n        this._transformStale = true;\r\n        /**\r\n         * Gets or sets wether to show debug information about the graphic\r\n         */\r\n        this.showDebug = false;\r\n        this._flipHorizontal = false;\r\n        this._flipVertical = false;\r\n        this._rotation = 0;\r\n        /**\r\n         * Gets or sets the opacity of the graphic, 0 is transparent, 1 is solid (opaque).\r\n         */\r\n        this.opacity = 1;\r\n        this._scale = Vector.One;\r\n        this._origin = null;\r\n        this._width = 0;\r\n        this._height = 0;\r\n        if (options) {\r\n            this.origin = (_a = options.origin) !== null && _a !== void 0 ? _a : this.origin;\r\n            this.flipHorizontal = (_b = options.flipHorizontal) !== null && _b !== void 0 ? _b : this.flipHorizontal;\r\n            this.flipVertical = (_c = options.flipVertical) !== null && _c !== void 0 ? _c : this.flipVertical;\r\n            this.rotation = (_d = options.rotation) !== null && _d !== void 0 ? _d : this.rotation;\r\n            this.opacity = (_e = options.opacity) !== null && _e !== void 0 ? _e : this.opacity;\r\n            this.scale = (_f = options.scale) !== null && _f !== void 0 ? _f : this.scale;\r\n        }\r\n    }\r\n    isStale() {\r\n        return this._transformStale;\r\n    }\r\n    /**\r\n     * Gets or sets the flipHorizontal, which will flip the graphic horizontally (across the y axis)\r\n     */\r\n    get flipHorizontal() {\r\n        return this._flipHorizontal;\r\n    }\r\n    set flipHorizontal(value) {\r\n        this._flipHorizontal = value;\r\n        this._transformStale = true;\r\n    }\r\n    /**\r\n     * Gets or sets the flipVertical, which will flip the graphic vertically (across the x axis)\r\n     */\r\n    get flipVertical() {\r\n        return this._flipVertical;\r\n    }\r\n    set flipVertical(value) {\r\n        this._flipVertical = value;\r\n        this._transformStale = true;\r\n    }\r\n    /**\r\n     * Gets or sets the rotation of the graphic\r\n     */\r\n    get rotation() {\r\n        return this._rotation;\r\n    }\r\n    set rotation(value) {\r\n        this._rotation = value;\r\n        this._transformStale = true;\r\n    }\r\n    /**\r\n     * Gets or sets the scale of the graphic, this affects the width and\r\n     */\r\n    get scale() {\r\n        return this._scale;\r\n    }\r\n    set scale(value) {\r\n        this._scale = watch(value, () => {\r\n            this._transformStale = true;\r\n        });\r\n        this._transformStale = true;\r\n    }\r\n    /**\r\n     * Gets or sets the origin of the graphic, if not set the center of the graphic is the origin\r\n     */\r\n    get origin() {\r\n        return this._origin;\r\n    }\r\n    set origin(value) {\r\n        this._origin = watch(value, () => {\r\n            this._transformStale = true;\r\n        });\r\n        this._transformStale = true;\r\n    }\r\n    cloneGraphicOptions() {\r\n        return {\r\n            origin: this.origin ? this.origin.clone() : null,\r\n            flipHorizontal: this.flipHorizontal,\r\n            flipVertical: this.flipVertical,\r\n            rotation: this.rotation,\r\n            opacity: this.opacity,\r\n            scale: this.scale ? this.scale.clone() : null\r\n        };\r\n    }\r\n    /**\r\n     * Gets or sets the width of the graphic (always positive)\r\n     */\r\n    get width() {\r\n        return Math.abs(this._width * this.scale.x);\r\n    }\r\n    /**\r\n     * Gets or sets the height of the graphic (always positive)\r\n     */\r\n    get height() {\r\n        return Math.abs(this._height * this.scale.y);\r\n    }\r\n    set width(value) {\r\n        this._width = value;\r\n        this._transformStale = true;\r\n    }\r\n    set height(value) {\r\n        this._height = value;\r\n        this._transformStale = true;\r\n    }\r\n    /**\r\n     * Gets a copy of the bounds in pixels occupied by the graphic on the the screen. This includes scale.\r\n     */\r\n    get localBounds() {\r\n        return BoundingBox.fromDimension(this.width, this.height, Vector.Zero);\r\n    }\r\n    /**\r\n     * Draw the whole graphic to the context including transform\r\n     * @param ex The excalibur graphics context\r\n     * @param x\r\n     * @param y\r\n     */\r\n    draw(ex, x, y) {\r\n        this._preDraw(ex, x, y);\r\n        this._drawImage(ex, 0, 0);\r\n        this._postDraw(ex);\r\n    }\r\n    /**\r\n     * Apply affine transformations to the graphics context to manipulate the graphic before [[Graphic._drawImage]]\r\n     * @param ex\r\n     * @param x\r\n     * @param y\r\n     */\r\n    _preDraw(ex, x, y) {\r\n        ex.save();\r\n        ex.translate(x, y);\r\n        if (this._transformStale) {\r\n            this.transform.reset();\r\n            this.transform.scale(Math.abs(this.scale.x), Math.abs(this.scale.y));\r\n            this._rotate(this.transform);\r\n            this._flip(this.transform);\r\n            this._transformStale = false;\r\n        }\r\n        ex.multiply(this.transform);\r\n        // it is important to multiply alphas so graphics respect the current context\r\n        ex.opacity = ex.opacity * this.opacity;\r\n    }\r\n    _rotate(ex) {\r\n        var _a;\r\n        const scaleDirX = this.scale.x > 0 ? 1 : -1;\r\n        const scaleDirY = this.scale.y > 0 ? 1 : -1;\r\n        const origin = (_a = this.origin) !== null && _a !== void 0 ? _a : vec(this.width / 2, this.height / 2);\r\n        ex.translate(origin.x, origin.y);\r\n        ex.rotate(this.rotation);\r\n        // This is for handling direction changes 1 or -1, that way we don't have mismatched translates()\r\n        ex.scale(scaleDirX, scaleDirY);\r\n        ex.translate(-origin.x, -origin.y);\r\n    }\r\n    _flip(ex) {\r\n        if (this.flipHorizontal) {\r\n            ex.translate(this.width / this.scale.x, 0);\r\n            ex.scale(-1, 1);\r\n        }\r\n        if (this.flipVertical) {\r\n            ex.translate(0, this.height / this.scale.y);\r\n            ex.scale(1, -1);\r\n        }\r\n    }\r\n    /**\r\n     * Apply any additional work after [[Graphic._drawImage]] and restore the context state.\r\n     * @param ex\r\n     */\r\n    _postDraw(ex) {\r\n        if (this.showDebug) {\r\n            ex.debug.drawRect(0, 0, this.width, this.height);\r\n        }\r\n        ex.restore();\r\n    }\r\n}\r\nGraphic._ID = 0;\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/webgl-util.ts\n/**\r\n * Checks if the current number is a power of two\r\n */\r\nfunction isPowerOfTwo(x) {\r\n    return (x & (x - 1)) === 0;\r\n}\r\n/**\r\n * Returns the next highest power of two\r\n */\r\nfunction nextHighestPowerOfTwo(x) {\r\n    --x;\r\n    for (let i = 1; i < 32; i <<= 1) {\r\n        x = x | (x >> i);\r\n    }\r\n    return x + 1;\r\n}\r\n/**\r\n * Returns the input number if a power of two, otherwise the next highest power of two\r\n */\r\nfunction ensurePowerOfTwo(x) {\r\n    if (!isPowerOfTwo(x)) {\r\n        return nextHighestPowerOfTwo(x);\r\n    }\r\n    return x;\r\n}\r\n/**\r\n * Return the size of the GlType in bytes\r\n * @param gl\r\n * @param type\r\n */\r\nfunction getGlTypeSizeBytes(gl, type) {\r\n    switch (type) {\r\n        case gl.FLOAT:\r\n            return 4;\r\n        case gl.SHORT:\r\n            return 2;\r\n        case gl.UNSIGNED_SHORT:\r\n            return 2;\r\n        case gl.BYTE:\r\n            return 1;\r\n        case gl.UNSIGNED_BYTE:\r\n            return 1;\r\n        default:\r\n            return 1;\r\n    }\r\n}\r\n/**\r\n * Based on the type return the number of attribute components\r\n *\r\n * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/vertexAttribPointer\r\n * @param gl\r\n * @param type\r\n */\r\nfunction getAttributeComponentSize(gl, type) {\r\n    switch (type) {\r\n        case gl.LOW_FLOAT:\r\n        case gl.HIGH_FLOAT:\r\n        case gl.FLOAT:\r\n            return 1;\r\n        case gl.FLOAT_VEC2:\r\n            return 2;\r\n        case gl.FLOAT_VEC3:\r\n            return 3;\r\n        case gl.FLOAT_VEC4:\r\n            return 4;\r\n        case gl.BYTE:\r\n            return 1;\r\n        case gl.UNSIGNED_BYTE:\r\n            return 1;\r\n        case gl.UNSIGNED_SHORT:\r\n        case gl.SHORT:\r\n            return 1;\r\n        default:\r\n            return 1;\r\n    }\r\n}\r\n/**\r\n * Based on the attribute return the corresponding supported attrib pointer type\r\n * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/vertexAttribPointer\r\n *\r\n * @param gl\r\n * @param type\r\n */\r\nfunction getAttributePointerType(gl, type) {\r\n    switch (type) {\r\n        case gl.LOW_FLOAT:\r\n        case gl.HIGH_FLOAT:\r\n        case gl.FLOAT:\r\n        case gl.FLOAT_VEC2:\r\n        case gl.FLOAT_VEC3:\r\n        case gl.FLOAT_VEC4:\r\n            return gl.FLOAT;\r\n        case gl.BYTE:\r\n            return gl.BYTE;\r\n        case gl.UNSIGNED_BYTE:\r\n            return gl.UNSIGNED_BYTE;\r\n        case gl.SHORT:\r\n            return gl.SHORT;\r\n        case gl.UNSIGNED_SHORT:\r\n            return gl.UNSIGNED_SHORT;\r\n        default:\r\n            return gl.FLOAT;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Filtering.ts\n/**\r\n * Describes the different image filtering modes\r\n */\r\nvar ImageFiltering;\r\n(function (ImageFiltering) {\r\n    /**\r\n     * Pixel is useful when you do not want smoothing aka antialiasing applied to your graphics.\r\n     *\r\n     * Useful for Pixel art aesthetics.\r\n     */\r\n    ImageFiltering[\"Pixel\"] = \"Pixel\";\r\n    /**\r\n     * Blended is useful when you have high resolution artwork and would like it blended and smoothed\r\n     */\r\n    ImageFiltering[\"Blended\"] = \"Blended\";\r\n})(ImageFiltering || (ImageFiltering = {}));\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/texture-loader.ts\n\r\n\r\n/**\r\n * Manages loading image sources into webgl textures, a unique id is associated with all sources\r\n */\r\nclass TextureLoader {\r\n    static register(context) {\r\n        TextureLoader._GL = context;\r\n    }\r\n    /**\r\n     * Get the WebGL Texture from a source image\r\n     * @param image\r\n     */\r\n    static get(image) {\r\n        return TextureLoader._TEXTURE_MAP.get(image);\r\n    }\r\n    /**\r\n     * Returns whether a source image has been loaded as a texture\r\n     * @param image\r\n     */\r\n    static has(image) {\r\n        return TextureLoader._TEXTURE_MAP.has(image);\r\n    }\r\n    /**\r\n     * Loads a graphic into webgl and returns it's texture info, a webgl context must be previously registered\r\n     * @param image Source graphic\r\n     * @param filtering {ImageFiltering} The ImageFiltering mode to apply to the loaded texture\r\n     * @param forceUpdate Optionally force a texture to be reloaded, useful if the source graphic has changed\r\n     */\r\n    static load(image, filtering, forceUpdate = false) {\r\n        // Ignore loading if webgl is not registered\r\n        const gl = TextureLoader._GL;\r\n        if (!gl) {\r\n            return null;\r\n        }\r\n        let tex = null;\r\n        // If reuse the texture if it's from the same source\r\n        if (TextureLoader.has(image)) {\r\n            tex = TextureLoader.get(image);\r\n        }\r\n        // Update existing webgl texture and return early\r\n        if (tex) {\r\n            if (forceUpdate) {\r\n                gl.bindTexture(gl.TEXTURE_2D, tex);\r\n                const source = TextureLoader.toPowerOfTwoImage(image);\r\n                gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, source);\r\n            }\r\n            return tex;\r\n        }\r\n        // No texture exists create a new one\r\n        tex = gl.createTexture();\r\n        const source = TextureLoader.toPowerOfTwoImage(image);\r\n        gl.bindTexture(gl.TEXTURE_2D, tex);\r\n        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n        // NEAREST for pixel art, LINEAR for hi-res\r\n        const filterMode = filtering !== null && filtering !== void 0 ? filtering : TextureLoader.filtering;\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, filterMode === ImageFiltering.Pixel ? gl.NEAREST : gl.LINEAR);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, filterMode === ImageFiltering.Pixel ? gl.NEAREST : gl.LINEAR);\r\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, source);\r\n        TextureLoader._TEXTURE_MAP.set(image, tex);\r\n        return tex;\r\n    }\r\n    /**\r\n     * Converts source images into power of two images, WebGL only supports POT images\r\n     * https://www.khronos.org/webgl/wiki/WebGL_and_OpenGL_Differences#Non-Power_of_Two_Texture_Support\r\n     * @param image\r\n     */\r\n    static toPowerOfTwoImage(image) {\r\n        const potCanvas = TextureLoader._POT_CANVAS;\r\n        const potCtx = TextureLoader._POT_CTX;\r\n        if (!isPowerOfTwo(image.width) || !isPowerOfTwo(image.height)) {\r\n            // Scale up the texture to the next highest power of two dimensions.\r\n            potCanvas.width = ensurePowerOfTwo(image.width);\r\n            potCanvas.height = ensurePowerOfTwo(image.height);\r\n            potCtx.imageSmoothingEnabled = false;\r\n            potCtx.clearRect(0, 0, potCanvas.width, potCanvas.height);\r\n            potCtx.drawImage(image, 0, 0, image.width, image.height);\r\n            image = potCanvas;\r\n        }\r\n        return image;\r\n    }\r\n}\r\n/**\r\n * Sets the default filtering for the Excalibur texture loader, default [[ImageFiltering.Blended]]\r\n */\r\nTextureLoader.filtering = ImageFiltering.Blended;\r\nTextureLoader._POT_CANVAS = document.createElement('canvas');\r\nTextureLoader._POT_CTX = TextureLoader._POT_CANVAS.getContext('2d');\r\nTextureLoader._TEXTURE_MAP = new Map();\r\n\n;// CONCATENATED MODULE: ./Graphics/Raster.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * A Raster is a Graphic that needs to be first painted to a HTMLCanvasElement before it can be drawn to the\r\n * [[ExcaliburGraphicsContext]]. This is useful for generating custom images using the 2D canvas api.\r\n *\r\n * Implementors must implement the [[Raster.execute]] method to rasterize their drawing.\r\n */\r\nclass Raster extends Graphic {\r\n    constructor(options) {\r\n        var _a, _b, _c, _d, _e, _f, _g, _h;\r\n        super(options);\r\n        this.filtering = null;\r\n        this._dirty = true;\r\n        this._smoothing = false;\r\n        this._color = watch(Color.Black, () => this.flagDirty());\r\n        this._lineWidth = 1;\r\n        this._lineDash = [];\r\n        this._padding = 0;\r\n        if (options) {\r\n            this.color = (_a = options.color) !== null && _a !== void 0 ? _a : Color.Black;\r\n            this.strokeColor = options === null || options === void 0 ? void 0 : options.strokeColor;\r\n            this.smoothing = (_b = options.smoothing) !== null && _b !== void 0 ? _b : this.smoothing;\r\n            this.lineWidth = (_c = options.lineWidth) !== null && _c !== void 0 ? _c : this.lineWidth;\r\n            this.lineDash = (_d = options.lineDash) !== null && _d !== void 0 ? _d : this.lineDash;\r\n            this.padding = (_e = options.padding) !== null && _e !== void 0 ? _e : this.padding;\r\n            this.filtering = (_f = options.filtering) !== null && _f !== void 0 ? _f : this.filtering;\r\n        }\r\n        this._bitmap = document.createElement('canvas');\r\n        // get the default canvas width/height as a fallback\r\n        const bitmapWidth = (_g = options === null || options === void 0 ? void 0 : options.width) !== null && _g !== void 0 ? _g : this._bitmap.width;\r\n        const bitmapHeight = (_h = options === null || options === void 0 ? void 0 : options.height) !== null && _h !== void 0 ? _h : this._bitmap.height;\r\n        // Rasters use power of two images as an optimization for webgl\r\n        this.width = ensurePowerOfTwo(bitmapWidth);\r\n        this.height = ensurePowerOfTwo(bitmapHeight);\r\n        const maybeCtx = this._bitmap.getContext('2d');\r\n        if (!maybeCtx) {\r\n            /* istanbul ignore next */\r\n            throw new Error('Browser does not support 2d canvas drawing, cannot create Raster graphic');\r\n        }\r\n        else {\r\n            this._ctx = maybeCtx;\r\n        }\r\n    }\r\n    cloneRasterOptions() {\r\n        return {\r\n            color: this.color ? this.color.clone() : null,\r\n            strokeColor: this.strokeColor ? this.strokeColor.clone() : null,\r\n            smoothing: this.smoothing,\r\n            lineWidth: this.lineWidth,\r\n            lineDash: this.lineDash,\r\n            padding: this.padding\r\n        };\r\n    }\r\n    /**\r\n     * Gets whether the graphic is dirty, this means there are changes that haven't been re-rasterized\r\n     */\r\n    get dirty() {\r\n        return this._dirty;\r\n    }\r\n    /**\r\n     * Flags the graphic as dirty, meaning it must be re-rasterized before draw.\r\n     * This should be called any time the graphics state changes such that it affects the outputted drawing\r\n     */\r\n    flagDirty() {\r\n        this._dirty = true;\r\n    }\r\n    /**\r\n     * Gets or sets the current width of the Raster graphic. Setting the width will cause the raster\r\n     * to be flagged dirty causing a re-raster on the next draw.\r\n     *\r\n     * Any `padding`s set will be factored into the width\r\n     */\r\n    get width() {\r\n        return Math.abs(this._getTotalWidth() * this.scale.x);\r\n    }\r\n    set width(value) {\r\n        value /= Math.abs(this.scale.x);\r\n        this._bitmap.width = value;\r\n        this._originalWidth = value;\r\n        this.flagDirty();\r\n    }\r\n    /**\r\n     * Gets or sets the current height of the Raster graphic. Setting the height will cause the raster\r\n     * to be flagged dirty causing a re-raster on the next draw.\r\n     *\r\n     * Any `padding` set will be factored into the height\r\n     */\r\n    get height() {\r\n        return Math.abs(this._getTotalHeight() * this.scale.y);\r\n    }\r\n    set height(value) {\r\n        value /= Math.abs(this.scale.y);\r\n        this._bitmap.height = value;\r\n        this._originalHeight = value;\r\n        this.flagDirty();\r\n    }\r\n    _getTotalWidth() {\r\n        var _a;\r\n        return ((_a = this._originalWidth) !== null && _a !== void 0 ? _a : this._bitmap.width) + this.padding * 2;\r\n    }\r\n    _getTotalHeight() {\r\n        var _a;\r\n        return ((_a = this._originalHeight) !== null && _a !== void 0 ? _a : this._bitmap.height) + this.padding * 2;\r\n    }\r\n    /**\r\n     * Returns the local bounds of the Raster including the padding\r\n     */\r\n    get localBounds() {\r\n        return BoundingBox.fromDimension(this._getTotalWidth() * this.scale.x, this._getTotalHeight() * this.scale.y, Vector.Zero);\r\n    }\r\n    /**\r\n     * Gets or sets the smoothing (anti-aliasing of the graphic). Setting the height will cause the raster\r\n     * to be flagged dirty causing a re-raster on the next draw.\r\n     */\r\n    get smoothing() {\r\n        return this._smoothing;\r\n    }\r\n    set smoothing(value) {\r\n        this._smoothing = value;\r\n        this.flagDirty();\r\n    }\r\n    /**\r\n     * Gets or sets the fillStyle of the Raster graphic. Setting the fillStyle will cause the raster to be\r\n     * flagged dirty causing a re-raster on the next draw.\r\n     */\r\n    get color() {\r\n        return this._color;\r\n    }\r\n    set color(value) {\r\n        this.flagDirty();\r\n        this._color = watch(value, () => this.flagDirty());\r\n    }\r\n    /**\r\n     * Gets or sets the strokeStyle of the Raster graphic. Setting the strokeStyle will cause the raster to be\r\n     * flagged dirty causing a re-raster on the next draw.\r\n     */\r\n    get strokeColor() {\r\n        return this._strokeColor;\r\n    }\r\n    set strokeColor(value) {\r\n        this.flagDirty();\r\n        this._strokeColor = watch(value, () => this.flagDirty());\r\n    }\r\n    /**\r\n     * Gets or sets the line width of the Raster graphic. Setting the lineWidth will cause the raster to be\r\n     * flagged dirty causing a re-raster on the next draw.\r\n     */\r\n    get lineWidth() {\r\n        return this._lineWidth;\r\n    }\r\n    set lineWidth(value) {\r\n        this._lineWidth = value;\r\n        this.flagDirty();\r\n    }\r\n    get lineDash() {\r\n        return this._lineDash;\r\n    }\r\n    set lineDash(value) {\r\n        this._lineDash = value;\r\n        this.flagDirty();\r\n    }\r\n    get padding() {\r\n        return this._padding;\r\n    }\r\n    set padding(value) {\r\n        this._padding = value;\r\n        this.flagDirty();\r\n    }\r\n    /**\r\n     * Rasterize the graphic to a bitmap making it usable as in excalibur. Rasterize is called automatically if\r\n     * the graphic is [[Raster.dirty]] on the next [[Graphic.draw]] call\r\n     */\r\n    rasterize() {\r\n        this._dirty = false;\r\n        this._ctx.clearRect(0, 0, this._getTotalWidth(), this._getTotalHeight());\r\n        this._ctx.save();\r\n        this._applyRasterProperties(this._ctx);\r\n        this.execute(this._ctx);\r\n        this._ctx.restore();\r\n        // The webgl texture needs to be updated if it exists after a raster cycle\r\n        TextureLoader.load(this._bitmap, this.filtering, true);\r\n    }\r\n    _applyRasterProperties(ctx) {\r\n        var _a, _b, _c;\r\n        this._bitmap.width = this._getTotalWidth();\r\n        this._bitmap.height = this._getTotalHeight();\r\n        ctx.translate(this.padding, this.padding);\r\n        ctx.imageSmoothingEnabled = this.smoothing;\r\n        ctx.lineWidth = this.lineWidth;\r\n        ctx.setLineDash((_a = this.lineDash) !== null && _a !== void 0 ? _a : ctx.getLineDash());\r\n        ctx.strokeStyle = (_b = this.strokeColor) === null || _b === void 0 ? void 0 : _b.toString();\r\n        ctx.fillStyle = (_c = this.color) === null || _c === void 0 ? void 0 : _c.toString();\r\n    }\r\n    _drawImage(ex, x, y) {\r\n        if (this._dirty) {\r\n            this.rasterize();\r\n        }\r\n        ex.drawImage(this._bitmap, x, y);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Canvas.ts\n\r\n/**\r\n * A canvas [[Graphic]] to provide an adapter between the 2D Canvas API and the [[ExcaliburGraphicsContext]].\r\n *\r\n * The [[Canvas]] works by re-rastering a draw handler to a HTMLCanvasElement for every draw which is then passed\r\n * to the [[ExcaliburGraphicsContext]] implementation as a rendered image.\r\n *\r\n * **Low performance API**\r\n */\r\nclass Canvas extends Raster {\r\n    constructor(_options) {\r\n        super(_options);\r\n        this._options = _options;\r\n    }\r\n    /**\r\n     * Return the 2D graphics context of this canvas\r\n     */\r\n    get ctx() {\r\n        return this._ctx;\r\n    }\r\n    clone() {\r\n        return new Canvas({\r\n            ...this._options,\r\n            ...this.cloneGraphicOptions(),\r\n            ...this.cloneRasterOptions()\r\n        });\r\n    }\r\n    execute(ctx) {\r\n        var _a, _b;\r\n        if ((_a = this._options) === null || _a === void 0 ? void 0 : _a.draw) {\r\n            (_b = this._options) === null || _b === void 0 ? void 0 : _b.draw(ctx);\r\n        }\r\n        if (!this._options.cache) {\r\n            this.flagDirty();\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Events.ts\nvar EventTypes;\r\n(function (EventTypes) {\r\n    EventTypes[\"Kill\"] = \"kill\";\r\n    EventTypes[\"PreKill\"] = \"prekill\";\r\n    EventTypes[\"PostKill\"] = \"postkill\";\r\n    EventTypes[\"PreDraw\"] = \"predraw\";\r\n    EventTypes[\"PostDraw\"] = \"postdraw\";\r\n    EventTypes[\"PreDebugDraw\"] = \"predebugdraw\";\r\n    EventTypes[\"PostDebugDraw\"] = \"postdebugdraw\";\r\n    EventTypes[\"PreUpdate\"] = \"preupdate\";\r\n    EventTypes[\"PostUpdate\"] = \"postupdate\";\r\n    EventTypes[\"PreFrame\"] = \"preframe\";\r\n    EventTypes[\"PostFrame\"] = \"postframe\";\r\n    EventTypes[\"PreCollision\"] = \"precollision\";\r\n    EventTypes[\"CollisionStart\"] = \"collisionstart\";\r\n    EventTypes[\"CollisionEnd\"] = \"collisionend\";\r\n    EventTypes[\"PostCollision\"] = \"postcollision\";\r\n    EventTypes[\"Initialize\"] = \"initialize\";\r\n    EventTypes[\"Activate\"] = \"activate\";\r\n    EventTypes[\"Deactivate\"] = \"deactivate\";\r\n    EventTypes[\"ExitViewport\"] = \"exitviewport\";\r\n    EventTypes[\"EnterViewport\"] = \"enterviewport\";\r\n    EventTypes[\"ExitTrigger\"] = \"exit\";\r\n    EventTypes[\"EnterTrigger\"] = \"enter\";\r\n    EventTypes[\"Connect\"] = \"connect\";\r\n    EventTypes[\"Disconnect\"] = \"disconnect\";\r\n    EventTypes[\"Button\"] = \"button\";\r\n    EventTypes[\"Axis\"] = \"axis\";\r\n    EventTypes[\"Subscribe\"] = \"subscribe\";\r\n    EventTypes[\"Unsubscribe\"] = \"unsubscribe\";\r\n    EventTypes[\"Visible\"] = \"visible\";\r\n    EventTypes[\"Hidden\"] = \"hidden\";\r\n    EventTypes[\"Start\"] = \"start\";\r\n    EventTypes[\"Stop\"] = \"stop\";\r\n    EventTypes[\"PointerUp\"] = \"pointerup\";\r\n    EventTypes[\"PointerDown\"] = \"pointerdown\";\r\n    EventTypes[\"PointerMove\"] = \"pointermove\";\r\n    EventTypes[\"PointerEnter\"] = \"pointerenter\";\r\n    EventTypes[\"PointerLeave\"] = \"pointerleave\";\r\n    EventTypes[\"PointerCancel\"] = \"pointercancel\";\r\n    EventTypes[\"PointerWheel\"] = \"pointerwheel\";\r\n    EventTypes[\"Up\"] = \"up\";\r\n    EventTypes[\"Down\"] = \"down\";\r\n    EventTypes[\"Move\"] = \"move\";\r\n    EventTypes[\"Enter\"] = \"enter\";\r\n    EventTypes[\"Leave\"] = \"leave\";\r\n    EventTypes[\"Cancel\"] = \"cancel\";\r\n    EventTypes[\"Wheel\"] = \"wheel\";\r\n    EventTypes[\"Press\"] = \"press\";\r\n    EventTypes[\"Release\"] = \"release\";\r\n    EventTypes[\"Hold\"] = \"hold\";\r\n    EventTypes[\"PointerDragStart\"] = \"pointerdragstart\";\r\n    EventTypes[\"PointerDragEnd\"] = \"pointerdragend\";\r\n    EventTypes[\"PointerDragEnter\"] = \"pointerdragenter\";\r\n    EventTypes[\"PointerDragLeave\"] = \"pointerdragleave\";\r\n    EventTypes[\"PointerDragMove\"] = \"pointerdragmove\";\r\n})(EventTypes || (EventTypes = {}));\r\n/**\r\n * Base event type in Excalibur that all other event types derive from. Not all event types are thrown on all Excalibur game objects,\r\n * some events are unique to a type, others are not.\r\n *\r\n */\r\nclass GameEvent {\r\n    constructor() {\r\n        this._bubbles = true;\r\n    }\r\n    /**\r\n     * If set to false, prevents event from propagating to other actors. If true it will be propagated\r\n     * to all actors that apply.\r\n     */\r\n    get bubbles() {\r\n        return this._bubbles;\r\n    }\r\n    set bubbles(value) {\r\n        this._bubbles = value;\r\n    }\r\n    /**\r\n     * Prevents event from bubbling\r\n     */\r\n    stopPropagation() {\r\n        this.bubbles = false;\r\n    }\r\n}\r\n/**\r\n * The 'kill' event is emitted on actors when it is killed. The target is the actor that was killed.\r\n */\r\nclass KillEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'prekill' event is emitted directly before an actor is killed.\r\n */\r\nclass PreKillEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'postkill' event is emitted directly after the actor is killed.\r\n */\r\nclass PostKillEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'start' event is emitted on engine when has started and is ready for interaction.\r\n */\r\nclass GameStartEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'stop' event is emitted on engine when has been stopped and will no longer take input, update or draw.\r\n */\r\nclass GameStopEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'predraw' event is emitted on actors, scenes, and engine before drawing starts. Actors' predraw happens inside their graphics\r\n * transform so that all drawing takes place with the actor as the origin.\r\n *\r\n */\r\nclass PreDrawEvent extends GameEvent {\r\n    constructor(ctx, delta, target) {\r\n        super();\r\n        this.ctx = ctx;\r\n        this.delta = delta;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'postdraw' event is emitted on actors, scenes, and engine after drawing finishes. Actors' postdraw happens inside their graphics\r\n * transform so that all drawing takes place with the actor as the origin.\r\n *\r\n */\r\nclass PostDrawEvent extends GameEvent {\r\n    constructor(ctx, delta, target) {\r\n        super();\r\n        this.ctx = ctx;\r\n        this.delta = delta;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'predebugdraw' event is emitted on actors, scenes, and engine before debug drawing starts.\r\n */\r\nclass PreDebugDrawEvent extends GameEvent {\r\n    constructor(ctx, target) {\r\n        super();\r\n        this.ctx = ctx;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'postdebugdraw' event is emitted on actors, scenes, and engine after debug drawing starts.\r\n */\r\nclass PostDebugDrawEvent extends GameEvent {\r\n    constructor(ctx, target) {\r\n        super();\r\n        this.ctx = ctx;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'preupdate' event is emitted on actors, scenes, camera, and engine before the update starts.\r\n */\r\nclass PreUpdateEvent extends GameEvent {\r\n    constructor(engine, delta, target) {\r\n        super();\r\n        this.engine = engine;\r\n        this.delta = delta;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'postupdate' event is emitted on actors, scenes, camera, and engine after the update ends.\r\n */\r\nclass PostUpdateEvent extends GameEvent {\r\n    constructor(engine, delta, target) {\r\n        super();\r\n        this.engine = engine;\r\n        this.delta = delta;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'preframe' event is emitted on the engine, before the frame begins.\r\n */\r\nclass PreFrameEvent extends GameEvent {\r\n    constructor(engine, prevStats) {\r\n        super();\r\n        this.engine = engine;\r\n        this.prevStats = prevStats;\r\n        this.target = engine;\r\n    }\r\n}\r\n/**\r\n * The 'postframe' event is emitted on the engine, after a frame ends.\r\n */\r\nclass PostFrameEvent extends GameEvent {\r\n    constructor(engine, stats) {\r\n        super();\r\n        this.engine = engine;\r\n        this.stats = stats;\r\n        this.target = engine;\r\n    }\r\n}\r\n/**\r\n * Event received when a gamepad is connected to Excalibur. [[Gamepads]] receives this event.\r\n */\r\nclass GamepadConnectEvent extends GameEvent {\r\n    constructor(index, gamepad) {\r\n        super();\r\n        this.index = index;\r\n        this.gamepad = gamepad;\r\n        this.target = gamepad;\r\n    }\r\n}\r\n/**\r\n * Event received when a gamepad is disconnected from Excalibur. [[Gamepads]] receives this event.\r\n */\r\nclass GamepadDisconnectEvent extends GameEvent {\r\n    constructor(index, gamepad) {\r\n        super();\r\n        this.index = index;\r\n        this.gamepad = gamepad;\r\n        this.target = gamepad;\r\n    }\r\n}\r\n/**\r\n * Gamepad button event. See [[Gamepads]] for information on responding to controller input. [[Gamepad]] instances receive this event;\r\n */\r\nclass GamepadButtonEvent extends GameEvent {\r\n    /**\r\n     * @param button  The Gamepad button\r\n     * @param value   A numeric value between 0 and 1\r\n     */\r\n    constructor(button, value, target) {\r\n        super();\r\n        this.button = button;\r\n        this.value = value;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Gamepad axis event. See [[Gamepads]] for information on responding to controller input. [[Gamepad]] instances receive this event;\r\n */\r\nclass GamepadAxisEvent extends GameEvent {\r\n    /**\r\n     * @param axis  The Gamepad axis\r\n     * @param value A numeric value between -1 and 1\r\n     */\r\n    constructor(axis, value, target) {\r\n        super();\r\n        this.axis = axis;\r\n        this.value = value;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Subscribe event thrown when handlers for events other than subscribe are added. Meta event that is received by\r\n * [[EventDispatcher|event dispatchers]].\r\n */\r\nclass SubscribeEvent extends GameEvent {\r\n    constructor(topic, handler) {\r\n        super();\r\n        this.topic = topic;\r\n        this.handler = handler;\r\n    }\r\n}\r\n/**\r\n * Unsubscribe event thrown when handlers for events other than unsubscribe are removed. Meta event that is received by\r\n * [[EventDispatcher|event dispatchers]].\r\n */\r\nclass UnsubscribeEvent extends GameEvent {\r\n    constructor(topic, handler) {\r\n        super();\r\n        this.topic = topic;\r\n        this.handler = handler;\r\n    }\r\n}\r\n/**\r\n * Event received by the [[Engine]] when the browser window is visible on a screen.\r\n */\r\nclass VisibleEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Event received by the [[Engine]] when the browser window is hidden from all screens.\r\n */\r\nclass HiddenEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Event thrown on an [[Actor|actor]] when a collision will occur this frame if it resolves\r\n */\r\nclass PreCollisionEvent extends GameEvent {\r\n    /**\r\n     * @param actor         The actor the event was thrown on\r\n     * @param other         The actor that will collided with the current actor\r\n     * @param side          The side that will be collided with the current actor\r\n     * @param intersection  Intersection vector\r\n     */\r\n    constructor(actor, other, side, intersection) {\r\n        super();\r\n        this.other = other;\r\n        this.side = side;\r\n        this.intersection = intersection;\r\n        this.target = actor;\r\n    }\r\n}\r\n/**\r\n * Event thrown on an [[Actor|actor]] when a collision has been resolved (body reacted) this frame\r\n */\r\nclass PostCollisionEvent extends GameEvent {\r\n    /**\r\n     * @param actor         The actor the event was thrown on\r\n     * @param other         The actor that did collide with the current actor\r\n     * @param side          The side that did collide with the current actor\r\n     * @param intersection  Intersection vector\r\n     */\r\n    constructor(actor, other, side, intersection) {\r\n        super();\r\n        this.other = other;\r\n        this.side = side;\r\n        this.intersection = intersection;\r\n        this.target = actor;\r\n    }\r\n    get actor() {\r\n        return this.target;\r\n    }\r\n    set actor(actor) {\r\n        this.target = actor;\r\n    }\r\n}\r\nclass ContactStartEvent {\r\n    constructor(target, other, contact) {\r\n        this.target = target;\r\n        this.other = other;\r\n        this.contact = contact;\r\n    }\r\n}\r\nclass ContactEndEvent {\r\n    constructor(target, other) {\r\n        this.target = target;\r\n        this.other = other;\r\n    }\r\n}\r\nclass CollisionPreSolveEvent {\r\n    constructor(target, other, side, intersection, contact) {\r\n        this.target = target;\r\n        this.other = other;\r\n        this.side = side;\r\n        this.intersection = intersection;\r\n        this.contact = contact;\r\n    }\r\n}\r\nclass CollisionPostSolveEvent {\r\n    constructor(target, other, side, intersection, contact) {\r\n        this.target = target;\r\n        this.other = other;\r\n        this.side = side;\r\n        this.intersection = intersection;\r\n        this.contact = contact;\r\n    }\r\n}\r\n/**\r\n * Event thrown the first time an [[Actor|actor]] collides with another, after an actor is in contact normal collision events are fired.\r\n */\r\nclass CollisionStartEvent extends GameEvent {\r\n    /**\r\n     *\r\n     * @param actor\r\n     * @param other\r\n     * @param contact\r\n     */\r\n    constructor(actor, other, contact) {\r\n        super();\r\n        this.other = other;\r\n        this.contact = contact;\r\n        this.target = actor;\r\n    }\r\n    get actor() {\r\n        return this.target;\r\n    }\r\n    set actor(actor) {\r\n        this.target = actor;\r\n    }\r\n}\r\n/**\r\n * Event thrown when the [[Actor|actor]] is no longer colliding with another\r\n */\r\nclass CollisionEndEvent extends GameEvent {\r\n    /**\r\n     *\r\n     */\r\n    constructor(actor, other) {\r\n        super();\r\n        this.other = other;\r\n        this.target = actor;\r\n    }\r\n    get actor() {\r\n        return this.target;\r\n    }\r\n    set actor(actor) {\r\n        this.target = actor;\r\n    }\r\n}\r\n/**\r\n * Event thrown on an [[Actor]] and a [[Scene]] only once before the first update call\r\n */\r\nclass InitializeEvent extends GameEvent {\r\n    /**\r\n     * @param engine  The reference to the current engine\r\n     */\r\n    constructor(engine, target) {\r\n        super();\r\n        this.engine = engine;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Event thrown on a [[Scene]] on activation\r\n */\r\nclass ActivateEvent extends GameEvent {\r\n    /**\r\n     * @param oldScene  The reference to the old scene\r\n     */\r\n    constructor(oldScene, target) {\r\n        super();\r\n        this.oldScene = oldScene;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Event thrown on a [[Scene]] on deactivation\r\n */\r\nclass DeactivateEvent extends GameEvent {\r\n    /**\r\n     * @param newScene  The reference to the new scene\r\n     */\r\n    constructor(newScene, target) {\r\n        super();\r\n        this.newScene = newScene;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Event thrown on an [[Actor]] when it completely leaves the screen.\r\n */\r\nclass ExitViewPortEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Event thrown on an [[Actor]] when it completely leaves the screen.\r\n */\r\nclass EnterViewPortEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\nclass EnterTriggerEvent extends GameEvent {\r\n    constructor(target, actor) {\r\n        super();\r\n        this.target = target;\r\n        this.actor = actor;\r\n    }\r\n}\r\nclass ExitTriggerEvent extends GameEvent {\r\n    constructor(target, actor) {\r\n        super();\r\n        this.target = target;\r\n        this.actor = actor;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EventDispatcher.ts\n\r\nclass EventDispatcher {\r\n    constructor() {\r\n        this._handlers = {};\r\n        this._wiredEventDispatchers = [];\r\n    }\r\n    /**\r\n     * Clears any existing handlers or wired event dispatchers on this event dispatcher\r\n     */\r\n    clear() {\r\n        this._handlers = {};\r\n        this._wiredEventDispatchers = [];\r\n    }\r\n    /**\r\n     * Emits an event for target\r\n     * @param eventName  The name of the event to publish\r\n     * @param event      Optionally pass an event data object to the handler\r\n     */\r\n    emit(eventName, event) {\r\n        if (!eventName) {\r\n            // key not mapped\r\n            return;\r\n        }\r\n        eventName = eventName.toLowerCase();\r\n        if (!event) {\r\n            event = new GameEvent();\r\n        }\r\n        let i, len;\r\n        if (this._handlers[eventName]) {\r\n            i = 0;\r\n            len = this._handlers[eventName].length;\r\n            for (i; i < len; i++) {\r\n                this._handlers[eventName][i](event);\r\n            }\r\n        }\r\n        i = 0;\r\n        len = this._wiredEventDispatchers.length;\r\n        for (i; i < len; i++) {\r\n            this._wiredEventDispatchers[i].emit(eventName, event);\r\n        }\r\n    }\r\n    /**\r\n     * Subscribe an event handler to a particular event name, multiple handlers per event name are allowed.\r\n     * @param eventName  The name of the event to subscribe to\r\n     * @param handler    The handler callback to fire on this event\r\n     */\r\n    on(eventName, handler) {\r\n        eventName = eventName.toLowerCase();\r\n        if (!this._handlers[eventName]) {\r\n            this._handlers[eventName] = [];\r\n        }\r\n        this._handlers[eventName].push(handler);\r\n        // meta event handlers\r\n        if (eventName !== 'unsubscribe' && eventName !== 'subscribe') {\r\n            this.emit('subscribe', new SubscribeEvent(eventName, handler));\r\n        }\r\n    }\r\n    /**\r\n     * Unsubscribe an event handler(s) from an event. If a specific handler\r\n     * is specified for an event, only that handler will be unsubscribed.\r\n     * Otherwise all handlers will be unsubscribed for that event.\r\n     *\r\n     * @param eventName  The name of the event to unsubscribe\r\n     * @param handler    Optionally the specific handler to unsubscribe\r\n     */\r\n    off(eventName, handler) {\r\n        eventName = eventName.toLowerCase();\r\n        const eventHandlers = this._handlers[eventName];\r\n        if (eventHandlers) {\r\n            // if no explicit handler is give with the event name clear all handlers\r\n            if (!handler) {\r\n                this._handlers[eventName].length = 0;\r\n            }\r\n            else {\r\n                const index = eventHandlers.indexOf(handler);\r\n                this._handlers[eventName].splice(index, 1);\r\n            }\r\n        }\r\n        // meta event handlers\r\n        if (eventName !== 'unsubscribe' && eventName !== 'subscribe') {\r\n            this.emit('unsubscribe', new UnsubscribeEvent(eventName, handler));\r\n        }\r\n    }\r\n    /**\r\n     * Once listens to an event one time, then unsubscribes from that event\r\n     *\r\n     * @param eventName The name of the event to subscribe to once\r\n     * @param handler   The handler of the event that will be auto unsubscribed\r\n     */\r\n    once(eventName, handler) {\r\n        const metaHandler = (event) => {\r\n            const ev = event || new GameEvent();\r\n            this.off(eventName, handler);\r\n            handler(ev);\r\n        };\r\n        this.on(eventName, metaHandler);\r\n    }\r\n    /**\r\n     * Wires this event dispatcher to also receive events from another\r\n     */\r\n    wire(eventDispatcher) {\r\n        eventDispatcher._wiredEventDispatchers.push(this);\r\n    }\r\n    /**\r\n     * Unwires this event dispatcher from another\r\n     */\r\n    unwire(eventDispatcher) {\r\n        const index = eventDispatcher._wiredEventDispatchers.indexOf(this);\r\n        if (index > -1) {\r\n            eventDispatcher._wiredEventDispatchers.splice(index, 1);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Resources/Resource.ts\n\r\n\r\n/**\r\n * The [[Resource]] type allows games built in Excalibur to load generic resources.\r\n * For any type of remote resource it is recommended to use [[Resource]] for preloading.\r\n */\r\nclass Resource {\r\n    /**\r\n     * @param path          Path to the remote resource\r\n     * @param responseType  The type to expect as a response: \"\" | \"arraybuffer\" | \"blob\" | \"document\" | \"json\" | \"text\";\r\n     * @param bustCache     Whether or not to cache-bust requests\r\n     */\r\n    constructor(path, responseType, bustCache = true) {\r\n        this.path = path;\r\n        this.responseType = responseType;\r\n        this.bustCache = bustCache;\r\n        this.data = null;\r\n        this.logger = Logger.getInstance();\r\n        this.events = new EventDispatcher();\r\n    }\r\n    /**\r\n     * Returns true if the Resource is completely loaded and is ready\r\n     * to be drawn.\r\n     */\r\n    isLoaded() {\r\n        return this.data !== null;\r\n    }\r\n    _cacheBust(uri) {\r\n        const query = /\\?\\w*=\\w*/;\r\n        if (query.test(uri)) {\r\n            uri += '&__=' + Date.now();\r\n        }\r\n        else {\r\n            uri += '?__=' + Date.now();\r\n        }\r\n        return uri;\r\n    }\r\n    /**\r\n     * Begin loading the resource and returns a promise to be resolved on completion\r\n     */\r\n    load() {\r\n        return new Promise((resolve, reject) => {\r\n            // Exit early if we already have data\r\n            if (this.data !== null) {\r\n                this.logger.debug('Already have data for resource', this.path);\r\n                this.events.emit('complete', this.data);\r\n                resolve(this.data);\r\n                return;\r\n            }\r\n            const request = new XMLHttpRequest();\r\n            request.open('GET', this.bustCache ? this._cacheBust(this.path) : this.path, true);\r\n            request.responseType = this.responseType;\r\n            request.addEventListener('loadstart', (e) => this.events.emit('loadstart', e));\r\n            request.addEventListener('progress', (e) => this.events.emit('progress', e));\r\n            request.addEventListener('error', (e) => this.events.emit('error', e));\r\n            request.addEventListener('load', (e) => this.events.emit('load', e));\r\n            request.addEventListener('load', () => {\r\n                // XHR on file:// success status is 0, such as with PhantomJS\r\n                if (request.status !== 0 && request.status !== 200) {\r\n                    this.logger.error('Failed to load resource ', this.path, ' server responded with error code', request.status);\r\n                    this.events.emit('error', request.response);\r\n                    reject(new Error(request.statusText));\r\n                    return;\r\n                }\r\n                this.data = request.response;\r\n                this.events.emit('complete', this.data);\r\n                this.logger.debug('Completed loading resource', this.path);\r\n                resolve(this.data);\r\n            });\r\n            request.send();\r\n        });\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Drawing/SpriteEffects.ts\n/**\r\n * @module\r\n * @deprecated\r\n * These effects can be applied to any bitmap image but are mainly used\r\n * for [[Sprite]] effects or [[Animation]] effects.\r\n */\r\nvar SpriteEffects_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n/**\r\n * @typedoc\r\n */\r\n\r\n\r\n/**\r\n * Applies the \"Grayscale\" effect to a sprite, removing color information.\r\n * @deprecated [[Grayscale]] will be removed in v0.26.0\r\n */\r\nlet Grayscale = class Grayscale {\r\n    updatePixel(x, y, imageData) {\r\n        const firstPixel = (x + y * imageData.width) * 4;\r\n        const pixel = imageData.data;\r\n        const avg = (pixel[firstPixel + 0] + pixel[firstPixel + 1] + pixel[firstPixel + 2]) / 3;\r\n        pixel[firstPixel + 0] = avg;\r\n        pixel[firstPixel + 1] = avg;\r\n        pixel[firstPixel + 2] = avg;\r\n    }\r\n};\r\nGrayscale = SpriteEffects_decorate([\r\n    obsolete({\r\n        message: 'Grayscale will be removed in v0.26.0'\r\n    })\r\n], Grayscale);\r\n\r\n/**\r\n * Applies the \"Invert\" effect to a sprite, inverting the pixel colors.\r\n * @deprecated [[Invert]] will be removed in v0.26.0\r\n */\r\nlet Invert = class Invert {\r\n    updatePixel(x, y, imageData) {\r\n        const firstPixel = (x + y * imageData.width) * 4;\r\n        const pixel = imageData.data;\r\n        pixel[firstPixel + 0] = 255 - pixel[firstPixel + 0];\r\n        pixel[firstPixel + 1] = 255 - pixel[firstPixel + 1];\r\n        pixel[firstPixel + 2] = 255 - pixel[firstPixel + 2];\r\n    }\r\n};\r\nInvert = SpriteEffects_decorate([\r\n    obsolete({\r\n        message: 'Invert will be removed in v0.26.0'\r\n    })\r\n], Invert);\r\n\r\n/**\r\n * Applies the \"Opacity\" effect to a sprite, setting the alpha of all pixels to a given value.\r\n * @deprecated [[Opacity]] will be removed in v0.26.0\r\n */\r\nlet Opacity = class Opacity {\r\n    /**\r\n     * @param opacity  The new opacity of the sprite from 0-1.0\r\n     */\r\n    constructor(opacity) {\r\n        this.opacity = opacity;\r\n    }\r\n    updatePixel(x, y, imageData) {\r\n        const firstPixel = (x + y * imageData.width) * 4;\r\n        const pixel = imageData.data;\r\n        if (pixel[firstPixel + 3] !== 0) {\r\n            pixel[firstPixel + 3] = Math.round(this.opacity * pixel[firstPixel + 3]);\r\n        }\r\n    }\r\n};\r\nOpacity = SpriteEffects_decorate([\r\n    obsolete({\r\n        message: 'Opacity will be removed in v0.26.0'\r\n    })\r\n], Opacity);\r\n\r\n/**\r\n * Applies the \"Colorize\" effect to a sprite, changing the color channels of all the pixels to an\r\n * average of the original color and the provided color\r\n * @deprecated [[Colorize]] will be removed in v0.26.0\r\n */\r\nlet Colorize = class Colorize {\r\n    /**\r\n     * @param color  The color to apply to the sprite\r\n     */\r\n    constructor(color) {\r\n        this.color = color;\r\n    }\r\n    updatePixel(x, y, imageData) {\r\n        const firstPixel = (x + y * imageData.width) * 4;\r\n        const pixel = imageData.data;\r\n        if (pixel[firstPixel + 3] !== 0) {\r\n            pixel[firstPixel + 0] = (pixel[firstPixel + 0] + this.color.r) / 2;\r\n            pixel[firstPixel + 1] = (pixel[firstPixel + 1] + this.color.g) / 2;\r\n            pixel[firstPixel + 2] = (pixel[firstPixel + 2] + this.color.b) / 2;\r\n        }\r\n    }\r\n};\r\nColorize = SpriteEffects_decorate([\r\n    obsolete({\r\n        message: 'Colorize will be removed in v0.26.0'\r\n    })\r\n], Colorize);\r\n\r\n/**\r\n * Applies the \"Lighten\" effect to a sprite, changes the lightness of the color according to HSL\r\n * @deprecated [[Lighten]] will be removed in v0.26.0\r\n */\r\nlet Lighten = class Lighten {\r\n    /**\r\n     * @param factor  The factor of the effect between 0-1\r\n     */\r\n    constructor(factor = 0.1) {\r\n        this.factor = factor;\r\n    }\r\n    updatePixel(x, y, imageData) {\r\n        const firstPixel = (x + y * imageData.width) * 4;\r\n        const pixel = imageData.data;\r\n        const color = Color.fromRGB(pixel[firstPixel + 0], pixel[firstPixel + 1], pixel[firstPixel + 2], pixel[firstPixel + 3]).lighten(this.factor);\r\n        pixel[firstPixel + 0] = color.r;\r\n        pixel[firstPixel + 1] = color.g;\r\n        pixel[firstPixel + 2] = color.b;\r\n        pixel[firstPixel + 3] = color.a;\r\n    }\r\n};\r\nLighten = SpriteEffects_decorate([\r\n    obsolete({\r\n        message: 'Lighten will be removed in v0.26.0'\r\n    })\r\n], Lighten);\r\n\r\n/**\r\n * Applies the \"Darken\" effect to a sprite, changes the darkness of the color according to HSL\r\n * @deprecated [[Darken]] will be removed in v0.26.0\r\n */\r\nlet Darken = class Darken {\r\n    /**\r\n     * @param factor  The factor of the effect between 0-1\r\n     */\r\n    constructor(factor = 0.1) {\r\n        this.factor = factor;\r\n    }\r\n    updatePixel(x, y, imageData) {\r\n        const firstPixel = (x + y * imageData.width) * 4;\r\n        const pixel = imageData.data;\r\n        const color = Color.fromRGB(pixel[firstPixel + 0], pixel[firstPixel + 1], pixel[firstPixel + 2], pixel[firstPixel + 3]).darken(this.factor);\r\n        pixel[firstPixel + 0] = color.r;\r\n        pixel[firstPixel + 1] = color.g;\r\n        pixel[firstPixel + 2] = color.b;\r\n        pixel[firstPixel + 3] = color.a;\r\n    }\r\n};\r\nDarken = SpriteEffects_decorate([\r\n    obsolete({\r\n        message: 'Darken will be removed v0.26.0'\r\n    })\r\n], Darken);\r\n\r\n/**\r\n * Applies the \"Saturate\" effect to a sprite, saturates the color according to HSL\r\n * @deprecated [[Saturate]] will be removed in v0.26.0\r\n */\r\nlet Saturate = class Saturate {\r\n    /**\r\n     * @param factor  The factor of the effect between 0-1\r\n     */\r\n    constructor(factor = 0.1) {\r\n        this.factor = factor;\r\n    }\r\n    updatePixel(x, y, imageData) {\r\n        const firstPixel = (x + y * imageData.width) * 4;\r\n        const pixel = imageData.data;\r\n        const color = Color.fromRGB(pixel[firstPixel + 0], pixel[firstPixel + 1], pixel[firstPixel + 2], pixel[firstPixel + 3]).saturate(this.factor);\r\n        pixel[firstPixel + 0] = color.r;\r\n        pixel[firstPixel + 1] = color.g;\r\n        pixel[firstPixel + 2] = color.b;\r\n        pixel[firstPixel + 3] = color.a;\r\n    }\r\n};\r\nSaturate = SpriteEffects_decorate([\r\n    obsolete({\r\n        message: 'Saturate will be removed in v0.26.0'\r\n    })\r\n], Saturate);\r\n\r\n/**\r\n * Applies the \"Desaturate\" effect to a sprite, desaturates the color according to HSL\r\n * @deprecated [[Desaturate]] will be removed in v0.26.0\r\n */\r\nlet Desaturate = class Desaturate {\r\n    /**\r\n     * @param factor  The factor of the effect between 0-1\r\n     */\r\n    constructor(factor = 0.1) {\r\n        this.factor = factor;\r\n    }\r\n    updatePixel(x, y, imageData) {\r\n        const firstPixel = (x + y * imageData.width) * 4;\r\n        const pixel = imageData.data;\r\n        const color = Color.fromRGB(pixel[firstPixel + 0], pixel[firstPixel + 1], pixel[firstPixel + 2], pixel[firstPixel + 3]).desaturate(this.factor);\r\n        pixel[firstPixel + 0] = color.r;\r\n        pixel[firstPixel + 1] = color.g;\r\n        pixel[firstPixel + 2] = color.b;\r\n        pixel[firstPixel + 3] = color.a;\r\n    }\r\n};\r\nDesaturate = SpriteEffects_decorate([\r\n    obsolete({\r\n        message: 'Desaturate will be removed in v0.26.0'\r\n    })\r\n], Desaturate);\r\n\r\n/**\r\n * Applies the \"Fill\" effect to a sprite, changing the color channels of all non-transparent pixels to match\r\n * a given color\r\n * @deprecated [[Fill]] will be removed in v0.26.0\r\n */\r\nlet Fill = class Fill {\r\n    /**\r\n     * @param color  The color to apply to the sprite\r\n     */\r\n    constructor(color) {\r\n        this.color = color;\r\n    }\r\n    updatePixel(x, y, imageData) {\r\n        const firstPixel = (x + y * imageData.width) * 4;\r\n        const pixel = imageData.data;\r\n        if (pixel[firstPixel + 3] !== 0) {\r\n            pixel[firstPixel + 0] = this.color.r;\r\n            pixel[firstPixel + 1] = this.color.g;\r\n            pixel[firstPixel + 2] = this.color.b;\r\n        }\r\n    }\r\n};\r\nFill = SpriteEffects_decorate([\r\n    obsolete({\r\n        message: 'Fill will be removed in v0.26.0'\r\n    })\r\n], Fill);\r\n\r\n\n;// CONCATENATED MODULE: ./Drawing/Texture.ts\n\r\n\r\n/**\r\n * The [[Texture]] object allows games built in Excalibur to load image resources.\r\n * [[Texture]] is an [[Loadable]] which means it can be passed to a [[Loader]]\r\n * to pre-load before starting a level or game.\r\n * @deprecated\r\n */\r\nclass Texture {\r\n    /**\r\n     * @param path       Path to the image resource or a base64 string representing an image \"data:image/png;base64,iVB...\"\r\n     * @param bustCache  Optionally load texture with cache busting\r\n     */\r\n    constructor(path, bustCache = true) {\r\n        this.path = path;\r\n        this.bustCache = bustCache;\r\n        this._sprite = null;\r\n        this.loaded = new Promise(resolve => {\r\n            this._loadedResolve = resolve;\r\n        });\r\n        this._resource = new Resource(path, 'blob', bustCache);\r\n        this._sprite = new Sprite_Sprite(this, 0, 0, 0, 0);\r\n    }\r\n    get image() {\r\n        return this.data;\r\n    }\r\n    /**\r\n     * Returns true if the Texture is completely loaded and is ready\r\n     * to be drawn.\r\n     */\r\n    isLoaded() {\r\n        return !!this.data;\r\n    }\r\n    /**\r\n     * Begins loading the texture and returns a promise to be resolved on completion\r\n     */\r\n    async load() {\r\n        try {\r\n            // Load base64 or blob if needed\r\n            let url;\r\n            if (!this.path.includes('data:image/')) {\r\n                const blob = await this._resource.load();\r\n                url = URL.createObjectURL(blob);\r\n            }\r\n            else {\r\n                url = this.path;\r\n            }\r\n            // Decode the image\r\n            const image = new Image();\r\n            image.src = url;\r\n            await image.decode();\r\n            // Set results\r\n            this.data = image;\r\n            this.width = this._sprite.width = image.naturalWidth;\r\n            this.height = this._sprite.height = image.naturalHeight;\r\n            this._sprite = new Sprite_Sprite(this, 0, 0, this.width, this.height);\r\n        }\r\n        catch (_a) {\r\n            await Promise.reject('Error loading texture');\r\n        }\r\n        // todo emit complete\r\n        this._loadedResolve(this.data);\r\n        return this.data;\r\n    }\r\n    asSprite() {\r\n        return this._sprite;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Configurable.ts\n/**\r\n * Configurable helper extends base type and makes all properties available as option bag arguments\r\n * @internal\r\n * @param base\r\n */\r\nfunction Configurable(base) {\r\n    return class extends base {\r\n        assign(props) {\r\n            //set the value of every property that was passed in,\r\n            //if the constructor previously set this value, it will be overridden here\r\n            for (const k in props) {\r\n                // eslint-disable-next-line\r\n                if (typeof this[k] !== 'function') {\r\n                    // eslint-disable-next-line\r\n                    this[k] = props[k];\r\n                }\r\n            }\r\n        }\r\n        constructor(...args) {\r\n            super(...args);\r\n            //get the number of arguments that aren't undefined. TS passes a value to all parameters\r\n            //of whatever ctor is the implementation, so args.length doesn't work here.\r\n            const size = args.filter(function (value) {\r\n                return value !== undefined;\r\n            }).length;\r\n            if (size === 1 && args[0] && typeof args[0] === 'object' && !(args[0] instanceof Array)) {\r\n                this.assign(args[0]);\r\n            }\r\n        }\r\n    };\r\n}\r\n\n;// CONCATENATED MODULE: ./Drawing/Sprite.ts\nvar Sprite_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * @hidden\r\n * @deprecated Use [[Sprite]]\r\n */\r\nclass SpriteImpl {\r\n    /**\r\n     * @param imageOrConfig  The backing image texture to build the Sprite, or Sprite option bag\r\n     * @param x      The x position of the sprite\r\n     * @param y      The y position of the sprite\r\n     * @param width  The width of the sprite in pixels\r\n     * @param height The height of the sprite in pixels\r\n     */\r\n    constructor(imageOrConfig, x, y, width, height) {\r\n        this.x = 0;\r\n        this.y = 0;\r\n        this.rotation = 0.0;\r\n        this.anchor = Vector.Half;\r\n        this.offset = Vector.Zero;\r\n        this.scale = Vector.One;\r\n        /**\r\n         * Default: false, should the sprite be drawn around the anchor or from the top left.\r\n         * Sprite rotations/scaling still happen around the anchor regardless of this setting.\r\n         */\r\n        this.drawAroundAnchor = false;\r\n        this.logger = Logger.getInstance();\r\n        /**\r\n         * Draws the sprite flipped vertically\r\n         */\r\n        this.flipVertical = false;\r\n        /**\r\n         * Draws the sprite flipped horizontally\r\n         */\r\n        this.flipHorizontal = false;\r\n        this.effects = [];\r\n        this.width = 0;\r\n        this.height = 0;\r\n        this._spriteCanvas = null;\r\n        this._spriteCtx = null;\r\n        this._pixelData = null;\r\n        this._pixelsLoaded = false;\r\n        this._dirtyEffect = true;\r\n        this._opacity = 1;\r\n        let image = imageOrConfig;\r\n        if (imageOrConfig && !(imageOrConfig instanceof Texture)) {\r\n            x = imageOrConfig.x | 0;\r\n            y = imageOrConfig.y | 0;\r\n            width = imageOrConfig.width | 0;\r\n            height = imageOrConfig.height | 0;\r\n            image = imageOrConfig.image;\r\n            if (!image) {\r\n                const message = 'An image texture is required to construct a sprite';\r\n                throw new Error(message);\r\n            }\r\n        }\r\n        this.x = x || 0;\r\n        this.y = y || 0;\r\n        this.texture = image;\r\n        this._spriteCanvas = document.createElement('canvas');\r\n        this._spriteCanvas.width = width;\r\n        this._spriteCanvas.height = height;\r\n        this._spriteCtx = this._spriteCanvas.getContext('2d');\r\n        this._initPixelsFromTexture();\r\n        this.width = width;\r\n        this.height = height;\r\n    }\r\n    get drawWidth() {\r\n        return Math.abs(this.width * this.scale.x);\r\n    }\r\n    get drawHeight() {\r\n        return Math.abs(this.height * this.scale.y);\r\n    }\r\n    async _initPixelsFromTexture() {\r\n        try {\r\n            const image = await this.texture.loaded;\r\n            this.width = this.width || image.naturalWidth;\r\n            this.height = this.height || image.naturalHeight;\r\n            this._spriteCanvas.width = this._spriteCanvas.width || image.naturalWidth;\r\n            this._spriteCanvas.height = this._spriteCanvas.height || image.naturalHeight;\r\n            this._loadPixels();\r\n            this._dirtyEffect = true;\r\n        }\r\n        catch (e) {\r\n            this.logger.error('Error loading texture ', this.texture.path, e);\r\n        }\r\n    }\r\n    _loadPixels() {\r\n        if (this.texture.isLoaded() && !this._pixelsLoaded) {\r\n            const naturalWidth = this.texture.image.naturalWidth || 0;\r\n            const naturalHeight = this.texture.image.naturalHeight || 0;\r\n            if (this.width > naturalWidth) {\r\n                this.logger.warn(`The sprite width ${this.width} exceeds the width \r\n                              ${naturalWidth} of the backing texture ${this.texture.path}`);\r\n            }\r\n            if (this.width <= 0 || naturalWidth <= 0) {\r\n                throw new Error(`The width of a sprite cannot be 0 or negative, sprite width: ${this.width}, original width: ${naturalWidth}`);\r\n            }\r\n            if (this.height > naturalHeight) {\r\n                this.logger.warn(`The sprite height ${this.height} exceeds the height \r\n                              ${naturalHeight} of the backing texture ${this.texture.path}`);\r\n            }\r\n            if (this.height <= 0 || naturalHeight <= 0) {\r\n                throw new Error(`The height of a sprite cannot be 0 or negative, sprite height: ${this.height}, original height: ${naturalHeight}`);\r\n            }\r\n            this._flushTexture();\r\n            this._pixelsLoaded = true;\r\n        }\r\n    }\r\n    _flushTexture() {\r\n        const naturalWidth = this.texture.image.naturalWidth || 0;\r\n        const naturalHeight = this.texture.image.naturalHeight || 0;\r\n        this._spriteCtx.clearRect(0, 0, this.width, this.height);\r\n        this._spriteCtx.drawImage(this.texture.image, clamp(this.x, 0, naturalWidth), clamp(this.y, 0, naturalHeight), clamp(this.width, 0, naturalWidth), clamp(this.height, 0, naturalHeight), 0, 0, this.width, this.height);\r\n    }\r\n    /**\r\n     * Applies the [[Opacity]] effect to a sprite, setting the alpha of all pixels to a given value\r\n     */\r\n    opacity(value) {\r\n        this._opacity = value;\r\n    }\r\n    /**\r\n     * Applies the [[Grayscale]] effect to a sprite, removing color information.\r\n     */\r\n    grayscale() {\r\n        this.addEffect(new Grayscale());\r\n    }\r\n    /**\r\n     * Applies the [[Invert]] effect to a sprite, inverting the pixel colors.\r\n     */\r\n    invert() {\r\n        this.addEffect(new Invert());\r\n    }\r\n    /**\r\n     * Applies the [[Fill]] effect to a sprite, changing the color channels of all non-transparent pixels to match a given color\r\n     */\r\n    fill(color) {\r\n        this.addEffect(new Fill(color));\r\n    }\r\n    /**\r\n     * Applies the [[Colorize]] effect to a sprite, changing the color channels of all pixels to be the average of the original color\r\n     * and the provided color.\r\n     */\r\n    colorize(color) {\r\n        this.addEffect(new Colorize(color));\r\n    }\r\n    /**\r\n     * Applies the [[Lighten]] effect to a sprite, changes the lightness of the color according to HSL\r\n     */\r\n    lighten(factor = 0.1) {\r\n        this.addEffect(new Lighten(factor));\r\n    }\r\n    /**\r\n     * Applies the [[Darken]] effect to a sprite, changes the darkness of the color according to HSL\r\n     */\r\n    darken(factor = 0.1) {\r\n        this.addEffect(new Darken(factor));\r\n    }\r\n    /**\r\n     * Applies the [[Saturate]] effect to a sprite, saturates the color according to HSL\r\n     */\r\n    saturate(factor = 0.1) {\r\n        this.addEffect(new Saturate(factor));\r\n    }\r\n    /**\r\n     * Applies the [[Desaturate]] effect to a sprite, desaturates the color according to HSL\r\n     */\r\n    desaturate(factor = 0.1) {\r\n        this.addEffect(new Desaturate(factor));\r\n    }\r\n    /**\r\n     * Adds a new [[SpriteEffect]] to this drawing.\r\n     * @param effect  Effect to add to the this drawing\r\n     */\r\n    addEffect(effect) {\r\n        this.effects.push(effect);\r\n        // We must check if the texture and the backing sprite pixels are loaded as well before\r\n        // an effect can be applied\r\n        if (!this.texture.isLoaded() || !this._pixelsLoaded) {\r\n            this._dirtyEffect = true;\r\n        }\r\n        else {\r\n            this._applyEffects();\r\n        }\r\n    }\r\n    removeEffect(param) {\r\n        let indexToRemove = -1;\r\n        if (typeof param === 'number') {\r\n            indexToRemove = param;\r\n        }\r\n        else {\r\n            indexToRemove = this.effects.indexOf(param);\r\n        }\r\n        // bounds check\r\n        if (indexToRemove < 0 || indexToRemove >= this.effects.length) {\r\n            return;\r\n        }\r\n        this.effects.splice(indexToRemove, 1);\r\n        // We must check if the texture and the backing sprite pixels are loaded as well before\r\n        // an effect can be applied\r\n        if (!this.texture.isLoaded() || !this._pixelsLoaded) {\r\n            this._dirtyEffect = true;\r\n        }\r\n        else {\r\n            this._applyEffects();\r\n        }\r\n    }\r\n    _applyEffects() {\r\n        this._flushTexture();\r\n        if (this.effects.length > 0) {\r\n            this._pixelData = this._spriteCtx.getImageData(0, 0, this.width, this.height);\r\n            const len = this.effects.length;\r\n            for (let i = 0; i < len; i++) {\r\n                for (let y = 0; y < this.height; y++) {\r\n                    for (let x = 0; x < this.width; x++) {\r\n                        this.effects[i].updatePixel(x, y, this._pixelData);\r\n                    }\r\n                }\r\n            }\r\n            this._spriteCtx.clearRect(0, 0, this.width, this.height);\r\n            this._spriteCtx.putImageData(this._pixelData, 0, 0);\r\n        }\r\n        this._dirtyEffect = false;\r\n    }\r\n    /**\r\n     * Clears all effects from the drawing and return it to its original state.\r\n     */\r\n    clearEffects() {\r\n        this.effects.length = 0;\r\n        this._applyEffects();\r\n    }\r\n    /**\r\n     * Resets the internal state of the drawing (if any)\r\n     */\r\n    reset() {\r\n        // do nothing\r\n    }\r\n    debugDraw(ctx, x, y) {\r\n        ctx.save();\r\n        ctx.translate(x, y);\r\n        ctx.rotate(this.rotation);\r\n        const xpoint = this.drawWidth * this.anchor.x;\r\n        const ypoint = this.drawHeight * this.anchor.y;\r\n        ctx.strokeStyle = Color.Black.toString();\r\n        ctx.strokeRect(-xpoint, -ypoint, this.drawWidth, this.drawHeight);\r\n        ctx.restore();\r\n    }\r\n    draw(ctxOrOptions, x, y) {\r\n        if (ctxOrOptions instanceof CanvasRenderingContext2D) {\r\n            this._drawWithOptions({ ctx: ctxOrOptions, x, y });\r\n        }\r\n        else {\r\n            this._drawWithOptions(ctxOrOptions);\r\n        }\r\n    }\r\n    _drawWithOptions(options) {\r\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j;\r\n        const { ctx, x, y, rotation, drawWidth, drawHeight, anchor, offset, opacity, flipHorizontal, flipVertical } = {\r\n            ...options,\r\n            rotation: (_a = options.rotation) !== null && _a !== void 0 ? _a : this.rotation,\r\n            drawWidth: (_b = options.drawWidth) !== null && _b !== void 0 ? _b : this.width,\r\n            drawHeight: (_c = options.drawHeight) !== null && _c !== void 0 ? _c : this.height,\r\n            flipHorizontal: (_d = options.flipHorizontal) !== null && _d !== void 0 ? _d : this.flipHorizontal,\r\n            flipVertical: (_e = options.flipVertical) !== null && _e !== void 0 ? _e : this.flipVertical,\r\n            anchor: (_f = options.anchor) !== null && _f !== void 0 ? _f : this.anchor,\r\n            offset: (_g = options.offset) !== null && _g !== void 0 ? _g : this.offset,\r\n            opacity: ((_h = options.opacity) !== null && _h !== void 0 ? _h : 1) * ((_j = this._opacity) !== null && _j !== void 0 ? _j : 1)\r\n        };\r\n        if (this._dirtyEffect) {\r\n            this._applyEffects();\r\n        }\r\n        // calculating current dimensions\r\n        const anchorX = drawWidth * anchor.x + offset.x;\r\n        const anchorY = drawHeight * anchor.y + offset.y;\r\n        const scaleDirX = this.scale.x > 0 ? 1 : -1;\r\n        const scaleDirY = this.scale.y > 0 ? 1 : -1;\r\n        ctx.save();\r\n        // Move the draw point of origin\r\n        ctx.translate(x, y);\r\n        // Rotate and scale around anchor point\r\n        // This requires a bit of explaination, scale coordinates first positive flipping or rotating\r\n        ctx.scale(Math.abs(this.scale.x), Math.abs(this.scale.y));\r\n        if (this.drawAroundAnchor) {\r\n            // In the case where you want the anchor to match with the point of draw\r\n            // Otherwise sprites are always drawn from top-left\r\n            ctx.translate(-anchorX, -anchorY);\r\n        }\r\n        ctx.translate(anchorX, anchorY);\r\n        ctx.rotate(rotation);\r\n        // This is for handling direction changes 1 or -1, that way we don't have mismatched translates()\r\n        ctx.scale(scaleDirX, scaleDirY);\r\n        ctx.translate(-anchorX, -anchorY);\r\n        if (flipHorizontal) {\r\n            ctx.translate(drawWidth, 0);\r\n            ctx.scale(-1, 1);\r\n        }\r\n        if (flipVertical) {\r\n            ctx.translate(0, drawHeight);\r\n            ctx.scale(1, -1);\r\n        }\r\n        const oldAlpha = ctx.globalAlpha;\r\n        ctx.globalAlpha = opacity;\r\n        // Context is already rotated and scaled\r\n        ctx.drawImage(this._spriteCanvas, 0, 0, this.width, this.height, // source\r\n        0, 0, this.width, this.height); // dest\r\n        ctx.globalAlpha = oldAlpha;\r\n        ctx.restore();\r\n    }\r\n    /**\r\n     * Produces a copy of the current sprite\r\n     */\r\n    clone() {\r\n        const result = new Sprite_Sprite(this.texture, this.x, this.y, this.width, this.height);\r\n        result.anchor = this.anchor.clone();\r\n        result.scale = this.scale.clone();\r\n        result.rotation = this.rotation;\r\n        result.flipHorizontal = this.flipHorizontal;\r\n        result.flipVertical = this.flipVertical;\r\n        const len = this.effects.length;\r\n        for (let i = 0; i < len; i++) {\r\n            result.addEffect(this.effects[i]);\r\n        }\r\n        return result;\r\n    }\r\n}\r\n/**\r\n * A [[LegacyDrawing.Sprite]] is one of the main drawing primitives. It is responsible for drawing\r\n * images or parts of images from a [[LegacyDrawing.Texture]] resource to the screen.\r\n * @deprecated Use [[Sprite]]\r\n */\r\nlet Sprite_Sprite = class Sprite extends Configurable(SpriteImpl) {\r\n    constructor(imageOrConfig, x, y, width, height) {\r\n        super(imageOrConfig, x, y, width, height);\r\n    }\r\n};\r\nSprite_Sprite = Sprite_decorate([\r\n    obsolete({\r\n        message: 'Label.clearTextShadow will be removed in v0.26.0',\r\n        alternateMethod: 'Use Label.font.shadow'\r\n    })\r\n], Sprite_Sprite);\r\n\r\n\n;// CONCATENATED MODULE: ./Graphics/Sprite.ts\n\r\n\r\n\r\n\r\nclass Sprite extends Graphic {\r\n    constructor(options) {\r\n        var _a, _b;\r\n        super(options);\r\n        this._dirty = true;\r\n        this.image = options.image;\r\n        const { width, height } = options;\r\n        this.sourceView = (_a = options.sourceView) !== null && _a !== void 0 ? _a : { x: 0, y: 0, width: width !== null && width !== void 0 ? width : 0, height: height !== null && height !== void 0 ? height : 0 };\r\n        this.destSize = (_b = options.destSize) !== null && _b !== void 0 ? _b : { width: width !== null && width !== void 0 ? width : 0, height: height !== null && height !== void 0 ? height : 0 };\r\n        this._updateSpriteDimensions();\r\n        this.image.ready.then(() => {\r\n            this._updateSpriteDimensions();\r\n        });\r\n    }\r\n    static from(image) {\r\n        return new Sprite({\r\n            image: image\r\n        });\r\n    }\r\n    get width() {\r\n        return Math.abs(this.destSize.width * this.scale.x);\r\n    }\r\n    get height() {\r\n        return Math.abs(this.destSize.height * this.scale.y);\r\n    }\r\n    set width(newWidth) {\r\n        newWidth /= Math.abs(this.scale.x);\r\n        this.destSize.width = newWidth;\r\n        super.width = Math.ceil(this.destSize.width);\r\n    }\r\n    set height(newHeight) {\r\n        newHeight /= Math.abs(this.scale.y);\r\n        this.destSize.height = newHeight;\r\n        super.height = Math.ceil(this.destSize.height);\r\n    }\r\n    _updateSpriteDimensions() {\r\n        var _a, _b, _c, _d, _e, _f;\r\n        const { width: nativeWidth, height: nativeHeight } = this.image;\r\n        // This code uses || to avoid 0's\r\n        // If the source is not specified, use the native dimension\r\n        this.sourceView.width = ((_a = this.sourceView) === null || _a === void 0 ? void 0 : _a.width) || nativeWidth;\r\n        this.sourceView.height = ((_b = this.sourceView) === null || _b === void 0 ? void 0 : _b.height) || nativeHeight;\r\n        // If the destination is not specified, use the source if specified, then native\r\n        this.destSize.width = ((_c = this.destSize) === null || _c === void 0 ? void 0 : _c.width) || ((_d = this.sourceView) === null || _d === void 0 ? void 0 : _d.width) || nativeWidth;\r\n        this.destSize.height = ((_e = this.destSize) === null || _e === void 0 ? void 0 : _e.height) || ((_f = this.sourceView) === null || _f === void 0 ? void 0 : _f.height) || nativeHeight;\r\n        this.width = Math.ceil(this.destSize.width) * this.scale.x;\r\n        this.height = Math.ceil(this.destSize.height) * this.scale.y;\r\n    }\r\n    _preDraw(ex, x, y) {\r\n        if (this.image.isLoaded() && this._dirty) {\r\n            this._dirty = false;\r\n            this._updateSpriteDimensions();\r\n        }\r\n        super._preDraw(ex, x, y);\r\n    }\r\n    _drawImage(ex, x, y) {\r\n        if (this.image.isLoaded()) {\r\n            ex.drawImage(this.image.image, this.sourceView.x, this.sourceView.y, this.sourceView.width, this.sourceView.height, x, y, this.destSize.width, this.destSize.height);\r\n        }\r\n    }\r\n    /**\r\n     * Create a ImageSource from legacy texture\r\n     * @param sprite\r\n     */\r\n    static fromLegacySprite(sprite) {\r\n        const tex = sprite.texture;\r\n        const image = ImageSource.fromLegacyTexture(tex);\r\n        return new Sprite({\r\n            image,\r\n            sourceView: {\r\n                x: sprite.x,\r\n                y: sprite.y,\r\n                width: sprite.width,\r\n                height: sprite.height\r\n            }\r\n        });\r\n    }\r\n    /**\r\n     * Converts a sprite to a Legacy sprite\r\n     * @deprecated\r\n     * @param sprite\r\n     * @returns LegacyDrawing.Sprite\r\n     */\r\n    static toLegacySprite(sprite) {\r\n        const image = sprite.image;\r\n        const tex = new Texture(image.path);\r\n        tex.data = image.image;\r\n        return new Sprite_Sprite(tex, sprite.sourceView.x, sprite.sourceView.y, sprite.sourceView.width, sprite.sourceView.height);\r\n    }\r\n    clone() {\r\n        return new Sprite({\r\n            image: this.image,\r\n            sourceView: { ...this.sourceView },\r\n            destSize: { ...this.destSize },\r\n            ...this.cloneGraphicOptions()\r\n        });\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/ImageSource.ts\n\r\n\r\n\r\n\r\nclass ImageSource {\r\n    /**\r\n     * The path to the image, can also be a data url like 'data:image/'\r\n     * @param path {string} Path to the image resource relative from the HTML document hosting the game, or absolute\r\n     * @param bustCache {boolean} Should excalibur add a cache busting querystring?\r\n     * @param filtering {ImageFiltering} Optionally override the image filtering set by [[EngineOptions.antialiasing]]\r\n     */\r\n    constructor(path, bustCache = false, filtering) {\r\n        this.path = path;\r\n        this._logger = Logger.getInstance();\r\n        /**\r\n         * Access to the underlying html image element\r\n         */\r\n        this.data = new Image();\r\n        this._resource = new Resource(path, 'blob', bustCache);\r\n        this._filtering = filtering;\r\n        if (path.endsWith('.svg') || path.endsWith('.gif')) {\r\n            this._logger.warn(`Image type is not fully supported, you may have mixed results ${path}. Fully supported: jpg, bmp, and png`);\r\n        }\r\n        this.ready = new Promise((resolve) => {\r\n            this._loadedResolve = resolve;\r\n        });\r\n    }\r\n    /**\r\n     * The original size of the source image in pixels\r\n     */\r\n    get width() {\r\n        return this.image.naturalWidth;\r\n    }\r\n    /**\r\n     * The original height of the source image in pixels\r\n     */\r\n    get height() {\r\n        return this.image.naturalHeight;\r\n    }\r\n    /**\r\n     * Returns true if the Texture is completely loaded and is ready\r\n     * to be drawn.\r\n     */\r\n    isLoaded() {\r\n        if (!this._src) {\r\n            // this boosts speed of access\r\n            this._src = this.data.src;\r\n        }\r\n        return !!this._src;\r\n    }\r\n    get image() {\r\n        return this.data;\r\n    }\r\n    /**\r\n     * Begins loading the image and returns a promise that resolves when the image is loaded\r\n     */\r\n    async load() {\r\n        if (this.isLoaded()) {\r\n            return this.data;\r\n        }\r\n        try {\r\n            // Load base64 or blob if needed\r\n            let url;\r\n            if (!this.path.includes('data:image/')) {\r\n                const blob = await this._resource.load();\r\n                url = URL.createObjectURL(blob);\r\n            }\r\n            else {\r\n                url = this.path;\r\n            }\r\n            // Decode the image\r\n            const image = new Image();\r\n            image.src = url;\r\n            await image.decode();\r\n            // Set results\r\n            this.data = image;\r\n        }\r\n        catch (error) {\r\n            throw `Error loading ImageSource from path '${this.path}' with error [${error.message}]`;\r\n        }\r\n        TextureLoader.load(this.data, this._filtering);\r\n        // todo emit complete\r\n        this._loadedResolve(this.data);\r\n        return this.data;\r\n    }\r\n    /**\r\n     * Build a sprite from this ImageSource\r\n     */\r\n    toSprite() {\r\n        return Sprite.from(this);\r\n    }\r\n    /**\r\n     * Create a ImageSource from legacy texture\r\n     * @param tex\r\n     */\r\n    static fromLegacyTexture(tex) {\r\n        const image = new ImageSource(tex.path);\r\n        if (tex.isLoaded()) {\r\n            image.data = tex.data;\r\n        }\r\n        else {\r\n            tex.loaded.then(() => {\r\n                image.data = tex.data;\r\n            });\r\n        }\r\n        return image;\r\n    }\r\n    /**\r\n     * Unload images from memory\r\n     */\r\n    unload() {\r\n        this.data = new Image();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Drawing/Animation.ts\nvar Animation_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * @hidden\r\n * @deprecated Use [[Animation]]\r\n */\r\nclass AnimationImpl {\r\n    /**\r\n     * Typically you will use a [[SpriteSheet]] to generate an [[Animation]].\r\n     *\r\n     * @param engineOrConfig  Reference to the current game engine\r\n     * @param sprites  An array of sprites to create the frames for the animation\r\n     * @param speed   The number in milliseconds to display each frame in the animation\r\n     * @param loop    Indicates whether the animation should loop after it is completed\r\n     */\r\n    constructor(engineOrConfig, sprites, speed, loop) {\r\n        /**\r\n         * The sprite frames to play, in order. See [[SpriteSheet.getAnimationForAll]] to quickly\r\n         * generate an [[Animation]].\r\n         */\r\n        this.sprites = [];\r\n        /**\r\n         * Current frame index being shown\r\n         */\r\n        this.currentFrame = 0;\r\n        this._timeLeftInFrame = 0;\r\n        this._idempotencyToken = -1;\r\n        this.anchor = Vector.Zero;\r\n        this.rotation = 0.0;\r\n        this.scale = Vector.One;\r\n        /**\r\n         * Indicates whether the animation should loop after it is completed\r\n         */\r\n        this.loop = true;\r\n        /**\r\n         * Indicates the frame index the animation should freeze on for a non-looping\r\n         * animation. By default it is the last frame.\r\n         */\r\n        this.freezeFrame = -1;\r\n        /**\r\n         * Flip each frame vertically. Sets [[Sprite.flipVertical]].\r\n         */\r\n        this.flipVertical = false;\r\n        /**\r\n         * Flip each frame horizontally. Sets [[Sprite.flipHorizontal]].\r\n         */\r\n        this.flipHorizontal = false;\r\n        this.drawWidth = 0;\r\n        this.drawHeight = 0;\r\n        this.width = 0;\r\n        this.height = 0;\r\n        this._opacity = 1;\r\n        let engine = engineOrConfig;\r\n        if (engineOrConfig && !(engineOrConfig instanceof Engine)) {\r\n            const config = engineOrConfig;\r\n            engine = config.engine;\r\n            sprites = config.sprites;\r\n            speed = config.speed;\r\n            loop = config.loop;\r\n        }\r\n        this.sprites = sprites;\r\n        this.speed = speed;\r\n        this._engine = engine;\r\n        this._timeLeftInFrame = this.speed;\r\n        if (loop != null) {\r\n            this.loop = loop;\r\n        }\r\n        if (sprites && sprites[0]) {\r\n            this.drawHeight = sprites[0] ? sprites[0].drawHeight : 0;\r\n            this.drawWidth = sprites[0] ? sprites[0].drawWidth : 0;\r\n            this.width = sprites[0] ? sprites[0].width : 0;\r\n            this.height = sprites[0] ? sprites[0].height : 0;\r\n            this.freezeFrame = sprites.length - 1;\r\n        }\r\n    }\r\n    /**\r\n     * Applies the opacity effect to a sprite, setting the alpha of all pixels to a given value\r\n     */\r\n    opacity(value) {\r\n        this._opacity = value;\r\n    }\r\n    /**\r\n     * Applies the grayscale effect to a sprite, removing color information.\r\n     */\r\n    grayscale() {\r\n        this.addEffect(new Grayscale());\r\n    }\r\n    /**\r\n     * Applies the invert effect to a sprite, inverting the pixel colors.\r\n     */\r\n    invert() {\r\n        this.addEffect(new Invert());\r\n    }\r\n    /**\r\n     * Applies the fill effect to a sprite, changing the color channels of all non-transparent pixels to match a given color\r\n     */\r\n    fill(color) {\r\n        this.addEffect(new Fill(color));\r\n    }\r\n    /**\r\n     * Applies the colorize effect to a sprite, changing the color channels of all pixels to be the average of the original color and the\r\n     * provided color.\r\n     */\r\n    colorize(color) {\r\n        this.addEffect(new Colorize(color));\r\n    }\r\n    /**\r\n     * Applies the lighten effect to a sprite, changes the lightness of the color according to hsl\r\n     */\r\n    lighten(factor = 0.1) {\r\n        this.addEffect(new Lighten(factor));\r\n    }\r\n    /**\r\n     * Applies the darken effect to a sprite, changes the darkness of the color according to hsl\r\n     */\r\n    darken(factor = 0.1) {\r\n        this.addEffect(new Darken(factor));\r\n    }\r\n    /**\r\n     * Applies the saturate effect to a sprite, saturates the color according to hsl\r\n     */\r\n    saturate(factor = 0.1) {\r\n        this.addEffect(new Saturate(factor));\r\n    }\r\n    /**\r\n     * Applies the desaturate effect to a sprite, desaturates the color according to hsl\r\n     */\r\n    desaturate(factor = 0.1) {\r\n        this.addEffect(new Desaturate(factor));\r\n    }\r\n    /**\r\n     * Add a [[SpriteEffect]] manually\r\n     */\r\n    addEffect(effect) {\r\n        for (const i in this.sprites) {\r\n            this.sprites[i].addEffect(effect);\r\n        }\r\n    }\r\n    removeEffect(param) {\r\n        for (const i in this.sprites) {\r\n            this.sprites[i].removeEffect(param);\r\n        }\r\n    }\r\n    /**\r\n     * Clear all sprite effects\r\n     */\r\n    clearEffects() {\r\n        for (const i in this.sprites) {\r\n            this.sprites[i].clearEffects();\r\n        }\r\n    }\r\n    _setAnchor(point) {\r\n        //if (!this.anchor.equals(point)) {\r\n        for (const i in this.sprites) {\r\n            this.sprites[i].anchor.setTo(point.x, point.y);\r\n        }\r\n        //}\r\n    }\r\n    _setRotation(radians) {\r\n        //if (this.rotation !== radians) {\r\n        for (const i in this.sprites) {\r\n            this.sprites[i].rotation = radians;\r\n        }\r\n        //}\r\n    }\r\n    _setScale(scale) {\r\n        //if (!this.scale.equals(scale)) {\r\n        for (const i in this.sprites) {\r\n            this.sprites[i].scale = scale;\r\n        }\r\n        //}\r\n    }\r\n    /**\r\n     * Resets the animation to first frame.\r\n     */\r\n    reset() {\r\n        this.currentFrame = 0;\r\n    }\r\n    /**\r\n     * Indicates whether the animation is complete, animations that loop are never complete.\r\n     */\r\n    isDone() {\r\n        return !this.loop && this.currentFrame >= this.sprites.length;\r\n    }\r\n    /**\r\n     * Not meant to be called by game developers. Ticks the animation forward internally and\r\n     * calculates whether to change to the frame.\r\n     * @internal\r\n     */\r\n    tick(elapsed, idempotencyToken) {\r\n        if (this._idempotencyToken === idempotencyToken) {\r\n            return;\r\n        }\r\n        this._idempotencyToken = idempotencyToken;\r\n        this._timeLeftInFrame -= elapsed;\r\n        if (this._timeLeftInFrame <= 0) {\r\n            this.currentFrame = this.loop ? (this.currentFrame + 1) % this.sprites.length : this.currentFrame + 1;\r\n            this._timeLeftInFrame = this.speed;\r\n        }\r\n        this._updateValues();\r\n        const current = this.sprites[this.currentFrame];\r\n        if (current) {\r\n            this.width = current.width;\r\n            this.height = current.height;\r\n            this.drawWidth = current.drawWidth;\r\n            this.drawHeight = current.drawHeight;\r\n        }\r\n    }\r\n    _updateValues() {\r\n        this._setAnchor(this.anchor);\r\n        this._setRotation(this.rotation);\r\n        this._setScale(this.scale);\r\n    }\r\n    /**\r\n     * Skips ahead a specified number of frames in the animation\r\n     * @param frames  Frames to skip ahead\r\n     */\r\n    skip(frames) {\r\n        this.currentFrame = (this.currentFrame + frames) % this.sprites.length;\r\n    }\r\n    draw(ctxOrOptions, x, y) {\r\n        if (ctxOrOptions instanceof CanvasRenderingContext2D) {\r\n            this._drawWithOptions({ ctx: ctxOrOptions, x, y });\r\n        }\r\n        else {\r\n            this._drawWithOptions(ctxOrOptions);\r\n        }\r\n    }\r\n    _drawWithOptions(options) {\r\n        var _a, _b, _c, _d, _e, _f, _g, _h;\r\n        const animOptions = {\r\n            ...options,\r\n            rotation: (_a = options.rotation) !== null && _a !== void 0 ? _a : this.rotation,\r\n            drawWidth: (_b = options.drawWidth) !== null && _b !== void 0 ? _b : this.drawWidth,\r\n            drawHeight: (_c = options.drawHeight) !== null && _c !== void 0 ? _c : this.drawHeight,\r\n            flipHorizontal: (_d = options.flipHorizontal) !== null && _d !== void 0 ? _d : this.flipHorizontal,\r\n            flipVertical: (_e = options.flipVertical) !== null && _e !== void 0 ? _e : this.flipVertical,\r\n            anchor: (_f = options.anchor) !== null && _f !== void 0 ? _f : this.anchor,\r\n            opacity: ((_g = options.opacity) !== null && _g !== void 0 ? _g : 1) * ((_h = this._opacity) !== null && _h !== void 0 ? _h : 1)\r\n        };\r\n        this._updateValues();\r\n        let currSprite;\r\n        if (this.currentFrame < this.sprites.length) {\r\n            currSprite = this.sprites[this.currentFrame];\r\n            currSprite.draw(animOptions);\r\n        }\r\n        if (this.freezeFrame !== -1 && this.currentFrame >= this.sprites.length) {\r\n            currSprite = this.sprites[clamp(this.freezeFrame, 0, this.sprites.length - 1)];\r\n            currSprite.draw(animOptions);\r\n        }\r\n        // add the calculated width\r\n        if (currSprite) {\r\n            this.drawWidth = currSprite.drawWidth;\r\n            this.drawHeight = currSprite.drawHeight;\r\n        }\r\n    }\r\n    /**\r\n     * Plays an animation at an arbitrary location in the game.\r\n     * @param x  The x position in the game to play\r\n     * @param y  The y position in the game to play\r\n     */\r\n    play(x, y) {\r\n        this.reset();\r\n        this._engine.playAnimation(this, x, y);\r\n    }\r\n}\r\n/**\r\n * Animations allow you to display a series of images one after another,\r\n * creating the illusion of change. Generally these images will come from a [[SpriteSheet]] source.\r\n * @deprecated Use [[Animation]]\r\n */\r\nlet Animation_Animation = class Animation extends Configurable(AnimationImpl) {\r\n    constructor(engineOrConfig, images, speed, loop) {\r\n        super(engineOrConfig, images, speed, loop);\r\n    }\r\n};\r\nAnimation_Animation = Animation_decorate([\r\n    obsolete({\r\n        message: 'Animation will be removed in v0.26.0',\r\n        alternateMethod: 'Use Graphics.Animation'\r\n    })\r\n], Animation_Animation);\r\n\r\n\n;// CONCATENATED MODULE: ./Graphics/FontCommon.ts\n/**\r\n * Enum representing the different font size units\r\n * https://developer.mozilla.org/en-US/docs/Web/CSS/font-size\r\n */\r\nvar FontUnit;\r\n(function (FontUnit) {\r\n    /**\r\n     * Em is a scalable unit, 1 em is equal to the current font size of the current element, parent elements can effect em values\r\n     */\r\n    FontUnit[\"Em\"] = \"em\";\r\n    /**\r\n     * Rem is similar to the Em, it is a scalable unit. 1 rem is equal to the font size of the root element\r\n     */\r\n    FontUnit[\"Rem\"] = \"rem\";\r\n    /**\r\n     * Pixel is a unit of length in screen pixels\r\n     */\r\n    FontUnit[\"Px\"] = \"px\";\r\n    /**\r\n     * Point is a physical unit length (1/72 of an inch)\r\n     */\r\n    FontUnit[\"Pt\"] = \"pt\";\r\n    /**\r\n     * Percent is a scalable unit similar to Em, the only difference is the Em units scale faster when Text-Size stuff\r\n     */\r\n    FontUnit[\"Percent\"] = \"%\";\r\n})(FontUnit || (FontUnit = {}));\r\n/**\r\n * Enum representing the different horizontal text alignments\r\n */\r\nvar TextAlign;\r\n(function (TextAlign) {\r\n    /**\r\n     * The text is left-aligned.\r\n     */\r\n    TextAlign[\"Left\"] = \"left\";\r\n    /**\r\n     * The text is right-aligned.\r\n     */\r\n    TextAlign[\"Right\"] = \"right\";\r\n    /**\r\n     * The text is centered.\r\n     */\r\n    TextAlign[\"Center\"] = \"center\";\r\n    /**\r\n     * The text is aligned at the normal start of the line (left-aligned for left-to-right locales,\r\n     * right-aligned for right-to-left locales).\r\n     */\r\n    TextAlign[\"Start\"] = \"start\";\r\n    /**\r\n     * The text is aligned at the normal end of the line (right-aligned for left-to-right locales,\r\n     * left-aligned for right-to-left locales).\r\n     */\r\n    TextAlign[\"End\"] = \"end\";\r\n})(TextAlign || (TextAlign = {}));\r\n/**\r\n * Enum representing the different baseline text alignments\r\n */\r\nvar BaseAlign;\r\n(function (BaseAlign) {\r\n    /**\r\n     * The text baseline is the top of the em square.\r\n     */\r\n    BaseAlign[\"Top\"] = \"top\";\r\n    /**\r\n     * The text baseline is the hanging baseline.  Currently unsupported; this will act like\r\n     * alphabetic.\r\n     */\r\n    BaseAlign[\"Hanging\"] = \"hanging\";\r\n    /**\r\n     * The text baseline is the middle of the em square.\r\n     */\r\n    BaseAlign[\"Middle\"] = \"middle\";\r\n    /**\r\n     * The text baseline is the normal alphabetic baseline.\r\n     */\r\n    BaseAlign[\"Alphabetic\"] = \"alphabetic\";\r\n    /**\r\n     * The text baseline is the ideographic baseline; this is the bottom of\r\n     * the body of the characters, if the main body of characters protrudes\r\n     * beneath the alphabetic baseline.  Currently unsupported; this will\r\n     * act like alphabetic.\r\n     */\r\n    BaseAlign[\"Ideographic\"] = \"ideographic\";\r\n    /**\r\n     * The text baseline is the bottom of the bounding box.  This differs\r\n     * from the ideographic baseline in that the ideographic baseline\r\n     * doesn't consider descenders.\r\n     */\r\n    BaseAlign[\"Bottom\"] = \"bottom\";\r\n})(BaseAlign || (BaseAlign = {}));\r\n/**\r\n * Enum representing the different possible font styles\r\n */\r\nvar FontStyle;\r\n(function (FontStyle) {\r\n    FontStyle[\"Normal\"] = \"normal\";\r\n    FontStyle[\"Italic\"] = \"italic\";\r\n    FontStyle[\"Oblique\"] = \"oblique\";\r\n})(FontStyle || (FontStyle = {}));\r\n/**\r\n * Enum representing the text direction, useful for other languages, or writing text in reverse\r\n */\r\nvar Direction;\r\n(function (Direction) {\r\n    Direction[\"LeftToRight\"] = \"ltr\";\r\n    Direction[\"RightToLeft\"] = \"rtl\";\r\n})(Direction || (Direction = {}));\r\n\n;// CONCATENATED MODULE: ./Drawing/SpriteSheet.ts\nvar SpriteSheet_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Sprite sheets are a useful mechanism for slicing up image resources into\r\n * separate sprites or for generating in game animations. [[Sprite|Sprites]] are organized\r\n * in row major order in the [[SpriteSheet]].\r\n * @deprecated Will be removed in v0.26.0\r\n */\r\nclass SpriteSheet_SpriteSheet {\r\n    /**\r\n     * @param imageOrConfigOrSprites The backing image texture to build the SpriteSheet, option bag, or sprite list\r\n     * @param columns   The number of columns in the image texture\r\n     * @param rows      The number of rows in the image texture\r\n     * @param spWidth   The width of each individual sprite in pixels\r\n     * @param spHeight  The height of each individual sprite in pixels\r\n     * @param spacing   The spacing between every sprite in a spritesheet\r\n     */\r\n    constructor(imageOrConfigOrSprites, columns, rows, spWidth, spHeight, spacing) {\r\n        this._sprites = [];\r\n        this._image = null;\r\n        this._columns = 0;\r\n        this._rows = 0;\r\n        this._spWidth = 0;\r\n        this._spHeight = 0;\r\n        this._spacing = 0;\r\n        let loadFromImage = false;\r\n        if (imageOrConfigOrSprites instanceof Array) {\r\n            this._sprites = imageOrConfigOrSprites;\r\n        }\r\n        else {\r\n            if (imageOrConfigOrSprites && !(imageOrConfigOrSprites instanceof Texture)) {\r\n                this._columns = imageOrConfigOrSprites.columns;\r\n                this._rows = imageOrConfigOrSprites.rows;\r\n                this._spWidth = imageOrConfigOrSprites.spWidth;\r\n                this._spHeight = imageOrConfigOrSprites.spHeight;\r\n                this._image = imageOrConfigOrSprites.image;\r\n                this._spacing = imageOrConfigOrSprites.spacing || 0;\r\n            }\r\n            else {\r\n                this._image = imageOrConfigOrSprites;\r\n                this._columns = columns;\r\n                this._rows = rows;\r\n                this._spWidth = spWidth;\r\n                this._spHeight = spHeight;\r\n                this._spacing = spacing || 0;\r\n            }\r\n            this._sprites = new Array(this._columns * this._rows);\r\n            loadFromImage = true;\r\n        }\r\n        // Inspect actual image dimensions with preloading\r\n        if (this.image instanceof Texture) {\r\n            let isWidthError = false;\r\n            let isHeightError = false;\r\n            if (this.image.isLoaded()) {\r\n                isWidthError = this.spWidth * this.columns > this.image.image.naturalWidth;\r\n                isHeightError = this.spHeight * this.rows > this.image.image.naturalHeight;\r\n                if (isWidthError) {\r\n                    throw new RangeError(`SpriteSheet specified is wider, ` +\r\n                        `${this.columns} cols x ${this.spWidth} pixels > ${this.image.image.naturalWidth} ` +\r\n                        `pixels than image width`);\r\n                }\r\n                if (isHeightError) {\r\n                    throw new RangeError(`SpriteSheet specified is taller, ` +\r\n                        `${this.rows} rows x ${this.spHeight} pixels > ${this.image.image.naturalHeight} ` +\r\n                        `pixels than image height`);\r\n                }\r\n            }\r\n        }\r\n        if (loadFromImage) {\r\n            const spacing = this.getSpacingDimensions();\r\n            for (let row = 0; row < this.rows; row++) {\r\n                for (let col = 0; col < this.columns; col++) {\r\n                    this._sprites[col + row * this.columns] = new Sprite_Sprite(this.image, col * this.spWidth + spacing.margin * col + spacing.left, row * this.spHeight + spacing.margin * row + spacing.top, this.spWidth, this.spHeight);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Gets the raw spacing dimensions for the sprites in the sheet, which can be a fixed number or custom dimensions.\r\n     */\r\n    get spacing() {\r\n        return this._spacing;\r\n    }\r\n    /**\r\n     * Get a copy of the backing sprite array\r\n     */\r\n    get sprites() {\r\n        return [...this._sprites];\r\n    }\r\n    /**\r\n     * The backing texture used for the sprite sheet\r\n     */\r\n    get image() {\r\n        return this._image;\r\n    }\r\n    /**\r\n     * The number of columns in the sheet\r\n     */\r\n    get columns() {\r\n        return this._columns;\r\n    }\r\n    /**\r\n     * The number of rows in the sheet\r\n     */\r\n    get rows() {\r\n        return this._rows;\r\n    }\r\n    /**\r\n     * The width of the individual sprites\r\n     */\r\n    get spWidth() {\r\n        return this._spWidth;\r\n    }\r\n    /**\r\n     * The height of the individual sprites\r\n     */\r\n    get spHeight() {\r\n        return this._spHeight;\r\n    }\r\n    /**\r\n     * Gets the calculated spacing dimensions based on whether spacing\r\n     * is a fixed number or has different values for each dimension\r\n     */\r\n    getSpacingDimensions() {\r\n        var _a, _b, _c;\r\n        if (typeof this.spacing === 'number') {\r\n            return {\r\n                left: this.spacing,\r\n                top: this.spacing,\r\n                margin: this.spacing\r\n            };\r\n        }\r\n        else {\r\n            return {\r\n                left: (_a = this.spacing.left) !== null && _a !== void 0 ? _a : 0,\r\n                top: (_b = this.spacing.top) !== null && _b !== void 0 ? _b : 0,\r\n                margin: (_c = this.spacing.margin) !== null && _c !== void 0 ? _c : 0\r\n            };\r\n        }\r\n    }\r\n    /**\r\n     * Create an animation from the this SpriteSheet by listing out the\r\n     * sprite indices. Sprites are organized in row major order in the SpriteSheet.\r\n     * @param engine   Reference to the current game [[Engine]]\r\n     * @param indices  An array of sprite indices to use in the animation\r\n     * @param speed    The number in milliseconds to display each frame in the animation\r\n     */\r\n    getAnimationByIndices(engine, indices, speed) {\r\n        let images = indices.map((index) => {\r\n            return this.sprites[index];\r\n        });\r\n        images = images.map(function (i) {\r\n            return i.clone();\r\n        });\r\n        return new Animation_Animation(engine, images, speed);\r\n    }\r\n    /**\r\n     * Create an animation from the this SpriteSheet by specifying the range of\r\n     * images with the beginning (inclusive) and ending (exclusive) index\r\n     * For example `getAnimationBetween(engine, 0, 5, 200)` returns an animation with 5 frames.\r\n     * @param engine      Reference to the current game Engine\r\n     * @param beginIndex  The index to start taking frames (inclusive)\r\n     * @param endIndex    The index to stop taking frames (exclusive)\r\n     * @param speed       The number in milliseconds to display each frame in the animation\r\n     */\r\n    getAnimationBetween(engine, beginIndex, endIndex, speed) {\r\n        let images = this.sprites.slice(beginIndex, endIndex);\r\n        images = images.map(function (i) {\r\n            return i.clone();\r\n        });\r\n        return new Animation_Animation(engine, images, speed);\r\n    }\r\n    /**\r\n     * Treat the entire SpriteSheet as one animation, organizing the frames in\r\n     * row major order.\r\n     * @param engine  Reference to the current game [[Engine]]\r\n     * @param speed   The number in milliseconds to display each frame the animation\r\n     */\r\n    getAnimationForAll(engine, speed) {\r\n        const sprites = this.sprites.map(function (i) {\r\n            return i.clone();\r\n        });\r\n        return new Animation_Animation(engine, sprites, speed);\r\n    }\r\n    /**\r\n     * Retrieve a specific sprite from the SpriteSheet by its index. Sprites are organized\r\n     * in row major order in the SpriteSheet.\r\n     * @param index  The index of the sprite\r\n     */\r\n    getSprite(index) {\r\n        if (index >= 0 && index < this.sprites.length) {\r\n            return this.sprites[index];\r\n        }\r\n        else {\r\n            throw new Error('Invalid index: ' + index);\r\n        }\r\n    }\r\n    /**\r\n     * Get an animation with bespoke sprite coordinates. This is useful if the SpriteSheet is\r\n     * packed and not a uniform width or height. The resulting [[Animation]] will have the height and width of the\r\n     * largest dimension (width, height) from among the sprite coordinates\r\n     * @param engine\r\n     * @param spriteCoordinates\r\n     * @param speed\r\n     */\r\n    getAnimationByCoords(engine, spriteCoordinates, speed) {\r\n        let maxWidth = 0;\r\n        let maxHeight = 0;\r\n        const sprites = new Array(spriteCoordinates.length);\r\n        for (let i = 0; i < spriteCoordinates.length; i++) {\r\n            const coord = spriteCoordinates[i];\r\n            // no need to pass image again if using a spritesheet\r\n            coord.image = coord.image || this.image;\r\n            maxWidth = Math.max(maxWidth, coord.drawWidth);\r\n            maxHeight = Math.max(maxHeight, coord.drawHeight);\r\n            sprites[i] = new Sprite_Sprite(coord);\r\n        }\r\n        const anim = new Animation_Animation(engine, sprites, speed);\r\n        anim.drawWidth = maxWidth;\r\n        anim.drawHeight = maxHeight;\r\n        return anim;\r\n    }\r\n}\r\n/**\r\n * Sprite fonts are a used in conjunction with a [[Label]] to specify\r\n * a particular bitmap as a font. Note that some font features are not\r\n * supported by Sprite fonts.\r\n * @deprecated Will be removed into v0.26.0\r\n */\r\nlet SpriteFont = class SpriteFont extends SpriteSheet_SpriteSheet {\r\n    /**\r\n     * @param imageOrConfig   The backing image texture to build the SpriteFont or the sprite font option bag\r\n     * @param alphabet        A string representing all the characters in the image, in row major order.\r\n     * @param caseInsensitive  Indicate whether this font takes case into account\r\n     * @param columns         The number of columns of characters in the image\r\n     * @param rows            The number of rows of characters in the image\r\n     * @param spWidth         The width of each character in pixels\r\n     * @param spHeight        The height of each character in pixels\r\n     */\r\n    constructor(imageOrConfig, alphabet, caseInsensitive, columns, rows, spWidth, spHeight, spacing) {\r\n        super(imageOrConfig instanceof Texture\r\n            ? {\r\n                image: imageOrConfig,\r\n                spWidth: spWidth,\r\n                spHeight: spHeight,\r\n                rows: rows,\r\n                columns: columns,\r\n                spacing: spacing || 0\r\n            }\r\n            : imageOrConfig);\r\n        this._currentColor = Color.Black;\r\n        this._currentOpacity = 1.0;\r\n        this._spriteRecord = {};\r\n        // text shadow\r\n        this._textShadowOn = false;\r\n        this._textShadowDirty = true;\r\n        this._textShadowColor = Color.Black;\r\n        this._textShadowSprites = {};\r\n        this._shadowOffsetX = 5;\r\n        this._shadowOffsetY = 5;\r\n        if (imageOrConfig && !(imageOrConfig instanceof Texture)) {\r\n            alphabet = imageOrConfig.alphabet;\r\n            caseInsensitive = imageOrConfig.caseInsensitive;\r\n        }\r\n        this.alphabet = alphabet;\r\n        this.caseInsensitive = caseInsensitive;\r\n        this._spriteRecord = this.getTextSprites();\r\n    }\r\n    /**\r\n     * Returns a dictionary that maps each character in the alphabet to the appropriate [[Sprite]].\r\n     */\r\n    getTextSprites() {\r\n        const lookup = {};\r\n        for (let i = 0; i < this.alphabet.length; i++) {\r\n            let char = this.alphabet[i];\r\n            if (this.caseInsensitive) {\r\n                char = char.toLowerCase();\r\n            }\r\n            lookup[char] = this.sprites[i].clone();\r\n        }\r\n        return lookup;\r\n    }\r\n    /**\r\n     * Sets the text shadow for sprite fonts\r\n     * @param offsetX      The x offset in pixels to place the shadow\r\n     * @param offsetY      The y offset in pixels to place the shadow\r\n     * @param shadowColor  The color of the text shadow\r\n     */\r\n    setTextShadow(offsetX, offsetY, shadowColor) {\r\n        this._textShadowOn = true;\r\n        this._shadowOffsetX = offsetX;\r\n        this._shadowOffsetY = offsetY;\r\n        this._textShadowColor = shadowColor.clone();\r\n        this._textShadowDirty = true;\r\n        for (const character in this._spriteRecord) {\r\n            this._textShadowSprites[character] = this._spriteRecord[character].clone();\r\n        }\r\n    }\r\n    /**\r\n     * Toggles text shadows on or off\r\n     */\r\n    useTextShadow(on) {\r\n        this._textShadowOn = on;\r\n        if (on) {\r\n            this.setTextShadow(5, 5, this._textShadowColor);\r\n        }\r\n    }\r\n    /**\r\n     * Draws the current sprite font\r\n     */\r\n    draw(ctx, text, x, y, options) {\r\n        options = this._parseOptions(options);\r\n        if (this._currentColor.toString() !== options.color.toString() || this._currentOpacity !== options.opacity) {\r\n            this._currentOpacity = options.opacity;\r\n            this._currentColor = options.color;\r\n            for (const char in this._spriteRecord) {\r\n                this._spriteRecord[char].clearEffects();\r\n                this._spriteRecord[char].fill(options.color);\r\n                this._spriteRecord[char].opacity(options.opacity);\r\n            }\r\n        }\r\n        if (this._textShadowOn && this._textShadowDirty && this._textShadowColor) {\r\n            for (const characterShadow in this._textShadowSprites) {\r\n                this._textShadowSprites[characterShadow].clearEffects();\r\n                this._textShadowSprites[characterShadow].addEffect(new Fill(this._textShadowColor.clone()));\r\n            }\r\n            this._textShadowDirty = false;\r\n        }\r\n        // find the current length of text in pixels\r\n        const sprite = this.sprites[0];\r\n        // find the current height fo the text in pixels\r\n        const height = sprite.height;\r\n        // calculate appropriate scale for font size\r\n        const scale = options.fontSize / height;\r\n        const length = text.length * sprite.width * scale + text.length * options.letterSpacing;\r\n        let currX = x;\r\n        if (options.textAlign === TextAlign.Left || options.textAlign === TextAlign.Start) {\r\n            currX = x;\r\n        }\r\n        else if (options.textAlign === TextAlign.Right || options.textAlign === TextAlign.End) {\r\n            currX = x - length;\r\n        }\r\n        else if (options.textAlign === TextAlign.Center) {\r\n            currX = x - length / 2;\r\n        }\r\n        let currY = y - height * scale;\r\n        if (options.baseAlign === BaseAlign.Top || options.baseAlign === BaseAlign.Hanging) {\r\n            currY = y;\r\n        }\r\n        else if (options.baseAlign === BaseAlign.Ideographic ||\r\n            options.baseAlign === BaseAlign.Bottom ||\r\n            options.baseAlign === BaseAlign.Alphabetic) {\r\n            currY = y - height * scale;\r\n        }\r\n        else if (options.baseAlign === BaseAlign.Middle) {\r\n            currY = y - (height * scale) / 2;\r\n        }\r\n        for (let i = 0; i < text.length; i++) {\r\n            let character = text[i];\r\n            if (this.caseInsensitive) {\r\n                character = character.toLowerCase();\r\n            }\r\n            try {\r\n                // if text shadow\r\n                if (this._textShadowOn) {\r\n                    this._textShadowSprites[character].drawAroundAnchor = false;\r\n                    this._textShadowSprites[character].scale = vec(scale, scale);\r\n                    this._textShadowSprites[character].draw(ctx, currX + this._shadowOffsetX, currY + this._shadowOffsetY);\r\n                }\r\n                const charSprite = this._spriteRecord[character];\r\n                charSprite.drawAroundAnchor = false;\r\n                charSprite.scale = vec(scale, scale);\r\n                charSprite.draw(ctx, currX, currY);\r\n                currX += charSprite.drawWidth + options.letterSpacing;\r\n            }\r\n            catch (e) {\r\n                Logger.getInstance().error(`SpriteFont Error drawing char ${character}`);\r\n            }\r\n        }\r\n    }\r\n    _parseOptions(options) {\r\n        return {\r\n            fontSize: options.fontSize || 10,\r\n            letterSpacing: options.letterSpacing || 0,\r\n            color: options.color || Color.Black,\r\n            textAlign: typeof options.textAlign === undefined ? TextAlign.Left : options.textAlign,\r\n            baseAlign: typeof options.baseAlign === undefined ? BaseAlign.Bottom : options.baseAlign,\r\n            maxWidth: options.maxWidth || -1,\r\n            opacity: options.opacity || 0\r\n        };\r\n    }\r\n};\r\nSpriteFont = SpriteSheet_decorate([\r\n    obsolete({\r\n        message: 'SpriteSheet will be removed in v0.26.0',\r\n        alternateMethod: 'Use Graphics.SpriteSheet'\r\n    })\r\n], SpriteFont);\r\n\r\n\n;// CONCATENATED MODULE: ./Graphics/SpriteSheet.ts\n\r\n\r\n\r\n/**\r\n * Represents a collection of sprites from a source image with some organization in a grid\r\n */\r\nclass SpriteSheet {\r\n    /**\r\n     * Build a new sprite sheet from a list of sprites\r\n     *\r\n     * Use [[SpriteSheet.fromImageSource]] to create a SpriteSheet from an [[ImageSource]] organized in a grid\r\n     * @param options\r\n     */\r\n    constructor(options) {\r\n        this._logger = Logger.getInstance();\r\n        this.sprites = [];\r\n        const { sprites, rows, columns } = options;\r\n        this.sprites = sprites;\r\n        this.rows = rows !== null && rows !== void 0 ? rows : 1;\r\n        this.columns = columns !== null && columns !== void 0 ? columns : this.sprites.length;\r\n    }\r\n    /**\r\n     * Find a sprite by their x/y position in the SpriteSheet, for example `getSprite(0, 0)` is the [[Sprite]] in the top-left\r\n     * @param x\r\n     * @param y\r\n     */\r\n    getSprite(x, y) {\r\n        if (x >= this.columns || x < 0) {\r\n            this._logger.warn(`No sprite exists in the SpriteSheet at (${x}, ${y}), x: ${x} should be between 0 and ${this.columns - 1}`);\r\n            return null;\r\n        }\r\n        if (y >= this.rows || y < 0) {\r\n            this._logger.warn(`No sprite exists in the SpriteSheet at (${x}, ${y}), y: ${y} should be between 0 and ${this.rows - 1}`);\r\n            return null;\r\n        }\r\n        const spriteIndex = x + y * this.columns;\r\n        return this.sprites[spriteIndex];\r\n    }\r\n    /**\r\n     * To a graphics sprite sheet from a legacy sprite sheet\r\n     */\r\n    static fromLegacySpriteSheet(legacySpriteSheet) {\r\n        const sprites = legacySpriteSheet.sprites.map(oldSprite => Sprite.fromLegacySprite(oldSprite));\r\n        return new SpriteSheet({\r\n            sprites\r\n        });\r\n    }\r\n    /**\r\n     * @deprecated\r\n     * @param spriteSheet\r\n     */\r\n    static toLegacySpriteSheet(spriteSheet) {\r\n        const sprites = spriteSheet.sprites.map(sprite => Sprite.toLegacySprite(sprite));\r\n        return new SpriteSheet_SpriteSheet(sprites);\r\n    }\r\n    /**\r\n     * Create a SpriteSheet from an [[ImageSource]] organized in a grid\r\n     *\r\n     * Example:\r\n     * ```\r\n     * const spriteSheet = SpriteSheet.fromImageSource({\r\n     *   image: imageSource,\r\n     *   grid: {\r\n     *     rows: 5,\r\n     *     columns: 2,\r\n     *     spriteWidth: 32, // pixels\r\n     *     spriteHeight: 32 // pixels\r\n     *   },\r\n     *   // Optionally specify spacing\r\n     *   spacing: {\r\n     *     // pixels from the top left to start the sprite parsing\r\n     *     originOffset: {\r\n     *       x: 5,\r\n     *       y: 5\r\n     *     },\r\n     *     // pixels between each sprite while parsing\r\n     *     margin: {\r\n     *       x: 1,\r\n     *       y: 1\r\n     *     }\r\n     *   }\r\n     * })\r\n     * ```\r\n     *\r\n     * @param options\r\n     */\r\n    static fromImageSource(options) {\r\n        var _a;\r\n        const sprites = [];\r\n        options.spacing = (_a = options.spacing) !== null && _a !== void 0 ? _a : {};\r\n        const { image, grid: { rows, columns: cols, spriteWidth, spriteHeight }, spacing: { originOffset, margin } } = options;\r\n        const offsetDefaults = { x: 0, y: 0, ...originOffset };\r\n        const marginDefaults = { x: 0, y: 0, ...margin };\r\n        for (let x = 0; x < cols; x++) {\r\n            for (let y = 0; y < rows; y++) {\r\n                sprites[x + y * cols] = new Sprite({\r\n                    image: image,\r\n                    sourceView: {\r\n                        x: x * spriteWidth + marginDefaults.x * x + offsetDefaults.x,\r\n                        y: y * spriteHeight + marginDefaults.y * y + offsetDefaults.y,\r\n                        width: spriteWidth,\r\n                        height: spriteHeight\r\n                    },\r\n                    destSize: { height: spriteHeight, width: spriteWidth }\r\n                });\r\n            }\r\n        }\r\n        return new SpriteSheet({\r\n            sprites: sprites,\r\n            rows: rows,\r\n            columns: cols\r\n        });\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/SpriteFont.ts\n\r\n\r\n\r\n\r\n\r\n\r\nclass SpriteFont_SpriteFont extends Graphic {\r\n    constructor(options) {\r\n        super(options);\r\n        this._text = '';\r\n        this.alphabet = '';\r\n        this.shadow = null;\r\n        this.caseInsensitive = false;\r\n        this.spacing = 0;\r\n        this._logger = Logger.getInstance();\r\n        this._alreadyWarnedAlphabet = false;\r\n        this._alreadyWarnedSpriteSheet = false;\r\n        const { alphabet, spriteSheet, caseInsensitive, spacing, shadow } = options;\r\n        this.alphabet = alphabet;\r\n        this.spriteSheet = spriteSheet;\r\n        this.caseInsensitive = caseInsensitive !== null && caseInsensitive !== void 0 ? caseInsensitive : this.caseInsensitive;\r\n        this.spacing = spacing !== null && spacing !== void 0 ? spacing : this.spacing;\r\n        this.shadow = shadow !== null && shadow !== void 0 ? shadow : this.shadow;\r\n    }\r\n    static fromLegacySpriteFont(spriteFont) {\r\n        const sprites = spriteFont.sprites.map(Sprite.fromLegacySprite);\r\n        return new SpriteFont_SpriteFont({\r\n            alphabet: spriteFont.alphabet,\r\n            spacing: 0,\r\n            caseInsensitive: spriteFont.caseInsensitive,\r\n            spriteSheet: new SpriteSheet({\r\n                sprites\r\n            })\r\n        });\r\n    }\r\n    _getCharacterSprites(text) {\r\n        const results = [];\r\n        // handle case insensitive\r\n        const textToRender = this.caseInsensitive ? text.toLocaleLowerCase() : text;\r\n        const alphabet = this.caseInsensitive ? this.alphabet.toLocaleLowerCase() : this.alphabet;\r\n        // for each letter in text\r\n        for (let letterIndex = 0; letterIndex < textToRender.length; letterIndex++) {\r\n            // find the sprite index in alphabet , if there is an error pick the first\r\n            const letter = textToRender[letterIndex];\r\n            let spriteIndex = alphabet.indexOf(letter);\r\n            if (spriteIndex === -1) {\r\n                spriteIndex = 0;\r\n                if (!this._alreadyWarnedAlphabet) {\r\n                    this._logger.warn(`SpriteFont - Cannot find letter '${letter}' in configured alphabet '${alphabet}'.`);\r\n                    this._logger.warn('There maybe be more issues in the SpriteFont configuration. No additional warnings will be logged.');\r\n                    this._alreadyWarnedAlphabet = true;\r\n                }\r\n            }\r\n            const letterSprite = this.spriteSheet.sprites[spriteIndex];\r\n            if (letterSprite) {\r\n                results.push(letterSprite);\r\n            }\r\n            else {\r\n                if (!this._alreadyWarnedSpriteSheet) {\r\n                    this._logger.warn(`SpriteFont - Cannot find sprite for '${letter}' at index '${spriteIndex}' in configured SpriteSheet`);\r\n                    this._logger.warn('There maybe be more issues in the SpriteFont configuration. No additional warnings will be logged.');\r\n                    this._alreadyWarnedSpriteSheet = true;\r\n                }\r\n            }\r\n        }\r\n        return results;\r\n    }\r\n    measureText(text) {\r\n        const lines = text.split('\\n');\r\n        const maxWidthLine = lines.reduce((a, b) => {\r\n            return a.length > b.length ? a : b;\r\n        });\r\n        const sprites = this._getCharacterSprites(maxWidthLine);\r\n        let width = 0;\r\n        let height = 0;\r\n        for (const sprite of sprites) {\r\n            width += sprite.width + this.spacing;\r\n            height = Math.max(height, sprite.height);\r\n        }\r\n        return BoundingBox.fromDimension(width, height * lines.length, Vector.Zero);\r\n    }\r\n    _drawImage(ex, x, y) {\r\n        let xCursor = 0;\r\n        let yCursor = 0;\r\n        let height = 0;\r\n        const lines = this._text.split('\\n');\r\n        for (const line of lines) {\r\n            for (const sprite of this._getCharacterSprites(line)) {\r\n                // draw it in the right spot and increase the cursor by sprite width\r\n                sprite.draw(ex, x + xCursor, y + yCursor);\r\n                xCursor += sprite.width + this.spacing;\r\n                height = Math.max(height, sprite.height);\r\n            }\r\n            xCursor = 0;\r\n            yCursor += height;\r\n        }\r\n    }\r\n    render(ex, text, _color, x, y) {\r\n        // SpriteFont doesn't support _color, yet...\r\n        this._text = text;\r\n        const bounds = this.measureText(text);\r\n        this.width = bounds.width;\r\n        this.height = bounds.height;\r\n        if (this.shadow) {\r\n            ex.save();\r\n            ex.translate(this.shadow.offset.x, this.shadow.offset.y);\r\n            this.draw(ex, x, y);\r\n            ex.restore();\r\n        }\r\n        this.draw(ex, x, y);\r\n    }\r\n    clone() {\r\n        return new SpriteFont_SpriteFont({\r\n            alphabet: this.alphabet,\r\n            spriteSheet: this.spriteSheet,\r\n            spacing: this.spacing\r\n        });\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/debug-font.png\n/* harmony default export */ const debug_font = (\"data:image/png;base64,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\");\n;// CONCATENATED MODULE: ./Graphics/Context/debug-text.ts\n\r\n\r\n/**\r\n * Internal debugtext helper\r\n */\r\nclass DebugText {\r\n    constructor() {\r\n        /**\r\n         * base64 font\r\n         */\r\n        this.fontSheet = debug_font;\r\n        this.size = 16;\r\n        this.load();\r\n    }\r\n    load() {\r\n        this._imageSource = new ImageSource(this.fontSheet);\r\n        return this._imageSource.load().then(() => {\r\n            this._spriteSheet = SpriteSheet.fromImageSource({\r\n                image: this._imageSource,\r\n                grid: {\r\n                    rows: 3,\r\n                    columns: 16,\r\n                    spriteWidth: 16,\r\n                    spriteHeight: 16\r\n                }\r\n            });\r\n            this._spriteFont = new SpriteFont_SpriteFont({\r\n                alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ,!\\'&.\"?-()+ ',\r\n                caseInsensitive: true,\r\n                spriteSheet: this._spriteSheet,\r\n                spacing: -6\r\n            });\r\n        });\r\n    }\r\n    /**\r\n     * Writes debug text using the built in sprint font\r\n     * @param ctx\r\n     * @param text\r\n     * @param pos\r\n     */\r\n    write(ctx, text, pos) {\r\n        if (this._imageSource.isLoaded()) {\r\n            this._spriteFont.render(ctx, text, null, pos.x, pos.y);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/render-source.ts\nclass RenderSource {\r\n    constructor(_gl, _texture) {\r\n        this._gl = _gl;\r\n        this._texture = _texture;\r\n    }\r\n    use() {\r\n        const gl = this._gl;\r\n        gl.activeTexture(gl.TEXTURE0);\r\n        gl.bindTexture(gl.TEXTURE_2D, this._texture);\r\n    }\r\n    disable() {\r\n        const gl = this._gl;\r\n        gl.bindTexture(gl.TEXTURE_2D, null);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/render-target.ts\n\r\nclass RenderTarget {\r\n    constructor(options) {\r\n        this.width = options.width;\r\n        this.height = options.height;\r\n        this._gl = options.gl;\r\n        this._setupFramebuffer();\r\n    }\r\n    setResolution(width, height) {\r\n        const gl = this._gl;\r\n        this.width = width;\r\n        this.height = height;\r\n        gl.bindTexture(gl.TEXTURE_2D, this._frameTexture);\r\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, this.width, this.height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\r\n    }\r\n    get frameBuffer() {\r\n        return this._frameBuffer;\r\n    }\r\n    get frameTexture() {\r\n        return this._frameTexture;\r\n    }\r\n    _setupFramebuffer() {\r\n        // Allocates frame buffer\r\n        const gl = this._gl;\r\n        this._frameTexture = gl.createTexture();\r\n        gl.bindTexture(gl.TEXTURE_2D, this._frameTexture);\r\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, this.width, this.height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\r\n        // set the filtering so we don't need mips\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n        // attach the texture as the first color attachment\r\n        const attachmentPoint = gl.COLOR_ATTACHMENT0;\r\n        // After this bind all draw calls will draw to this framebuffer texture\r\n        this._frameBuffer = gl.createFramebuffer();\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, this._frameBuffer);\r\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, attachmentPoint, gl.TEXTURE_2D, this._frameTexture, 0);\r\n        // Reset after initialized\r\n        this.disable();\r\n    }\r\n    toRenderSource() {\r\n        const source = new RenderSource(this._gl, this._frameTexture);\r\n        return source;\r\n    }\r\n    /**\r\n     * When called, all drawing gets redirected to this render target\r\n     */\r\n    use() {\r\n        const gl = this._gl;\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, this._frameBuffer);\r\n        // very important to set the viewport to the size of the framebuffer texture\r\n        gl.viewport(0, 0, this.width, this.height);\r\n    }\r\n    /**\r\n     * When called, all drawing is sent back to the canvas\r\n     */\r\n    disable() {\r\n        const gl = this._gl;\r\n        // passing null switches rendering back to the canvas\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n        gl.bindTexture(gl.TEXTURE_2D, null);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/webgl-adapter.ts\n/**\r\n * Must be accessed after Engine construction time to ensure the context has been created\r\n */\r\nclass ExcaliburWebGLContextAccessor {\r\n    static clear() {\r\n        ExcaliburWebGLContextAccessor._GL = null;\r\n    }\r\n    static register(gl) {\r\n        ExcaliburWebGLContextAccessor._GL = gl;\r\n    }\r\n    // current webgl context\r\n    static get gl() {\r\n        if (!ExcaliburWebGLContextAccessor._GL) {\r\n            throw Error('Attempted gl access before init');\r\n        }\r\n        return ExcaliburWebGLContextAccessor._GL;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/line-renderer/line-vertex.glsl\n/* harmony default export */ const line_vertex = (\"attribute vec2 a_position;\\r\\nattribute vec4 a_color;\\r\\n\\r\\nvarying lowp vec4 v_color;\\r\\n\\r\\nuniform mat4 u_matrix;\\r\\n\\r\\n\\r\\nvoid main() {\\r\\n   // Set the vertex position using the ortho transform matrix\\r\\n   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\\r\\n\\r\\n   // Passthrough the color\\r\\n   v_color = a_color;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/line-renderer/line-fragment.glsl\n/* harmony default export */ const line_fragment = (\"precision mediump float;\\r\\n\\r\\n// Color\\r\\nvarying lowp vec4 v_color;\\r\\n\\r\\n\\r\\nvoid main() {\\r\\n  gl_FragColor = v_color;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/shader.ts\n\r\n\r\nclass Shader {\r\n    /**\r\n     * Create a shader program in excalibur\r\n     * @param options specify shader vertex and fragment source\r\n     */\r\n    constructor(options) {\r\n        this._gl = ExcaliburWebGLContextAccessor.gl;\r\n        this.uniforms = {};\r\n        this.attributes = {};\r\n        this._compiled = false;\r\n        const { vertexSource, fragmentSource } = options;\r\n        this.vertexSource = vertexSource;\r\n        this.fragmentSource = fragmentSource;\r\n    }\r\n    get compiled() {\r\n        return this._compiled;\r\n    }\r\n    /**\r\n     * Binds the shader program\r\n     */\r\n    use() {\r\n        const gl = this._gl;\r\n        gl.useProgram(this.program);\r\n        Shader._ACTIVE_SHADER_INSTANCE = this;\r\n    }\r\n    isCurrentlyBound() {\r\n        return Shader._ACTIVE_SHADER_INSTANCE === this;\r\n    }\r\n    /**\r\n     * Compile the current shader against a webgl context\r\n     */\r\n    compile() {\r\n        const gl = this._gl;\r\n        const vertexShader = this._compileShader(gl, this.vertexSource, gl.VERTEX_SHADER);\r\n        const fragmentShader = this._compileShader(gl, this.fragmentSource, gl.FRAGMENT_SHADER);\r\n        this.program = this._createProgram(gl, vertexShader, fragmentShader);\r\n        const attributes = this.getAttributes();\r\n        for (const attribute of attributes) {\r\n            this.attributes[attribute.name] = attribute;\r\n        }\r\n        const uniforms = this.getUniforms();\r\n        for (const uniform of uniforms) {\r\n            this.uniforms[uniform.name] = uniform;\r\n        }\r\n        this._compiled = true;\r\n        return this.program;\r\n    }\r\n    getUniforms() {\r\n        const gl = this._gl;\r\n        const uniformCount = gl.getProgramParameter(this.program, gl.ACTIVE_UNIFORMS);\r\n        const uniforms = [];\r\n        for (let i = 0; i < uniformCount; i++) {\r\n            const uniform = gl.getActiveUniform(this.program, i);\r\n            const uniformLocation = gl.getUniformLocation(this.program, uniform.name);\r\n            uniforms.push({\r\n                name: uniform.name,\r\n                glType: uniform.type,\r\n                location: uniformLocation\r\n            });\r\n        }\r\n        return uniforms;\r\n    }\r\n    getAttributes() {\r\n        const gl = this._gl;\r\n        const attributeCount = gl.getProgramParameter(this.program, gl.ACTIVE_ATTRIBUTES);\r\n        const attributes = [];\r\n        for (let i = 0; i < attributeCount; i++) {\r\n            const attribute = gl.getActiveAttrib(this.program, i);\r\n            const attributeLocation = gl.getAttribLocation(this.program, attribute.name);\r\n            attributes.push({\r\n                name: attribute.name,\r\n                glType: getAttributePointerType(gl, attribute.type),\r\n                size: getAttributeComponentSize(gl, attribute.type),\r\n                location: attributeLocation,\r\n                normalized: false\r\n            });\r\n        }\r\n        return attributes;\r\n    }\r\n    /**\r\n     * Set a texture in a gpu texture slot\r\n     * @param slotNumber\r\n     * @param texture\r\n     */\r\n    setTexture(slotNumber, texture) {\r\n        const gl = this._gl;\r\n        gl.activeTexture(gl.TEXTURE0 + slotNumber);\r\n        gl.bindTexture(gl.TEXTURE_2D, texture);\r\n    }\r\n    /**\r\n     * Set an integer uniform for the current shader\r\n     *\r\n     * **Important** Must call ex.Shader.use() before setting a uniform!\r\n     *\r\n     * @param name\r\n     * @param value\r\n     */\r\n    setUniformInt(name, value) {\r\n        this.setUniform('uniform1i', name, ~~value);\r\n    }\r\n    /**\r\n     * Set an integer array uniform for the current shader\r\n     *\r\n     * **Important** Must call ex.Shader.use() before setting a uniform!\r\n     *\r\n     * @param name\r\n     * @param value\r\n     */\r\n    setUniformIntArray(name, value) {\r\n        this.setUniform('uniform1iv', name, value);\r\n    }\r\n    /**\r\n     * Set a boolean uniform for the current shader\r\n     *\r\n     * **Important** Must call ex.Shader.use() before setting a uniform!\r\n     *\r\n     * @param name\r\n     * @param value\r\n     */\r\n    setUniformBoolean(name, value) {\r\n        this.setUniform('uniform1i', name, value ? 1 : 0);\r\n    }\r\n    /**\r\n     * Set a float uniform for the current shader\r\n     *\r\n     * **Important** Must call ex.Shader.use() before setting a uniform!\r\n     *\r\n     * @param name\r\n     * @param value\r\n     */\r\n    setUniformFloat(name, value) {\r\n        this.setUniform('uniform1f', name, value);\r\n    }\r\n    /**\r\n     * Set a float array uniform for the current shader\r\n     *\r\n     * **Important** Must call ex.Shader.use() before setting a uniform!\r\n     *\r\n     * @param name\r\n     * @param value\r\n     */\r\n    setUniformFloatArray(name, value) {\r\n        this.setUniform('uniform1fv', name, value);\r\n    }\r\n    /**\r\n     * Set a [[Vector]] uniform for the current shader\r\n     *\r\n     * **Important** Must call ex.Shader.use() before setting a uniform!\r\n     *\r\n     * @param name\r\n     * @param value\r\n     */\r\n    setUniformFloatVector(name, value) {\r\n        this.setUniform('uniform2f', name, value.x, value.y);\r\n    }\r\n    /**\r\n     * Set an [[Matrix]] uniform for the current shader\r\n     *\r\n     * **Important** Must call ex.Shader.use() before setting a uniform!\r\n     *\r\n     * @param name\r\n     * @param value\r\n     */\r\n    setUniformMatrix(name, value) {\r\n        this.setUniform('uniformMatrix4fv', name, false, value.data);\r\n    }\r\n    /**\r\n     * Set any available uniform type in webgl\r\n     *\r\n     * For example setUniform('uniformMatrix2fv', 'u_my2x2_mat`, ...);\r\n     */\r\n    setUniform(uniformType, name, ...value) {\r\n        if (!this._compiled) {\r\n            throw Error(`Must compile shader before setting a uniform ${uniformType}:${name}`);\r\n        }\r\n        if (!this.isCurrentlyBound()) {\r\n            throw Error('Currently accessed shader instance is not the current active shader in WebGL,' +\r\n                ' must call `shader.use()` before setting uniforms');\r\n        }\r\n        const gl = this._gl;\r\n        const location = gl.getUniformLocation(this.program, name);\r\n        if (location) {\r\n            const args = [location, ...value];\r\n            this._gl[uniformType].apply(this._gl, args);\r\n        }\r\n        else {\r\n            throw Error(`Uniform ${uniformType}:${name} doesn\\'t exist or is not used in the shader source code,` +\r\n                ' unused uniforms are optimized away by most browsers');\r\n        }\r\n    }\r\n    _createProgram(gl, vertexShader, fragmentShader) {\r\n        const program = gl.createProgram();\r\n        if (program === null) {\r\n            throw Error('Could not create graphics shader program');\r\n        }\r\n        // attach the shaders.\r\n        gl.attachShader(program, vertexShader);\r\n        gl.attachShader(program, fragmentShader);\r\n        // link the program.\r\n        gl.linkProgram(program);\r\n        const success = gl.getProgramParameter(program, gl.LINK_STATUS);\r\n        if (!success) {\r\n            throw Error(`Could not link the program: [${gl.getProgramInfoLog(program)}]`);\r\n        }\r\n        return program;\r\n    }\r\n    _compileShader(gl, source, type) {\r\n        const typeName = gl.VERTEX_SHADER === type ? 'vertex' : 'fragment';\r\n        const shader = gl.createShader(type);\r\n        if (shader === null) {\r\n            throw Error(`Could not build shader: [${source}]`);\r\n        }\r\n        gl.shaderSource(shader, source);\r\n        gl.compileShader(shader);\r\n        const success = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\r\n        if (!success) {\r\n            const errorInfo = gl.getShaderInfoLog(shader);\r\n            throw Error(`Could not compile ${typeName} shader:\\n\\n${errorInfo}${this._processSourceForError(source, errorInfo)}`);\r\n        }\r\n        return shader;\r\n    }\r\n    _processSourceForError(source, errorInfo) {\r\n        const lines = source.split('\\n');\r\n        const errorLineStart = errorInfo.search(/\\d:\\d/);\r\n        const errorLineEnd = errorInfo.indexOf(' ', errorLineStart);\r\n        const [_, error2] = errorInfo.slice(errorLineStart, errorLineEnd).split(':').map(v => Number(v));\r\n        for (let i = 0; i < lines.length; i++) {\r\n            lines[i] = `${i + 1}: ${lines[i]}${error2 === (i + 1) ? ' <----- ERROR!' : ''}`;\r\n        }\r\n        return '\\n\\nSource:\\n' + lines.join('\\n');\r\n    }\r\n}\r\nShader._ACTIVE_SHADER_INSTANCE = null;\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/vertex-buffer.ts\n\r\n/**\r\n * Helper around vertex buffer to simplify creating and uploading geometry\r\n *\r\n * Under the hood uses Float32Array\r\n */\r\nclass VertexBuffer {\r\n    constructor(options) {\r\n        this._gl = ExcaliburWebGLContextAccessor.gl;\r\n        /**\r\n         * If the vertices never change switching 'static' can be more efficient on the gpu\r\n         *\r\n         * Default is 'dynamic'\r\n         */\r\n        this.type = 'dynamic';\r\n        const { size, type, data } = options;\r\n        this.buffer = this._gl.createBuffer();\r\n        if (!data && !size) {\r\n            throw Error('Must either provide data or a size to the VertexBuffer');\r\n        }\r\n        if (!data) {\r\n            this.bufferData = new Float32Array(size);\r\n        }\r\n        else {\r\n            this.bufferData = data;\r\n        }\r\n        this.type = type !== null && type !== void 0 ? type : this.type;\r\n    }\r\n    /**\r\n     * Bind this vertex buffer\r\n     */\r\n    bind() {\r\n        const gl = this._gl;\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.buffer);\r\n    }\r\n    /**\r\n     * Upload vertex buffer geometry to the GPU\r\n     */\r\n    upload() {\r\n        const gl = this._gl;\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.buffer);\r\n        gl.bufferData(gl.ARRAY_BUFFER, this.bufferData, this.type === 'static' ? gl.STATIC_DRAW : gl.DYNAMIC_DRAW);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/vertex-layout.ts\n\r\n\r\n\r\n/**\r\n * Helper around creating vertex attributes in a given [[VertexBuffer]], this is useful for describing\r\n * the memory layout for your vertices inside a particular buffer\r\n *\r\n * Note: This helper assumes interleaved attributes in one [[VertexBuffer]], not many.\r\n *\r\n * Working with `gl.vertexAttribPointer` can be tricky, and this attempts to double check you\r\n */\r\nclass VertexLayout {\r\n    constructor(options) {\r\n        this._gl = ExcaliburWebGLContextAccessor.gl;\r\n        this._logger = Logger.getInstance();\r\n        this._layout = [];\r\n        this._attributes = [];\r\n        this._vertexTotalSizeBytes = 0;\r\n        const { shader, vertexBuffer, attributes } = options;\r\n        this._vertexBuffer = vertexBuffer;\r\n        this._attributes = attributes;\r\n        this._shader = shader;\r\n        this.initialize();\r\n    }\r\n    get vertexBuffer() {\r\n        return this._vertexBuffer;\r\n    }\r\n    get attributes() {\r\n        return this._attributes;\r\n    }\r\n    /**\r\n     * Total number of bytes that the vertex will take up\r\n     */\r\n    get totalVertexSizeBytes() {\r\n        return this._vertexTotalSizeBytes;\r\n    }\r\n    /**\r\n     * Layouts need shader locations and must be bound to a shader\r\n     */\r\n    initialize() {\r\n        if (!this._shader.compiled) {\r\n            throw Error('Shader not compiled, shader must be compiled before defining a vertex layout');\r\n        }\r\n        this._layout.length = 0;\r\n        const shaderAttributes = this._shader.attributes;\r\n        for (const attribute of this._attributes) {\r\n            const attrib = shaderAttributes[attribute[0]];\r\n            if (!attrib) {\r\n                throw Error(`The attribute named: ${attribute[0]} size ${attribute[1]}` +\r\n                    ` not found in the shader source code:\\n ${this._shader.vertexSource}`);\r\n            }\r\n            if (attrib.size !== attribute[1]) {\r\n                throw Error(`VertexLayout size definition for attribute: [${attribute[0]}, ${attribute[1]}],`\r\n                    + ` doesnt match shader source size ${attrib.size}:\\n ${this._shader.vertexSource}`);\r\n            }\r\n            this._layout.push(attrib);\r\n        }\r\n        // calc size\r\n        let componentsPerVertex = 0;\r\n        for (const vertAttribute of this._layout) {\r\n            const typeSize = getGlTypeSizeBytes(this._gl, vertAttribute.glType);\r\n            this._vertexTotalSizeBytes += typeSize * vertAttribute.size;\r\n            componentsPerVertex += vertAttribute.size;\r\n        }\r\n        if (this._vertexBuffer.bufferData.length % componentsPerVertex !== 0) {\r\n            this._logger.warn(`The vertex component size (${componentsPerVertex})  does divide evenly into the specified vertex buffer`\r\n                + ` (${this._vertexBuffer.bufferData.length})`);\r\n        }\r\n    }\r\n    /**\r\n     * Bind this layout with it's associated vertex buffer\r\n     *\r\n     * @param uploadBuffer Optionally indicate you wish to upload the buffer to the GPU associated with this layout\r\n     */\r\n    use(uploadBuffer = false) {\r\n        const gl = this._gl;\r\n        if (!this._shader.isCurrentlyBound()) {\r\n            throw Error('Shader associated with this vertex layout is not active! Call shader.use() before layout.use()');\r\n        }\r\n        this._vertexBuffer.bind();\r\n        if (uploadBuffer) {\r\n            this._vertexBuffer.upload();\r\n        }\r\n        let offset = 0;\r\n        // TODO switch to VAOs if the extension is\r\n        for (const vert of this._layout) {\r\n            gl.vertexAttribPointer(vert.location, vert.size, vert.glType, vert.normalized, this.totalVertexSizeBytes, offset);\r\n            gl.enableVertexAttribArray(vert.location);\r\n            offset += getGlTypeSizeBytes(gl, vert.glType) * vert.size;\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/GraphicsDiagnostics.ts\nclass GraphicsDiagnostics {\r\n    static clear() {\r\n        GraphicsDiagnostics.DrawCallCount = 0;\r\n        GraphicsDiagnostics.DrawnImagesCount = 0;\r\n    }\r\n}\r\nGraphicsDiagnostics.DrawCallCount = 0;\r\nGraphicsDiagnostics.DrawnImagesCount = 0;\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/line-renderer/line-renderer.ts\n\r\n\r\n\r\n\r\nclass LineRenderer {\r\n    constructor() {\r\n        this.type = 'ex.line';\r\n        this.priority = 0;\r\n        this._maxLines = 10922;\r\n        this._vertexIndex = 0;\r\n        this._lineCount = 0;\r\n    }\r\n    initialize(gl, context) {\r\n        this._gl = gl;\r\n        this._context = context;\r\n        this._shader = new Shader({\r\n            vertexSource: line_vertex,\r\n            fragmentSource: line_fragment\r\n        });\r\n        this._shader.compile();\r\n        this._shader.use();\r\n        this._shader.setUniformMatrix('u_matrix', this._context.ortho);\r\n        this._vertexBuffer = new VertexBuffer({\r\n            size: 6 * 2 * this._maxLines,\r\n            type: 'dynamic'\r\n        });\r\n        this._layout = new VertexLayout({\r\n            vertexBuffer: this._vertexBuffer,\r\n            shader: this._shader,\r\n            attributes: [\r\n                ['a_position', 2],\r\n                ['a_color', 4]\r\n            ]\r\n        });\r\n    }\r\n    draw(start, end, color) {\r\n        // Force a render if the batch is full\r\n        if (this._isFull()) {\r\n            this.flush();\r\n        }\r\n        this._lineCount++;\r\n        const transform = this._context.getTransform();\r\n        const finalStart = transform.multv(start);\r\n        const finalEnd = transform.multv(end);\r\n        const vertexBuffer = this._vertexBuffer.bufferData;\r\n        // Start\r\n        vertexBuffer[this._vertexIndex++] = finalStart.x;\r\n        vertexBuffer[this._vertexIndex++] = finalStart.y;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        // End\r\n        vertexBuffer[this._vertexIndex++] = finalEnd.x;\r\n        vertexBuffer[this._vertexIndex++] = finalEnd.y;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n    }\r\n    _isFull() {\r\n        if (this._lineCount >= this._maxLines) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    hasPendingDraws() {\r\n        return this._lineCount !== 0;\r\n    }\r\n    flush() {\r\n        // nothing to draw early exit\r\n        if (this._lineCount === 0) {\r\n            return;\r\n        }\r\n        const gl = this._gl;\r\n        this._shader.use();\r\n        this._layout.use(true);\r\n        this._shader.setUniformMatrix('u_matrix', this._context.ortho);\r\n        gl.drawArrays(gl.LINES, 0, this._lineCount * 2); // 2 verts per line\r\n        GraphicsDiagnostics.DrawnImagesCount += this._lineCount;\r\n        GraphicsDiagnostics.DrawCallCount++;\r\n        // reset\r\n        this._vertexIndex = 0;\r\n        this._lineCount = 0;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/point-renderer/point-vertex.glsl\n/* harmony default export */ const point_vertex = (\"attribute vec2 a_position;\\r\\nattribute vec4 a_color;\\r\\nattribute float a_size;\\r\\nvarying lowp vec4 v_color;\\r\\nuniform mat4 u_matrix;\\r\\n\\r\\nvoid main() {\\r\\n  gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\\r\\n  gl_PointSize = a_size * 2.0;\\r\\n  v_color = a_color;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/point-renderer/point-fragment.glsl\n/* harmony default export */ const point_fragment = (\"#ifdef GL_OES_standard_derivatives\\r\\n#extension GL_OES_standard_derivatives : enable\\r\\n#endif\\r\\n\\r\\nprecision mediump float;\\r\\nvarying lowp vec4 v_color;\\r\\n\\r\\nvoid main() {\\r\\n  float r = 0.0, delta = 0.0, alpha = 1.0;\\r\\n  vec2 cxy = 2.0 * gl_PointCoord - 1.0;\\r\\n  r = dot(cxy, cxy);\\r\\n\\r\\n#ifdef GL_OES_standard_derivatives\\r\\n  delta = fwidth(r);\\r\\n  alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\\r\\n#else\\r\\n  if (r > 1.0) {\\r\\n    discard;\\r\\n  }\\r\\n#endif\\r\\n  // \\\"premultiply\\\" the color by alpha\\r\\n  vec4 color = v_color;\\r\\n  color.a = color.a * alpha;\\r\\n  color.rgb = color.rgb * color.a;\\r\\n  gl_FragColor = color;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/point-renderer/point-renderer.ts\n\r\n\r\n\r\n\r\n\r\n\r\nclass PointRenderer {\r\n    constructor() {\r\n        this.type = 'ex.point';\r\n        this.priority = 0;\r\n        this._maxPoints = 10922;\r\n        this._pointCount = 0;\r\n        this._vertexIndex = 0;\r\n    }\r\n    initialize(gl, context) {\r\n        this._gl = gl;\r\n        this._context = context;\r\n        this._shader = new Shader({\r\n            vertexSource: point_vertex,\r\n            fragmentSource: point_fragment\r\n        });\r\n        this._shader.compile();\r\n        this._shader.use();\r\n        this._shader.setUniformMatrix('u_matrix', this._context.ortho);\r\n        this._buffer = new VertexBuffer({\r\n            size: 7 * this._maxPoints,\r\n            type: 'dynamic'\r\n        });\r\n        this._layout = new VertexLayout({\r\n            shader: this._shader,\r\n            vertexBuffer: this._buffer,\r\n            attributes: [\r\n                ['a_position', 2],\r\n                ['a_color', 4],\r\n                ['a_size', 1]\r\n            ]\r\n        });\r\n    }\r\n    draw(point, color, size) {\r\n        // Force a render if the batch is full\r\n        if (this._isFull()) {\r\n            this.flush();\r\n        }\r\n        this._pointCount++;\r\n        const transform = this._context.getTransform();\r\n        const opacity = this._context.opacity;\r\n        const finalPoint = transform.multv(point);\r\n        const vertexBuffer = this._buffer.bufferData;\r\n        vertexBuffer[this._vertexIndex++] = finalPoint.x;\r\n        vertexBuffer[this._vertexIndex++] = finalPoint.y;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a * opacity;\r\n        vertexBuffer[this._vertexIndex++] = size * Math.max(transform.getScaleX(), transform.getScaleY());\r\n    }\r\n    _isFull() {\r\n        if (this._pointCount >= this._maxPoints) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    hasPendingDraws() {\r\n        return this._pointCount !== 0;\r\n    }\r\n    flush() {\r\n        // nothing to draw early exit\r\n        if (this._pointCount === 0) {\r\n            return;\r\n        }\r\n        const gl = this._gl;\r\n        this._shader.use();\r\n        this._layout.use(true);\r\n        this._shader.setUniformMatrix('u_matrix', this._context.ortho);\r\n        gl.drawArrays(gl.POINTS, 0, this._pointCount);\r\n        GraphicsDiagnostics.DrawnImagesCount += this._pointCount;\r\n        GraphicsDiagnostics.DrawCallCount++;\r\n        this._pointCount = 0;\r\n        this._vertexIndex = 0;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/screen-pass-painter/screen-vertex.glsl\n/* harmony default export */ const screen_vertex = (\"attribute vec2 a_position;\\r\\n\\r\\nattribute vec2 a_texcoord;\\r\\nvarying vec2 v_texcoord;\\r\\n\\r\\nvoid main() {\\r\\n  gl_Position = vec4(a_position, 0.0, 1.0);\\r\\n\\r\\n  // Pass the texcoord to the fragment shader.\\r\\n  v_texcoord = a_texcoord;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/screen-pass-painter/screen-fragment.glsl\n/* harmony default export */ const screen_fragment = (\"precision mediump float;\\r\\n\\r\\n// Passed in from the vertex shader.\\r\\nvarying vec2 v_texcoord;\\r\\n\\r\\n// The texture.\\r\\nuniform sampler2D u_texture;\\r\\n\\r\\nvoid main() {\\r\\n   gl_FragColor = texture2D(u_texture, v_texcoord);\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/screen-pass-painter/screen-pass-painter.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * This is responsible for painting the entire screen during the render passes\r\n */\r\nclass ScreenPassPainter {\r\n    constructor(gl) {\r\n        this._gl = gl;\r\n        this._shader = new Shader({\r\n            vertexSource: screen_vertex,\r\n            fragmentSource: screen_fragment\r\n        });\r\n        this._shader.compile();\r\n        // Setup memory layout\r\n        this._buffer = new VertexBuffer({\r\n            type: 'static',\r\n            // clip space quad + uv since we don't need a camera\r\n            data: new Float32Array([\r\n                -1, -1, 0, 0,\r\n                -1, 1, 0, 1,\r\n                1, -1, 1, 0,\r\n                1, -1, 1, 0,\r\n                -1, 1, 0, 1,\r\n                1, 1, 1, 1\r\n            ])\r\n        });\r\n        this._layout = new VertexLayout({\r\n            shader: this._shader,\r\n            vertexBuffer: this._buffer,\r\n            attributes: [\r\n                ['a_position', 2],\r\n                ['a_texcoord', 2]\r\n            ]\r\n        });\r\n        this._buffer.upload();\r\n    }\r\n    renderWithPostProcessor(postprocessor) {\r\n        const gl = this._gl;\r\n        postprocessor.getShader().use();\r\n        postprocessor.getLayout().use();\r\n        gl.drawArrays(gl.TRIANGLES, 0, 6);\r\n    }\r\n    renderToScreen() {\r\n        const gl = this._gl;\r\n        this._shader.use();\r\n        this._layout.use();\r\n        gl.drawArrays(gl.TRIANGLES, 0, 6);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/quad-index-buffer.ts\n\r\n\r\n/**\r\n * Helper that defines and index buffer for quad geometry\r\n *\r\n * Index buffers allow you to save space in vertex buffers when you share vertices in geometry\r\n * it is almost always worth it in terms of performance to use an index buffer.\r\n */\r\nclass QuadIndexBuffer {\r\n    /**\r\n     * @param numberOfQuads Specify the max number of quads you want to draw\r\n     * @param useUint16 Optionally force a uint16 buffer\r\n     */\r\n    constructor(numberOfQuads, useUint16) {\r\n        this._gl = ExcaliburWebGLContextAccessor.gl;\r\n        this._logger = Logger.getInstance();\r\n        const gl = this._gl;\r\n        this.buffer = gl.createBuffer();\r\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.buffer);\r\n        const totalVertices = numberOfQuads * 6;\r\n        const ext = gl.getExtension('OES_element_index_uint');\r\n        if (ext && !useUint16) {\r\n            this.bufferData = new Uint32Array(totalVertices);\r\n        }\r\n        else {\r\n            // fall back to using gl.UNSIGNED_SHORT or tell the user they are out of luck\r\n            const maxUint16 = 65535;\r\n            const maxUint16Index = Math.floor((maxUint16 - 1) / 4); // max quads\r\n            this.bufferGlType = gl.UNSIGNED_SHORT;\r\n            this.bufferData = new Uint16Array(totalVertices);\r\n            // TODO Should we error if this happens?? maybe not might crash mid game\r\n            if (numberOfQuads > maxUint16Index) {\r\n                this._logger.warn(`Total quads exceeds hardware index buffer limit (uint16), max(${maxUint16Index}) requested quads(${numberOfQuads})`);\r\n            }\r\n        }\r\n        let currentQuad = 0;\r\n        for (let i = 0; i < totalVertices; i += 6) {\r\n            // first triangle\r\n            this.bufferData[i + 0] = currentQuad + 0;\r\n            this.bufferData[i + 1] = currentQuad + 1;\r\n            this.bufferData[i + 2] = currentQuad + 2;\r\n            // second triangle\r\n            this.bufferData[i + 3] = currentQuad + 2;\r\n            this.bufferData[i + 4] = currentQuad + 1;\r\n            this.bufferData[i + 5] = currentQuad + 3;\r\n            currentQuad += 4;\r\n        }\r\n        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, this.bufferData, gl.STATIC_DRAW);\r\n    }\r\n    get size() {\r\n        return this.bufferData.length;\r\n    }\r\n    /**\r\n     * Upload data to the GPU\r\n     */\r\n    upload() {\r\n        const gl = this._gl;\r\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.buffer);\r\n        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, this.bufferData, gl.STATIC_DRAW);\r\n    }\r\n    /**\r\n     * Bind this index buffer\r\n     */\r\n    bind() {\r\n        const gl = this._gl;\r\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.buffer);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/image-renderer/image-renderer.frag.glsl\n/* harmony default export */ const image_renderer_frag = (\"precision mediump float;\\r\\n\\r\\n// UV coord\\r\\nvarying vec2 v_texcoord;\\r\\n\\r\\n// Texture index\\r\\nvarying lowp float v_textureIndex;\\r\\n\\r\\n// Textures in the current draw\\r\\nuniform sampler2D u_textures[%%count%%];\\r\\n\\r\\n// Opacity\\r\\nvarying float v_opacity;\\r\\n\\r\\nvoid main() {\\r\\n   // In order to support the most efficient sprite batching, we have multiple\\r\\n   // textures loaded into the gpu (usually 8) this picker logic skips over textures\\r\\n   // that do not apply to a particular sprite.\\r\\n\\r\\n   vec4 color = vec4(1.0, 0, 0, 1.0);\\r\\n\\r\\n   // GLSL is templated out to pick the right texture and set the vec4 color\\r\\n   %%texture_picker%%\\r\\n\\r\\n   color.rgb = color.rgb * v_opacity;\\r\\n   color.a = color.a * v_opacity;\\r\\n   gl_FragColor = color;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/image-renderer/image-renderer.vert.glsl\n/* harmony default export */ const image_renderer_vert = (\"attribute vec2 a_position;\\r\\n\\r\\n// Opacity \\r\\nattribute float a_opacity;\\r\\nvarying float v_opacity;\\r\\n\\r\\n// UV coordinate\\r\\nattribute vec2 a_texcoord;\\r\\nvarying vec2 v_texcoord;\\r\\n\\r\\n// Texture number\\r\\nattribute lowp float a_textureIndex;\\r\\nvarying lowp float v_textureIndex;\\r\\n\\r\\nuniform mat4 u_matrix;\\r\\n\\r\\n\\r\\nvoid main() {\\r\\n   // Set the vertex position using the ortho transform matrix\\r\\n   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\\r\\n\\r\\n   // Pass through the Opacity to the fragment shader\\r\\n   v_opacity = a_opacity;\\r\\n   // Pass through the UV coord to the fragment shader\\r\\n   v_texcoord = a_texcoord;\\r\\n   // Pass through the texture number to the fragment shader\\r\\n   v_textureIndex = a_textureIndex;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/image-renderer/image-renderer.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass ImageRenderer {\r\n    constructor() {\r\n        this.type = 'ex.image';\r\n        this.priority = 0;\r\n        this._maxImages = 10922; // max(uint16) / 6 verts\r\n        this._maxTextures = 0;\r\n        // Per flush vars\r\n        this._imageCount = 0;\r\n        this._textures = [];\r\n        this._vertexIndex = 0;\r\n    }\r\n    initialize(gl, context) {\r\n        this._gl = gl;\r\n        this._context = context;\r\n        // Transform shader source\r\n        this._maxTextures = gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);\r\n        const transformedFrag = this._transformFragmentSource(image_renderer_frag, this._maxTextures);\r\n        // Compile shader\r\n        this._shader = new Shader({\r\n            fragmentSource: transformedFrag,\r\n            vertexSource: image_renderer_vert\r\n        });\r\n        this._shader.compile();\r\n        // setup uniforms\r\n        this._shader.use();\r\n        this._shader.setUniformMatrix('u_matrix', context.ortho);\r\n        // Initialize texture slots to [0, 1, 2, 3, 4, .... maxGPUTextures]\r\n        this._shader.setUniformIntArray('u_textures', [...Array(this._maxTextures)].map((_, i) => i));\r\n        // Setup memory layout\r\n        this._buffer = new VertexBuffer({\r\n            size: 6 * 4 * this._maxImages,\r\n            type: 'dynamic'\r\n        });\r\n        this._layout = new VertexLayout({\r\n            shader: this._shader,\r\n            vertexBuffer: this._buffer,\r\n            attributes: [\r\n                ['a_position', 2],\r\n                ['a_opacity', 1],\r\n                ['a_texcoord', 2],\r\n                ['a_textureIndex', 1]\r\n            ]\r\n        });\r\n        // Setup index buffer\r\n        this._quads = new QuadIndexBuffer(this._maxImages, true);\r\n    }\r\n    _transformFragmentSource(source, maxTextures) {\r\n        let newSource = source.replace('%%count%%', maxTextures.toString());\r\n        let texturePickerBuilder = '';\r\n        for (let i = 0; i < maxTextures; i++) {\r\n            if (i === 0) {\r\n                texturePickerBuilder += `if (v_textureIndex <= ${i}.5) {\\n`;\r\n            }\r\n            else {\r\n                texturePickerBuilder += `   else if (v_textureIndex <= ${i}.5) {\\n`;\r\n            }\r\n            texturePickerBuilder += `      color = texture2D(u_textures[${i}], v_texcoord);\\n`;\r\n            texturePickerBuilder += `   }\\n`;\r\n        }\r\n        newSource = newSource.replace('%%texture_picker%%', texturePickerBuilder);\r\n        return newSource;\r\n    }\r\n    _addImageAsTexture(image) {\r\n        const texture = TextureLoader.load(image);\r\n        if (this._textures.indexOf(texture) === -1) {\r\n            this._textures.push(texture);\r\n        }\r\n    }\r\n    _bindTextures(gl) {\r\n        // Bind textures in the correct order\r\n        for (let i = 0; i < this._maxTextures; i++) {\r\n            gl.activeTexture(gl.TEXTURE0 + i);\r\n            gl.bindTexture(gl.TEXTURE_2D, this._textures[i] || this._textures[0]);\r\n        }\r\n    }\r\n    _getTextureIdForImage(image) {\r\n        if (image) {\r\n            return this._textures.indexOf(TextureLoader.get(image));\r\n        }\r\n        return -1;\r\n    }\r\n    _isFull() {\r\n        if (this._imageCount >= this._maxImages) {\r\n            return true;\r\n        }\r\n        if (this._textures.length >= this._maxTextures) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    draw(image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight) {\r\n        var _a, _b, _c, _d;\r\n        // Force a render if the batch is full\r\n        if (this._isFull()) {\r\n            this.flush();\r\n        }\r\n        this._imageCount++;\r\n        this._addImageAsTexture(image);\r\n        let width = (image === null || image === void 0 ? void 0 : image.width) || swidth || 0;\r\n        let height = (image === null || image === void 0 ? void 0 : image.height) || sheight || 0;\r\n        let view = [0, 0, (_a = swidth !== null && swidth !== void 0 ? swidth : image === null || image === void 0 ? void 0 : image.width) !== null && _a !== void 0 ? _a : 0, (_b = sheight !== null && sheight !== void 0 ? sheight : image === null || image === void 0 ? void 0 : image.height) !== null && _b !== void 0 ? _b : 0];\r\n        let dest = [sx !== null && sx !== void 0 ? sx : 1, sy !== null && sy !== void 0 ? sy : 1];\r\n        // If destination is specified, update view and dest\r\n        if (dx !== undefined && dy !== undefined && dwidth !== undefined && dheight !== undefined) {\r\n            view = [sx !== null && sx !== void 0 ? sx : 1, sy !== null && sy !== void 0 ? sy : 1, (_c = swidth !== null && swidth !== void 0 ? swidth : image === null || image === void 0 ? void 0 : image.width) !== null && _c !== void 0 ? _c : 0, (_d = sheight !== null && sheight !== void 0 ? sheight : image === null || image === void 0 ? void 0 : image.height) !== null && _d !== void 0 ? _d : 0];\r\n            dest = [dx, dy];\r\n            width = dwidth;\r\n            height = dheight;\r\n        }\r\n        sx = view[0];\r\n        sy = view[1];\r\n        const sw = view[2];\r\n        const sh = view[3];\r\n        // transform based on current context\r\n        const transform = this._context.getTransform();\r\n        const opacity = this._context.opacity;\r\n        const snapToPixel = this._context.snapToPixel;\r\n        const topleft = transform.multv([dest[0], dest[1]]);\r\n        const topRight = transform.multv([dest[0] + width, dest[1]]);\r\n        const bottomLeft = transform.multv([dest[0], dest[1] + height]);\r\n        const bottomRight = transform.multv([dest[0] + width, dest[1] + height]);\r\n        if (snapToPixel) {\r\n            topleft[0] = ~~topleft[0];\r\n            topleft[1] = ~~topleft[1];\r\n            topRight[0] = ~~topRight[0];\r\n            topRight[1] = ~~topRight[1];\r\n            bottomLeft[0] = ~~bottomLeft[0];\r\n            bottomLeft[1] = ~~bottomLeft[1];\r\n            bottomRight[0] = ~~bottomRight[0];\r\n            bottomRight[1] = ~~bottomRight[1];\r\n        }\r\n        const textureId = this._getTextureIdForImage(image);\r\n        const potWidth = ensurePowerOfTwo(image.width || width);\r\n        const potHeight = ensurePowerOfTwo(image.height || height);\r\n        const uvx0 = (sx) / potWidth;\r\n        const uvy0 = (sy) / potHeight;\r\n        const uvx1 = (sx + sw - 0.01) / potWidth;\r\n        const uvy1 = (sy + sh - 0.01) / potHeight;\r\n        // update data\r\n        const vertexBuffer = this._layout.vertexBuffer.bufferData;\r\n        // (0, 0) - 0\r\n        vertexBuffer[this._vertexIndex++] = topleft[0];\r\n        vertexBuffer[this._vertexIndex++] = topleft[1];\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = uvx0;\r\n        vertexBuffer[this._vertexIndex++] = uvy0;\r\n        vertexBuffer[this._vertexIndex++] = textureId;\r\n        // (0, 1) - 1\r\n        vertexBuffer[this._vertexIndex++] = bottomLeft[0];\r\n        vertexBuffer[this._vertexIndex++] = bottomLeft[1];\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = uvx0;\r\n        vertexBuffer[this._vertexIndex++] = uvy1;\r\n        vertexBuffer[this._vertexIndex++] = textureId;\r\n        // (1, 0) - 2\r\n        vertexBuffer[this._vertexIndex++] = topRight[0];\r\n        vertexBuffer[this._vertexIndex++] = topRight[1];\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = uvx1;\r\n        vertexBuffer[this._vertexIndex++] = uvy0;\r\n        vertexBuffer[this._vertexIndex++] = textureId;\r\n        // (1, 1) - 3\r\n        vertexBuffer[this._vertexIndex++] = bottomRight[0];\r\n        vertexBuffer[this._vertexIndex++] = bottomRight[1];\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = uvx1;\r\n        vertexBuffer[this._vertexIndex++] = uvy1;\r\n        vertexBuffer[this._vertexIndex++] = textureId;\r\n    }\r\n    hasPendingDraws() {\r\n        return this._imageCount !== 0;\r\n    }\r\n    flush() {\r\n        // nothing to draw early exit\r\n        if (this._imageCount === 0) {\r\n            return;\r\n        }\r\n        const gl = this._gl;\r\n        // Bind the shader\r\n        this._shader.use();\r\n        // Bind the memory layout and upload data\r\n        this._layout.use(true);\r\n        // Update ortho matrix uniform\r\n        this._shader.setUniformMatrix('u_matrix', this._context.ortho);\r\n        // Bind textures to\r\n        this._bindTextures(gl);\r\n        // Bind index buffer\r\n        this._quads.bind();\r\n        // Draw all the quads\r\n        gl.drawElements(gl.TRIANGLES, this._imageCount * 6, this._quads.bufferGlType, 0);\r\n        GraphicsDiagnostics.DrawnImagesCount += this._imageCount;\r\n        GraphicsDiagnostics.DrawCallCount++;\r\n        // Reset\r\n        this._imageCount = 0;\r\n        this._vertexIndex = 0;\r\n        this._textures.length = 0;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/rectangle-renderer/rectangle-renderer.frag.glsl\n/* harmony default export */ const rectangle_renderer_frag = (\"#ifdef GL_OES_standard_derivatives\\r\\n#extension GL_OES_standard_derivatives : enable\\r\\n#endif\\r\\nprecision mediump float;\\r\\n\\r\\n// UV coord\\r\\nvarying vec2 v_uv;\\r\\n\\r\\nvarying vec2 v_size; // in pixels\\r\\n\\r\\n// Color coord to blend with image\\r\\nvarying lowp vec4 v_color;\\r\\n\\r\\n// Stroke color if used\\r\\nvarying lowp vec4 v_strokeColor;\\r\\n\\r\\n// Stroke thickness if used\\r\\nvarying lowp float v_strokeThickness; // in pixels\\r\\n\\r\\n// Opacity\\r\\nvarying float v_opacity;\\r\\n\\r\\nvoid main() {\\r\\n    // modified from https://stackoverflow.com/questions/59197671/glsl-rounded-rectangle-with-variable-border\\r\\n    vec2 uv = v_uv;\\r\\n    vec2 fragCoord = uv * v_size;\\r\\n    float maxX = v_size.x - v_strokeThickness;\\r\\n    float minX = v_strokeThickness;\\r\\n    float maxY = v_size.y - v_strokeThickness;\\r\\n    float minY = v_strokeThickness;\\r\\n\\r\\n    if (fragCoord.x < maxX && fragCoord.x > minX &&\\r\\n        fragCoord.y < maxY && fragCoord.y > minY) {\\r\\n      gl_FragColor = v_color;\\r\\n    } else {\\r\\n      gl_FragColor = v_strokeColor;\\r\\n    }\\r\\n    gl_FragColor.a *= v_opacity;\\r\\n    gl_FragColor.rgb *= gl_FragColor.a;\\r\\n\\r\\n    // vec2 v2CenteredPos     = abs(fragCoord - v_size.xy / 2.0);\\r\\n    // vec2 v2HalfShapeSizePx = v_size.xy/2.0 - v_strokeThickness/2.0;\\r\\n\\r\\n    // float fHalfBorderDist      = 0.0;\\r\\n    // float fHalfBorderThickness = 0.0;\\r\\n\\r\\n    // if (fragCoord.x > max(v_radius, v_strokeThickness) && \\r\\n    //     fragCoord.x < v_size.x - max(v_radius, v_strokeThickness))\\r\\n    // {\\r\\n    //     fHalfBorderDist      = v2CenteredPos.y - v2HalfShapeSizePx.y;\\r\\n    //     fHalfBorderThickness = v_strokeThickness / 2.0;\\r\\n    // }\\r\\n    // else if (fragCoord.y > max(v_radius, v_strokeThickness) && \\r\\n    //          fragCoord.y < v_size.y - max(v_radius, v_strokeThickness))\\r\\n    // {\\r\\n    //     fHalfBorderDist      = v2CenteredPos.x - v2HalfShapeSizePx.x;\\r\\n    //     fHalfBorderThickness = v_strokeThickness / 2.0;\\r\\n    // }\\r\\n    // else\\r\\n    // {\\r\\n    //     vec2 edgeVec = max(vec2(0.0), v_radius - vec2(\\r\\n    //         uv.x > 0.5 ? v_size.x - fragCoord.x : fragCoord.x,\\r\\n    //         uv.y > 0.5 ? v_size.y - fragCoord.y : fragCoord.y));\\r\\n        \\r\\n    //     float ellipse_ab    = v_radius-v_strokeThickness;\\r\\n    //     vec2 ellipse_isect = (v_strokeThickness > v_radius || v_strokeThickness > v_radius) ? vec2(0.0) :\\r\\n    //                             edgeVec.xy * ellipse_ab*ellipse_ab / length(ellipse_ab*edgeVec.yx); \\r\\n            \\r\\n    //     fHalfBorderThickness = (v_radius - length(ellipse_isect)) / 2.0;\\r\\n    //     fHalfBorderDist      = length(edgeVec) - (v_radius - fHalfBorderThickness);\\r\\n    // }\\r\\n\\r\\n    // vec4 v4FromColor = v_strokeColor;\\r\\n    // v4FromColor.rgb *= v4FromColor.a;\\r\\n    // vec4 v4ToColor   = vec4(0.0); // background color is transparent\\r\\n    // if (fHalfBorderDist < 0.0) {\\r\\n    //     v4ToColor = v_color;\\r\\n    //     v4ToColor.rgb *= v4ToColor.a;\\r\\n    // }\\r\\n\\r\\n    // float mixPct = abs(fHalfBorderDist) - fHalfBorderThickness;\\r\\n\\r\\n    // vec4 finalColor = mix(v4FromColor, v4ToColor, mixPct);\\r\\n    // gl_FragColor = finalColor;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/rectangle-renderer/rectangle-renderer.vert.glsl\n/* harmony default export */ const rectangle_renderer_vert = (\"attribute vec2 a_position;\\r\\n\\r\\n// UV coordinate\\r\\nattribute vec2 a_uv;\\r\\nvarying vec2 v_uv;\\r\\n\\r\\nattribute vec2 a_size;\\r\\nvarying vec2 v_size;\\r\\n\\r\\n// Opacity \\r\\nattribute float a_opacity;\\r\\nvarying float v_opacity;\\r\\n\\r\\nattribute vec4 a_color;\\r\\nvarying vec4 v_color;\\r\\n\\r\\nattribute vec4 a_strokeColor;\\r\\nvarying vec4 v_strokeColor;\\r\\n\\r\\nattribute float a_strokeThickness;\\r\\nvarying float v_strokeThickness;\\r\\n\\r\\nuniform mat4 u_matrix;\\r\\n\\r\\n\\r\\nvoid main() {\\r\\n   // Set the vertex position using the ortho transform matrix\\r\\n   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\\r\\n\\r\\n   // Pass through UV coords\\r\\n   v_uv = a_uv;\\r\\n   // Pass through size\\r\\n   v_size = a_size;\\r\\n   // Pass through the Opacity to the fragment shader\\r\\n   v_opacity = a_opacity;\\r\\n   // Pass through the color to the fragment shader\\r\\n   v_color = a_color;\\r\\n   // Pass through the stroke color to the fragment shader\\r\\n   v_strokeColor = a_strokeColor;\\r\\n   // Pass through the stroke thickenss to the fragment shader\\r\\n   v_strokeThickness = a_strokeThickness;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/rectangle-renderer/rectangle-renderer.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass RectangleRenderer {\r\n    constructor() {\r\n        this.type = 'ex.rectangle';\r\n        this.priority = 0;\r\n        this._maxRectangles = 10922; // max(uint16) / 6 verts\r\n        this._rectangleCount = 0;\r\n        this._vertexIndex = 0;\r\n    }\r\n    initialize(gl, context) {\r\n        this._gl = gl;\r\n        this._context = context;\r\n        gl.getExtension('OES_standard_derivatives');\r\n        // https://stackoverflow.com/questions/59197671/glsl-rounded-rectangle-with-variable-border\r\n        this._shader = new Shader({\r\n            fragmentSource: rectangle_renderer_frag,\r\n            vertexSource: rectangle_renderer_vert\r\n        });\r\n        this._shader.compile();\r\n        // setup uniforms\r\n        this._shader.use();\r\n        this._shader.setUniformMatrix('u_matrix', context.ortho);\r\n        this._buffer = new VertexBuffer({\r\n            size: 16 * 4 * this._maxRectangles,\r\n            type: 'dynamic'\r\n        });\r\n        this._layout = new VertexLayout({\r\n            shader: this._shader,\r\n            vertexBuffer: this._buffer,\r\n            attributes: [\r\n                ['a_position', 2],\r\n                ['a_uv', 2],\r\n                ['a_size', 2],\r\n                ['a_opacity', 1],\r\n                ['a_color', 4],\r\n                ['a_strokeColor', 4],\r\n                ['a_strokeThickness', 1]\r\n            ]\r\n        });\r\n        this._quads = new QuadIndexBuffer(this._maxRectangles, true);\r\n    }\r\n    _isFull() {\r\n        if (this._rectangleCount >= this._maxRectangles) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    drawLine(start, end, color, thickness = 1) {\r\n        if (this._isFull()) {\r\n            this.flush();\r\n        }\r\n        this._rectangleCount++;\r\n        // transform based on current context\r\n        const transform = this._context.getTransform();\r\n        const opacity = this._context.opacity;\r\n        const dir = end.sub(start);\r\n        const length = dir.size;\r\n        const normal = dir.normalize().perpendicular();\r\n        const halfThick = thickness / 2;\r\n        /**\r\n         *    +---------------------^----------------------+\r\n         *    |                     | (normal)             |\r\n         *   (startx, starty)------------------>(endx, endy)\r\n         *    |                                            |\r\n         *    + -------------------------------------------+\r\n         */\r\n        const startTop = transform.multv(normal.scale(halfThick).add(start));\r\n        const startBottom = transform.multv(normal.scale(-halfThick).add(start));\r\n        const endTop = transform.multv(normal.scale(halfThick).add(end));\r\n        const endBottom = transform.multv(normal.scale(-halfThick).add(end));\r\n        // TODO uv could be static vertex buffer\r\n        const uvx0 = 0;\r\n        const uvy0 = 0;\r\n        const uvx1 = 1;\r\n        const uvy1 = 1;\r\n        const stroke = Color.Transparent;\r\n        const strokeThickness = 0;\r\n        const width = 1;\r\n        // update data\r\n        const vertexBuffer = this._layout.vertexBuffer.bufferData;\r\n        // (0, 0) - 0\r\n        vertexBuffer[this._vertexIndex++] = startTop.x;\r\n        vertexBuffer[this._vertexIndex++] = startTop.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx0;\r\n        vertexBuffer[this._vertexIndex++] = uvy0;\r\n        vertexBuffer[this._vertexIndex++] = length;\r\n        vertexBuffer[this._vertexIndex++] = thickness;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness / width;\r\n        // (0, 1) - 1\r\n        vertexBuffer[this._vertexIndex++] = startBottom.x;\r\n        vertexBuffer[this._vertexIndex++] = startBottom.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx0;\r\n        vertexBuffer[this._vertexIndex++] = uvy1;\r\n        vertexBuffer[this._vertexIndex++] = length;\r\n        vertexBuffer[this._vertexIndex++] = thickness;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness / width;\r\n        // (1, 0) - 2\r\n        vertexBuffer[this._vertexIndex++] = endTop.x;\r\n        vertexBuffer[this._vertexIndex++] = endTop.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx1;\r\n        vertexBuffer[this._vertexIndex++] = uvy0;\r\n        vertexBuffer[this._vertexIndex++] = length;\r\n        vertexBuffer[this._vertexIndex++] = thickness;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness / width;\r\n        // (1, 1) - 3\r\n        vertexBuffer[this._vertexIndex++] = endBottom.x;\r\n        vertexBuffer[this._vertexIndex++] = endBottom.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx1;\r\n        vertexBuffer[this._vertexIndex++] = uvy1;\r\n        vertexBuffer[this._vertexIndex++] = length;\r\n        vertexBuffer[this._vertexIndex++] = thickness;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness / width;\r\n    }\r\n    draw(pos, width, height, color, stroke = Color.Transparent, strokeThickness = 0) {\r\n        if (this._isFull()) {\r\n            this.flush();\r\n        }\r\n        this._rectangleCount++;\r\n        // transform based on current context\r\n        const transform = this._context.getTransform();\r\n        const opacity = this._context.opacity;\r\n        const topLeft = transform.multv(pos.add(vec(0, 0)));\r\n        const topRight = transform.multv(pos.add(vec(width, 0)));\r\n        const bottomRight = transform.multv(pos.add(vec(width, height)));\r\n        const bottomLeft = transform.multv(pos.add(vec(0, height)));\r\n        // TODO uv could be static vertex buffer\r\n        const uvx0 = 0;\r\n        const uvy0 = 0;\r\n        const uvx1 = 1;\r\n        const uvy1 = 1;\r\n        // update data\r\n        const vertexBuffer = this._layout.vertexBuffer.bufferData;\r\n        // (0, 0) - 0\r\n        vertexBuffer[this._vertexIndex++] = topLeft.x;\r\n        vertexBuffer[this._vertexIndex++] = topLeft.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx0;\r\n        vertexBuffer[this._vertexIndex++] = uvy0;\r\n        vertexBuffer[this._vertexIndex++] = width;\r\n        vertexBuffer[this._vertexIndex++] = height;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness;\r\n        // (0, 1) - 1\r\n        vertexBuffer[this._vertexIndex++] = bottomLeft.x;\r\n        vertexBuffer[this._vertexIndex++] = bottomLeft.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx0;\r\n        vertexBuffer[this._vertexIndex++] = uvy1;\r\n        vertexBuffer[this._vertexIndex++] = width;\r\n        vertexBuffer[this._vertexIndex++] = height;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness;\r\n        // (1, 0) - 2\r\n        vertexBuffer[this._vertexIndex++] = topRight.x;\r\n        vertexBuffer[this._vertexIndex++] = topRight.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx1;\r\n        vertexBuffer[this._vertexIndex++] = uvy0;\r\n        vertexBuffer[this._vertexIndex++] = width;\r\n        vertexBuffer[this._vertexIndex++] = height;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness;\r\n        // (1, 1) - 3\r\n        vertexBuffer[this._vertexIndex++] = bottomRight.x;\r\n        vertexBuffer[this._vertexIndex++] = bottomRight.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx1;\r\n        vertexBuffer[this._vertexIndex++] = uvy1;\r\n        vertexBuffer[this._vertexIndex++] = width;\r\n        vertexBuffer[this._vertexIndex++] = height;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness;\r\n    }\r\n    hasPendingDraws() {\r\n        return this._rectangleCount !== 0;\r\n    }\r\n    flush() {\r\n        // nothing to draw early exit\r\n        if (this._rectangleCount === 0) {\r\n            return;\r\n        }\r\n        const gl = this._gl;\r\n        // Bind the shader\r\n        this._shader.use();\r\n        // Bind the memory layout and upload data\r\n        this._layout.use(true);\r\n        // Update ortho matrix uniform\r\n        this._shader.setUniformMatrix('u_matrix', this._context.ortho);\r\n        // Bind index buffer\r\n        this._quads.bind();\r\n        // Draw all the quads\r\n        gl.drawElements(gl.TRIANGLES, this._rectangleCount * 6, this._quads.bufferGlType, 0);\r\n        GraphicsDiagnostics.DrawnImagesCount += this._rectangleCount;\r\n        GraphicsDiagnostics.DrawCallCount++;\r\n        // Reset\r\n        this._rectangleCount = 0;\r\n        this._vertexIndex = 0;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/circle-renderer/circle-renderer.frag.glsl\n/* harmony default export */ const circle_renderer_frag = (\"#ifdef GL_OES_standard_derivatives\\r\\n#extension GL_OES_standard_derivatives : enable\\r\\n#endif\\r\\nprecision highp float;\\r\\n\\r\\n// UV coord\\r\\nvarying vec2 v_uv;\\r\\n\\r\\n// Color coord to blend with image\\r\\nvarying lowp vec4 v_color;\\r\\n\\r\\n// Stroke color if used\\r\\nvarying lowp vec4 v_strokeColor;\\r\\n\\r\\n// Stroke thickness if used\\r\\nvarying lowp float v_strokeThickness;\\r\\n\\r\\n// Opacity\\r\\nvarying float v_opacity;\\r\\n\\r\\nvoid main() {\\r\\n  // make (0, 0) the center the uv \\r\\n  vec2 uv = v_uv * 2.0 - 1.0;\\r\\n\\r\\n  vec4 color = v_color;\\r\\n  vec4 strokeColor = v_strokeColor;\\r\\n\\r\\n  // circle border is at radius 1.0 \\r\\n  // dist is > 0 when inside the circle \\r\\n  float d = length(uv);\\r\\n  float dist = 1.0 - length(uv);\\r\\n\\r\\n  // Fade based on fwidth\\r\\n  float fade = fwidth(dot(uv, uv));\\r\\n\\r\\n  // if dist is greater than 0 step to 1;\\r\\n  // when we cross this 0 threshold add a smooth fade\\r\\n  float fill = smoothstep(-fade/2.0, fade/2.0, dist);\\r\\n\\r\\n  // if dist is greater than the stroke thickness step to 1\\r\\n  float stroke = 1.0 - smoothstep(v_strokeThickness, v_strokeThickness + fade, dist);\\r\\n\\r\\n  strokeColor.a *= fill * stroke;\\r\\n  strokeColor.rgb *= strokeColor.a;\\r\\n\\r\\n  color.a *= fill * (1.0 - stroke);\\r\\n  color.rgb *= color.a;\\r\\n\\r\\n  vec4 finalColor = mix(vec4(0.0), (color + strokeColor), fill);\\r\\n  finalColor.rgb = finalColor.rgb * v_opacity;\\r\\n  finalColor.a = finalColor.a * v_opacity;\\r\\n  gl_FragColor = finalColor;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/circle-renderer/circle-renderer.vert.glsl\n/* harmony default export */ const circle_renderer_vert = (\"attribute vec2 a_position;\\r\\n\\r\\n// UV coordinate\\r\\nattribute vec2 a_uv;\\r\\nvarying vec2 v_uv;\\r\\n\\r\\n// Opacity \\r\\nattribute float a_opacity;\\r\\nvarying float v_opacity;\\r\\n\\r\\nattribute vec4 a_color;\\r\\nvarying vec4 v_color;\\r\\n\\r\\nattribute vec4 a_strokeColor;\\r\\nvarying vec4 v_strokeColor;\\r\\n\\r\\nattribute float a_strokeThickness;\\r\\nvarying float v_strokeThickness;\\r\\n\\r\\nuniform mat4 u_matrix;\\r\\n\\r\\n\\r\\nvoid main() {\\r\\n   // Set the vertex position using the ortho transform matrix\\r\\n   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\\r\\n\\r\\n   // Pass through UV coords\\r\\n   v_uv = a_uv;\\r\\n   // Pass through the Opacity to the fragment shader\\r\\n   v_opacity = a_opacity;\\r\\n   // Pass through the color to the fragment shader\\r\\n   v_color = a_color;\\r\\n   // Pass through the stroke color to the fragment shader\\r\\n   v_strokeColor = a_strokeColor;\\r\\n   // Pass through the stroke thickenss to the fragment shader\\r\\n   v_strokeThickness = a_strokeThickness;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/circle-renderer/circle-renderer.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass CircleRenderer {\r\n    constructor() {\r\n        this.type = 'ex.circle';\r\n        this.priority = 0;\r\n        this._maxCircles = 10922; // max(uint16) / 6 verts\r\n        this._circleCount = 0;\r\n        this._vertexIndex = 0;\r\n    }\r\n    initialize(gl, context) {\r\n        this._gl = gl;\r\n        this._context = context;\r\n        gl.getExtension('OES_standard_derivatives');\r\n        this._shader = new Shader({\r\n            fragmentSource: circle_renderer_frag,\r\n            vertexSource: circle_renderer_vert\r\n        });\r\n        this._shader.compile();\r\n        // setup uniforms\r\n        this._shader.use();\r\n        this._shader.setUniformMatrix('u_matrix', context.ortho);\r\n        this._buffer = new VertexBuffer({\r\n            size: 14 * 4 * this._maxCircles,\r\n            type: 'dynamic'\r\n        });\r\n        this._layout = new VertexLayout({\r\n            shader: this._shader,\r\n            vertexBuffer: this._buffer,\r\n            attributes: [\r\n                ['a_position', 2],\r\n                ['a_uv', 2],\r\n                ['a_opacity', 1],\r\n                ['a_color', 4],\r\n                ['a_strokeColor', 4],\r\n                ['a_strokeThickness', 1]\r\n            ]\r\n        });\r\n        this._quads = new QuadIndexBuffer(this._maxCircles, true);\r\n    }\r\n    _isFull() {\r\n        if (this._circleCount >= this._maxCircles) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    draw(pos, radius, color, stroke = Color.Transparent, strokeThickness = 0) {\r\n        if (this._isFull()) {\r\n            this.flush();\r\n        }\r\n        this._circleCount++;\r\n        // transform based on current context\r\n        const transform = this._context.getTransform();\r\n        const opacity = this._context.opacity;\r\n        const topLeft = transform.multv(pos.add(vec(-radius, -radius)));\r\n        const topRight = transform.multv(pos.add(vec(radius, -radius)));\r\n        const bottomRight = transform.multv(pos.add(vec(radius, radius)));\r\n        const bottomLeft = transform.multv(pos.add(vec(-radius, radius)));\r\n        // TODO UV could be static vertex buffer\r\n        const uvx0 = 0;\r\n        const uvy0 = 0;\r\n        const uvx1 = 1;\r\n        const uvy1 = 1;\r\n        // update data\r\n        const vertexBuffer = this._layout.vertexBuffer.bufferData;\r\n        // (0, 0) - 0\r\n        vertexBuffer[this._vertexIndex++] = topLeft.x;\r\n        vertexBuffer[this._vertexIndex++] = topLeft.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx0;\r\n        vertexBuffer[this._vertexIndex++] = uvy0;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness / radius;\r\n        // (0, 1) - 1\r\n        vertexBuffer[this._vertexIndex++] = bottomLeft.x;\r\n        vertexBuffer[this._vertexIndex++] = bottomLeft.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx0;\r\n        vertexBuffer[this._vertexIndex++] = uvy1;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness / radius;\r\n        // (1, 0) - 2\r\n        vertexBuffer[this._vertexIndex++] = topRight.x;\r\n        vertexBuffer[this._vertexIndex++] = topRight.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx1;\r\n        vertexBuffer[this._vertexIndex++] = uvy0;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness / radius;\r\n        // (1, 1) - 3\r\n        vertexBuffer[this._vertexIndex++] = bottomRight.x;\r\n        vertexBuffer[this._vertexIndex++] = bottomRight.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx1;\r\n        vertexBuffer[this._vertexIndex++] = uvy1;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness / radius;\r\n    }\r\n    hasPendingDraws() {\r\n        return this._circleCount !== 0;\r\n    }\r\n    flush() {\r\n        // nothing to draw early exit\r\n        if (this._circleCount === 0) {\r\n            return;\r\n        }\r\n        const gl = this._gl;\r\n        // Bind the shader\r\n        this._shader.use();\r\n        // Bind the memory layout and upload data\r\n        this._layout.use(true);\r\n        // Update ortho matrix uniform\r\n        this._shader.setUniformMatrix('u_matrix', this._context.ortho);\r\n        // Bind index buffer\r\n        this._quads.bind();\r\n        // Draw all the quads\r\n        gl.drawElements(gl.TRIANGLES, this._circleCount * 6, this._quads.bufferGlType, 0);\r\n        GraphicsDiagnostics.DrawnImagesCount += this._circleCount;\r\n        GraphicsDiagnostics.DrawCallCount++;\r\n        // Reset\r\n        this._circleCount = 0;\r\n        this._vertexIndex = 0;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/ExcaliburGraphicsContextWebGL.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// renderers\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass ExcaliburGraphicsContextWebGLDebug {\r\n    constructor(_webglCtx) {\r\n        this._webglCtx = _webglCtx;\r\n        this._debugText = new DebugText();\r\n    }\r\n    /**\r\n     * Draw a debugging rectangle to the context\r\n     * @param x\r\n     * @param y\r\n     * @param width\r\n     * @param height\r\n     */\r\n    drawRect(x, y, width, height, rectOptions = { color: Color.Black }) {\r\n        this.drawLine(vec(x, y), vec(x + width, y), { ...rectOptions });\r\n        this.drawLine(vec(x + width, y), vec(x + width, y + height), { ...rectOptions });\r\n        this.drawLine(vec(x + width, y + height), vec(x, y + height), { ...rectOptions });\r\n        this.drawLine(vec(x, y + height), vec(x, y), { ...rectOptions });\r\n    }\r\n    /**\r\n     * Draw a debugging line to the context\r\n     * @param start\r\n     * @param end\r\n     * @param lineOptions\r\n     */\r\n    drawLine(start, end, lineOptions = { color: Color.Black }) {\r\n        this._webglCtx.draw('ex.line', start, end, lineOptions.color);\r\n    }\r\n    /**\r\n     * Draw a debugging point to the context\r\n     * @param point\r\n     * @param pointOptions\r\n     */\r\n    drawPoint(point, pointOptions = { color: Color.Black, size: 5 }) {\r\n        this._webglCtx.draw('ex.point', point, pointOptions.color, pointOptions.size);\r\n    }\r\n    drawText(text, pos) {\r\n        this._debugText.write(this._webglCtx, text, pos);\r\n    }\r\n}\r\nclass ExcaliburGraphicsContextWebGL {\r\n    constructor(options) {\r\n        this._logger = Logger.getInstance();\r\n        this._renderers = new Map();\r\n        this._isDrawLifecycle = false;\r\n        // Postprocessing is a tuple with 2 render targets, these are flip-flopped during the postprocessing process\r\n        this._postProcessTargets = [];\r\n        this._postprocessors = [];\r\n        this._transform = new TransformStack();\r\n        this._state = new StateStack();\r\n        /**\r\n         * Meant for internal use only. Access the internal context at your own risk and no guarantees this will exist in the future.\r\n         * @internal\r\n         */\r\n        // public __imageRenderer: ImageRenderer;\r\n        this.snapToPixel = true;\r\n        this.smoothing = false;\r\n        this.backgroundColor = Color.ExcaliburBlue;\r\n        this._alreadyWarnedDrawLifecycle = false;\r\n        this.debug = new ExcaliburGraphicsContextWebGLDebug(this);\r\n        const { canvasElement, enableTransparency, smoothing, snapToPixel, backgroundColor } = options;\r\n        this.__gl = canvasElement.getContext('webgl', {\r\n            antialias: smoothing !== null && smoothing !== void 0 ? smoothing : this.smoothing,\r\n            premultipliedAlpha: false,\r\n            alpha: enableTransparency !== null && enableTransparency !== void 0 ? enableTransparency : true,\r\n            depth: true,\r\n            powerPreference: 'high-performance'\r\n        });\r\n        ExcaliburWebGLContextAccessor.register(this.__gl);\r\n        TextureLoader.register(this.__gl);\r\n        this.snapToPixel = snapToPixel !== null && snapToPixel !== void 0 ? snapToPixel : this.snapToPixel;\r\n        this.smoothing = smoothing !== null && smoothing !== void 0 ? smoothing : this.smoothing;\r\n        this.backgroundColor = backgroundColor !== null && backgroundColor !== void 0 ? backgroundColor : this.backgroundColor;\r\n        this._init();\r\n    }\r\n    get opacity() {\r\n        return this._state.current.opacity;\r\n    }\r\n    set opacity(value) {\r\n        this._state.current.opacity = value;\r\n    }\r\n    get width() {\r\n        return this.__gl.canvas.width;\r\n    }\r\n    get height() {\r\n        return this.__gl.canvas.height;\r\n    }\r\n    get ortho() {\r\n        return this._ortho;\r\n    }\r\n    /**\r\n     * Checks the underlying webgl implementation if the requested internal resolution is supported\r\n     * @param dim\r\n     */\r\n    checkIfResolutionSupported(dim) {\r\n        // Slight hack based on this thread https://groups.google.com/g/webgl-dev-list/c/AHONvz3oQTo\r\n        const gl = this.__gl;\r\n        // If any dimension is greater than max texture size (divide by 4 bytes per pixel)\r\n        const maxDim = gl.getParameter(gl.MAX_TEXTURE_SIZE) / 4;\r\n        let supported = true;\r\n        if (dim.width > maxDim || dim.height > maxDim) {\r\n            supported = false;\r\n        }\r\n        return supported;\r\n    }\r\n    _init() {\r\n        const gl = this.__gl;\r\n        // Setup viewport and view matrix\r\n        this._ortho = Matrix.ortho(0, gl.canvas.width, gl.canvas.height, 0, 400, -400);\r\n        gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);\r\n        // Clear background\r\n        gl.clearColor(this.backgroundColor.r / 255, this.backgroundColor.g / 255, this.backgroundColor.b / 255, this.backgroundColor.a);\r\n        gl.clear(gl.COLOR_BUFFER_BIT);\r\n        // Enable alpha blending\r\n        // https://www.realtimerendering.com/blog/gpus-prefer-premultiplication/\r\n        gl.enable(gl.BLEND);\r\n        gl.blendEquation(gl.FUNC_ADD);\r\n        gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\r\n        gl.blendEquationSeparate(gl.FUNC_ADD, gl.FUNC_ADD);\r\n        gl.blendFuncSeparate(gl.ONE, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\r\n        // Setup builtin renderers\r\n        this.register(new ImageRenderer());\r\n        this.register(new RectangleRenderer());\r\n        this.register(new CircleRenderer());\r\n        this.register(new PointRenderer());\r\n        this.register(new LineRenderer());\r\n        this._screenRenderer = new ScreenPassPainter(gl);\r\n        this._renderTarget = new RenderTarget({\r\n            gl,\r\n            width: gl.canvas.width,\r\n            height: gl.canvas.height\r\n        });\r\n        this._postProcessTargets = [\r\n            new RenderTarget({\r\n                gl,\r\n                width: gl.canvas.width,\r\n                height: gl.canvas.height\r\n            }),\r\n            new RenderTarget({\r\n                gl,\r\n                width: gl.canvas.width,\r\n                height: gl.canvas.height\r\n            })\r\n        ];\r\n        // 2D ctx shim\r\n        this._canvas = new Canvas({\r\n            width: gl.canvas.width,\r\n            height: gl.canvas.height\r\n        });\r\n        this.__ctx = this._canvas.ctx;\r\n    }\r\n    register(renderer) {\r\n        this._renderers.set(renderer.type, renderer);\r\n        renderer.initialize(this.__gl, this);\r\n    }\r\n    get(rendererName) {\r\n        return this._renderers.get(rendererName);\r\n    }\r\n    _isCurrentRenderer(renderer) {\r\n        if (!this._currentRenderer || this._currentRenderer === renderer) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    beginDrawLifecycle() {\r\n        this._isDrawLifecycle = true;\r\n    }\r\n    endDrawLifecycle() {\r\n        this._isDrawLifecycle = false;\r\n    }\r\n    draw(rendererName, ...args) {\r\n        if (!this._isDrawLifecycle && !this._alreadyWarnedDrawLifecycle) {\r\n            this._logger.warn(`Attempting to draw outside the the drawing lifecycle (preDraw/postDraw) is not supported and is a source of bugs/errors.\\n` +\r\n                `If you want to do custom drawing, use Actor.graphics, or any onPreDraw or onPostDraw handler.`);\r\n            this._alreadyWarnedDrawLifecycle = true;\r\n        }\r\n        // TODO does not handle priority yet...\r\n        //  in order to do this draw commands need to be captured and fed in priority order\r\n        const renderer = this._renderers.get(rendererName);\r\n        if (renderer) {\r\n            // Set the current renderer if not defined\r\n            if (!this._currentRenderer) {\r\n                this._currentRenderer = renderer;\r\n            }\r\n            if (!this._isCurrentRenderer(renderer)) {\r\n                // switching graphics means we must flush the previous\r\n                this._currentRenderer.flush();\r\n            }\r\n            // If we are still using the same renderer we can add to the current batch\r\n            renderer.draw(...args);\r\n            this._currentRenderer = renderer;\r\n        }\r\n        else {\r\n            throw Error(`No renderer with name ${rendererName} has been registered`);\r\n        }\r\n    }\r\n    resetTransform() {\r\n        this._transform.current = Matrix.identity();\r\n    }\r\n    updateViewport(resolution) {\r\n        const gl = this.__gl;\r\n        this._ortho = this._ortho = Matrix.ortho(0, resolution.width, resolution.height, 0, 400, -400);\r\n        this._renderTarget.setResolution(gl.canvas.width, gl.canvas.height);\r\n        this._postProcessTargets[0].setResolution(gl.canvas.width, gl.canvas.height);\r\n        this._postProcessTargets[1].setResolution(gl.canvas.width, gl.canvas.height);\r\n        // 2D ctx shim\r\n        this._canvas.width = gl.canvas.width;\r\n        this._canvas.height = gl.canvas.height;\r\n    }\r\n    drawImage(image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight) {\r\n        if (swidth === 0 || sheight === 0) {\r\n            return; // zero dimension dest exit early\r\n        }\r\n        else if (dwidth === 0 || dheight === 0) {\r\n            return; // zero dimension dest exit early\r\n        }\r\n        else if (image.width === 0 || image.height === 0) {\r\n            return; // zero dimension source exit early\r\n        }\r\n        if (!image) {\r\n            Logger.getInstance().warn('Cannot draw a null or undefined image');\r\n            // tslint:disable-next-line: no-console\r\n            if (console.trace) {\r\n                // tslint:disable-next-line: no-console\r\n                console.trace();\r\n            }\r\n            return;\r\n        }\r\n        this.draw('ex.image', image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight);\r\n    }\r\n    drawLine(start, end, color, thickness = 1) {\r\n        const rectangleRenderer = this._renderers.get('ex.rectangle');\r\n        rectangleRenderer.drawLine(start, end, color, thickness);\r\n    }\r\n    drawRectangle(pos, width, height, color, stroke, strokeThickness) {\r\n        this.draw('ex.rectangle', pos, width, height, color, stroke, strokeThickness);\r\n    }\r\n    drawCircle(pos, radius, color, stroke, thickness) {\r\n        this.draw('ex.circle', pos, radius, color, stroke, thickness);\r\n    }\r\n    save() {\r\n        this._transform.save();\r\n        this._state.save();\r\n    }\r\n    restore() {\r\n        this._transform.restore();\r\n        this._state.restore();\r\n    }\r\n    translate(x, y) {\r\n        this._transform.translate(this.snapToPixel ? ~~x : x, this.snapToPixel ? ~~y : y);\r\n    }\r\n    rotate(angle) {\r\n        this._transform.rotate(angle);\r\n    }\r\n    scale(x, y) {\r\n        this._transform.scale(x, y);\r\n    }\r\n    transform(matrix) {\r\n        this._transform.current = matrix;\r\n    }\r\n    getTransform() {\r\n        return this._transform.current;\r\n    }\r\n    multiply(m) {\r\n        this._transform.current = this._transform.current.multm(m);\r\n    }\r\n    addPostProcessor(postprocessor) {\r\n        this._postprocessors.push(postprocessor);\r\n        postprocessor.initialize(this.__gl);\r\n    }\r\n    removePostProcessor(postprocessor) {\r\n        const index = this._postprocessors.indexOf(postprocessor);\r\n        if (index !== -1) {\r\n            this._postprocessors.splice(index, 1);\r\n        }\r\n    }\r\n    clearPostProcessors() {\r\n        this._postprocessors.length = 0;\r\n    }\r\n    clear() {\r\n        const gl = this.__gl;\r\n        this._renderTarget.use();\r\n        gl.clearColor(this.backgroundColor.r / 255, this.backgroundColor.g / 255, this.backgroundColor.b / 255, this.backgroundColor.a);\r\n        // Clear the context with the newly set color. This is\r\n        // the function call that actually does the drawing.\r\n        gl.clear(gl.COLOR_BUFFER_BIT);\r\n    }\r\n    /**\r\n     * Flushes all batched rendering to the screen\r\n     */\r\n    flush() {\r\n        const gl = this.__gl;\r\n        // render target captures all draws and redirects to the render target\r\n        this._renderTarget.use();\r\n        // This is the final flush at the moment to draw any leftover pending draw\r\n        // TODO sort by priority and flush in order\r\n        for (const renderer of this._renderers.values()) {\r\n            if (renderer.hasPendingDraws()) {\r\n                renderer.flush();\r\n            }\r\n        }\r\n        this._renderTarget.disable();\r\n        // post process step\r\n        const source = this._renderTarget.toRenderSource();\r\n        source.use();\r\n        // flip flop render targets\r\n        for (let i = 0; i < this._postprocessors.length; i++) {\r\n            this._postProcessTargets[i % 2].use();\r\n            this._screenRenderer.renderWithPostProcessor(this._postprocessors[i]);\r\n            this._postProcessTargets[i % 2].toRenderSource().use();\r\n        }\r\n        // passing null switches rendering back to the canvas\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n        this._screenRenderer.renderToScreen();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Screen.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Enum representing the different display modes available to Excalibur.\r\n */\r\nvar DisplayMode;\r\n(function (DisplayMode) {\r\n    /**\r\n     * Default, use a specified resolution for the game. Like 800x600 pixels for example.\r\n     */\r\n    DisplayMode[\"Fixed\"] = \"Fixed\";\r\n    /**\r\n     * Fit to screen using as much space as possible while maintaining aspect ratio and resolution.\r\n     * This is not the same as [[Screen.goFullScreen]] but behaves in a similar way maintaining aspect ratio.\r\n     *\r\n     * You may want to center your game here is an example\r\n     * ```html\r\n     * <!-- html -->\r\n     * <body>\r\n     * <main>\r\n     *   <canvas id=\"game\"></canvas>\r\n     * </main>\r\n     * </body>\r\n     * ```\r\n     *\r\n     * ```css\r\n     * // css\r\n     * main {\r\n     *   display: flex;\r\n     *   align-items: center;\r\n     *   justify-content: center;\r\n     *   height: 100%;\r\n     *   width: 100%;\r\n     * }\r\n     * ```\r\n     *\r\n     */\r\n    DisplayMode[\"FitScreen\"] = \"FitScreen\";\r\n    /**\r\n     * Fill the entire screen's css width/height for the game resolution dynamically. This means the resolution of the game will\r\n     * change dynamically as the window is resized. This is not the same as [[Screen.goFullScreen]]\r\n     */\r\n    DisplayMode[\"FillScreen\"] = \"FillScreen\";\r\n    /**\r\n     * Fit to parent element width/height using as much space as possible while maintaining aspect ratio and resolution.\r\n     */\r\n    DisplayMode[\"FitContainer\"] = \"FitContainer\";\r\n    /**\r\n     * Use the parent DOM container's css width/height for the game resolution dynamically\r\n     */\r\n    DisplayMode[\"FillContainer\"] = \"FillContainer\";\r\n    /**\r\n     * Allow the game to be positioned with the [[EngineOptions.position]] option\r\n     * @deprecated Use CSS to position the game canvas, will be removed in v0.26.0\r\n     */\r\n    DisplayMode[\"Position\"] = \"Position\";\r\n})(DisplayMode || (DisplayMode = {}));\r\n/**\r\n * Convenience class for quick resolutions\r\n * Mostly sourced from https://emulation.gametechwiki.com/index.php/Resolution\r\n */\r\nclass Resolution {\r\n    /* istanbul ignore next */\r\n    static get SVGA() {\r\n        return { width: 800, height: 600 };\r\n    }\r\n    /* istanbul ignore next */\r\n    static get Standard() {\r\n        return { width: 1920, height: 1080 };\r\n    }\r\n    /* istanbul ignore next */\r\n    static get Atari2600() {\r\n        return { width: 160, height: 192 };\r\n    }\r\n    /* istanbul ignore next */\r\n    static get GameBoy() {\r\n        return { width: 160, height: 144 };\r\n    }\r\n    /* istanbul ignore next */\r\n    static get GameBoyAdvance() {\r\n        return { width: 240, height: 160 };\r\n    }\r\n    /* istanbul ignore next */\r\n    static get NintendoDS() {\r\n        return { width: 256, height: 192 };\r\n    }\r\n    /* istanbul ignore next */\r\n    static get NES() {\r\n        return { width: 256, height: 224 };\r\n    }\r\n    /* istanbul ignore next */\r\n    static get SNES() {\r\n        return { width: 256, height: 244 };\r\n    }\r\n}\r\n/**\r\n * The Screen handles all aspects of interacting with the screen for Excalibur.\r\n */\r\nclass Screen {\r\n    constructor(options) {\r\n        var _a, _b, _c;\r\n        this._antialiasing = true;\r\n        this._resolutionStack = [];\r\n        this._viewportStack = [];\r\n        this._pixelRatioOverride = null;\r\n        this._isFullScreen = false;\r\n        this._isDisposed = false;\r\n        this._logger = Logger.getInstance();\r\n        this._fullscreenChangeHandler = () => {\r\n            this._isFullScreen = !this._isFullScreen;\r\n            this._logger.debug('Fullscreen Change', this._isFullScreen);\r\n        };\r\n        this._pixelRatioChangeHandler = () => {\r\n            this._logger.debug('Pixel Ratio Change', window.devicePixelRatio);\r\n            this._listenForPixelRatio();\r\n            this._devicePixelRatio = this._calculateDevicePixelRatio();\r\n            this.applyResolutionAndViewport();\r\n        };\r\n        this._resizeHandler = () => {\r\n            const parent = this.parent;\r\n            this._logger.debug('View port resized');\r\n            this._setResolutionAndViewportByDisplayMode(parent);\r\n            this.applyResolutionAndViewport();\r\n        };\r\n        // Asking the window.devicePixelRatio is expensive we do it once\r\n        this._devicePixelRatio = this._calculateDevicePixelRatio();\r\n        this._alreadyWarned = false;\r\n        this.viewport = options.viewport;\r\n        this.resolution = (_a = options.resolution) !== null && _a !== void 0 ? _a : { ...this.viewport };\r\n        this._displayMode = (_b = options.displayMode) !== null && _b !== void 0 ? _b : DisplayMode.Fixed;\r\n        this._canvas = options.canvas;\r\n        this.graphicsContext = options.context;\r\n        this._antialiasing = (_c = options.antialiasing) !== null && _c !== void 0 ? _c : this._antialiasing;\r\n        this._browser = options.browser;\r\n        this._position = options.position;\r\n        this._pixelRatioOverride = options.pixelRatio;\r\n        this._applyDisplayMode();\r\n        this._listenForPixelRatio();\r\n        this._canvas.addEventListener('fullscreenchange', this._fullscreenChangeHandler);\r\n        this.applyResolutionAndViewport();\r\n    }\r\n    _listenForPixelRatio() {\r\n        if (this._mediaQueryList && !this._mediaQueryList.addEventListener) {\r\n            // Safari <=13.1 workaround, remove any existing handlers\r\n            this._mediaQueryList.removeListener(this._pixelRatioChangeHandler);\r\n        }\r\n        this._mediaQueryList = this._browser.window.nativeComponent.matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);\r\n        // Safari <=13.1 workaround\r\n        if (this._mediaQueryList.addEventListener) {\r\n            this._mediaQueryList.addEventListener('change', this._pixelRatioChangeHandler, { once: true });\r\n        }\r\n        else {\r\n            this._mediaQueryList.addListener(this._pixelRatioChangeHandler);\r\n        }\r\n    }\r\n    dispose() {\r\n        if (!this._isDisposed) {\r\n            // Clean up handlers\r\n            this._isDisposed = true;\r\n            this._browser.window.off('resize', this._resizeHandler);\r\n            if (this._resizeObserver) {\r\n                this._resizeObserver.disconnect();\r\n            }\r\n            this.parent.removeEventListener('resize', this._resizeHandler);\r\n            // Safari <=13.1 workaround\r\n            if (this._mediaQueryList.removeEventListener) {\r\n                this._mediaQueryList.removeEventListener('change', this._pixelRatioChangeHandler);\r\n            }\r\n            else {\r\n                this._mediaQueryList.removeListener(this._pixelRatioChangeHandler);\r\n            }\r\n            this._canvas.removeEventListener('fullscreenchange', this._fullscreenChangeHandler);\r\n        }\r\n    }\r\n    _calculateDevicePixelRatio() {\r\n        if (window.devicePixelRatio < 1) {\r\n            return 1;\r\n        }\r\n        const devicePixelRatio = window.devicePixelRatio || 1;\r\n        return devicePixelRatio;\r\n    }\r\n    get pixelRatio() {\r\n        if (this._pixelRatioOverride) {\r\n            return this._pixelRatioOverride;\r\n        }\r\n        return this._devicePixelRatio;\r\n    }\r\n    get isHiDpi() {\r\n        return this.pixelRatio !== 1;\r\n    }\r\n    get displayMode() {\r\n        return this._displayMode;\r\n    }\r\n    get canvas() {\r\n        return this._canvas;\r\n    }\r\n    get parent() {\r\n        return ((this.displayMode === DisplayMode.FillContainer || this.displayMode === DisplayMode.FitContainer\r\n            ? this.canvas.parentElement || document.body\r\n            : window));\r\n    }\r\n    get resolution() {\r\n        return this._resolution;\r\n    }\r\n    set resolution(resolution) {\r\n        this._resolution = resolution;\r\n    }\r\n    get viewport() {\r\n        if (this._viewport) {\r\n            return this._viewport;\r\n        }\r\n        return this._resolution;\r\n    }\r\n    set viewport(viewport) {\r\n        this._viewport = viewport;\r\n    }\r\n    get aspectRatio() {\r\n        return this._resolution.width / this._resolution.height;\r\n    }\r\n    get scaledWidth() {\r\n        return this._resolution.width * this.pixelRatio;\r\n    }\r\n    get scaledHeight() {\r\n        return this._resolution.height * this.pixelRatio;\r\n    }\r\n    setCurrentCamera(camera) {\r\n        this._camera = camera;\r\n    }\r\n    pushResolutionAndViewport() {\r\n        this._resolutionStack.push(this.resolution);\r\n        this._viewportStack.push(this.viewport);\r\n        this.resolution = { ...this.resolution };\r\n        this.viewport = { ...this.viewport };\r\n    }\r\n    peekViewport() {\r\n        return this._viewportStack[this._viewportStack.length - 1];\r\n    }\r\n    peekResolution() {\r\n        return this._resolutionStack[this._resolutionStack.length - 1];\r\n    }\r\n    popResolutionAndViewport() {\r\n        this.resolution = this._resolutionStack.pop();\r\n        this.viewport = this._viewportStack.pop();\r\n    }\r\n    applyResolutionAndViewport() {\r\n        this._canvas.width = this.scaledWidth;\r\n        this._canvas.height = this.scaledHeight;\r\n        if (this.graphicsContext instanceof ExcaliburGraphicsContextWebGL) {\r\n            const supported = this.graphicsContext.checkIfResolutionSupported({\r\n                width: this.scaledWidth,\r\n                height: this.scaledHeight\r\n            });\r\n            if (!supported && !this._alreadyWarned) {\r\n                this._alreadyWarned = true; // warn once\r\n                this._logger.warn(`The currently configured resolution (${this.resolution.width}x${this.resolution.height})` +\r\n                    ' is too large for the platform WebGL implementation, this may work but cause WebGL rendering to behave oddly.' +\r\n                    ' Try reducing the resolution or disabling Hi DPI scaling to avoid this' +\r\n                    ' (read more here https://excaliburjs.com/docs/screens#understanding-viewport--resolution).');\r\n            }\r\n        }\r\n        if (this._antialiasing) {\r\n            this._canvas.style.imageRendering = 'auto';\r\n        }\r\n        else {\r\n            this._canvas.style.imageRendering = 'pixelated';\r\n            // Fall back to 'crisp-edges' if 'pixelated' is not supported\r\n            // Currently for firefox https://developer.mozilla.org/en-US/docs/Web/CSS/image-rendering\r\n            if (this._canvas.style.imageRendering === '') {\r\n                this._canvas.style.imageRendering = 'crisp-edges';\r\n            }\r\n        }\r\n        this._canvas.style.width = this.viewport.width + 'px';\r\n        this._canvas.style.height = this.viewport.height + 'px';\r\n        // After messing with the canvas width/height the graphics context is invalidated and needs to have some properties reset\r\n        this.graphicsContext.updateViewport(this.resolution);\r\n        this.graphicsContext.resetTransform();\r\n        this.graphicsContext.smoothing = this._antialiasing;\r\n    }\r\n    get antialiasing() {\r\n        return this._antialiasing;\r\n    }\r\n    set antialiasing(isSmooth) {\r\n        this._antialiasing = isSmooth;\r\n        this.graphicsContext.smoothing = this._antialiasing;\r\n    }\r\n    /**\r\n     * Returns true if excalibur is fullscreen using the browser fullscreen api\r\n     */\r\n    get isFullScreen() {\r\n        return this._isFullScreen;\r\n    }\r\n    /**\r\n     * Requests to go fullscreen using the browser fullscreen api, requires user interaction to be successful.\r\n     * For example, wire this to a user click handler.\r\n     */\r\n    goFullScreen() {\r\n        return this._canvas.requestFullscreen();\r\n    }\r\n    /**\r\n     * Requests to exit fullscreen using the browser fullscreen api\r\n     */\r\n    exitFullScreen() {\r\n        return document.exitFullscreen();\r\n    }\r\n    /**\r\n     * Takes a coordinate in normal html page space, for example from a pointer move event, and translates it to\r\n     * Excalibur screen space.\r\n     *\r\n     * Excalibur screen space starts at the top left (0, 0) corner of the viewport, and extends to the\r\n     * bottom right corner (resolutionX, resolutionY)\r\n     * @param point\r\n     */\r\n    pageToScreenCoordinates(point) {\r\n        let newX = point.x;\r\n        let newY = point.y;\r\n        if (!this._isFullScreen) {\r\n            newX -= getPosition(this._canvas).x;\r\n            newY -= getPosition(this._canvas).y;\r\n        }\r\n        // if fullscreen api on it centers with black bars\r\n        // we need to adjust the screen to world coordinates in this case\r\n        if (this._isFullScreen) {\r\n            if (window.innerWidth / this.aspectRatio < window.innerHeight) {\r\n                const screenHeight = window.innerWidth / this.aspectRatio;\r\n                const screenMarginY = (window.innerHeight - screenHeight) / 2;\r\n                newY = ((newY - screenMarginY) / screenHeight) * this.viewport.height;\r\n                newX = (newX / window.innerWidth) * this.viewport.width;\r\n            }\r\n            else {\r\n                const screenWidth = window.innerHeight * this.aspectRatio;\r\n                const screenMarginX = (window.innerWidth - screenWidth) / 2;\r\n                newX = ((newX - screenMarginX) / screenWidth) * this.viewport.width;\r\n                newY = (newY / window.innerHeight) * this.viewport.height;\r\n            }\r\n        }\r\n        newX = (newX / this.viewport.width) * this.resolution.width;\r\n        newY = (newY / this.viewport.height) * this.resolution.height;\r\n        return new Vector(newX, newY);\r\n    }\r\n    /**\r\n     * Takes a coordinate in Excalibur screen space, and translates it to normal html page space. For example,\r\n     * this is where html elements might live if you want to position them relative to Excalibur.\r\n     *\r\n     * Excalibur screen space starts at the top left (0, 0) corner of the viewport, and extends to the\r\n     * bottom right corner (resolutionX, resolutionY)\r\n     * @param point\r\n     */\r\n    screenToPageCoordinates(point) {\r\n        let newX = point.x;\r\n        let newY = point.y;\r\n        newX = (newX / this.resolution.width) * this.viewport.width;\r\n        newY = (newY / this.resolution.height) * this.viewport.height;\r\n        if (this._isFullScreen) {\r\n            if (window.innerWidth / this.aspectRatio < window.innerHeight) {\r\n                const screenHeight = window.innerWidth / this.aspectRatio;\r\n                const screenMarginY = (window.innerHeight - screenHeight) / 2;\r\n                newY = (newY / this.viewport.height) * screenHeight + screenMarginY;\r\n                newX = (newX / this.viewport.width) * window.innerWidth;\r\n            }\r\n            else {\r\n                const screenWidth = window.innerHeight * this.aspectRatio;\r\n                const screenMarginX = (window.innerWidth - screenWidth) / 2;\r\n                newX = (newX / this.viewport.width) * screenWidth + screenMarginX;\r\n                newY = (newY / this.viewport.height) * window.innerHeight;\r\n            }\r\n        }\r\n        if (!this._isFullScreen) {\r\n            newX += getPosition(this._canvas).x;\r\n            newY += getPosition(this._canvas).y;\r\n        }\r\n        return new Vector(newX, newY);\r\n    }\r\n    /**\r\n     * Takes a coordinate in Excalibur screen space, and translates it to Excalibur world space.\r\n     *\r\n     * World space is where [[Entity|entities]] in Excalibur live by default [[CoordPlane.World]]\r\n     * and extends infinitely out relative from the [[Camera]].\r\n     * @param point  Screen coordinate to convert\r\n     */\r\n    screenToWorldCoordinates(point) {\r\n        // the only difference between screen & world is the camera transform\r\n        if (this._camera) {\r\n            return this._camera.inverse.multv(point);\r\n        }\r\n        return point.sub(vec(this.resolution.width / 2, this.resolution.height / 2));\r\n    }\r\n    /**\r\n     * Takes a coordinate in Excalibur world space, and translates it to Excalibur screen space.\r\n     *\r\n     * Screen space is where [[ScreenElement|screen elements]] and [[Entity|entities]] with [[CoordPlane.Screen]] live.\r\n     * @param point  World coordinate to convert\r\n     */\r\n    worldToScreenCoordinates(point) {\r\n        if (this._camera) {\r\n            return this._camera.transform.multv(point);\r\n        }\r\n        return point.add(vec(this.resolution.width / 2, this.resolution.height / 2));\r\n    }\r\n    pageToWorldCoordinates(point) {\r\n        const screen = this.pageToScreenCoordinates(point);\r\n        return this.screenToWorldCoordinates(screen);\r\n    }\r\n    worldToPageCoordinates(point) {\r\n        const screen = this.worldToScreenCoordinates(point);\r\n        return this.screenToPageCoordinates(screen);\r\n    }\r\n    /**\r\n     * Returns a BoundingBox of the top left corner of the screen\r\n     * and the bottom right corner of the screen.\r\n     *\r\n     * World bounds are in world coordinates, useful for culling objects offscreen\r\n     */\r\n    getWorldBounds() {\r\n        const topLeft = this.screenToWorldCoordinates(Vector.Zero);\r\n        const right = topLeft.x + this.drawWidth;\r\n        const bottom = topLeft.y + this.drawHeight;\r\n        return new BoundingBox(topLeft.x, topLeft.y, right, bottom);\r\n    }\r\n    /**\r\n     * The width of the game canvas in pixels (physical width component of the\r\n     * resolution of the canvas element)\r\n     */\r\n    get canvasWidth() {\r\n        return this.canvas.width;\r\n    }\r\n    /**\r\n     * Returns half width of the game canvas in pixels (half physical width component)\r\n     */\r\n    get halfCanvasWidth() {\r\n        return this.canvas.width / 2;\r\n    }\r\n    /**\r\n     * The height of the game canvas in pixels, (physical height component of\r\n     * the resolution of the canvas element)\r\n     */\r\n    get canvasHeight() {\r\n        return this.canvas.height;\r\n    }\r\n    /**\r\n     * Returns half height of the game canvas in pixels (half physical height component)\r\n     */\r\n    get halfCanvasHeight() {\r\n        return this.canvas.height / 2;\r\n    }\r\n    /**\r\n     * Returns the width of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get drawWidth() {\r\n        if (this._camera) {\r\n            return this.resolution.width / this._camera.zoom;\r\n        }\r\n        return this.resolution.width;\r\n    }\r\n    /**\r\n     * Returns half the width of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get halfDrawWidth() {\r\n        return this.drawWidth / 2;\r\n    }\r\n    /**\r\n     * Returns the height of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get drawHeight() {\r\n        if (this._camera) {\r\n            return this.resolution.height / this._camera.zoom;\r\n        }\r\n        return this.resolution.height;\r\n    }\r\n    /**\r\n     * Returns half the height of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get halfDrawHeight() {\r\n        return this.drawHeight / 2;\r\n    }\r\n    /**\r\n     * Returns screen center coordinates including zoom and device pixel ratio.\r\n     */\r\n    get center() {\r\n        return vec(this.halfDrawWidth, this.halfDrawHeight);\r\n    }\r\n    _computeFit() {\r\n        document.body.style.margin = '0px';\r\n        document.body.style.overflow = 'hidden';\r\n        const aspect = this.aspectRatio;\r\n        let adjustedWidth = 0;\r\n        let adjustedHeight = 0;\r\n        if (window.innerWidth / aspect < window.innerHeight) {\r\n            adjustedWidth = window.innerWidth;\r\n            adjustedHeight = window.innerWidth / aspect;\r\n        }\r\n        else {\r\n            adjustedWidth = window.innerHeight * aspect;\r\n            adjustedHeight = window.innerHeight;\r\n        }\r\n        this.viewport = {\r\n            width: adjustedWidth,\r\n            height: adjustedHeight\r\n        };\r\n    }\r\n    _computeFitContainer() {\r\n        const aspect = this.aspectRatio;\r\n        let adjustedWidth = 0;\r\n        let adjustedHeight = 0;\r\n        const parent = this.canvas.parentElement;\r\n        if (parent.clientWidth / aspect < parent.clientHeight) {\r\n            adjustedWidth = parent.clientWidth;\r\n            adjustedHeight = parent.clientWidth / aspect;\r\n        }\r\n        else {\r\n            adjustedWidth = parent.clientHeight * aspect;\r\n            adjustedHeight = parent.clientHeight;\r\n        }\r\n        this.viewport = {\r\n            width: adjustedWidth,\r\n            height: adjustedHeight\r\n        };\r\n    }\r\n    _applyDisplayMode() {\r\n        if (this.displayMode === DisplayMode.Position) {\r\n            this._initializeDisplayModePosition(this._position);\r\n        }\r\n        else {\r\n            this._setResolutionAndViewportByDisplayMode(this.parent);\r\n            // watch resizing\r\n            if (this.parent instanceof Window) {\r\n                this._browser.window.on('resize', this._resizeHandler);\r\n            }\r\n            else {\r\n                this._resizeObserver = new ResizeObserver(() => {\r\n                    this._resizeHandler();\r\n                });\r\n                this._resizeObserver.observe(this.parent);\r\n            }\r\n            this.parent.addEventListener('resize', this._resizeHandler);\r\n        }\r\n    }\r\n    /**\r\n     * Sets the resolution and viewport based on the selected display mode.\r\n     */\r\n    _setResolutionAndViewportByDisplayMode(parent) {\r\n        if (this.displayMode === DisplayMode.FillContainer) {\r\n            this.resolution = {\r\n                width: parent.clientWidth,\r\n                height: parent.clientHeight\r\n            };\r\n            this.viewport = this.resolution;\r\n        }\r\n        if (this.displayMode === DisplayMode.FillScreen) {\r\n            document.body.style.margin = '0px';\r\n            document.body.style.overflow = 'hidden';\r\n            this.resolution = {\r\n                width: parent.innerWidth,\r\n                height: parent.innerHeight\r\n            };\r\n            this.viewport = this.resolution;\r\n        }\r\n        if (this.displayMode === DisplayMode.FitScreen) {\r\n            this._computeFit();\r\n        }\r\n        if (this.displayMode === DisplayMode.FitContainer) {\r\n            this._computeFitContainer();\r\n        }\r\n    }\r\n    _initializeDisplayModePosition(position) {\r\n        if (!position) {\r\n            throw new Error('DisplayMode of Position was selected but no position option was given');\r\n        }\r\n        else {\r\n            this.canvas.style.display = 'block';\r\n            this.canvas.style.position = 'absolute';\r\n            if (typeof position === 'string') {\r\n                const specifiedPosition = position.split(' ');\r\n                switch (specifiedPosition[0]) {\r\n                    case 'top':\r\n                        this.canvas.style.top = '0px';\r\n                        break;\r\n                    case 'bottom':\r\n                        this.canvas.style.bottom = '0px';\r\n                        break;\r\n                    case 'middle':\r\n                        this.canvas.style.top = '50%';\r\n                        const offsetY = -this.halfDrawHeight;\r\n                        this.canvas.style.marginTop = offsetY.toString();\r\n                        break;\r\n                    default:\r\n                        throw new Error('Invalid Position Given');\r\n                }\r\n                if (specifiedPosition[1]) {\r\n                    switch (specifiedPosition[1]) {\r\n                        case 'left':\r\n                            this.canvas.style.left = '0px';\r\n                            break;\r\n                        case 'right':\r\n                            this.canvas.style.right = '0px';\r\n                            break;\r\n                        case 'center':\r\n                            this.canvas.style.left = '50%';\r\n                            const offsetX = -this.halfDrawWidth;\r\n                            this.canvas.style.marginLeft = offsetX.toString();\r\n                            break;\r\n                        default:\r\n                            throw new Error('Invalid Position Given');\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                if (position.top) {\r\n                    typeof position.top === 'number'\r\n                        ? (this.canvas.style.top = position.top.toString() + 'px')\r\n                        : (this.canvas.style.top = position.top);\r\n                }\r\n                if (position.right) {\r\n                    typeof position.right === 'number'\r\n                        ? (this.canvas.style.right = position.right.toString() + 'px')\r\n                        : (this.canvas.style.right = position.right);\r\n                }\r\n                if (position.bottom) {\r\n                    typeof position.bottom === 'number'\r\n                        ? (this.canvas.style.bottom = position.bottom.toString() + 'px')\r\n                        : (this.canvas.style.bottom = position.bottom);\r\n                }\r\n                if (position.left) {\r\n                    typeof position.left === 'number'\r\n                        ? (this.canvas.style.left = position.left.toString() + 'px')\r\n                        : (this.canvas.style.left = position.left);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Resources/Sound/AudioContext.ts\n/**\r\n * Internal class used to build instances of AudioContext\r\n */\r\n/* istanbul ignore next */\r\nclass AudioContextFactory {\r\n    static create() {\r\n        if (!this._INSTANCE) {\r\n            if (window.AudioContext || window.webkitAudioContext) {\r\n                this._INSTANCE = new AudioContext();\r\n            }\r\n        }\r\n        return this._INSTANCE;\r\n    }\r\n}\r\nAudioContextFactory._INSTANCE = null;\r\n\n;// CONCATENATED MODULE: ./Util/WebAudio.ts\n\r\n\r\n/**\r\n * Patch for detecting legacy web audio in browsers\r\n * @internal\r\n * @param source\r\n */\r\nfunction isLegacyWebAudioSource(source) {\r\n    return !!source.playbackState;\r\n}\r\nclass WebAudio {\r\n    /**\r\n     * Play an empty sound to unlock Safari WebAudio context. Call this function\r\n     * right after a user interaction event.\r\n     * @source https://paulbakaus.com/tutorials/html5/web-audio-on-ios/\r\n     */\r\n    static unlock() {\r\n        const promise = new Promise((resolve, reject) => {\r\n            if (WebAudio._UNLOCKED || !AudioContextFactory.create()) {\r\n                return resolve(true);\r\n            }\r\n            const unlockTimeoutTimer = setTimeout(() => {\r\n                Logger.getInstance().warn('Excalibur was unable to unlock the audio context, audio probably will not play in this browser.');\r\n                resolve(false);\r\n            }, 200);\r\n            const audioContext = AudioContextFactory.create();\r\n            audioContext.resume().then(() => {\r\n                // create empty buffer and play it\r\n                const buffer = audioContext.createBuffer(1, 1, 22050);\r\n                const source = audioContext.createBufferSource();\r\n                let ended = false;\r\n                source.buffer = buffer;\r\n                source.connect(audioContext.destination);\r\n                source.onended = () => (ended = true);\r\n                source.start(0);\r\n                // by checking the play state after some time, we know if we're really unlocked\r\n                setTimeout(() => {\r\n                    if (isLegacyWebAudioSource(source)) {\r\n                        if (source.playbackState === source.PLAYING_STATE || source.playbackState === source.FINISHED_STATE) {\r\n                            WebAudio._UNLOCKED = true;\r\n                        }\r\n                    }\r\n                    else {\r\n                        if (audioContext.currentTime > 0 || ended) {\r\n                            WebAudio._UNLOCKED = true;\r\n                        }\r\n                    }\r\n                }, 0);\r\n                clearTimeout(unlockTimeoutTimer);\r\n                resolve(true);\r\n            }, () => {\r\n                reject();\r\n            });\r\n        });\r\n        return promise;\r\n    }\r\n    static isUnlocked() {\r\n        return this._UNLOCKED;\r\n    }\r\n}\r\nWebAudio._UNLOCKED = false;\r\n\n;// CONCATENATED MODULE: ./Class.ts\n\r\n/**\r\n * Excalibur base class that provides basic functionality such as [[EventDispatcher]]\r\n * and extending abilities for vanilla Javascript projects\r\n */\r\nclass Class {\r\n    constructor() {\r\n        this.eventDispatcher = new EventDispatcher();\r\n    }\r\n    /**\r\n     * Alias for `addEventListener`. You can listen for a variety of\r\n     * events off of the engine; see the events section below for a complete list.\r\n     * @param eventName  Name of the event to listen for\r\n     * @param handler    Event handler for the thrown event\r\n     */\r\n    on(eventName, handler) {\r\n        this.eventDispatcher.on(eventName, handler);\r\n    }\r\n    /**\r\n     * Alias for `removeEventListener`. If only the eventName is specified\r\n     * it will remove all handlers registered for that specific event. If the eventName\r\n     * and the handler instance are specified only that handler will be removed.\r\n     *\r\n     * @param eventName  Name of the event to listen for\r\n     * @param handler    Event handler for the thrown event\r\n     */\r\n    off(eventName, handler) {\r\n        this.eventDispatcher.off(eventName, handler);\r\n    }\r\n    /**\r\n     * Emits a new event\r\n     * @param eventName   Name of the event to emit\r\n     * @param eventObject Data associated with this event\r\n     */\r\n    emit(eventName, eventObject) {\r\n        this.eventDispatcher.emit(eventName, eventObject);\r\n    }\r\n    /**\r\n     * Once listens to an event one time, then unsubscribes from that event\r\n     *\r\n     * @param eventName The name of the event to subscribe to once\r\n     * @param handler   The handler of the event that will be auto unsubscribed\r\n     */\r\n    once(eventName, handler) {\r\n        this.eventDispatcher.once(eventName, handler);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/DrawUtil.ts\n\r\n/* istanbul ignore next */\r\n/**\r\n * Draw a line on canvas context\r\n *\r\n * @param ctx The canvas context\r\n * @param color The color of the line\r\n * @param x1 The start x coordinate\r\n * @param y1 The start y coordinate\r\n * @param x2 The ending x coordinate\r\n * @param y2 The ending y coordinate\r\n * @param thickness The line thickness\r\n * @param cap The [[LineCapStyle]] (butt, round, or square)\r\n */\r\nfunction line(ctx, color = Color.Red, x1, y1, x2, y2, thickness = 1, cap = 'butt') {\r\n    ctx.save();\r\n    ctx.beginPath();\r\n    ctx.lineWidth = thickness;\r\n    ctx.lineCap = cap;\r\n    ctx.strokeStyle = color.toString();\r\n    ctx.moveTo(x1, y1);\r\n    ctx.lineTo(x2, y2);\r\n    ctx.closePath();\r\n    ctx.stroke();\r\n    ctx.restore();\r\n}\r\n/* istanbul ignore next */\r\n/**\r\n * Draw the vector as a point onto the canvas.\r\n */\r\nfunction point(ctx, color = Color.Red, point) {\r\n    ctx.beginPath();\r\n    ctx.strokeStyle = color.toString();\r\n    ctx.arc(point.x, point.y, 5, 0, Math.PI * 2);\r\n    ctx.closePath();\r\n    ctx.stroke();\r\n}\r\n/**\r\n * Draw the vector as a line onto the canvas starting a origin point.\r\n */\r\n/* istanbul ignore next */\r\n/**\r\n *\r\n */\r\nfunction vector(ctx, color, origin, vector, scale = 1.0) {\r\n    const c = color ? color.toString() : 'blue';\r\n    const v = vector.scale(scale);\r\n    ctx.beginPath();\r\n    ctx.strokeStyle = c;\r\n    ctx.moveTo(origin.x, origin.y);\r\n    ctx.lineTo(origin.x + v.x, origin.y + v.y);\r\n    ctx.closePath();\r\n    ctx.stroke();\r\n}\r\n/**\r\n * Draw a round rectangle on a canvas context\r\n *\r\n * @param ctx The canvas context\r\n * @param x The top-left x coordinate\r\n * @param y The top-left y coordinate\r\n * @param width The width of the rectangle\r\n * @param height The height of the rectangle\r\n * @param radius The border radius of the rectangle\r\n * @param stroke The [[Color]] to stroke rectangle with\r\n * @param fill The [[Color]] to fill rectangle with\r\n */\r\nfunction roundRect(ctx, x, y, width, height, radius = 5, stroke = Color.White, fill = null) {\r\n    let br;\r\n    if (typeof radius === 'number') {\r\n        br = { tl: radius, tr: radius, br: radius, bl: radius };\r\n    }\r\n    else {\r\n        const defaultRadius = { tl: 0, tr: 0, br: 0, bl: 0 };\r\n        for (const prop in defaultRadius) {\r\n            if (defaultRadius.hasOwnProperty(prop)) {\r\n                const side = prop;\r\n                br[side] = radius[side] || defaultRadius[side];\r\n            }\r\n        }\r\n    }\r\n    ctx.beginPath();\r\n    ctx.moveTo(x + br.tl, y);\r\n    ctx.lineTo(x + width - br.tr, y);\r\n    ctx.quadraticCurveTo(x + width, y, x + width, y + br.tr);\r\n    ctx.lineTo(x + width, y + height - br.br);\r\n    ctx.quadraticCurveTo(x + width, y + height, x + width - br.br, y + height);\r\n    ctx.lineTo(x + br.bl, y + height);\r\n    ctx.quadraticCurveTo(x, y + height, x, y + height - br.bl);\r\n    ctx.lineTo(x, y + br.tl);\r\n    ctx.quadraticCurveTo(x, y, x + br.tl, y);\r\n    ctx.closePath();\r\n    if (fill) {\r\n        ctx.fillStyle = fill.toString();\r\n        ctx.fill();\r\n    }\r\n    if (stroke) {\r\n        ctx.strokeStyle = stroke.toString();\r\n        ctx.stroke();\r\n    }\r\n}\r\n/**\r\n *\r\n */\r\nfunction circle(ctx, x, y, radius, stroke = Color.White, fill = null) {\r\n    ctx.beginPath();\r\n    ctx.arc(x, y, radius, 0, Math.PI * 2);\r\n    ctx.closePath();\r\n    if (fill) {\r\n        ctx.fillStyle = fill.toString();\r\n        ctx.fill();\r\n    }\r\n    if (stroke) {\r\n        ctx.strokeStyle = stroke.toString();\r\n        ctx.stroke();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Loader.logo.png\n/* harmony default export */ const Loader_logo = (\"data:image/png;base64,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\");\n// EXTERNAL MODULE: ./Loader.css\nvar Loader_0 = __webpack_require__(1388);\n;// CONCATENATED MODULE: ./Loader.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Pre-loading assets\r\n *\r\n * The loader provides a mechanism to preload multiple resources at\r\n * one time. The loader must be passed to the engine in order to\r\n * trigger the loading progress bar.\r\n *\r\n * The [[Loader]] itself implements [[Loadable]] so you can load loaders.\r\n *\r\n * ## Example: Pre-loading resources for a game\r\n *\r\n * ```js\r\n * // create a loader\r\n * var loader = new ex.Loader();\r\n *\r\n * // create a resource dictionary (best practice is to keep a separate file)\r\n * var resources = {\r\n *   TextureGround: new ex.Texture(\"/images/textures/ground.png\"),\r\n *   SoundDeath: new ex.Sound(\"/sound/death.wav\", \"/sound/death.mp3\")\r\n * };\r\n *\r\n * // loop through dictionary and add to loader\r\n * for (var loadable in resources) {\r\n *   if (resources.hasOwnProperty(loadable)) {\r\n *     loader.addResource(resources[loadable]);\r\n *   }\r\n * }\r\n *\r\n * // start game\r\n * game.start(loader).then(function () {\r\n *   console.log(\"Game started!\");\r\n * });\r\n * ```\r\n *\r\n * ## Customize the Loader\r\n *\r\n * The loader can be customized to show different, text, logo, background color, and button.\r\n *\r\n * ```typescript\r\n * const loader = new ex.Loader([playerTexture]);\r\n *\r\n * // The loaders button text can simply modified using this\r\n * loader.playButtonText = 'Start the best game ever';\r\n *\r\n * // The logo can be changed by inserting a base64 image string here\r\n *\r\n * loader.logo = 'data:image/png;base64,iVBORw...';\r\n * loader.logoWidth = 15;\r\n * loader.logoHeight = 14;\r\n *\r\n * // The background color can be changed like so by supplying a valid CSS color string\r\n *\r\n * loader.backgroundColor = 'red'\r\n * loader.backgroundColor = '#176BAA'\r\n *\r\n * // To build a completely new button\r\n * loader.startButtonFactory = () => {\r\n *     let myButton = document.createElement('button');\r\n *     myButton.textContent = 'The best button';\r\n *     return myButton;\r\n * };\r\n *\r\n * engine.start(loader).then(() => {});\r\n * ```\r\n */\r\nclass Loader extends Class {\r\n    /**\r\n     * @param loadables  Optionally provide the list of resources you want to load at constructor time\r\n     */\r\n    constructor(loadables) {\r\n        super();\r\n        this.canvas = new Canvas({\r\n            filtering: ImageFiltering.Blended,\r\n            smoothing: true,\r\n            draw: this.draw.bind(this)\r\n        });\r\n        this._resourceList = [];\r\n        this._index = 0;\r\n        this._playButtonShown = false;\r\n        this._resourceCount = 0;\r\n        this._numLoaded = 0;\r\n        this._progressCounts = {};\r\n        this._totalCounts = {};\r\n        // logo drawing stuff\r\n        // base64 string encoding of the excalibur logo (logo-white.png)\r\n        this.logo = Loader_logo;\r\n        this.logoWidth = 468;\r\n        this.logoHeight = 118;\r\n        /**\r\n         * Gets or sets the color of the loading bar, default is [[Color.White]]\r\n         */\r\n        this.loadingBarColor = Color.White;\r\n        /**\r\n         * Gets or sets the background color of the loader as a hex string\r\n         */\r\n        this.backgroundColor = '#176BAA';\r\n        this.suppressPlayButton = false;\r\n        /** Loads the css from Loader.css */\r\n        this._playButtonStyles = Loader_0/* default.toString */.Z.toString();\r\n        /**\r\n         * Get/set play button text\r\n         */\r\n        this.playButtonText = 'Play game';\r\n        /**\r\n         * Return a html button element for excalibur to use as a play button\r\n         */\r\n        this.startButtonFactory = () => {\r\n            let buttonElement = document.getElementById('excalibur-play');\r\n            if (!buttonElement) {\r\n                buttonElement = document.createElement('button');\r\n            }\r\n            buttonElement.id = 'excalibur-play';\r\n            buttonElement.textContent = this.playButtonText;\r\n            buttonElement.style.display = 'none';\r\n            return buttonElement;\r\n        };\r\n        this._isLoadedPromise = new Promise(resolve => {\r\n            this._isLoadedResolve = resolve;\r\n        });\r\n        if (loadables) {\r\n            this.addResources(loadables);\r\n        }\r\n    }\r\n    get _image() {\r\n        if (!this._imageElement) {\r\n            this._imageElement = new Image();\r\n            this._imageElement.src = this.logo;\r\n        }\r\n        return this._imageElement;\r\n    }\r\n    get playButtonRootElement() {\r\n        return this._playButtonRootElement;\r\n    }\r\n    get playButtonElement() {\r\n        return this._playButtonElement;\r\n    }\r\n    get _playButton() {\r\n        const existingRoot = document.getElementById('excalibur-play-root');\r\n        if (existingRoot) {\r\n            this._playButtonRootElement = existingRoot;\r\n        }\r\n        if (!this._playButtonRootElement) {\r\n            this._playButtonRootElement = document.createElement('div');\r\n            this._playButtonRootElement.id = 'excalibur-play-root';\r\n            this._playButtonRootElement.style.position = 'absolute';\r\n            document.body.appendChild(this._playButtonRootElement);\r\n        }\r\n        if (!this._styleBlock) {\r\n            this._styleBlock = document.createElement('style');\r\n            this._styleBlock.textContent = this._playButtonStyles;\r\n            document.head.appendChild(this._styleBlock);\r\n        }\r\n        if (!this._playButtonElement) {\r\n            this._playButtonElement = this.startButtonFactory();\r\n            this._playButtonRootElement.appendChild(this._playButtonElement);\r\n        }\r\n        return this._playButtonElement;\r\n    }\r\n    wireEngine(engine) {\r\n        this._engine = engine;\r\n        this.canvas.width = this._engine.canvas.width;\r\n        this.canvas.height = this._engine.canvas.height;\r\n    }\r\n    /**\r\n     * Add a resource to the loader to load\r\n     * @param loadable  Resource to add\r\n     */\r\n    addResource(loadable) {\r\n        const key = this._index++;\r\n        this._resourceList.push(loadable);\r\n        this._progressCounts[key] = 0;\r\n        this._totalCounts[key] = 1;\r\n        this._resourceCount++;\r\n    }\r\n    /**\r\n     * Add a list of resources to the loader to load\r\n     * @param loadables  The list of resources to load\r\n     */\r\n    addResources(loadables) {\r\n        let i = 0;\r\n        const len = loadables.length;\r\n        for (i; i < len; i++) {\r\n            this.addResource(loadables[i]);\r\n        }\r\n    }\r\n    /**\r\n     * Returns true if the loader has completely loaded all resources\r\n     */\r\n    isLoaded() {\r\n        return this._numLoaded === this._resourceCount;\r\n    }\r\n    /**\r\n     * Shows the play button and returns a promise that resolves when clicked\r\n     */\r\n    async showPlayButton() {\r\n        var _a, _b;\r\n        if (this.suppressPlayButton) {\r\n            this.hidePlayButton();\r\n            // Delay is to give the logo a chance to show, otherwise don't delay\r\n            await delay(500, (_a = this._engine) === null || _a === void 0 ? void 0 : _a.clock);\r\n        }\r\n        else {\r\n            const resizeHandler = () => {\r\n                this._positionPlayButton();\r\n            };\r\n            if ((_b = this._engine) === null || _b === void 0 ? void 0 : _b.browser) {\r\n                this._engine.browser.window.on('resize', resizeHandler);\r\n            }\r\n            this._playButtonShown = true;\r\n            this._playButton.style.display = 'block';\r\n            document.body.addEventListener('keyup', (evt) => {\r\n                if (evt.key === 'Enter') {\r\n                    this._playButton.click();\r\n                }\r\n            });\r\n            this._positionPlayButton();\r\n            const playButtonClicked = new Promise((resolve) => {\r\n                const startButtonHandler = (e) => {\r\n                    var _a;\r\n                    // We want to stop propagation to keep bubbling to the engine pointer handlers\r\n                    e.stopPropagation();\r\n                    // Hide Button after click\r\n                    this.hidePlayButton();\r\n                    if ((_a = this._engine) === null || _a === void 0 ? void 0 : _a.browser) {\r\n                        this._engine.browser.window.off('resize', resizeHandler);\r\n                    }\r\n                    resolve();\r\n                };\r\n                this._playButton.addEventListener('click', startButtonHandler);\r\n                this._playButton.addEventListener('touchend', startButtonHandler);\r\n                this._playButton.addEventListener('pointerup', startButtonHandler);\r\n            });\r\n            return await playButtonClicked;\r\n        }\r\n    }\r\n    hidePlayButton() {\r\n        this._playButtonShown = false;\r\n        this._playButton.style.display = 'none';\r\n    }\r\n    /**\r\n     * Clean up generated elements for the loader\r\n     */\r\n    dispose() {\r\n        if (this._playButtonRootElement.parentElement) {\r\n            this._playButtonRootElement.removeChild(this._playButtonElement);\r\n            document.body.removeChild(this._playButtonRootElement);\r\n            document.head.removeChild(this._styleBlock);\r\n            this._playButtonRootElement = null;\r\n            this._playButtonElement = null;\r\n            this._styleBlock = null;\r\n        }\r\n    }\r\n    update(_engine, _delta) {\r\n        // override me\r\n    }\r\n    areResourcesLoaded() {\r\n        return this._isLoadedPromise;\r\n    }\r\n    /**\r\n     * Begin loading all of the supplied resources, returning a promise\r\n     * that resolves when loading of all is complete AND the user has clicked the \"Play button\"\r\n     */\r\n    async load() {\r\n        var _a, _b;\r\n        await ((_a = this._image) === null || _a === void 0 ? void 0 : _a.decode()); // decode logo if it exists\r\n        await Promise.all(this._resourceList.map((r) => r.load().finally(() => {\r\n            // capture progress\r\n            this._numLoaded++;\r\n        })));\r\n        this._isLoadedResolve();\r\n        // short delay in showing the button for aesthetics\r\n        await delay(200, (_b = this._engine) === null || _b === void 0 ? void 0 : _b.clock);\r\n        await this.showPlayButton();\r\n        // Unlock browser AudioContext in after user gesture\r\n        // See: https://github.com/excaliburjs/Excalibur/issues/262\r\n        // See: https://github.com/excaliburjs/Excalibur/issues/1031\r\n        await WebAudio.unlock();\r\n        return (this.data = this._resourceList);\r\n    }\r\n    markResourceComplete() {\r\n        this._numLoaded++;\r\n    }\r\n    /**\r\n     * Returns the progress of the loader as a number between [0, 1] inclusive.\r\n     */\r\n    get progress() {\r\n        return this._resourceCount > 0 ? clamp(this._numLoaded, 0, this._resourceCount) / this._resourceCount : 1;\r\n    }\r\n    _positionPlayButton() {\r\n        if (this._engine) {\r\n            const screenHeight = this._engine.screen.viewport.height;\r\n            const screenWidth = this._engine.screen.viewport.width;\r\n            if (this._playButtonRootElement) {\r\n                const left = this._engine.canvas.offsetLeft;\r\n                const top = this._engine.canvas.offsetTop;\r\n                const buttonWidth = this._playButton.clientWidth;\r\n                const buttonHeight = this._playButton.clientHeight;\r\n                if (this.playButtonPosition) {\r\n                    this._playButtonRootElement.style.left = `${this.playButtonPosition.x}px`;\r\n                    this._playButtonRootElement.style.top = `${this.playButtonPosition.y}px`;\r\n                }\r\n                else {\r\n                    this._playButtonRootElement.style.left = `${left + screenWidth / 2 - buttonWidth / 2}px`;\r\n                    this._playButtonRootElement.style.top = `${top + screenHeight / 2 - buttonHeight / 2 + 100}px`;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Loader draw function. Draws the default Excalibur loading screen.\r\n     * Override `logo`, `logoWidth`, `logoHeight` and `backgroundColor` properties\r\n     * to customize the drawing, or just override entire method.\r\n     */\r\n    draw(ctx) {\r\n        const canvasHeight = this._engine.canvasHeight / this._engine.pixelRatio;\r\n        const canvasWidth = this._engine.canvasWidth / this._engine.pixelRatio;\r\n        this._positionPlayButton();\r\n        ctx.fillStyle = this.backgroundColor;\r\n        ctx.fillRect(0, 0, canvasWidth, canvasHeight);\r\n        let logoY = canvasHeight / 2;\r\n        const width = Math.min(this.logoWidth, canvasWidth * 0.75);\r\n        let logoX = canvasWidth / 2 - width / 2;\r\n        if (this.logoPosition) {\r\n            logoX = this.logoPosition.x;\r\n            logoY = this.logoPosition.y;\r\n        }\r\n        const imageHeight = Math.floor(width * (this.logoHeight / this.logoWidth)); // OG height/width factor\r\n        const oldAntialias = this._engine.getAntialiasing();\r\n        this._engine.setAntialiasing(true);\r\n        if (!this.logoPosition) {\r\n            ctx.drawImage(this._image, 0, 0, this.logoWidth, this.logoHeight, logoX, logoY - imageHeight - 20, width, imageHeight);\r\n        }\r\n        else {\r\n            ctx.drawImage(this._image, 0, 0, this.logoWidth, this.logoHeight, logoX, logoY, width, imageHeight);\r\n        }\r\n        // loading box\r\n        if (!this.suppressPlayButton && this._playButtonShown) {\r\n            this._engine.setAntialiasing(oldAntialias);\r\n            return;\r\n        }\r\n        let loadingX = logoX;\r\n        let loadingY = logoY;\r\n        if (this.loadingBarPosition) {\r\n            loadingX = this.loadingBarPosition.x;\r\n            loadingY = this.loadingBarPosition.y;\r\n        }\r\n        ctx.lineWidth = 2;\r\n        roundRect(ctx, loadingX, loadingY, width, 20, 10, this.loadingBarColor);\r\n        const progress = width * this.progress;\r\n        const margin = 5;\r\n        const progressWidth = progress - margin * 2;\r\n        const height = 20 - margin * 2;\r\n        roundRect(ctx, loadingX + margin, loadingY + margin, progressWidth > 10 ? progressWidth : 10, height, 5, null, this.loadingBarColor);\r\n        this._engine.setAntialiasing(oldAntialias);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Detector.ts\n\r\n/**\r\n * This is the list of features that will be used to log the supported\r\n * features to the console when Detector.logBrowserFeatures() is called.\r\n */\r\nconst REPORTED_FEATURES = {\r\n    webgl: 'WebGL',\r\n    webaudio: 'WebAudio',\r\n    gamepadapi: 'Gamepad API'\r\n};\r\n/**\r\n * Excalibur internal feature detection helper class\r\n */\r\nclass Detector {\r\n    constructor() {\r\n        this._features = null;\r\n        this.failedTests = [];\r\n        // critical browser features required for ex to run\r\n        this._criticalTests = {\r\n            // Test canvas/2d context support\r\n            canvasSupport: function () {\r\n                const elem = document.createElement('canvas');\r\n                return !!(elem.getContext && elem.getContext('2d'));\r\n            },\r\n            // Test array buffer support ex uses for downloading binary data\r\n            arrayBufferSupport: function () {\r\n                const xhr = new XMLHttpRequest();\r\n                xhr.open('GET', '/');\r\n                try {\r\n                    xhr.responseType = 'arraybuffer';\r\n                }\r\n                catch (e) {\r\n                    return false;\r\n                }\r\n                return xhr.responseType === 'arraybuffer';\r\n            },\r\n            // Test data urls ex uses for sprites\r\n            dataUrlSupport: function () {\r\n                const canvas = document.createElement('canvas');\r\n                return canvas.toDataURL('image/png').indexOf('data:image/png') === 0;\r\n            },\r\n            // Test object url support for loading\r\n            objectUrlSupport: function () {\r\n                return 'URL' in window && 'revokeObjectURL' in URL && 'createObjectURL' in URL;\r\n            },\r\n            // RGBA support for colors\r\n            rgbaSupport: function () {\r\n                const style = document.createElement('a').style;\r\n                style.cssText = 'background-color:rgba(150,255,150,.5)';\r\n                return ('' + style.backgroundColor).indexOf('rgba') > -1;\r\n            }\r\n        };\r\n        // warnings excalibur performance will be degraded\r\n        this._warningTest = {\r\n            webAudioSupport: function () {\r\n                return !!(window.AudioContext ||\r\n                    window.webkitAudioContext ||\r\n                    window.mozAudioContext ||\r\n                    window.msAudioContext ||\r\n                    window.oAudioContext);\r\n            },\r\n            webglSupport: function () {\r\n                const elem = document.createElement('canvas');\r\n                return !!(elem.getContext && elem.getContext('webgl'));\r\n            }\r\n        };\r\n        this._features = this._loadBrowserFeatures();\r\n    }\r\n    /**\r\n     * Returns a map of currently supported browser features. This method\r\n     * treats the features as a singleton and will only calculate feature\r\n     * support if it has not previously been done.\r\n     */\r\n    getBrowserFeatures() {\r\n        if (this._features === null) {\r\n            this._features = this._loadBrowserFeatures();\r\n        }\r\n        return this._features;\r\n    }\r\n    /**\r\n     * Report on non-critical browser support for debugging purposes.\r\n     * Use native browser console colors for visibility.\r\n     */\r\n    logBrowserFeatures() {\r\n        let msg = '%cSUPPORTED BROWSER FEATURES\\n==========================%c\\n';\r\n        const args = ['font-weight: bold; color: navy', 'font-weight: normal; color: inherit'];\r\n        const supported = this.getBrowserFeatures();\r\n        for (const feature of Object.keys(REPORTED_FEATURES)) {\r\n            if (supported[feature]) {\r\n                msg += '(%c\\u2713%c)'; // (✓)\r\n                args.push('font-weight: bold; color: green');\r\n                args.push('font-weight: normal; color: inherit');\r\n            }\r\n            else {\r\n                msg += '(%c\\u2717%c)'; // (✗)\r\n                args.push('font-weight: bold; color: red');\r\n                args.push('font-weight: normal; color: inherit');\r\n            }\r\n            msg += ' ' + REPORTED_FEATURES[feature] + '\\n';\r\n        }\r\n        args.unshift(msg);\r\n        // eslint-disable-next-line no-console\r\n        console.log.apply(console, args);\r\n    }\r\n    /**\r\n     * Executes several IIFE's to get a constant reference to supported\r\n     * features within the current execution context.\r\n     */\r\n    _loadBrowserFeatures() {\r\n        return {\r\n            // IIFE to check canvas support\r\n            canvas: (() => {\r\n                return this._criticalTests.canvasSupport();\r\n            })(),\r\n            // IIFE to check arraybuffer support\r\n            arraybuffer: (() => {\r\n                return this._criticalTests.arrayBufferSupport();\r\n            })(),\r\n            // IIFE to check dataurl support\r\n            dataurl: (() => {\r\n                return this._criticalTests.dataUrlSupport();\r\n            })(),\r\n            // IIFE to check objecturl support\r\n            objecturl: (() => {\r\n                return this._criticalTests.objectUrlSupport();\r\n            })(),\r\n            // IIFE to check rgba support\r\n            rgba: (() => {\r\n                return this._criticalTests.rgbaSupport();\r\n            })(),\r\n            // IIFE to check webaudio support\r\n            webaudio: (() => {\r\n                return this._warningTest.webAudioSupport();\r\n            })(),\r\n            // IIFE to check webgl support\r\n            webgl: (() => {\r\n                return this._warningTest.webglSupport();\r\n            })(),\r\n            // IIFE to check gamepadapi support\r\n            gamepadapi: (() => {\r\n                return !!navigator.getGamepads;\r\n            })()\r\n        };\r\n    }\r\n    test() {\r\n        // Critical test will for ex not to run\r\n        let failedCritical = false;\r\n        for (const test in this._criticalTests) {\r\n            if (!this._criticalTests[test].call(this)) {\r\n                this.failedTests.push(test);\r\n                Logger.getInstance().error('Critical browser feature missing, Excalibur requires:', test);\r\n                failedCritical = true;\r\n            }\r\n        }\r\n        if (failedCritical) {\r\n            return false;\r\n        }\r\n        // Warning tests do not for ex to return false to compatibility\r\n        for (const warning in this._warningTest) {\r\n            if (!this._warningTest[warning]()) {\r\n                Logger.getInstance().warn('Warning browser feature missing, Excalibur will have reduced performance:', warning);\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/CollisionType.ts\n/**\r\n * An enum that describes the types of collisions bodies can participate in\r\n */\r\nvar CollisionType;\r\n(function (CollisionType) {\r\n    /**\r\n     * Bodies with the `PreventCollision` setting do not participate in any\r\n     * collisions and do not raise collision events.\r\n     */\r\n    CollisionType[\"PreventCollision\"] = \"PreventCollision\";\r\n    /**\r\n     * Bodies with the `Passive` setting only raise collision events, but are not\r\n     * influenced or moved by other bodies and do not influence or move other bodies.\r\n     * This is useful for use in trigger type behavior.\r\n     */\r\n    CollisionType[\"Passive\"] = \"Passive\";\r\n    /**\r\n     * Bodies with the `Active` setting raise collision events and participate\r\n     * in collisions with other bodies and will be push or moved by bodies sharing\r\n     * the `Active` or `Fixed` setting.\r\n     */\r\n    CollisionType[\"Active\"] = \"Active\";\r\n    /**\r\n     * Bodies with the `Fixed` setting raise collision events and participate in\r\n     * collisions with other bodies. Actors with the `Fixed` setting will not be\r\n     * pushed or moved by other bodies sharing the `Fixed`. Think of Fixed\r\n     * bodies as \"immovable/unstoppable\" objects. If two `Fixed` bodies meet they will\r\n     * not be pushed or moved by each other, they will not interact except to throw\r\n     * collision events.\r\n     */\r\n    CollisionType[\"Fixed\"] = \"Fixed\";\r\n})(CollisionType || (CollisionType = {}));\r\n\n;// CONCATENATED MODULE: ./Collision/Physics.ts\nvar Physics_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\n\r\n/**\r\n * Possible collision resolution strategies\r\n *\r\n * The default is [[CollisionResolutionStrategy.Arcade]] which performs simple axis aligned arcade style physics. This is useful for things\r\n * like platformers or top down games.\r\n *\r\n * More advanced rigid body physics are enabled by setting [[CollisionResolutionStrategy.Realistic]] which allows for complicated\r\n * simulated physical interactions.\r\n */\r\nvar CollisionResolutionStrategy;\r\n(function (CollisionResolutionStrategy) {\r\n    CollisionResolutionStrategy[\"Arcade\"] = \"arcade\";\r\n    CollisionResolutionStrategy[\"Realistic\"] = \"realistic\";\r\n})(CollisionResolutionStrategy || (CollisionResolutionStrategy = {}));\r\n/**\r\n * Possible broadphase collision pair identification strategies\r\n *\r\n * The default strategy is [[BroadphaseStrategy.DynamicAABBTree]] which uses a binary tree of axis-aligned bounding boxes to identify\r\n * potential collision pairs which is O(nlog(n)) faster.\r\n */\r\nvar BroadphaseStrategy;\r\n(function (BroadphaseStrategy) {\r\n    BroadphaseStrategy[BroadphaseStrategy[\"DynamicAABBTree\"] = 0] = \"DynamicAABBTree\";\r\n})(BroadphaseStrategy || (BroadphaseStrategy = {}));\r\n/**\r\n * Possible numerical integrators for position and velocity\r\n */\r\nvar Integrator;\r\n(function (Integrator) {\r\n    Integrator[Integrator[\"Euler\"] = 0] = \"Euler\";\r\n})(Integrator || (Integrator = {}));\r\n/**\r\n * The [[Physics]] object is the global configuration object for all Excalibur physics.\r\n */\r\n/* istanbul ignore next */\r\nclass Physics {\r\n    static get gravity() {\r\n        return Physics.acc;\r\n    }\r\n    static set gravity(v) {\r\n        Physics.acc = v;\r\n    }\r\n    /**\r\n     * Configures Excalibur to use \"arcade\" physics. Arcade physics which performs simple axis aligned arcade style physics.\r\n     */\r\n    static useArcadePhysics() {\r\n        Physics.collisionResolutionStrategy = CollisionResolutionStrategy.Arcade;\r\n    }\r\n    /**\r\n     * Configures Excalibur to use rigid body physics. Rigid body physics allows for complicated\r\n     * simulated physical interactions.\r\n     */\r\n    static useRealisticPhysics() {\r\n        Physics.collisionResolutionStrategy = CollisionResolutionStrategy.Realistic;\r\n    }\r\n    static get dynamicTreeVelocityMultiplyer() {\r\n        return Physics.dynamicTreeVelocityMultiplier;\r\n    }\r\n    static set dynamicTreeVelocityMultiplyer(value) {\r\n        Physics.dynamicTreeVelocityMultiplier = value;\r\n    }\r\n}\r\n/**\r\n * Global acceleration that is applied to all vanilla actors that have a [[CollisionType.Active|active]] collision type.\r\n * Global acceleration won't effect [[Label|labels]], [[ScreenElement|ui actors]], or [[Trigger|triggers]] in Excalibur.\r\n *\r\n * This is a great way to globally simulate effects like gravity.\r\n */\r\nPhysics.acc = new Vector(0, 0);\r\n/**\r\n * Globally switches all Excalibur physics behavior on or off.\r\n */\r\nPhysics.enabled = true;\r\n/**\r\n * Gets or sets the broadphase pair identification strategy.\r\n *\r\n * The default strategy is [[BroadphaseStrategy.DynamicAABBTree]] which uses a binary tree of axis-aligned bounding boxes to identify\r\n * potential collision pairs which is O(nlog(n)) faster.\r\n */\r\nPhysics.broadphaseStrategy = BroadphaseStrategy.DynamicAABBTree;\r\n/**\r\n * Gets or sets the global collision resolution strategy (narrowphase).\r\n *\r\n * The default is [[CollisionResolutionStrategy.Arcade]] which performs simple axis aligned arcade style physics.\r\n *\r\n * More advanced rigid body physics are enabled by setting [[CollisionResolutionStrategy.Realistic]] which allows for complicated\r\n * simulated physical interactions.\r\n */\r\nPhysics.collisionResolutionStrategy = CollisionResolutionStrategy.Arcade;\r\n/**\r\n * The default mass to use if none is specified\r\n */\r\nPhysics.defaultMass = 10;\r\n/**\r\n * Gets or sets the position and velocity positional integrator, currently only Euler is supported.\r\n */\r\nPhysics.integrator = Integrator.Euler;\r\n/**\r\n * Factor to add to the RigidBody BoundingBox, bounding box (dimensions += vel * dynamicTreeVelocityMultiplier);\r\n */\r\nPhysics.dynamicTreeVelocityMultiplier = 2;\r\n/**\r\n * Pad RigidBody BoundingBox by a constant amount\r\n */\r\nPhysics.boundsPadding = 5;\r\n/**\r\n * Number of position iterations (overlap) to run in the solver\r\n */\r\nPhysics.positionIterations = 3;\r\n/**\r\n * Number of velocity iteration (response) to run in the solver\r\n */\r\nPhysics.velocityIterations = 8;\r\n/**\r\n * Amount of overlap to tolerate in pixels\r\n */\r\nPhysics.slop = 1;\r\n/**\r\n * Amount of positional overlap correction to apply each position iteration of the solver\r\n * O - meaning no correction, 1 - meaning correct all overlap\r\n */\r\nPhysics.steeringFactor = 0.2;\r\n/**\r\n * Warm start set to true re-uses impulses from previous frames back in the solver\r\n */\r\nPhysics.warmStart = true;\r\n/**\r\n * By default bodies do not sleep\r\n */\r\nPhysics.bodiesCanSleepByDefault = false;\r\n/**\r\n * Surface epsilon is used to help deal with surface penetration\r\n */\r\nPhysics.surfaceEpsilon = 0.1;\r\nPhysics.sleepEpsilon = 0.07;\r\nPhysics.wakeThreshold = Physics.sleepEpsilon * 3;\r\nPhysics.sleepBias = 0.9;\r\n/**\r\n * Enable fast moving body checking, this enables checking for collision pairs via raycast for fast moving objects to prevent\r\n * bodies from tunneling through one another.\r\n */\r\nPhysics.checkForFastBodies = true;\r\n/**\r\n * Disable minimum fast moving body raycast, by default if ex.Physics.checkForFastBodies = true Excalibur will only check if the\r\n * body is moving at least half of its minimum dimension in an update. If ex.Physics.disableMinimumSpeedForFastBody is set to true,\r\n * Excalibur will always perform the fast body raycast regardless of speed.\r\n */\r\nPhysics.disableMinimumSpeedForFastBody = false;\r\nPhysics_decorate([\r\n    obsolete({\r\n        message: 'Alias for incorrect spelling used in older versions, will be removed in v0.25.0',\r\n        alternateMethod: 'dynamicTreeVelocityMultiplier'\r\n    })\r\n], Physics, \"dynamicTreeVelocityMultiplyer\", null);\r\n\n;// CONCATENATED MODULE: ./Math/vector-view.ts\n\r\nclass VectorView extends Vector {\r\n    constructor(options) {\r\n        super(0, 0);\r\n        this._getX = options.getX;\r\n        this._getY = options.getY;\r\n        this._setX = options.setX;\r\n        this._setY = options.setY;\r\n    }\r\n    get x() {\r\n        return (this._x = this._getX());\r\n    }\r\n    set x(val) {\r\n        this._setX(val);\r\n        this._x = val;\r\n    }\r\n    get y() {\r\n        return (this._y = this._getY());\r\n    }\r\n    set y(val) {\r\n        this._setY(val);\r\n        this._y = val;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/Component.ts\n/**\r\n * Type guard to check if a component implements clone\r\n * @param x\r\n */\r\nfunction hasClone(x) {\r\n    return !!(x === null || x === void 0 ? void 0 : x.clone);\r\n}\r\n/**\r\n * Components are containers for state in Excalibur, the are meant to convey capabilities that an Entity possesses\r\n *\r\n * Implementations of Component must have a zero-arg constructor to support dependencies\r\n *\r\n * ```typescript\r\n * class MyComponent extends ex.Component<'my'> {\r\n *   public readonly type = 'my';\r\n *   // zero arg support required if you want to use component dependencies\r\n *   constructor(public optionalPos?: ex.Vector) {}\r\n * }\r\n * ```\r\n */\r\nclass Component {\r\n    constructor() {\r\n        /**\r\n         * Current owning [[Entity]], if any, of this component. Null if not added to any [[Entity]]\r\n         */\r\n        this.owner = null;\r\n    }\r\n    /**\r\n     * Clones any properties on this component, if that property value has a `clone()` method it will be called\r\n     */\r\n    clone() {\r\n        const newComponent = new this.constructor();\r\n        for (const prop in this) {\r\n            if (this.hasOwnProperty(prop)) {\r\n                const val = this[prop];\r\n                if (hasClone(val) && prop !== 'owner' && prop !== 'clone') {\r\n                    newComponent[prop] = val.clone();\r\n                }\r\n                else {\r\n                    newComponent[prop] = val;\r\n                }\r\n            }\r\n        }\r\n        return newComponent;\r\n    }\r\n}\r\n/**\r\n * Tag components are a way of tagging a component with label and a simple value\r\n *\r\n * For example:\r\n *\r\n * ```typescript\r\n * const isOffscreen = new TagComponent('offscreen');\r\n * entity.addComponent(isOffscreen);\r\n * entity.tags.includes\r\n * ```\r\n */\r\nclass TagComponent extends Component {\r\n    constructor(type, value) {\r\n        super();\r\n        this.type = type;\r\n        this.value = value;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/Components/TransformComponent.ts\n\r\n\r\n\r\n\r\nconst createPosView = (matrix) => {\r\n    const source = matrix;\r\n    return new VectorView({\r\n        setX: (x) => {\r\n            source.data[MatrixLocations.X] = x;\r\n        },\r\n        setY: (y) => {\r\n            source.data[MatrixLocations.Y] = y;\r\n        },\r\n        getX: () => {\r\n            return source.data[MatrixLocations.X];\r\n        },\r\n        getY: () => {\r\n            return source.data[MatrixLocations.Y];\r\n        }\r\n    });\r\n};\r\nconst createScaleView = (matrix) => {\r\n    const source = matrix;\r\n    return new VectorView({\r\n        setX: (x) => {\r\n            source.setScaleX(x);\r\n        },\r\n        setY: (y) => {\r\n            source.setScaleY(y);\r\n        },\r\n        getX: () => {\r\n            return source.getScaleX();\r\n        },\r\n        getY: () => {\r\n            return source.getScaleY();\r\n        }\r\n    });\r\n};\r\n/**\r\n * Enum representing the coordinate plane for the position 2D vector in the [[TransformComponent]]\r\n */\r\nvar CoordPlane;\r\n(function (CoordPlane) {\r\n    /**\r\n     * The world coordinate plane (default) represents world space, any entities drawn with world\r\n     * space move when the camera moves.\r\n     */\r\n    CoordPlane[\"World\"] = \"world\";\r\n    /**\r\n     * The screen coordinate plane represents screen space, entities drawn in screen space are pinned\r\n     * to screen coordinates ignoring the camera.\r\n     */\r\n    CoordPlane[\"Screen\"] = \"screen\";\r\n})(CoordPlane || (CoordPlane = {}));\r\nclass TransformComponent extends Component {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.type = 'ex.transform';\r\n        this._dirty = false;\r\n        this.matrix = Matrix.identity().translate(0, 0).rotate(0).scale(1, 1);\r\n        this._position = createPosView(this.matrix);\r\n        this._rotation = 0;\r\n        this._scale = createScaleView(this.matrix);\r\n        /**\r\n         * The [[CoordPlane|coordinate plane|]] for this transform for the entity.\r\n         */\r\n        this.coordPlane = CoordPlane.World;\r\n        /**\r\n         * The z-index ordering of the entity, a higher values are drawn on top of lower values.\r\n         * For example z=99 would be drawn on top of z=0.\r\n         */\r\n        this.z = 0;\r\n    }\r\n    _recalculate() {\r\n        this._rotation = this.matrix.getRotation();\r\n        this._dirty = false;\r\n    }\r\n    getGlobalMatrix() {\r\n        if (!this.parent) {\r\n            return this.matrix;\r\n        }\r\n        else {\r\n            return this.parent.getGlobalMatrix().multm(this.matrix);\r\n        }\r\n    }\r\n    getGlobalTransform() {\r\n        return {\r\n            pos: this.globalPos,\r\n            scale: this.globalScale,\r\n            rotation: this.globalRotation,\r\n            z: this.z,\r\n            coordPlane: this.coordPlane\r\n        };\r\n    }\r\n    get parent() {\r\n        var _a, _b;\r\n        return (_b = (_a = this === null || this === void 0 ? void 0 : this.owner) === null || _a === void 0 ? void 0 : _a.parent) === null || _b === void 0 ? void 0 : _b.get(TransformComponent);\r\n    }\r\n    /**\r\n     * The current position of the entity in world space or in screen space depending on the the [[CoordPlane|coordinate plane]].\r\n     *\r\n     * If a parent entity exists coordinates are local to the parent.\r\n     */\r\n    get pos() {\r\n        if (this._dirty) {\r\n            this._recalculate();\r\n        }\r\n        return this._position;\r\n    }\r\n    set pos(val) {\r\n        this.matrix.setPosition(val.x, val.y);\r\n        this._dirty = true;\r\n    }\r\n    // Dirty flag check up the chain\r\n    get dirty() {\r\n        var _a;\r\n        if ((_a = this === null || this === void 0 ? void 0 : this.owner) === null || _a === void 0 ? void 0 : _a.parent) {\r\n            const parent = this.parent;\r\n            return parent.dirty || this._dirty;\r\n        }\r\n        return this._dirty;\r\n    }\r\n    /**\r\n     * The current world position calculated\r\n     */\r\n    get globalPos() {\r\n        const source = this.getGlobalMatrix();\r\n        return new VectorView({\r\n            getX: () => source.data[MatrixLocations.X],\r\n            getY: () => source.data[MatrixLocations.Y],\r\n            setX: (x) => {\r\n                var _a;\r\n                if (this.parent) {\r\n                    const [newX] = (_a = this.parent) === null || _a === void 0 ? void 0 : _a.getGlobalMatrix().getAffineInverse().multv([x, source.data[MatrixLocations.Y]]);\r\n                    this.matrix.data[MatrixLocations.X] = newX;\r\n                }\r\n                else {\r\n                    this.matrix.data[MatrixLocations.X] = x;\r\n                }\r\n            },\r\n            setY: (y) => {\r\n                var _a;\r\n                if (this.parent) {\r\n                    const [, newY] = (_a = this.parent) === null || _a === void 0 ? void 0 : _a.getGlobalMatrix().getAffineInverse().multv([source.data[MatrixLocations.X], y]);\r\n                    this.matrix.data[MatrixLocations.Y] = newY;\r\n                }\r\n                else {\r\n                    this.matrix.data[MatrixLocations.Y] = y;\r\n                }\r\n            }\r\n        });\r\n    }\r\n    set globalPos(val) {\r\n        const parentTransform = this.parent;\r\n        if (!parentTransform) {\r\n            this.pos = val;\r\n        }\r\n        else {\r\n            this.pos = parentTransform.getGlobalMatrix().getAffineInverse().multv(val);\r\n        }\r\n    }\r\n    /**\r\n     * The rotation of the entity in radians. For example `Math.PI` radians is the same as 180 degrees.\r\n     */\r\n    get rotation() {\r\n        if (this._dirty) {\r\n            this._recalculate();\r\n        }\r\n        return this._rotation;\r\n    }\r\n    set rotation(val) {\r\n        this.matrix.setRotation(val);\r\n        this._dirty = true;\r\n    }\r\n    get globalRotation() {\r\n        return this.getGlobalMatrix().getRotation();\r\n    }\r\n    set globalRotation(val) {\r\n        const parentTransform = this.parent;\r\n        if (!parentTransform) {\r\n            this.rotation = val;\r\n        }\r\n        else {\r\n            this.rotation = val - parentTransform.globalRotation;\r\n        }\r\n    }\r\n    /**\r\n     * The scale of the entity.\r\n     */\r\n    get scale() {\r\n        if (this._dirty) {\r\n            this._recalculate();\r\n        }\r\n        return this._scale;\r\n    }\r\n    set scale(val) {\r\n        this.matrix.setScale(val);\r\n        this._dirty = true;\r\n    }\r\n    get globalScale() {\r\n        const source = this.getGlobalMatrix();\r\n        return new VectorView({\r\n            getX: () => source.getScaleX(),\r\n            getY: () => source.getScaleY(),\r\n            setX: (x) => {\r\n                if (this.parent) {\r\n                    const globalScaleX = this.parent.globalScale.x;\r\n                    this.matrix.setScaleX(x / globalScaleX);\r\n                }\r\n                else {\r\n                    this.matrix.setScaleX(x);\r\n                }\r\n            },\r\n            setY: (y) => {\r\n                if (this.parent) {\r\n                    const globalScaleY = this.parent.globalScale.y;\r\n                    this.matrix.setScaleY(y / globalScaleY);\r\n                }\r\n                else {\r\n                    this.matrix.setScaleY(y);\r\n                }\r\n            }\r\n        });\r\n    }\r\n    set globalScale(val) {\r\n        const parentTransform = this.parent;\r\n        if (!parentTransform) {\r\n            this.scale = val;\r\n        }\r\n        else {\r\n            this.scale = vec(val.x / parentTransform.globalScale.x, val.y / parentTransform.globalScale.y);\r\n        }\r\n    }\r\n    /**\r\n     * Apply the transform to a point\r\n     * @param point\r\n     */\r\n    apply(point) {\r\n        return this.matrix.multv(point);\r\n    }\r\n    /**\r\n     * Apply the inverse transform to a point\r\n     * @param point\r\n     */\r\n    applyInverse(point) {\r\n        return this.matrix.getAffineInverse().multv(point);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/Components/MotionComponent.ts\n\r\n\r\nclass MotionComponent extends Component {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.type = 'ex.motion';\r\n        /**\r\n         * The velocity of an entity in pixels per second\r\n         */\r\n        this.vel = Vector.Zero;\r\n        /**\r\n         * The acceleration of entity in pixels per second^2\r\n         */\r\n        this.acc = Vector.Zero;\r\n        /**\r\n         * The scale rate of change in scale units per second\r\n         */\r\n        this.scaleFactor = Vector.Zero;\r\n        /**\r\n         * The angular velocity which is how quickly the entity is rotating in radians per second\r\n         */\r\n        this.angularVelocity = 0;\r\n        /**\r\n         * The amount of torque applied to the entity, angular acceleration is torque * inertia\r\n         */\r\n        this.torque = 0;\r\n        /**\r\n         * Inertia can be thought of as the resistance to motion\r\n         */\r\n        this.inertia = 1;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Group/CollisionGroup.ts\n/**\r\n * CollisionGroups indicate like members that do not collide with each other. Use [[CollisionGroupManager]] to create [[CollisionGroup]]s\r\n *\r\n * For example:\r\n *\r\n * Players have collision group \"player\"\r\n *\r\n * ![Player Collision Group](/assets/images/docs/CollisionGroupsPlayer.png)\r\n *\r\n * Enemies have collision group \"enemy\"\r\n *\r\n * ![Enemy Collision Group](/assets/images/docs/CollisionGroupsEnemy.png)\r\n *\r\n * Blocks have collision group \"ground\"\r\n *\r\n * ![Ground collision group](/assets/images/docs/CollisionGroupsGround.png)\r\n *\r\n * Players don't collide with each other, but enemies and blocks. Likewise, enemies don't collide with each other but collide\r\n * with players and blocks.\r\n *\r\n * This is done with bitmasking, see the following pseudo-code\r\n *\r\n * PlayerGroup = `0b001`\r\n * PlayerGroupMask = `0b110`\r\n *\r\n * EnemyGroup = `0b010`\r\n * EnemyGroupMask = `0b101`\r\n *\r\n * BlockGroup = `0b100`\r\n * BlockGroupMask = `0b011`\r\n *\r\n * Should Players collide? No because the bitwise mask evaluates to 0\r\n * `(player1.group & player2.mask) === 0`\r\n * `(0b001 & 0b110) === 0`\r\n *\r\n * Should Players and Enemies collide? Yes because the bitwise mask is non-zero\r\n * `(player1.group & enemy1.mask) === 1`\r\n * `(0b001 & 0b101) === 1`\r\n *\r\n * Should Players and Blocks collide? Yes because the bitwise mask is non-zero\r\n * `(player1.group & blocks1.mask) === 1`\r\n * `(0b001 & 0b011) === 1`\r\n */\r\nclass CollisionGroup {\r\n    /**\r\n     * STOP!!** It is preferred that [[CollisionGroupManager.create]] is used to create collision groups\r\n     *  unless you know how to construct the proper bitmasks. See https://github.com/excaliburjs/Excalibur/issues/1091 for more info.\r\n     * @param name Name of the collision group\r\n     * @param category 32 bit category for the group, should be a unique power of 2. For example `0b001` or `0b010`\r\n     * @param mask 32 bit mask of category, or `~category` generally. For a category of `0b001`, the mask would be `0b110`\r\n     */\r\n    constructor(name, category, mask) {\r\n        this._name = name;\r\n        this._category = category;\r\n        this._mask = mask;\r\n    }\r\n    /**\r\n     * Get the name of the collision group\r\n     */\r\n    get name() {\r\n        return this._name;\r\n    }\r\n    /**\r\n     * Get the category of the collision group, a 32 bit number which should be a unique power of 2\r\n     */\r\n    get category() {\r\n        return this._category;\r\n    }\r\n    /**\r\n     * Get the mask for this collision group\r\n     */\r\n    get mask() {\r\n        return this._mask;\r\n    }\r\n    /**\r\n     * Evaluates whether 2 collision groups can collide\r\n     * @param other  CollisionGroup\r\n     */\r\n    canCollide(other) {\r\n        return (this.category & other.mask) !== 0 && (other.category & this.mask) !== 0;\r\n    }\r\n    /**\r\n     * Inverts the collision group. For example, if before the group specified \"players\",\r\n     * inverting would specify all groups except players\r\n     * @returns CollisionGroup\r\n     */\r\n    invert() {\r\n        return new CollisionGroup('~(' + this.name + ')', ~this.category, ~this.mask);\r\n    }\r\n    /**\r\n     * Combine collision groups with each other. The new group includes all of the previous groups.\r\n     *\r\n     * @param collisionGroups\r\n     */\r\n    static combine(collisionGroups) {\r\n        const combinedName = collisionGroups.map((c) => c.name).join('+');\r\n        const combinedCategory = collisionGroups.reduce((current, g) => g.category | current, 0b0);\r\n        const combinedMask = ~combinedCategory;\r\n        return new CollisionGroup(combinedName, combinedCategory, combinedMask);\r\n    }\r\n    /**\r\n     * Creates a collision group that collides with the listed groups\r\n     * @param collisionGroups\r\n     */\r\n    static collidesWith(collisionGroups) {\r\n        return CollisionGroup.combine(collisionGroups).invert();\r\n    }\r\n}\r\n/**\r\n * The `All` [[CollisionGroup]] is a special group that collides with all other groups including itself,\r\n * it is the default collision group on colliders.\r\n */\r\nCollisionGroup.All = new CollisionGroup('Collide with all groups', -1, -1);\r\n\n;// CONCATENATED MODULE: ./Util/Observable.ts\n/**\r\n * Simple Observable implementation\r\n * @template T is the typescript Type that defines the data being observed\r\n */\r\nclass Observable {\r\n    constructor() {\r\n        this.observers = [];\r\n        this.subscriptions = [];\r\n    }\r\n    /**\r\n     * Register an observer to listen to this observable\r\n     * @param observer\r\n     */\r\n    register(observer) {\r\n        this.observers.push(observer);\r\n    }\r\n    /**\r\n     * Register a callback to listen to this observable\r\n     * @param func\r\n     */\r\n    subscribe(func) {\r\n        this.subscriptions.push(func);\r\n    }\r\n    /**\r\n     * Remove an observer from the observable\r\n     * @param observer\r\n     */\r\n    unregister(observer) {\r\n        const i = this.observers.indexOf(observer);\r\n        if (i !== -1) {\r\n            this.observers.splice(i, 1);\r\n        }\r\n    }\r\n    /**\r\n     * Remove a callback that is listening to this observable\r\n     * @param func\r\n     */\r\n    unsubscribe(func) {\r\n        const i = this.subscriptions.indexOf(func);\r\n        if (i !== -1) {\r\n            this.subscriptions.splice(i, 1);\r\n        }\r\n    }\r\n    /**\r\n     * Broadcasts a message to all observers and callbacks\r\n     * @param message\r\n     */\r\n    notifyAll(message) {\r\n        this.observers.forEach((o) => o.notify(message));\r\n        this.subscriptions.forEach(cb => cb(message));\r\n    }\r\n    /**\r\n     * Removes all observers and callbacks\r\n     */\r\n    clear() {\r\n        this.observers.length = 0;\r\n        this.subscriptions.length = 0;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Detection/Pair.ts\n\r\n\r\n/**\r\n * Models a potential collision between 2 colliders\r\n */\r\nclass Pair {\r\n    constructor(colliderA, colliderB) {\r\n        this.colliderA = colliderA;\r\n        this.colliderB = colliderB;\r\n        this.id = null;\r\n        this.id = Pair.calculatePairHash(colliderA.id, colliderB.id);\r\n    }\r\n    /**\r\n     * Returns whether a it is allowed for 2 colliders in a Pair to collide\r\n     * @param colliderA\r\n     * @param colliderB\r\n     */\r\n    static canCollide(colliderA, colliderB) {\r\n        var _a, _b;\r\n        const bodyA = (_a = colliderA === null || colliderA === void 0 ? void 0 : colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n        const bodyB = (_b = colliderB === null || colliderB === void 0 ? void 0 : colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n        // Prevent self collision\r\n        if (colliderA.id === colliderB.id) {\r\n            return false;\r\n        }\r\n        // Colliders with the same owner do not collide (composite colliders)\r\n        if (colliderA.owner &&\r\n            colliderB.owner &&\r\n            colliderA.owner.id === colliderB.owner.id) {\r\n            return false;\r\n        }\r\n        // if the pair has a member with zero dimension don't collide\r\n        if (colliderA.localBounds.hasZeroDimensions() || colliderB.localBounds.hasZeroDimensions()) {\r\n            return false;\r\n        }\r\n        // Body's needed for collision in the current state\r\n        // TODO can we collide without a body?\r\n        if (!bodyA || !bodyB) {\r\n            return false;\r\n        }\r\n        // If both are in the same collision group short circuit\r\n        if (!bodyA.group.canCollide(bodyB.group)) {\r\n            return false;\r\n        }\r\n        // if both are fixed short circuit\r\n        if (bodyA.collisionType === CollisionType.Fixed && bodyB.collisionType === CollisionType.Fixed) {\r\n            return false;\r\n        }\r\n        // if the either is prevent collision short circuit\r\n        if (bodyB.collisionType === CollisionType.PreventCollision || bodyA.collisionType === CollisionType.PreventCollision) {\r\n            return false;\r\n        }\r\n        // if either is dead short circuit\r\n        if (!bodyA.active || !bodyB.active) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    /**\r\n     * Returns whether or not it is possible for the pairs to collide\r\n     */\r\n    get canCollide() {\r\n        const colliderA = this.colliderA;\r\n        const colliderB = this.colliderB;\r\n        return Pair.canCollide(colliderA, colliderB);\r\n    }\r\n    /**\r\n     * Runs the collision intersection logic on the members of this pair\r\n     */\r\n    collide() {\r\n        return this.colliderA.collide(this.colliderB);\r\n    }\r\n    /**\r\n     * Check if the collider is part of the pair\r\n     * @param collider\r\n     */\r\n    hasCollider(collider) {\r\n        return collider === this.colliderA || collider === this.colliderB;\r\n    }\r\n    /**\r\n     * Calculates the unique pair hash id for this collision pair (owning id)\r\n     */\r\n    static calculatePairHash(idA, idB) {\r\n        if (idA.value < idB.value) {\r\n            return `#${idA.value}+${idB.value}`;\r\n        }\r\n        else {\r\n            return `#${idB.value}+${idA.value}`;\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/projection.ts\n/**\r\n * A 1 dimensional projection on an axis, used to test overlaps\r\n */\r\nclass Projection {\r\n    constructor(min, max) {\r\n        this.min = min;\r\n        this.max = max;\r\n    }\r\n    overlaps(projection) {\r\n        return this.max > projection.min && projection.max > this.min;\r\n    }\r\n    getOverlap(projection) {\r\n        if (this.overlaps(projection)) {\r\n            if (this.max > projection.max) {\r\n                return projection.max - this.min;\r\n            }\r\n            else {\r\n                return this.max - projection.min;\r\n            }\r\n        }\r\n        return 0;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Detection/DynamicTree.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Dynamic Tree Node used for tracking bounds within the tree\r\n */\r\nclass TreeNode {\r\n    constructor(parent) {\r\n        this.parent = parent;\r\n        this.parent = parent || null;\r\n        this.data = null;\r\n        this.bounds = new BoundingBox();\r\n        this.left = null;\r\n        this.right = null;\r\n        this.height = 0;\r\n    }\r\n    isLeaf() {\r\n        return !this.left && !this.right;\r\n    }\r\n}\r\n/**\r\n * The DynamicTrees provides a spatial partitioning data structure for quickly querying for overlapping bounding boxes for\r\n * all tracked bodies. The worst case performance of this is O(n*log(n)) where n is the number of bodies in the tree.\r\n *\r\n * Internally the bounding boxes are organized as a balanced binary tree of bounding boxes, where the leaf nodes are tracked bodies.\r\n * Every non-leaf node is a bounding box that contains child bounding boxes.\r\n */\r\nclass DynamicTree {\r\n    constructor(worldBounds = new BoundingBox(-Number.MAX_VALUE, -Number.MAX_VALUE, Number.MAX_VALUE, Number.MAX_VALUE)) {\r\n        this.worldBounds = worldBounds;\r\n        this.root = null;\r\n        this.nodes = {};\r\n    }\r\n    /**\r\n     * Inserts a node into the dynamic tree\r\n     */\r\n    _insert(leaf) {\r\n        // If there are no nodes in the tree, make this the root leaf\r\n        if (this.root === null) {\r\n            this.root = leaf;\r\n            this.root.parent = null;\r\n            return;\r\n        }\r\n        // Search the tree for a node that is not a leaf and find the best place to insert\r\n        const leafAABB = leaf.bounds;\r\n        let currentRoot = this.root;\r\n        while (!currentRoot.isLeaf()) {\r\n            const left = currentRoot.left;\r\n            const right = currentRoot.right;\r\n            const area = currentRoot.bounds.getPerimeter();\r\n            const combinedAABB = currentRoot.bounds.combine(leafAABB);\r\n            const combinedArea = combinedAABB.getPerimeter();\r\n            // Calculate cost heuristic for creating a new parent and leaf\r\n            const cost = 2 * combinedArea;\r\n            // Minimum cost of pushing the leaf down the tree\r\n            const inheritanceCost = 2 * (combinedArea - area);\r\n            // Cost of descending\r\n            let leftCost = 0;\r\n            const leftCombined = leafAABB.combine(left.bounds);\r\n            let newArea;\r\n            let oldArea;\r\n            if (left.isLeaf()) {\r\n                leftCost = leftCombined.getPerimeter() + inheritanceCost;\r\n            }\r\n            else {\r\n                oldArea = left.bounds.getPerimeter();\r\n                newArea = leftCombined.getPerimeter();\r\n                leftCost = newArea - oldArea + inheritanceCost;\r\n            }\r\n            let rightCost = 0;\r\n            const rightCombined = leafAABB.combine(right.bounds);\r\n            if (right.isLeaf()) {\r\n                rightCost = rightCombined.getPerimeter() + inheritanceCost;\r\n            }\r\n            else {\r\n                oldArea = right.bounds.getPerimeter();\r\n                newArea = rightCombined.getPerimeter();\r\n                rightCost = newArea - oldArea + inheritanceCost;\r\n            }\r\n            // cost is acceptable\r\n            if (cost < leftCost && cost < rightCost) {\r\n                break;\r\n            }\r\n            // Descend to the depths\r\n            if (leftCost < rightCost) {\r\n                currentRoot = left;\r\n            }\r\n            else {\r\n                currentRoot = right;\r\n            }\r\n        }\r\n        // Create the new parent node and insert into the tree\r\n        const oldParent = currentRoot.parent;\r\n        const newParent = new TreeNode(oldParent);\r\n        newParent.bounds = leafAABB.combine(currentRoot.bounds);\r\n        newParent.height = currentRoot.height + 1;\r\n        if (oldParent !== null) {\r\n            // The sibling node was not the root\r\n            if (oldParent.left === currentRoot) {\r\n                oldParent.left = newParent;\r\n            }\r\n            else {\r\n                oldParent.right = newParent;\r\n            }\r\n            newParent.left = currentRoot;\r\n            newParent.right = leaf;\r\n            currentRoot.parent = newParent;\r\n            leaf.parent = newParent;\r\n        }\r\n        else {\r\n            // The sibling node was the root\r\n            newParent.left = currentRoot;\r\n            newParent.right = leaf;\r\n            currentRoot.parent = newParent;\r\n            leaf.parent = newParent;\r\n            this.root = newParent;\r\n        }\r\n        // Walk up the tree fixing heights and AABBs\r\n        let currentNode = leaf.parent;\r\n        while (currentNode) {\r\n            currentNode = this._balance(currentNode);\r\n            if (!currentNode.left) {\r\n                throw new Error('Parent of current leaf cannot have a null left child' + currentNode);\r\n            }\r\n            if (!currentNode.right) {\r\n                throw new Error('Parent of current leaf cannot have a null right child' + currentNode);\r\n            }\r\n            currentNode.height = 1 + Math.max(currentNode.left.height, currentNode.right.height);\r\n            currentNode.bounds = currentNode.left.bounds.combine(currentNode.right.bounds);\r\n            currentNode = currentNode.parent;\r\n        }\r\n    }\r\n    /**\r\n     * Removes a node from the dynamic tree\r\n     */\r\n    _remove(leaf) {\r\n        if (leaf === this.root) {\r\n            this.root = null;\r\n            return;\r\n        }\r\n        const parent = leaf.parent;\r\n        const grandParent = parent.parent;\r\n        let sibling;\r\n        if (parent.left === leaf) {\r\n            sibling = parent.right;\r\n        }\r\n        else {\r\n            sibling = parent.left;\r\n        }\r\n        if (grandParent) {\r\n            if (grandParent.left === parent) {\r\n                grandParent.left = sibling;\r\n            }\r\n            else {\r\n                grandParent.right = sibling;\r\n            }\r\n            sibling.parent = grandParent;\r\n            let currentNode = grandParent;\r\n            while (currentNode) {\r\n                currentNode = this._balance(currentNode);\r\n                currentNode.bounds = currentNode.left.bounds.combine(currentNode.right.bounds);\r\n                currentNode.height = 1 + Math.max(currentNode.left.height, currentNode.right.height);\r\n                currentNode = currentNode.parent;\r\n            }\r\n        }\r\n        else {\r\n            this.root = sibling;\r\n            sibling.parent = null;\r\n        }\r\n    }\r\n    /**\r\n     * Tracks a body in the dynamic tree\r\n     */\r\n    trackCollider(collider) {\r\n        const node = new TreeNode();\r\n        node.data = collider;\r\n        node.bounds = collider.bounds;\r\n        node.bounds.left -= 2;\r\n        node.bounds.top -= 2;\r\n        node.bounds.right += 2;\r\n        node.bounds.bottom += 2;\r\n        this.nodes[collider.id.value] = node;\r\n        this._insert(node);\r\n    }\r\n    /**\r\n     * Updates the dynamic tree given the current bounds of each body being tracked\r\n     */\r\n    updateCollider(collider) {\r\n        var _a;\r\n        const node = this.nodes[collider.id.value];\r\n        if (!node) {\r\n            return false;\r\n        }\r\n        const b = collider.bounds;\r\n        // if the body is outside the world no longer update it\r\n        if (!this.worldBounds.contains(b)) {\r\n            Logger.getInstance().warn('Collider with id ' + collider.id.value + ' is outside the world bounds and will no longer be tracked for physics');\r\n            this.untrackCollider(collider);\r\n            return false;\r\n        }\r\n        if (node.bounds.contains(b)) {\r\n            return false;\r\n        }\r\n        this._remove(node);\r\n        b.left -= Physics.boundsPadding;\r\n        b.top -= Physics.boundsPadding;\r\n        b.right += Physics.boundsPadding;\r\n        b.bottom += Physics.boundsPadding;\r\n        // THIS IS CAUSING UNECESSARY CHECKS\r\n        if (collider.owner) {\r\n            const body = (_a = collider.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n            if (body) {\r\n                const multdx = ((body.vel.x * 32) / 1000) * Physics.dynamicTreeVelocityMultiplier;\r\n                const multdy = ((body.vel.y * 32) / 1000) * Physics.dynamicTreeVelocityMultiplier;\r\n                if (multdx < 0) {\r\n                    b.left += multdx;\r\n                }\r\n                else {\r\n                    b.right += multdx;\r\n                }\r\n                if (multdy < 0) {\r\n                    b.top += multdy;\r\n                }\r\n                else {\r\n                    b.bottom += multdy;\r\n                }\r\n            }\r\n        }\r\n        node.bounds = b;\r\n        this._insert(node);\r\n        return true;\r\n    }\r\n    /**\r\n     * Untracks a body from the dynamic tree\r\n     */\r\n    untrackCollider(collider) {\r\n        const node = this.nodes[collider.id.value];\r\n        if (!node) {\r\n            return;\r\n        }\r\n        this._remove(node);\r\n        this.nodes[collider.id.value] = null;\r\n        delete this.nodes[collider.id.value];\r\n    }\r\n    /**\r\n     * Balances the tree about a node\r\n     */\r\n    _balance(node) {\r\n        if (node === null) {\r\n            throw new Error('Cannot balance at null node');\r\n        }\r\n        if (node.isLeaf() || node.height < 2) {\r\n            return node;\r\n        }\r\n        const left = node.left;\r\n        const right = node.right;\r\n        const a = node;\r\n        const b = left;\r\n        const c = right;\r\n        const d = left.left;\r\n        const e = left.right;\r\n        const f = right.left;\r\n        const g = right.right;\r\n        const balance = c.height - b.height;\r\n        // Rotate c node up\r\n        if (balance > 1) {\r\n            // Swap the right node with it's parent\r\n            c.left = a;\r\n            c.parent = a.parent;\r\n            a.parent = c;\r\n            // The original node's old parent should point to the right node\r\n            // this is mega confusing\r\n            if (c.parent) {\r\n                if (c.parent.left === a) {\r\n                    c.parent.left = c;\r\n                }\r\n                else {\r\n                    c.parent.right = c;\r\n                }\r\n            }\r\n            else {\r\n                this.root = c;\r\n            }\r\n            // Rotate\r\n            if (f.height > g.height) {\r\n                c.right = f;\r\n                a.right = g;\r\n                g.parent = a;\r\n                a.bounds = b.bounds.combine(g.bounds);\r\n                c.bounds = a.bounds.combine(f.bounds);\r\n                a.height = 1 + Math.max(b.height, g.height);\r\n                c.height = 1 + Math.max(a.height, f.height);\r\n            }\r\n            else {\r\n                c.right = g;\r\n                a.right = f;\r\n                f.parent = a;\r\n                a.bounds = b.bounds.combine(f.bounds);\r\n                c.bounds = a.bounds.combine(g.bounds);\r\n                a.height = 1 + Math.max(b.height, f.height);\r\n                c.height = 1 + Math.max(a.height, g.height);\r\n            }\r\n            return c;\r\n        }\r\n        // Rotate left node up\r\n        if (balance < -1) {\r\n            // swap\r\n            b.left = a;\r\n            b.parent = a.parent;\r\n            a.parent = b;\r\n            // node's old parent should point to b\r\n            if (b.parent) {\r\n                if (b.parent.left === a) {\r\n                    b.parent.left = b;\r\n                }\r\n                else {\r\n                    if (b.parent.right !== a) {\r\n                        throw 'Error rotating Dynamic Tree';\r\n                    }\r\n                    b.parent.right = b;\r\n                }\r\n            }\r\n            else {\r\n                this.root = b;\r\n            }\r\n            // rotate\r\n            if (d.height > e.height) {\r\n                b.right = d;\r\n                a.left = e;\r\n                e.parent = a;\r\n                a.bounds = c.bounds.combine(e.bounds);\r\n                b.bounds = a.bounds.combine(d.bounds);\r\n                a.height = 1 + Math.max(c.height, e.height);\r\n                b.height = 1 + Math.max(a.height, d.height);\r\n            }\r\n            else {\r\n                b.right = e;\r\n                a.left = d;\r\n                d.parent = a;\r\n                a.bounds = c.bounds.combine(d.bounds);\r\n                b.bounds = a.bounds.combine(e.bounds);\r\n                a.height = 1 + Math.max(c.height, d.height);\r\n                b.height = 1 + Math.max(a.height, e.height);\r\n            }\r\n            return b;\r\n        }\r\n        return node;\r\n    }\r\n    /**\r\n     * Returns the internal height of the tree, shorter trees are better. Performance drops as the tree grows\r\n     */\r\n    getHeight() {\r\n        if (this.root === null) {\r\n            return 0;\r\n        }\r\n        return this.root.height;\r\n    }\r\n    /**\r\n     * Queries the Dynamic Axis Aligned Tree for bodies that could be colliding with the provided body.\r\n     *\r\n     * In the query callback, it will be passed a potential collider. Returning true from this callback indicates\r\n     * that you are complete with your query and you do not want to continue. Returning false will continue searching\r\n     * the tree until all possible colliders have been returned.\r\n     */\r\n    query(collider, callback) {\r\n        const bounds = collider.bounds;\r\n        const helper = (currentNode) => {\r\n            if (currentNode && currentNode.bounds.intersect(bounds)) {\r\n                if (currentNode.isLeaf() && currentNode.data !== collider) {\r\n                    if (callback.call(collider, currentNode.data)) {\r\n                        return true;\r\n                    }\r\n                }\r\n                else {\r\n                    return helper(currentNode.left) || helper(currentNode.right);\r\n                }\r\n            }\r\n            return false;\r\n        };\r\n        helper(this.root);\r\n    }\r\n    /**\r\n     * Queries the Dynamic Axis Aligned Tree for bodies that could be intersecting. By default the raycast query uses an infinitely\r\n     * long ray to test the tree specified by `max`.\r\n     *\r\n     * In the query callback, it will be passed a potential body that intersects with the raycast. Returning true from this\r\n     * callback indicates that your are complete with your query and do not want to continue. Return false will continue searching\r\n     * the tree until all possible bodies that would intersect with the ray have been returned.\r\n     */\r\n    rayCastQuery(ray, max = Infinity, callback) {\r\n        const helper = (currentNode) => {\r\n            if (currentNode && currentNode.bounds.rayCast(ray, max)) {\r\n                if (currentNode.isLeaf()) {\r\n                    if (callback.call(ray, currentNode.data)) {\r\n                        // ray hit a leaf! return the body\r\n                        return true;\r\n                    }\r\n                }\r\n                else {\r\n                    // ray hit but not at a leaf, recurse deeper\r\n                    return helper(currentNode.left) || helper(currentNode.right);\r\n                }\r\n            }\r\n            return false; // ray missed\r\n        };\r\n        helper(this.root);\r\n    }\r\n    getNodes() {\r\n        const helper = (currentNode) => {\r\n            if (currentNode) {\r\n                return [currentNode].concat(helper(currentNode.left), helper(currentNode.right));\r\n            }\r\n            else {\r\n                return [];\r\n            }\r\n        };\r\n        return helper(this.root);\r\n    }\r\n    debug(ex) {\r\n        // draw all the nodes in the Dynamic Tree\r\n        const helper = (currentNode) => {\r\n            if (currentNode) {\r\n                if (currentNode.isLeaf()) {\r\n                    currentNode.bounds.draw(ex, Color.Green);\r\n                }\r\n                else {\r\n                    currentNode.bounds.draw(ex, Color.White);\r\n                }\r\n                if (currentNode.left) {\r\n                    helper(currentNode.left);\r\n                }\r\n                if (currentNode.right) {\r\n                    helper(currentNode.right);\r\n                }\r\n            }\r\n        };\r\n        helper(this.root);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/ray.ts\n/**\r\n * A 2D ray that can be cast into the scene to do collision detection\r\n */\r\nclass Ray {\r\n    /**\r\n     * @param pos The starting position for the ray\r\n     * @param dir The vector indicating the direction of the ray\r\n     */\r\n    constructor(pos, dir) {\r\n        this.pos = pos;\r\n        this.dir = dir.normalize();\r\n    }\r\n    /**\r\n     * Tests a whether this ray intersects with a line segment. Returns a number greater than or equal to 0 on success.\r\n     * This number indicates the mathematical intersection time.\r\n     * @param line  The line to test\r\n     */\r\n    intersect(line) {\r\n        const numerator = line.begin.sub(this.pos);\r\n        // Test is line and ray are parallel and non intersecting\r\n        if (this.dir.cross(line.getSlope()) === 0 && numerator.cross(this.dir) !== 0) {\r\n            return -1;\r\n        }\r\n        // Lines are parallel\r\n        const divisor = this.dir.cross(line.getSlope());\r\n        if (divisor === 0) {\r\n            return -1;\r\n        }\r\n        const t = numerator.cross(line.getSlope()) / divisor;\r\n        if (t >= 0) {\r\n            const u = numerator.cross(this.dir) / divisor / line.getLength();\r\n            if (u >= 0 && u <= 1) {\r\n                return t;\r\n            }\r\n        }\r\n        return -1;\r\n    }\r\n    intersectPoint(line) {\r\n        const time = this.intersect(line);\r\n        if (time < 0) {\r\n            return null;\r\n        }\r\n        return this.getPoint(time);\r\n    }\r\n    /**\r\n     * Returns the point of intersection given the intersection time\r\n     */\r\n    getPoint(time) {\r\n        return this.pos.add(this.dir.scale(time));\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Detection/DynamicTreeCollisionProcessor.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Responsible for performing the collision broadphase (locating potential collisions) and\r\n * the narrowphase (actual collision contacts)\r\n */\r\nclass DynamicTreeCollisionProcessor {\r\n    constructor() {\r\n        this._dynamicCollisionTree = new DynamicTree();\r\n        this._pairs = new Set();\r\n        this._collisionPairCache = [];\r\n        this._colliders = [];\r\n    }\r\n    getColliders() {\r\n        return this._colliders;\r\n    }\r\n    /**\r\n     * Tracks a physics body for collisions\r\n     */\r\n    track(target) {\r\n        if (!target) {\r\n            Logger.getInstance().warn('Cannot track null collider');\r\n            return;\r\n        }\r\n        if (target instanceof CompositeCollider) {\r\n            const colliders = target.getColliders();\r\n            for (const c of colliders) {\r\n                c.owner = target.owner;\r\n                this._colliders.push(c);\r\n                this._dynamicCollisionTree.trackCollider(c);\r\n            }\r\n        }\r\n        else {\r\n            this._colliders.push(target);\r\n            this._dynamicCollisionTree.trackCollider(target);\r\n        }\r\n    }\r\n    /**\r\n     * Untracks a physics body\r\n     */\r\n    untrack(target) {\r\n        if (!target) {\r\n            Logger.getInstance().warn('Cannot untrack a null collider');\r\n            return;\r\n        }\r\n        if (target instanceof CompositeCollider) {\r\n            const colliders = target.getColliders();\r\n            for (const c of colliders) {\r\n                const index = this._colliders.indexOf(c);\r\n                if (index !== -1) {\r\n                    this._colliders.splice(index, 1);\r\n                }\r\n                this._dynamicCollisionTree.untrackCollider(c);\r\n            }\r\n        }\r\n        else {\r\n            const index = this._colliders.indexOf(target);\r\n            if (index !== -1) {\r\n                this._colliders.splice(index, 1);\r\n            }\r\n            this._dynamicCollisionTree.untrackCollider(target);\r\n        }\r\n    }\r\n    _pairExists(colliderA, colliderB) {\r\n        // if the collision pair has been calculated already short circuit\r\n        const hash = Pair.calculatePairHash(colliderA.id, colliderB.id);\r\n        return this._pairs.has(hash);\r\n    }\r\n    /**\r\n     * Detects potential collision pairs in a broadphase approach with the dynamic AABB tree strategy\r\n     */\r\n    broadphase(targets, delta, stats) {\r\n        const seconds = delta / 1000;\r\n        // Retrieve the list of potential colliders, exclude killed, prevented, and self\r\n        const potentialColliders = targets.filter((other) => {\r\n            var _a, _b;\r\n            const body = (_a = other.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n            return ((_b = other.owner) === null || _b === void 0 ? void 0 : _b.active) && body.collisionType !== CollisionType.PreventCollision;\r\n        });\r\n        // clear old list of collision pairs\r\n        this._collisionPairCache = [];\r\n        this._pairs.clear();\r\n        // check for normal collision pairs\r\n        let collider;\r\n        for (let j = 0, l = potentialColliders.length; j < l; j++) {\r\n            collider = potentialColliders[j];\r\n            // Query the collision tree for potential colliders\r\n            this._dynamicCollisionTree.query(collider, (other) => {\r\n                if (!this._pairExists(collider, other) && Pair.canCollide(collider, other)) {\r\n                    const pair = new Pair(collider, other);\r\n                    this._pairs.add(pair.id);\r\n                    this._collisionPairCache.push(pair);\r\n                }\r\n                // Always return false, to query whole tree. Returning true in the query method stops searching\r\n                return false;\r\n            });\r\n        }\r\n        if (stats) {\r\n            stats.physics.pairs = this._collisionPairCache.length;\r\n        }\r\n        // Check dynamic tree for fast moving objects\r\n        // Fast moving objects are those moving at least there smallest bound per frame\r\n        if (Physics.checkForFastBodies) {\r\n            for (const collider of potentialColliders) {\r\n                const body = collider.owner.get(BodyComponent);\r\n                // Skip non-active objects. Does not make sense on other collision types\r\n                if (body.collisionType !== CollisionType.Active) {\r\n                    continue;\r\n                }\r\n                // Maximum travel distance next frame\r\n                const updateDistance = body.vel.size * seconds + // velocity term\r\n                    body.acc.size * 0.5 * seconds * seconds; // acc term\r\n                // Find the minimum dimension\r\n                const minDimension = Math.min(collider.bounds.height, collider.bounds.width);\r\n                if (Physics.disableMinimumSpeedForFastBody || updateDistance > minDimension / 2) {\r\n                    if (stats) {\r\n                        stats.physics.fastBodies++;\r\n                    }\r\n                    // start with the oldPos because the integration for actors has already happened\r\n                    // objects resting on a surface may be slightly penetrating in the current position\r\n                    const updateVec = body.pos.sub(body.oldPos);\r\n                    const centerPoint = collider.center;\r\n                    const furthestPoint = collider.getFurthestPoint(body.vel);\r\n                    const origin = furthestPoint.sub(updateVec);\r\n                    const ray = new Ray(origin, body.vel);\r\n                    // back the ray up by -2x surfaceEpsilon to account for fast moving objects starting on the surface\r\n                    ray.pos = ray.pos.add(ray.dir.scale(-2 * Physics.surfaceEpsilon));\r\n                    let minCollider;\r\n                    let minTranslate = new Vector(Infinity, Infinity);\r\n                    this._dynamicCollisionTree.rayCastQuery(ray, updateDistance + Physics.surfaceEpsilon * 2, (other) => {\r\n                        if (!this._pairExists(collider, other) && Pair.canCollide(collider, other)) {\r\n                            const hitPoint = other.rayCast(ray, updateDistance + Physics.surfaceEpsilon * 10);\r\n                            if (hitPoint) {\r\n                                const translate = hitPoint.sub(origin);\r\n                                if (translate.size < minTranslate.size) {\r\n                                    minTranslate = translate;\r\n                                    minCollider = other;\r\n                                }\r\n                            }\r\n                        }\r\n                        return false;\r\n                    });\r\n                    if (minCollider && Vector.isValid(minTranslate)) {\r\n                        const pair = new Pair(collider, minCollider);\r\n                        if (!this._pairs.has(pair.id)) {\r\n                            this._pairs.add(pair.id);\r\n                            this._collisionPairCache.push(pair);\r\n                        }\r\n                        // move the fast moving object to the other body\r\n                        // need to push into the surface by ex.Physics.surfaceEpsilon\r\n                        const shift = centerPoint.sub(furthestPoint);\r\n                        body.pos = origin\r\n                            .add(shift)\r\n                            .add(minTranslate)\r\n                            .add(ray.dir.scale(10 * Physics.surfaceEpsilon)); // needed to push the shape slightly into contact\r\n                        collider.update(body.transform);\r\n                        if (stats) {\r\n                            stats.physics.fastBodyCollisions++;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        // return cache\r\n        return this._collisionPairCache;\r\n    }\r\n    /**\r\n     * Applies narrow phase on collision pairs to find actual area intersections\r\n     * Adds actual colliding pairs to stats' Frame data\r\n     */\r\n    narrowphase(pairs, stats) {\r\n        let contacts = [];\r\n        for (let i = 0; i < pairs.length; i++) {\r\n            const newContacts = pairs[i].collide();\r\n            contacts = contacts.concat(newContacts);\r\n            if (stats && newContacts.length > 0) {\r\n                for (const c of newContacts) {\r\n                    stats.physics.contacts.set(c.id, c);\r\n                }\r\n            }\r\n        }\r\n        if (stats) {\r\n            stats.physics.collisions += contacts.length;\r\n        }\r\n        return contacts;\r\n    }\r\n    /**\r\n     * Update the dynamic tree positions\r\n     */\r\n    update(targets) {\r\n        let updated = 0;\r\n        const len = targets.length;\r\n        for (let i = 0; i < len; i++) {\r\n            if (this._dynamicCollisionTree.updateCollider(targets[i])) {\r\n                updated++;\r\n            }\r\n        }\r\n        return updated;\r\n    }\r\n    debug(ex) {\r\n        this._dynamicCollisionTree.debug(ex);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/Collider.ts\n\r\n\r\n/**\r\n * A collision collider specifies the geometry that can detect when other collision colliders intersect\r\n * for the purposes of colliding 2 objects in excalibur.\r\n */\r\nclass Collider {\r\n    constructor() {\r\n        this.id = createId('collider', Collider._ID++);\r\n        this.events = new EventDispatcher();\r\n    }\r\n    /**\r\n     * Returns a boolean indicating whether this body collided with\r\n     * or was in stationary contact with\r\n     * the body of the other [[Collider]]\r\n     */\r\n    touching(other) {\r\n        const contact = this.collide(other);\r\n        if (contact) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n}\r\nCollider._ID = 0;\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/CompositeCollider.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass CompositeCollider extends Collider {\r\n    constructor(colliders) {\r\n        super();\r\n        this._collisionProcessor = new DynamicTreeCollisionProcessor();\r\n        this._dynamicAABBTree = new DynamicTree();\r\n        this._colliders = [];\r\n        for (const c of colliders) {\r\n            this.addCollider(c);\r\n        }\r\n    }\r\n    clearColliders() {\r\n        this._colliders = [];\r\n    }\r\n    addCollider(collider) {\r\n        this.events.wire(collider.events);\r\n        this._colliders.push(collider);\r\n        this._collisionProcessor.track(collider);\r\n        this._dynamicAABBTree.trackCollider(collider);\r\n    }\r\n    removeCollider(collider) {\r\n        this.events.unwire(collider.events);\r\n        removeItemFromArray(collider, this._colliders);\r\n        this._collisionProcessor.untrack(collider);\r\n        this._dynamicAABBTree.untrackCollider(collider);\r\n    }\r\n    getColliders() {\r\n        return this._colliders;\r\n    }\r\n    get worldPos() {\r\n        var _a, _b;\r\n        // TODO transform component world pos\r\n        return (_b = (_a = this._transform) === null || _a === void 0 ? void 0 : _a.pos) !== null && _b !== void 0 ? _b : Vector.Zero;\r\n    }\r\n    get center() {\r\n        var _a, _b;\r\n        return (_b = (_a = this._transform) === null || _a === void 0 ? void 0 : _a.pos) !== null && _b !== void 0 ? _b : Vector.Zero;\r\n    }\r\n    get bounds() {\r\n        var _a, _b;\r\n        // TODO cache this\r\n        const colliders = this.getColliders();\r\n        const results = colliders.reduce((acc, collider) => acc.combine(collider.bounds), (_b = (_a = colliders[0]) === null || _a === void 0 ? void 0 : _a.bounds) !== null && _b !== void 0 ? _b : new BoundingBox().translate(this.worldPos));\r\n        return results;\r\n    }\r\n    get localBounds() {\r\n        var _a, _b;\r\n        // TODO cache this\r\n        const colliders = this.getColliders();\r\n        const results = colliders.reduce((acc, collider) => acc.combine(collider.localBounds), (_b = (_a = colliders[0]) === null || _a === void 0 ? void 0 : _a.localBounds) !== null && _b !== void 0 ? _b : new BoundingBox());\r\n        return results;\r\n    }\r\n    get axes() {\r\n        // TODO cache this\r\n        const colliders = this.getColliders();\r\n        let axes = [];\r\n        for (const collider of colliders) {\r\n            axes = axes.concat(collider.axes);\r\n        }\r\n        return axes;\r\n    }\r\n    getFurthestPoint(direction) {\r\n        const colliders = this.getColliders();\r\n        const furthestPoints = [];\r\n        for (const collider of colliders) {\r\n            furthestPoints.push(collider.getFurthestPoint(direction));\r\n        }\r\n        // Pick best point from all colliders\r\n        let bestPoint = furthestPoints[0];\r\n        let maxDistance = -Number.MAX_VALUE;\r\n        for (const point of furthestPoints) {\r\n            const distance = point.dot(direction);\r\n            if (distance > maxDistance) {\r\n                bestPoint = point;\r\n                maxDistance = distance;\r\n            }\r\n        }\r\n        return bestPoint;\r\n    }\r\n    getInertia(mass) {\r\n        const colliders = this.getColliders();\r\n        let totalInertia = 0;\r\n        for (const collider of colliders) {\r\n            totalInertia += collider.getInertia(mass);\r\n        }\r\n        return totalInertia;\r\n    }\r\n    collide(other) {\r\n        let otherColliders = [other];\r\n        if (other instanceof CompositeCollider) {\r\n            otherColliders = other.getColliders();\r\n        }\r\n        const pairs = [];\r\n        for (const c of otherColliders) {\r\n            this._dynamicAABBTree.query(c, (potentialCollider) => {\r\n                pairs.push(new Pair(c, potentialCollider));\r\n                return false;\r\n            });\r\n        }\r\n        let contacts = [];\r\n        for (const p of pairs) {\r\n            contacts = contacts.concat(p.collide());\r\n        }\r\n        return contacts;\r\n    }\r\n    getClosestLineBetween(other) {\r\n        const colliders = this.getColliders();\r\n        const lines = [];\r\n        if (other instanceof CompositeCollider) {\r\n            const otherColliders = other.getColliders();\r\n            for (const colliderA of colliders) {\r\n                for (const colliderB of otherColliders) {\r\n                    const maybeLine = colliderA.getClosestLineBetween(colliderB);\r\n                    if (maybeLine) {\r\n                        lines.push(maybeLine);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            for (const collider of colliders) {\r\n                const maybeLine = other.getClosestLineBetween(collider);\r\n                if (maybeLine) {\r\n                    lines.push(maybeLine);\r\n                }\r\n            }\r\n        }\r\n        if (lines.length) {\r\n            let minLength = lines[0].getLength();\r\n            let minLine = lines[0];\r\n            for (const line of lines) {\r\n                const length = line.getLength();\r\n                if (length < minLength) {\r\n                    minLength = length;\r\n                    minLine = line;\r\n                }\r\n            }\r\n            return minLine;\r\n        }\r\n        return null;\r\n    }\r\n    contains(point) {\r\n        const colliders = this.getColliders();\r\n        for (const collider of colliders) {\r\n            if (collider.contains(point)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    rayCast(ray, max) {\r\n        const colliders = this.getColliders();\r\n        const points = [];\r\n        for (const collider of colliders) {\r\n            const vec = collider.rayCast(ray, max);\r\n            if (vec) {\r\n                points.push(vec);\r\n            }\r\n        }\r\n        if (points.length) {\r\n            let minPoint = points[0];\r\n            let minDistance = minPoint.dot(ray.dir);\r\n            for (const point of points) {\r\n                const distance = ray.dir.dot(point);\r\n                if (distance < minDistance) {\r\n                    minPoint = point;\r\n                    minDistance = distance;\r\n                }\r\n            }\r\n            return minPoint;\r\n        }\r\n        return null;\r\n    }\r\n    project(axis) {\r\n        const colliders = this.getColliders();\r\n        const projs = [];\r\n        for (const collider of colliders) {\r\n            const proj = collider.project(axis);\r\n            if (proj) {\r\n                projs.push(proj);\r\n            }\r\n        }\r\n        // Merge all proj's on the same axis\r\n        if (projs.length) {\r\n            const newProjection = new Projection(projs[0].min, projs[0].max);\r\n            for (const proj of projs) {\r\n                newProjection.min = Math.min(proj.min, newProjection.min);\r\n                newProjection.max = Math.max(proj.max, newProjection.max);\r\n            }\r\n            return newProjection;\r\n        }\r\n        return null;\r\n    }\r\n    update(transform) {\r\n        if (transform) {\r\n            const colliders = this.getColliders();\r\n            for (const collider of colliders) {\r\n                collider.owner = this.owner;\r\n                collider.update(transform);\r\n            }\r\n        }\r\n    }\r\n    draw(ctx, color, pos) {\r\n        const colliders = this.getColliders();\r\n        for (const collider of colliders) {\r\n            collider.draw(ctx, color, pos);\r\n        }\r\n    }\r\n    debug(ex, color) {\r\n        const colliders = this.getColliders();\r\n        for (const collider of colliders) {\r\n            collider.debug(ex, color);\r\n        }\r\n    }\r\n    debugDraw(ctx, color) {\r\n        const colliders = this.getColliders();\r\n        for (const collider of colliders) {\r\n            collider.draw(ctx, color);\r\n        }\r\n    }\r\n    clone() {\r\n        return new CompositeCollider(this._colliders.map((c) => c.clone()));\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/line.ts\n\r\n/**\r\n * A 2D line segment\r\n */\r\nclass Line {\r\n    /**\r\n     * @param begin  The starting point of the line segment\r\n     * @param end  The ending point of the line segment\r\n     */\r\n    constructor(begin, end) {\r\n        this.begin = begin;\r\n        this.end = end;\r\n    }\r\n    /**\r\n     * Gets the raw slope (m) of the line. Will return (+/-)Infinity for vertical lines.\r\n     */\r\n    get slope() {\r\n        return (this.end.y - this.begin.y) / (this.end.x - this.begin.x);\r\n    }\r\n    /**\r\n     * Gets the Y-intercept (b) of the line. Will return (+/-)Infinity if there is no intercept.\r\n     */\r\n    get intercept() {\r\n        return this.begin.y - this.slope * this.begin.x;\r\n    }\r\n    /**\r\n     * Gets the normal of the line\r\n     */\r\n    normal() {\r\n        return this.end.sub(this.begin).normal();\r\n    }\r\n    dir() {\r\n        return this.end.sub(this.begin);\r\n    }\r\n    getPoints() {\r\n        return [this.begin, this.end];\r\n    }\r\n    /**\r\n     * Returns the slope of the line in the form of a vector of length 1\r\n     */\r\n    getSlope() {\r\n        const begin = this.begin;\r\n        const end = this.end;\r\n        const distance = begin.distance(end);\r\n        return end.sub(begin).scale(1 / distance);\r\n    }\r\n    /**\r\n     * Returns the edge of the line as vector, the length of the vector is the length of the edge\r\n     */\r\n    getEdge() {\r\n        const begin = this.begin;\r\n        const end = this.end;\r\n        return end.sub(begin);\r\n    }\r\n    /**\r\n     * Returns the length of the line segment in pixels\r\n     */\r\n    getLength() {\r\n        const begin = this.begin;\r\n        const end = this.end;\r\n        const distance = begin.distance(end);\r\n        return distance;\r\n    }\r\n    /**\r\n     * Returns the midpoint of the edge\r\n     */\r\n    get midpoint() {\r\n        return this.begin.add(this.end).scale(0.5);\r\n    }\r\n    /**\r\n     * Flips the direction of the line segment\r\n     */\r\n    flip() {\r\n        return new Line(this.end, this.begin);\r\n    }\r\n    /**\r\n     * Tests if a given point is below the line, points in the normal direction above the line are considered above.\r\n     * @param point\r\n     */\r\n    below(point) {\r\n        const above2 = (this.end.x - this.begin.x) * (point.y - this.begin.y) - (this.end.y - this.begin.y) * (point.x - this.begin.x);\r\n        return above2 >= 0;\r\n    }\r\n    /**\r\n     * Returns the clip point\r\n     * @param sideVector Vector that traces the line\r\n     * @param length Length to clip along side\r\n     */\r\n    clip(sideVector, length) {\r\n        let dir = sideVector;\r\n        dir = dir.normalize();\r\n        const near = dir.dot(this.begin) - length;\r\n        const far = dir.dot(this.end) - length;\r\n        const results = [];\r\n        if (near <= 0) {\r\n            results.push(this.begin);\r\n        }\r\n        if (far <= 0) {\r\n            results.push(this.end);\r\n        }\r\n        if (near * far < 0) {\r\n            const clipTime = near / (near - far);\r\n            results.push(this.begin.add(this.end.sub(this.begin).scale(clipTime)));\r\n        }\r\n        if (results.length !== 2) {\r\n            return null;\r\n        }\r\n        return new Line(results[0], results[1]);\r\n    }\r\n    /**\r\n     * Find the perpendicular distance from the line to a point\r\n     * https://en.wikipedia.org/wiki/Distance_from_a_point_to_a_line\r\n     * @param point\r\n     */\r\n    distanceToPoint(point, signed = false) {\r\n        const x0 = point.x;\r\n        const y0 = point.y;\r\n        const l = this.getLength();\r\n        const dy = this.end.y - this.begin.y;\r\n        const dx = this.end.x - this.begin.x;\r\n        const distance = (dy * x0 - dx * y0 + this.end.x * this.begin.y - this.end.y * this.begin.x) / l;\r\n        return signed ? distance : Math.abs(distance);\r\n    }\r\n    /**\r\n     * Find the perpendicular line from the line to a point\r\n     * https://en.wikipedia.org/wiki/Distance_from_a_point_to_a_line\r\n     * (a - p) - ((a - p) * n)n\r\n     * a is a point on the line\r\n     * p is the arbitrary point above the line\r\n     * n is a unit vector in direction of the line\r\n     * @param point\r\n     */\r\n    findVectorToPoint(point) {\r\n        const aMinusP = this.begin.sub(point);\r\n        const n = this.getSlope();\r\n        return aMinusP.sub(n.scale(aMinusP.dot(n)));\r\n    }\r\n    /**\r\n     * Finds a point on the line given only an X or a Y value. Given an X value, the function returns\r\n     * a new point with the calculated Y value and vice-versa.\r\n     *\r\n     * @param x The known X value of the target point\r\n     * @param y The known Y value of the target point\r\n     * @returns A new point with the other calculated axis value\r\n     */\r\n    findPoint(x = null, y = null) {\r\n        const m = this.slope;\r\n        const b = this.intercept;\r\n        if (x !== null) {\r\n            return new Vector(x, m * x + b);\r\n        }\r\n        else if (y !== null) {\r\n            return new Vector((y - b) / m, y);\r\n        }\r\n        else {\r\n            throw new Error('You must provide an X or a Y value');\r\n        }\r\n    }\r\n    /**\r\n     * @see http://stackoverflow.com/a/11908158/109458\r\n     */\r\n    hasPoint() {\r\n        let currPoint;\r\n        let threshold = 0;\r\n        if (typeof arguments[0] === 'number' && typeof arguments[1] === 'number') {\r\n            currPoint = new Vector(arguments[0], arguments[1]);\r\n            threshold = arguments[2] || 0;\r\n        }\r\n        else if (arguments[0] instanceof Vector) {\r\n            currPoint = arguments[0];\r\n            threshold = arguments[1] || 0;\r\n        }\r\n        else {\r\n            throw 'Could not determine the arguments for Vector.hasPoint';\r\n        }\r\n        const dxc = currPoint.x - this.begin.x;\r\n        const dyc = currPoint.y - this.begin.y;\r\n        const dx1 = this.end.x - this.begin.x;\r\n        const dy1 = this.end.y - this.begin.y;\r\n        const cross = dxc * dy1 - dyc * dx1;\r\n        // check whether point lines on the line\r\n        if (Math.abs(cross) > threshold) {\r\n            return false;\r\n        }\r\n        // check whether point lies in-between start and end\r\n        if (Math.abs(dx1) >= Math.abs(dy1)) {\r\n            return dx1 > 0 ? this.begin.x <= currPoint.x && currPoint.x <= this.end.x : this.end.x <= currPoint.x && currPoint.x <= this.begin.x;\r\n        }\r\n        else {\r\n            return dy1 > 0 ? this.begin.y <= currPoint.y && currPoint.y <= this.end.y : this.end.y <= currPoint.y && currPoint.y <= this.begin.y;\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/ClosestLineJumpTable.ts\n\r\n\r\n\r\n/**\r\n * Finds the closes line between 2 line segments, were the magnitude of u, v are the lengths of each segment\r\n * L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\r\n * L2 = Q(t) = q0 + t * v, where t is time and q0 is the start of the line\r\n * @param p0 Point where L1 begins\r\n * @param u Direction and length of L1\r\n * @param q0 Point were L2 begins\r\n * @param v Direction and length of L2\r\n */\r\nfunction ClosestLine(p0, u, q0, v) {\r\n    // Distance between 2 lines http://geomalgorithms.com/a07-_distance.html\r\n    // w(s, t) = P(s) - Q(t)\r\n    // The w(s, t) that has the minimum distance we will say is w(sClosest, tClosest) = wClosest\r\n    //\r\n    // wClosest is the vector that is uniquely perpendicular to the 2 line directions u & v.\r\n    // wClosest = w0 + sClosest * u - tClosest * v, where w0 is p0 - q0\r\n    //\r\n    // The closest point between 2 lines then satisfies this pair of equations\r\n    // 1: u * wClosest = 0\r\n    // 2: v * wClosest = 0\r\n    //\r\n    // Substituting wClosest into the equations we get\r\n    //\r\n    // 1: (u * u) * sClosest - (u * v) tClosest = -u * w0\r\n    // 2: (v * u) * sClosest - (v * v) tClosest = -v * w0\r\n    // simplify w0\r\n    const w0 = p0.sub(q0);\r\n    // simplify (u * u);\r\n    const a = u.dot(u);\r\n    // simplify (u * v);\r\n    const b = u.dot(v);\r\n    // simplify (v * v)\r\n    const c = v.dot(v);\r\n    // simplify (u * w0)\r\n    const d = u.dot(w0);\r\n    // simplify (v * w0)\r\n    const e = v.dot(w0);\r\n    // denominator ac - b^2\r\n    const denom = a * c - b * b;\r\n    let sDenom = denom;\r\n    let tDenom = denom;\r\n    // if denom is 0 they are parallel, use any point from either as the start in this case p0\r\n    if (denom === 0 || denom <= 0.01) {\r\n        const tClosestParallel = d / b;\r\n        return new Line(p0, q0.add(v.scale(tClosestParallel)));\r\n    }\r\n    // Solve for sClosest for infinite line\r\n    let sClosest = b * e - c * d; // / denom;\r\n    // Solve for tClosest for infinite line\r\n    let tClosest = a * e - b * d; // / denom;\r\n    // Solve for segments candidate edges, if sClosest and tClosest are outside their segments\r\n    if (sClosest < 0) {\r\n        sClosest = 0;\r\n        tClosest = e;\r\n        tDenom = c;\r\n    }\r\n    else if (sClosest > sDenom) {\r\n        sClosest = sDenom;\r\n        tClosest = e + b;\r\n        tDenom = c;\r\n    }\r\n    if (tClosest < 0) {\r\n        tClosest = 0;\r\n        if (-d < 0) {\r\n            sClosest = 0;\r\n        }\r\n        else if (-d > a) {\r\n            sClosest = sDenom;\r\n        }\r\n        else {\r\n            sClosest = -d;\r\n            sDenom = a;\r\n        }\r\n    }\r\n    else if (tClosest > tDenom) {\r\n        tClosest = tDenom;\r\n        if (-d + b < 0) {\r\n            sClosest = 0;\r\n        }\r\n        else if (-d + b > a) {\r\n            sClosest = sDenom;\r\n        }\r\n        else {\r\n            sClosest = -d + b;\r\n            sDenom = a;\r\n        }\r\n    }\r\n    sClosest = Math.abs(sClosest) < 0.001 ? 0 : sClosest / sDenom;\r\n    tClosest = Math.abs(tClosest) < 0.001 ? 0 : tClosest / tDenom;\r\n    return new Line(p0.add(u.scale(sClosest)), q0.add(v.scale(tClosest)));\r\n}\r\nconst ClosestLineJumpTable = {\r\n    PolygonPolygonClosestLine(polygonA, polygonB) {\r\n        // Find the 2 closest faces on each polygon\r\n        const otherWorldPos = polygonB.worldPos;\r\n        const otherDirection = otherWorldPos.sub(polygonA.worldPos);\r\n        const thisDirection = otherDirection.negate();\r\n        const rayTowardsOther = new Ray(polygonA.worldPos, otherDirection);\r\n        const rayTowardsThis = new Ray(otherWorldPos, thisDirection);\r\n        const thisPoint = polygonA.rayCast(rayTowardsOther).add(rayTowardsOther.dir.scale(0.1));\r\n        const otherPoint = polygonB.rayCast(rayTowardsThis).add(rayTowardsThis.dir.scale(0.1));\r\n        const thisFace = polygonA.getClosestFace(thisPoint);\r\n        const otherFace = polygonB.getClosestFace(otherPoint);\r\n        // L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\r\n        const p0 = thisFace.face.begin;\r\n        const u = thisFace.face.getEdge();\r\n        // L2 = Q(t) = q0 + t * v, where t is time and q0 is the start of the line\r\n        const q0 = otherFace.face.begin;\r\n        const v = otherFace.face.getEdge();\r\n        return ClosestLine(p0, u, q0, v);\r\n    },\r\n    PolygonEdgeClosestLine(polygon, edge) {\r\n        // Find the 2 closest faces on each polygon\r\n        const otherWorldPos = edge.worldPos;\r\n        const otherDirection = otherWorldPos.sub(polygon.worldPos);\r\n        const rayTowardsOther = new Ray(polygon.worldPos, otherDirection);\r\n        const thisPoint = polygon.rayCast(rayTowardsOther).add(rayTowardsOther.dir.scale(0.1));\r\n        const thisFace = polygon.getClosestFace(thisPoint);\r\n        // L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\r\n        const p0 = thisFace.face.begin;\r\n        const u = thisFace.face.getEdge();\r\n        // L2 = Q(t) = q0 + t * v, where t is time and q0 is the start of the line\r\n        const edgeLine = edge.asLine();\r\n        const edgeStart = edgeLine.begin;\r\n        const edgeVector = edgeLine.getEdge();\r\n        const q0 = edgeStart;\r\n        const v = edgeVector;\r\n        return ClosestLine(p0, u, q0, v);\r\n    },\r\n    PolygonCircleClosestLine(polygon, circle) {\r\n        // https://math.stackexchange.com/questions/1919177/how-to-find-point-on-line-closest-to-sphere\r\n        // Find the 2 closest faces on each polygon\r\n        const otherWorldPos = circle.worldPos;\r\n        const otherDirection = otherWorldPos.sub(polygon.worldPos);\r\n        const rayTowardsOther = new Ray(polygon.worldPos, otherDirection.normalize());\r\n        const thisPoint = polygon.rayCast(rayTowardsOther).add(rayTowardsOther.dir.scale(0.1));\r\n        const thisFace = polygon.getClosestFace(thisPoint);\r\n        // L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\r\n        const p0 = thisFace.face.begin;\r\n        const u = thisFace.face.getEdge();\r\n        // Time of minimum distance\r\n        let t = (u.x * (otherWorldPos.x - p0.x) + u.y * (otherWorldPos.y - p0.y)) / (u.x * u.x + u.y * u.y);\r\n        // If time of minimum is past the edge clamp\r\n        if (t > 1) {\r\n            t = 1;\r\n        }\r\n        else if (t < 0) {\r\n            t = 0;\r\n        }\r\n        // Minimum distance\r\n        const d = Math.sqrt(Math.pow(p0.x + u.x * t - otherWorldPos.x, 2) + Math.pow(p0.y + u.y * t - otherWorldPos.y, 2)) - circle.radius;\r\n        const circlex = ((p0.x + u.x * t - otherWorldPos.x) * circle.radius) / (circle.radius + d);\r\n        const circley = ((p0.y + u.y * t - otherWorldPos.y) * circle.radius) / (circle.radius + d);\r\n        return new Line(u.scale(t).add(p0), new Vector(otherWorldPos.x + circlex, otherWorldPos.y + circley));\r\n    },\r\n    CircleCircleClosestLine(circleA, circleB) {\r\n        // Find the 2 closest faces on each polygon\r\n        const otherWorldPos = circleB.worldPos;\r\n        const otherDirection = otherWorldPos.sub(circleA.worldPos);\r\n        const thisWorldPos = circleA.worldPos;\r\n        const thisDirection = thisWorldPos.sub(circleB.worldPos);\r\n        const rayTowardsOther = new Ray(circleA.worldPos, otherDirection);\r\n        const rayTowardsThis = new Ray(circleB.worldPos, thisDirection);\r\n        const thisPoint = circleA.rayCast(rayTowardsOther);\r\n        const otherPoint = circleB.rayCast(rayTowardsThis);\r\n        return new Line(thisPoint, otherPoint);\r\n    },\r\n    CircleEdgeClosestLine(circle, edge) {\r\n        // https://math.stackexchange.com/questions/1919177/how-to-find-point-on-line-closest-to-sphere\r\n        const circleWorlPos = circle.worldPos;\r\n        // L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\r\n        const edgeLine = edge.asLine();\r\n        const edgeStart = edgeLine.begin;\r\n        const edgeVector = edgeLine.getEdge();\r\n        const p0 = edgeStart;\r\n        const u = edgeVector;\r\n        // Time of minimum distance\r\n        let t = (u.x * (circleWorlPos.x - p0.x) + u.y * (circleWorlPos.y - p0.y)) / (u.x * u.x + u.y * u.y);\r\n        // If time of minimum is past the edge clamp to edge\r\n        if (t > 1) {\r\n            t = 1;\r\n        }\r\n        else if (t < 0) {\r\n            t = 0;\r\n        }\r\n        // Minimum distance\r\n        const d = Math.sqrt(Math.pow(p0.x + u.x * t - circleWorlPos.x, 2) + Math.pow(p0.y + u.y * t - circleWorlPos.y, 2)) - circle.radius;\r\n        const circlex = ((p0.x + u.x * t - circleWorlPos.x) * circle.radius) / (circle.radius + d);\r\n        const circley = ((p0.y + u.y * t - circleWorlPos.y) * circle.radius) / (circle.radius + d);\r\n        return new Line(u.scale(t).add(p0), new Vector(circleWorlPos.x + circlex, circleWorlPos.y + circley));\r\n    },\r\n    EdgeEdgeClosestLine(edgeA, edgeB) {\r\n        // L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\r\n        const edgeLineA = edgeA.asLine();\r\n        const edgeStartA = edgeLineA.begin;\r\n        const edgeVectorA = edgeLineA.getEdge();\r\n        const p0 = edgeStartA;\r\n        const u = edgeVectorA;\r\n        // L2 = Q(t) = q0 + t * v, where t is time and q0 is the start of the line\r\n        const edgeLineB = edgeB.asLine();\r\n        const edgeStartB = edgeLineB.begin;\r\n        const edgeVectorB = edgeLineB.getEdge();\r\n        const q0 = edgeStartB;\r\n        const v = edgeVectorB;\r\n        return ClosestLine(p0, u, q0, v);\r\n    }\r\n};\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/CircleCollider.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * This is a circle collider for the excalibur rigid body physics simulation\r\n */\r\nclass CircleCollider extends Collider {\r\n    constructor(options) {\r\n        super();\r\n        /**\r\n         * Position of the circle relative to the collider, by default (0, 0).\r\n         */\r\n        this.offset = Vector.Zero;\r\n        this.offset = options.offset || Vector.Zero;\r\n        this.radius = options.radius || 0;\r\n    }\r\n    get worldPos() {\r\n        var _a, _b, _c, _d;\r\n        const tx = this._transform;\r\n        const scale = (_a = tx === null || tx === void 0 ? void 0 : tx.globalScale) !== null && _a !== void 0 ? _a : Vector.One;\r\n        const rotation = (_b = tx === null || tx === void 0 ? void 0 : tx.globalRotation) !== null && _b !== void 0 ? _b : 0;\r\n        const pos = ((_c = tx === null || tx === void 0 ? void 0 : tx.globalPos) !== null && _c !== void 0 ? _c : Vector.Zero);\r\n        return ((_d = this.offset) !== null && _d !== void 0 ? _d : Vector.Zero).scale(scale).rotate(rotation).add(pos);\r\n    }\r\n    /**\r\n     * Get the radius of the circle\r\n     */\r\n    get radius() {\r\n        var _a;\r\n        const tx = this._transform;\r\n        const scale = (_a = tx === null || tx === void 0 ? void 0 : tx.globalScale) !== null && _a !== void 0 ? _a : Vector.One;\r\n        // This is a trade off, the alternative is retooling circles to support ellipse collisions\r\n        return this._naturalRadius * Math.min(scale.x, scale.y);\r\n    }\r\n    /**\r\n     * Set the radius of the circle\r\n     */\r\n    set radius(val) {\r\n        var _a;\r\n        const tx = this._transform;\r\n        const scale = (_a = tx === null || tx === void 0 ? void 0 : tx.globalScale) !== null && _a !== void 0 ? _a : Vector.One;\r\n        // This is a trade off, the alternative is retooling circles to support ellipse collisions\r\n        this._naturalRadius = val / Math.min(scale.x, scale.y);\r\n    }\r\n    /**\r\n     * Returns a clone of this shape, not associated with any collider\r\n     */\r\n    clone() {\r\n        return new CircleCollider({\r\n            offset: this.offset.clone(),\r\n            radius: this.radius\r\n        });\r\n    }\r\n    /**\r\n     * Get the center of the collider in world coordinates\r\n     */\r\n    get center() {\r\n        var _a, _b, _c, _d;\r\n        const tx = this._transform;\r\n        const scale = (_a = tx === null || tx === void 0 ? void 0 : tx.globalScale) !== null && _a !== void 0 ? _a : Vector.One;\r\n        const rotation = (_b = tx === null || tx === void 0 ? void 0 : tx.globalRotation) !== null && _b !== void 0 ? _b : 0;\r\n        const pos = ((_c = tx === null || tx === void 0 ? void 0 : tx.globalPos) !== null && _c !== void 0 ? _c : Vector.Zero);\r\n        return ((_d = this.offset) !== null && _d !== void 0 ? _d : Vector.Zero).scale(scale).rotate(rotation).add(pos);\r\n    }\r\n    /**\r\n     * Tests if a point is contained in this collider\r\n     */\r\n    contains(point) {\r\n        var _a, _b;\r\n        const pos = (_b = (_a = this._transform) === null || _a === void 0 ? void 0 : _a.pos) !== null && _b !== void 0 ? _b : this.offset;\r\n        const distance = pos.distance(point);\r\n        if (distance <= this.radius) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    /**\r\n     * Casts a ray at the Circle collider and returns the nearest point of collision\r\n     * @param ray\r\n     */\r\n    rayCast(ray, max = Infinity) {\r\n        //https://en.wikipedia.org/wiki/Line%E2%80%93sphere_intersection\r\n        const c = this.center;\r\n        const dir = ray.dir;\r\n        const orig = ray.pos;\r\n        const discriminant = Math.sqrt(Math.pow(dir.dot(orig.sub(c)), 2) - Math.pow(orig.sub(c).distance(), 2) + Math.pow(this.radius, 2));\r\n        if (discriminant < 0) {\r\n            // no intersection\r\n            return null;\r\n        }\r\n        else {\r\n            let toi = 0;\r\n            if (discriminant === 0) {\r\n                toi = -dir.dot(orig.sub(c));\r\n                if (toi > 0 && toi < max) {\r\n                    return ray.getPoint(toi);\r\n                }\r\n                return null;\r\n            }\r\n            else {\r\n                const toi1 = -dir.dot(orig.sub(c)) + discriminant;\r\n                const toi2 = -dir.dot(orig.sub(c)) - discriminant;\r\n                const positiveToi = [];\r\n                if (toi1 >= 0) {\r\n                    positiveToi.push(toi1);\r\n                }\r\n                if (toi2 >= 0) {\r\n                    positiveToi.push(toi2);\r\n                }\r\n                const mintoi = Math.min(...positiveToi);\r\n                if (mintoi <= max) {\r\n                    return ray.getPoint(mintoi);\r\n                }\r\n                return null;\r\n            }\r\n        }\r\n    }\r\n    getClosestLineBetween(shape) {\r\n        if (shape instanceof CircleCollider) {\r\n            return ClosestLineJumpTable.CircleCircleClosestLine(this, shape);\r\n        }\r\n        else if (shape instanceof PolygonCollider) {\r\n            return ClosestLineJumpTable.PolygonCircleClosestLine(shape, this).flip();\r\n        }\r\n        else if (shape instanceof EdgeCollider) {\r\n            return ClosestLineJumpTable.CircleEdgeClosestLine(this, shape).flip();\r\n        }\r\n        else {\r\n            throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof shape}`);\r\n        }\r\n    }\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    collide(collider) {\r\n        if (collider instanceof CircleCollider) {\r\n            return CollisionJumpTable.CollideCircleCircle(this, collider);\r\n        }\r\n        else if (collider instanceof PolygonCollider) {\r\n            return CollisionJumpTable.CollideCirclePolygon(this, collider);\r\n        }\r\n        else if (collider instanceof EdgeCollider) {\r\n            return CollisionJumpTable.CollideCircleEdge(this, collider);\r\n        }\r\n        else {\r\n            throw new Error(`Circle could not collide with unknown CollisionShape ${typeof collider}`);\r\n        }\r\n    }\r\n    /**\r\n     * Find the point on the collider furthest in the direction specified\r\n     */\r\n    getFurthestPoint(direction) {\r\n        return this.center.add(direction.normalize().scale(this.radius));\r\n    }\r\n    /**\r\n     * Find the local point on the shape in the direction specified\r\n     * @param direction\r\n     */\r\n    getFurthestLocalPoint(direction) {\r\n        const dir = direction.normalize();\r\n        return dir.scale(this.radius);\r\n    }\r\n    /**\r\n     * Get the axis aligned bounding box for the circle collider in world coordinates\r\n     */\r\n    get bounds() {\r\n        var _a, _b, _c;\r\n        const tx = this._transform;\r\n        const scale = (_a = tx === null || tx === void 0 ? void 0 : tx.globalScale) !== null && _a !== void 0 ? _a : Vector.One;\r\n        const rotation = (_b = tx === null || tx === void 0 ? void 0 : tx.globalRotation) !== null && _b !== void 0 ? _b : 0;\r\n        const pos = ((_c = tx === null || tx === void 0 ? void 0 : tx.globalPos) !== null && _c !== void 0 ? _c : Vector.Zero);\r\n        return new BoundingBox(this.offset.x - this._naturalRadius, this.offset.y - this._naturalRadius, this.offset.x + this._naturalRadius, this.offset.y + this._naturalRadius).rotate(rotation).scale(scale).translate(pos);\r\n    }\r\n    /**\r\n     * Get the axis aligned bounding box for the circle collider in local coordinates\r\n     */\r\n    get localBounds() {\r\n        return new BoundingBox(this.offset.x - this._naturalRadius, this.offset.y - this._naturalRadius, this.offset.x + this._naturalRadius, this.offset.y + this._naturalRadius);\r\n    }\r\n    /**\r\n     * Get axis not implemented on circles, since there are infinite axis in a circle\r\n     */\r\n    get axes() {\r\n        return [];\r\n    }\r\n    /**\r\n     * Returns the moment of inertia of a circle given it's mass\r\n     * https://en.wikipedia.org/wiki/List_of_moments_of_inertia\r\n     */\r\n    getInertia(mass) {\r\n        return (mass * this.radius * this.radius) / 2;\r\n    }\r\n    /* istanbul ignore next */\r\n    update(transform) {\r\n        this._transform = transform;\r\n    }\r\n    /**\r\n     * Project the circle along a specified axis\r\n     */\r\n    project(axis) {\r\n        const scalars = [];\r\n        const point = this.center;\r\n        const dotProduct = point.dot(axis);\r\n        scalars.push(dotProduct);\r\n        scalars.push(dotProduct + this.radius);\r\n        scalars.push(dotProduct - this.radius);\r\n        return new Projection(Math.min.apply(Math, scalars), Math.max.apply(Math, scalars));\r\n    }\r\n    /**\r\n     * @deprecated signature will change in v0.26.0\r\n     * @param ctx\r\n     * @param color\r\n     * @param pos\r\n     */\r\n    draw(ctx, color = Color.Green, pos = Vector.Zero) {\r\n        const newPos = pos.add(this.offset);\r\n        ctx.beginPath();\r\n        ctx.fillStyle = color.toString();\r\n        ctx.arc(newPos.x, newPos.y, this.radius, 0, Math.PI * 2);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n    }\r\n    debug(ex, color) {\r\n        var _a, _b, _c, _d;\r\n        const tx = this._transform;\r\n        const scale = (_a = tx === null || tx === void 0 ? void 0 : tx.globalScale) !== null && _a !== void 0 ? _a : Vector.One;\r\n        const rotation = (_b = tx === null || tx === void 0 ? void 0 : tx.globalRotation) !== null && _b !== void 0 ? _b : 0;\r\n        const pos = ((_c = tx === null || tx === void 0 ? void 0 : tx.globalPos) !== null && _c !== void 0 ? _c : Vector.Zero);\r\n        ex.save();\r\n        ex.translate(pos.x, pos.y);\r\n        ex.rotate(rotation);\r\n        ex.scale(scale.x, scale.y);\r\n        ex.drawCircle(((_d = this.offset) !== null && _d !== void 0 ? _d : Vector.Zero), this._naturalRadius, Color.Transparent, color, 2);\r\n        ex.restore();\r\n    }\r\n    /**\r\n     * @deprecated signature will change in v0.26.0\r\n     * @param ctx\r\n     * @param color\r\n     */\r\n    /* istanbul ignore next */\r\n    debugDraw(ctx, color = Color.Green) {\r\n        const transform = this._transform;\r\n        const pos = transform ? transform.pos.add(this.offset) : this.offset;\r\n        const rotation = transform ? transform.rotation : 0;\r\n        ctx.beginPath();\r\n        ctx.strokeStyle = color.toString();\r\n        ctx.arc(pos.x, pos.y, this.radius, 0, Math.PI * 2);\r\n        ctx.closePath();\r\n        ctx.stroke();\r\n        ctx.beginPath();\r\n        ctx.moveTo(pos.x, pos.y);\r\n        ctx.lineTo(Math.cos(rotation) * this.radius + pos.x, Math.sin(rotation) * this.radius + pos.y);\r\n        ctx.closePath();\r\n        ctx.stroke();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Detection/CollisionContact.ts\n\r\n\r\n\r\n\r\n/**\r\n * Collision contacts are used internally by Excalibur to resolve collision between colliders. This\r\n * Pair prevents collisions from being evaluated more than one time\r\n */\r\nclass CollisionContact {\r\n    constructor(colliderA, colliderB, mtv, normal, tangent, points, localPoints, info) {\r\n        this._canceled = false;\r\n        this.colliderA = colliderA;\r\n        this.colliderB = colliderB;\r\n        this.mtv = mtv;\r\n        this.normal = normal;\r\n        this.tangent = tangent;\r\n        this.points = points;\r\n        this.localPoints = localPoints;\r\n        this.info = info;\r\n        this.id = Pair.calculatePairHash(colliderA.id, colliderB.id);\r\n    }\r\n    /**\r\n     * Match contact awake state, except if body's are Fixed\r\n     */\r\n    matchAwake() {\r\n        const bodyA = this.colliderA.owner.get(BodyComponent);\r\n        const bodyB = this.colliderB.owner.get(BodyComponent);\r\n        if (bodyA && bodyB) {\r\n            if (bodyA.sleeping !== bodyB.sleeping) {\r\n                if (bodyA.sleeping && bodyA.collisionType !== CollisionType.Fixed && bodyB.sleepMotion >= Physics.wakeThreshold) {\r\n                    bodyA.setSleeping(false);\r\n                }\r\n                if (bodyB.sleeping && bodyB.collisionType !== CollisionType.Fixed && bodyA.sleepMotion >= Physics.wakeThreshold) {\r\n                    bodyB.setSleeping(false);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    isCanceled() {\r\n        return this._canceled;\r\n    }\r\n    cancel() {\r\n        this._canceled = true;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/SeparatingAxis.ts\nclass SeparatingAxis {\r\n    static findPolygonPolygonSeparation(polyA, polyB) {\r\n        let bestSeparation = -Number.MAX_VALUE;\r\n        let bestSide = null;\r\n        let bestAxis = null;\r\n        let bestSideIndex = -1;\r\n        let bestOtherPoint = null;\r\n        const sides = polyA.getSides();\r\n        const localSides = polyA.getLocalSides();\r\n        for (let i = 0; i < sides.length; i++) {\r\n            const side = sides[i];\r\n            const axis = side.normal();\r\n            const vertB = polyB.getFurthestPoint(axis.negate());\r\n            // Separation on side i's axis\r\n            // We are looking for the largest separation between poly A's sides\r\n            const vertSeparation = side.distanceToPoint(vertB, true);\r\n            if (vertSeparation > bestSeparation) {\r\n                bestSeparation = vertSeparation;\r\n                bestSide = side;\r\n                bestAxis = axis;\r\n                bestSideIndex = i;\r\n                bestOtherPoint = vertB;\r\n            }\r\n        }\r\n        return {\r\n            collider: polyA,\r\n            separation: bestAxis ? bestSeparation : 99,\r\n            axis: bestAxis,\r\n            side: bestSide,\r\n            localSide: localSides[bestSideIndex],\r\n            sideId: bestSideIndex,\r\n            point: bestOtherPoint,\r\n            localPoint: bestAxis ? polyB.getFurthestLocalPoint(bestAxis.negate()) : null\r\n        };\r\n    }\r\n    static findCirclePolygonSeparation(circle, polygon) {\r\n        const axes = polygon.axes;\r\n        const pc = polygon.center;\r\n        // Special SAT with circles\r\n        const polyDir = pc.sub(circle.worldPos);\r\n        const closestPointOnPoly = polygon.getFurthestPoint(polyDir.negate());\r\n        axes.push(closestPointOnPoly.sub(circle.worldPos).normalize());\r\n        let minOverlap = Number.MAX_VALUE;\r\n        let minAxis = null;\r\n        let minIndex = -1;\r\n        for (let i = 0; i < axes.length; i++) {\r\n            const proj1 = polygon.project(axes[i]);\r\n            const proj2 = circle.project(axes[i]);\r\n            const overlap = proj1.getOverlap(proj2);\r\n            if (overlap <= 0) {\r\n                return null;\r\n            }\r\n            else {\r\n                if (overlap < minOverlap) {\r\n                    minOverlap = overlap;\r\n                    minAxis = axes[i];\r\n                    minIndex = i;\r\n                }\r\n            }\r\n        }\r\n        if (minIndex < 0) {\r\n            return null;\r\n        }\r\n        return minAxis.normalize().scale(minOverlap);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/CollisionJumpTable.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst CollisionJumpTable = {\r\n    CollideCircleCircle(circleA, circleB) {\r\n        const circleAPos = circleA.worldPos;\r\n        const circleBPos = circleB.worldPos;\r\n        const combinedRadius = circleA.radius + circleB.radius;\r\n        const distance = circleAPos.distance(circleBPos);\r\n        if (distance > combinedRadius) {\r\n            return [];\r\n        }\r\n        // negative means overlap\r\n        const separation = combinedRadius - distance;\r\n        // Normal points from A -> B\r\n        const normal = circleBPos.sub(circleAPos).normalize();\r\n        const tangent = normal.perpendicular();\r\n        const mvt = normal.scale(separation);\r\n        const point = circleA.getFurthestPoint(normal);\r\n        const local = circleA.getFurthestLocalPoint(normal);\r\n        const info = {\r\n            collider: circleA,\r\n            separation,\r\n            axis: normal,\r\n            point: point\r\n        };\r\n        return [new CollisionContact(circleA, circleB, mvt, normal, tangent, [point], [local], info)];\r\n    },\r\n    CollideCirclePolygon(circle, polygon) {\r\n        var _a, _b;\r\n        let minAxis = SeparatingAxis.findCirclePolygonSeparation(circle, polygon);\r\n        if (!minAxis) {\r\n            return [];\r\n        }\r\n        // make sure that the minAxis is pointing away from circle\r\n        const samedir = minAxis.dot(polygon.center.sub(circle.center));\r\n        minAxis = samedir < 0 ? minAxis.negate() : minAxis;\r\n        const point = circle.getFurthestPoint(minAxis);\r\n        const xf = (_b = (_a = circle.owner) === null || _a === void 0 ? void 0 : _a.get(TransformComponent)) !== null && _b !== void 0 ? _b : new TransformComponent();\r\n        const local = xf.applyInverse(point);\r\n        const normal = minAxis.normalize();\r\n        const info = {\r\n            collider: circle,\r\n            separation: -minAxis.size,\r\n            axis: normal,\r\n            point: point,\r\n            localPoint: local,\r\n            side: polygon.findSide(normal.negate()),\r\n            localSide: polygon.findLocalSide(normal.negate())\r\n        };\r\n        return [new CollisionContact(circle, polygon, minAxis, normal, normal.perpendicular(), [point], [local], info)];\r\n    },\r\n    CollideCircleEdge(circle, edge) {\r\n        // TODO not sure this actually abides by local/world collisions\r\n        // Are edge.begin and edge.end local space or world space? I think they should be local\r\n        // center of the circle in world pos\r\n        const cc = circle.center;\r\n        // vector in the direction of the edge\r\n        const edgeWorld = edge.asLine();\r\n        const e = edgeWorld.end.sub(edgeWorld.begin);\r\n        // amount of overlap with the circle's center along the edge direction\r\n        const u = e.dot(edgeWorld.end.sub(cc));\r\n        const v = e.dot(cc.sub(edgeWorld.begin));\r\n        const side = edge.asLine();\r\n        const localSide = edge.asLocalLine();\r\n        // Potential region A collision (circle is on the left side of the edge, before the beginning)\r\n        if (v <= 0) {\r\n            const da = edgeWorld.begin.sub(cc);\r\n            const dda = da.dot(da); // quick and dirty way of calc'n distance in r^2 terms saves some sqrts\r\n            // save some sqrts\r\n            if (dda > circle.radius * circle.radius) {\r\n                return []; // no collision\r\n            }\r\n            const normal = da.normalize();\r\n            const separation = circle.radius - Math.sqrt(dda);\r\n            const info = {\r\n                collider: circle,\r\n                separation: separation,\r\n                axis: normal,\r\n                point: side.begin,\r\n                side: side,\r\n                localSide: localSide\r\n            };\r\n            return [\r\n                new CollisionContact(circle, edge, normal.scale(separation), normal, normal.perpendicular(), [side.begin], [localSide.begin], info)\r\n            ];\r\n        }\r\n        // Potential region B collision (circle is on the right side of the edge, after the end)\r\n        if (u <= 0) {\r\n            const db = edgeWorld.end.sub(cc);\r\n            const ddb = db.dot(db);\r\n            if (ddb > circle.radius * circle.radius) {\r\n                return [];\r\n            }\r\n            const normal = db.normalize();\r\n            const separation = circle.radius - Math.sqrt(ddb);\r\n            const info = {\r\n                collider: circle,\r\n                separation: separation,\r\n                axis: normal,\r\n                point: side.end,\r\n                side: side,\r\n                localSide: localSide\r\n            };\r\n            return [\r\n                new CollisionContact(circle, edge, normal.scale(separation), normal, normal.perpendicular(), [side.end], [localSide.end], info)\r\n            ];\r\n        }\r\n        // Otherwise potential region AB collision (circle is in the middle of the edge between the beginning and end)\r\n        const den = e.dot(e);\r\n        const pointOnEdge = edgeWorld.begin\r\n            .scale(u)\r\n            .add(edgeWorld.end.scale(v))\r\n            .scale(1 / den);\r\n        const d = cc.sub(pointOnEdge);\r\n        const dd = d.dot(d);\r\n        if (dd > circle.radius * circle.radius) {\r\n            return []; // no collision\r\n        }\r\n        let normal = e.perpendicular();\r\n        // flip correct direction\r\n        if (normal.dot(cc.sub(edgeWorld.begin)) < 0) {\r\n            normal.x = -normal.x;\r\n            normal.y = -normal.y;\r\n        }\r\n        normal = normal.normalize();\r\n        const separation = circle.radius - Math.sqrt(dd);\r\n        const mvt = normal.scale(separation);\r\n        const info = {\r\n            collider: circle,\r\n            separation: separation,\r\n            axis: normal,\r\n            point: pointOnEdge,\r\n            side: side,\r\n            localSide: localSide\r\n        };\r\n        return [\r\n            new CollisionContact(circle, edge, mvt, normal.negate(), normal.negate().perpendicular(), [pointOnEdge], [pointOnEdge.sub(edge.worldPos)], info)\r\n        ];\r\n    },\r\n    CollideEdgeEdge() {\r\n        // Edge-edge collision doesn't make sense\r\n        return [];\r\n    },\r\n    CollidePolygonEdge(polygon, edge) {\r\n        var _a;\r\n        const pc = polygon.center;\r\n        const ec = edge.center;\r\n        const dir = ec.sub(pc).normalize();\r\n        // build a temporary polygon from the edge to use SAT\r\n        const linePoly = new PolygonCollider({\r\n            points: [edge.begin, edge.end, edge.end.add(dir.scale(100)), edge.begin.add(dir.scale(100))],\r\n            offset: edge.offset\r\n        });\r\n        linePoly.owner = edge.owner;\r\n        const tx = (_a = edge.owner) === null || _a === void 0 ? void 0 : _a.get(TransformComponent);\r\n        if (tx) {\r\n            linePoly.update(edge.owner.get(TransformComponent));\r\n        }\r\n        // Gross hack but poly-poly works well\r\n        const contact = this.CollidePolygonPolygon(polygon, linePoly);\r\n        if (contact.length) {\r\n            // Fudge the contact back to edge\r\n            contact[0].colliderB = edge;\r\n            contact[0].id = Pair.calculatePairHash(polygon.id, edge.id);\r\n            // contact[0].info.collider\r\n        }\r\n        return contact;\r\n    },\r\n    CollidePolygonPolygon(polyA, polyB) {\r\n        var _a, _b, _c, _d;\r\n        // Multi contact from SAT\r\n        // https://gamedev.stackexchange.com/questions/111390/multiple-contacts-for-sat-collision-detection\r\n        // do a SAT test to find a min axis if it exists\r\n        const separationA = SeparatingAxis.findPolygonPolygonSeparation(polyA, polyB);\r\n        // If there is no overlap from boxA's perspective we can end early\r\n        if (separationA.separation > 0) {\r\n            return [];\r\n        }\r\n        const separationB = SeparatingAxis.findPolygonPolygonSeparation(polyB, polyA);\r\n        // If there is no overlap from boxB's perspective exit now\r\n        if (separationB.separation > 0) {\r\n            return [];\r\n        }\r\n        // Separations are both negative, we want to pick the least negative (minimal movement)\r\n        const separation = separationA.separation > separationB.separation ? separationA : separationB;\r\n        // The incident side is the most opposite from the axes of collision on the other collider\r\n        const other = separation.collider === polyA ? polyB : polyA;\r\n        const incident = other.findSide(separation.axis.negate());\r\n        // Clip incident side by the perpendicular lines at each end of the reference side\r\n        // https://en.wikipedia.org/wiki/Sutherland%E2%80%93Hodgman_algorithm\r\n        const reference = separation.side;\r\n        const refDir = reference.dir().normalize();\r\n        // Find our contact points by clipping the incident by the collision side\r\n        const clipRight = incident.clip(refDir.negate(), -refDir.dot(reference.begin));\r\n        let clipLeft = null;\r\n        if (clipRight) {\r\n            clipLeft = clipRight.clip(refDir, refDir.dot(reference.end));\r\n        }\r\n        // If there is no left there is no collision\r\n        if (clipLeft) {\r\n            // We only want clip points below the reference edge, discard the others\r\n            const points = clipLeft.getPoints().filter((p) => {\r\n                return reference.below(p);\r\n            });\r\n            let normal = separation.axis;\r\n            let tangent = normal.perpendicular();\r\n            // Point Contact A -> B\r\n            if (polyB.worldPos.sub(polyA.worldPos).dot(normal) < 0) {\r\n                normal = normal.negate();\r\n                tangent = normal.perpendicular();\r\n            }\r\n            // Points are clipped from incident which is the other collider\r\n            // Store those as locals\r\n            let localPoints = [];\r\n            if (separation.collider === polyA) {\r\n                const xf = (_b = (_a = polyB.owner) === null || _a === void 0 ? void 0 : _a.get(TransformComponent)) !== null && _b !== void 0 ? _b : new TransformComponent();\r\n                localPoints = points.map((p) => xf.applyInverse(p));\r\n            }\r\n            else {\r\n                const xf = (_d = (_c = polyA.owner) === null || _c === void 0 ? void 0 : _c.get(TransformComponent)) !== null && _d !== void 0 ? _d : new TransformComponent();\r\n                localPoints = points.map((p) => xf.applyInverse(p));\r\n            }\r\n            return [new CollisionContact(polyA, polyB, normal.scale(-separation.separation), normal, tangent, points, localPoints, separation)];\r\n        }\r\n        return [];\r\n    },\r\n    FindContactSeparation(contact, localPoint) {\r\n        var _a, _b, _c, _d;\r\n        const shapeA = contact.colliderA;\r\n        const txA = (_b = (_a = contact.colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(TransformComponent)) !== null && _b !== void 0 ? _b : new TransformComponent();\r\n        const shapeB = contact.colliderB;\r\n        const txB = (_d = (_c = contact.colliderB.owner) === null || _c === void 0 ? void 0 : _c.get(TransformComponent)) !== null && _d !== void 0 ? _d : new TransformComponent();\r\n        // both are circles\r\n        if (shapeA instanceof CircleCollider && shapeB instanceof CircleCollider) {\r\n            const combinedRadius = shapeA.radius + shapeB.radius;\r\n            const distance = txA.pos.distance(txB.pos);\r\n            const separation = combinedRadius - distance;\r\n            return -separation;\r\n        }\r\n        // both are polygons\r\n        if (shapeA instanceof PolygonCollider && shapeB instanceof PolygonCollider) {\r\n            if (contact.info.localSide) {\r\n                let side;\r\n                let worldPoint;\r\n                if (contact.info.collider === shapeA) {\r\n                    side = new Line(txA.apply(contact.info.localSide.begin), txA.apply(contact.info.localSide.end));\r\n                    worldPoint = txB.apply(localPoint);\r\n                }\r\n                else {\r\n                    side = new Line(txB.apply(contact.info.localSide.begin), txB.apply(contact.info.localSide.end));\r\n                    worldPoint = txA.apply(localPoint);\r\n                }\r\n                return side.distanceToPoint(worldPoint, true);\r\n            }\r\n        }\r\n        // polygon v circle\r\n        if ((shapeA instanceof PolygonCollider && shapeB instanceof CircleCollider) ||\r\n            (shapeB instanceof PolygonCollider && shapeA instanceof CircleCollider)) {\r\n            const worldPoint = txA.apply(localPoint);\r\n            if (contact.info.side) {\r\n                return contact.info.side.distanceToPoint(worldPoint, true);\r\n            }\r\n        }\r\n        // polygon v edge\r\n        if ((shapeA instanceof EdgeCollider && shapeB instanceof PolygonCollider) ||\r\n            (shapeB instanceof EdgeCollider && shapeA instanceof PolygonCollider)) {\r\n            let worldPoint;\r\n            if (contact.info.collider === shapeA) {\r\n                worldPoint = txB.apply(localPoint);\r\n            }\r\n            else {\r\n                worldPoint = txA.apply(localPoint);\r\n            }\r\n            if (contact.info.side) {\r\n                return contact.info.side.distanceToPoint(worldPoint, true);\r\n            }\r\n        }\r\n        // circle v edge\r\n        if ((shapeA instanceof CircleCollider && shapeB instanceof EdgeCollider) ||\r\n            (shapeB instanceof CircleCollider && shapeA instanceof EdgeCollider)) {\r\n            // Local point is always on the edge which is always shapeB\r\n            const worldPoint = txB.apply(localPoint);\r\n            let circlePoint;\r\n            if (shapeA instanceof CircleCollider) {\r\n                circlePoint = shapeA.getFurthestPoint(contact.normal);\r\n            }\r\n            const dist = worldPoint.distance(circlePoint);\r\n            if (contact.info.side) {\r\n                return dist > 0 ? -dist : 0;\r\n            }\r\n        }\r\n        return 0;\r\n    }\r\n};\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/EdgeCollider.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Edge is a single line collider to create collisions with a single line.\r\n */\r\nclass EdgeCollider extends Collider {\r\n    constructor(options) {\r\n        var _a;\r\n        super();\r\n        this.begin = options.begin || Vector.Zero;\r\n        this.end = options.end || Vector.Zero;\r\n        this.offset = (_a = options.offset) !== null && _a !== void 0 ? _a : Vector.Zero;\r\n    }\r\n    /**\r\n     * Returns a clone of this Edge, not associated with any collider\r\n     */\r\n    clone() {\r\n        return new EdgeCollider({\r\n            begin: this.begin.clone(),\r\n            end: this.end.clone()\r\n        });\r\n    }\r\n    get worldPos() {\r\n        var _a;\r\n        const tx = this._transform;\r\n        return (_a = tx === null || tx === void 0 ? void 0 : tx.globalPos.add(this.offset)) !== null && _a !== void 0 ? _a : this.offset;\r\n    }\r\n    /**\r\n     * Get the center of the collision area in world coordinates\r\n     */\r\n    get center() {\r\n        const pos = this.begin.average(this.end).add(this._getBodyPos());\r\n        return pos;\r\n    }\r\n    _getBodyPos() {\r\n        var _a;\r\n        const tx = this._transform;\r\n        const bodyPos = (_a = tx === null || tx === void 0 ? void 0 : tx.globalPos) !== null && _a !== void 0 ? _a : Vector.Zero;\r\n        return bodyPos;\r\n    }\r\n    _getTransformedBegin() {\r\n        const tx = this._transform;\r\n        const angle = tx ? tx.globalRotation : 0;\r\n        return this.begin.rotate(angle).add(this._getBodyPos());\r\n    }\r\n    _getTransformedEnd() {\r\n        const tx = this._transform;\r\n        const angle = tx ? tx.globalRotation : 0;\r\n        return this.end.rotate(angle).add(this._getBodyPos());\r\n    }\r\n    /**\r\n     * Returns the slope of the line in the form of a vector\r\n     */\r\n    getSlope() {\r\n        const begin = this._getTransformedBegin();\r\n        const end = this._getTransformedEnd();\r\n        const distance = begin.distance(end);\r\n        return end.sub(begin).scale(1 / distance);\r\n    }\r\n    /**\r\n     * Returns the length of the line segment in pixels\r\n     */\r\n    getLength() {\r\n        const begin = this._getTransformedBegin();\r\n        const end = this._getTransformedEnd();\r\n        const distance = begin.distance(end);\r\n        return distance;\r\n    }\r\n    /**\r\n     * Tests if a point is contained in this collision area\r\n     */\r\n    contains() {\r\n        return false;\r\n    }\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    rayCast(ray, max = Infinity) {\r\n        const numerator = this._getTransformedBegin().sub(ray.pos);\r\n        // Test is line and ray are parallel and non intersecting\r\n        if (ray.dir.cross(this.getSlope()) === 0 && numerator.cross(ray.dir) !== 0) {\r\n            return null;\r\n        }\r\n        // Lines are parallel\r\n        const divisor = ray.dir.cross(this.getSlope());\r\n        if (divisor === 0) {\r\n            return null;\r\n        }\r\n        const t = numerator.cross(this.getSlope()) / divisor;\r\n        if (t >= 0 && t <= max) {\r\n            const u = numerator.cross(ray.dir) / divisor / this.getLength();\r\n            if (u >= 0 && u <= 1) {\r\n                return ray.getPoint(t);\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n    /**\r\n     * Returns the closes line between this and another collider, from this -> collider\r\n     * @param shape\r\n     */\r\n    getClosestLineBetween(shape) {\r\n        if (shape instanceof CircleCollider) {\r\n            return ClosestLineJumpTable.CircleEdgeClosestLine(shape, this);\r\n        }\r\n        else if (shape instanceof PolygonCollider) {\r\n            return ClosestLineJumpTable.PolygonEdgeClosestLine(shape, this).flip();\r\n        }\r\n        else if (shape instanceof EdgeCollider) {\r\n            return ClosestLineJumpTable.EdgeEdgeClosestLine(this, shape);\r\n        }\r\n        else {\r\n            throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof shape}`);\r\n        }\r\n    }\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    collide(shape) {\r\n        if (shape instanceof CircleCollider) {\r\n            return CollisionJumpTable.CollideCircleEdge(shape, this);\r\n        }\r\n        else if (shape instanceof PolygonCollider) {\r\n            return CollisionJumpTable.CollidePolygonEdge(shape, this);\r\n        }\r\n        else if (shape instanceof EdgeCollider) {\r\n            return CollisionJumpTable.CollideEdgeEdge();\r\n        }\r\n        else {\r\n            throw new Error(`Edge could not collide with unknown CollisionShape ${typeof shape}`);\r\n        }\r\n    }\r\n    /**\r\n     * Find the point on the collider furthest in the direction specified\r\n     */\r\n    getFurthestPoint(direction) {\r\n        const transformedBegin = this._getTransformedBegin();\r\n        const transformedEnd = this._getTransformedEnd();\r\n        if (direction.dot(transformedBegin) > 0) {\r\n            return transformedBegin;\r\n        }\r\n        else {\r\n            return transformedEnd;\r\n        }\r\n    }\r\n    _boundsFromBeginEnd(begin, end, padding = 10) {\r\n        // A perfectly vertical or horizontal edge would have a bounds 0 width or height\r\n        // this causes problems for the collision system so we give them some padding\r\n        return new BoundingBox(Math.min(begin.x, end.x) - padding, Math.min(begin.y, end.y) - padding, Math.max(begin.x, end.x) + padding, Math.max(begin.y, end.y) + padding);\r\n    }\r\n    /**\r\n     * Get the axis aligned bounding box for the edge collider in world space\r\n     */\r\n    get bounds() {\r\n        const transformedBegin = this._getTransformedBegin();\r\n        const transformedEnd = this._getTransformedEnd();\r\n        return this._boundsFromBeginEnd(transformedBegin, transformedEnd);\r\n    }\r\n    /**\r\n     * Get the axis aligned bounding box for the edge collider in local space\r\n     */\r\n    get localBounds() {\r\n        return this._boundsFromBeginEnd(this.begin, this.end);\r\n    }\r\n    /**\r\n     * Returns this edge represented as a line in world coordinates\r\n     */\r\n    asLine() {\r\n        return new Line(this._getTransformedBegin(), this._getTransformedEnd());\r\n    }\r\n    /**\r\n     * Return this edge as a line in local line coordinates (relative to the position)\r\n     */\r\n    asLocalLine() {\r\n        return new Line(this.begin, this.end);\r\n    }\r\n    /**\r\n     * Get the axis associated with the edge\r\n     */\r\n    get axes() {\r\n        const e = this._getTransformedEnd().sub(this._getTransformedBegin());\r\n        const edgeNormal = e.normal();\r\n        const axes = [];\r\n        axes.push(edgeNormal);\r\n        axes.push(edgeNormal.negate());\r\n        axes.push(edgeNormal.normal());\r\n        axes.push(edgeNormal.normal().negate());\r\n        return axes;\r\n    }\r\n    /**\r\n     * Get the moment of inertia for an edge\r\n     * https://en.wikipedia.org/wiki/List_of_moments_of_inertia\r\n     */\r\n    getInertia(mass) {\r\n        const length = this.end.sub(this.begin).distance() / 2;\r\n        return mass * length * length;\r\n    }\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    update(transform) {\r\n        this._transform = transform;\r\n    }\r\n    /**\r\n     * Project the edge along a specified axis\r\n     */\r\n    project(axis) {\r\n        const scalars = [];\r\n        const points = [this._getTransformedBegin(), this._getTransformedEnd()];\r\n        const len = points.length;\r\n        for (let i = 0; i < len; i++) {\r\n            scalars.push(points[i].dot(axis));\r\n        }\r\n        return new Projection(Math.min.apply(Math, scalars), Math.max.apply(Math, scalars));\r\n    }\r\n    draw(ctx, color = Color.Green, pos = Vector.Zero) {\r\n        const begin = this.begin.add(pos);\r\n        const end = this.end.add(pos);\r\n        ctx.strokeStyle = color.toString();\r\n        ctx.beginPath();\r\n        ctx.moveTo(begin.x, begin.y);\r\n        ctx.lineTo(end.x, end.y);\r\n        ctx.closePath();\r\n        ctx.stroke();\r\n    }\r\n    debug(ex, color) {\r\n        const begin = this._getTransformedBegin();\r\n        const end = this._getTransformedEnd();\r\n        ex.drawLine(begin, end, color, 2);\r\n        ex.drawCircle(begin, 2, color);\r\n        ex.drawCircle(end, 2, color);\r\n    }\r\n    /* istanbul ignore next */\r\n    debugDraw(ctx, color = Color.Red) {\r\n        const begin = this._getTransformedBegin();\r\n        const end = this._getTransformedEnd();\r\n        ctx.strokeStyle = color.toString();\r\n        ctx.beginPath();\r\n        ctx.moveTo(begin.x, begin.y);\r\n        ctx.lineTo(end.x, end.y);\r\n        ctx.closePath();\r\n        ctx.stroke();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/PolygonCollider.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Polygon collider for detecting collisions\r\n */\r\nclass PolygonCollider extends Collider {\r\n    constructor(options) {\r\n        var _a;\r\n        super();\r\n        this._transformedPoints = [];\r\n        this._axes = [];\r\n        this._sides = [];\r\n        this._localSides = [];\r\n        this.offset = (_a = options.offset) !== null && _a !== void 0 ? _a : Vector.Zero;\r\n        const winding = !!options.clockwiseWinding;\r\n        this.points = (winding ? options.points.reverse() : options.points) || [];\r\n        // calculate initial transformation\r\n        this._calculateTransformation();\r\n    }\r\n    /**\r\n     * Returns a clone of this ConvexPolygon, not associated with any collider\r\n     */\r\n    clone() {\r\n        return new PolygonCollider({\r\n            offset: this.offset.clone(),\r\n            points: this.points.map((p) => p.clone())\r\n        });\r\n    }\r\n    /**\r\n     * Returns the world position of the collider, which is the current body transform plus any defined offset\r\n     */\r\n    get worldPos() {\r\n        if (this._transform) {\r\n            return this._transform.pos.add(this.offset);\r\n        }\r\n        return this.offset;\r\n    }\r\n    /**\r\n     * Get the center of the collider in world coordinates\r\n     */\r\n    get center() {\r\n        return this.bounds.center;\r\n    }\r\n    /**\r\n     * Calculates the underlying transformation from the body relative space to world space\r\n     */\r\n    _calculateTransformation() {\r\n        const transform = this._transform;\r\n        const pos = transform ? transform.globalPos.add(this.offset) : this.offset;\r\n        const angle = transform ? transform.globalRotation : 0;\r\n        const scale = transform ? transform.globalScale : Vector.One;\r\n        const len = this.points.length;\r\n        this._transformedPoints.length = 0; // clear out old transform\r\n        for (let i = 0; i < len; i++) {\r\n            this._transformedPoints[i] = this.points[i].scale(scale).rotate(angle).add(pos);\r\n        }\r\n    }\r\n    /**\r\n     * Gets the points that make up the polygon in world space, from actor relative space (if specified)\r\n     */\r\n    getTransformedPoints() {\r\n        this._calculateTransformation();\r\n        return this._transformedPoints;\r\n    }\r\n    /**\r\n     * Gets the sides of the polygon in world space\r\n     */\r\n    getSides() {\r\n        if (this._sides.length) {\r\n            return this._sides;\r\n        }\r\n        const lines = [];\r\n        const points = this.getTransformedPoints();\r\n        const len = points.length;\r\n        for (let i = 0; i < len; i++) {\r\n            // This winding is important\r\n            lines.push(new Line(points[i], points[(i + 1) % len]));\r\n        }\r\n        this._sides = lines;\r\n        return this._sides;\r\n    }\r\n    /**\r\n     * Returns the local coordinate space sides\r\n     */\r\n    getLocalSides() {\r\n        if (this._localSides.length) {\r\n            return this._localSides;\r\n        }\r\n        const lines = [];\r\n        const points = this.points;\r\n        const len = points.length;\r\n        for (let i = 0; i < len; i++) {\r\n            // This winding is important\r\n            lines.push(new Line(points[i], points[(i + 1) % len]));\r\n        }\r\n        this._localSides = lines;\r\n        return this._localSides;\r\n    }\r\n    /**\r\n     * Given a direction vector find the world space side that is most in that direction\r\n     * @param direction\r\n     */\r\n    findSide(direction) {\r\n        const sides = this.getSides();\r\n        let bestSide = sides[0];\r\n        let maxDistance = -Number.MAX_VALUE;\r\n        for (let side = 0; side < sides.length; side++) {\r\n            const currentSide = sides[side];\r\n            const sideNormal = currentSide.normal();\r\n            const mostDirection = sideNormal.dot(direction);\r\n            if (mostDirection > maxDistance) {\r\n                bestSide = currentSide;\r\n                maxDistance = mostDirection;\r\n            }\r\n        }\r\n        return bestSide;\r\n    }\r\n    /**\r\n     * Given a direction vector find the local space side that is most in that direction\r\n     * @param direction\r\n     */\r\n    findLocalSide(direction) {\r\n        const sides = this.getLocalSides();\r\n        let bestSide = sides[0];\r\n        let maxDistance = -Number.MAX_VALUE;\r\n        for (let side = 0; side < sides.length; side++) {\r\n            const currentSide = sides[side];\r\n            const sideNormal = currentSide.normal();\r\n            const mostDirection = sideNormal.dot(direction);\r\n            if (mostDirection > maxDistance) {\r\n                bestSide = currentSide;\r\n                maxDistance = mostDirection;\r\n            }\r\n        }\r\n        return bestSide;\r\n    }\r\n    /**\r\n     * Get the axis associated with the convex polygon\r\n     */\r\n    get axes() {\r\n        if (this._axes.length) {\r\n            return this._axes;\r\n        }\r\n        const axes = this.getSides().map((s) => s.normal());\r\n        this._axes = axes;\r\n        return this._axes;\r\n    }\r\n    update(transform) {\r\n        this._transform = transform;\r\n        this._sides.length = 0;\r\n        this._localSides.length = 0;\r\n        this._axes.length = 0;\r\n        this._transformedPoints.length = 0;\r\n        this.getTransformedPoints();\r\n        this.getSides();\r\n        this.getLocalSides();\r\n    }\r\n    /**\r\n     * Tests if a point is contained in this collider in world space\r\n     */\r\n    contains(point) {\r\n        // Always cast to the right, as long as we cast in a consistent fixed direction we\r\n        // will be fine\r\n        const testRay = new Ray(point, new Vector(1, 0));\r\n        const intersectCount = this.getSides().reduce(function (accum, side) {\r\n            if (testRay.intersect(side) >= 0) {\r\n                return accum + 1;\r\n            }\r\n            return accum;\r\n        }, 0);\r\n        if (intersectCount % 2 === 0) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    getClosestLineBetween(collider) {\r\n        if (collider instanceof CircleCollider) {\r\n            return ClosestLineJumpTable.PolygonCircleClosestLine(this, collider);\r\n        }\r\n        else if (collider instanceof PolygonCollider) {\r\n            return ClosestLineJumpTable.PolygonPolygonClosestLine(this, collider);\r\n        }\r\n        else if (collider instanceof EdgeCollider) {\r\n            return ClosestLineJumpTable.PolygonEdgeClosestLine(this, collider);\r\n        }\r\n        else {\r\n            throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof collider}`);\r\n        }\r\n    }\r\n    /**\r\n     * Returns a collision contact if the 2 colliders collide, otherwise collide will\r\n     * return null.\r\n     * @param collider\r\n     */\r\n    collide(collider) {\r\n        if (collider instanceof CircleCollider) {\r\n            return CollisionJumpTable.CollideCirclePolygon(collider, this);\r\n        }\r\n        else if (collider instanceof PolygonCollider) {\r\n            return CollisionJumpTable.CollidePolygonPolygon(this, collider);\r\n        }\r\n        else if (collider instanceof EdgeCollider) {\r\n            return CollisionJumpTable.CollidePolygonEdge(this, collider);\r\n        }\r\n        else {\r\n            throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof collider}`);\r\n        }\r\n    }\r\n    /**\r\n     * Find the point on the collider furthest in the direction specified\r\n     */\r\n    getFurthestPoint(direction) {\r\n        const pts = this.getTransformedPoints();\r\n        let furthestPoint = null;\r\n        let maxDistance = -Number.MAX_VALUE;\r\n        for (let i = 0; i < pts.length; i++) {\r\n            const distance = direction.dot(pts[i]);\r\n            if (distance > maxDistance) {\r\n                maxDistance = distance;\r\n                furthestPoint = pts[i];\r\n            }\r\n        }\r\n        return furthestPoint;\r\n    }\r\n    /**\r\n     * Find the local point on the collider furthest in the direction specified\r\n     * @param direction\r\n     */\r\n    getFurthestLocalPoint(direction) {\r\n        const pts = this.points;\r\n        let furthestPoint = pts[0];\r\n        let maxDistance = -Number.MAX_VALUE;\r\n        for (let i = 0; i < pts.length; i++) {\r\n            const distance = direction.dot(pts[i]);\r\n            if (distance > maxDistance) {\r\n                maxDistance = distance;\r\n                furthestPoint = pts[i];\r\n            }\r\n        }\r\n        return furthestPoint;\r\n    }\r\n    /**\r\n     * Finds the closes face to the point using perpendicular distance\r\n     * @param point point to test against polygon\r\n     */\r\n    getClosestFace(point) {\r\n        const sides = this.getSides();\r\n        let min = Number.POSITIVE_INFINITY;\r\n        let faceIndex = -1;\r\n        let distance = -1;\r\n        for (let i = 0; i < sides.length; i++) {\r\n            const dist = sides[i].distanceToPoint(point);\r\n            if (dist < min) {\r\n                min = dist;\r\n                faceIndex = i;\r\n                distance = dist;\r\n            }\r\n        }\r\n        if (faceIndex !== -1) {\r\n            return {\r\n                distance: sides[faceIndex].normal().scale(distance),\r\n                face: sides[faceIndex]\r\n            };\r\n        }\r\n        return null;\r\n    }\r\n    /**\r\n     * Get the axis aligned bounding box for the polygon collider in world coordinates\r\n     */\r\n    get bounds() {\r\n        var _a, _b, _c;\r\n        const tx = this._transform;\r\n        const scale = (_a = tx === null || tx === void 0 ? void 0 : tx.globalScale) !== null && _a !== void 0 ? _a : Vector.One;\r\n        const rotation = (_b = tx === null || tx === void 0 ? void 0 : tx.globalRotation) !== null && _b !== void 0 ? _b : 0;\r\n        const pos = ((_c = tx === null || tx === void 0 ? void 0 : tx.globalPos) !== null && _c !== void 0 ? _c : Vector.Zero).add(this.offset);\r\n        return this.localBounds.scale(scale).rotate(rotation).translate(pos);\r\n    }\r\n    /**\r\n     * Get the axis aligned bounding box for the polygon collider in local coordinates\r\n     */\r\n    get localBounds() {\r\n        return BoundingBox.fromPoints(this.points);\r\n    }\r\n    /**\r\n     * Get the moment of inertia for an arbitrary polygon\r\n     * https://en.wikipedia.org/wiki/List_of_moments_of_inertia\r\n     */\r\n    getInertia(mass) {\r\n        let numerator = 0;\r\n        let denominator = 0;\r\n        for (let i = 0; i < this.points.length; i++) {\r\n            const iplusone = (i + 1) % this.points.length;\r\n            const crossTerm = this.points[iplusone].cross(this.points[i]);\r\n            numerator +=\r\n                crossTerm *\r\n                    (this.points[i].dot(this.points[i]) + this.points[i].dot(this.points[iplusone]) + this.points[iplusone].dot(this.points[iplusone]));\r\n            denominator += crossTerm;\r\n        }\r\n        return (mass / 6) * (numerator / denominator);\r\n    }\r\n    /**\r\n     * Casts a ray into the polygon and returns a vector representing the point of contact (in world space) or null if no collision.\r\n     */\r\n    rayCast(ray, max = Infinity) {\r\n        // find the minimum contact time greater than 0\r\n        // contact times less than 0 are behind the ray and we don't want those\r\n        const sides = this.getSides();\r\n        const len = sides.length;\r\n        let minContactTime = Number.MAX_VALUE;\r\n        let contactIndex = -1;\r\n        for (let i = 0; i < len; i++) {\r\n            const contactTime = ray.intersect(sides[i]);\r\n            if (contactTime >= 0 && contactTime < minContactTime && contactTime <= max) {\r\n                minContactTime = contactTime;\r\n                contactIndex = i;\r\n            }\r\n        }\r\n        // contact was found\r\n        if (contactIndex >= 0) {\r\n            return ray.getPoint(minContactTime);\r\n        }\r\n        // no contact found\r\n        return null;\r\n    }\r\n    /**\r\n     * Project the edges of the polygon along a specified axis\r\n     */\r\n    project(axis) {\r\n        const points = this.getTransformedPoints();\r\n        const len = points.length;\r\n        let min = Number.MAX_VALUE;\r\n        let max = -Number.MAX_VALUE;\r\n        for (let i = 0; i < len; i++) {\r\n            const scalar = points[i].dot(axis);\r\n            min = Math.min(min, scalar);\r\n            max = Math.max(max, scalar);\r\n        }\r\n        return new Projection(min, max);\r\n    }\r\n    draw(ctx, color = Color.Green, pos = Vector.Zero) {\r\n        const effectiveOffset = pos.add(this.offset);\r\n        ctx.beginPath();\r\n        ctx.fillStyle = color.toString();\r\n        const firstPoint = this.points[0].add(effectiveOffset);\r\n        ctx.moveTo(firstPoint.x, firstPoint.y);\r\n        // Points are relative\r\n        this.points\r\n            .map((p) => p.add(effectiveOffset))\r\n            .forEach(function (point) {\r\n            ctx.lineTo(point.x, point.y);\r\n        });\r\n        ctx.lineTo(firstPoint.x, firstPoint.y);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n    }\r\n    debug(ex, color) {\r\n        const firstPoint = this.getTransformedPoints()[0];\r\n        const points = [firstPoint, ...this.getTransformedPoints(), firstPoint];\r\n        for (let i = 0; i < points.length - 1; i++) {\r\n            ex.drawLine(points[i], points[i + 1], color, 2);\r\n            ex.drawCircle(points[i], 2, color);\r\n            ex.drawCircle(points[i + 1], 2, color);\r\n        }\r\n    }\r\n    /* istanbul ignore next */\r\n    debugDraw(ctx, color = Color.Red) {\r\n        ctx.beginPath();\r\n        ctx.strokeStyle = color.toString();\r\n        // Iterate through the supplied points and construct a 'polygon'\r\n        const firstPoint = this.getTransformedPoints()[0];\r\n        ctx.moveTo(firstPoint.x, firstPoint.y);\r\n        this.getTransformedPoints().forEach(function (point) {\r\n            ctx.lineTo(point.x, point.y);\r\n        });\r\n        ctx.lineTo(firstPoint.x, firstPoint.y);\r\n        ctx.closePath();\r\n        ctx.stroke();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/Shape.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Excalibur helper for defining colliders quickly\r\n */\r\nclass Shape {\r\n    /**\r\n     * Creates a box collider, under the hood defines a [[PolygonCollider]] collider\r\n     * @param width Width of the box\r\n     * @param height Height of the box\r\n     * @param anchor Anchor of the box (default (.5, .5)) which positions the box relative to the center of the collider's position\r\n     * @param offset Optional offset relative to the collider in local coordinates\r\n     */\r\n    static Box(width, height, anchor = Vector.Half, offset = Vector.Zero) {\r\n        return new PolygonCollider({\r\n            points: new BoundingBox(-width * anchor.x, -height * anchor.y, width - width * anchor.x, height - height * anchor.y).getPoints(),\r\n            offset: offset\r\n        });\r\n    }\r\n    /**\r\n     * Creates a new [[PolygonCollider|arbitrary polygon]] collider\r\n     *\r\n     * PolygonColliders are useful for creating convex polygon shapes\r\n     * @param points Points specified in counter clockwise\r\n     * @param clockwiseWinding Optionally changed the winding of points, by default false meaning counter-clockwise winding.\r\n     * @param offset Optional offset relative to the collider in local coordinates\r\n     */\r\n    static Polygon(points, clockwiseWinding = false, offset = Vector.Zero) {\r\n        return new PolygonCollider({\r\n            points: points,\r\n            offset: offset,\r\n            clockwiseWinding: clockwiseWinding\r\n        });\r\n    }\r\n    /**\r\n     * Creates a new [[CircleCollider|circle]] collider\r\n     *\r\n     * Circle colliders are useful for balls, or to make collisions more forgiving on sharp edges\r\n     * @param radius Radius of the circle collider\r\n     * @param offset Optional offset relative to the collider in local coordinates\r\n     */\r\n    static Circle(radius, offset = Vector.Zero) {\r\n        return new CircleCollider({\r\n            radius: radius,\r\n            offset: offset\r\n        });\r\n    }\r\n    /**\r\n     * Creates a new [[EdgeCollider|edge]] collider\r\n     *\r\n     * Edge colliders are useful for  floors, walls, and other barriers\r\n     * @param begin Beginning of the edge in local coordinates to the collider\r\n     * @param end Ending of the edge in local coordinates to the collider\r\n     */\r\n    static Edge(begin, end) {\r\n        return new EdgeCollider({\r\n            begin: begin,\r\n            end: end\r\n        });\r\n    }\r\n    /**\r\n     * Creates a new capsule shaped [[CompositeCollider]] using 2 circles and a box\r\n     *\r\n     * Capsule colliders are useful for platformers with incline or jagged floors to have a smooth\r\n     * player experience.\r\n     *\r\n     * @param width\r\n     * @param height\r\n     * @param offset Optional offset\r\n     */\r\n    static Capsule(width, height, offset = Vector.Zero) {\r\n        const logger = Logger.getInstance();\r\n        if (width === height) {\r\n            logger.warn('A capsule collider with equal width and height is a circle, consider using a ex.Shape.Circle or ex.CircleCollider');\r\n        }\r\n        const vertical = height >= width;\r\n        if (vertical) {\r\n            // height > width, if equal maybe use a circle\r\n            const capsule = new CompositeCollider([\r\n                Shape.Circle(width / 2, vec(0, -height / 2 + width / 2).add(offset)),\r\n                Shape.Box(width, height - width, Vector.Half, offset),\r\n                Shape.Circle(width / 2, vec(0, height / 2 - width / 2).add(offset))\r\n            ]);\r\n            return capsule;\r\n        }\r\n        else {\r\n            // width > height, if equal maybe use a circle\r\n            const capsule = new CompositeCollider([\r\n                Shape.Circle(height / 2, vec(-width / 2 + height / 2, 0).add(offset)),\r\n                Shape.Box(width - height, height, Vector.Half, offset),\r\n                Shape.Circle(height / 2, vec(width / 2 - height / 2, 0).add(offset))\r\n            ]);\r\n            return capsule;\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/ColliderComponent.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass ColliderComponent extends Component {\r\n    constructor(collider) {\r\n        super();\r\n        this.type = 'ex.collider';\r\n        this.events = new EventDispatcher();\r\n        /**\r\n         * Observable that notifies when a collider is added to the body\r\n         */\r\n        this.$colliderAdded = new Observable();\r\n        /**\r\n         * Observable that notifies when a collider is removed from the body\r\n         */\r\n        this.$colliderRemoved = new Observable();\r\n        this.set(collider);\r\n    }\r\n    /**\r\n     * Get the current collider geometry\r\n     */\r\n    get() {\r\n        return this._collider;\r\n    }\r\n    /**\r\n     * Set the collider geometry\r\n     * @param collider\r\n     * @returns the collider you set\r\n     */\r\n    set(collider) {\r\n        this.clear();\r\n        if (collider) {\r\n            this._collider = collider;\r\n            this._collider.owner = this.owner;\r\n            this.events.wire(collider.events);\r\n            this.$colliderAdded.notifyAll(collider);\r\n            this.update();\r\n        }\r\n        return collider;\r\n    }\r\n    /**\r\n     * Remove collider geometry from collider component\r\n     */\r\n    clear() {\r\n        if (this._collider) {\r\n            this.events.unwire(this._collider.events);\r\n            this.$colliderRemoved.notifyAll(this._collider);\r\n            this._collider.owner = null;\r\n            this._collider = null;\r\n        }\r\n    }\r\n    /**\r\n     * Return world space bounds\r\n     */\r\n    get bounds() {\r\n        var _a, _b;\r\n        return (_b = (_a = this._collider) === null || _a === void 0 ? void 0 : _a.bounds) !== null && _b !== void 0 ? _b : new BoundingBox();\r\n    }\r\n    /**\r\n     * Return local space bounds\r\n     */\r\n    get localBounds() {\r\n        var _a, _b;\r\n        return (_b = (_a = this._collider) === null || _a === void 0 ? void 0 : _a.localBounds) !== null && _b !== void 0 ? _b : new BoundingBox();\r\n    }\r\n    /**\r\n     * Update the collider's transformed geometry\r\n     */\r\n    update() {\r\n        var _a;\r\n        const tx = (_a = this.owner) === null || _a === void 0 ? void 0 : _a.get(TransformComponent);\r\n        if (this._collider) {\r\n            this._collider.owner = this.owner;\r\n            if (tx) {\r\n                this._collider.update(tx);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Collide component with another\r\n     * @param other\r\n     */\r\n    collide(other) {\r\n        let colliderA = this._collider;\r\n        let colliderB = other._collider;\r\n        if (!colliderA || !colliderB) {\r\n            return [];\r\n        }\r\n        // If we have a composite lefthand side :(\r\n        // Might bite us, but to avoid updating all the handlers make composite always left side\r\n        let flipped = false;\r\n        if (colliderB instanceof CompositeCollider) {\r\n            colliderA = colliderB;\r\n            colliderB = this._collider;\r\n            flipped = true;\r\n        }\r\n        if (this._collider) {\r\n            const contacts = colliderA.collide(colliderB);\r\n            if (contacts) {\r\n                if (flipped) {\r\n                    contacts.forEach((contact) => {\r\n                        contact.mtv = contact.mtv.negate();\r\n                        contact.normal = contact.normal.negate();\r\n                        contact.tangent = contact.normal.perpendicular();\r\n                        contact.colliderA = this._collider;\r\n                        contact.colliderB = other._collider;\r\n                    });\r\n                }\r\n                return contacts;\r\n            }\r\n            return [];\r\n        }\r\n        return [];\r\n    }\r\n    onAdd(entity) {\r\n        if (this._collider) {\r\n            this.update();\r\n        }\r\n        // Wire up the collider events to the owning entity\r\n        this.events.on('precollision', (evt) => {\r\n            const precollision = evt;\r\n            entity.events.emit('precollision', new PreCollisionEvent(precollision.target.owner, precollision.other.owner, precollision.side, precollision.intersection));\r\n        });\r\n        this.events.on('postcollision', (evt) => {\r\n            const postcollision = evt;\r\n            entity.events.emit('postcollision', new PostCollisionEvent(postcollision.target.owner, postcollision.other.owner, postcollision.side, postcollision.intersection));\r\n        });\r\n        this.events.on('collisionstart', (evt) => {\r\n            const start = evt;\r\n            entity.events.emit('collisionstart', new CollisionStartEvent(start.target.owner, start.other.owner, start.contact));\r\n        });\r\n        this.events.on('collisionend', (evt) => {\r\n            const end = evt;\r\n            entity.events.emit('collisionend', new CollisionEndEvent(end.target.owner, end.other.owner));\r\n        });\r\n    }\r\n    onRemove() {\r\n        this.events.clear();\r\n        this.$colliderRemoved.notifyAll(this._collider);\r\n    }\r\n    /**\r\n     * Sets up a box geometry based on the current bounds of the associated actor of this physics body.\r\n     *\r\n     * If no width/height are specified the body will attempt to use the associated actor's width/height.\r\n     *\r\n     * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.\r\n     */\r\n    useBoxCollider(width, height, anchor = Vector.Half, center = Vector.Zero) {\r\n        const collider = Shape.Box(width, height, anchor, center);\r\n        return (this.set(collider));\r\n    }\r\n    /**\r\n     * Sets up a [[PolygonCollider|polygon]] collision geometry based on a list of of points relative\r\n     *  to the anchor of the associated actor\r\n     * of this physics body.\r\n     *\r\n     * Only [convex polygon](https://en.wikipedia.org/wiki/Convex_polygon) definitions are supported.\r\n     *\r\n     * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.\r\n     */\r\n    usePolygonCollider(points, center = Vector.Zero) {\r\n        const poly = Shape.Polygon(points, false, center);\r\n        return (this.set(poly));\r\n    }\r\n    /**\r\n     * Sets up a [[Circle|circle collision geometry]] as the only collider with a specified radius in pixels.\r\n     *\r\n     * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.\r\n     */\r\n    useCircleCollider(radius, center = Vector.Zero) {\r\n        const collider = Shape.Circle(radius, center);\r\n        return (this.set(collider));\r\n    }\r\n    /**\r\n     * Sets up an [[Edge|edge collision geometry]] with a start point and an end point relative to the anchor of the associated actor\r\n     * of this physics body.\r\n     *\r\n     * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.\r\n     */\r\n    useEdgeCollider(begin, end) {\r\n        const collider = Shape.Edge(begin, end);\r\n        return (this.set(collider));\r\n    }\r\n    /**\r\n     * Setups up a [[CompositeCollider]] which can define any arbitrary set of excalibur colliders\r\n     * @param colliders\r\n     */\r\n    useCompositeCollider(colliders) {\r\n        return (this.set(new CompositeCollider(colliders)));\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/BodyComponent.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar DegreeOfFreedom;\r\n(function (DegreeOfFreedom) {\r\n    DegreeOfFreedom[\"Rotation\"] = \"rotation\";\r\n    DegreeOfFreedom[\"X\"] = \"x\";\r\n    DegreeOfFreedom[\"Y\"] = \"y\";\r\n})(DegreeOfFreedom || (DegreeOfFreedom = {}));\r\n/**\r\n * Body describes all the physical properties pos, vel, acc, rotation, angular velocity for the purpose of\r\n * of physics simulation.\r\n */\r\nclass BodyComponent extends Component {\r\n    constructor(options) {\r\n        var _a, _b, _c;\r\n        super();\r\n        this.type = 'ex.body';\r\n        this.dependencies = [TransformComponent, MotionComponent];\r\n        this.id = createId('body', BodyComponent._ID++);\r\n        this.events = new EventDispatcher();\r\n        /**\r\n         * Collision type for the rigidbody physics simulation, by default [[CollisionType.PreventCollision]]\r\n         */\r\n        this.collisionType = CollisionType.PreventCollision;\r\n        /**\r\n         * The collision group for the body's colliders, by default body colliders collide with everything\r\n         */\r\n        this.group = CollisionGroup.All;\r\n        /**\r\n         * The amount of mass the body has\r\n         */\r\n        this.mass = Physics.defaultMass;\r\n        /**\r\n         * Amount of \"motion\" the body has before sleeping. If below [[Physics.sleepEpsilon]] it goes to \"sleep\"\r\n         */\r\n        this.sleepMotion = Physics.sleepEpsilon * 5;\r\n        /**\r\n         * Can this body sleep, by default bodies do not sleep\r\n         */\r\n        this.canSleep = Physics.bodiesCanSleepByDefault;\r\n        this._sleeping = false;\r\n        /**\r\n         * The also known as coefficient of restitution of this actor, represents the amount of energy preserved after collision or the\r\n         * bounciness. If 1, it is 100% bouncy, 0 it completely absorbs.\r\n         */\r\n        this.bounciness = 0.2;\r\n        /**\r\n         * The coefficient of friction on this actor\r\n         */\r\n        this.friction = 0.99;\r\n        /**\r\n         * Should use global gravity [[Physics.gravity]] in it's physics simulation, default is true\r\n         */\r\n        this.useGravity = true;\r\n        /**\r\n         * Degrees of freedom to limit\r\n         */\r\n        this.limitDegreeOfFreedom = [];\r\n        /**\r\n         * The position of the actor last frame (x, y) in pixels\r\n         */\r\n        this.oldPos = new Vector(0, 0);\r\n        /**\r\n         * The velocity of the actor last frame (vx, vy) in pixels/second\r\n         */\r\n        this.oldVel = new Vector(0, 0);\r\n        /**\r\n         * Gets/sets the acceleration of the actor from the last frame. This does not include the global acc [[Physics.acc]].\r\n         */\r\n        this.oldAcc = Vector.Zero;\r\n        /**\r\n         * Gets/sets the rotation of the body from the last frame.\r\n         */\r\n        this.oldRotation = 0; // radians\r\n        /**\r\n         * The scale of the actor last frame\r\n         * @deprecated ex.Body.scale will be removed in v0.25.0\r\n         */\r\n        this.oldScale = Vector.One;\r\n        if (options) {\r\n            this.collisionType = (_a = options.type) !== null && _a !== void 0 ? _a : this.collisionType;\r\n            this.group = (_b = options.group) !== null && _b !== void 0 ? _b : this.group;\r\n            this.useGravity = (_c = options.useGravity) !== null && _c !== void 0 ? _c : this.useGravity;\r\n        }\r\n    }\r\n    /**\r\n     * The inverse mass (1/mass) of the body. If [[CollisionType.Fixed]] this is 0, meaning \"infinite\" mass\r\n     */\r\n    get inverseMass() {\r\n        return this.collisionType === CollisionType.Fixed ? 0 : 1 / this.mass;\r\n    }\r\n    /**\r\n     * Whether this body is sleeping or not\r\n     */\r\n    get sleeping() {\r\n        return this._sleeping;\r\n    }\r\n    /**\r\n     * Set the sleep state of the body\r\n     * @param sleeping\r\n     */\r\n    setSleeping(sleeping) {\r\n        this._sleeping = sleeping;\r\n        if (!sleeping) {\r\n            // Give it a kick to keep it from falling asleep immediately\r\n            this.sleepMotion = Physics.sleepEpsilon * 5;\r\n        }\r\n        else {\r\n            this.vel = Vector.Zero;\r\n            this.acc = Vector.Zero;\r\n            this.angularVelocity = 0;\r\n            this.sleepMotion = 0;\r\n        }\r\n    }\r\n    /**\r\n     * Update body's [[BodyComponent.sleepMotion]] for the purpose of sleeping\r\n     */\r\n    updateMotion() {\r\n        if (this._sleeping) {\r\n            this.setSleeping(true);\r\n        }\r\n        const currentMotion = this.vel.size * this.vel.size + Math.abs(this.angularVelocity * this.angularVelocity);\r\n        const bias = Physics.sleepBias;\r\n        this.sleepMotion = bias * this.sleepMotion + (1 - bias) * currentMotion;\r\n        this.sleepMotion = clamp(this.sleepMotion, 0, 10 * Physics.sleepEpsilon);\r\n        if (this.canSleep && this.sleepMotion < Physics.sleepEpsilon) {\r\n            this.setSleeping(true);\r\n        }\r\n    }\r\n    /**\r\n     * Get the moment of inertia from the [[ColliderComponent]]\r\n     */\r\n    get inertia() {\r\n        // Inertia is a property of the geometry, so this is a little goofy but seems to be okay?\r\n        const collider = this.owner.get(ColliderComponent);\r\n        if (collider === null || collider === void 0 ? void 0 : collider.get()) {\r\n            return collider.get().getInertia(this.mass);\r\n        }\r\n        return 0;\r\n    }\r\n    /**\r\n     * Get the inverse moment of inertial from the [[ColliderComponent]]. If [[CollisionType.Fixed]] this is 0, meaning \"infinite\" mass\r\n     */\r\n    get inverseInertia() {\r\n        return this.collisionType === CollisionType.Fixed ? 0 : 1 / this.inertia;\r\n    }\r\n    /**\r\n     * Returns if the owner is active\r\n     */\r\n    get active() {\r\n        var _a;\r\n        return !!((_a = this.owner) === null || _a === void 0 ? void 0 : _a.active);\r\n    }\r\n    get center() {\r\n        return this.pos;\r\n    }\r\n    get transform() {\r\n        var _a;\r\n        return (_a = this.owner) === null || _a === void 0 ? void 0 : _a.get(TransformComponent);\r\n    }\r\n    get motion() {\r\n        var _a;\r\n        return (_a = this.owner) === null || _a === void 0 ? void 0 : _a.get(MotionComponent);\r\n    }\r\n    /**\r\n     * The (x, y) position of the actor this will be in the middle of the actor if the\r\n     * [[Actor.anchor]] is set to (0.5, 0.5) which is default.\r\n     * If you want the (x, y) position to be the top left of the actor specify an anchor of (0, 0).\r\n     */\r\n    get pos() {\r\n        return this.transform.globalPos;\r\n    }\r\n    set pos(val) {\r\n        this.transform.globalPos = val;\r\n    }\r\n    /**\r\n     * The current velocity vector (vx, vy) of the actor in pixels/second\r\n     */\r\n    get vel() {\r\n        return this.motion.vel;\r\n    }\r\n    set vel(val) {\r\n        this.motion.vel = val;\r\n    }\r\n    /**\r\n     * The current acceleration vector (ax, ay) of the actor in pixels/second/second. An acceleration pointing down such as (0, 100) may\r\n     * be useful to simulate a gravitational effect.\r\n     */\r\n    get acc() {\r\n        return this.motion.acc;\r\n    }\r\n    set acc(val) {\r\n        this.motion.acc = val;\r\n    }\r\n    /**\r\n     * The current torque applied to the actor\r\n     */\r\n    get torque() {\r\n        return this.motion.torque;\r\n    }\r\n    set torque(val) {\r\n        this.motion.torque = val;\r\n    }\r\n    /**\r\n     * The rotation of the body in radians\r\n     */\r\n    get rotation() {\r\n        return this.transform.globalRotation;\r\n    }\r\n    set rotation(val) {\r\n        this.transform.globalRotation = val;\r\n    }\r\n    /**\r\n     * The scale vector of the actor\r\n     * @deprecated ex.Body.scale will be removed in v0.25.0, Use ex.Transform.scale\r\n     */\r\n    get scale() {\r\n        return this.transform.globalScale;\r\n    }\r\n    set scale(val) {\r\n        this.transform.globalScale = val;\r\n    }\r\n    /**\r\n     * The x scalar velocity of the actor in scale/second\r\n     * @deprecated ex.Body.scale will be removed in v0.25.0\r\n     */\r\n    get sx() {\r\n        return this.motion.scaleFactor.x;\r\n    }\r\n    set sx(xFactor) {\r\n        this.motion.scaleFactor.x = xFactor;\r\n    }\r\n    /**\r\n     * The y scalar velocity of the actor in scale/second\r\n     * @deprecated ex.Body.scale will be removed in v0.25.0\r\n     */\r\n    get sy() {\r\n        return this.motion.scaleFactor.y;\r\n    }\r\n    set sy(yFactor) {\r\n        this.motion.scaleFactor.y = yFactor;\r\n    }\r\n    /**\r\n     * The rotational velocity of the actor in radians/second\r\n     * @deprecated\r\n     */\r\n    get rx() {\r\n        return this.motion.angularVelocity;\r\n    }\r\n    /**\r\n     * The rotational velocity of the actor in radians/second\r\n     * @deprecated\r\n     */\r\n    set rx(value) {\r\n        this.motion.angularVelocity = value;\r\n    }\r\n    /**\r\n     * Get the angular velocity in radians/second\r\n     */\r\n    get angularVelocity() {\r\n        return this.motion.angularVelocity;\r\n    }\r\n    /**\r\n     * Set the angular velocity in radians/second\r\n     */\r\n    set angularVelocity(value) {\r\n        this.motion.angularVelocity = value;\r\n    }\r\n    /**\r\n     * Apply a specific impulse to the body\r\n     * @param point\r\n     * @param impulse\r\n     */\r\n    applyImpulse(point, impulse) {\r\n        if (this.collisionType !== CollisionType.Active) {\r\n            return; // only active objects participate in the simulation\r\n        }\r\n        const finalImpulse = impulse.scale(this.inverseMass);\r\n        if (this.limitDegreeOfFreedom.includes(DegreeOfFreedom.X)) {\r\n            finalImpulse.x = 0;\r\n        }\r\n        if (this.limitDegreeOfFreedom.includes(DegreeOfFreedom.Y)) {\r\n            finalImpulse.y = 0;\r\n        }\r\n        this.vel.addEqual(finalImpulse);\r\n        if (!this.limitDegreeOfFreedom.includes(DegreeOfFreedom.Rotation)) {\r\n            const distanceFromCenter = point.sub(this.pos);\r\n            this.angularVelocity += this.inverseInertia * distanceFromCenter.cross(impulse);\r\n        }\r\n    }\r\n    /**\r\n     * Apply only linear impulse to the body\r\n     * @param impulse\r\n     */\r\n    applyLinearImpulse(impulse) {\r\n        if (this.collisionType !== CollisionType.Active) {\r\n            return; // only active objects participate in the simulation\r\n        }\r\n        const finalImpulse = impulse.scale(this.inverseMass);\r\n        if (this.limitDegreeOfFreedom.includes(DegreeOfFreedom.X)) {\r\n            finalImpulse.x = 0;\r\n        }\r\n        if (this.limitDegreeOfFreedom.includes(DegreeOfFreedom.Y)) {\r\n            finalImpulse.y = 0;\r\n        }\r\n        this.vel = this.vel.add(finalImpulse);\r\n    }\r\n    /**\r\n     * Apply only angular impulse to the body\r\n     * @param point\r\n     * @param impulse\r\n     */\r\n    applyAngularImpulse(point, impulse) {\r\n        if (this.collisionType !== CollisionType.Active) {\r\n            return; // only active objects participate in the simulation\r\n        }\r\n        if (!this.limitDegreeOfFreedom.includes(DegreeOfFreedom.Rotation)) {\r\n            const distanceFromCenter = point.sub(this.pos);\r\n            this.angularVelocity += this.inverseInertia * distanceFromCenter.cross(impulse);\r\n        }\r\n    }\r\n    /**\r\n     * Sets the old versions of pos, vel, acc, and scale.\r\n     */\r\n    captureOldTransform() {\r\n        // Capture old values before integration step updates them\r\n        this.oldVel.setTo(this.vel.x, this.vel.y);\r\n        this.oldPos.setTo(this.pos.x, this.pos.y);\r\n        this.oldAcc.setTo(this.acc.x, this.acc.y);\r\n        this.oldScale.setTo(this.scale.x, this.scale.y);\r\n        this.oldRotation = this.rotation;\r\n    }\r\n    /**\r\n     * @deprecated signature will change in v0.26.0\r\n     * @param _ctx\r\n     */\r\n    debugDraw(_ctx) {\r\n        // pass\r\n    }\r\n}\r\nBodyComponent._ID = 0;\r\n\n;// CONCATENATED MODULE: ./Util/CullingBox.ts\n\r\n\r\n/**\r\n * @deprecated Will be removed in 0.26.0\r\n */\r\nclass CullingBox {\r\n    constructor() {\r\n        this._topLeft = new Vector(0, 0);\r\n        this._topRight = new Vector(0, 0);\r\n        this._bottomLeft = new Vector(0, 0);\r\n        this._bottomRight = new Vector(0, 0);\r\n    }\r\n    isSpriteOffScreen(actor, engine) {\r\n        const drawingWidth = actor.currentDrawing.drawWidth;\r\n        const drawingHeight = actor.currentDrawing.drawHeight;\r\n        const rotation = actor.rotation;\r\n        const anchor = actor.center;\r\n        const worldPos = actor.getGlobalPos();\r\n        this._topLeft = vec(worldPos.x - drawingWidth / 2, worldPos.y - drawingHeight / 2);\r\n        this._topLeft = this._topLeft.rotate(rotation, anchor);\r\n        this._topRight = vec(worldPos.x + drawingWidth / 2, worldPos.y - drawingHeight / 2);\r\n        this._topRight = this._topRight.rotate(rotation, anchor);\r\n        this._bottomLeft = vec(worldPos.x - drawingWidth / 2, worldPos.y + drawingHeight / 2);\r\n        this._bottomLeft = this._bottomLeft.rotate(rotation, anchor);\r\n        this._bottomRight = vec(worldPos.x + drawingWidth / 2, worldPos.y + drawingHeight / 2);\r\n        this._bottomRight = this._bottomRight.rotate(rotation, anchor);\r\n        const topLeftScreen = engine.worldToScreenCoordinates(this._topLeft);\r\n        const topRightScreen = engine.worldToScreenCoordinates(this._topRight);\r\n        const bottomLeftScreen = engine.worldToScreenCoordinates(this._bottomLeft);\r\n        const bottomRightScreen = engine.worldToScreenCoordinates(this._bottomRight);\r\n        this._xCoords = [];\r\n        this._yCoords = [];\r\n        this._xCoords.push(topLeftScreen.x, topRightScreen.x, bottomLeftScreen.x, bottomRightScreen.x);\r\n        this._yCoords.push(topLeftScreen.y, topRightScreen.y, bottomLeftScreen.y, bottomRightScreen.y);\r\n        this._xMin = Math.min.apply(null, this._xCoords);\r\n        this._yMin = Math.min.apply(null, this._yCoords);\r\n        this._xMax = Math.max.apply(null, this._xCoords);\r\n        this._yMax = Math.max.apply(null, this._yCoords);\r\n        const minWorld = engine.screenToWorldCoordinates(new Vector(this._xMin, this._yMin));\r\n        const maxWorld = engine.screenToWorldCoordinates(new Vector(this._xMax, this._yMax));\r\n        this._xMinWorld = minWorld.x;\r\n        this._yMinWorld = minWorld.y;\r\n        this._xMaxWorld = maxWorld.x;\r\n        this._yMaxWorld = maxWorld.y;\r\n        const boundingPoints = [\r\n            new Vector(this._xMin, this._yMin),\r\n            new Vector(this._xMax, this._yMin),\r\n            new Vector(this._xMin, this._yMax),\r\n            new Vector(this._xMax, this._yMax) // bottom right\r\n        ];\r\n        // sprite can be wider than canvas screen (and still visible within canvas)\r\n        // top or bottom of sprite must be within canvas\r\n        if (boundingPoints[0].x < 0 &&\r\n            boundingPoints[1].x > engine.canvas.clientWidth &&\r\n            (boundingPoints[0].y > 0 || boundingPoints[2].y < engine.canvas.clientHeight)) {\r\n            return false;\r\n        }\r\n        // sprite can be taller than canvas screen (and still visible within canvas)\r\n        // left or right of sprite must be within canvas\r\n        if (boundingPoints[0].y < 0 &&\r\n            boundingPoints[2].y > engine.canvas.clientHeight &&\r\n            (boundingPoints[1].x > 0 || boundingPoints[0].x < engine.canvas.clientWidth)) {\r\n            return false;\r\n        }\r\n        // otherwise if any corner is visible, we're not offscreen\r\n        for (let i = 0; i < boundingPoints.length; i++) {\r\n            if (boundingPoints[i].x > 0 &&\r\n                boundingPoints[i].y > 0 &&\r\n                boundingPoints[i].x < engine.canvas.clientWidth &&\r\n                boundingPoints[i].y < engine.canvas.clientHeight) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n    debugDraw(ctx) {\r\n        // bounding rectangle\r\n        ctx.beginPath();\r\n        ctx.strokeStyle = Color.White.toString();\r\n        ctx.rect(this._xMinWorld, this._yMinWorld, this._xMaxWorld - this._xMinWorld, this._yMaxWorld - this._yMinWorld);\r\n        ctx.stroke();\r\n        ctx.fillStyle = Color.Red.toString();\r\n        ctx.beginPath();\r\n        ctx.arc(this._topLeft.x, this._topLeft.y, 5, 0, Math.PI * 2);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n        ctx.fillStyle = Color.Green.toString();\r\n        ctx.beginPath();\r\n        ctx.arc(this._topRight.x, this._topRight.y, 5, 0, Math.PI * 2);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n        ctx.fillStyle = Color.Blue.toString();\r\n        ctx.beginPath();\r\n        ctx.arc(this._bottomLeft.x, this._bottomLeft.y, 5, 0, Math.PI * 2);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n        ctx.fillStyle = Color.Magenta.toString();\r\n        ctx.beginPath();\r\n        ctx.arc(this._bottomRight.x, this._bottomRight.y, 5, 0, Math.PI * 2);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Traits/OffscreenCulling.ts\n\r\n\r\n\r\n/**\r\n * @deprecated will be removed in 0.26.0\r\n */\r\nclass OffscreenCulling {\r\n    constructor() {\r\n        this.cullingBox = new CullingBox();\r\n    }\r\n    update(actor, engine) {\r\n        const events = actor.eventDispatcher;\r\n        let isSpriteOffScreen = true;\r\n        if (actor.currentDrawing != null) {\r\n            isSpriteOffScreen = this.cullingBox.isSpriteOffScreen(actor, engine);\r\n        }\r\n        let actorBoundsOffscreen = false;\r\n        if (engine && engine.currentScene && engine.currentScene.camera && engine.currentScene.camera.viewport && !actor.parent) {\r\n            actorBoundsOffscreen = !engine.currentScene.camera.viewport.intersect(actor.collider.bounds);\r\n        }\r\n        if (!actor.isOffScreen) {\r\n            if (actorBoundsOffscreen && isSpriteOffScreen) {\r\n                events.emit('exitviewport', new ExitViewPortEvent(actor));\r\n                actor.addComponent(new TagComponent('offscreen'));\r\n            }\r\n        }\r\n        else {\r\n            if (!actorBoundsOffscreen || !isSpriteOffScreen) {\r\n                events.emit('enterviewport', new EnterViewPortEvent(actor));\r\n                actor.removeComponent('offscreen');\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/Entity.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * AddedComponent message\r\n */\r\nclass AddedComponent {\r\n    constructor(data) {\r\n        this.data = data;\r\n        this.type = 'Component Added';\r\n    }\r\n}\r\n/**\r\n * Type guard to know if message is f an Added Component\r\n */\r\nfunction isAddedComponent(x) {\r\n    return !!x && x.type === 'Component Added';\r\n}\r\n/**\r\n * RemovedComponent message\r\n */\r\nclass RemovedComponent {\r\n    constructor(data) {\r\n        this.data = data;\r\n        this.type = 'Component Removed';\r\n    }\r\n}\r\n/**\r\n * Type guard to know if message is for a Removed Component\r\n */\r\nfunction isRemovedComponent(x) {\r\n    return !!x && x.type === 'Component Removed';\r\n}\r\n/**\r\n * An Entity is the base type of anything that can have behavior in Excalibur, they are part of the built in entity component system\r\n *\r\n * Entities can be strongly typed with the components they contain\r\n *\r\n * ```typescript\r\n * const entity = new Entity<ComponentA | ComponentB>();\r\n * entity.components.a; // Type ComponentA\r\n * entity.components.b; // Type ComponentB\r\n * ```\r\n */\r\nclass Entity extends Class {\r\n    constructor(components, name) {\r\n        super();\r\n        /**\r\n         * The unique identifier for the entity\r\n         */\r\n        this.id = Entity._ID++;\r\n        this._name = 'anonymous';\r\n        /**\r\n         * Whether this entity is active, if set to false it will be reclaimed\r\n         */\r\n        this.active = true;\r\n        /**\r\n         * Bucket to hold on to deferred removals\r\n         */\r\n        this._componentsToRemove = [];\r\n        this._componentTypeToInstance = new Map();\r\n        this._componentStringToInstance = new Map();\r\n        this._tagsMemo = [];\r\n        this._typesMemo = [];\r\n        /**\r\n         * Observable that keeps track of component add or remove changes on the entity\r\n         */\r\n        this.componentAdded$ = new Observable();\r\n        this.componentRemoved$ = new Observable();\r\n        this._parent = null;\r\n        this.childrenAdded$ = new Observable();\r\n        this.childrenRemoved$ = new Observable();\r\n        this._children = [];\r\n        this._isInitialized = false;\r\n        this._setName(name);\r\n        if (components) {\r\n            for (const component of components) {\r\n                this.addComponent(component);\r\n            }\r\n        }\r\n    }\r\n    _setName(name) {\r\n        if (name) {\r\n            this._name = name;\r\n        }\r\n    }\r\n    get name() {\r\n        return this._name;\r\n    }\r\n    get events() {\r\n        return this.eventDispatcher;\r\n    }\r\n    /**\r\n     * Kill the entity, means it will no longer be updated. Kills are deferred to the end of the update.\r\n     */\r\n    kill() {\r\n        this.active = false;\r\n    }\r\n    isKilled() {\r\n        return !this.active;\r\n    }\r\n    /**\r\n     * Specifically get the tags on the entity from [[TagComponent]]\r\n     */\r\n    get tags() {\r\n        return this._tagsMemo;\r\n    }\r\n    /**\r\n     * Check if a tag exists on the entity\r\n     * @param tag name to check for\r\n     */\r\n    hasTag(tag) {\r\n        return this.tags.includes(tag);\r\n    }\r\n    /**\r\n     * Adds a tag to an entity\r\n     * @param tag\r\n     * @returns Entity\r\n     */\r\n    addTag(tag) {\r\n        return this.addComponent(new TagComponent(tag));\r\n    }\r\n    /**\r\n     * Removes a tag on the entity\r\n     *\r\n     * Removals are deferred until the end of update\r\n     * @param tag\r\n     * @param force Remove component immediately, no deferred\r\n     */\r\n    removeTag(tag, force = false) {\r\n        return this.removeComponent(tag, force);\r\n    }\r\n    /**\r\n     * The types of the components on the Entity\r\n     */\r\n    get types() {\r\n        return this._typesMemo;\r\n    }\r\n    _rebuildMemos() {\r\n        this._tagsMemo = Array.from(this._componentStringToInstance.values())\r\n            .filter((c) => c instanceof TagComponent)\r\n            .map((c) => c.type);\r\n        this._typesMemo = Array.from(this._componentStringToInstance.keys());\r\n    }\r\n    getComponents() {\r\n        return Array.from(this._componentStringToInstance.values());\r\n    }\r\n    _notifyAddComponent(component) {\r\n        this._rebuildMemos();\r\n        const added = new AddedComponent({\r\n            component,\r\n            entity: this\r\n        });\r\n        this.componentAdded$.notifyAll(added);\r\n    }\r\n    _notifyRemoveComponent(component) {\r\n        const removed = new RemovedComponent({\r\n            component,\r\n            entity: this\r\n        });\r\n        this.componentRemoved$.notifyAll(removed);\r\n        this._rebuildMemos();\r\n    }\r\n    get parent() {\r\n        return this._parent;\r\n    }\r\n    /**\r\n     * Get the direct children of this entity\r\n     */\r\n    get children() {\r\n        return this._children;\r\n    }\r\n    /**\r\n     * Unparents this entity, if there is a parent. Otherwise it does nothing.\r\n     */\r\n    unparent() {\r\n        if (this._parent) {\r\n            this._parent.removeChild(this);\r\n            this._parent = null;\r\n        }\r\n    }\r\n    /**\r\n     * Adds an entity to be a child of this entity\r\n     * @param entity\r\n     */\r\n    addChild(entity) {\r\n        if (entity.parent === null) {\r\n            if (this.getAncestors().includes(entity)) {\r\n                throw new Error('Cycle detected, cannot add entity');\r\n            }\r\n            this._children.push(entity);\r\n            entity._parent = this;\r\n            this.childrenAdded$.notifyAll(entity);\r\n        }\r\n        else {\r\n            throw new Error('Entity already has a parent, cannot add without unparenting');\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Remove an entity from children if it exists\r\n     * @param entity\r\n     */\r\n    removeChild(entity) {\r\n        if (entity.parent === this) {\r\n            removeItemFromArray(entity, this._children);\r\n            entity._parent = null;\r\n            this.childrenRemoved$.notifyAll(entity);\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Removes all children from this entity\r\n     */\r\n    removeAllChildren() {\r\n        this.children.forEach((c) => {\r\n            this.removeChild(c);\r\n        });\r\n        return this;\r\n    }\r\n    /**\r\n     * Returns a list of parent entities starting with the topmost parent. Includes the current entity.\r\n     */\r\n    getAncestors() {\r\n        const result = [this];\r\n        let current = this.parent;\r\n        while (current) {\r\n            result.push(current);\r\n            current = current.parent;\r\n        }\r\n        return result.reverse();\r\n    }\r\n    /**\r\n     * Returns a list of all the entities that descend from this entity. Includes the current entity.\r\n     */\r\n    getDescendants() {\r\n        let result = [this];\r\n        let queue = [this];\r\n        while (queue.length > 0) {\r\n            const curr = queue.pop();\r\n            queue = queue.concat(curr.children);\r\n            result = result.concat(curr.children);\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Creates a deep copy of the entity and a copy of all its components\r\n     */\r\n    clone() {\r\n        const newEntity = new Entity();\r\n        for (const c of this.types) {\r\n            newEntity.addComponent(this.get(c).clone());\r\n        }\r\n        for (const child of this.children) {\r\n            newEntity.addChild(child.clone());\r\n        }\r\n        return newEntity;\r\n    }\r\n    /**\r\n     * Adds a copy of all the components from another template entity as a \"prefab\"\r\n     * @param templateEntity Entity to use as a template\r\n     * @param force Force component replacement if it already exists on the target entity\r\n     */\r\n    addTemplate(templateEntity, force = false) {\r\n        for (const c of templateEntity.getComponents()) {\r\n            this.addComponent(c.clone(), force);\r\n        }\r\n        for (const child of templateEntity.children) {\r\n            this.addChild(child.clone().addTemplate(child));\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Adds a component to the entity\r\n     * @param component Component or Entity to add copy of components from\r\n     * @param force Optionally overwrite any existing components of the same type\r\n     */\r\n    addComponent(component, force = false) {\r\n        // if component already exists, skip if not forced\r\n        if (this.has(component.type)) {\r\n            if (force) {\r\n                // Remove existing component type if exists when forced\r\n                this.removeComponent(component);\r\n            }\r\n            else {\r\n                // early exit component exits\r\n                return this;\r\n            }\r\n        }\r\n        // TODO circular dependencies will be a problem\r\n        if (component.dependencies && component.dependencies.length) {\r\n            for (const ctor of component.dependencies) {\r\n                this.addComponent(new ctor());\r\n            }\r\n        }\r\n        component.owner = this;\r\n        const constuctorType = component.constructor;\r\n        this._componentTypeToInstance.set(constuctorType, component);\r\n        this._componentStringToInstance.set(component.type, component);\r\n        if (component.onAdd) {\r\n            component.onAdd(this);\r\n        }\r\n        this._notifyAddComponent(component);\r\n        return this;\r\n    }\r\n    /**\r\n     * Removes a component from the entity, by default removals are deferred to the end of entity update to avoid consistency issues\r\n     *\r\n     * Components can be force removed with the `force` flag, the removal is not deferred and happens immediately\r\n     * @param componentOrType\r\n     * @param force\r\n     */\r\n    removeComponent(componentOrType, force = false) {\r\n        if (force) {\r\n            if (typeof componentOrType === 'string') {\r\n                this._removeComponentByType(componentOrType);\r\n            }\r\n            else if (componentOrType instanceof Component) {\r\n                this._removeComponentByType(componentOrType.type);\r\n            }\r\n        }\r\n        else {\r\n            this._componentsToRemove.push(componentOrType);\r\n        }\r\n        return this;\r\n    }\r\n    _removeComponentByType(type) {\r\n        if (this.has(type)) {\r\n            const component = this.get(type);\r\n            component.owner = null;\r\n            if (component.onRemove) {\r\n                component.onRemove(this);\r\n            }\r\n            const ctor = component.constructor;\r\n            this._componentTypeToInstance.delete(ctor);\r\n            this._componentStringToInstance.delete(component.type);\r\n            this._notifyRemoveComponent(component);\r\n        }\r\n    }\r\n    /**\r\n     * @hidden\r\n     * @internal\r\n     */\r\n    processComponentRemoval() {\r\n        for (const componentOrType of this._componentsToRemove) {\r\n            const type = typeof componentOrType === 'string' ? componentOrType : componentOrType.type;\r\n            this._removeComponentByType(type);\r\n        }\r\n        this._componentsToRemove.length = 0;\r\n    }\r\n    has(type) {\r\n        if (typeof type === 'string') {\r\n            return this._componentStringToInstance.has(type);\r\n        }\r\n        else {\r\n            return this._componentTypeToInstance.has(type);\r\n        }\r\n    }\r\n    get(type) {\r\n        if (typeof type === 'string') {\r\n            return this._componentStringToInstance.get(type);\r\n        }\r\n        else {\r\n            return this._componentTypeToInstance.get(type);\r\n        }\r\n    }\r\n    /**\r\n     * Gets whether the actor is Initialized\r\n     */\r\n    get isInitialized() {\r\n        return this._isInitialized;\r\n    }\r\n    /**\r\n     * Initializes this entity, meant to be called by the Scene before first update not by users of Excalibur.\r\n     *\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * @internal\r\n     */\r\n    _initialize(engine) {\r\n        if (!this.isInitialized) {\r\n            this.onInitialize(engine);\r\n            super.emit('initialize', new InitializeEvent(engine, this));\r\n            this._isInitialized = true;\r\n        }\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPreUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _preupdate(engine, delta) {\r\n        this.emit('preupdate', new PreUpdateEvent(engine, delta, this));\r\n        this.onPreUpdate(engine, delta);\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPostUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _postupdate(engine, delta) {\r\n        this.emit('postupdate', new PostUpdateEvent(engine, delta, this));\r\n        this.onPostUpdate(engine, delta);\r\n    }\r\n    /**\r\n     * `onInitialize` is called before the first update of the entity. This method is meant to be\r\n     * overridden.\r\n     *\r\n     * Synonymous with the event handler `.on('initialize', (evt) => {...})`\r\n     */\r\n    onInitialize(_engine) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * Safe to override onPreUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPreUpdate` is called directly before an entity is updated.\r\n     */\r\n    onPreUpdate(_engine, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('postupdate', (evt) =>{...})`\r\n     *\r\n     * `onPostUpdate` is called directly after an entity is updated.\r\n     */\r\n    onPostUpdate(_engine, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     *\r\n     * Entity update lifecycle, called internally\r\n     *\r\n     * @internal\r\n     * @param engine\r\n     * @param delta\r\n     */\r\n    update(engine, delta) {\r\n        this._initialize(engine);\r\n        this._preupdate(engine, delta);\r\n        for (const child of this.children) {\r\n            child.update(engine, delta);\r\n        }\r\n        this._postupdate(engine, delta);\r\n    }\r\n}\r\nEntity._ID = 0;\r\n\n;// CONCATENATED MODULE: ./Drawing/CanvasDrawComponent.ts\n\r\n/**\r\n * Shim to draw to the canvas when in LegacyDrawing mode\r\n * @deprecated\r\n */\r\nclass CanvasDrawComponent extends Component {\r\n    constructor(draw) {\r\n        var _a;\r\n        super();\r\n        this.draw = draw;\r\n        this.type = 'ex.canvas';\r\n        // eslint-disable-next-line @typescript-eslint/no-empty-function\r\n        this.draw = (_a = this.draw) !== null && _a !== void 0 ? _a : (() => { });\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/GraphicsComponent.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Type guard for checking if a Graphic HasTick (used for graphics that change over time like animations)\r\n * @param graphic\r\n */\r\nfunction hasGraphicsTick(graphic) {\r\n    return !!graphic.tick;\r\n}\r\nclass GraphicsLayer {\r\n    constructor(_options, _graphics) {\r\n        this._options = _options;\r\n        this._graphics = _graphics;\r\n        this.graphics = [];\r\n    }\r\n    get name() {\r\n        return this._options.name;\r\n    }\r\n    hide(nameOrGraphic) {\r\n        if (!nameOrGraphic) {\r\n            this.graphics.length = 0;\r\n        }\r\n        else {\r\n            let gfx = null;\r\n            if (nameOrGraphic instanceof Graphic) {\r\n                gfx = nameOrGraphic;\r\n            }\r\n            else {\r\n                gfx = this._graphics.getGraphic(nameOrGraphic);\r\n            }\r\n            this.graphics = this.graphics.filter((g) => g.graphic !== gfx);\r\n        }\r\n    }\r\n    /**\r\n     * Show a graphic by name or instance at an offset, graphics are shown in the order in which `show()` is called.\r\n     *\r\n     * If `show()` is called multiple times for the same graphic it will be shown multiple times.\r\n     * @param nameOrGraphic\r\n     * @param options\r\n     */\r\n    show(nameOrGraphic, options) {\r\n        options = { ...options };\r\n        let gfx;\r\n        if (nameOrGraphic instanceof Graphic) {\r\n            gfx = this._graphics.copyGraphics ? nameOrGraphic.clone() : nameOrGraphic;\r\n        }\r\n        else {\r\n            gfx = this._graphics.getGraphic(nameOrGraphic);\r\n            if (!gfx) {\r\n                Logger.getInstance().error(`No such graphic added to component named ${nameOrGraphic}. These named graphics are available: `, this._graphics.getNames());\r\n            }\r\n        }\r\n        if (gfx) {\r\n            this.graphics.push({ graphic: gfx, options });\r\n            return gfx;\r\n        }\r\n        else {\r\n            return null;\r\n        }\r\n    }\r\n    /**\r\n     * Use a specific graphic, swap out any current graphics being shown\r\n     * @param nameOrGraphic\r\n     * @param options\r\n     */\r\n    use(nameOrGraphic, options) {\r\n        options = { ...options };\r\n        this.hide();\r\n        return this.show(nameOrGraphic, options);\r\n    }\r\n    /**\r\n     * Current order of the layer, higher numbers are on top, lower numbers are on the bottom.\r\n     *\r\n     * For example a layer with `order = -1` would be under a layer of `order = 1`\r\n     */\r\n    get order() {\r\n        return this._options.order;\r\n    }\r\n    /**\r\n     * Set the order of the layer, higher numbers are on top, lower numbers are on the bottom.\r\n     *\r\n     * For example a layer with `order = -1` would be under a layer of `order = 1`\r\n     */\r\n    set order(order) {\r\n        this._options.order = order;\r\n    }\r\n    /**\r\n     * Get or set the pixel offset from the layer anchor for all graphics in the layer\r\n     */\r\n    get offset() {\r\n        var _a;\r\n        return (_a = this._options.offset) !== null && _a !== void 0 ? _a : Vector.Zero;\r\n    }\r\n    set offset(value) {\r\n        this._options.offset = value;\r\n    }\r\n    get currentKeys() {\r\n        var _a;\r\n        return (_a = this.name) !== null && _a !== void 0 ? _a : 'anonymous';\r\n    }\r\n}\r\nclass GraphicsLayers {\r\n    constructor(_component) {\r\n        this._component = _component;\r\n        this._layers = [];\r\n        this._layerMap = {};\r\n        this.default = new GraphicsLayer({ name: 'default', order: 0 }, _component);\r\n        this._maybeAddLayer(this.default);\r\n    }\r\n    create(options) {\r\n        const layer = new GraphicsLayer(options, this._component);\r\n        return this._maybeAddLayer(layer);\r\n    }\r\n    get(name) {\r\n        if (name) {\r\n            return this._getLayer(name);\r\n        }\r\n        return this._layers;\r\n    }\r\n    currentKeys() {\r\n        const graphicsLayerKeys = [];\r\n        for (const layer of this._layers) {\r\n            graphicsLayerKeys.push(layer.currentKeys);\r\n        }\r\n        return graphicsLayerKeys;\r\n    }\r\n    has(name) {\r\n        return name in this._layerMap;\r\n    }\r\n    _maybeAddLayer(layer) {\r\n        if (this._layerMap[layer.name]) {\r\n            // todo log warning\r\n            return this._layerMap[layer.name];\r\n        }\r\n        this._layerMap[layer.name] = layer;\r\n        this._layers.push(layer);\r\n        this._layers.sort((a, b) => a.order - b.order);\r\n        return layer;\r\n    }\r\n    _getLayer(name) {\r\n        return this._layerMap[name];\r\n    }\r\n}\r\n/**\r\n * Component to manage drawings, using with the position component\r\n */\r\nclass GraphicsComponent extends Component {\r\n    constructor(options) {\r\n        super();\r\n        this.type = 'ex.graphics';\r\n        this._graphics = {};\r\n        /**\r\n         * Sets or gets wether any drawing should be visible in this component\r\n         */\r\n        this.visible = true;\r\n        /**\r\n         * Sets or gets wither all drawings should have an opacity applied\r\n         */\r\n        this.opacity = 1;\r\n        /**\r\n         * Offset to apply to graphics by default\r\n         */\r\n        this.offset = Vector.Zero;\r\n        /**\r\n         * Anchor to apply to graphics by default\r\n         */\r\n        this.anchor = Vector.Half;\r\n        /**\r\n         * If set to true graphics added to the component will be copied. This can affect performance\r\n         */\r\n        this.copyGraphics = false;\r\n        this._bounds = null;\r\n        // Defaults\r\n        options = {\r\n            visible: this.visible,\r\n            ...options\r\n        };\r\n        const { current, anchor, opacity, visible, graphics, offset, copyGraphics, onPreDraw, onPostDraw } = options;\r\n        this._graphics = graphics || {};\r\n        this.offset = offset !== null && offset !== void 0 ? offset : this.offset;\r\n        this.opacity = opacity !== null && opacity !== void 0 ? opacity : this.opacity;\r\n        this.anchor = anchor !== null && anchor !== void 0 ? anchor : this.anchor;\r\n        this.copyGraphics = copyGraphics !== null && copyGraphics !== void 0 ? copyGraphics : this.copyGraphics;\r\n        this.onPreDraw = onPreDraw !== null && onPreDraw !== void 0 ? onPreDraw : this.onPreDraw;\r\n        this.onPostDraw = onPostDraw !== null && onPostDraw !== void 0 ? onPostDraw : this.onPostDraw;\r\n        this.visible = !!visible;\r\n        this.layers = new GraphicsLayers(this);\r\n        if (current && this._graphics[current]) {\r\n            this.show(this._graphics[current]);\r\n        }\r\n    }\r\n    getGraphic(name) {\r\n        return this._graphics[name];\r\n    }\r\n    /**\r\n     * Get registered graphics names\r\n     */\r\n    getNames() {\r\n        return Object.keys(this._graphics);\r\n    }\r\n    /**\r\n     * Returns the currently displayed graphics and their offsets, empty array if hidden\r\n     */\r\n    get current() {\r\n        return this.layers.default.graphics;\r\n    }\r\n    /**\r\n     * Returns all graphics associated with this component\r\n     */\r\n    get graphics() {\r\n        return this._graphics;\r\n    }\r\n    add(nameOrGraphic, graphic) {\r\n        let name = 'default';\r\n        let graphicToSet = null;\r\n        if (typeof nameOrGraphic === 'string') {\r\n            name = nameOrGraphic;\r\n            graphicToSet = graphic;\r\n        }\r\n        else {\r\n            graphicToSet = nameOrGraphic;\r\n        }\r\n        this._graphics[name] = this.copyGraphics ? graphicToSet.clone() : graphicToSet;\r\n        if (name === 'default') {\r\n            this.show('default');\r\n        }\r\n        return graphicToSet;\r\n    }\r\n    /**\r\n     * Show a graphic by name on the **default** layer, returns the new [[Graphic]]\r\n     */\r\n    show(nameOrGraphic, options) {\r\n        return this.layers.default.show(nameOrGraphic, options);\r\n    }\r\n    /**\r\n     * Use a graphic only, swap out any graphics on the **default** layer, returns the new [[Graphic]]\r\n     * @param nameOrGraphic\r\n     * @param options\r\n     */\r\n    use(nameOrGraphic, options) {\r\n        return this.layers.default.use(nameOrGraphic, options);\r\n    }\r\n    hide(nameOrGraphic) {\r\n        this.layers.default.hide(nameOrGraphic);\r\n    }\r\n    set localBounds(bounds) {\r\n        this._bounds = bounds;\r\n    }\r\n    get localBounds() {\r\n        if (this._bounds) {\r\n            return this._bounds;\r\n        }\r\n        let bb = new BoundingBox();\r\n        for (const layer of this.layers.get()) {\r\n            for (const { graphic, options } of layer.graphics) {\r\n                let anchor = this.anchor;\r\n                let offset = this.offset;\r\n                if (options === null || options === void 0 ? void 0 : options.anchor) {\r\n                    anchor = options.anchor;\r\n                }\r\n                if (options === null || options === void 0 ? void 0 : options.offset) {\r\n                    offset = options.offset;\r\n                }\r\n                const bounds = graphic.localBounds;\r\n                const offsetX = -bounds.width * anchor.x + offset.x;\r\n                const offsetY = -bounds.height * anchor.y + offset.y;\r\n                bb = graphic === null || graphic === void 0 ? void 0 : graphic.localBounds.translate(vec(offsetX + layer.offset.x, offsetY + layer.offset.y)).combine(bb);\r\n            }\r\n        }\r\n        return bb;\r\n    }\r\n    /**\r\n     * Update underlying graphics if necesary, called internally\r\n     * @param elapsed\r\n     * @internal\r\n     */\r\n    update(elapsed, idempotencyToken = 0) {\r\n        for (const layer of this.layers.get()) {\r\n            for (const { graphic } of layer.graphics) {\r\n                if (hasGraphicsTick(graphic)) {\r\n                    graphic === null || graphic === void 0 ? void 0 : graphic.tick(elapsed, idempotencyToken);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Rectangle.ts\n\r\n/**\r\n * A Rectangle [[Graphic]] for drawing rectangles to the [[ExcaliburGraphicsContext]]\r\n */\r\nclass Rectangle extends Raster {\r\n    constructor(options) {\r\n        super(options);\r\n        this.width = options.width;\r\n        this.height = options.height;\r\n        this.rasterize();\r\n    }\r\n    clone() {\r\n        return new Rectangle({\r\n            width: this.width,\r\n            height: this.height,\r\n            ...this.cloneGraphicOptions(),\r\n            ...this.cloneRasterOptions()\r\n        });\r\n    }\r\n    execute(ctx) {\r\n        if (this.color) {\r\n            ctx.fillRect(0, 0, this.width, this.height);\r\n        }\r\n        if (this.strokeColor) {\r\n            ctx.strokeRect(0, 0, this.width, this.height);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Circle.ts\n\r\n\r\n/**\r\n * A circle [[Graphic]] for drawing circles to the [[ExcaliburGraphicsContext]]\r\n *\r\n * Circles default to [[ImageFiltering.Blended]]\r\n */\r\nclass Circle extends Raster {\r\n    constructor(options) {\r\n        var _a, _b;\r\n        super(options);\r\n        this._radius = 0;\r\n        this.padding = (_a = options.padding) !== null && _a !== void 0 ? _a : 2; // default 2 padding for circles looks nice\r\n        this.radius = options.radius;\r\n        this.filtering = (_b = options.filtering) !== null && _b !== void 0 ? _b : ImageFiltering.Blended;\r\n        this.rasterize();\r\n    }\r\n    get radius() {\r\n        return this._radius;\r\n    }\r\n    set radius(value) {\r\n        this._radius = value;\r\n        this.width = this._radius * 2;\r\n        this.height = this._radius * 2;\r\n        this.flagDirty();\r\n    }\r\n    clone() {\r\n        return new Circle({\r\n            radius: this.radius,\r\n            ...this.cloneGraphicOptions(),\r\n            ...this.cloneRasterOptions()\r\n        });\r\n    }\r\n    execute(ctx) {\r\n        if (this.radius > 0) {\r\n            ctx.beginPath();\r\n            ctx.arc(this.radius, this.radius, this.radius, 0, Math.PI * 2);\r\n            if (this.color) {\r\n                ctx.fill();\r\n            }\r\n            if (this.strokeColor) {\r\n                ctx.stroke();\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Input/PointerComponent.ts\n\r\n/**\r\n * Add this component to optionally configure how the pointer\r\n * system detects pointer events.\r\n *\r\n * By default the collider shape is used and graphics bounds is not.\r\n *\r\n * If both collider shape and graphics bounds are enabled it will fire events if either or\r\n * are intersecting the pointer.\r\n */\r\nclass PointerComponent extends Component {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.type = 'ex.pointer';\r\n        /**\r\n         * Use any existing Collider component geometry for pointer events. This is useful if you want\r\n         * user pointer events only to trigger on the same collision geometry used in the collider component\r\n         * for collision resolution. Default is `true`.\r\n         */\r\n        this.useColliderShape = true;\r\n        /**\r\n         * Use any existing Graphics component bounds for pointers. This is useful if you want the axis aligned\r\n         * bounds around the graphic to trigger pointer events. Default is `false`.\r\n         */\r\n        this.useGraphicsBounds = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/EasingFunctions.ts\nvar EasingFunctions_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\n\r\n/**\r\n * Standard easing functions for motion in Excalibur, defined on a domain of [0, duration] and a range from [+startValue,+endValue]\r\n * Given a time, the function will return a value from positive startValue to positive endValue.\r\n *\r\n * ```js\r\n * function Linear (t) {\r\n *    return t * t;\r\n * }\r\n *\r\n * // accelerating from zero velocity\r\n * function EaseInQuad (t) {\r\n *    return t * t;\r\n * }\r\n *\r\n * // decelerating to zero velocity\r\n * function EaseOutQuad (t) {\r\n *    return t * (2 - t);\r\n * }\r\n *\r\n * // acceleration until halfway, then deceleration\r\n * function EaseInOutQuad (t) {\r\n *    return t < .5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\r\n * }\r\n *\r\n * // accelerating from zero velocity\r\n * function EaseInCubic (t) {\r\n *    return t * t * t;\r\n * }\r\n *\r\n * // decelerating to zero velocity\r\n * function EaseOutCubic (t) {\r\n *    return (--t) * t * t + 1;\r\n * }\r\n *\r\n * // acceleration until halfway, then deceleration\r\n * function EaseInOutCubic (t) {\r\n *    return t < .5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1;\r\n * }\r\n * ```\r\n */\r\nclass EasingFunctions {\r\n    static CreateReversibleEasingFunction(easing) {\r\n        return (time, start, end, duration) => {\r\n            if (end < start) {\r\n                return start - (easing(time, end, start, duration) - end);\r\n            }\r\n            else {\r\n                return easing(time, start, end, duration);\r\n            }\r\n        };\r\n    }\r\n    static CreateReversableEasingFunction(easing) {\r\n        return EasingFunctions.CreateReversibleEasingFunction(easing);\r\n    }\r\n    static CreateVectorEasingFunction(easing) {\r\n        return (time, start, end, duration) => {\r\n            return new Vector(easing(time, start.x, end.x, duration), easing(time, start.y, end.y, duration));\r\n        };\r\n    }\r\n}\r\nEasingFunctions.Linear = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\r\n    endValue = endValue - startValue;\r\n    return (endValue * currentTime) / duration + startValue;\r\n});\r\nEasingFunctions.EaseInQuad = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\r\n    endValue = endValue - startValue;\r\n    currentTime /= duration;\r\n    return endValue * currentTime * currentTime + startValue;\r\n});\r\nEasingFunctions.EaseOutQuad = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\r\n    endValue = endValue - startValue;\r\n    currentTime /= duration;\r\n    return -endValue * currentTime * (currentTime - 2) + startValue;\r\n});\r\nEasingFunctions.EaseInOutQuad = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\r\n    endValue = endValue - startValue;\r\n    currentTime /= duration / 2;\r\n    if (currentTime < 1) {\r\n        return (endValue / 2) * currentTime * currentTime + startValue;\r\n    }\r\n    currentTime--;\r\n    return (-endValue / 2) * (currentTime * (currentTime - 2) - 1) + startValue;\r\n});\r\nEasingFunctions.EaseInCubic = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\r\n    endValue = endValue - startValue;\r\n    currentTime /= duration;\r\n    return endValue * currentTime * currentTime * currentTime + startValue;\r\n});\r\nEasingFunctions.EaseOutCubic = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\r\n    endValue = endValue - startValue;\r\n    currentTime /= duration;\r\n    currentTime--;\r\n    return endValue * (currentTime * currentTime * currentTime + 1) + startValue;\r\n});\r\nEasingFunctions.EaseInOutCubic = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\r\n    endValue = endValue - startValue;\r\n    currentTime /= duration / 2;\r\n    if (currentTime < 1) {\r\n        return (endValue / 2) * currentTime * currentTime * currentTime + startValue;\r\n    }\r\n    currentTime -= 2;\r\n    return (endValue / 2) * (currentTime * currentTime * currentTime + 2) + startValue;\r\n});\r\nEasingFunctions_decorate([\r\n    obsolete({\r\n        message: 'Alias for incorrect spelling used in older versions, will be removed in v0.25.0',\r\n        alternateMethod: 'CreateReversibleEasingFunction'\r\n    })\r\n], EasingFunctions, \"CreateReversableEasingFunction\", null);\r\n\n;// CONCATENATED MODULE: ./Actions/ActionQueue.ts\n/**\r\n * Action Queues represent an ordered sequence of actions\r\n *\r\n * Action queues are part of the [[ActionContext|Action API]] and\r\n * store the list of actions to be executed for an [[Actor]].\r\n *\r\n * Actors implement [[Actor.actions]] which can be manipulated by\r\n * advanced users to adjust the actions currently being executed in the\r\n * queue.\r\n */\r\nclass ActionQueue {\r\n    constructor(entity) {\r\n        this._actions = [];\r\n        this._completedActions = [];\r\n        this._entity = entity;\r\n    }\r\n    /**\r\n     * Add an action to the sequence\r\n     * @param action\r\n     */\r\n    add(action) {\r\n        this._actions.push(action);\r\n    }\r\n    /**\r\n     * Remove an action by reference from the sequence\r\n     * @param action\r\n     */\r\n    remove(action) {\r\n        const index = this._actions.indexOf(action);\r\n        this._actions.splice(index, 1);\r\n    }\r\n    /**\r\n     * Removes all actions from this sequence\r\n     */\r\n    clearActions() {\r\n        this._actions.length = 0;\r\n        this._completedActions.length = 0;\r\n        if (this._currentAction) {\r\n            this._currentAction.stop();\r\n        }\r\n    }\r\n    /**\r\n     *\r\n     * @returns The total list of actions in this sequence complete or not\r\n     */\r\n    getActions() {\r\n        return this._actions.concat(this._completedActions);\r\n    }\r\n    /**\r\n     *\r\n     * @returns `true` if there are more actions to process in the sequence\r\n     */\r\n    hasNext() {\r\n        return this._actions.length > 0;\r\n    }\r\n    /**\r\n     * @returns `true` if the current sequence of actions is done\r\n     */\r\n    isComplete() {\r\n        return this._actions.length === 0;\r\n    }\r\n    /**\r\n     * Resets the sequence of actions, this is used to restart a sequence from the beginning\r\n     */\r\n    reset() {\r\n        this._actions = this.getActions();\r\n        const len = this._actions.length;\r\n        for (let i = 0; i < len; i++) {\r\n            this._actions[i].reset();\r\n        }\r\n        this._completedActions = [];\r\n    }\r\n    /**\r\n     * Update the queue which updates actions and handles completing actions\r\n     * @param elapsedMs\r\n     */\r\n    update(elapsedMs) {\r\n        if (this._actions.length > 0) {\r\n            this._currentAction = this._actions[0];\r\n            this._currentAction.update(elapsedMs);\r\n            if (this._currentAction.isComplete(this._entity)) {\r\n                this._completedActions.push(this._actions.shift());\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/Repeat.ts\n\r\nclass Repeat {\r\n    constructor(entity, repeatBuilder, repeat) {\r\n        this._stopped = false;\r\n        this._repeatBuilder = repeatBuilder;\r\n        this._repeatContext = new ActionContext(entity);\r\n        this._actionQueue = this._repeatContext.getQueue();\r\n        this._repeat = repeat;\r\n        this._originalRepeat = repeat;\r\n        this._repeatBuilder(this._repeatContext);\r\n        this._repeat--; // current execution is the first repeat\r\n    }\r\n    update(delta) {\r\n        if (this._actionQueue.isComplete()) {\r\n            this._actionQueue.clearActions();\r\n            this._repeatBuilder(this._repeatContext);\r\n            this._repeat--;\r\n        }\r\n        this._actionQueue.update(delta);\r\n    }\r\n    isComplete() {\r\n        return this._stopped || (this._repeat <= 0 && this._actionQueue.isComplete());\r\n    }\r\n    stop() {\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._repeat = this._originalRepeat;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/RepeatForever.ts\n\r\n/**\r\n * RepeatForever Action implementation, it is recommended you use the fluent action\r\n * context API.\r\n *\r\n *\r\n */\r\nclass RepeatForever {\r\n    constructor(entity, repeatBuilder) {\r\n        this._stopped = false;\r\n        this._repeatBuilder = repeatBuilder;\r\n        this._repeatContext = new ActionContext(entity);\r\n        this._actionQueue = this._repeatContext.getQueue();\r\n        this._repeatBuilder(this._repeatContext);\r\n    }\r\n    update(delta) {\r\n        if (this._stopped) {\r\n            return;\r\n        }\r\n        if (this._actionQueue.isComplete()) {\r\n            this._actionQueue.clearActions();\r\n            this._repeatBuilder(this._repeatContext);\r\n        }\r\n        this._actionQueue.update(delta);\r\n    }\r\n    isComplete() {\r\n        return this._stopped;\r\n    }\r\n    stop() {\r\n        this._stopped = true;\r\n        this._actionQueue.clearActions();\r\n    }\r\n    reset() {\r\n        return;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/MoveBy.ts\n\r\n\r\n\r\n\r\nclass MoveBy {\r\n    constructor(entity, offsetX, offsetY, speed) {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._entity = entity;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._speed = speed;\r\n        this._offset = new Vector(offsetX, offsetY);\r\n        if (speed <= 0) {\r\n            Logger.getInstance().error('Attempted to moveBy with speed less than or equal to zero : ' + speed);\r\n            throw new Error('Speed must be greater than 0 pixels per second');\r\n        }\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._start = new Vector(this._tx.pos.x, this._tx.pos.y);\r\n            this._end = this._start.add(this._offset);\r\n            this._distance = this._offset.size;\r\n            this._dir = this._end.sub(this._start).normalize();\r\n        }\r\n        if (this.isComplete(this._entity)) {\r\n            this._tx.pos = vec(this._end.x, this._end.y);\r\n            this._motion.vel = vec(0, 0);\r\n        }\r\n        else {\r\n            this._motion.vel = this._dir.scale(this._speed);\r\n        }\r\n    }\r\n    isComplete(entity) {\r\n        const tx = entity.get(TransformComponent);\r\n        return this._stopped || tx.pos.distance(this._start) >= this._distance;\r\n    }\r\n    stop() {\r\n        this._motion.vel = vec(0, 0);\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/MoveTo.ts\n\r\n\r\n\r\nclass MoveTo {\r\n    constructor(entity, destx, desty, speed) {\r\n        this.entity = entity;\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._end = new Vector(destx, desty);\r\n        this._speed = speed;\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._start = new Vector(this._tx.pos.x, this._tx.pos.y);\r\n            this._distance = this._start.distance(this._end);\r\n            this._dir = this._end.sub(this._start).normalize();\r\n        }\r\n        const m = this._dir.scale(this._speed);\r\n        this._motion.vel = vec(m.x, m.y);\r\n        if (this.isComplete(this.entity)) {\r\n            this._tx.pos = vec(this._end.x, this._end.y);\r\n            this._motion.vel = vec(0, 0);\r\n        }\r\n    }\r\n    isComplete(entity) {\r\n        const tx = entity.get(TransformComponent);\r\n        return this._stopped || new Vector(tx.pos.x, tx.pos.y).distance(this._start) >= this._distance;\r\n    }\r\n    stop() {\r\n        this._motion.vel = vec(0, 0);\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/RotationType.ts\n/**\r\n * An enum that describes the strategies that rotation actions can use\r\n */\r\nvar RotationType;\r\n(function (RotationType) {\r\n    /**\r\n     * Rotation via `ShortestPath` will use the smallest angle\r\n     * between the starting and ending points. This strategy is the default behavior.\r\n     */\r\n    RotationType[RotationType[\"ShortestPath\"] = 0] = \"ShortestPath\";\r\n    /**\r\n     * Rotation via `LongestPath` will use the largest angle\r\n     * between the starting and ending points.\r\n     */\r\n    RotationType[RotationType[\"LongestPath\"] = 1] = \"LongestPath\";\r\n    /**\r\n     * Rotation via `Clockwise` will travel in a clockwise direction,\r\n     * regardless of the starting and ending points.\r\n     */\r\n    RotationType[RotationType[\"Clockwise\"] = 2] = \"Clockwise\";\r\n    /**\r\n     * Rotation via `CounterClockwise` will travel in a counterclockwise direction,\r\n     * regardless of the starting and ending points.\r\n     */\r\n    RotationType[RotationType[\"CounterClockwise\"] = 3] = \"CounterClockwise\";\r\n})(RotationType || (RotationType = {}));\r\n\n;// CONCATENATED MODULE: ./Actions/Action/RotateTo.ts\n\r\n\r\n\r\n\r\nclass RotateTo {\r\n    constructor(entity, angleRadians, speed, rotationType) {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._end = angleRadians;\r\n        this._speed = speed;\r\n        this._rotationType = rotationType || RotationType.ShortestPath;\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._start = this._tx.rotation;\r\n            this._currentNonCannonAngle = this._tx.rotation;\r\n            const distance1 = Math.abs(this._end - this._start);\r\n            const distance2 = TwoPI - distance1;\r\n            if (distance1 > distance2) {\r\n                this._shortDistance = distance2;\r\n                this._longDistance = distance1;\r\n            }\r\n            else {\r\n                this._shortDistance = distance1;\r\n                this._longDistance = distance2;\r\n            }\r\n            this._shortestPathIsPositive = (this._start - this._end + TwoPI) % TwoPI >= Math.PI;\r\n            switch (this._rotationType) {\r\n                case RotationType.ShortestPath:\r\n                    this._distance = this._shortDistance;\r\n                    if (this._shortestPathIsPositive) {\r\n                        this._direction = 1;\r\n                    }\r\n                    else {\r\n                        this._direction = -1;\r\n                    }\r\n                    break;\r\n                case RotationType.LongestPath:\r\n                    this._distance = this._longDistance;\r\n                    if (this._shortestPathIsPositive) {\r\n                        this._direction = -1;\r\n                    }\r\n                    else {\r\n                        this._direction = 1;\r\n                    }\r\n                    break;\r\n                case RotationType.Clockwise:\r\n                    this._direction = 1;\r\n                    if (this._shortestPathIsPositive) {\r\n                        this._distance = this._shortDistance;\r\n                    }\r\n                    else {\r\n                        this._distance = this._longDistance;\r\n                    }\r\n                    break;\r\n                case RotationType.CounterClockwise:\r\n                    this._direction = -1;\r\n                    if (!this._shortestPathIsPositive) {\r\n                        this._distance = this._shortDistance;\r\n                    }\r\n                    else {\r\n                        this._distance = this._longDistance;\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n        this._motion.angularVelocity = this._direction * this._speed;\r\n        this._currentNonCannonAngle += this._direction * this._speed * (_delta / 1000);\r\n        if (this.isComplete()) {\r\n            this._tx.rotation = this._end;\r\n            this._motion.angularVelocity = 0;\r\n            this._stopped = true;\r\n        }\r\n    }\r\n    isComplete() {\r\n        const distanceTravelled = Math.abs(this._currentNonCannonAngle - this._start);\r\n        return this._stopped || distanceTravelled >= Math.abs(this._distance);\r\n    }\r\n    stop() {\r\n        this._motion.angularVelocity = 0;\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/RotateBy.ts\n\r\n\r\n\r\n\r\nclass RotateBy {\r\n    constructor(entity, angleRadiansOffset, speed, rotationType) {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._speed = speed;\r\n        this._offset = angleRadiansOffset;\r\n        this._rotationType = rotationType || RotationType.ShortestPath;\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._start = this._tx.rotation;\r\n            this._currentNonCannonAngle = this._tx.rotation;\r\n            this._end = this._start + this._offset;\r\n            const distance1 = Math.abs(this._end - this._start);\r\n            const distance2 = TwoPI - distance1;\r\n            if (distance1 > distance2) {\r\n                this._shortDistance = distance2;\r\n                this._longDistance = distance1;\r\n            }\r\n            else {\r\n                this._shortDistance = distance1;\r\n                this._longDistance = distance2;\r\n            }\r\n            this._shortestPathIsPositive = (this._start - this._end + TwoPI) % TwoPI >= Math.PI;\r\n            switch (this._rotationType) {\r\n                case RotationType.ShortestPath:\r\n                    this._distance = this._shortDistance;\r\n                    if (this._shortestPathIsPositive) {\r\n                        this._direction = 1;\r\n                    }\r\n                    else {\r\n                        this._direction = -1;\r\n                    }\r\n                    break;\r\n                case RotationType.LongestPath:\r\n                    this._distance = this._longDistance;\r\n                    if (this._shortestPathIsPositive) {\r\n                        this._direction = -1;\r\n                    }\r\n                    else {\r\n                        this._direction = 1;\r\n                    }\r\n                    break;\r\n                case RotationType.Clockwise:\r\n                    this._direction = 1;\r\n                    if (this._shortDistance >= 0) {\r\n                        this._distance = this._shortDistance;\r\n                    }\r\n                    else {\r\n                        this._distance = this._longDistance;\r\n                    }\r\n                    break;\r\n                case RotationType.CounterClockwise:\r\n                    this._direction = -1;\r\n                    if (this._shortDistance <= 0) {\r\n                        this._distance = this._shortDistance;\r\n                    }\r\n                    else {\r\n                        this._distance = this._longDistance;\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n        this._motion.angularVelocity = this._direction * this._speed;\r\n        this._currentNonCannonAngle += this._direction * this._speed * (_delta / 1000);\r\n        if (this.isComplete()) {\r\n            this._tx.rotation = this._end;\r\n            this._motion.angularVelocity = 0;\r\n            this._stopped = true;\r\n        }\r\n    }\r\n    isComplete() {\r\n        const distanceTravelled = Math.abs(this._currentNonCannonAngle - this._start);\r\n        return this._stopped || distanceTravelled >= Math.abs(this._distance);\r\n    }\r\n    stop() {\r\n        this._motion.angularVelocity = 0;\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/ScaleTo.ts\n\r\n\r\n\r\nclass ScaleTo {\r\n    constructor(entity, scaleX, scaleY, speedX, speedY) {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._endX = scaleX;\r\n        this._endY = scaleY;\r\n        this._speedX = speedX;\r\n        this._speedY = speedY;\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._startX = this._tx.scale.x;\r\n            this._startY = this._tx.scale.y;\r\n            this._distanceX = Math.abs(this._endX - this._startX);\r\n            this._distanceY = Math.abs(this._endY - this._startY);\r\n        }\r\n        if (!(Math.abs(this._tx.scale.x - this._startX) >= this._distanceX)) {\r\n            const directionX = this._endY < this._startY ? -1 : 1;\r\n            this._motion.scaleFactor.x = this._speedX * directionX;\r\n        }\r\n        else {\r\n            this._motion.scaleFactor.x = 0;\r\n        }\r\n        if (!(Math.abs(this._tx.scale.y - this._startY) >= this._distanceY)) {\r\n            const directionY = this._endY < this._startY ? -1 : 1;\r\n            this._motion.scaleFactor.y = this._speedY * directionY;\r\n        }\r\n        else {\r\n            this._motion.scaleFactor.y = 0;\r\n        }\r\n        if (this.isComplete()) {\r\n            this._tx.scale = vec(this._endX, this._endY);\r\n            this._motion.scaleFactor.x = 0;\r\n            this._motion.scaleFactor.y = 0;\r\n        }\r\n    }\r\n    isComplete() {\r\n        return (this._stopped ||\r\n            (Math.abs(this._tx.scale.y - this._startX) >= this._distanceX && Math.abs(this._tx.scale.y - this._startY) >= this._distanceY));\r\n    }\r\n    stop() {\r\n        this._motion.scaleFactor.x = 0;\r\n        this._motion.scaleFactor.y = 0;\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/ScaleBy.ts\n\r\n\r\n\r\nclass ScaleBy {\r\n    constructor(entity, scaleOffsetX, scaleOffsetY, speed) {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._offset = new Vector(scaleOffsetX, scaleOffsetY);\r\n        this._speedX = this._speedY = speed;\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._startScale = this._tx.scale.clone();\r\n            this._endScale = this._startScale.add(this._offset);\r\n            this._distanceX = Math.abs(this._endScale.x - this._startScale.x);\r\n            this._distanceY = Math.abs(this._endScale.y - this._startScale.y);\r\n            this._directionX = this._endScale.x < this._startScale.x ? -1 : 1;\r\n            this._directionY = this._endScale.y < this._startScale.y ? -1 : 1;\r\n        }\r\n        this._motion.scaleFactor.x = this._speedX * this._directionX;\r\n        this._motion.scaleFactor.y = this._speedY * this._directionY;\r\n        if (this.isComplete()) {\r\n            this._tx.scale = this._endScale;\r\n            this._motion.scaleFactor.x = 0;\r\n            this._motion.scaleFactor.y = 0;\r\n        }\r\n    }\r\n    isComplete() {\r\n        return (this._stopped ||\r\n            (Math.abs(this._tx.scale.x - this._startScale.x) >= this._distanceX &&\r\n                Math.abs(this._tx.scale.y - this._startScale.y) >= this._distanceY));\r\n    }\r\n    stop() {\r\n        this._motion.scaleFactor.x = 0;\r\n        this._motion.scaleFactor.y = 0;\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/CallMethod.ts\nclass CallMethod {\r\n    constructor(method) {\r\n        this._method = null;\r\n        this._hasBeenCalled = false;\r\n        this._method = method;\r\n    }\r\n    update(_delta) {\r\n        this._method();\r\n        this._hasBeenCalled = true;\r\n    }\r\n    isComplete() {\r\n        return this._hasBeenCalled;\r\n    }\r\n    reset() {\r\n        this._hasBeenCalled = false;\r\n    }\r\n    stop() {\r\n        this._hasBeenCalled = true;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/EaseTo.ts\n\r\n\r\n\r\nclass EaseTo {\r\n    constructor(entity, x, y, duration, easingFcn) {\r\n        this.easingFcn = easingFcn;\r\n        this._currentLerpTime = 0;\r\n        this._lerpDuration = 1 * 1000; // 1 second\r\n        this._lerpStart = new Vector(0, 0);\r\n        this._lerpEnd = new Vector(0, 0);\r\n        this._initialized = false;\r\n        this._stopped = false;\r\n        this._distance = 0;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._lerpDuration = duration;\r\n        this._lerpEnd = new Vector(x, y);\r\n    }\r\n    _initialize() {\r\n        this._lerpStart = new Vector(this._tx.pos.x, this._tx.pos.y);\r\n        this._currentLerpTime = 0;\r\n        this._distance = this._lerpStart.distance(this._lerpEnd);\r\n    }\r\n    update(delta) {\r\n        if (!this._initialized) {\r\n            this._initialize();\r\n            this._initialized = true;\r\n        }\r\n        // Need to update lerp time first, otherwise the first update will always be zero\r\n        this._currentLerpTime += delta;\r\n        let newX = this._tx.pos.x;\r\n        let newY = this._tx.pos.y;\r\n        if (this._currentLerpTime < this._lerpDuration) {\r\n            if (this._lerpEnd.x < this._lerpStart.x) {\r\n                newX =\r\n                    this._lerpStart.x -\r\n                        (this.easingFcn(this._currentLerpTime, this._lerpEnd.x, this._lerpStart.x, this._lerpDuration) - this._lerpEnd.x);\r\n            }\r\n            else {\r\n                newX = this.easingFcn(this._currentLerpTime, this._lerpStart.x, this._lerpEnd.x, this._lerpDuration);\r\n            }\r\n            if (this._lerpEnd.y < this._lerpStart.y) {\r\n                newY =\r\n                    this._lerpStart.y -\r\n                        (this.easingFcn(this._currentLerpTime, this._lerpEnd.y, this._lerpStart.y, this._lerpDuration) - this._lerpEnd.y);\r\n            }\r\n            else {\r\n                newY = this.easingFcn(this._currentLerpTime, this._lerpStart.y, this._lerpEnd.y, this._lerpDuration);\r\n            }\r\n            // Given the lerp position figure out the velocity in pixels per second\r\n            this._motion.vel = vec((newX - this._tx.pos.x) / (delta / 1000), (newY - this._tx.pos.y) / (delta / 1000));\r\n        }\r\n        else {\r\n            this._tx.pos = vec(this._lerpEnd.x, this._lerpEnd.y);\r\n            this._motion.vel = Vector.Zero;\r\n        }\r\n    }\r\n    isComplete(actor) {\r\n        return this._stopped || new Vector(actor.pos.x, actor.pos.y).distance(this._lerpStart) >= this._distance;\r\n    }\r\n    reset() {\r\n        this._initialized = false;\r\n    }\r\n    stop() {\r\n        this._motion.vel = vec(0, 0);\r\n        this._stopped = true;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/Blink.ts\n\r\nclass Blink {\r\n    constructor(entity, timeVisible, timeNotVisible, numBlinks = 1) {\r\n        this._timeVisible = 0;\r\n        this._timeNotVisible = 0;\r\n        this._elapsedTime = 0;\r\n        this._totalTime = 0;\r\n        this._stopped = false;\r\n        this._started = false;\r\n        this._graphics = entity.get(GraphicsComponent);\r\n        this._timeVisible = timeVisible;\r\n        this._timeNotVisible = timeNotVisible;\r\n        this._duration = (timeVisible + timeNotVisible) * numBlinks;\r\n    }\r\n    update(delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n        }\r\n        if (!this._graphics) {\r\n            return;\r\n        }\r\n        this._elapsedTime += delta;\r\n        this._totalTime += delta;\r\n        if (this._graphics.visible && this._elapsedTime >= this._timeVisible) {\r\n            this._graphics.visible = false;\r\n            this._elapsedTime = 0;\r\n        }\r\n        if (!this._graphics.visible && this._elapsedTime >= this._timeNotVisible) {\r\n            this._graphics.visible = true;\r\n            this._elapsedTime = 0;\r\n        }\r\n        if (this.isComplete()) {\r\n            this._graphics.visible = true;\r\n        }\r\n    }\r\n    isComplete() {\r\n        return this._stopped || this._totalTime >= this._duration;\r\n    }\r\n    stop() {\r\n        if (this._graphics) {\r\n            this._graphics.visible = true;\r\n        }\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n        this._elapsedTime = 0;\r\n        this._totalTime = 0;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/Fade.ts\n\r\n\r\nclass Fade {\r\n    constructor(entity, endOpacity, speed) {\r\n        this._multiplier = 1;\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._graphics = entity.get(GraphicsComponent);\r\n        this._endOpacity = endOpacity;\r\n        this._speed = speed;\r\n    }\r\n    update(delta) {\r\n        if (!this._graphics) {\r\n            return;\r\n        }\r\n        if (!this._started) {\r\n            this._started = true;\r\n            // determine direction when we start\r\n            if (this._endOpacity < this._graphics.opacity) {\r\n                this._multiplier = -1;\r\n            }\r\n            else {\r\n                this._multiplier = 1;\r\n            }\r\n        }\r\n        if (this._speed > 0) {\r\n            this._graphics.opacity += (this._multiplier *\r\n                (Math.abs(this._graphics.opacity - this._endOpacity) * delta)) / this._speed;\r\n        }\r\n        this._speed -= delta;\r\n        if (this.isComplete()) {\r\n            this._graphics.opacity = this._endOpacity;\r\n        }\r\n        Logger.getInstance().debug('[Action fade] Actor opacity:', this._graphics.opacity);\r\n    }\r\n    isComplete() {\r\n        return this._stopped || Math.abs(this._graphics.opacity - this._endOpacity) < 0.05;\r\n    }\r\n    stop() {\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/Delay.ts\nclass Delay {\r\n    constructor(delay) {\r\n        this._elapsedTime = 0;\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._delay = delay;\r\n    }\r\n    update(delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n        }\r\n        this._elapsedTime += delta;\r\n    }\r\n    isComplete() {\r\n        return this._stopped || this._elapsedTime >= this._delay;\r\n    }\r\n    stop() {\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._elapsedTime = 0;\r\n        this._started = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/Die.ts\n\r\nclass Die {\r\n    constructor(entity) {\r\n        this._stopped = false;\r\n        this._entity = entity;\r\n    }\r\n    update(_delta) {\r\n        this._entity.get(ActionsComponent).clearActions();\r\n        this._entity.kill();\r\n        this._stopped = true;\r\n    }\r\n    isComplete() {\r\n        return this._stopped;\r\n    }\r\n    stop() {\r\n        return;\r\n    }\r\n    reset() {\r\n        return;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/Follow.ts\n\r\n\r\n\r\nclass Follow {\r\n    constructor(entity, entityToFollow, followDistance) {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._followTx = entityToFollow.get(TransformComponent);\r\n        this._followMotion = entityToFollow.get(MotionComponent);\r\n        this._current = new Vector(this._tx.pos.x, this._tx.pos.y);\r\n        this._end = new Vector(this._followTx.pos.x, this._followTx.pos.y);\r\n        this._maximumDistance = followDistance !== undefined ? followDistance : this._current.distance(this._end);\r\n        this._speed = 0;\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._distanceBetween = this._current.distance(this._end);\r\n            this._dir = this._end.sub(this._current).normalize();\r\n        }\r\n        const actorToFollowSpeed = Math.sqrt(Math.pow(this._followMotion.vel.x, 2) + Math.pow(this._followMotion.vel.y, 2));\r\n        if (actorToFollowSpeed !== 0) {\r\n            this._speed = actorToFollowSpeed;\r\n        }\r\n        this._current = vec(this._tx.pos.x, this._tx.pos.y);\r\n        this._end = vec(this._followTx.pos.x, this._followTx.pos.y);\r\n        this._distanceBetween = this._current.distance(this._end);\r\n        this._dir = this._end.sub(this._current).normalize();\r\n        if (this._distanceBetween >= this._maximumDistance) {\r\n            const m = this._dir.scale(this._speed);\r\n            this._motion.vel = vec(m.x, m.y);\r\n        }\r\n        else {\r\n            this._motion.vel = vec(0, 0);\r\n        }\r\n        if (this.isComplete()) {\r\n            this._tx.pos = vec(this._end.x, this._end.y);\r\n            this._motion.vel = vec(0, 0);\r\n        }\r\n    }\r\n    stop() {\r\n        this._motion.vel = vec(0, 0);\r\n        this._stopped = true;\r\n    }\r\n    isComplete() {\r\n        // the actor following should never stop unless specified to do so\r\n        return this._stopped;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/Meet.ts\n\r\n\r\n\r\nclass Meet {\r\n    constructor(actor, actorToMeet, speed) {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._speedWasSpecified = false;\r\n        this._tx = actor.get(TransformComponent);\r\n        this._motion = actor.get(MotionComponent);\r\n        this._meetTx = actorToMeet.get(TransformComponent);\r\n        this._meetMotion = actorToMeet.get(MotionComponent);\r\n        this._current = new Vector(this._tx.pos.x, this._tx.pos.y);\r\n        this._end = new Vector(this._meetTx.pos.x, this._meetTx.pos.y);\r\n        this._speed = speed || 0;\r\n        if (speed !== undefined) {\r\n            this._speedWasSpecified = true;\r\n        }\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._distanceBetween = this._current.distance(this._end);\r\n            this._dir = this._end.sub(this._current).normalize();\r\n        }\r\n        const actorToMeetSpeed = Math.sqrt(Math.pow(this._meetMotion.vel.x, 2) + Math.pow(this._meetMotion.vel.y, 2));\r\n        if (actorToMeetSpeed !== 0 && !this._speedWasSpecified) {\r\n            this._speed = actorToMeetSpeed;\r\n        }\r\n        this._current = vec(this._tx.pos.x, this._tx.pos.y);\r\n        this._end = vec(this._meetTx.pos.x, this._meetTx.pos.y);\r\n        this._distanceBetween = this._current.distance(this._end);\r\n        this._dir = this._end.sub(this._current).normalize();\r\n        const m = this._dir.scale(this._speed);\r\n        this._motion.vel = vec(m.x, m.y);\r\n        if (this.isComplete()) {\r\n            this._tx.pos = vec(this._end.x, this._end.y);\r\n            this._motion.vel = vec(0, 0);\r\n        }\r\n    }\r\n    isComplete() {\r\n        return this._stopped || this._distanceBetween <= 1;\r\n    }\r\n    stop() {\r\n        this._motion.vel = vec(0, 0);\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/ActionContext.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * The fluent Action API allows you to perform \"actions\" on\r\n * [[Actor|Actors]] such as following, moving, rotating, and\r\n * more. You can implement your own actions by implementing\r\n * the [[Action]] interface.\r\n */\r\nclass ActionContext {\r\n    constructor(entity) {\r\n        this._entity = entity;\r\n        this._queue = new ActionQueue(entity);\r\n    }\r\n    getQueue() {\r\n        return this._queue;\r\n    }\r\n    update(elapsedMs) {\r\n        this._queue.update(elapsedMs);\r\n    }\r\n    /**\r\n     * Clears all queued actions from the Actor\r\n     */\r\n    clearActions() {\r\n        this._queue.clearActions();\r\n    }\r\n    easeTo(...args) {\r\n        var _a, _b;\r\n        let x = 0;\r\n        let y = 0;\r\n        let duration = 0;\r\n        let easingFcn = EasingFunctions.Linear;\r\n        if (args[0] instanceof Vector) {\r\n            x = args[0].x;\r\n            y = args[0].y;\r\n            duration = args[1];\r\n            easingFcn = (_a = args[2]) !== null && _a !== void 0 ? _a : easingFcn;\r\n        }\r\n        else {\r\n            x = args[0];\r\n            y = args[1];\r\n            duration = args[2];\r\n            easingFcn = (_b = args[3]) !== null && _b !== void 0 ? _b : easingFcn;\r\n        }\r\n        this._queue.add(new EaseTo(this._entity, x, y, duration, easingFcn));\r\n        return this;\r\n    }\r\n    moveTo(xOrPos, yOrSpeed, speedOrUndefined) {\r\n        let x = 0;\r\n        let y = 0;\r\n        let speed = 0;\r\n        if (xOrPos instanceof Vector) {\r\n            x = xOrPos.x;\r\n            y = xOrPos.y;\r\n            speed = yOrSpeed;\r\n        }\r\n        else {\r\n            x = xOrPos;\r\n            y = yOrSpeed;\r\n            speed = speedOrUndefined;\r\n        }\r\n        this._queue.add(new MoveTo(this._entity, x, y, speed));\r\n        return this;\r\n    }\r\n    moveBy(xOffsetOrVector, yOffsetOrSpeed, speedOrUndefined) {\r\n        let xOffset = 0;\r\n        let yOffset = 0;\r\n        let speed = 0;\r\n        if (xOffsetOrVector instanceof Vector) {\r\n            xOffset = xOffsetOrVector.x;\r\n            yOffset = xOffsetOrVector.y;\r\n            speed = yOffsetOrSpeed;\r\n        }\r\n        else {\r\n            xOffset = xOffsetOrVector;\r\n            yOffset = yOffsetOrSpeed;\r\n            speed = speedOrUndefined;\r\n        }\r\n        this._queue.add(new MoveBy(this._entity, xOffset, yOffset, speed));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will rotate an actor to the specified angle at the speed\r\n     * specified (in radians per second) and return back the actor. This\r\n     * method is part of the actor 'Action' fluent API allowing action chaining.\r\n     * @param angleRadians  The angle to rotate to in radians\r\n     * @param speed         The angular velocity of the rotation specified in radians per second\r\n     * @param rotationType  The [[RotationType]] to use for this rotation\r\n     */\r\n    rotateTo(angleRadians, speed, rotationType) {\r\n        this._queue.add(new RotateTo(this._entity, angleRadians, speed, rotationType));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will rotate an actor by the specified angle offset, from it's current rotation given a certain speed\r\n     * in radians/sec and return back the actor. This method is part\r\n     * of the actor 'Action' fluent API allowing action chaining.\r\n     * @param angleRadiansOffset  The angle to rotate to in radians relative to the current rotation\r\n     * @param speed          The speed in radians/sec the actor should rotate at\r\n     * @param rotationType  The [[RotationType]] to use for this rotation, default is shortest path\r\n     */\r\n    rotateBy(angleRadiansOffset, speed, rotationType) {\r\n        this._queue.add(new RotateBy(this._entity, angleRadiansOffset, speed, rotationType));\r\n        return this;\r\n    }\r\n    scaleTo(sizeXOrVector, sizeYOrSpeed, speedXOrUndefined, speedYOrUndefined) {\r\n        let sizeX = 1;\r\n        let sizeY = 1;\r\n        let speedX = 0;\r\n        let speedY = 0;\r\n        if (sizeXOrVector instanceof Vector && sizeYOrSpeed instanceof Vector) {\r\n            sizeX = sizeXOrVector.x;\r\n            sizeY = sizeXOrVector.y;\r\n            speedX = sizeYOrSpeed.x;\r\n            speedY = sizeYOrSpeed.y;\r\n        }\r\n        if (typeof sizeXOrVector === 'number' && typeof sizeYOrSpeed === 'number') {\r\n            sizeX = sizeXOrVector;\r\n            sizeY = sizeYOrSpeed;\r\n            speedX = speedXOrUndefined;\r\n            speedY = speedYOrUndefined;\r\n        }\r\n        this._queue.add(new ScaleTo(this._entity, sizeX, sizeY, speedX, speedY));\r\n        return this;\r\n    }\r\n    scaleBy(sizeOffsetXOrVector, sizeOffsetYOrSpeed, speed) {\r\n        let sizeOffsetX = 1;\r\n        let sizeOffsetY = 1;\r\n        if (sizeOffsetXOrVector instanceof Vector) {\r\n            sizeOffsetX = sizeOffsetXOrVector.x;\r\n            sizeOffsetY = sizeOffsetXOrVector.y;\r\n            speed = sizeOffsetYOrSpeed;\r\n        }\r\n        if (typeof sizeOffsetXOrVector === 'number' && typeof sizeOffsetYOrSpeed === 'number') {\r\n            sizeOffsetX = sizeOffsetXOrVector;\r\n            sizeOffsetY = sizeOffsetYOrSpeed;\r\n        }\r\n        this._queue.add(new ScaleBy(this._entity, sizeOffsetX, sizeOffsetY, speed));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will cause an actor to blink (become visible and not\r\n     * visible). Optionally, you may specify the number of blinks. Specify the amount of time\r\n     * the actor should be visible per blink, and the amount of time not visible.\r\n     * This method is part of the actor 'Action' fluent API allowing action chaining.\r\n     * @param timeVisible     The amount of time to stay visible per blink in milliseconds\r\n     * @param timeNotVisible  The amount of time to stay not visible per blink in milliseconds\r\n     * @param numBlinks       The number of times to blink\r\n     */\r\n    blink(timeVisible, timeNotVisible, numBlinks = 1) {\r\n        this._queue.add(new Blink(this._entity, timeVisible, timeNotVisible, numBlinks));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will cause an actor's opacity to change from its current value\r\n     * to the provided value by a specified time (in milliseconds). This method is\r\n     * part of the actor 'Action' fluent API allowing action chaining.\r\n     * @param opacity  The ending opacity\r\n     * @param time     The time it should take to fade the actor (in milliseconds)\r\n     */\r\n    fade(opacity, time) {\r\n        this._queue.add(new Fade(this._entity, opacity, time));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will delay the next action from executing for a certain\r\n     * amount of time (in milliseconds). This method is part of the actor\r\n     * 'Action' fluent API allowing action chaining.\r\n     * @param time  The amount of time to delay the next action in the queue from executing in milliseconds\r\n     */\r\n    delay(time) {\r\n        this._queue.add(new Delay(time));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will add an action to the queue that will remove the actor from the\r\n     * scene once it has completed its previous  Any actions on the\r\n     * action queue after this action will not be executed.\r\n     */\r\n    die() {\r\n        this._queue.add(new Die(this._entity));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method allows you to call an arbitrary method as the next action in the\r\n     * action queue. This is useful if you want to execute code in after a specific\r\n     * action, i.e An actor arrives at a destination after traversing a path\r\n     */\r\n    callMethod(method) {\r\n        this._queue.add(new CallMethod(method));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will cause the actor to repeat all of the actions built in\r\n     * the `repeatBuilder` callback. If the number of repeats\r\n     * is not specified it will repeat forever. This method is part of\r\n     * the actor 'Action' fluent API allowing action chaining\r\n     *\r\n     * ```typescript\r\n     * // Move up in a zig-zag by repeated moveBy's\r\n     * actor.actions.repeat(repeatCtx => {\r\n     *  repeatCtx.moveBy(10, 0, 10);\r\n     *  repeatCtx.moveBy(0, 10, 10);\r\n     * }, 5);\r\n     * ```\r\n     *\r\n     * @param repeatBuilder The builder to specify the repeatable list of actions\r\n     * @param times  The number of times to repeat all the previous actions in the action queue. If nothing is specified the actions\r\n     * will repeat forever\r\n     */\r\n    repeat(repeatBuilder, times) {\r\n        if (!times) {\r\n            this.repeatForever(repeatBuilder);\r\n            return this;\r\n        }\r\n        this._queue.add(new Repeat(this._entity, repeatBuilder, times));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will cause the actor to repeat all of the actions built in\r\n     * the `repeatBuilder` callback. If the number of repeats\r\n     * is not specified it will repeat forever. This method is part of\r\n     * the actor 'Action' fluent API allowing action chaining\r\n     *\r\n     * ```typescript\r\n     * // Move up in a zig-zag by repeated moveBy's\r\n     * actor.actions.repeat(repeatCtx => {\r\n     *  repeatCtx.moveBy(10, 0, 10);\r\n     *  repeatCtx.moveBy(0, 10, 10);\r\n     * }, 5);\r\n     * ```\r\n     *\r\n     * @param repeatBuilder The builder to specify the repeatable list of actions\r\n     */\r\n    repeatForever(repeatBuilder) {\r\n        this._queue.add(new RepeatForever(this._entity, repeatBuilder));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will cause the entity to follow another at a specified distance\r\n     * @param entity           The entity to follow\r\n     * @param followDistance  The distance to maintain when following, if not specified the actor will follow at the current distance.\r\n     */\r\n    follow(entity, followDistance) {\r\n        if (followDistance === undefined) {\r\n            this._queue.add(new Follow(this._entity, entity));\r\n        }\r\n        else {\r\n            this._queue.add(new Follow(this._entity, entity, followDistance));\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will cause the entity to move towards another until they\r\n     * collide \"meet\" at a specified speed.\r\n     * @param entity  The entity to meet\r\n     * @param speed  The speed in pixels per second to move, if not specified it will match the speed of the other actor\r\n     */\r\n    meet(entity, speed) {\r\n        if (speed === undefined) {\r\n            this._queue.add(new Meet(this._entity, entity));\r\n        }\r\n        else {\r\n            this._queue.add(new Meet(this._entity, entity, speed));\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Returns a promise that resolves when the current action queue up to now\r\n     * is finished.\r\n     * @deprecated Use `toPromise()` will be removed in v0.26.0\r\n     */\r\n    asPromise() {\r\n        return this.toPromise();\r\n    }\r\n    /**\r\n     * Returns a promise that resolves when the current action queue up to now\r\n     * is finished.\r\n     */\r\n    toPromise() {\r\n        const temp = new Promise((resolve) => {\r\n            this._queue.add(new CallMethod(() => {\r\n                resolve();\r\n            }));\r\n        });\r\n        return temp;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/ActionsComponent.ts\n\r\n\r\n\r\n\r\n;\r\nclass ActionsComponent extends Component {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.type = 'ex.actions';\r\n        this.dependencies = [TransformComponent, MotionComponent];\r\n    }\r\n    onAdd(entity) {\r\n        this._ctx = new ActionContext(entity);\r\n    }\r\n    onRemove() {\r\n        this._ctx = null;\r\n    }\r\n    /**\r\n     * Returns the internal action queue\r\n     * @returns action queue\r\n     */\r\n    getQueue() {\r\n        var _a;\r\n        return (_a = this._ctx) === null || _a === void 0 ? void 0 : _a.getQueue();\r\n    }\r\n    /**\r\n     * Updates the internal action context, performing action and moving through the internal queue\r\n     * @param elapsedMs\r\n     */\r\n    update(elapsedMs) {\r\n        var _a;\r\n        return (_a = this._ctx) === null || _a === void 0 ? void 0 : _a.update(elapsedMs);\r\n    }\r\n    /**\r\n     * Clears all queued actions from the Actor\r\n     */\r\n    clearActions() {\r\n        var _a;\r\n        (_a = this._ctx) === null || _a === void 0 ? void 0 : _a.clearActions();\r\n    }\r\n    easeTo(...args) {\r\n        return this._ctx.easeTo.apply(this._ctx, args);\r\n    }\r\n    moveTo(xOrPos, yOrSpeed, speedOrUndefined) {\r\n        return this._ctx.moveTo.apply(this._ctx, [xOrPos, yOrSpeed, speedOrUndefined]);\r\n    }\r\n    moveBy(xOffsetOrVector, yOffsetOrSpeed, speedOrUndefined) {\r\n        return this._ctx.moveBy.apply(this._ctx, [xOffsetOrVector, yOffsetOrSpeed, speedOrUndefined]);\r\n    }\r\n    /**\r\n     * This method will rotate an actor to the specified angle at the speed\r\n     * specified (in radians per second) and return back the actor. This\r\n     * method is part of the actor 'Action' fluent API allowing action chaining.\r\n     * @param angleRadians  The angle to rotate to in radians\r\n     * @param speed         The angular velocity of the rotation specified in radians per second\r\n     * @param rotationType  The [[RotationType]] to use for this rotation\r\n     */\r\n    rotateTo(angleRadians, speed, rotationType) {\r\n        return this._ctx.rotateTo(angleRadians, speed, rotationType);\r\n    }\r\n    /**\r\n     * This method will rotate an actor by the specified angle offset, from it's current rotation given a certain speed\r\n     * in radians/sec and return back the actor. This method is part\r\n     * of the actor 'Action' fluent API allowing action chaining.\r\n     * @param angleRadiansOffset  The angle to rotate to in radians relative to the current rotation\r\n     * @param speed          The speed in radians/sec the actor should rotate at\r\n     * @param rotationType  The [[RotationType]] to use for this rotation, default is shortest path\r\n     */\r\n    rotateBy(angleRadiansOffset, speed, rotationType) {\r\n        return this._ctx.rotateBy(angleRadiansOffset, speed, rotationType);\r\n    }\r\n    scaleTo(sizeXOrVector, sizeYOrSpeed, speedXOrUndefined, speedYOrUndefined) {\r\n        return this._ctx.scaleTo.apply(this._ctx, [sizeXOrVector, sizeYOrSpeed, speedXOrUndefined, speedYOrUndefined]);\r\n    }\r\n    scaleBy(sizeOffsetXOrVector, sizeOffsetYOrSpeed, speed) {\r\n        return this._ctx.scaleBy.apply(this._ctx, [sizeOffsetXOrVector, sizeOffsetYOrSpeed, speed]);\r\n    }\r\n    /**\r\n     * This method will cause an actor to blink (become visible and not\r\n     * visible). Optionally, you may specify the number of blinks. Specify the amount of time\r\n     * the actor should be visible per blink, and the amount of time not visible.\r\n     * This method is part of the actor 'Action' fluent API allowing action chaining.\r\n     * @param timeVisible     The amount of time to stay visible per blink in milliseconds\r\n     * @param timeNotVisible  The amount of time to stay not visible per blink in milliseconds\r\n     * @param numBlinks       The number of times to blink\r\n     */\r\n    blink(timeVisible, timeNotVisible, numBlinks) {\r\n        return this._ctx.blink(timeVisible, timeNotVisible, numBlinks);\r\n    }\r\n    /**\r\n     * This method will cause an actor's opacity to change from its current value\r\n     * to the provided value by a specified time (in milliseconds). This method is\r\n     * part of the actor 'Action' fluent API allowing action chaining.\r\n     * @param opacity  The ending opacity\r\n     * @param time     The time it should take to fade the actor (in milliseconds)\r\n     */\r\n    fade(opacity, time) {\r\n        return this._ctx.fade(opacity, time);\r\n    }\r\n    /**\r\n     * This method will delay the next action from executing for a certain\r\n     * amount of time (in milliseconds). This method is part of the actor\r\n     * 'Action' fluent API allowing action chaining.\r\n     * @param time  The amount of time to delay the next action in the queue from executing in milliseconds\r\n     */\r\n    delay(time) {\r\n        return this._ctx.delay(time);\r\n    }\r\n    /**\r\n     * This method will add an action to the queue that will remove the actor from the\r\n     * scene once it has completed its previous  Any actions on the\r\n     * action queue after this action will not be executed.\r\n     */\r\n    die() {\r\n        return this._ctx.die();\r\n    }\r\n    /**\r\n     * This method allows you to call an arbitrary method as the next action in the\r\n     * action queue. This is useful if you want to execute code in after a specific\r\n     * action, i.e An actor arrives at a destination after traversing a path\r\n     */\r\n    callMethod(method) {\r\n        return this._ctx.callMethod(method);\r\n    }\r\n    /**\r\n     * This method will cause the actor to repeat all of the actions built in\r\n     * the `repeatBuilder` callback. If the number of repeats\r\n     * is not specified it will repeat forever. This method is part of\r\n     * the actor 'Action' fluent API allowing action chaining\r\n     *\r\n     * ```typescript\r\n     * // Move up in a zig-zag by repeated moveBy's\r\n     * actor.actions.repeat(repeatCtx => {\r\n     *  repeatCtx.moveBy(10, 0, 10);\r\n     *  repeatCtx.moveBy(0, 10, 10);\r\n     * }, 5);\r\n     * ```\r\n     *\r\n     * @param repeatBuilder The builder to specify the repeatable list of actions\r\n     * @param times  The number of times to repeat all the previous actions in the action queue. If nothing is specified the actions\r\n     * will repeat forever\r\n     */\r\n    repeat(repeatBuilder, times) {\r\n        return this._ctx.repeat(repeatBuilder, times);\r\n    }\r\n    /**\r\n     * This method will cause the actor to repeat all of the actions built in\r\n     * the `repeatBuilder` callback. If the number of repeats\r\n     * is not specified it will repeat forever. This method is part of\r\n     * the actor 'Action' fluent API allowing action chaining\r\n     *\r\n     * ```typescript\r\n     * // Move up in a zig-zag by repeated moveBy's\r\n     * actor.actions.repeat(repeatCtx => {\r\n     *  repeatCtx.moveBy(10, 0, 10);\r\n     *  repeatCtx.moveBy(0, 10, 10);\r\n     * }, 5);\r\n     * ```\r\n     *\r\n     * @param repeatBuilder The builder to specify the repeatable list of actions\r\n     */\r\n    repeatForever(repeatBuilder) {\r\n        return this._ctx.repeatForever(repeatBuilder);\r\n    }\r\n    /**\r\n     * This method will cause the entity to follow another at a specified distance\r\n     * @param entity           The entity to follow\r\n     * @param followDistance  The distance to maintain when following, if not specified the actor will follow at the current distance.\r\n     */\r\n    follow(entity, followDistance) {\r\n        return this._ctx.follow(entity, followDistance);\r\n    }\r\n    /**\r\n     * This method will cause the entity to move towards another until they\r\n     * collide \"meet\" at a specified speed.\r\n     * @param entity  The entity to meet\r\n     * @param speed  The speed in pixels per second to move, if not specified it will match the speed of the other actor\r\n     */\r\n    meet(entity, speed) {\r\n        return this._ctx.meet(entity, speed);\r\n    }\r\n    /**\r\n     * Returns a promise that resolves when the current action queue up to now\r\n     * is finished.\r\n     * @deprecated Use `toPromise()` will be removed in v0.26.0\r\n     */\r\n    asPromise() {\r\n        return this.toPromise();\r\n    }\r\n    /**\r\n     * Returns a promise that resolves when the current action queue up to now\r\n     * is finished.\r\n     */\r\n    toPromise() {\r\n        return this._ctx.toPromise();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Font.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Represents a system or web font in Excalibur\r\n *\r\n * If no options specified, the system sans-serif 10 pixel is used\r\n *\r\n * If loading a custom web font be sure to have the font loaded before you use it https://erikonarheim.com/posts/dont-test-fonts/\r\n */\r\nclass Font extends Graphic {\r\n    constructor(options = {}) {\r\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t, _u;\r\n        super(options); // <- Graphics properties\r\n        /**\r\n         * Set the font filtering mode, by default set to [[ImageFiltering.Blended]] regardless of the engine default smoothing\r\n         *\r\n         * If you have a pixel style font that may be a reason to switch this to [[ImageFiltering.Pixel]]\r\n         */\r\n        this.filtering = ImageFiltering.Blended;\r\n        /**\r\n         * Font quality determines the size of the underlying raster text, higher quality means less jagged edges.\r\n         * If quality is set to 1, then just enough raster bitmap is generated to render the text.\r\n         *\r\n         * You can think of quality as how zoomed in to the text you can get before seeing jagged edges.\r\n         *\r\n         * (Default 2)\r\n         */\r\n        this.quality = 2;\r\n        // Raster properties for fonts\r\n        this.padding = 2;\r\n        this.smoothing = false;\r\n        this.lineWidth = 1;\r\n        this.lineDash = [];\r\n        this.color = Color.Black;\r\n        this.family = 'sans-serif';\r\n        this.style = FontStyle.Normal;\r\n        this.bold = false;\r\n        this.unit = FontUnit.Px;\r\n        this.textAlign = TextAlign.Left;\r\n        this.baseAlign = BaseAlign.Alphabetic;\r\n        this.direction = Direction.LeftToRight;\r\n        this.size = 10;\r\n        this.shadow = null;\r\n        this._textBounds = new BoundingBox();\r\n        this._textToBitmap = new Map();\r\n        this._bitmapUsage = new Map();\r\n        // Raster properties\r\n        this.smoothing = (_a = options === null || options === void 0 ? void 0 : options.smoothing) !== null && _a !== void 0 ? _a : this.smoothing;\r\n        this.padding = (_b = options === null || options === void 0 ? void 0 : options.padding) !== null && _b !== void 0 ? _b : this.padding;\r\n        this.color = (_c = options === null || options === void 0 ? void 0 : options.color) !== null && _c !== void 0 ? _c : this.color;\r\n        this.strokeColor = (_d = options === null || options === void 0 ? void 0 : options.strokeColor) !== null && _d !== void 0 ? _d : this.strokeColor;\r\n        this.lineDash = (_e = options === null || options === void 0 ? void 0 : options.lineDash) !== null && _e !== void 0 ? _e : this.lineDash;\r\n        this.lineWidth = (_f = options === null || options === void 0 ? void 0 : options.lineWidth) !== null && _f !== void 0 ? _f : this.lineWidth;\r\n        this.filtering = (_g = options === null || options === void 0 ? void 0 : options.filtering) !== null && _g !== void 0 ? _g : this.filtering;\r\n        // Font specific properties\r\n        this.family = (_h = options === null || options === void 0 ? void 0 : options.family) !== null && _h !== void 0 ? _h : this.family;\r\n        this.style = (_j = options === null || options === void 0 ? void 0 : options.style) !== null && _j !== void 0 ? _j : this.style;\r\n        this.bold = (_k = options === null || options === void 0 ? void 0 : options.bold) !== null && _k !== void 0 ? _k : this.bold;\r\n        this.size = (_l = options === null || options === void 0 ? void 0 : options.size) !== null && _l !== void 0 ? _l : this.size;\r\n        this.unit = (_m = options === null || options === void 0 ? void 0 : options.unit) !== null && _m !== void 0 ? _m : this.unit;\r\n        this.textAlign = (_o = options === null || options === void 0 ? void 0 : options.textAlign) !== null && _o !== void 0 ? _o : this.textAlign;\r\n        this.baseAlign = (_p = options === null || options === void 0 ? void 0 : options.baseAlign) !== null && _p !== void 0 ? _p : this.baseAlign;\r\n        this.direction = (_q = options === null || options === void 0 ? void 0 : options.direction) !== null && _q !== void 0 ? _q : this.direction;\r\n        this.quality = (_r = options === null || options === void 0 ? void 0 : options.quality) !== null && _r !== void 0 ? _r : this.quality;\r\n        if (options === null || options === void 0 ? void 0 : options.shadow) {\r\n            this.shadow = {};\r\n            this.shadow.blur = (_s = options.shadow.blur) !== null && _s !== void 0 ? _s : this.shadow.blur;\r\n            this.shadow.offset = (_t = options.shadow.offset) !== null && _t !== void 0 ? _t : this.shadow.offset;\r\n            this.shadow.color = (_u = options.shadow.color) !== null && _u !== void 0 ? _u : this.shadow.color;\r\n        }\r\n    }\r\n    clone() {\r\n        return new Font({\r\n            ...this.cloneGraphicOptions(),\r\n            size: this.size,\r\n            unit: this.unit,\r\n            family: this.family,\r\n            style: this.style,\r\n            bold: this.bold,\r\n            textAlign: this.textAlign,\r\n            baseAlign: this.baseAlign,\r\n            direction: this.direction,\r\n            shadow: this.shadow\r\n                ? {\r\n                    blur: this.shadow.blur,\r\n                    offset: this.shadow.offset,\r\n                    color: this.shadow.color\r\n                }\r\n                : null\r\n        });\r\n    }\r\n    get fontString() {\r\n        return `${this.style} ${this.bold ? 'bold' : ''} ${this.size}${this.unit} ${this.family}`;\r\n    }\r\n    get localBounds() {\r\n        return this._textBounds;\r\n    }\r\n    _drawImage(_ex, _x, _y) {\r\n        // TODO weird vestigial drawimage\r\n    }\r\n    _rotate(ex) {\r\n        var _a;\r\n        // TODO this needs to change depending on the bounding box...\r\n        const origin = (_a = this.origin) !== null && _a !== void 0 ? _a : this._textBounds.center;\r\n        ex.translate(origin.x, origin.y);\r\n        ex.rotate(this.rotation);\r\n        ex.translate(-origin.x, -origin.y);\r\n    }\r\n    _flip(ex) {\r\n        if (this.flipHorizontal) {\r\n            ex.translate(this._textBounds.width / this.scale.x, 0);\r\n            ex.scale(-1, 1);\r\n        }\r\n        if (this.flipVertical) {\r\n            ex.translate(0, -this._textBounds.height / 2 / this.scale.y);\r\n            ex.scale(1, -1);\r\n        }\r\n    }\r\n    /**\r\n     * Returns a BoundingBox that is the total size of the text including multiple lines\r\n     *\r\n     * Does not include any padding or adjustment\r\n     * @param text\r\n     * @returns BoundingBox\r\n     */\r\n    measureText(text) {\r\n        const lines = text.split('\\n');\r\n        const maxWidthLine = lines.reduce((a, b) => {\r\n            return a.length > b.length ? a : b;\r\n        });\r\n        const ctx = this._getTextBitmap(text);\r\n        this._applyFont(ctx); // font must be applied to the context to measure it\r\n        const metrics = ctx.measureText(maxWidthLine);\r\n        let textHeight = Math.abs(metrics.actualBoundingBoxAscent) + Math.abs(metrics.actualBoundingBoxDescent);\r\n        // TODO lineheight makes the text bounds wonky\r\n        const lineAdjustedHeight = textHeight * lines.length;\r\n        textHeight = lineAdjustedHeight;\r\n        const bottomBounds = lineAdjustedHeight - Math.abs(metrics.actualBoundingBoxAscent);\r\n        const x = 0;\r\n        const y = 0;\r\n        return new BoundingBox({\r\n            left: x - Math.abs(metrics.actualBoundingBoxLeft) - this.padding,\r\n            top: y - Math.abs(metrics.actualBoundingBoxAscent) - this.padding,\r\n            bottom: y + bottomBounds + this.padding,\r\n            right: x + Math.abs(metrics.actualBoundingBoxRight) + this.padding\r\n        });\r\n    }\r\n    _setDimension(textBounds, bitmap) {\r\n        // Changing the width and height clears the context properties\r\n        // We double the bitmap width to account for all possible alignment\r\n        // We scale by \"quality\" so we render text without jaggies\r\n        bitmap.canvas.width = (textBounds.width + this.padding * 2) * 2 * this.quality;\r\n        bitmap.canvas.height = (textBounds.height + this.padding * 2) * 2 * this.quality;\r\n    }\r\n    _postDraw(ex) {\r\n        ex.restore();\r\n    }\r\n    /**\r\n     * We need to identify bitmaps with more than just the text content\r\n     *\r\n     * Any properties that can change the rendering of the text\r\n     */\r\n    _getRasterPropertiesHash(color) {\r\n        var _a, _b;\r\n        const hash = '__hashcode__' +\r\n            this.fontString +\r\n            this.showDebug +\r\n            this.textAlign +\r\n            this.baseAlign +\r\n            this.direction +\r\n            JSON.stringify(this.shadow) +\r\n            (this.padding.toString() +\r\n                this.smoothing.toString() +\r\n                this.lineWidth.toString() +\r\n                this.lineDash.toString() +\r\n                ((_a = this.strokeColor) === null || _a === void 0 ? void 0 : _a.toString()) +\r\n                (color ? color.toString() : (_b = this.color) === null || _b === void 0 ? void 0 : _b.toString()).toString());\r\n        return hash;\r\n    }\r\n    _applyRasterProperties(ctx, color) {\r\n        var _a, _b, _c;\r\n        ctx.translate(this.padding, this.padding);\r\n        ctx.imageSmoothingEnabled = this.smoothing;\r\n        ctx.lineWidth = this.lineWidth;\r\n        ctx.setLineDash((_a = this.lineDash) !== null && _a !== void 0 ? _a : ctx.getLineDash());\r\n        ctx.strokeStyle = (_b = this.strokeColor) === null || _b === void 0 ? void 0 : _b.toString();\r\n        ctx.fillStyle = color ? color.toString() : (_c = this.color) === null || _c === void 0 ? void 0 : _c.toString();\r\n    }\r\n    _applyFont(ctx) {\r\n        ctx.translate(this.padding + ctx.canvas.width / 2, this.padding + ctx.canvas.height / 2);\r\n        ctx.scale(this.quality, this.quality);\r\n        ctx.textAlign = this.textAlign;\r\n        ctx.textBaseline = this.baseAlign;\r\n        ctx.font = this.fontString;\r\n        ctx.direction = this.direction;\r\n        if (this.shadow) {\r\n            ctx.shadowColor = this.shadow.color.toString();\r\n            ctx.shadowBlur = this.shadow.blur;\r\n            ctx.shadowOffsetX = this.shadow.offset.x;\r\n            ctx.shadowOffsetY = this.shadow.offset.y;\r\n        }\r\n    }\r\n    _drawText(ctx, text, colorOverride, lineHeight) {\r\n        const lines = text.split('\\n');\r\n        this._applyRasterProperties(ctx, colorOverride);\r\n        this._applyFont(ctx);\r\n        for (let i = 0; i < lines.length; i++) {\r\n            const line = lines[i];\r\n            if (this.color) {\r\n                ctx.fillText(line, 0, i * lineHeight);\r\n            }\r\n            if (this.strokeColor) {\r\n                ctx.strokeText(line, 0, i * lineHeight);\r\n            }\r\n        }\r\n        if (this.showDebug) {\r\n            // Horizontal line\r\n            /* istanbul ignore next */\r\n            line(ctx, Color.Red, -ctx.canvas.width / 2, 0, ctx.canvas.width / 2, 0, 2);\r\n            // Vertical line\r\n            /* istanbul ignore next */\r\n            line(ctx, Color.Red, 0, -ctx.canvas.height / 2, 0, ctx.canvas.height / 2, 2);\r\n        }\r\n    }\r\n    _getTextBitmap(text, color) {\r\n        const textAndHash = text + this._getRasterPropertiesHash(color);\r\n        const bitmap = this._textToBitmap.get(textAndHash);\r\n        if (bitmap) {\r\n            return bitmap;\r\n        }\r\n        const canvas = document.createElement('canvas');\r\n        const ctx = canvas.getContext('2d');\r\n        this._textToBitmap.set(textAndHash, ctx);\r\n        return ctx;\r\n    }\r\n    render(ex, text, colorOverride, x, y) {\r\n        if (this.showDebug) {\r\n            this.clearCache();\r\n        }\r\n        this.checkAndClearCache();\r\n        const bitmap = this._getTextBitmap(text, colorOverride);\r\n        const isNewBitmap = !this._bitmapUsage.get(bitmap);\r\n        this._textBounds = this.measureText(text);\r\n        if (isNewBitmap) {\r\n            this._setDimension(this._textBounds, bitmap);\r\n        }\r\n        this._preDraw(ex, x, y);\r\n        const lines = text.split('\\n');\r\n        const lineHeight = this._textBounds.height / lines.length;\r\n        const rasterWidth = bitmap.canvas.width;\r\n        const rasterHeight = bitmap.canvas.height;\r\n        if (isNewBitmap) {\r\n            // draws the text to the bitmap\r\n            this._drawText(bitmap, text, colorOverride, lineHeight);\r\n            // draws the bitmap to excalibur graphics context\r\n            TextureLoader.load(bitmap.canvas, this.filtering, true);\r\n        }\r\n        ex.drawImage(bitmap.canvas, 0, 0, rasterWidth, rasterHeight, x - rasterWidth / this.quality / 2, y - rasterHeight / this.quality / 2, rasterWidth / this.quality, rasterHeight / this.quality);\r\n        this._postDraw(ex);\r\n        // Cache the bitmap for certain amount of time\r\n        this._bitmapUsage.set(bitmap, performance.now());\r\n    }\r\n    /**\r\n     * Get the internal cache size of the font\r\n     * This is useful when debugging memory usage, these numbers indicate the number of cached in memory text bitmaps\r\n     */\r\n    get cacheSize() {\r\n        return this._bitmapUsage.size;\r\n    }\r\n    /**\r\n     * Force clear all cached text bitmaps\r\n     */\r\n    clearCache() {\r\n        this._bitmapUsage.clear();\r\n    }\r\n    /**\r\n     * Remove any expired cached text bitmaps\r\n     */\r\n    checkAndClearCache() {\r\n        for (const [bitmap, time] of this._bitmapUsage.entries()) {\r\n            // if bitmap hasn't been used in 1 second clear it\r\n            if (time + 1000 < performance.now()) {\r\n                this._bitmapUsage.delete(bitmap);\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Text.ts\n\r\n\r\n\r\n/**\r\n * Represent Text graphics in excalibur\r\n *\r\n * Useful for in game labels, ui, or overlays\r\n */\r\nclass Text extends Graphic {\r\n    constructor(options) {\r\n        var _a, _b;\r\n        super(options);\r\n        this._text = '';\r\n        this._textWidth = 0;\r\n        this._textHeight = 0;\r\n        // This order is important font, color, then text\r\n        this.font = (_a = options.font) !== null && _a !== void 0 ? _a : new Font();\r\n        this.color = (_b = options.color) !== null && _b !== void 0 ? _b : this.color;\r\n        this.text = options.text;\r\n    }\r\n    clone() {\r\n        var _a, _b;\r\n        return new Text({\r\n            text: this.text.slice(),\r\n            color: (_b = (_a = this.color) === null || _a === void 0 ? void 0 : _a.clone()) !== null && _b !== void 0 ? _b : Color.Black,\r\n            font: this.font.clone()\r\n        });\r\n    }\r\n    get text() {\r\n        return this._text;\r\n    }\r\n    set text(value) {\r\n        this._text = value;\r\n        const bounds = this.font.measureText(this._text);\r\n        this._textWidth = bounds.width;\r\n        this._textHeight = bounds.height;\r\n    }\r\n    get font() {\r\n        return this._font;\r\n    }\r\n    set font(font) {\r\n        this._font = font;\r\n    }\r\n    get width() {\r\n        if (this._textWidth === 0) {\r\n            this._calculateDimension();\r\n        }\r\n        return this._textWidth * this.scale.x;\r\n    }\r\n    get height() {\r\n        if (this._textHeight === 0) {\r\n            this._calculateDimension();\r\n        }\r\n        return this._textHeight * this.scale.y;\r\n    }\r\n    _calculateDimension() {\r\n        const { width, height } = this.font.measureText(this._text);\r\n        this._textWidth = width;\r\n        this._textHeight = height;\r\n    }\r\n    get localBounds() {\r\n        return this.font.measureText(this._text).scale(this.scale);\r\n    }\r\n    _rotate(_ex) {\r\n        // None this is delegated to font\r\n        // This override erases the default behavior\r\n    }\r\n    _flip(_ex) {\r\n        // None this is delegated to font\r\n        // This override erases the default behavior\r\n    }\r\n    _drawImage(ex, x, y) {\r\n        var _a;\r\n        let color = Color.Black;\r\n        if (this.font instanceof Font) {\r\n            color = (_a = this.color) !== null && _a !== void 0 ? _a : this.font.color;\r\n        }\r\n        if (this.isStale() || this.font.isStale()) {\r\n            this.font.flipHorizontal = this.flipHorizontal;\r\n            this.font.flipVertical = this.flipVertical;\r\n            this.font.rotation = this.rotation;\r\n            this.font.origin = this.origin;\r\n            this.font.opacity = this.opacity;\r\n        }\r\n        const { width, height } = this.font.measureText(this._text);\r\n        this._textWidth = width;\r\n        this._textHeight = height;\r\n        this.font.render(ex, this._text, color, x, y);\r\n        if (this.font.showDebug) {\r\n            ex.debug.drawRect(x - width, y - height, width * 2, height * 2);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actor.ts\nvar Actor_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Type guard for checking if something is an Actor\r\n * @param x\r\n */\r\nfunction isActor(x) {\r\n    return x instanceof Actor;\r\n}\r\n/**\r\n * The most important primitive in Excalibur is an `Actor`. Anything that\r\n * can move on the screen, collide with another `Actor`, respond to events,\r\n * or interact with the current scene, must be an actor. An `Actor` **must**\r\n * be part of a [[Scene]] for it to be drawn to the screen.\r\n */\r\nclass Actor extends Entity {\r\n    // #endregion\r\n    /**\r\n     *\r\n     * @param config\r\n     */\r\n    constructor(config) {\r\n        super();\r\n        /**\r\n         * The anchor to apply all actor related transformations like rotation,\r\n         * translation, and scaling. By default the anchor is in the center of\r\n         * the actor. By default it is set to the center of the actor (.5, .5)\r\n         *\r\n         * An anchor of (.5, .5) will ensure that drawings are centered.\r\n         *\r\n         * Use `anchor.setTo` to set the anchor to a different point using\r\n         * values between 0 and 1. For example, anchoring to the top-left would be\r\n         * `Actor.anchor.setTo(0, 0)` and top-right would be `Actor.anchor.setTo(0, 1)`.\r\n         */\r\n        this._anchor = watch(Vector.Half, (v) => this._handleAnchorChange(v));\r\n        /**\r\n         * Convenience reference to the global logger\r\n         */\r\n        this.logger = Logger.getInstance();\r\n        /**\r\n         * The scene that the actor is in\r\n         */\r\n        this.scene = null;\r\n        /**\r\n         * @deprecated will be removed in v0.26.0\r\n         */\r\n        this.frames = {};\r\n        /**\r\n         * Access to the current drawing for the actor, this can be\r\n         * an [[Animation]], [[Sprite]], or [[Polygon]].\r\n         * Set drawings with [[setDrawing]].\r\n         * @deprecated will be removed in v0.26.0\r\n         */\r\n        this.currentDrawing = null;\r\n        /**\r\n         * Draggable helper\r\n         */\r\n        this._draggable = false;\r\n        this._dragging = false;\r\n        this._pointerDragStartHandler = () => {\r\n            this._dragging = true;\r\n        };\r\n        this._pointerDragEndHandler = () => {\r\n            this._dragging = false;\r\n        };\r\n        this._pointerDragMoveHandler = (pe) => {\r\n            if (this._dragging) {\r\n                this.pos = pe.worldPos;\r\n            }\r\n        };\r\n        this._pointerDragLeaveHandler = (pe) => {\r\n            if (this._dragging) {\r\n                this.pos = pe.worldPos;\r\n            }\r\n        };\r\n        /**\r\n         * Modify the current actor update pipeline.\r\n         * @deprecated will be removed in v0.26.0\r\n         */\r\n        this.traits = [];\r\n        const { name, x, y, pos, coordPlane, scale, width, height, radius, collider, vel, acc, rotation, angularVelocity, z, color, visible, anchor, collisionType, collisionGroup } = {\r\n            ...config\r\n        };\r\n        this._setName(name);\r\n        this.anchor = anchor !== null && anchor !== void 0 ? anchor : Actor.defaults.anchor.clone();\r\n        const tx = new TransformComponent();\r\n        this.addComponent(tx);\r\n        this.pos = pos !== null && pos !== void 0 ? pos : vec(x !== null && x !== void 0 ? x : 0, y !== null && y !== void 0 ? y : 0);\r\n        this.rotation = rotation !== null && rotation !== void 0 ? rotation : 0;\r\n        this.scale = scale !== null && scale !== void 0 ? scale : vec(1, 1);\r\n        this.z = z !== null && z !== void 0 ? z : 0;\r\n        tx.coordPlane = coordPlane !== null && coordPlane !== void 0 ? coordPlane : CoordPlane.World;\r\n        this.addComponent(new PointerComponent);\r\n        this.addComponent(new GraphicsComponent({\r\n            anchor: this.anchor\r\n        }));\r\n        this.addComponent(new CanvasDrawComponent((ctx, delta) => this.draw(ctx, delta)));\r\n        this.addComponent(new MotionComponent());\r\n        this.vel = vel !== null && vel !== void 0 ? vel : Vector.Zero;\r\n        this.acc = acc !== null && acc !== void 0 ? acc : Vector.Zero;\r\n        this.angularVelocity = angularVelocity !== null && angularVelocity !== void 0 ? angularVelocity : 0;\r\n        this.addComponent(new ActionsComponent());\r\n        this.addComponent(new BodyComponent());\r\n        this.body.collisionType = collisionType !== null && collisionType !== void 0 ? collisionType : CollisionType.Passive;\r\n        if (collisionGroup) {\r\n            this.body.group = collisionGroup;\r\n        }\r\n        if (collider) {\r\n            this.addComponent(new ColliderComponent(collider));\r\n        }\r\n        else if (radius) {\r\n            this.addComponent(new ColliderComponent(Shape.Circle(radius, this.anchor)));\r\n        }\r\n        else {\r\n            if (width > 0 && height > 0) {\r\n                this.addComponent(new ColliderComponent(Shape.Box(width, height, this.anchor)));\r\n            }\r\n            else {\r\n                this.addComponent(new ColliderComponent()); // no collider\r\n            }\r\n        }\r\n        this.graphics.visible = visible !== null && visible !== void 0 ? visible : true;\r\n        if (color) {\r\n            this.color = color;\r\n            if (width && height) {\r\n                this.graphics.add(new Rectangle({\r\n                    color: color,\r\n                    width,\r\n                    height\r\n                }));\r\n            }\r\n            else if (radius) {\r\n                this.graphics.add(new Circle({\r\n                    color: color,\r\n                    radius\r\n                }));\r\n            }\r\n        }\r\n        // Build default pipeline\r\n        if (Flags.isEnabled(Legacy.LegacyDrawing)) {\r\n            // TODO remove offscreen trait after legacy drawing removed\r\n            this.traits.push(new OffscreenCulling());\r\n        }\r\n    }\r\n    /**\r\n     * The physics body the is associated with this actor. The body is the container for all physical properties, like position, velocity,\r\n     * acceleration, mass, inertia, etc.\r\n     */\r\n    get body() {\r\n        return this.get(BodyComponent);\r\n    }\r\n    /**\r\n     * Access the Actor's built in [[TransformComponent]]\r\n     */\r\n    get transform() {\r\n        return this.get(TransformComponent);\r\n    }\r\n    /**\r\n     * Access the Actor's built in [[MotionComponent]]\r\n     */\r\n    get motion() {\r\n        return this.get(MotionComponent);\r\n    }\r\n    /**\r\n     * Access to the Actor's built in [[GraphicsComponent]]\r\n     */\r\n    get graphics() {\r\n        return this.get(GraphicsComponent);\r\n    }\r\n    /**\r\n     * Access to the Actor's built in [[ColliderComponent]]\r\n     */\r\n    get collider() {\r\n        return this.get(ColliderComponent);\r\n    }\r\n    /**\r\n     * Access to the Actor's built in [[PointerComponent]] config\r\n     */\r\n    get pointer() {\r\n        return this.get(PointerComponent);\r\n    }\r\n    /**\r\n     * Useful for quickly scripting actor behavior, like moving to a place, patrolling back and forth, blinking, etc.\r\n     *\r\n     *  Access to the Actor's built in [[ActionsComponent]] which forwards to the\r\n     * [[ActionContext|Action context]] of the actor.\r\n     */\r\n    get actions() {\r\n        return this.get(ActionsComponent);\r\n    }\r\n    /**\r\n     * Gets the position vector of the actor in pixels\r\n     */\r\n    get pos() {\r\n        return this.transform.pos;\r\n    }\r\n    /**\r\n     * Sets the position vector of the actor in pixels\r\n     */\r\n    set pos(thePos) {\r\n        this.transform.pos = thePos.clone();\r\n    }\r\n    /**\r\n     * Gets the position vector of the actor from the last frame\r\n     */\r\n    get oldPos() {\r\n        return this.body.oldPos;\r\n    }\r\n    /**\r\n     * Sets the position vector of the actor in the last frame\r\n     */\r\n    set oldPos(thePos) {\r\n        this.body.oldPos.setTo(thePos.x, thePos.y);\r\n    }\r\n    /**\r\n     * Gets the velocity vector of the actor in pixels/sec\r\n     */\r\n    get vel() {\r\n        return this.motion.vel;\r\n    }\r\n    /**\r\n     * Sets the velocity vector of the actor in pixels/sec\r\n     */\r\n    set vel(theVel) {\r\n        this.motion.vel = theVel.clone();\r\n    }\r\n    /**\r\n     * Gets the velocity vector of the actor from the last frame\r\n     */\r\n    get oldVel() {\r\n        return this.body.oldVel;\r\n    }\r\n    /**\r\n     * Sets the velocity vector of the actor from the last frame\r\n     */\r\n    set oldVel(theVel) {\r\n        this.body.oldVel.setTo(theVel.x, theVel.y);\r\n    }\r\n    /**\r\n     * Gets the acceleration vector of the actor in pixels/second/second. An acceleration pointing down such as (0, 100) may be\r\n     * useful to simulate a gravitational effect.\r\n     */\r\n    get acc() {\r\n        return this.motion.acc;\r\n    }\r\n    /**\r\n     * Sets the acceleration vector of teh actor in pixels/second/second\r\n     */\r\n    set acc(theAcc) {\r\n        this.motion.acc = theAcc.clone();\r\n    }\r\n    /**\r\n     * Sets the acceleration of the actor from the last frame. This does not include the global acc [[Physics.acc]].\r\n     */\r\n    set oldAcc(theAcc) {\r\n        this.body.oldAcc.setTo(theAcc.x, theAcc.y);\r\n    }\r\n    /**\r\n     * Gets the acceleration of the actor from the last frame. This does not include the global acc [[Physics.acc]].\r\n     */\r\n    get oldAcc() {\r\n        return this.body.oldAcc;\r\n    }\r\n    /**\r\n     * Gets the rotation of the actor in radians. 1 radian = 180/PI Degrees.\r\n     */\r\n    get rotation() {\r\n        return this.transform.rotation;\r\n    }\r\n    /**\r\n     * Sets the rotation of the actor in radians. 1 radian = 180/PI Degrees.\r\n     */\r\n    set rotation(theAngle) {\r\n        this.transform.rotation = theAngle;\r\n    }\r\n    /**\r\n     * Gets the rotational velocity of the actor in radians/second\r\n     */\r\n    get angularVelocity() {\r\n        return this.motion.angularVelocity;\r\n    }\r\n    /**\r\n     * Sets the rotational velocity of the actor in radians/sec\r\n     */\r\n    set angularVelocity(angularVelocity) {\r\n        this.motion.angularVelocity = angularVelocity;\r\n    }\r\n    get scale() {\r\n        return this.get(TransformComponent).scale;\r\n    }\r\n    set scale(scale) {\r\n        this.get(TransformComponent).scale = scale;\r\n    }\r\n    get anchor() {\r\n        return this._anchor;\r\n    }\r\n    set anchor(vec) {\r\n        this._anchor = watch(vec, (v) => this._handleAnchorChange(v));\r\n        this._handleAnchorChange(vec);\r\n    }\r\n    _handleAnchorChange(v) {\r\n        if (this.graphics) {\r\n            this.graphics.anchor = v;\r\n        }\r\n    }\r\n    /**\r\n     * Indicates whether the actor is physically in the viewport\r\n     */\r\n    get isOffScreen() {\r\n        return this.hasTag('offscreen');\r\n    }\r\n    /**\r\n     * The visibility of an actor\r\n     * @deprecated Use [[GraphicsComponent.visible|Actor.graphics.visible]], will be removed in v0.26.0\r\n     */\r\n    get visible() {\r\n        return this.graphics.visible;\r\n    }\r\n    set visible(isVisible) {\r\n        this.graphics.visible = isVisible;\r\n    }\r\n    /**\r\n     * The opacity of an actor.\r\n     *\r\n     * @deprecated Actor.opacity will be removed in v0.26.0, use [[GraphicsComponent.opacity|Actor.graphics.opacity]].\r\n     */\r\n    get opacity() {\r\n        return this.graphics.opacity;\r\n    }\r\n    set opacity(opacity) {\r\n        this.graphics.opacity = opacity;\r\n    }\r\n    get draggable() {\r\n        return this._draggable;\r\n    }\r\n    set draggable(isDraggable) {\r\n        if (isDraggable) {\r\n            if (isDraggable && !this._draggable) {\r\n                this.on('pointerdragstart', this._pointerDragStartHandler);\r\n                this.on('pointerdragend', this._pointerDragEndHandler);\r\n                this.on('pointerdragmove', this._pointerDragMoveHandler);\r\n                this.on('pointerdragleave', this._pointerDragLeaveHandler);\r\n            }\r\n            else if (!isDraggable && this._draggable) {\r\n                this.off('pointerdragstart', this._pointerDragStartHandler);\r\n                this.off('pointerdragend', this._pointerDragEndHandler);\r\n                this.off('pointerdragmove', this._pointerDragMoveHandler);\r\n                this.off('pointerdragleave', this._pointerDragLeaveHandler);\r\n            }\r\n            this._draggable = isDraggable;\r\n        }\r\n    }\r\n    /**\r\n     * Sets the color of the actor's current graphic\r\n     */\r\n    get color() {\r\n        return this._color;\r\n    }\r\n    set color(v) {\r\n        var _a;\r\n        this._color = v.clone();\r\n        const defaultLayer = this.graphics.layers.default;\r\n        const currentGraphic = (_a = defaultLayer.graphics[0]) === null || _a === void 0 ? void 0 : _a.graphic;\r\n        if (currentGraphic instanceof Raster || currentGraphic instanceof Text) {\r\n            currentGraphic.color = this._color;\r\n        }\r\n    }\r\n    /**\r\n     * `onInitialize` is called before the first update of the actor. This method is meant to be\r\n     * overridden. This is where initialization of child actors should take place.\r\n     *\r\n     * Synonymous with the event handler `.on('initialize', (evt) => {...})`\r\n     */\r\n    onInitialize(_engine) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * Initializes this actor and all it's child actors, meant to be called by the Scene before first update not by users of Excalibur.\r\n     *\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * @internal\r\n     */\r\n    _initialize(engine) {\r\n        super._initialize(engine);\r\n        for (const child of this.children) {\r\n            child._initialize(engine);\r\n        }\r\n    }\r\n    on(eventName, handler) {\r\n        super.on(eventName, handler);\r\n    }\r\n    once(eventName, handler) {\r\n        super.once(eventName, handler);\r\n    }\r\n    off(eventName, handler) {\r\n        super.off(eventName, handler);\r\n    }\r\n    // #endregion\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _prekill handler for [[onPreKill]] lifecycle event\r\n     * @internal\r\n     */\r\n    _prekill(_scene) {\r\n        super.emit('prekill', new PreKillEvent(this));\r\n        this.onPreKill(_scene);\r\n    }\r\n    /**\r\n     * Safe to override onPreKill lifecycle event handler. Synonymous with `.on('prekill', (evt) =>{...})`\r\n     *\r\n     * `onPreKill` is called directly before an actor is killed and removed from its current [[Scene]].\r\n     */\r\n    onPreKill(_scene) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _prekill handler for [[onPostKill]] lifecycle event\r\n     * @internal\r\n     */\r\n    _postkill(_scene) {\r\n        super.emit('postkill', new PostKillEvent(this));\r\n        this.onPostKill(_scene);\r\n    }\r\n    /**\r\n     * Safe to override onPostKill lifecycle event handler. Synonymous with `.on('postkill', (evt) => {...})`\r\n     *\r\n     * `onPostKill` is called directly after an actor is killed and remove from its current [[Scene]].\r\n     */\r\n    onPostKill(_scene) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * If the current actor is a member of the scene, this will remove\r\n     * it from the scene graph. It will no longer be drawn or updated.\r\n     */\r\n    kill() {\r\n        if (this.scene) {\r\n            this._prekill(this.scene);\r\n            this.emit('kill', new KillEvent(this));\r\n            super.kill();\r\n            this._postkill(this.scene);\r\n        }\r\n        else {\r\n            this.logger.warn('Cannot kill actor, it was never added to the Scene');\r\n        }\r\n    }\r\n    /**\r\n     * If the current actor is killed, it will now not be killed.\r\n     */\r\n    unkill() {\r\n        this.active = true;\r\n    }\r\n    /**\r\n     * Indicates wether the actor has been killed.\r\n     */\r\n    isKilled() {\r\n        return !this.active;\r\n    }\r\n    setDrawing(key) {\r\n        key = key.toString();\r\n        if (this.currentDrawing !== this.frames[key]) {\r\n            if (this.frames[key] != null) {\r\n                this.frames[key].reset();\r\n                this.currentDrawing = this.frames[key];\r\n            }\r\n            else {\r\n                Logger.getInstance().error(`the specified drawing key ${key} does not exist`);\r\n            }\r\n        }\r\n        if (this.currentDrawing && this.currentDrawing instanceof Animation_Animation) {\r\n            this.currentDrawing.tick(0);\r\n        }\r\n    }\r\n    addDrawing() {\r\n        if (arguments.length === 2) {\r\n            this.frames[arguments[0]] = arguments[1];\r\n            if (!this.currentDrawing) {\r\n                this.currentDrawing = arguments[1];\r\n            }\r\n        }\r\n        else {\r\n            if (arguments[0] instanceof Sprite_Sprite) {\r\n                this.addDrawing('default', arguments[0]);\r\n            }\r\n            if (arguments[0] instanceof Texture) {\r\n                this.addDrawing('default', arguments[0].asSprite());\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Gets the z-index of an actor. The z-index determines the relative order an actor is drawn in.\r\n     * Actors with a higher z-index are drawn on top of actors with a lower z-index\r\n     */\r\n    get z() {\r\n        return this.get(TransformComponent).z;\r\n    }\r\n    /**\r\n     * @deprecated Use [[Actor.z]], will be removed in v0.26.0\r\n     */\r\n    getZIndex() {\r\n        return this.get(TransformComponent).z;\r\n    }\r\n    /**\r\n     * Sets the z-index of an actor and updates it in the drawing list for the scene.\r\n     * The z-index determines the relative order an actor is drawn in.\r\n     * Actors with a higher z-index are drawn on top of actors with a lower z-index\r\n     * @param newZ new z-index to assign\r\n     */\r\n    set z(newZ) {\r\n        this.get(TransformComponent).z = newZ;\r\n    }\r\n    /**\r\n     * @param newIndex new z-index to assign\r\n     * @deprecated Use [[Actor.z]], will be removed in v0.26.0\r\n     */\r\n    setZIndex(newIndex) {\r\n        this.get(TransformComponent).z = newIndex;\r\n    }\r\n    /**\r\n     * Get the center point of an actor (global position)\r\n     */\r\n    get center() {\r\n        const globalPos = this.getGlobalPos();\r\n        return new Vector(globalPos.x + this.width / 2 - this.anchor.x * this.width, globalPos.y + this.height / 2 - this.anchor.y * this.height);\r\n    }\r\n    /**\r\n     * Get the local center point of an actor\r\n     */\r\n    get localCenter() {\r\n        return new Vector(this.pos.x + this.width / 2 - this.anchor.x * this.width, this.pos.y + this.height / 2 - this.anchor.y * this.height);\r\n    }\r\n    get width() {\r\n        return this.collider.localBounds.width * this.getGlobalScale().x;\r\n    }\r\n    get height() {\r\n        return this.collider.localBounds.height * this.getGlobalScale().y;\r\n    }\r\n    /**\r\n     * Gets this actor's rotation taking into account any parent relationships\r\n     *\r\n     * @returns Rotation angle in radians\r\n     */\r\n    getGlobalRotation() {\r\n        return this.get(TransformComponent).globalRotation;\r\n    }\r\n    /**\r\n     * Gets an actor's world position taking into account parent relationships, scaling, rotation, and translation\r\n     *\r\n     * @returns Position in world coordinates\r\n     */\r\n    getGlobalPos() {\r\n        return this.get(TransformComponent).globalPos;\r\n    }\r\n    /**\r\n     * Gets the global scale of the Actor\r\n     */\r\n    getGlobalScale() {\r\n        return this.get(TransformComponent).globalScale;\r\n    }\r\n    // #region Collision\r\n    /**\r\n     * Tests whether the x/y specified are contained in the actor\r\n     * @param x  X coordinate to test (in world coordinates)\r\n     * @param y  Y coordinate to test (in world coordinates)\r\n     * @param recurse checks whether the x/y are contained in any child actors (if they exist).\r\n     */\r\n    contains(x, y, recurse = false) {\r\n        const point = vec(x, y);\r\n        const collider = this.get(ColliderComponent);\r\n        collider.update();\r\n        const geom = collider.get();\r\n        if (!geom) {\r\n            return false;\r\n        }\r\n        const containment = geom.contains(point);\r\n        if (recurse) {\r\n            return (containment ||\r\n                this.children.some((child) => {\r\n                    return child.contains(x, y, true);\r\n                }));\r\n        }\r\n        return containment;\r\n    }\r\n    /**\r\n     * Returns true if the two actor.collider's surfaces are less than or equal to the distance specified from each other\r\n     * @param actor     Actor to test\r\n     * @param distance  Distance in pixels to test\r\n     */\r\n    within(actor, distance) {\r\n        const collider = this.get(ColliderComponent);\r\n        const otherCollider = actor.get(ColliderComponent);\r\n        const me = collider.get();\r\n        const other = otherCollider.get();\r\n        if (me && other) {\r\n            return me.getClosestLineBetween(other).getLength() <= distance;\r\n        }\r\n        return false;\r\n    }\r\n    // #endregion\r\n    // #region Update\r\n    /**\r\n     * Called by the Engine, updates the state of the actor\r\n     * @internal\r\n     * @param engine The reference to the current game engine\r\n     * @param delta  The time elapsed since the last update in milliseconds\r\n     */\r\n    update(engine, delta) {\r\n        this._initialize(engine);\r\n        this._preupdate(engine, delta);\r\n        // Tick animations\r\n        const drawing = this.currentDrawing;\r\n        if (drawing && drawing instanceof Animation_Animation) {\r\n            drawing.tick(delta, engine.stats.currFrame.id);\r\n        }\r\n        // Update actor pipeline (movement, collision detection, event propagation, offscreen culling)\r\n        for (const trait of this.traits) {\r\n            trait.update(this, engine, delta);\r\n        }\r\n        this._postupdate(engine, delta);\r\n    }\r\n    /**\r\n     * Safe to override onPreUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPreUpdate` is called directly before an actor is updated.\r\n     */\r\n    onPreUpdate(_engine, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('postupdate', (evt) =>{...})`\r\n     *\r\n     * `onPostUpdate` is called directly after an actor is updated.\r\n     */\r\n    onPostUpdate(_engine, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPreUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _preupdate(engine, delta) {\r\n        this.emit('preupdate', new PreUpdateEvent(engine, delta, this));\r\n        this.onPreUpdate(engine, delta);\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPostUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _postupdate(engine, delta) {\r\n        this.emit('postupdate', new PreUpdateEvent(engine, delta, this));\r\n        this.onPostUpdate(engine, delta);\r\n    }\r\n    // endregion\r\n    // #region Drawing\r\n    /**\r\n     * Called by the Engine, draws the actor to the screen\r\n     * @param ctx   The rendering context\r\n     * @param delta The time since the last draw in milliseconds\r\n     *\r\n     * **Warning** only works with Flags.useLegacyDrawing() enabled\r\n     * @deprecated Use Actor.graphics, will be removed in v0.26.0\r\n     */\r\n    draw(ctx, delta) {\r\n        var _a;\r\n        // translate canvas by anchor offset\r\n        ctx.save();\r\n        if (this.currentDrawing) {\r\n            ctx.translate(-(this.width * this.anchor.x), -(this.height * this.anchor.y));\r\n            this._predraw(ctx, delta);\r\n            const drawing = this.currentDrawing;\r\n            // See https://github.com/excaliburjs/Excalibur/pull/619 for discussion on this formula\r\n            const offsetX = (this.width - drawing.width * drawing.scale.x) * this.anchor.x;\r\n            const offsetY = (this.height - drawing.height * drawing.scale.y) * this.anchor.y;\r\n            this.currentDrawing.draw({ ctx, x: offsetX, y: offsetY, opacity: this.graphics.opacity });\r\n        }\r\n        else {\r\n            this._predraw(ctx, delta);\r\n            if (this.color && this.collider) {\r\n                // update collider geometry based on transform\r\n                const collider = this.get(ColliderComponent);\r\n                collider.update();\r\n                if (collider && !collider.bounds.hasZeroDimensions()) {\r\n                    // Colliders are already shifted by anchor, unshift\r\n                    ctx.globalAlpha = this.graphics.opacity;\r\n                    (_a = collider.get()) === null || _a === void 0 ? void 0 : _a.draw(ctx, this.color, vec(0, 0));\r\n                }\r\n            }\r\n        }\r\n        ctx.restore();\r\n        this._postdraw(ctx, delta);\r\n    }\r\n    /**\r\n     * Safe to override onPreDraw lifecycle event handler. Synonymous with `.on('predraw', (evt) =>{...})`\r\n     *\r\n     * `onPreDraw` is called directly before an actor is drawn, but after local transforms are made.\r\n     *\r\n     * **Warning** only works with Flags.useLegacyDrawing() enabled\r\n     * @deprecated Use Actor.graphics.onPostDraw, will be removed in v0.26.0\r\n     */\r\n    onPreDraw(_ctx, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * Safe to override onPostDraw lifecycle event handler. Synonymous with `.on('postdraw', (evt) =>{...})`\r\n     *\r\n     * `onPostDraw` is called directly after an actor is drawn, and before local transforms are removed.\r\n     *\r\n     * **Warning** only works with Flags.useLegacyDrawing() enabled\r\n     * @deprecated Use Actor.graphics.onPostDraw, will be removed in v0.26.0\r\n     */\r\n    onPostDraw(_ctx, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _predraw handler for [[onPreDraw]] lifecycle event\r\n     *\r\n     * **Warning** only works with Flags.useLegacyDrawing() enabled\r\n     * @deprecated Use Actor.graphics.onPreDraw, will be removed in v0.26.0\r\n     * @internal\r\n     */\r\n    _predraw(ctx, delta) {\r\n        this.emit('predraw', new PreDrawEvent(ctx, delta, this));\r\n        this.onPreDraw(ctx, delta);\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _postdraw handler for [[onPostDraw]] lifecycle event\r\n     *\r\n     * **Warning** only works with Flags.useLegacyDrawing() enabled\r\n     * @deprecated Use Actor.graphics.onPostDraw, will be removed in v0.26.0\r\n     * @internal\r\n     */\r\n    _postdraw(ctx, delta) {\r\n        this.emit('postdraw', new PreDrawEvent(ctx, delta, this));\r\n        this.onPostDraw(ctx, delta);\r\n    }\r\n    /**\r\n     * Called by the Engine, draws the actors debugging to the screen\r\n     * @param ctx The rendering context\r\n     *\r\n     *\r\n     * **Warning** only works with Flags.useLegacyDrawing() enabled\r\n     * @deprecated will be removed in v0.26.0\r\n     * @internal\r\n     */\r\n    /* istanbul ignore next */\r\n    debugDraw(_ctx) {\r\n        // pass\r\n    }\r\n}\r\n// #region Properties\r\n/**\r\n * Set defaults for all Actors\r\n */\r\nActor.defaults = {\r\n    anchor: Vector.Half\r\n};\r\nActor_decorate([\r\n    obsolete({ message: 'Actor.visible will be removed in v0.26.0', alternateMethod: 'Use Actor.graphics.visible' })\r\n], Actor.prototype, \"visible\", null);\r\nActor_decorate([\r\n    obsolete({\r\n        message: 'Actor.opacity will be removed in v0.26.0',\r\n        alternateMethod: 'Use Actor.graphics.opacity'\r\n    })\r\n], Actor.prototype, \"opacity\", null);\r\nActor_decorate([\r\n    obsolete({\r\n        message: 'Actor.setDrawing will be removed in v0.26.0',\r\n        alternateMethod: 'Use Actor.graphics.show() or Actor.graphics.use()'\r\n    })\r\n], Actor.prototype, \"setDrawing\", null);\r\nActor_decorate([\r\n    obsolete({\r\n        message: 'Actor.addDrawing will be removed in v0.26.0',\r\n        alternateMethod: 'Use Actor.graphics.add()'\r\n    })\r\n], Actor.prototype, \"addDrawing\", null);\r\nActor_decorate([\r\n    obsolete({\r\n        message: 'Actor.getZIndex will be removed in v0.26.0',\r\n        alternateMethod: 'Use Actor.transform.z or Actor.z'\r\n    })\r\n], Actor.prototype, \"getZIndex\", null);\r\nActor_decorate([\r\n    obsolete({\r\n        message: 'Actor.setZIndex will be removed in v0.26.0',\r\n        alternateMethod: 'Use Actor.transform.z or Actor.z'\r\n    })\r\n], Actor.prototype, \"setZIndex\", null);\r\n\n;// CONCATENATED MODULE: ./ScreenElement.ts\n\r\n\r\n\r\n\r\n/**\r\n * Helper [[Actor]] primitive for drawing UI's, optimized for UI drawing. Does\r\n * not participate in collisions. Drawn on top of all other actors.\r\n */\r\nclass ScreenElement_ScreenElement extends Actor {\r\n    constructor(config) {\r\n        super({ ...config });\r\n        this.get(TransformComponent).coordPlane = CoordPlane.Screen;\r\n        this.anchor = vec(0, 0);\r\n        this.body.collisionType = CollisionType.PreventCollision;\r\n        this.collider.useBoxCollider(this.width, this.height, this.anchor);\r\n    }\r\n    _initialize(engine) {\r\n        this._engine = engine;\r\n        super._initialize(engine);\r\n    }\r\n    contains(x, y, useWorld = true) {\r\n        if (useWorld) {\r\n            return super.contains(x, y);\r\n        }\r\n        const coords = this._engine.worldToScreenCoordinates(new Vector(x, y));\r\n        return super.contains(coords.x, coords.y);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Timer.ts\nvar Timer_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\n\r\n/**\r\n * The Excalibur timer hooks into the internal timer and fires callbacks,\r\n * after a certain interval, optionally repeating.\r\n */\r\nclass Timer {\r\n    constructor(fcn, interval, repeats, numberOfRepeats) {\r\n        this._logger = Logger.getInstance();\r\n        this.id = 0;\r\n        this._elapsedTime = 0;\r\n        this._totalTimeAlive = 0;\r\n        this._running = false;\r\n        this._numberOfTicks = 0;\r\n        this.interval = 10;\r\n        this.repeats = false;\r\n        this.maxNumberOfRepeats = -1;\r\n        this._complete = false;\r\n        this.scene = null;\r\n        if (typeof fcn !== 'function') {\r\n            const options = fcn;\r\n            fcn = options.fcn;\r\n            interval = options.interval;\r\n            repeats = options.repeats;\r\n            numberOfRepeats = options.numberOfRepeats;\r\n        }\r\n        if (!!numberOfRepeats && numberOfRepeats >= 0) {\r\n            this.maxNumberOfRepeats = numberOfRepeats;\r\n            if (!repeats) {\r\n                throw new Error('repeats must be set to true if numberOfRepeats is set');\r\n            }\r\n        }\r\n        this.id = Timer._MAX_ID++;\r\n        this.interval = interval || this.interval;\r\n        this.repeats = repeats || this.repeats;\r\n        this._callbacks = [];\r\n        if (fcn) {\r\n            this.on(fcn);\r\n        }\r\n    }\r\n    get complete() {\r\n        return this._complete;\r\n    }\r\n    /**\r\n     * Adds a new callback to be fired after the interval is complete\r\n     * @param fcn The callback to be added to the callback list, to be fired after the interval is complete.\r\n     */\r\n    on(fcn) {\r\n        this._callbacks.push(fcn);\r\n    }\r\n    /**\r\n     * Removes a callback from the callback list to be fired after the interval is complete.\r\n     * @param fcn The callback to be removed from the callback list, to be fired after the interval is complete.\r\n     */\r\n    off(fcn) {\r\n        const index = this._callbacks.indexOf(fcn);\r\n        this._callbacks.splice(index, 1);\r\n    }\r\n    /**\r\n     * Updates the timer after a certain number of milliseconds have elapsed. This is used internally by the engine.\r\n     * @param delta  Number of elapsed milliseconds since the last update.\r\n     */\r\n    update(delta) {\r\n        if (this._running) {\r\n            this._totalTimeAlive += delta;\r\n            this._elapsedTime += delta;\r\n            if (this.maxNumberOfRepeats > -1 && this._numberOfTicks >= this.maxNumberOfRepeats) {\r\n                this._complete = true;\r\n                this._running = false;\r\n                this._elapsedTime = 0;\r\n            }\r\n            if (!this.complete && this._elapsedTime >= this.interval) {\r\n                this._callbacks.forEach((c) => {\r\n                    c.call(this);\r\n                });\r\n                this._numberOfTicks++;\r\n                if (this.repeats) {\r\n                    this._elapsedTime = 0;\r\n                }\r\n                else {\r\n                    this._complete = true;\r\n                    this._running = false;\r\n                    this._elapsedTime = 0;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Resets the timer so that it can be reused, and optionally reconfigure the timers interval.\r\n     *\r\n     * Warning** you may need to call `timer.start()` again if the timer had completed\r\n     * @param newInterval If specified, sets a new non-negative interval in milliseconds to refire the callback\r\n     * @param newNumberOfRepeats If specified, sets a new non-negative upper limit to the number of time this timer executes\r\n     */\r\n    reset(newInterval, newNumberOfRepeats) {\r\n        if (!!newInterval && newInterval >= 0) {\r\n            this.interval = newInterval;\r\n        }\r\n        if (!!this.maxNumberOfRepeats && this.maxNumberOfRepeats >= 0) {\r\n            this.maxNumberOfRepeats = newNumberOfRepeats;\r\n            if (!this.repeats) {\r\n                throw new Error('repeats must be set to true if numberOfRepeats is set');\r\n            }\r\n        }\r\n        this._complete = false;\r\n        this._elapsedTime = 0;\r\n        this._numberOfTicks = 0;\r\n    }\r\n    get timesRepeated() {\r\n        return this._numberOfTicks;\r\n    }\r\n    getTimeRunning() {\r\n        return this._totalTimeAlive;\r\n    }\r\n    /**\r\n     * @returns milliseconds until the next action callback, if complete will return 0\r\n     */\r\n    get timeToNextAction() {\r\n        if (this.complete) {\r\n            return 0;\r\n        }\r\n        return this.interval - this._elapsedTime;\r\n    }\r\n    /**\r\n     * @returns milliseconds elapsed toward the next action\r\n     */\r\n    get timeElapsedTowardNextAction() {\r\n        return this._elapsedTime;\r\n    }\r\n    get isRunning() {\r\n        return this._running;\r\n    }\r\n    /**\r\n     * Pauses the timer, time will no longer increment towards the next call\r\n     */\r\n    pause() {\r\n        this._running = false;\r\n        return this;\r\n    }\r\n    /**\r\n     * Unpauses the timer. Time will now increment towards the next call\r\n     * @deprecated Will be removed in v0.26.0\r\n     */\r\n    unpause() {\r\n        this._running = true;\r\n    }\r\n    /**\r\n     * Resumes the timer, time will now increment towards the next call.\r\n     */\r\n    resume() {\r\n        this._running = true;\r\n        return this;\r\n    }\r\n    /**\r\n     * Starts the timer, if the timer was complete it will restart the timer and reset the elapsed time counter\r\n     */\r\n    start() {\r\n        if (!this.scene) {\r\n            this._logger.warn('Cannot start a timer not part of a scene, timer wont start until added');\r\n        }\r\n        this._running = true;\r\n        if (this.complete) {\r\n            this._complete = false;\r\n            this._elapsedTime = 0;\r\n            this._numberOfTicks = 0;\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Stops the timer and resets the elapsed time counter towards the next action invocation\r\n     */\r\n    stop() {\r\n        this._running = false;\r\n        this._elapsedTime = 0;\r\n        this._numberOfTicks = 0;\r\n        return this;\r\n    }\r\n    /**\r\n     * Cancels the timer, preventing any further executions.\r\n     */\r\n    cancel() {\r\n        this.pause();\r\n        if (this.scene) {\r\n            this.scene.cancelTimer(this);\r\n        }\r\n    }\r\n}\r\nTimer._MAX_ID = 0;\r\nTimer_decorate([\r\n    obsolete({ message: 'Will be removed in v0.26.0', alternateMethod: 'Use Timer.resume()' })\r\n], Timer.prototype, \"unpause\", null);\r\n\n;// CONCATENATED MODULE: ./Graphics/DebugGraphicsComponent.ts\n\r\n/**\r\n * Provide arbitrary drawing for the purposes of debugging your game\r\n *\r\n * Will only show when the Engine is set to debug mode [[Engine.showDebug]] or [[Engine.toggleDebug]]\r\n *\r\n */\r\nclass DebugGraphicsComponent extends Component {\r\n    constructor(draw) {\r\n        super();\r\n        this.draw = draw;\r\n        this.type = 'ex.debuggraphics';\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./TileMap.ts\nvar TileMap_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * @hidden\r\n */\r\nclass TileMapImpl extends Entity {\r\n    /**\r\n     * @param xOrConfig     The x coordinate to anchor the TileMap's upper left corner (should not be changed once set) or TileMap option bag\r\n     * @param y             The y coordinate to anchor the TileMap's upper left corner (should not be changed once set)\r\n     * @param cellWidth     The individual width of each cell (in pixels) (should not be changed once set)\r\n     * @param cellHeight    The individual height of each cell (in pixels) (should not be changed once set)\r\n     * @param rows          The number of rows in the TileMap (should not be changed once set)\r\n     * @param cols          The number of cols in the TileMap (should not be changed once set)\r\n     */\r\n    constructor(xOrConfig, y, cellWidth, cellHeight, rows, cols) {\r\n        super();\r\n        this._token = 0;\r\n        this._onScreenXStart = 0;\r\n        this._onScreenXEnd = 9999;\r\n        this._onScreenYStart = 0;\r\n        this._onScreenYEnd = 9999;\r\n        this._spriteSheets = {};\r\n        this._legacySpriteMap = new Map();\r\n        this.logger = Logger.getInstance();\r\n        this.data = [];\r\n        this._rows = [];\r\n        this._cols = [];\r\n        this.visible = true;\r\n        this.isOffscreen = false;\r\n        this._dirty = true;\r\n        if (xOrConfig && typeof xOrConfig === 'object') {\r\n            const config = xOrConfig;\r\n            xOrConfig = config.x;\r\n            y = config.y;\r\n            cellWidth = config.cellWidth;\r\n            cellHeight = config.cellHeight;\r\n            rows = config.rows;\r\n            cols = config.cols;\r\n        }\r\n        this.addComponent(new TransformComponent());\r\n        this.addComponent(new MotionComponent());\r\n        this.addComponent(new BodyComponent({\r\n            type: CollisionType.Fixed\r\n        }));\r\n        this.addComponent(new CanvasDrawComponent((ctx, delta) => this.draw(ctx, delta)));\r\n        this.addComponent(new GraphicsComponent({\r\n            onPostDraw: (ctx, delta) => this.draw(ctx, delta)\r\n        }));\r\n        this.addComponent(new DebugGraphicsComponent((ctx) => this.debug(ctx)));\r\n        this.addComponent(new ColliderComponent());\r\n        this._transform = this.get(TransformComponent);\r\n        this._motion = this.get(MotionComponent);\r\n        this._collider = this.get(ColliderComponent);\r\n        this._composite = this._collider.useCompositeCollider([]);\r\n        this.x = xOrConfig;\r\n        this.y = y;\r\n        this.cellWidth = cellWidth;\r\n        this.cellHeight = cellHeight;\r\n        this.rows = rows;\r\n        this.cols = cols;\r\n        this.data = new Array(rows * cols);\r\n        this._rows = new Array(rows);\r\n        this._cols = new Array(cols);\r\n        let currentCol = [];\r\n        for (let i = 0; i < cols; i++) {\r\n            for (let j = 0; j < rows; j++) {\r\n                const cd = new Cell(i * cellWidth + xOrConfig, j * cellHeight + y, cellWidth, cellHeight, i + j * cols);\r\n                cd.map = this;\r\n                this.data[i + j * cols] = cd;\r\n                currentCol.push(cd);\r\n                if (!this._rows[j]) {\r\n                    this._rows[j] = [];\r\n                }\r\n                this._rows[j].push(cd);\r\n            }\r\n            this._cols[i] = currentCol;\r\n            currentCol = [];\r\n        }\r\n        this.get(GraphicsComponent).localBounds = new BoundingBox({\r\n            left: 0,\r\n            top: 0,\r\n            right: this.cols * this.cellWidth,\r\n            bottom: this.rows * this.cellHeight\r\n        });\r\n    }\r\n    flagDirty() {\r\n        this._dirty = true;\r\n    }\r\n    get x() {\r\n        var _a;\r\n        return (_a = this._transform.pos.x) !== null && _a !== void 0 ? _a : 0;\r\n    }\r\n    set x(val) {\r\n        var _a;\r\n        if ((_a = this._transform) === null || _a === void 0 ? void 0 : _a.pos) {\r\n            this.get(TransformComponent).pos = vec(val, this.y);\r\n        }\r\n    }\r\n    get y() {\r\n        var _a, _b;\r\n        return (_b = (_a = this._transform) === null || _a === void 0 ? void 0 : _a.pos.y) !== null && _b !== void 0 ? _b : 0;\r\n    }\r\n    set y(val) {\r\n        var _a;\r\n        if ((_a = this._transform) === null || _a === void 0 ? void 0 : _a.pos) {\r\n            this._transform.pos = vec(this.x, val);\r\n        }\r\n    }\r\n    get z() {\r\n        var _a;\r\n        return (_a = this._transform.z) !== null && _a !== void 0 ? _a : 0;\r\n    }\r\n    set z(val) {\r\n        if (this._transform) {\r\n            this._transform.z = val;\r\n        }\r\n    }\r\n    get rotation() {\r\n        var _a, _b;\r\n        return (_b = (_a = this._transform) === null || _a === void 0 ? void 0 : _a.rotation) !== null && _b !== void 0 ? _b : 0;\r\n    }\r\n    set rotation(val) {\r\n        var _a;\r\n        if ((_a = this._transform) === null || _a === void 0 ? void 0 : _a.rotation) {\r\n            this._transform.rotation = val;\r\n        }\r\n    }\r\n    get scale() {\r\n        var _a, _b;\r\n        return (_b = (_a = this._transform) === null || _a === void 0 ? void 0 : _a.scale) !== null && _b !== void 0 ? _b : Vector.One;\r\n    }\r\n    set scale(val) {\r\n        var _a;\r\n        if ((_a = this._transform) === null || _a === void 0 ? void 0 : _a.scale) {\r\n            this._transform.scale = val;\r\n        }\r\n    }\r\n    get pos() {\r\n        return this._transform.pos;\r\n    }\r\n    set pos(val) {\r\n        this._transform.pos = val;\r\n    }\r\n    get vel() {\r\n        return this._motion.vel;\r\n    }\r\n    set vel(val) {\r\n        this._motion.vel = val;\r\n    }\r\n    on(eventName, handler) {\r\n        super.on(eventName, handler);\r\n    }\r\n    _initialize(engine) {\r\n        super._initialize(engine);\r\n    }\r\n    registerSpriteSheet(key, spriteSheet) {\r\n        if (spriteSheet instanceof SpriteSheet) {\r\n            this._spriteSheets[key] = spriteSheet;\r\n        }\r\n        else {\r\n            this._spriteSheets[key] = SpriteSheet.fromLegacySpriteSheet(spriteSheet);\r\n        }\r\n    }\r\n    /**\r\n     * Tiles colliders based on the solid tiles in the tilemap.\r\n     */\r\n    _updateColliders() {\r\n        this._composite.clearColliders();\r\n        const colliders = [];\r\n        let current;\r\n        // Bad square tesselation algo\r\n        for (let i = 0; i < this.cols; i++) {\r\n            // Scan column for colliders\r\n            for (let j = 0; j < this.rows; j++) {\r\n                // Columns start with a new collider\r\n                if (j === 0) {\r\n                    current = null;\r\n                }\r\n                const tile = this.data[i + j * this.cols];\r\n                // Current tile in column is solid build up current collider\r\n                if (tile.solid) {\r\n                    if (!current) {\r\n                        current = tile.bounds;\r\n                    }\r\n                    else {\r\n                        current = current.combine(tile.bounds);\r\n                    }\r\n                }\r\n                else {\r\n                    // Not solid skip and cut off the current collider\r\n                    if (current) {\r\n                        colliders.push(current);\r\n                    }\r\n                    current = null;\r\n                }\r\n            }\r\n            // After a column is complete check to see if it can be merged into the last one\r\n            if (current) {\r\n                // if previous is the same combine it\r\n                const prev = colliders[colliders.length - 1];\r\n                if (prev && prev.top === current.top && prev.bottom === current.bottom) {\r\n                    colliders[colliders.length - 1] = prev.combine(current);\r\n                }\r\n                else {\r\n                    // else new collider\r\n                    colliders.push(current);\r\n                }\r\n            }\r\n        }\r\n        this._composite = this._collider.useCompositeCollider([]);\r\n        for (const c of colliders) {\r\n            const collider = Shape.Box(c.width, c.height, Vector.Zero, vec(c.left - this.pos.x, c.top - this.pos.y));\r\n            collider.owner = this;\r\n            this._composite.addCollider(collider);\r\n        }\r\n        this._collider.update();\r\n    }\r\n    /**\r\n     * Returns the [[Cell]] by index (row major order)\r\n     */\r\n    getCellByIndex(index) {\r\n        return this.data[index];\r\n    }\r\n    /**\r\n     * Returns the [[Cell]] by its x and y coordinates\r\n     */\r\n    getCell(x, y) {\r\n        if (x < 0 || y < 0 || x >= this.cols || y >= this.rows) {\r\n            return null;\r\n        }\r\n        return this.data[x + y * this.cols];\r\n    }\r\n    /**\r\n     * Returns the [[Cell]] by testing a point in global coordinates,\r\n     * returns `null` if no cell was found.\r\n     */\r\n    getCellByPoint(x, y) {\r\n        x = Math.floor((x - this.pos.x) / this.cellWidth);\r\n        y = Math.floor((y - this.pos.y) / this.cellHeight);\r\n        const cell = this.getCell(x, y);\r\n        if (x >= 0 && y >= 0 && x < this.cols && y < this.rows && cell) {\r\n            return cell;\r\n        }\r\n        return null;\r\n    }\r\n    getRows() {\r\n        return this._rows;\r\n    }\r\n    getColumns() {\r\n        return this._cols;\r\n    }\r\n    onPreUpdate(_engine, _delta) {\r\n        // Override me\r\n    }\r\n    onPostUpdate(_engine, _delta) {\r\n        // Override me\r\n    }\r\n    update(engine, delta) {\r\n        this.onPreUpdate(engine, delta);\r\n        this.emit('preupdate', new PreUpdateEvent(engine, delta, this));\r\n        if (this._dirty) {\r\n            this._dirty = false;\r\n            this._updateColliders();\r\n        }\r\n        this._token++;\r\n        const worldBounds = engine.getWorldBounds();\r\n        const worldCoordsUpperLeft = vec(worldBounds.left, worldBounds.top);\r\n        const worldCoordsLowerRight = vec(worldBounds.right, worldBounds.bottom);\r\n        this._onScreenXStart = Math.max(Math.floor((worldCoordsUpperLeft.x - this.x) / this.cellWidth) - 2, 0);\r\n        this._onScreenYStart = Math.max(Math.floor((worldCoordsUpperLeft.y - this.y) / this.cellHeight) - 2, 0);\r\n        this._onScreenXEnd = Math.max(Math.floor((worldCoordsLowerRight.x - this.x) / this.cellWidth) + 2, 0);\r\n        this._onScreenYEnd = Math.max(Math.floor((worldCoordsLowerRight.y - this.y) / this.cellHeight) + 2, 0);\r\n        this._transform.pos = vec(this.x, this.y);\r\n        this.onPostUpdate(engine, delta);\r\n        this.emit('postupdate', new PostUpdateEvent(engine, delta, this));\r\n    }\r\n    /**\r\n     * Draws the tile map to the screen. Called by the [[Scene]].\r\n     * @param ctx CanvasRenderingContext2D or ExcaliburGraphicsContext\r\n     * @param delta  The number of milliseconds since the last draw\r\n     */\r\n    draw(ctx, delta) {\r\n        this.emit('predraw', new PreDrawEvent(ctx, delta, this)); // TODO fix event\r\n        let x = this._onScreenXStart;\r\n        const xEnd = Math.min(this._onScreenXEnd, this.cols);\r\n        let y = this._onScreenYStart;\r\n        const yEnd = Math.min(this._onScreenYEnd, this.rows);\r\n        let graphics, graphicsIndex, graphicsLen;\r\n        for (x; x < xEnd; x++) {\r\n            for (y; y < yEnd; y++) {\r\n                // get non-negative tile sprites\r\n                graphics = this.getCell(x, y).graphics;\r\n                for (graphicsIndex = 0, graphicsLen = graphics.length; graphicsIndex < graphicsLen; graphicsIndex++) {\r\n                    // draw sprite, warning if sprite doesn't exist\r\n                    const graphic = graphics[graphicsIndex];\r\n                    if (graphic) {\r\n                        if (!(ctx instanceof CanvasRenderingContext2D)) {\r\n                            if (hasGraphicsTick(graphic)) {\r\n                                graphic === null || graphic === void 0 ? void 0 : graphic.tick(delta, this._token);\r\n                            }\r\n                            graphic.draw(ctx, x * this.cellWidth, y * this.cellHeight);\r\n                        }\r\n                        else if (graphic instanceof Sprite) {\r\n                            // TODO legacy drawing mode\r\n                            if (!this._legacySpriteMap.has(graphic)) {\r\n                                this._legacySpriteMap.set(graphic, Sprite.toLegacySprite(graphic));\r\n                            }\r\n                            this._legacySpriteMap.get(graphic).draw(ctx, x * this.cellWidth, y * this.cellHeight);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            y = this._onScreenYStart;\r\n        }\r\n        this.emit('postdraw', new PostDrawEvent(ctx, delta, this));\r\n    }\r\n    debug(gfx) {\r\n        const width = this.cellWidth * this.cols;\r\n        const height = this.cellHeight * this.rows;\r\n        const pos = Vector.Zero;\r\n        for (let r = 0; r < this.rows + 1; r++) {\r\n            const yOffset = vec(0, r * this.cellHeight);\r\n            gfx.drawLine(pos.add(yOffset), pos.add(vec(width, yOffset.y)), Color.Red, 2);\r\n        }\r\n        for (let c = 0; c < this.cols + 1; c++) {\r\n            const xOffset = vec(c * this.cellWidth, 0);\r\n            gfx.drawLine(pos.add(xOffset), pos.add(vec(xOffset.x, height)), Color.Red, 2);\r\n        }\r\n        const colliders = this._composite.getColliders();\r\n        for (const collider of colliders) {\r\n            const grayish = Color.Gray;\r\n            grayish.a = 0.5;\r\n            const bounds = collider.localBounds;\r\n            const pos = collider.worldPos.sub(this.pos);\r\n            gfx.drawRectangle(pos, bounds.width, bounds.height, grayish);\r\n        }\r\n    }\r\n}\r\nTileMap_decorate([\r\n    obsolete({ message: 'No longer used, will be removed in v0.26.0' })\r\n], TileMapImpl.prototype, \"registerSpriteSheet\", null);\r\n/**\r\n * The [[TileMap]] class provides a lightweight way to do large complex scenes with collision\r\n * without the overhead of actors.\r\n */\r\nclass TileMap extends Configurable(TileMapImpl) {\r\n    constructor(xOrConfig, y, cellWidth, cellHeight, rows, cols) {\r\n        super(xOrConfig, y, cellWidth, cellHeight, rows, cols);\r\n    }\r\n}\r\n/**\r\n * @hidden\r\n */\r\nclass CellImpl extends Entity {\r\n    /**\r\n     * @param xOrConfig Gets or sets x coordinate of the cell in world coordinates or cell option bag\r\n     * @param y       Gets or sets y coordinate of the cell in world coordinates\r\n     * @param width   Gets or sets the width of the cell\r\n     * @param height  Gets or sets the height of the cell\r\n     * @param index   The index of the cell in row major order\r\n     * @param solid   Gets or sets whether this cell is solid\r\n     * @param graphics The list of tile graphics to use to draw in this cell (in order)\r\n     */\r\n    constructor(xOrConfig, y, width, height, index, solid = false, graphics = []) {\r\n        super();\r\n        this._solid = false;\r\n        /**\r\n         * Current list of graphics for this cell\r\n         */\r\n        this.graphics = [];\r\n        /**\r\n         * Arbitrary data storage per cell, useful for any game specific data\r\n         */\r\n        this.data = new Map();\r\n        if (xOrConfig && typeof xOrConfig === 'object') {\r\n            const config = xOrConfig;\r\n            xOrConfig = config.x;\r\n            y = config.y;\r\n            width = config.width;\r\n            height = config.height;\r\n            index = config.index;\r\n            solid = config.solid;\r\n            graphics = config.sprites;\r\n        }\r\n        this.x = xOrConfig;\r\n        this.y = y;\r\n        this.width = width;\r\n        this.height = height;\r\n        this.index = index;\r\n        this.solid = solid;\r\n        this.graphics = graphics;\r\n        this._bounds = new BoundingBox(this.x, this.y, this.x + this.width, this.y + this.height);\r\n    }\r\n    /**\r\n     * Wether this cell should be treated as solid by the tilemap\r\n     */\r\n    get solid() {\r\n        return this._solid;\r\n    }\r\n    /**\r\n     * Wether this cell should be treated as solid by the tilemap\r\n     */\r\n    set solid(val) {\r\n        var _a;\r\n        (_a = this.map) === null || _a === void 0 ? void 0 : _a.flagDirty();\r\n        this._solid = val;\r\n    }\r\n    get bounds() {\r\n        return this._bounds;\r\n    }\r\n    get center() {\r\n        return new Vector(this.x + this.width / 2, this.y + this.height / 2);\r\n    }\r\n    /**\r\n     * Add another [[Sprite]] to this cell\r\n     * @deprecated Use addSprite, will be removed in v0.26.0\r\n     */\r\n    pushSprite(sprite) {\r\n        this.addGraphic(sprite);\r\n    }\r\n    /**\r\n     * Add another [[Graphic]] to this TileMap cell\r\n     * @param graphic\r\n     */\r\n    addGraphic(graphic) {\r\n        if (graphic instanceof Sprite_Sprite) {\r\n            this.graphics.push(Sprite.fromLegacySprite(graphic));\r\n        }\r\n        else {\r\n            this.graphics.push(graphic);\r\n        }\r\n    }\r\n    /**\r\n     * Remove an instance of a [[Graphic]] from this cell\r\n     */\r\n    removeGraphic(graphic) {\r\n        removeItemFromArray(graphic, this.graphics);\r\n    }\r\n    /**\r\n     * Clear all graphics from this cell\r\n     */\r\n    clearGraphics() {\r\n        this.graphics.length = 0;\r\n    }\r\n}\r\nTileMap_decorate([\r\n    obsolete({ message: 'Will be removed in v0.26.0', alternateMethod: 'addSprite' })\r\n], CellImpl.prototype, \"pushSprite\", null);\r\n/**\r\n * TileMap Cell\r\n *\r\n * A light-weight object that occupies a space in a collision map. Generally\r\n * created by a [[TileMap]].\r\n *\r\n * Cells can draw multiple sprites. Note that the order of drawing is the order\r\n * of the sprites in the array so the last one will be drawn on top. You can\r\n * use transparency to create layers this way.\r\n */\r\nclass Cell extends Configurable(CellImpl) {\r\n    constructor(xOrConfig, y, width, height, index, solid, sprites) {\r\n        super(xOrConfig, y, width, height, index, solid, sprites);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Camera.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Container to house convenience strategy methods\r\n * @internal\r\n */\r\nclass StrategyContainer {\r\n    constructor(camera) {\r\n        this.camera = camera;\r\n    }\r\n    /**\r\n     * Creates and adds the [[LockCameraToActorStrategy]] on the current camera.\r\n     * @param actor The actor to lock the camera to\r\n     */\r\n    lockToActor(actor) {\r\n        this.camera.addStrategy(new LockCameraToActorStrategy(actor));\r\n    }\r\n    /**\r\n     * Creates and adds the [[LockCameraToActorAxisStrategy]] on the current camera\r\n     * @param actor The actor to lock the camera to\r\n     * @param axis The axis to follow the actor on\r\n     */\r\n    lockToActorAxis(actor, axis) {\r\n        this.camera.addStrategy(new LockCameraToActorAxisStrategy(actor, axis));\r\n    }\r\n    /**\r\n     * Creates and adds the [[ElasticToActorStrategy]] on the current camera\r\n     * If cameraElasticity < cameraFriction < 1.0, the behavior will be a dampened spring that will slowly end at the target without bouncing\r\n     * If cameraFriction < cameraElasticity < 1.0, the behavior will be an oscillating spring that will over\r\n     * correct and bounce around the target\r\n     *\r\n     * @param actor Target actor to elastically follow\r\n     * @param cameraElasticity [0 - 1.0] The higher the elasticity the more force that will drive the camera towards the target\r\n     * @param cameraFriction [0 - 1.0] The higher the friction the more that the camera will resist motion towards the target\r\n     */\r\n    elasticToActor(actor, cameraElasticity, cameraFriction) {\r\n        this.camera.addStrategy(new ElasticToActorStrategy(actor, cameraElasticity, cameraFriction));\r\n    }\r\n    /**\r\n     * Creates and adds the [[RadiusAroundActorStrategy]] on the current camera\r\n     * @param actor Target actor to follow when it is \"radius\" pixels away\r\n     * @param radius Number of pixels away before the camera will follow\r\n     */\r\n    radiusAroundActor(actor, radius) {\r\n        this.camera.addStrategy(new RadiusAroundActorStrategy(actor, radius));\r\n    }\r\n    /**\r\n     * Creates and adds the [[LimitCameraBoundsStrategy]] on the current camera\r\n     * @param box The bounding box to limit the camera to.\r\n     */\r\n    limitCameraBounds(box) {\r\n        this.camera.addStrategy(new LimitCameraBoundsStrategy(box));\r\n    }\r\n}\r\n/**\r\n * Camera axis enum\r\n */\r\nvar Axis;\r\n(function (Axis) {\r\n    Axis[Axis[\"X\"] = 0] = \"X\";\r\n    Axis[Axis[\"Y\"] = 1] = \"Y\";\r\n})(Axis || (Axis = {}));\r\n/**\r\n * Lock a camera to the exact x/y position of an actor.\r\n */\r\nclass LockCameraToActorStrategy {\r\n    constructor(target) {\r\n        this.target = target;\r\n        this.action = (target, _cam, _eng, _delta) => {\r\n            const center = target.center;\r\n            return center;\r\n        };\r\n    }\r\n}\r\n/**\r\n * Lock a camera to a specific axis around an actor.\r\n */\r\nclass LockCameraToActorAxisStrategy {\r\n    constructor(target, axis) {\r\n        this.target = target;\r\n        this.axis = axis;\r\n        this.action = (target, cam, _eng, _delta) => {\r\n            const center = target.center;\r\n            const currentFocus = cam.getFocus();\r\n            if (this.axis === Axis.X) {\r\n                return new Vector(center.x, currentFocus.y);\r\n            }\r\n            else {\r\n                return new Vector(currentFocus.x, center.y);\r\n            }\r\n        };\r\n    }\r\n}\r\n/**\r\n * Using [Hook's law](https://en.wikipedia.org/wiki/Hooke's_law), elastically move the camera towards the target actor.\r\n */\r\nclass ElasticToActorStrategy {\r\n    /**\r\n     * If cameraElasticity < cameraFriction < 1.0, the behavior will be a dampened spring that will slowly end at the target without bouncing\r\n     * If cameraFriction < cameraElasticity < 1.0, the behavior will be an oscillating spring that will over\r\n     * correct and bounce around the target\r\n     *\r\n     * @param target Target actor to elastically follow\r\n     * @param cameraElasticity [0 - 1.0] The higher the elasticity the more force that will drive the camera towards the target\r\n     * @param cameraFriction [0 - 1.0] The higher the friction the more that the camera will resist motion towards the target\r\n     */\r\n    constructor(target, cameraElasticity, cameraFriction) {\r\n        this.target = target;\r\n        this.cameraElasticity = cameraElasticity;\r\n        this.cameraFriction = cameraFriction;\r\n        this.action = (target, cam, _eng, _delta) => {\r\n            const position = target.center;\r\n            let focus = cam.getFocus();\r\n            let cameraVel = cam.vel.clone();\r\n            // Calculate the stretch vector, using the spring equation\r\n            // F = kX\r\n            // https://en.wikipedia.org/wiki/Hooke's_law\r\n            // Apply to the current camera velocity\r\n            const stretch = position.sub(focus).scale(this.cameraElasticity); // stretch is X\r\n            cameraVel = cameraVel.add(stretch);\r\n            // Calculate the friction (-1 to apply a force in the opposition of motion)\r\n            // Apply to the current camera velocity\r\n            const friction = cameraVel.scale(-1).scale(this.cameraFriction);\r\n            cameraVel = cameraVel.add(friction);\r\n            // Update position by velocity deltas\r\n            focus = focus.add(cameraVel);\r\n            return focus;\r\n        };\r\n    }\r\n}\r\nclass RadiusAroundActorStrategy {\r\n    /**\r\n     *\r\n     * @param target Target actor to follow when it is \"radius\" pixels away\r\n     * @param radius Number of pixels away before the camera will follow\r\n     */\r\n    constructor(target, radius) {\r\n        this.target = target;\r\n        this.radius = radius;\r\n        this.action = (target, cam, _eng, _delta) => {\r\n            const position = target.center;\r\n            const focus = cam.getFocus();\r\n            const direction = position.sub(focus);\r\n            const distance = direction.size;\r\n            if (distance >= this.radius) {\r\n                const offset = distance - this.radius;\r\n                return focus.add(direction.normalize().scale(offset));\r\n            }\r\n            return focus;\r\n        };\r\n    }\r\n}\r\n/**\r\n * Prevent a camera from going beyond the given camera dimensions.\r\n */\r\nclass LimitCameraBoundsStrategy {\r\n    constructor(target) {\r\n        this.target = target;\r\n        /**\r\n         * Useful for limiting the camera to a [[TileMap]]'s dimensions, or a specific area inside the map.\r\n         *\r\n         * Note that this strategy does not perform any movement by itself.\r\n         * It only sets the camera position to within the given bounds when the camera has gone beyond them.\r\n         * Thus, it is a good idea to combine it with other camera strategies and set this strategy as the last one.\r\n         *\r\n         * Make sure that the camera bounds are at least as large as the viewport size.\r\n         *\r\n         * @param target The bounding box to limit the camera to\r\n         */\r\n        this.boundSizeChecked = false; // Check and warn only once\r\n        this.action = (target, cam, _eng, _delta) => {\r\n            const focus = cam.getFocus();\r\n            if (!this.boundSizeChecked) {\r\n                if (target.bottom - target.top < _eng.drawHeight || target.right - target.left < _eng.drawWidth) {\r\n                    Logger.getInstance().warn('Camera bounds should not be smaller than the engine viewport');\r\n                }\r\n                this.boundSizeChecked = true;\r\n            }\r\n            let focusX = focus.x;\r\n            let focusY = focus.y;\r\n            if (focus.x < target.left + _eng.halfDrawWidth) {\r\n                focusX = target.left + _eng.halfDrawWidth;\r\n            }\r\n            else if (focus.x > target.right - _eng.halfDrawWidth) {\r\n                focusX = target.right - _eng.halfDrawWidth;\r\n            }\r\n            if (focus.y < target.top + _eng.halfDrawHeight) {\r\n                focusY = target.top + _eng.halfDrawHeight;\r\n            }\r\n            else if (focus.y > target.bottom - _eng.halfDrawHeight) {\r\n                focusY = target.bottom - _eng.halfDrawHeight;\r\n            }\r\n            return vec(focusX, focusY);\r\n        };\r\n    }\r\n}\r\n/**\r\n * Cameras\r\n *\r\n * [[Camera]] is the base class for all Excalibur cameras. Cameras are used\r\n * to move around your game and set focus. They are used to determine\r\n * what is \"off screen\" and can be used to scale the game.\r\n *\r\n */\r\nclass Camera extends Class {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.transform = Matrix.identity();\r\n        this.inverse = Matrix.identity();\r\n        this._cameraStrategies = [];\r\n        this.strategy = new StrategyContainer(this);\r\n        /**\r\n         * Get or set current zoom of the camera, defaults to 1\r\n         */\r\n        this._z = 1;\r\n        /**\r\n         * Get or set rate of change in zoom, defaults to 0\r\n         */\r\n        this.dz = 0;\r\n        /**\r\n         * Get or set zoom acceleration\r\n         */\r\n        this.az = 0;\r\n        /**\r\n         * Current rotation of the camera\r\n         */\r\n        this.rotation = 0;\r\n        /**\r\n         * Current angular velocity\r\n         * @deprecated will be removed in v0.26.0, use angularVelocity\r\n         */\r\n        this.rx = 0;\r\n        /**\r\n         * Get or set the camera's position\r\n         */\r\n        this._posChanged = false;\r\n        this._pos = watchAny(Vector.Zero, () => (this._posChanged = true));\r\n        /**\r\n         * Get or set the camera's velocity\r\n         */\r\n        this.vel = Vector.Zero;\r\n        /**\r\n         * Get or set the camera's acceleration\r\n         */\r\n        this.acc = Vector.Zero;\r\n        this._cameraMoving = false;\r\n        this._currentLerpTime = 0;\r\n        this._lerpDuration = 1000; // 1 second\r\n        this._lerpStart = null;\r\n        this._lerpEnd = null;\r\n        //camera effects\r\n        this._isShaking = false;\r\n        this._shakeMagnitudeX = 0;\r\n        this._shakeMagnitudeY = 0;\r\n        this._shakeDuration = 0;\r\n        this._elapsedShakeTime = 0;\r\n        this._xShake = 0;\r\n        this._yShake = 0;\r\n        this._isZooming = false;\r\n        this._zoomStart = 1;\r\n        this._zoomEnd = 1;\r\n        this._currentZoomTime = 0;\r\n        this._zoomDuration = 0;\r\n        this._zoomEasing = EasingFunctions.EaseInOutCubic;\r\n        this._easing = EasingFunctions.EaseInOutCubic;\r\n        this._halfWidth = 0;\r\n        this._halfHeight = 0;\r\n        this._viewport = null;\r\n        this._isInitialized = false;\r\n    }\r\n    get zoom() {\r\n        return this._z;\r\n    }\r\n    set zoom(val) {\r\n        this._z = val;\r\n        if (this._engine) {\r\n            this._halfWidth = this._engine.halfDrawWidth;\r\n            this._halfHeight = this._engine.halfDrawHeight;\r\n        }\r\n    }\r\n    /**\r\n     * Get or set the camera's angular velocity\r\n     */\r\n    get angularVelocity() {\r\n        return this.rx;\r\n    }\r\n    set angularVelocity(value) {\r\n        this.rx = value;\r\n    }\r\n    get pos() {\r\n        return this._pos;\r\n    }\r\n    set pos(vec) {\r\n        this._pos = watchAny(vec, () => (this._posChanged = true));\r\n        this._posChanged = true;\r\n    }\r\n    /**\r\n     * Get the camera's x position\r\n     */\r\n    get x() {\r\n        return this.pos.x;\r\n    }\r\n    /**\r\n     * Set the camera's x position (cannot be set when following an [[Actor]] or when moving)\r\n     */\r\n    set x(value) {\r\n        if (!this._follow && !this._cameraMoving) {\r\n            this.pos = vec(value, this.pos.y);\r\n        }\r\n    }\r\n    /**\r\n     * Get the camera's y position\r\n     */\r\n    get y() {\r\n        return this.pos.y;\r\n    }\r\n    /**\r\n     * Set the camera's y position (cannot be set when following an [[Actor]] or when moving)\r\n     */\r\n    set y(value) {\r\n        if (!this._follow && !this._cameraMoving) {\r\n            this.pos = vec(this.pos.x, value);\r\n        }\r\n    }\r\n    /**\r\n     * Get or set the camera's x velocity\r\n     */\r\n    get dx() {\r\n        return this.vel.x;\r\n    }\r\n    set dx(value) {\r\n        this.vel = vec(value, this.vel.y);\r\n    }\r\n    /**\r\n     * Get or set the camera's y velocity\r\n     */\r\n    get dy() {\r\n        return this.vel.y;\r\n    }\r\n    set dy(value) {\r\n        this.vel = vec(this.vel.x, value);\r\n    }\r\n    /**\r\n     * Get or set the camera's x acceleration\r\n     */\r\n    get ax() {\r\n        return this.acc.x;\r\n    }\r\n    set ax(value) {\r\n        this.acc = vec(value, this.acc.y);\r\n    }\r\n    /**\r\n     * Get or set the camera's y acceleration\r\n     */\r\n    get ay() {\r\n        return this.acc.y;\r\n    }\r\n    set ay(value) {\r\n        this.acc = vec(this.acc.x, value);\r\n    }\r\n    /**\r\n     * Returns the focal point of the camera, a new point giving the x and y position of the camera\r\n     */\r\n    getFocus() {\r\n        return this.pos;\r\n    }\r\n    /**\r\n     * This moves the camera focal point to the specified position using specified easing function. Cannot move when following an Actor.\r\n     *\r\n     * @param pos The target position to move to\r\n     * @param duration The duration in milliseconds the move should last\r\n     * @param [easingFn] An optional easing function ([[ex.EasingFunctions.EaseInOutCubic]] by default)\r\n     * @returns A [[Promise]] that resolves when movement is finished, including if it's interrupted.\r\n     *          The [[Promise]] value is the [[Vector]] of the target position. It will be rejected if a move cannot be made.\r\n     */\r\n    move(pos, duration, easingFn = EasingFunctions.EaseInOutCubic) {\r\n        if (typeof easingFn !== 'function') {\r\n            throw 'Please specify an EasingFunction';\r\n        }\r\n        // cannot move when following an actor\r\n        if (this._follow) {\r\n            return Promise.reject(pos);\r\n        }\r\n        // resolve existing promise, if any\r\n        if (this._lerpPromise && this._lerpResolve) {\r\n            this._lerpResolve(pos);\r\n        }\r\n        this._lerpPromise = new Promise((resolve) => {\r\n            this._lerpResolve = resolve;\r\n        });\r\n        this._lerpStart = this.getFocus().clone();\r\n        this._lerpDuration = duration;\r\n        this._lerpEnd = pos;\r\n        this._currentLerpTime = 0;\r\n        this._cameraMoving = true;\r\n        this._easing = easingFn;\r\n        return this._lerpPromise;\r\n    }\r\n    /**\r\n     * Sets the camera to shake at the specified magnitudes for the specified duration\r\n     * @param magnitudeX  The x magnitude of the shake\r\n     * @param magnitudeY  The y magnitude of the shake\r\n     * @param duration    The duration of the shake in milliseconds\r\n     */\r\n    shake(magnitudeX, magnitudeY, duration) {\r\n        this._isShaking = true;\r\n        this._shakeMagnitudeX = magnitudeX;\r\n        this._shakeMagnitudeY = magnitudeY;\r\n        this._shakeDuration = duration;\r\n    }\r\n    /**\r\n     * Zooms the camera in or out by the specified scale over the specified duration.\r\n     * If no duration is specified, it take effect immediately.\r\n     * @param scale    The scale of the zoom\r\n     * @param duration The duration of the zoom in milliseconds\r\n     */\r\n    zoomOverTime(scale, duration = 0, easingFn = EasingFunctions.EaseInOutCubic) {\r\n        this._zoomPromise = new Promise((resolve) => {\r\n            this._zoomResolve = resolve;\r\n        });\r\n        if (duration) {\r\n            this._isZooming = true;\r\n            this._zoomEasing = easingFn;\r\n            this._currentZoomTime = 0;\r\n            this._zoomDuration = duration;\r\n            this._zoomStart = this.zoom;\r\n            this._zoomEnd = scale;\r\n        }\r\n        else {\r\n            this._isZooming = false;\r\n            this.zoom = scale;\r\n            return Promise.resolve(true);\r\n        }\r\n        return this._zoomPromise;\r\n    }\r\n    /**\r\n     * Gets the bounding box of the viewport of this camera in world coordinates\r\n     */\r\n    get viewport() {\r\n        if (this._viewport) {\r\n            return this._viewport;\r\n        }\r\n        return new BoundingBox(0, 0, 0, 0);\r\n    }\r\n    /**\r\n     * Adds a new camera strategy to this camera\r\n     * @param cameraStrategy Instance of an [[CameraStrategy]]\r\n     */\r\n    addStrategy(cameraStrategy) {\r\n        this._cameraStrategies.push(cameraStrategy);\r\n    }\r\n    /**\r\n     * Removes a camera strategy by reference\r\n     * @param cameraStrategy Instance of an [[CameraStrategy]]\r\n     */\r\n    removeStrategy(cameraStrategy) {\r\n        removeItemFromArray(cameraStrategy, this._cameraStrategies);\r\n    }\r\n    /**\r\n     * Clears all camera strategies from the camera\r\n     */\r\n    clearAllStrategies() {\r\n        this._cameraStrategies.length = 0;\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPreUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _preupdate(engine, delta) {\r\n        this.emit('preupdate', new PreUpdateEvent(engine, delta, this));\r\n        this.onPreUpdate(engine, delta);\r\n    }\r\n    /**\r\n     * Safe to override onPreUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPreUpdate` is called directly before a scene is updated.\r\n     */\r\n    onPreUpdate(_engine, _delta) {\r\n        // Overridable\r\n    }\r\n    /**\r\n     *  It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPostUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _postupdate(engine, delta) {\r\n        this.emit('postupdate', new PostUpdateEvent(engine, delta, this));\r\n        this.onPostUpdate(engine, delta);\r\n    }\r\n    /**\r\n     * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPostUpdate` is called directly after a scene is updated.\r\n     */\r\n    onPostUpdate(_engine, _delta) {\r\n        // Overridable\r\n    }\r\n    get isInitialized() {\r\n        return this._isInitialized;\r\n    }\r\n    _initialize(_engine) {\r\n        if (!this.isInitialized) {\r\n            this._engine = _engine;\r\n            this._screen = _engine.screen;\r\n            const currentRes = this._screen.resolution;\r\n            let center = vec(currentRes.width / 2, currentRes.height / 2);\r\n            if (!this._engine.loadingComplete) {\r\n                // If there was a loading screen, we peek the configured resolution\r\n                const res = this._screen.peekResolution();\r\n                if (res) {\r\n                    center = vec(res.width / 2, res.height / 2);\r\n                }\r\n            }\r\n            this._halfWidth = center.x;\r\n            this._halfHeight = center.y;\r\n            // If the user has not set the camera pos, apply default center screen position\r\n            if (!this._posChanged) {\r\n                this.pos = center;\r\n            }\r\n            // First frame bootstrap\r\n            // Ensure camera tx is correct\r\n            this.updateTransform();\r\n            // Run strategies for first frame\r\n            this.runStrategies(_engine, _engine.clock.elapsed());\r\n            // Setup the first frame viewport\r\n            this.updateViewport();\r\n            this.onInitialize(_engine);\r\n            super.emit('initialize', new InitializeEvent(_engine, this));\r\n            this._isInitialized = true;\r\n        }\r\n    }\r\n    /**\r\n     * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPostUpdate` is called directly after a scene is updated.\r\n     */\r\n    onInitialize(_engine) {\r\n        // Overridable\r\n    }\r\n    on(eventName, handler) {\r\n        super.on(eventName, handler);\r\n    }\r\n    off(eventName, handler) {\r\n        super.off(eventName, handler);\r\n    }\r\n    once(eventName, handler) {\r\n        super.once(eventName, handler);\r\n    }\r\n    runStrategies(engine, delta) {\r\n        for (const s of this._cameraStrategies) {\r\n            this.pos = s.action.call(s, s.target, this, engine, delta);\r\n        }\r\n    }\r\n    updateViewport() {\r\n        // recalc viewport\r\n        this._viewport = new BoundingBox(this.x - this._halfWidth, this.y - this._halfHeight, this.x + this._halfWidth, this.y + this._halfHeight);\r\n    }\r\n    update(_engine, delta) {\r\n        this._initialize(_engine);\r\n        this._preupdate(_engine, delta);\r\n        // Update placements based on linear algebra\r\n        this.pos = this.pos.add(this.vel.scale(delta / 1000));\r\n        this.zoom += (this.dz * delta) / 1000;\r\n        this.vel = this.vel.add(this.acc.scale(delta / 1000));\r\n        this.dz += (this.az * delta) / 1000;\r\n        this.rotation += (this.angularVelocity * delta) / 1000;\r\n        if (this._isZooming) {\r\n            if (this._currentZoomTime < this._zoomDuration) {\r\n                const zoomEasing = this._zoomEasing;\r\n                const newZoom = zoomEasing(this._currentZoomTime, this._zoomStart, this._zoomEnd, this._zoomDuration);\r\n                this.zoom = newZoom;\r\n                this._currentZoomTime += delta;\r\n            }\r\n            else {\r\n                this._isZooming = false;\r\n                this.zoom = this._zoomEnd;\r\n                this._currentZoomTime = 0;\r\n                this._zoomResolve(true);\r\n            }\r\n        }\r\n        if (this._cameraMoving) {\r\n            if (this._currentLerpTime < this._lerpDuration) {\r\n                const moveEasing = EasingFunctions.CreateVectorEasingFunction(this._easing);\r\n                const lerpPoint = moveEasing(this._currentLerpTime, this._lerpStart, this._lerpEnd, this._lerpDuration);\r\n                this.pos = lerpPoint;\r\n                this._currentLerpTime += delta;\r\n            }\r\n            else {\r\n                this.pos = this._lerpEnd;\r\n                const end = this._lerpEnd.clone();\r\n                this._lerpStart = null;\r\n                this._lerpEnd = null;\r\n                this._currentLerpTime = 0;\r\n                this._cameraMoving = false;\r\n                // Order matters here, resolve should be last so any chain promises have a clean slate\r\n                this._lerpResolve(end);\r\n            }\r\n        }\r\n        if (this._isDoneShaking()) {\r\n            this._isShaking = false;\r\n            this._elapsedShakeTime = 0;\r\n            this._shakeMagnitudeX = 0;\r\n            this._shakeMagnitudeY = 0;\r\n            this._shakeDuration = 0;\r\n            this._xShake = 0;\r\n            this._yShake = 0;\r\n        }\r\n        else {\r\n            this._elapsedShakeTime += delta;\r\n            this._xShake = ((Math.random() * this._shakeMagnitudeX) | 0) + 1;\r\n            this._yShake = ((Math.random() * this._shakeMagnitudeY) | 0) + 1;\r\n        }\r\n        this.updateTransform();\r\n        this.runStrategies(_engine, delta);\r\n        this.updateViewport();\r\n        this._postupdate(_engine, delta);\r\n    }\r\n    draw(ctx) {\r\n        // Apply transform\r\n        if (ctx instanceof CanvasRenderingContext2D) {\r\n            // TODO This will be removed in v0.26.0\r\n            const focus = this.getFocus();\r\n            // center the camera\r\n            const newCanvasWidth = this._screen.resolution.width / this.zoom;\r\n            const newCanvasHeight = this._screen.resolution.height / this.zoom;\r\n            const cameraPos = vec(-focus.x + newCanvasWidth / 2 + this._xShake, -focus.y + newCanvasHeight / 2 + this._yShake);\r\n            ctx.scale(this.zoom, this.zoom);\r\n            ctx.translate(cameraPos.x, cameraPos.y);\r\n        }\r\n        else {\r\n            ctx.multiply(this.transform);\r\n        }\r\n    }\r\n    updateTransform() {\r\n        // center the camera\r\n        const newCanvasWidth = this._screen.resolution.width / this.zoom;\r\n        const newCanvasHeight = this._screen.resolution.height / this.zoom;\r\n        const cameraPos = vec(-this.x + newCanvasWidth / 2 + this._xShake, -this.y + newCanvasHeight / 2 + this._yShake);\r\n        // Calculate camera transform\r\n        this.transform.reset();\r\n        this.transform.scale(this.zoom, this.zoom);\r\n        this.transform.translate(cameraPos.x, cameraPos.y);\r\n        this.transform.getAffineInverse(this.inverse);\r\n    }\r\n    /* istanbul ignore next */\r\n    debugDraw(_ctx) {\r\n        // pass\r\n    }\r\n    _isDoneShaking() {\r\n        return !this._isShaking || this._elapsedShakeTime >= this._shakeDuration;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Actors.ts\n\r\n\r\n\r\n/**\r\n * Type guard to detect if something is an actor\r\n * @deprecated Will be removed in v0.26.0\r\n * @param actor\r\n */\r\nfunction isVanillaActor(actor) {\r\n    return !(actor instanceof ScreenElement) && !(actor instanceof Trigger) && !(actor instanceof Label);\r\n}\r\n/**\r\n * Type guard to detect a screen element\r\n * @todo move to ScreenElement\r\n */\r\nfunction isScreenElement(actor) {\r\n    return actor instanceof ScreenElement_ScreenElement;\r\n}\r\n\n;// CONCATENATED MODULE: ./Trigger.ts\n\r\n\r\n\r\n\r\n\r\n\r\nconst triggerDefaults = {\r\n    pos: Vector.Zero,\r\n    width: 10,\r\n    height: 10,\r\n    visible: false,\r\n    action: () => {\r\n        return;\r\n    },\r\n    filter: () => true,\r\n    repeat: -1\r\n};\r\n/**\r\n * Triggers are a method of firing arbitrary code on collision. These are useful\r\n * as 'buttons', 'switches', or to trigger effects in a game. By default triggers\r\n * are invisible, and can only be seen when [[Trigger.visible]] is set to `true`.\r\n */\r\nclass Trigger_Trigger extends Actor {\r\n    /**\r\n     *\r\n     * @param opts Trigger options\r\n     */\r\n    constructor(opts) {\r\n        super({ x: opts.pos.x, y: opts.pos.y, width: opts.width, height: opts.height });\r\n        /**\r\n         * Action to fire when triggered by collision\r\n         */\r\n        this.action = () => {\r\n            return;\r\n        };\r\n        /**\r\n         * Filter to add additional granularity to action dispatch, if a filter is specified the action will only fire when\r\n         * filter return true for the collided actor.\r\n         */\r\n        this.filter = () => true;\r\n        /**\r\n         * Number of times to repeat before killing the trigger,\r\n         */\r\n        this.repeat = -1;\r\n        opts = {\r\n            ...triggerDefaults,\r\n            ...opts\r\n        };\r\n        this.filter = opts.filter || this.filter;\r\n        this.repeat = opts.repeat || this.repeat;\r\n        this.action = opts.action || this.action;\r\n        if (opts.target) {\r\n            this.target = opts.target;\r\n        }\r\n        this.graphics.visible = opts.visible;\r\n        this.body.collisionType = CollisionType.Passive;\r\n        this.eventDispatcher = new EventDispatcher();\r\n        this.events.on('collisionstart', (evt) => {\r\n            if (this.filter(evt.other)) {\r\n                this.emit('enter', new EnterTriggerEvent(this, evt.other));\r\n                this._dispatchAction();\r\n                // remove trigger if its done, -1 repeat forever\r\n                if (this.repeat === 0) {\r\n                    this.kill();\r\n                }\r\n            }\r\n        });\r\n        this.events.on('collisionend', (evt) => {\r\n            if (this.filter(evt.other)) {\r\n                this.emit('exit', new ExitTriggerEvent(this, evt.other));\r\n            }\r\n        });\r\n    }\r\n    set target(target) {\r\n        this._target = target;\r\n        this.filter = (actor) => actor === target;\r\n    }\r\n    get target() {\r\n        return this._target;\r\n    }\r\n    _initialize(engine) {\r\n        super._initialize(engine);\r\n    }\r\n    _dispatchAction() {\r\n        if (this.repeat !== 0) {\r\n            this.action.call(this);\r\n            this.repeat--;\r\n        }\r\n    }\r\n    /**\r\n     * @deprecated signature will change in v0.26.0\r\n     * @param ctx\r\n     */\r\n    /* istanbul ignore next */\r\n    debugDraw(ctx) {\r\n        super.debugDraw(ctx);\r\n        // Meant to draw debug information about actors\r\n        ctx.save();\r\n        ctx.translate(this.pos.x, this.pos.y);\r\n        const bb = this.collider.bounds;\r\n        const wp = this.getGlobalPos();\r\n        bb.left = bb.left - wp.x;\r\n        bb.right = bb.right - wp.x;\r\n        bb.top = bb.top - wp.y;\r\n        bb.bottom = bb.bottom - wp.y;\r\n        ctx.fillStyle = Color.Violet.toString();\r\n        ctx.strokeStyle = Color.Violet.toString();\r\n        ctx.fillText('Trigger', 10, 10);\r\n        bb.debugDraw(ctx);\r\n        ctx.restore();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/System.ts\n/**\r\n * Enum that determines whether to run the system in the update or draw phase\r\n */\r\nvar SystemType;\r\n(function (SystemType) {\r\n    SystemType[\"Update\"] = \"update\";\r\n    SystemType[\"Draw\"] = \"draw\";\r\n})(SystemType || (SystemType = {}));\r\n/**\r\n * An Excalibur [[System]] that updates entities of certain types.\r\n * Systems are scene specific\r\n *\r\n * Excalibur Systems currently require at least 1 Component type to operated\r\n *\r\n * Multiple types are declared as a type union\r\n * For example:\r\n *\r\n * ```typescript\r\n * class MySystem extends System<ComponentA | ComponentB> {\r\n *   public readonly types = ['a', 'b'] as const;\r\n *   public readonly systemType = SystemType.Update;\r\n *   public update(entities: Entity<ComponentA | ComponentB>) {\r\n *      ...\r\n *   }\r\n * }\r\n * ```\r\n */\r\nclass System {\r\n    constructor() {\r\n        /**\r\n         * System can execute in priority order, by default all systems are priority 0. Lower values indicated higher priority.\r\n         * For a system to execute before all other a lower priority value (-1 for example) must be set.\r\n         * For a system to execute after all other a higher priority value (10 for example) must be set.\r\n         */\r\n        this.priority = 0;\r\n    }\r\n    /**\r\n     * Systems observe when entities match their types or no longer match their types, override\r\n     * @param _entityAddedOrRemoved\r\n     */\r\n    notify(_entityAddedOrRemoved) {\r\n        // Override me\r\n    }\r\n}\r\n/**\r\n * An [[Entity]] with [[Component]] types that matches a [[System]] types exists in the current scene.\r\n */\r\nclass AddedEntity {\r\n    constructor(data) {\r\n        this.data = data;\r\n        this.type = 'Entity Added';\r\n    }\r\n}\r\n/**\r\n * Type guard to check for AddedEntity messages\r\n * @param x\r\n */\r\nfunction isAddedSystemEntity(x) {\r\n    return !!x && x.type === 'Entity Added';\r\n}\r\n/**\r\n * An [[Entity]] with [[Component]] types that no longer matches a [[System]] types exists in the current scene.\r\n */\r\nclass RemovedEntity {\r\n    constructor(data) {\r\n        this.data = data;\r\n        this.type = 'Entity Removed';\r\n    }\r\n}\r\n/**\r\n * type guard to check for the RemovedEntity message\r\n */\r\nfunction isRemoveSystemEntity(x) {\r\n    return !!x && x.type === 'Entity Removed';\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/EntityManager.ts\n\r\n\r\n// Add/Remove entities and components\r\nclass EntityManager {\r\n    constructor(_world) {\r\n        this._world = _world;\r\n        this.entities = [];\r\n        this._entityIndex = {};\r\n        this._entitiesToRemove = [];\r\n    }\r\n    /**\r\n     * Runs the entity lifecycle\r\n     * @param _context\r\n     */\r\n    updateEntities(_context, elapsed) {\r\n        for (const entity of this.entities) {\r\n            // TODO is this right?\r\n            entity.update(_context.engine, elapsed);\r\n            if (!entity.active) {\r\n                this.removeEntity(entity);\r\n            }\r\n        }\r\n    }\r\n    findEntitiesForRemoval() {\r\n        for (const entity of this.entities) {\r\n            if (!entity.active) {\r\n                this.removeEntity(entity);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * EntityManager observes changes on entities\r\n     * @param message\r\n     */\r\n    notify(message) {\r\n        if (isAddedComponent(message)) {\r\n            // we don't need the component, it's already on the entity\r\n            this._world.queryManager.addEntity(message.data.entity);\r\n        }\r\n        if (isRemovedComponent(message)) {\r\n            this._world.queryManager.removeComponent(message.data.entity, message.data.component);\r\n        }\r\n    }\r\n    /**\r\n     * Adds an entity to be tracked by the EntityManager\r\n     * @param entity\r\n     */\r\n    addEntity(entity) {\r\n        entity.active = true;\r\n        if (entity && !this._entityIndex[entity.id]) {\r\n            this._entityIndex[entity.id] = entity;\r\n            this.entities.push(entity);\r\n            this._world.queryManager.addEntity(entity);\r\n            entity.componentAdded$.register(this);\r\n            entity.componentRemoved$.register(this);\r\n            // if entity has children\r\n            entity.children.forEach((c) => this.addEntity(c));\r\n            entity.childrenAdded$.register({\r\n                notify: (e) => {\r\n                    this.addEntity(e);\r\n                }\r\n            });\r\n            entity.childrenRemoved$.register({\r\n                notify: (e) => {\r\n                    this.removeEntity(e, false);\r\n                }\r\n            });\r\n        }\r\n    }\r\n    removeEntity(idOrEntity, deferred = true) {\r\n        var _a;\r\n        let id = 0;\r\n        if (idOrEntity instanceof Entity) {\r\n            id = idOrEntity.id;\r\n        }\r\n        else {\r\n            id = idOrEntity;\r\n        }\r\n        const entity = this._entityIndex[id];\r\n        if (entity && entity.active) {\r\n            entity.kill();\r\n        }\r\n        if (entity && deferred) {\r\n            this._entitiesToRemove.push(entity);\r\n            return;\r\n        }\r\n        delete this._entityIndex[id];\r\n        if (entity) {\r\n            removeItemFromArray(entity, this.entities);\r\n            this._world.queryManager.removeEntity(entity);\r\n            entity.componentAdded$.unregister(this);\r\n            entity.componentRemoved$.unregister(this);\r\n            // if entity has children\r\n            entity.children.forEach((c) => this.removeEntity(c, deferred));\r\n            entity.childrenAdded$.clear();\r\n            entity.childrenRemoved$.clear();\r\n            // stats\r\n            if ((_a = this._world.context) === null || _a === void 0 ? void 0 : _a.engine) {\r\n                this._world.context.engine.stats.currFrame.actors.killed++;\r\n            }\r\n        }\r\n    }\r\n    processEntityRemovals() {\r\n        for (const entity of this._entitiesToRemove) {\r\n            if (entity.active) {\r\n                continue;\r\n            }\r\n            this.removeEntity(entity, false);\r\n        }\r\n    }\r\n    processComponentRemovals() {\r\n        for (const entity of this.entities) {\r\n            entity.processComponentRemoval();\r\n        }\r\n    }\r\n    getById(id) {\r\n        return this._entityIndex[id];\r\n    }\r\n    getByName(name) {\r\n        return this.entities.filter(e => e.name === name);\r\n    }\r\n    clear() {\r\n        for (const entity of this.entities) {\r\n            this.removeEntity(entity);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/Util.ts\nconst buildTypeKey = (types) => {\r\n    const key = [...types].sort((a, b) => a.localeCompare(b)).join('+');\r\n    return key;\r\n};\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/Query.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Represents query for entities that match a list of types that is cached and observable\r\n *\r\n * Queries can be strongly typed by supplying a type union in the optional type parameter\r\n * ```typescript\r\n * const queryAB = new ex.Query<ComponentTypeA | ComponentTypeB>(['A', 'B']);\r\n * ```\r\n */\r\nclass Query extends Observable {\r\n    constructor(types) {\r\n        super();\r\n        this._entities = [];\r\n        if (types[0] instanceof Function) {\r\n            this.types = types.map(T => (new T).type);\r\n        }\r\n        else {\r\n            this.types = types;\r\n        }\r\n    }\r\n    get key() {\r\n        if (this._key) {\r\n            return this._key;\r\n        }\r\n        return (this._key = buildTypeKey(this.types));\r\n    }\r\n    /**\r\n     * Returns a list of entities that match the query\r\n     *\r\n     * @param sort Optional sorting function to sort entities returned from the query\r\n     */\r\n    getEntities(sort) {\r\n        if (sort) {\r\n            this._entities.sort(sort);\r\n        }\r\n        return this._entities;\r\n    }\r\n    /**\r\n     * Add an entity to the query, will only be added if the entity matches the query types\r\n     * @param entity\r\n     */\r\n    addEntity(entity) {\r\n        if (!contains(this._entities, entity) && this.matches(entity)) {\r\n            this._entities.push(entity);\r\n            this.notifyAll(new AddedEntity(entity));\r\n        }\r\n    }\r\n    /**\r\n     * If the entity is part of the query it will be removed regardless of types\r\n     * @param entity\r\n     */\r\n    removeEntity(entity) {\r\n        if (removeItemFromArray(entity, this._entities)) {\r\n            this.notifyAll(new RemovedEntity(entity));\r\n        }\r\n    }\r\n    /**\r\n     * Removes all entities and observers from the query\r\n     */\r\n    clear() {\r\n        this._entities.length = 0;\r\n        for (const observer of this.observers) {\r\n            this.unregister(observer);\r\n        }\r\n    }\r\n    matches(typesOrEntity) {\r\n        let types = [];\r\n        if (typesOrEntity instanceof Entity) {\r\n            types = typesOrEntity.types;\r\n        }\r\n        else {\r\n            types = typesOrEntity;\r\n        }\r\n        let matches = true;\r\n        for (const type of this.types) {\r\n            matches = matches && types.indexOf(type) > -1;\r\n            if (!matches) {\r\n                return false;\r\n            }\r\n        }\r\n        return matches;\r\n    }\r\n    contain(type) {\r\n        return this.types.indexOf(type) > -1;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/QueryManager.ts\n\r\n\r\n/**\r\n * The query manager is responsible for updating all queries when entities/components change\r\n */\r\nclass QueryManager {\r\n    constructor(_world) {\r\n        this._world = _world;\r\n        this._queries = {};\r\n    }\r\n    /**\r\n     * Adds a query to the manager and populates with any entities that match\r\n     * @param query\r\n     */\r\n    _addQuery(query) {\r\n        this._queries[buildTypeKey(query.types)] = query;\r\n        for (const entity of this._world.entityManager.entities) {\r\n            query.addEntity(entity);\r\n        }\r\n    }\r\n    /**\r\n     * Removes the query if there are no observers left\r\n     * @param query\r\n     */\r\n    maybeRemoveQuery(query) {\r\n        if (query.observers.length === 0) {\r\n            query.clear();\r\n            delete this._queries[buildTypeKey(query.types)];\r\n        }\r\n    }\r\n    /**\r\n     * Adds the entity to any matching query in the query manage\r\n     * @param entity\r\n     */\r\n    addEntity(entity) {\r\n        for (const queryType in this._queries) {\r\n            if (this._queries[queryType]) {\r\n                this._queries[queryType].addEntity(entity);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Removes an entity from queries if the removed component disqualifies it\r\n     * @param entity\r\n     * @param component\r\n     */\r\n    removeComponent(entity, component) {\r\n        for (const queryType in this._queries) {\r\n            // If the component being removed from an entity is a part of a query,\r\n            // it is now disqualified from that query, remove it\r\n            if (this._queries[queryType].contain(component.type)) {\r\n                this._queries[queryType].removeEntity(entity);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Removes an entity from all queries it is currently a part of\r\n     * @param entity\r\n     */\r\n    removeEntity(entity) {\r\n        for (const queryType in this._queries) {\r\n            this._queries[queryType].removeEntity(entity);\r\n        }\r\n    }\r\n    /**\r\n     * Creates a populated query and returns, if the query already exists that will be returned instead of a new instance\r\n     * @param types\r\n     */\r\n    createQuery(types) {\r\n        const maybeExistingQuery = this.getQuery(types);\r\n        if (maybeExistingQuery) {\r\n            return maybeExistingQuery;\r\n        }\r\n        const query = new Query(types);\r\n        this._addQuery(query);\r\n        return query;\r\n    }\r\n    /**\r\n     * Retrieves an existing query by types if it exists otherwise returns null\r\n     * @param types\r\n     */\r\n    getQuery(types) {\r\n        const key = buildTypeKey(types);\r\n        if (this._queries[key]) {\r\n            return this._queries[key];\r\n        }\r\n        return null;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/SystemManager.ts\n\r\n/**\r\n * The SystemManager is responsible for keeping track of all systems in a scene.\r\n * Systems are scene specific\r\n */\r\nclass SystemManager {\r\n    constructor(_world) {\r\n        this._world = _world;\r\n        /**\r\n         * List of systems, to add a new system call [[SystemManager.addSystem]]\r\n         */\r\n        this.systems = [];\r\n        this.initialized = false;\r\n    }\r\n    /**\r\n     * Get a system registered in the manager by type\r\n     * @param systemType\r\n     */\r\n    get(systemType) {\r\n        return this.systems.find((s) => s instanceof systemType);\r\n    }\r\n    /**\r\n     * Adds a system to the manager, it will now be updated every frame\r\n     * @param system\r\n     */\r\n    addSystem(system) {\r\n        // validate system has types\r\n        if (!system.types || system.types.length === 0) {\r\n            throw new Error(`Attempted to add a System without any types`);\r\n        }\r\n        const query = this._world.queryManager.createQuery(system.types);\r\n        this.systems.push(system);\r\n        this.systems.sort((a, b) => a.priority - b.priority);\r\n        query.register(system);\r\n        if (this.initialized && system.initialize) {\r\n            system.initialize(this._world.context);\r\n        }\r\n    }\r\n    /**\r\n     * Removes a system from the manager, it will no longer be updated\r\n     * @param system\r\n     */\r\n    removeSystem(system) {\r\n        removeItemFromArray(system, this.systems);\r\n        const query = this._world.queryManager.getQuery(system.types);\r\n        if (query) {\r\n            query.unregister(system);\r\n            this._world.queryManager.maybeRemoveQuery(query);\r\n        }\r\n    }\r\n    /**\r\n     * Initialize all systems in the manager\r\n     *\r\n     * Systems added after initialize() will be initialized on add\r\n     */\r\n    initialize() {\r\n        if (!this.initialized) {\r\n            this.initialized = true;\r\n            for (const s of this.systems) {\r\n                if (s.initialize) {\r\n                    s.initialize(this._world.context);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Updates all systems\r\n     * @param type whether this is an update or draw system\r\n     * @param context context reference\r\n     * @param delta time in milliseconds\r\n     */\r\n    updateSystems(type, context, delta) {\r\n        const systems = this.systems.filter((s) => s.systemType === type);\r\n        for (const s of systems) {\r\n            if (s.preupdate) {\r\n                s.preupdate(context, delta);\r\n            }\r\n        }\r\n        for (const s of systems) {\r\n            // Get entities that match the system types, pre-sort\r\n            const entities = this._world.queryManager.getQuery(s.types).getEntities(s.sort);\r\n            // Initialize entities if needed\r\n            if (context instanceof Scene) {\r\n                for (const entity of entities) {\r\n                    entity._initialize(context === null || context === void 0 ? void 0 : context.engine);\r\n                }\r\n            }\r\n            s.update(entities, delta);\r\n        }\r\n        for (const s of systems) {\r\n            if (s.postupdate) {\r\n                s.postupdate(context, delta);\r\n            }\r\n        }\r\n    }\r\n    clear() {\r\n        for (const system of this.systems) {\r\n            this.removeSystem(system);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/World.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * The World is a self-contained entity component system for a particular context.\r\n */\r\nclass World {\r\n    /**\r\n     * The context type is passed to the system updates\r\n     * @param context\r\n     */\r\n    constructor(context) {\r\n        this.context = context;\r\n        this.queryManager = new QueryManager(this);\r\n        this.entityManager = new EntityManager(this);\r\n        this.systemManager = new SystemManager(this);\r\n    }\r\n    /**\r\n     * Update systems by type and time elapsed in milliseconds\r\n     */\r\n    update(type, delta) {\r\n        if (type === SystemType.Update) {\r\n            this.entityManager.updateEntities(this.context, delta);\r\n        }\r\n        this.systemManager.updateSystems(type, this.context, delta);\r\n        this.entityManager.findEntitiesForRemoval();\r\n        this.entityManager.processComponentRemovals();\r\n        this.entityManager.processEntityRemovals();\r\n    }\r\n    add(entityOrSystem) {\r\n        if (entityOrSystem instanceof Entity) {\r\n            this.entityManager.addEntity(entityOrSystem);\r\n        }\r\n        if (entityOrSystem instanceof System) {\r\n            this.systemManager.addSystem(entityOrSystem);\r\n        }\r\n    }\r\n    remove(entityOrSystem, deferred = true) {\r\n        if (entityOrSystem instanceof Entity) {\r\n            this.entityManager.removeEntity(entityOrSystem, deferred);\r\n        }\r\n        if (entityOrSystem instanceof System) {\r\n            this.systemManager.removeSystem(entityOrSystem);\r\n        }\r\n    }\r\n    clearEntities() {\r\n        this.entityManager.clear();\r\n    }\r\n    clearSystems() {\r\n        this.systemManager.clear();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Integrator.ts\nclass EulerIntegrator {\r\n    static integrate(transform, motion, totalAcc, elapsedMs) {\r\n        const seconds = elapsedMs / 1000;\r\n        motion.vel.addEqual(totalAcc.scale(seconds));\r\n        transform.pos.addEqual(motion.vel.scale(seconds)).addEqual(totalAcc.scale(0.5 * seconds * seconds));\r\n        motion.angularVelocity += motion.torque * (1.0 / motion.inertia) * seconds;\r\n        transform.rotation += motion.angularVelocity * seconds;\r\n        transform.scale.addEqual(motion.scaleFactor.scale(seconds));\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/MotionSystem.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass MotionSystem extends System {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.types = ['ex.transform', 'ex.motion'];\r\n        this.systemType = SystemType.Update;\r\n        this.priority = -1;\r\n    }\r\n    update(_entities, elapsedMs) {\r\n        let transform;\r\n        let motion;\r\n        for (const entity of _entities) {\r\n            transform = entity.get(TransformComponent);\r\n            motion = entity.get(MotionComponent);\r\n            const optionalBody = entity.get(BodyComponent);\r\n            if (optionalBody === null || optionalBody === void 0 ? void 0 : optionalBody.sleeping) {\r\n                continue;\r\n            }\r\n            const totalAcc = motion.acc.clone();\r\n            if ((optionalBody === null || optionalBody === void 0 ? void 0 : optionalBody.collisionType) === CollisionType.Active && (optionalBody === null || optionalBody === void 0 ? void 0 : optionalBody.useGravity)) {\r\n                totalAcc.addEqual(Physics.gravity);\r\n            }\r\n            optionalBody === null || optionalBody === void 0 ? void 0 : optionalBody.captureOldTransform();\r\n            // Update transform and motion based on Euler linear algebra\r\n            EulerIntegrator.integrate(transform, motion, totalAcc, elapsedMs);\r\n        }\r\n    }\r\n    /**\r\n     * @deprecated signature will change in v0.26.0\r\n     * @param _ctx\r\n     */\r\n    debugDraw(_ctx) {\r\n        // pass\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Solver/Solver.ts\n/**\r\n * A collision solver figures out how to position colliders such that they are no longer overlapping\r\n *\r\n * Solvers are executed in the order\r\n *\r\n * 1. preSolve\r\n * 2. solveVelocity\r\n * 3. solvePosition\r\n * 4. postSolve\r\n * @inheritdoc\r\n */\r\nclass CollisionSolver {\r\n    /**\r\n     * Solves overlapping contact in\r\n     *\r\n     * Solvers are executed in the order\r\n     * 1. preSolve\r\n     * 2. solveVelocity\r\n     * 3. solvePosition\r\n     * 4. postSolve\r\n     * @param contacts\r\n     */\r\n    solve(contacts) {\r\n        // Events and init\r\n        this.preSolve(contacts);\r\n        // Remove any canceled contacts\r\n        contacts = contacts.filter(c => !c.isCanceled());\r\n        // Solve velocity first\r\n        this.solveVelocity(contacts);\r\n        // Solve position last because non-overlap is the most important\r\n        this.solvePosition(contacts);\r\n        // Events and any contact house-keeping the solver needs\r\n        this.postSolve(contacts);\r\n        return contacts;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Solver/ArcadeSolver.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * ArcadeSolver is the default in Excalibur. It solves collisions so that there is no overlap between contacts,\r\n * and negates velocity along the collision normal.\r\n *\r\n * This is usually the type of collisions used for 2D games that don't need a more realistic collision simulation.\r\n *\r\n */\r\nclass ArcadeSolver extends CollisionSolver {\r\n    preSolve(contacts) {\r\n        for (const contact of contacts) {\r\n            const side = Side.fromDirection(contact.mtv);\r\n            const mtv = contact.mtv.negate();\r\n            // Publish collision events on both participants\r\n            contact.colliderA.events.emit('precollision', new PreCollisionEvent(contact.colliderA, contact.colliderB, side, mtv));\r\n            contact.colliderB.events.emit('precollision', new PreCollisionEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), mtv.negate()));\r\n        }\r\n    }\r\n    postSolve(contacts) {\r\n        var _a, _b;\r\n        for (const contact of contacts) {\r\n            const colliderA = contact.colliderA;\r\n            const colliderB = contact.colliderB;\r\n            const bodyA = (_a = colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n            const bodyB = (_b = colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n            if (bodyA && bodyB) {\r\n                if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\r\n                    continue;\r\n                }\r\n            }\r\n            const side = Side.fromDirection(contact.mtv);\r\n            const mtv = contact.mtv.negate();\r\n            // Publish collision events on both participants\r\n            contact.colliderA.events.emit('postcollision', new PostCollisionEvent(contact.colliderA, contact.colliderB, side, mtv));\r\n            contact.colliderB.events.emit('postcollision', new PostCollisionEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), mtv.negate()));\r\n        }\r\n    }\r\n    solvePosition(contacts) {\r\n        var _a, _b;\r\n        for (const contact of contacts) {\r\n            // if bounds no longer interesect skip to the next\r\n            // this removes jitter from overlapping/stacked solid tiles or a wall of solid tiles\r\n            if (!contact.colliderA.bounds.intersect(contact.colliderB.bounds)) {\r\n                continue;\r\n            }\r\n            let mtv = contact.mtv;\r\n            const colliderA = contact.colliderA;\r\n            const colliderB = contact.colliderB;\r\n            const bodyA = (_a = colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n            const bodyB = (_b = colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n            if (bodyA && bodyB) {\r\n                if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\r\n                    continue;\r\n                }\r\n                if (bodyA.collisionType === CollisionType.Active && bodyB.collisionType === CollisionType.Active) {\r\n                    // split overlaps if both are Active\r\n                    mtv = mtv.scale(0.5);\r\n                }\r\n                // Resolve overlaps\r\n                if (bodyA.collisionType === CollisionType.Active) {\r\n                    bodyA.pos.x -= mtv.x;\r\n                    bodyA.pos.y -= mtv.y;\r\n                }\r\n                if (bodyB.collisionType === CollisionType.Active) {\r\n                    bodyB.pos.x += mtv.x;\r\n                    bodyB.pos.y += mtv.y;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    solveVelocity(contacts) {\r\n        var _a, _b;\r\n        for (const contact of contacts) {\r\n            const colliderA = contact.colliderA;\r\n            const colliderB = contact.colliderB;\r\n            const bodyA = (_a = colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n            const bodyB = (_b = colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n            if (bodyA && bodyB) {\r\n                if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\r\n                    continue;\r\n                }\r\n                const normal = contact.normal;\r\n                const opposite = normal.negate();\r\n                // Cancel out velocity opposite direction of collision normal\r\n                if (bodyA.collisionType === CollisionType.Active) {\r\n                    const velAdj = normal.scale(normal.dot(bodyA.vel.negate()));\r\n                    bodyA.vel = bodyA.vel.add(velAdj);\r\n                }\r\n                if (bodyB.collisionType === CollisionType.Active) {\r\n                    const velAdj = opposite.scale(opposite.dot(bodyB.vel.negate()));\r\n                    bodyB.vel = bodyB.vel.add(velAdj);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Solver/ContactConstraintPoint.ts\n\r\n\r\n/**\r\n * Holds information about contact points, meant to be reused over multiple frames of contact\r\n */\r\nclass ContactConstraintPoint {\r\n    constructor(point, local, contact) {\r\n        this.point = point;\r\n        this.local = local;\r\n        this.contact = contact;\r\n        /**\r\n         * Impulse accumulated over time in normal direction\r\n         */\r\n        this.normalImpulse = 0;\r\n        /**\r\n         * Impulse accumulated over time in the tangent direction\r\n         */\r\n        this.tangentImpulse = 0;\r\n        /**\r\n         * Effective mass seen in the normal direction\r\n         */\r\n        this.normalMass = 0;\r\n        /**\r\n         * Effective mass seen in the tangent direction\r\n         */\r\n        this.tangentMass = 0;\r\n        /**\r\n         * Direction from center of mass of bodyA to contact point\r\n         */\r\n        this.aToContact = new Vector(0, 0);\r\n        /**\r\n         * Direction from center of mass of bodyB to contact point\r\n         */\r\n        this.bToContact = new Vector(0, 0);\r\n        this.update();\r\n    }\r\n    /**\r\n     * Updates the contact information\r\n     */\r\n    update() {\r\n        var _a, _b;\r\n        const bodyA = (_a = this.contact.colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n        const bodyB = (_b = this.contact.colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n        if (bodyA && bodyB) {\r\n            const normal = this.contact.normal;\r\n            const tangent = this.contact.tangent;\r\n            this.aToContact = this.point.sub(bodyA.pos);\r\n            this.bToContact = this.point.sub(bodyB.pos);\r\n            const aToContactNormal = this.aToContact.cross(normal);\r\n            const bToContactNormal = this.bToContact.cross(normal);\r\n            this.normalMass =\r\n                bodyA.inverseMass +\r\n                    bodyB.inverseMass +\r\n                    bodyA.inverseInertia * aToContactNormal * aToContactNormal +\r\n                    bodyB.inverseInertia * bToContactNormal * bToContactNormal;\r\n            const aToContactTangent = this.aToContact.cross(tangent);\r\n            const bToContactTangent = this.bToContact.cross(tangent);\r\n            this.tangentMass =\r\n                bodyA.inverseMass +\r\n                    bodyB.inverseMass +\r\n                    bodyA.inverseInertia * aToContactTangent * aToContactTangent +\r\n                    bodyB.inverseInertia * bToContactTangent * bToContactTangent;\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Returns the relative velocity between bodyA and bodyB\r\n     */\r\n    getRelativeVelocity() {\r\n        var _a, _b;\r\n        const bodyA = (_a = this.contact.colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n        const bodyB = (_b = this.contact.colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n        if (bodyA && bodyB) {\r\n            // Relative velocity in linear terms\r\n            // Angular to linear velocity formula -> omega = velocity/radius so omega x radius = velocity\r\n            const velA = bodyA.vel.add(Vector.cross(bodyA.angularVelocity, this.aToContact));\r\n            const velB = bodyB.vel.add(Vector.cross(bodyB.angularVelocity, this.bToContact));\r\n            return velB.sub(velA);\r\n        }\r\n        return Vector.Zero;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Solver/RealisticSolver.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass RealisticSolver extends CollisionSolver {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.lastFrameContacts = new Map();\r\n        // map contact id to contact points\r\n        this.idToContactConstraint = new Map();\r\n    }\r\n    getContactConstraints(id) {\r\n        var _a;\r\n        return (_a = this.idToContactConstraint.get(id)) !== null && _a !== void 0 ? _a : [];\r\n    }\r\n    preSolve(contacts) {\r\n        var _a, _b, _c;\r\n        for (const contact of contacts) {\r\n            // Publish collision events on both participants\r\n            const side = Side.fromDirection(contact.mtv);\r\n            contact.colliderA.events.emit('precollision', new PreCollisionEvent(contact.colliderA, contact.colliderB, side, contact.mtv));\r\n            contact.colliderA.events.emit('beforecollisionresolve', new CollisionPreSolveEvent(contact.colliderA, contact.colliderB, side, contact.mtv, contact));\r\n            contact.colliderB.events.emit('precollision', new PreCollisionEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), contact.mtv.negate()));\r\n            contact.colliderB.events.emit('beforecollisionresolve', new CollisionPreSolveEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), contact.mtv.negate(), contact));\r\n            // Match awake state for sleeping\r\n            contact.matchAwake();\r\n        }\r\n        // Keep track of contacts that done\r\n        const finishedContactIds = Array.from(this.idToContactConstraint.keys());\r\n        for (const contact of contacts) {\r\n            // Remove all current contacts that are not done\r\n            const index = finishedContactIds.indexOf(contact.id);\r\n            if (index > -1) {\r\n                finishedContactIds.splice(index, 1);\r\n            }\r\n            const contactPoints = (_a = this.idToContactConstraint.get(contact.id)) !== null && _a !== void 0 ? _a : [];\r\n            let pointIndex = 0;\r\n            const bodyA = contact.colliderA.owner.get(BodyComponent);\r\n            const bodyB = contact.colliderB.owner.get(BodyComponent);\r\n            if (bodyA && bodyB) {\r\n                for (const point of contact.points) {\r\n                    const normal = contact.normal;\r\n                    const tangent = contact.tangent;\r\n                    const aToContact = point.sub(bodyA.pos);\r\n                    const bToContact = point.sub(bodyB.pos);\r\n                    const aToContactNormal = aToContact.cross(normal);\r\n                    const bToContactNormal = bToContact.cross(normal);\r\n                    const normalMass = bodyA.inverseMass +\r\n                        bodyB.inverseMass +\r\n                        bodyA.inverseInertia * aToContactNormal * aToContactNormal +\r\n                        bodyB.inverseInertia * bToContactNormal * bToContactNormal;\r\n                    const aToContactTangent = aToContact.cross(tangent);\r\n                    const bToContactTangent = bToContact.cross(tangent);\r\n                    const tangentMass = bodyA.inverseMass +\r\n                        bodyB.inverseMass +\r\n                        bodyA.inverseInertia * aToContactTangent * aToContactTangent +\r\n                        bodyB.inverseInertia * bToContactTangent * bToContactTangent;\r\n                    // Preserve normal/tangent impulse by re-using the contact point if it's close\r\n                    if (contactPoints[pointIndex] && ((_c = (_b = contactPoints[pointIndex]) === null || _b === void 0 ? void 0 : _b.point) === null || _c === void 0 ? void 0 : _c.squareDistance(point)) < 4) {\r\n                        contactPoints[pointIndex].point = point;\r\n                        contactPoints[pointIndex].local = contact.localPoints[pointIndex];\r\n                    }\r\n                    else {\r\n                        // new contact if it's not close or doesn't exist\r\n                        contactPoints[pointIndex] = new ContactConstraintPoint(point, contact.localPoints[pointIndex], contact);\r\n                    }\r\n                    // Update contact point calculations\r\n                    contactPoints[pointIndex].aToContact = aToContact;\r\n                    contactPoints[pointIndex].bToContact = bToContact;\r\n                    contactPoints[pointIndex].normalMass = normalMass;\r\n                    contactPoints[pointIndex].tangentMass = tangentMass;\r\n                    pointIndex++;\r\n                }\r\n            }\r\n            this.idToContactConstraint.set(contact.id, contactPoints);\r\n        }\r\n        // Clean up any contacts that did not occur last frame\r\n        for (const id of finishedContactIds) {\r\n            this.idToContactConstraint.delete(id);\r\n        }\r\n        // Warm contacts with accumulated impulse\r\n        // Useful for tall stacks\r\n        if (Physics.warmStart) {\r\n            this.warmStart(contacts);\r\n        }\r\n        else {\r\n            for (const contact of contacts) {\r\n                const contactPoints = this.getContactConstraints(contact.id);\r\n                for (const point of contactPoints) {\r\n                    point.normalImpulse = 0;\r\n                    point.tangentImpulse = 0;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    postSolve(contacts) {\r\n        for (const contact of contacts) {\r\n            const bodyA = contact.colliderA.owner.get(BodyComponent);\r\n            const bodyB = contact.colliderB.owner.get(BodyComponent);\r\n            if (bodyA && bodyB) {\r\n                // Skip post solve for active+passive collisions\r\n                if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\r\n                    continue;\r\n                }\r\n                // Update motion values for sleeping\r\n                bodyA.updateMotion();\r\n                bodyB.updateMotion();\r\n            }\r\n            // Publish collision events on both participants\r\n            const side = Side.fromDirection(contact.mtv);\r\n            contact.colliderA.events.emit('postcollision', new PostCollisionEvent(contact.colliderA, contact.colliderB, side, contact.mtv));\r\n            contact.colliderA.events.emit('aftercollisionresolve', new CollisionPostSolveEvent(contact.colliderA, contact.colliderB, side, contact.mtv, contact));\r\n            contact.colliderB.events.emit('postcollision', new PostCollisionEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), contact.mtv.negate()));\r\n            contact.colliderB.events.emit('aftercollisionresolve', new CollisionPostSolveEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), contact.mtv.negate(), contact));\r\n        }\r\n        // Store contacts\r\n        this.lastFrameContacts.clear();\r\n        for (const c of contacts) {\r\n            this.lastFrameContacts.set(c.id, c);\r\n        }\r\n    }\r\n    /**\r\n     * Warm up body's based on previous frame contact points\r\n     * @param contacts\r\n     */\r\n    warmStart(contacts) {\r\n        var _a, _b, _c;\r\n        for (const contact of contacts) {\r\n            const bodyA = (_a = contact.colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n            const bodyB = (_b = contact.colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n            if (bodyA && bodyB) {\r\n                const contactPoints = (_c = this.idToContactConstraint.get(contact.id)) !== null && _c !== void 0 ? _c : [];\r\n                for (const point of contactPoints) {\r\n                    if (Physics.warmStart) {\r\n                        const normalImpulse = contact.normal.scale(point.normalImpulse);\r\n                        const tangentImpulse = contact.tangent.scale(point.tangentImpulse);\r\n                        const impulse = normalImpulse.add(tangentImpulse);\r\n                        bodyA.applyImpulse(point.point, impulse.negate());\r\n                        bodyB.applyImpulse(point.point, impulse);\r\n                    }\r\n                    else {\r\n                        point.normalImpulse = 0;\r\n                        point.tangentImpulse = 0;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Iteratively solve the position overlap constraint\r\n     * @param contacts\r\n     */\r\n    solvePosition(contacts) {\r\n        var _a, _b, _c;\r\n        for (let i = 0; i < Physics.positionIterations; i++) {\r\n            for (const contact of contacts) {\r\n                const bodyA = (_a = contact.colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n                const bodyB = (_b = contact.colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n                if (bodyA && bodyB) {\r\n                    // Skip solving active+passive\r\n                    if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\r\n                        continue;\r\n                    }\r\n                    const constraints = (_c = this.idToContactConstraint.get(contact.id)) !== null && _c !== void 0 ? _c : [];\r\n                    for (const point of constraints) {\r\n                        const normal = contact.normal;\r\n                        const separation = CollisionJumpTable.FindContactSeparation(contact, point.local);\r\n                        const steeringConstant = Physics.steeringFactor; //0.2;\r\n                        const maxCorrection = -5;\r\n                        const slop = Physics.slop; //1;\r\n                        // Clamp to avoid over-correction\r\n                        // Remember that we are shooting for 0 overlap in the end\r\n                        const steeringForce = clamp(steeringConstant * (separation + slop), maxCorrection, 0);\r\n                        const impulse = normal.scale(-steeringForce / point.normalMass);\r\n                        // This is a pseudo impulse, meaning we aren't doing a real impulse calculation\r\n                        // We adjust position and rotation instead of doing the velocity\r\n                        if (bodyA.collisionType === CollisionType.Active) {\r\n                            bodyA.pos = bodyA.pos.add(impulse.negate().scale(bodyA.inverseMass));\r\n                            bodyA.rotation -= point.aToContact.cross(impulse) * bodyA.inverseInertia;\r\n                        }\r\n                        if (bodyB.collisionType === CollisionType.Active) {\r\n                            bodyB.pos = bodyB.pos.add(impulse.scale(bodyB.inverseMass));\r\n                            bodyB.rotation += point.bToContact.cross(impulse) * bodyB.inverseInertia;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    solveVelocity(contacts) {\r\n        var _a, _b, _c;\r\n        for (let i = 0; i < Physics.velocityIterations; i++) {\r\n            for (const contact of contacts) {\r\n                const bodyA = (_a = contact.colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n                const bodyB = (_b = contact.colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n                if (bodyA && bodyB) {\r\n                    // Skip solving active+passive\r\n                    if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\r\n                        continue;\r\n                    }\r\n                    const restitution = bodyA.bounciness * bodyB.bounciness;\r\n                    const friction = Math.min(bodyA.friction, bodyB.friction);\r\n                    const constraints = (_c = this.idToContactConstraint.get(contact.id)) !== null && _c !== void 0 ? _c : [];\r\n                    for (const point of constraints) {\r\n                        const relativeVelocity = point.getRelativeVelocity();\r\n                        // Negate velocity in tangent direction to simulate friction\r\n                        const tangentVelocity = -relativeVelocity.dot(contact.tangent);\r\n                        let impulseDelta = tangentVelocity / point.tangentMass;\r\n                        // Clamping based in Erin Catto's GDC 2006 talk\r\n                        // Correct clamping https://github.com/erincatto/box2d-lite/blob/master/docs/GDC2006_Catto_Erin_PhysicsTutorial.pdf\r\n                        // Accumulated fiction impulse is always between -uMaxFriction < dT < uMaxFriction\r\n                        // But deltas can vary\r\n                        const maxFriction = friction * point.normalImpulse;\r\n                        const newImpulse = clamp(point.tangentImpulse + impulseDelta, -maxFriction, maxFriction);\r\n                        impulseDelta = newImpulse - point.tangentImpulse;\r\n                        point.tangentImpulse = newImpulse;\r\n                        const impulse = contact.tangent.scale(impulseDelta);\r\n                        bodyA.applyImpulse(point.point, impulse.negate());\r\n                        bodyB.applyImpulse(point.point, impulse);\r\n                    }\r\n                    for (const point of constraints) {\r\n                        // Need to recalc relative velocity because the previous step could have changed vel\r\n                        const relativeVelocity = point.getRelativeVelocity();\r\n                        // Compute impulse in normal direction\r\n                        const normalVelocity = relativeVelocity.dot(contact.normal);\r\n                        // See https://en.wikipedia.org/wiki/Collision_response\r\n                        let impulseDelta = (-(1 + restitution) * normalVelocity) / point.normalMass;\r\n                        // Clamping based in Erin Catto's GDC 2014 talk\r\n                        // Accumulated impulse stored in the contact is always positive (dV > 0)\r\n                        // But deltas can be negative\r\n                        const newImpulse = Math.max(point.normalImpulse + impulseDelta, 0);\r\n                        impulseDelta = newImpulse - point.normalImpulse;\r\n                        point.normalImpulse = newImpulse;\r\n                        const impulse = contact.normal.scale(impulseDelta);\r\n                        bodyA.applyImpulse(point.point, impulse.negate());\r\n                        bodyB.applyImpulse(point.point, impulse);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/CollisionSystem.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass CollisionSystem extends System {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.types = ['ex.transform', 'ex.motion', 'ex.collider'];\r\n        this.systemType = SystemType.Update;\r\n        this.priority = -1;\r\n        this._realisticSolver = new RealisticSolver();\r\n        this._arcadeSolver = new ArcadeSolver();\r\n        this._processor = new DynamicTreeCollisionProcessor();\r\n        this._lastFrameContacts = new Map();\r\n        this._currentFrameContacts = new Map();\r\n        this._trackCollider = (c) => this._processor.track(c);\r\n        this._untrackCollider = (c) => this._processor.untrack(c);\r\n    }\r\n    notify(message) {\r\n        if (isAddedSystemEntity(message)) {\r\n            const colliderComponent = message.data.get(ColliderComponent);\r\n            colliderComponent.$colliderAdded.subscribe(this._trackCollider);\r\n            colliderComponent.$colliderRemoved.subscribe(this._untrackCollider);\r\n            const collider = colliderComponent.get();\r\n            if (collider) {\r\n                this._processor.track(collider);\r\n            }\r\n        }\r\n        else {\r\n            const colliderComponent = message.data.get(ColliderComponent);\r\n            const collider = colliderComponent.get();\r\n            if (colliderComponent && collider) {\r\n                this._processor.untrack(collider);\r\n            }\r\n        }\r\n    }\r\n    initialize(scene) {\r\n        this._engine = scene.engine;\r\n    }\r\n    update(_entities, elapsedMs) {\r\n        var _a;\r\n        if (!Physics.enabled) {\r\n            return;\r\n        }\r\n        // Collect up all the colliders\r\n        let colliders = [];\r\n        for (const entity of _entities) {\r\n            const colliderComp = entity.get(ColliderComponent);\r\n            const collider = colliderComp === null || colliderComp === void 0 ? void 0 : colliderComp.get();\r\n            if (colliderComp && ((_a = colliderComp.owner) === null || _a === void 0 ? void 0 : _a.active) && collider) {\r\n                colliderComp.update();\r\n                if (collider instanceof CompositeCollider) {\r\n                    colliders = colliders.concat(collider.getColliders());\r\n                }\r\n                else {\r\n                    colliders.push(collider);\r\n                }\r\n            }\r\n        }\r\n        // Update the spatial partitioning data structures\r\n        // TODO if collider invalid it will break the processor\r\n        // TODO rename \"update\" to something more specific\r\n        this._processor.update(colliders);\r\n        // Run broadphase on all colliders and locates potential collisions\r\n        const pairs = this._processor.broadphase(colliders, elapsedMs);\r\n        this._currentFrameContacts.clear();\r\n        // Given possible pairs find actual contacts\r\n        let contacts = this._processor.narrowphase(pairs, this._engine.debug.stats.currFrame);\r\n        const solver = this.getSolver();\r\n        // Solve, this resolves the position/velocity so entities aren't overlapping\r\n        contacts = solver.solve(contacts);\r\n        // Record contacts\r\n        contacts.forEach((c) => this._currentFrameContacts.set(c.id, c));\r\n        // Emit contact start/end events\r\n        this.runContactStartEnd();\r\n        // reset the last frame cache\r\n        this._lastFrameContacts.clear();\r\n        // Keep track of collisions contacts that have started or ended\r\n        this._lastFrameContacts = new Map(this._currentFrameContacts);\r\n    }\r\n    getSolver() {\r\n        return Physics.collisionResolutionStrategy === CollisionResolutionStrategy.Realistic ? this._realisticSolver : this._arcadeSolver;\r\n    }\r\n    debug(ex) {\r\n        this._processor.debug(ex);\r\n    }\r\n    runContactStartEnd() {\r\n        for (const [id, c] of this._currentFrameContacts) {\r\n            // find all new contacts\r\n            if (!this._lastFrameContacts.has(id)) {\r\n                const colliderA = c.colliderA;\r\n                const colliderB = c.colliderB;\r\n                colliderA.events.emit('collisionstart', new CollisionStartEvent(colliderA, colliderB, c));\r\n                colliderA.events.emit('contactstart', new ContactStartEvent(colliderA, colliderB, c));\r\n                colliderB.events.emit('collisionstart', new CollisionStartEvent(colliderB, colliderA, c));\r\n                colliderB.events.emit('contactstart', new ContactStartEvent(colliderB, colliderA, c));\r\n            }\r\n        }\r\n        // find all contacts taht have ceased\r\n        for (const [id, c] of this._lastFrameContacts) {\r\n            if (!this._currentFrameContacts.has(id)) {\r\n                const colliderA = c.colliderA;\r\n                const colliderB = c.colliderB;\r\n                colliderA.events.emit('collisionend', new CollisionEndEvent(colliderA, colliderB));\r\n                colliderA.events.emit('contactend', new ContactEndEvent(colliderA, colliderB));\r\n                colliderB.events.emit('collisionend', new CollisionEndEvent(colliderB, colliderA));\r\n                colliderB.events.emit('contactend', new ContactEndEvent(colliderB, colliderA));\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Animation.ts\n\r\n\r\n\r\n\r\n\r\n\r\nvar AnimationDirection;\r\n(function (AnimationDirection) {\r\n    /**\r\n     * Animation is playing forwards\r\n     */\r\n    AnimationDirection[\"Forward\"] = \"forward\";\r\n    /**\r\n     * Animation is play backwards\r\n     */\r\n    AnimationDirection[\"Backward\"] = \"backward\";\r\n})(AnimationDirection || (AnimationDirection = {}));\r\nvar AnimationStrategy;\r\n(function (AnimationStrategy) {\r\n    /**\r\n     * Animation ends without displaying anything\r\n     */\r\n    AnimationStrategy[\"End\"] = \"end\";\r\n    /**\r\n     * Animation loops to the first frame after the last frame\r\n     */\r\n    AnimationStrategy[\"Loop\"] = \"loop\";\r\n    /**\r\n     * Animation plays to the last frame, then backwards to the first frame, then repeats\r\n     */\r\n    AnimationStrategy[\"PingPong\"] = \"pingpong\";\r\n    /**\r\n     * Animation ends stopping on the last frame\r\n     */\r\n    AnimationStrategy[\"Freeze\"] = \"freeze\";\r\n})(AnimationStrategy || (AnimationStrategy = {}));\r\n/**\r\n * Create an Animation given a list of [[Frame|frames]] in [[AnimationOptions]]\r\n *\r\n * To create an Animation from a [[SpriteSheet]], use [[Animation.fromSpriteSheet]]\r\n */\r\nclass Animation extends Graphic {\r\n    constructor(options) {\r\n        var _a, _b;\r\n        super(options);\r\n        this.events = new EventDispatcher(); // TODO replace with new Emitter\r\n        this.frames = [];\r\n        this.strategy = AnimationStrategy.Loop;\r\n        this.frameDuration = 100;\r\n        this.timeScale = 1;\r\n        this._idempotencyToken = -1;\r\n        this._firstTick = true;\r\n        this._currentFrame = 0;\r\n        this._timeLeftInFrame = 0;\r\n        this._direction = 1; // TODO only used in ping-pong\r\n        this._done = false;\r\n        this._playing = true;\r\n        this._reversed = false;\r\n        this.frames = options.frames;\r\n        this.strategy = (_a = options.strategy) !== null && _a !== void 0 ? _a : this.strategy;\r\n        this.frameDuration = options.totalDuration ? options.totalDuration / this.frames.length : (_b = options.frameDuration) !== null && _b !== void 0 ? _b : this.frameDuration;\r\n        if (options.reverse) {\r\n            this.reverse();\r\n        }\r\n        this.goToFrame(0);\r\n    }\r\n    clone() {\r\n        return new Animation({\r\n            frames: this.frames.map((f) => ({ ...f })),\r\n            frameDuration: this.frameDuration,\r\n            reverse: this._reversed,\r\n            strategy: this.strategy,\r\n            ...this.cloneGraphicOptions()\r\n        });\r\n    }\r\n    get width() {\r\n        const maybeFrame = this.currentFrame;\r\n        if (maybeFrame) {\r\n            return Math.abs(maybeFrame.graphic.width * this.scale.x);\r\n        }\r\n        return 0;\r\n    }\r\n    get height() {\r\n        const maybeFrame = this.currentFrame;\r\n        if (maybeFrame) {\r\n            return Math.abs(maybeFrame.graphic.height * this.scale.y);\r\n        }\r\n        return 0;\r\n    }\r\n    /**\r\n     * Create an Animation from a [[SpriteSheet]], a list of indices into the sprite sheet, a duration per frame\r\n     * and optional [[AnimationStrategy]]\r\n     *\r\n     * Example:\r\n     * ```typescript\r\n     * const spriteSheet = SpriteSheet.fromImageSource({...});\r\n     *\r\n     * const anim = Animation.fromSpriteSheet(spriteSheet, range(0, 5), 200, AnimationStrategy.Loop);\r\n     * ```\r\n     *\r\n     * @param spriteSheet\r\n     * @param frameIndices\r\n     * @param durationPerFrameMs\r\n     * @param strategy\r\n     */\r\n    static fromSpriteSheet(spriteSheet, frameIndices, durationPerFrameMs, strategy = AnimationStrategy.Loop) {\r\n        const maxIndex = spriteSheet.sprites.length - 1;\r\n        const invalidIndices = frameIndices.filter((index) => index < 0 || index > maxIndex);\r\n        if (invalidIndices.length) {\r\n            Animation._LOGGER.warn(`Indices into SpriteSheet were provided that don\\'t exist: ${invalidIndices.join(',')} no frame will be shown`);\r\n        }\r\n        return new Animation({\r\n            frames: spriteSheet.sprites\r\n                .filter((_, index) => frameIndices.indexOf(index) > -1)\r\n                .map((f) => ({\r\n                graphic: f,\r\n                duration: durationPerFrameMs\r\n            })),\r\n            strategy: strategy\r\n        });\r\n    }\r\n    /**\r\n     * Converts an animation to a legacy animation\r\n     * @deprecated\r\n     * @param engine\r\n     * @param animation\r\n     * @returns LegacyDrawing.Animation\r\n     */\r\n    static toLegacyAnimation(engine, animation) {\r\n        const legacySprites = animation.frames.map(f => Sprite.toLegacySprite(f.graphic));\r\n        return new Animation_Animation({\r\n            sprites: legacySprites,\r\n            loop: animation.strategy === AnimationStrategy.Loop,\r\n            freezeFrame: animation.strategy === AnimationStrategy.Freeze ? legacySprites.length - 1 : undefined,\r\n            speed: animation.frameDuration,\r\n            engine: engine\r\n        });\r\n    }\r\n    /**\r\n     * Returns the current Frame of the animation\r\n     */\r\n    get currentFrame() {\r\n        if (this._currentFrame >= 0 && this._currentFrame < this.frames.length) {\r\n            return this.frames[this._currentFrame];\r\n        }\r\n        return null;\r\n    }\r\n    /**\r\n     * Returns the current frame index of the animation\r\n     */\r\n    get currentFrameIndex() {\r\n        return this._currentFrame;\r\n    }\r\n    /**\r\n     * Returns `true` if the animation is playing\r\n     */\r\n    get isPlaying() {\r\n        return this._playing;\r\n    }\r\n    /**\r\n     * Reverses the play direction of the Animation, this preserves the current frame\r\n     */\r\n    reverse() {\r\n        // Don't mutate with the original frame list, create a copy\r\n        this.frames = this.frames.slice().reverse();\r\n        this._reversed = !this._reversed;\r\n    }\r\n    /**\r\n     * Returns the current play direction of the animation\r\n     */\r\n    get direction() {\r\n        // Keep logically consistent with ping-pong direction\r\n        // If ping-pong is forward = 1 and reversed is true then we are logically reversed\r\n        const reversed = (this._reversed && this._direction === 1) ? true : false;\r\n        return reversed ? AnimationDirection.Backward : AnimationDirection.Forward;\r\n    }\r\n    /**\r\n     * Plays or resumes the animation from the current frame\r\n     */\r\n    play() {\r\n        this._playing = true;\r\n    }\r\n    /**\r\n     * Pauses the animation on the current frame\r\n     */\r\n    pause() {\r\n        this._playing = false;\r\n        this._firstTick = true; // firstTick must be set to emit the proper frame event\r\n    }\r\n    /**\r\n     * Reset the animation back to the beginning, including if the animation were done\r\n     */\r\n    reset() {\r\n        this._done = false;\r\n        this._firstTick = true;\r\n        this._currentFrame = 0;\r\n    }\r\n    /**\r\n     * Returns `true` if the animation can end\r\n     */\r\n    get canFinish() {\r\n        switch (this.strategy) {\r\n            case AnimationStrategy.End:\r\n            case AnimationStrategy.Freeze: {\r\n                return true;\r\n            }\r\n            default: {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Returns `true` if the animation is done, for looping type animations\r\n     * `ex.AnimationStrategy.PingPong` and `ex.AnimationStrategy.Loop` this will always return `false`\r\n     *\r\n     * See the `ex.Animation.canFinish()` method to know if an animation type can end\r\n     */\r\n    get done() {\r\n        return this._done;\r\n    }\r\n    /**\r\n     * Jump the animation immediately to a specific frame if it exists\r\n     * @param frameNumber\r\n     */\r\n    goToFrame(frameNumber) {\r\n        this._currentFrame = frameNumber;\r\n        this._timeLeftInFrame = this.frameDuration;\r\n        const maybeFrame = this.frames[this._currentFrame];\r\n        if (maybeFrame && !this._done) {\r\n            this._timeLeftInFrame = (maybeFrame === null || maybeFrame === void 0 ? void 0 : maybeFrame.duration) || this.frameDuration;\r\n            this.events.emit('frame', maybeFrame);\r\n        }\r\n    }\r\n    _nextFrame() {\r\n        const currentFrame = this._currentFrame;\r\n        if (this._done) {\r\n            return currentFrame;\r\n        }\r\n        let next = -1;\r\n        switch (this.strategy) {\r\n            case AnimationStrategy.Loop: {\r\n                next = (currentFrame + 1) % this.frames.length;\r\n                if (next === 0) {\r\n                    this.events.emit('loop', this);\r\n                }\r\n                break;\r\n            }\r\n            case AnimationStrategy.End: {\r\n                next = currentFrame + 1;\r\n                if (next >= this.frames.length) {\r\n                    this._done = true;\r\n                    this._currentFrame = this.frames.length;\r\n                    this.events.emit('end', this);\r\n                }\r\n                break;\r\n            }\r\n            case AnimationStrategy.Freeze: {\r\n                next = clamp(currentFrame + 1, 0, this.frames.length - 1);\r\n                if (next >= this.frames.length - 1) {\r\n                    this._done = true;\r\n                    this.events.emit('end', this);\r\n                }\r\n                break;\r\n            }\r\n            case AnimationStrategy.PingPong: {\r\n                if (currentFrame + this._direction >= this.frames.length) {\r\n                    this._direction = -1;\r\n                    this.events.emit('loop', this);\r\n                }\r\n                if (currentFrame + this._direction < 0) {\r\n                    this._direction = 1;\r\n                    this.events.emit('loop', this);\r\n                }\r\n                next = currentFrame + (this._direction % this.frames.length);\r\n                break;\r\n            }\r\n        }\r\n        return next;\r\n    }\r\n    /**\r\n     * Called internally by Excalibur to update the state of the animation potential update the current frame\r\n     * @param elapsedMilliseconds Milliseconds elapsed\r\n     * @param idempotencyToken Prevents double ticking in a frame by passing a unique token to the frame\r\n     */\r\n    tick(elapsedMilliseconds, idempotencyToken = 0) {\r\n        if (this._idempotencyToken === idempotencyToken) {\r\n            return;\r\n        }\r\n        this._idempotencyToken = idempotencyToken;\r\n        if (!this._playing) {\r\n            return;\r\n        }\r\n        // if it's the first frame emit frame event\r\n        if (this._firstTick) {\r\n            this._firstTick = false;\r\n            this.events.emit('frame', this.currentFrame);\r\n        }\r\n        this._timeLeftInFrame -= elapsedMilliseconds * this.timeScale;\r\n        if (this._timeLeftInFrame <= 0) {\r\n            this.goToFrame(this._nextFrame());\r\n        }\r\n    }\r\n    _drawImage(ctx, x, y) {\r\n        if (this.currentFrame) {\r\n            this.currentFrame.graphic.draw(ctx, x, y);\r\n        }\r\n    }\r\n}\r\nAnimation._LOGGER = Logger.getInstance();\r\n\n;// CONCATENATED MODULE: ./Graphics/GraphicsGroup.ts\n\r\n\r\n\r\nclass GraphicsGroup extends Graphic {\r\n    constructor(options) {\r\n        super(options);\r\n        this.members = [];\r\n        this.members = options.members;\r\n        this._updateDimensions();\r\n    }\r\n    clone() {\r\n        return new GraphicsGroup({\r\n            members: [...this.members],\r\n            ...this.cloneGraphicOptions()\r\n        });\r\n    }\r\n    _updateDimensions() {\r\n        let bb = new BoundingBox();\r\n        for (const { graphic, pos } of this.members) {\r\n            bb = graphic.localBounds.translate(pos).combine(bb);\r\n        }\r\n        this.width = bb.width;\r\n        this.height = bb.height;\r\n        return bb;\r\n    }\r\n    get localBounds() {\r\n        let bb = new BoundingBox();\r\n        for (const { graphic, pos } of this.members) {\r\n            bb = graphic.localBounds.translate(pos).combine(bb);\r\n        }\r\n        return bb;\r\n    }\r\n    _isAnimationOrGroup(graphic) {\r\n        return graphic instanceof Animation || graphic instanceof GraphicsGroup;\r\n    }\r\n    tick(elapsedMilliseconds, idempotencyToken) {\r\n        for (const member of this.members) {\r\n            const maybeAnimation = member.graphic;\r\n            if (this._isAnimationOrGroup(maybeAnimation)) {\r\n                maybeAnimation.tick(elapsedMilliseconds, idempotencyToken);\r\n            }\r\n        }\r\n    }\r\n    reset() {\r\n        for (const member of this.members) {\r\n            const maybeAnimation = member.graphic;\r\n            if (this._isAnimationOrGroup(maybeAnimation)) {\r\n                maybeAnimation.reset();\r\n            }\r\n        }\r\n    }\r\n    _preDraw(ex, x, y) {\r\n        this._updateDimensions();\r\n        super._preDraw(ex, x, y);\r\n    }\r\n    _drawImage(ex, x, y) {\r\n        for (const member of this.members) {\r\n            ex.save();\r\n            ex.translate(x, y);\r\n            member.graphic.draw(ex, member.pos.x, member.pos.y);\r\n            if (this.showDebug) {\r\n                /* istanbul ignore next */\r\n                ex.debug.drawRect(0, 0, this.width, this.height);\r\n            }\r\n            ex.restore();\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Particles.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * An enum that represents the types of emitter nozzles\r\n */\r\nvar EmitterType;\r\n(function (EmitterType) {\r\n    /**\r\n     * Constant for the circular emitter type\r\n     */\r\n    EmitterType[EmitterType[\"Circle\"] = 0] = \"Circle\";\r\n    /**\r\n     * Constant for the rectangular emitter type\r\n     */\r\n    EmitterType[EmitterType[\"Rectangle\"] = 1] = \"Rectangle\";\r\n})(EmitterType || (EmitterType = {}));\r\n/**\r\n * @hidden\r\n */\r\nclass ParticleImpl extends Entity {\r\n    constructor(emitterOrConfig, life, opacity, beginColor, endColor, position, velocity, acceleration, startSize, endSize) {\r\n        super();\r\n        this.position = new Vector(0, 0);\r\n        this.velocity = new Vector(0, 0);\r\n        this.acceleration = new Vector(0, 0);\r\n        this.particleRotationalVelocity = 0;\r\n        this.currentRotation = 0;\r\n        this.focus = null;\r\n        this.focusAccel = 0;\r\n        this.opacity = 1;\r\n        this.beginColor = Color.White;\r\n        this.endColor = Color.White;\r\n        // Life is counted in ms\r\n        this.life = 300;\r\n        this.fadeFlag = false;\r\n        // Color transitions\r\n        this._rRate = 1;\r\n        this._gRate = 1;\r\n        this._bRate = 1;\r\n        this._aRate = 0;\r\n        this._currentColor = Color.White;\r\n        this.emitter = null;\r\n        this.particleSize = 5;\r\n        this.particleSprite = null;\r\n        this.sizeRate = 0;\r\n        this.elapsedMultiplier = 0;\r\n        this.visible = true;\r\n        this.isOffscreen = false;\r\n        let emitter = emitterOrConfig;\r\n        if (emitter && !(emitterOrConfig instanceof ParticleEmitter)) {\r\n            const config = emitterOrConfig;\r\n            emitter = config.emitter;\r\n            life = config.life;\r\n            opacity = config.opacity;\r\n            endColor = config.endColor;\r\n            beginColor = config.beginColor;\r\n            position = config.position;\r\n            velocity = config.velocity;\r\n            acceleration = config.acceleration;\r\n            startSize = config.startSize;\r\n            endSize = config.endSize;\r\n        }\r\n        this.emitter = emitter;\r\n        this.life = life || this.life;\r\n        this.opacity = opacity || this.opacity;\r\n        this.endColor = endColor || this.endColor.clone();\r\n        this.beginColor = beginColor || this.beginColor.clone();\r\n        this._currentColor = this.beginColor.clone();\r\n        this.position = (position || this.position).add(this.emitter.pos);\r\n        this.velocity = velocity || this.velocity;\r\n        this.acceleration = acceleration || this.acceleration;\r\n        this._rRate = (this.endColor.r - this.beginColor.r) / this.life;\r\n        this._gRate = (this.endColor.g - this.beginColor.g) / this.life;\r\n        this._bRate = (this.endColor.b - this.beginColor.b) / this.life;\r\n        this._aRate = this.opacity / this.life;\r\n        this.startSize = startSize || 0;\r\n        this.endSize = endSize || 0;\r\n        if (this.endSize > 0 && this.startSize > 0) {\r\n            this.sizeRate = (this.endSize - this.startSize) / this.life;\r\n            this.particleSize = this.startSize;\r\n        }\r\n        this.addComponent((this.transform = new TransformComponent()));\r\n        this.addComponent(new CanvasDrawComponent((ctx) => this.draw(ctx)));\r\n        this.addComponent((this.graphics = new GraphicsComponent()));\r\n        this.transform.pos = this.position;\r\n        this.transform.rotation = this.currentRotation;\r\n        this.transform.scale = vec(1, 1); // TODO wut\r\n        if (this.particleSprite) {\r\n            this.graphics.opacity = this.opacity;\r\n            this.graphics.use(Sprite.fromLegacySprite(this.particleSprite));\r\n        }\r\n        else {\r\n            this.graphics.onPostDraw = (ctx) => {\r\n                ctx.save();\r\n                this.graphics.opacity = this.opacity;\r\n                const tmpColor = this._currentColor.clone();\r\n                tmpColor.a = 1;\r\n                ctx.debug.drawPoint(vec(0, 0), { color: tmpColor, size: this.particleSize });\r\n                ctx.restore();\r\n            };\r\n        }\r\n    }\r\n    kill() {\r\n        this.emitter.removeParticle(this);\r\n    }\r\n    update(_engine, delta) {\r\n        this.life = this.life - delta;\r\n        this.elapsedMultiplier = this.elapsedMultiplier + delta;\r\n        if (this.life < 0) {\r\n            this.kill();\r\n        }\r\n        if (this.fadeFlag) {\r\n            this.opacity = clamp(this._aRate * this.life, 0.0001, 1);\r\n        }\r\n        if (this.startSize > 0 && this.endSize > 0) {\r\n            this.particleSize = clamp(this.sizeRate * delta + this.particleSize, Math.min(this.startSize, this.endSize), Math.max(this.startSize, this.endSize));\r\n        }\r\n        this._currentColor.r = clamp(this._currentColor.r + this._rRate * delta, 0, 255);\r\n        this._currentColor.g = clamp(this._currentColor.g + this._gRate * delta, 0, 255);\r\n        this._currentColor.b = clamp(this._currentColor.b + this._bRate * delta, 0, 255);\r\n        this._currentColor.a = clamp(this.opacity, 0.0001, 1);\r\n        if (this.focus) {\r\n            const accel = this.focus\r\n                .sub(this.position)\r\n                .normalize()\r\n                .scale(this.focusAccel)\r\n                .scale(delta / 1000);\r\n            this.velocity = this.velocity.add(accel);\r\n        }\r\n        else {\r\n            this.velocity = this.velocity.add(this.acceleration.scale(delta / 1000));\r\n        }\r\n        this.position = this.position.add(this.velocity.scale(delta / 1000));\r\n        if (this.particleRotationalVelocity) {\r\n            this.currentRotation = (this.currentRotation + (this.particleRotationalVelocity * delta) / 1000) % (2 * Math.PI);\r\n        }\r\n        this.transform.pos = this.position;\r\n        this.transform.rotation = this.currentRotation;\r\n        this.transform.scale = vec(1, 1); // todo wut\r\n        this.graphics.opacity = this.opacity;\r\n    }\r\n    /**\r\n     * @deprecated signature will change in v0.26.0\r\n     * @param ctx\r\n     */\r\n    draw(ctx) {\r\n        if (this.particleSprite) {\r\n            this.particleSprite.opacity(this.opacity);\r\n            this.particleSprite.draw(ctx, 0, 0);\r\n            return;\r\n        }\r\n        ctx.save();\r\n        this._currentColor.a = clamp(this.opacity, 0.0001, 1);\r\n        ctx.fillStyle = this._currentColor.toString();\r\n        ctx.beginPath();\r\n        ctx.arc(0, 0, this.particleSize, 0, Math.PI * 2);\r\n        ctx.fill();\r\n        ctx.closePath();\r\n        ctx.restore();\r\n    }\r\n}\r\n/**\r\n * Particle is used in a [[ParticleEmitter]]\r\n */\r\nclass Particle extends Configurable(ParticleImpl) {\r\n    constructor(emitterOrConfig, life, opacity, beginColor, endColor, position, velocity, acceleration, startSize, endSize) {\r\n        super(emitterOrConfig, life, opacity, beginColor, endColor, position, velocity, acceleration, startSize, endSize);\r\n    }\r\n}\r\n/**\r\n * Using a particle emitter is a great way to create interesting effects\r\n * in your game, like smoke, fire, water, explosions, etc. `ParticleEmitter`\r\n * extend [[Actor]] allowing you to use all of the features that come with.\r\n */\r\nclass ParticleEmitter extends Actor {\r\n    /**\r\n     * @param config particle emitter options bag\r\n     */\r\n    constructor(config) {\r\n        var _a, _b;\r\n        super({ width: (_a = config.width) !== null && _a !== void 0 ? _a : 0, height: (_b = config.height) !== null && _b !== void 0 ? _b : 0 });\r\n        this._particlesToEmit = 0;\r\n        this.numParticles = 0;\r\n        /**\r\n         * Gets or sets the isEmitting flag\r\n         */\r\n        this.isEmitting = true;\r\n        /**\r\n         * Gets or sets the backing particle collection\r\n         */\r\n        this.particles = [];\r\n        /**\r\n         * Gets or sets the backing deadParticle collection\r\n         */\r\n        this.deadParticles = [];\r\n        /**\r\n         * Gets or sets the minimum particle velocity\r\n         */\r\n        this.minVel = 0;\r\n        /**\r\n         * Gets or sets the maximum particle velocity\r\n         */\r\n        this.maxVel = 0;\r\n        /**\r\n         * Gets or sets the acceleration vector for all particles\r\n         */\r\n        this.acceleration = new Vector(0, 0);\r\n        /**\r\n         * Gets or sets the minimum angle in radians\r\n         */\r\n        this.minAngle = 0;\r\n        /**\r\n         * Gets or sets the maximum angle in radians\r\n         */\r\n        this.maxAngle = 0;\r\n        /**\r\n         * Gets or sets the emission rate for particles (particles/sec)\r\n         */\r\n        this.emitRate = 1; //particles/sec\r\n        /**\r\n         * Gets or sets the life of each particle in milliseconds\r\n         */\r\n        this.particleLife = 2000;\r\n        /**\r\n         * Gets or sets the fade flag which causes particles to gradually fade out over the course of their life.\r\n         */\r\n        this.fadeFlag = false;\r\n        /**\r\n         * Gets or sets the optional focus where all particles should accelerate towards\r\n         */\r\n        this.focus = null;\r\n        /**\r\n         * Gets or sets the acceleration for focusing particles if a focus has been specified\r\n         */\r\n        this.focusAccel = null;\r\n        /**\r\n         * Gets or sets the optional starting size for the particles\r\n         */\r\n        this.startSize = null;\r\n        /**\r\n         * Gets or sets the optional ending size for the particles\r\n         */\r\n        this.endSize = null;\r\n        /**\r\n         * Gets or sets the minimum size of all particles\r\n         */\r\n        this.minSize = 5;\r\n        /**\r\n         * Gets or sets the maximum size of all particles\r\n         */\r\n        this.maxSize = 5;\r\n        /**\r\n         * Gets or sets the beginning color of all particles\r\n         */\r\n        this.beginColor = Color.White;\r\n        /**\r\n         * Gets or sets the ending color of all particles\r\n         */\r\n        this.endColor = Color.White;\r\n        this._og = null;\r\n        this._sprite = null;\r\n        /**\r\n         * Gets or sets the emitter type for the particle emitter\r\n         */\r\n        this.emitterType = EmitterType.Rectangle;\r\n        /**\r\n         * Gets or sets the emitter radius, only takes effect when the [[emitterType]] is [[EmitterType.Circle]]\r\n         */\r\n        this.radius = 0;\r\n        /**\r\n         * Gets or sets the particle rotational speed velocity\r\n         */\r\n        this.particleRotationalVelocity = 0;\r\n        /**\r\n         * Indicates whether particles should start with a random rotation\r\n         */\r\n        this.randomRotation = false;\r\n        const { x, y, pos, isEmitting, minVel, maxVel, acceleration, minAngle, maxAngle, emitRate, particleLife, opacity, fadeFlag, focus, focusAccel, startSize, endSize, minSize, maxSize, beginColor, endColor, particleSprite, emitterType, radius, particleRotationalVelocity, randomRotation, random } = { ...config };\r\n        this.pos = pos !== null && pos !== void 0 ? pos : vec(x !== null && x !== void 0 ? x : 0, y !== null && y !== void 0 ? y : 0);\r\n        this.isEmitting = isEmitting !== null && isEmitting !== void 0 ? isEmitting : this.isEmitting;\r\n        this.minVel = minVel !== null && minVel !== void 0 ? minVel : this.minVel;\r\n        this.maxVel = maxVel !== null && maxVel !== void 0 ? maxVel : this.maxVel;\r\n        this.acceleration = acceleration !== null && acceleration !== void 0 ? acceleration : this.acceleration;\r\n        this.minAngle = minAngle !== null && minAngle !== void 0 ? minAngle : this.minAngle;\r\n        this.maxAngle = maxAngle !== null && maxAngle !== void 0 ? maxAngle : this.maxAngle;\r\n        this.emitRate = emitRate !== null && emitRate !== void 0 ? emitRate : this.emitRate;\r\n        this.particleLife = particleLife !== null && particleLife !== void 0 ? particleLife : this.particleLife;\r\n        this.opacity = opacity !== null && opacity !== void 0 ? opacity : this.opacity;\r\n        this.fadeFlag = fadeFlag !== null && fadeFlag !== void 0 ? fadeFlag : this.fadeFlag;\r\n        this.focus = focus !== null && focus !== void 0 ? focus : this.focus;\r\n        this.focusAccel = focusAccel !== null && focusAccel !== void 0 ? focusAccel : this.focusAccel;\r\n        this.startSize = startSize !== null && startSize !== void 0 ? startSize : this.startSize;\r\n        this.endSize = endSize !== null && endSize !== void 0 ? endSize : this.endSize;\r\n        this.minSize = minSize !== null && minSize !== void 0 ? minSize : this.minSize;\r\n        this.maxSize = maxSize !== null && maxSize !== void 0 ? maxSize : this.maxSize;\r\n        this.beginColor = beginColor !== null && beginColor !== void 0 ? beginColor : this.beginColor;\r\n        this.endColor = endColor !== null && endColor !== void 0 ? endColor : this.endColor;\r\n        this.particleSprite = particleSprite !== null && particleSprite !== void 0 ? particleSprite : this.particleSprite;\r\n        this.emitterType = emitterType !== null && emitterType !== void 0 ? emitterType : this.emitterType;\r\n        this.radius = radius !== null && radius !== void 0 ? radius : this.radius;\r\n        this.particleRotationalVelocity = particleRotationalVelocity !== null && particleRotationalVelocity !== void 0 ? particleRotationalVelocity : this.particleRotationalVelocity;\r\n        this.randomRotation = randomRotation !== null && randomRotation !== void 0 ? randomRotation : this.randomRotation;\r\n        this.body.collisionType = CollisionType.PreventCollision;\r\n        this.random = random !== null && random !== void 0 ? random : new Random();\r\n        // Remove offscreen culling from particle emitters\r\n        for (let i = 0; i < this.traits.length; i++) {\r\n            if (this.traits[i] instanceof OffscreenCulling) {\r\n                this.traits.splice(i, 1);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Gets the opacity of each particle from 0 to 1.0\r\n     */\r\n    get opacity() {\r\n        return super.graphics.opacity;\r\n    }\r\n    /**\r\n     * Gets the opacity of each particle from 0 to 1.0\r\n     */\r\n    set opacity(opacity) {\r\n        super.graphics.opacity = opacity;\r\n    }\r\n    /**\r\n     * Gets or sets the sprite that a particle should use\r\n     */\r\n    get particleSprite() {\r\n        return this._og;\r\n    }\r\n    set particleSprite(val) {\r\n        this._og = val;\r\n        if (val) {\r\n            this._sprite = Sprite.fromLegacySprite(val);\r\n        }\r\n    }\r\n    removeParticle(particle) {\r\n        this.deadParticles.push(particle);\r\n    }\r\n    /**\r\n     * Causes the emitter to emit particles\r\n     * @param particleCount  Number of particles to emit right now\r\n     */\r\n    emitParticles(particleCount) {\r\n        var _a;\r\n        for (let i = 0; i < particleCount; i++) {\r\n            const p = this._createParticle();\r\n            this.particles.push(p);\r\n            if ((_a = this === null || this === void 0 ? void 0 : this.scene) === null || _a === void 0 ? void 0 : _a.world) {\r\n                this.scene.world.add(p);\r\n            }\r\n        }\r\n    }\r\n    clearParticles() {\r\n        this.particles.length = 0;\r\n    }\r\n    // Creates a new particle given the constraints of the emitter\r\n    _createParticle() {\r\n        // todo implement emitter constraints;\r\n        let ranX = 0;\r\n        let ranY = 0;\r\n        const angle = randomInRange(this.minAngle, this.maxAngle, this.random);\r\n        const vel = randomInRange(this.minVel, this.maxVel, this.random);\r\n        const size = this.startSize || randomInRange(this.minSize, this.maxSize, this.random);\r\n        const dx = vel * Math.cos(angle);\r\n        const dy = vel * Math.sin(angle);\r\n        if (this.emitterType === EmitterType.Rectangle) {\r\n            ranX = randomInRange(0, this.width, this.random);\r\n            ranY = randomInRange(0, this.height, this.random);\r\n        }\r\n        else if (this.emitterType === EmitterType.Circle) {\r\n            const radius = randomInRange(0, this.radius, this.random);\r\n            ranX = radius * Math.cos(angle);\r\n            ranY = radius * Math.sin(angle);\r\n        }\r\n        const p = new Particle(this, this.particleLife, this.opacity, this.beginColor, this.endColor, new Vector(ranX, ranY), new Vector(dx, dy), this.acceleration, this.startSize, this.endSize);\r\n        p.fadeFlag = this.fadeFlag;\r\n        p.particleSize = size;\r\n        if (this.particleSprite) {\r\n            p.particleSprite = this.particleSprite;\r\n            p.graphics.opacity = this.opacity;\r\n            p.graphics.use(this._sprite);\r\n        }\r\n        p.particleRotationalVelocity = this.particleRotationalVelocity;\r\n        if (this.randomRotation) {\r\n            p.currentRotation = randomInRange(0, Math.PI * 2, this.random);\r\n        }\r\n        if (this.focus) {\r\n            p.focus = this.focus.add(new Vector(this.pos.x, this.pos.y));\r\n            p.focusAccel = this.focusAccel;\r\n        }\r\n        return p;\r\n    }\r\n    update(engine, delta) {\r\n        var _a;\r\n        super.update(engine, delta);\r\n        if (this.isEmitting) {\r\n            this._particlesToEmit += this.emitRate * (delta / 1000);\r\n            if (this._particlesToEmit > 1.0) {\r\n                this.emitParticles(Math.floor(this._particlesToEmit));\r\n                this._particlesToEmit = this._particlesToEmit - Math.floor(this._particlesToEmit);\r\n            }\r\n        }\r\n        // deferred removal\r\n        for (let i = 0; i < this.deadParticles.length; i++) {\r\n            removeItemFromArray(this.deadParticles[i], this.particles);\r\n            if ((_a = this === null || this === void 0 ? void 0 : this.scene) === null || _a === void 0 ? void 0 : _a.world) {\r\n                this.scene.world.remove(this.deadParticles[i], false);\r\n            }\r\n        }\r\n        this.deadParticles.length = 0;\r\n    }\r\n    /**\r\n     * @deprecated signature will change in v0.26.0\r\n     * @param ctx\r\n     */\r\n    draw(ctx) {\r\n        // todo is there a more efficient to draw\r\n        // possibly use a webgl offscreen canvas and shaders to do particles?\r\n        this.particles.forEach((p) => p.draw(ctx));\r\n    }\r\n    /**\r\n     * @deprecated signature will change in v0.26.0\r\n     * @param ctx\r\n     */\r\n    debugDraw(ctx) {\r\n        super.debugDraw(ctx);\r\n        ctx.fillStyle = Color.Black.toString();\r\n        ctx.fillText('Particles: ' + this.particles.length, this.pos.x, this.pos.y + 20);\r\n        if (this.focus) {\r\n            ctx.fillRect(this.focus.x + this.pos.x, this.focus.y + this.pos.y, 3, 3);\r\n            line(ctx, Color.Yellow, this.focus.x + this.pos.x, this.focus.y + this.pos.y, this.center.x, this.center.y);\r\n            ctx.fillText('Focus', this.focus.x + this.pos.x, this.focus.y + this.pos.y);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/GraphicsSystem.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass GraphicsSystem extends System {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.types = ['ex.transform', 'ex.graphics'];\r\n        this.systemType = SystemType.Draw;\r\n        this.priority = 0;\r\n        this._token = 0;\r\n    }\r\n    initialize(scene) {\r\n        this._graphicsContext = scene.engine.graphicsContext;\r\n        this._camera = scene.camera;\r\n        this._engine = scene.engine;\r\n    }\r\n    sort(a, b) {\r\n        return a.get(TransformComponent).z - b.get(TransformComponent).z;\r\n    }\r\n    update(entities, delta) {\r\n        this._token++;\r\n        let transform;\r\n        let graphics;\r\n        for (const entity of entities) {\r\n            transform = entity.get(TransformComponent);\r\n            graphics = entity.get(GraphicsComponent);\r\n            // Figure out if entities are offscreen\r\n            const entityOffscreen = this._isOffscreen(transform, graphics);\r\n            if (entityOffscreen && !entity.hasTag('offscreen')) {\r\n                entity.eventDispatcher.emit('exitviewport', new ExitViewPortEvent(entity));\r\n                entity.addComponent(new TagComponent('offscreen'));\r\n            }\r\n            if (!entityOffscreen && entity.hasTag('offscreen')) {\r\n                entity.eventDispatcher.emit('enterviewport', new EnterViewPortEvent(entity));\r\n                entity.removeComponent('offscreen');\r\n            }\r\n            // Skip entities that have graphics offscreen\r\n            if (entityOffscreen) {\r\n                continue;\r\n            }\r\n            // This optionally sets our camera based on the entity coord plan (world vs. screen)\r\n            this._pushCameraTransform(transform);\r\n            this._graphicsContext.save();\r\n            // Tick any graphics state (but only once) for animations and graphics groups\r\n            graphics.update(delta, this._token);\r\n            // Position the entity\r\n            this._applyTransform(entity);\r\n            // Optionally run the onPreDraw graphics lifecycle draw\r\n            if (graphics.onPreDraw) {\r\n                graphics.onPreDraw(this._graphicsContext, delta);\r\n            }\r\n            // TODO remove this hack on the particle redo\r\n            const particleOpacity = (entity instanceof Particle) ? entity.opacity : 1;\r\n            this._graphicsContext.opacity = graphics.opacity * particleOpacity;\r\n            // Draw the graphics component\r\n            this._drawGraphicsComponent(graphics);\r\n            // Optionally run the onPostDraw graphics lifecycle draw\r\n            if (graphics.onPostDraw) {\r\n                graphics.onPostDraw(this._graphicsContext, delta);\r\n            }\r\n            this._graphicsContext.restore();\r\n            // Reset the transform back to the original\r\n            this._popCameraTransform(transform);\r\n        }\r\n    }\r\n    _isOffscreen(transform, graphics) {\r\n        if (transform.coordPlane === CoordPlane.World) {\r\n            const graphicsOffscreen = !this._camera.viewport.intersect(graphics.localBounds.transform(transform.getGlobalMatrix()));\r\n            return graphicsOffscreen;\r\n        }\r\n        else {\r\n            // TODO screen coordinates\r\n            return false;\r\n        }\r\n    }\r\n    _drawGraphicsComponent(graphicsComponent) {\r\n        var _a, _b;\r\n        if (graphicsComponent.visible) {\r\n            // this should be moved to the graphics system\r\n            for (const layer of graphicsComponent.layers.get()) {\r\n                for (const { graphic, options } of layer.graphics) {\r\n                    let anchor = graphicsComponent.anchor;\r\n                    let offset = graphicsComponent.offset;\r\n                    if (options === null || options === void 0 ? void 0 : options.anchor) {\r\n                        anchor = options.anchor;\r\n                    }\r\n                    if (options === null || options === void 0 ? void 0 : options.offset) {\r\n                        offset = options.offset;\r\n                    }\r\n                    // See https://github.com/excaliburjs/Excalibur/pull/619 for discussion on this formula\r\n                    const offsetX = -graphic.width * anchor.x + offset.x;\r\n                    const offsetY = -graphic.height * anchor.y + offset.y;\r\n                    graphic === null || graphic === void 0 ? void 0 : graphic.draw(this._graphicsContext, offsetX + layer.offset.x, offsetY + layer.offset.y);\r\n                    if (((_a = this._engine) === null || _a === void 0 ? void 0 : _a.isDebug) && this._engine.debug.graphics.showBounds) {\r\n                        const offset = vec(offsetX + layer.offset.x, offsetY + layer.offset.y);\r\n                        if (graphic instanceof GraphicsGroup) {\r\n                            for (const g of graphic.members) {\r\n                                (_b = g.graphic) === null || _b === void 0 ? void 0 : _b.localBounds.translate(offset.add(g.pos)).draw(this._graphicsContext, this._engine.debug.graphics.boundsColor);\r\n                            }\r\n                        }\r\n                        else {\r\n                            /* istanbul ignore next */\r\n                            graphic === null || graphic === void 0 ? void 0 : graphic.localBounds.translate(offset).draw(this._graphicsContext, this._engine.debug.graphics.boundsColor);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * This applies the current entity transform to the graphics context\r\n     * @param entity\r\n     */\r\n    _applyTransform(entity) {\r\n        const ancestors = entity.getAncestors();\r\n        for (const ancestor of ancestors) {\r\n            const transform = ancestor === null || ancestor === void 0 ? void 0 : ancestor.get(TransformComponent);\r\n            if (transform) {\r\n                this._graphicsContext.translate(transform.pos.x, transform.pos.y);\r\n                this._graphicsContext.scale(transform.scale.x, transform.scale.y);\r\n                this._graphicsContext.rotate(transform.rotation);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Applies the current camera transform if in world coordinates\r\n     * @param transform\r\n     */\r\n    _pushCameraTransform(transform) {\r\n        // Establish camera offset per entity\r\n        if (transform.coordPlane === CoordPlane.World) {\r\n            this._graphicsContext.save();\r\n            if (this._camera) {\r\n                this._camera.draw(this._graphicsContext);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Resets the current camera transform if in world coordinates\r\n     * @param transform\r\n     */\r\n    _popCameraTransform(transform) {\r\n        if (transform.coordPlane === CoordPlane.World) {\r\n            // Apply camera world offset\r\n            this._graphicsContext.restore();\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Drawing/CanvasDrawingSystem.ts\n\r\n\r\n\r\n\r\n/**\r\n * Draws anything with a transform and a \"draw\" method\r\n * @deprecated Shim for canvas drawing, will be removed v0.26.0\r\n */\r\nclass CanvasDrawingSystem extends System {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.types = ['ex.transform', 'ex.canvas'];\r\n        this.systemType = SystemType.Draw;\r\n        this.priority = -1;\r\n    }\r\n    initialize(scene) {\r\n        this._ctx = scene.engine.ctx;\r\n        this._engine = scene.engine;\r\n        this._camera = scene.camera;\r\n    }\r\n    sort(a, b) {\r\n        return a.get(TransformComponent).z - b.get(TransformComponent).z;\r\n    }\r\n    update(entities, delta) {\r\n        var _a, _b, _c;\r\n        this._clearScreen();\r\n        let transform;\r\n        let canvasdraw;\r\n        const length = entities.length;\r\n        for (let i = 0; i < length; i++) {\r\n            const visible = (_c = (_b = (_a = entities[i]) === null || _a === void 0 ? void 0 : _a.graphics) === null || _b === void 0 ? void 0 : _b.visible) !== null && _c !== void 0 ? _c : true;\r\n            const offscreen = entities[i].isOffScreen;\r\n            if (visible && !offscreen) {\r\n                transform = entities[i].get(TransformComponent);\r\n                canvasdraw = entities[i].get(CanvasDrawComponent);\r\n                this._ctx.save();\r\n                this._pushCameraTransform(transform);\r\n                this._ctx.save();\r\n                this._applyTransform(entities[i]);\r\n                canvasdraw.draw(this._ctx, delta);\r\n                this._ctx.restore();\r\n                this._popCameraTransform(transform);\r\n                this._ctx.restore();\r\n            }\r\n            if (this._engine.isDebug) {\r\n                this._ctx.save();\r\n                this._pushCameraTransform(transform);\r\n                this._ctx.strokeStyle = 'yellow';\r\n                entities[i].debugDraw(this._ctx);\r\n                this._popCameraTransform(transform);\r\n                this._ctx.restore();\r\n            }\r\n        }\r\n        if (this._engine.isDebug) {\r\n            this._ctx.save();\r\n            this._camera.draw(this._ctx);\r\n            this._camera.debugDraw(this._ctx);\r\n            this._ctx.restore();\r\n        }\r\n        this._engine.stats.currFrame.graphics.drawnImages = GraphicsDiagnostics.DrawnImagesCount;\r\n        this._engine.stats.currFrame.graphics.drawCalls = GraphicsDiagnostics.DrawCallCount;\r\n    }\r\n    _applyTransform(entity) {\r\n        const ancestors = entity.getAncestors();\r\n        for (const ancestor of ancestors) {\r\n            const transform = ancestor === null || ancestor === void 0 ? void 0 : ancestor.get(TransformComponent);\r\n            if (transform) {\r\n                this._ctx.translate(transform.pos.x, transform.pos.y);\r\n                this._ctx.rotate(transform.rotation);\r\n                this._ctx.scale(transform.scale.x, transform.scale.y);\r\n            }\r\n        }\r\n    }\r\n    _clearScreen() {\r\n        this._ctx.clearRect(0, 0, this._ctx.canvas.width, this._ctx.canvas.height);\r\n        this._ctx.fillStyle = this._engine.backgroundColor.toString();\r\n        this._ctx.fillRect(0, 0, this._ctx.canvas.width, this._ctx.canvas.height);\r\n    }\r\n    _pushCameraTransform(transform) {\r\n        if (transform.coordPlane === CoordPlane.World) {\r\n            // Apply camera transform to place entity in world space\r\n            this._ctx.save();\r\n            if (this._camera) {\r\n                this._camera.draw(this._ctx);\r\n            }\r\n        }\r\n    }\r\n    _popCameraTransform(transform) {\r\n        if (transform.coordPlane === CoordPlane.World) {\r\n            // Restore back to screen space from world space if we were drawing an entity there\r\n            this._ctx.restore();\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Debug/DebugSystem.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass DebugSystem extends System {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.types = ['ex.transform'];\r\n        this.systemType = SystemType.Draw;\r\n        this.priority = 999; // lowest priority\r\n    }\r\n    initialize(scene) {\r\n        this._graphicsContext = scene.engine.graphicsContext;\r\n        this._camera = scene.camera;\r\n        this._engine = scene.engine;\r\n        this._collisionSystem = scene.world.systemManager.get(CollisionSystem);\r\n    }\r\n    update(entities, _delta) {\r\n        var _a, _b;\r\n        if (!this._engine.isDebug) {\r\n            return;\r\n        }\r\n        const filterSettings = this._engine.debug.filter;\r\n        let id;\r\n        let name;\r\n        const entitySettings = this._engine.debug.entity;\r\n        let tx;\r\n        const txSettings = this._engine.debug.transform;\r\n        let motion;\r\n        const motionSettings = this._engine.debug.motion;\r\n        let colliderComp;\r\n        const colliderSettings = this._engine.debug.collider;\r\n        const physicsSettings = this._engine.debug.physics;\r\n        let graphics;\r\n        const graphicsSettings = this._engine.debug.graphics;\r\n        let debugDraw;\r\n        let body;\r\n        const bodySettings = this._engine.debug.body;\r\n        const cameraSettings = this._engine.debug.camera;\r\n        for (const entity of entities) {\r\n            if (entity.hasTag('offscreen')) {\r\n                // skip offscreen entities\r\n                continue;\r\n            }\r\n            if (entity instanceof Particle) {\r\n                // Particles crush the renderer :(\r\n                continue;\r\n            }\r\n            if (filterSettings.useFilter) {\r\n                const allIds = filterSettings.ids.length === 0;\r\n                const idMatch = allIds || filterSettings.ids.includes(entity.id);\r\n                if (!idMatch) {\r\n                    continue;\r\n                }\r\n                const allNames = filterSettings.nameQuery === '';\r\n                const nameMatch = allNames || entity.name.includes(filterSettings.nameQuery);\r\n                if (!nameMatch) {\r\n                    continue;\r\n                }\r\n            }\r\n            let cursor = Vector.Zero;\r\n            const lineHeight = vec(0, 16);\r\n            id = entity.id;\r\n            name = entity.name;\r\n            tx = entity.get(TransformComponent);\r\n            // This optionally sets our camera based on the entity coord plan (world vs. screen)\r\n            this._pushCameraTransform(tx);\r\n            this._graphicsContext.save();\r\n            this._applyTransform(entity);\r\n            if (tx) {\r\n                if (txSettings.showAll || txSettings.showPosition) {\r\n                    this._graphicsContext.debug.drawPoint(Vector.Zero, { size: 4, color: txSettings.positionColor });\r\n                }\r\n                if (txSettings.showAll || txSettings.showPositionLabel) {\r\n                    this._graphicsContext.debug.drawText(`pos${tx.pos.toString(2)}`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (entitySettings.showAll || entitySettings.showId) {\r\n                    this._graphicsContext.debug.drawText(`id(${id}) ${tx.parent ? 'child of id(' + ((_b = (_a = tx.parent) === null || _a === void 0 ? void 0 : _a.owner) === null || _b === void 0 ? void 0 : _b.id) + ')' : ''}`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (entitySettings.showAll || entitySettings.showName) {\r\n                    this._graphicsContext.debug.drawText(`name(${name})`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (txSettings.showAll || txSettings.showRotation) {\r\n                    this._graphicsContext.drawLine(Vector.Zero, Vector.fromAngle(tx.rotation).scale(50).add(Vector.Zero), txSettings.rotationColor, 2);\r\n                    this._graphicsContext.debug.drawText(`rot deg(${toDegrees(tx.rotation).toFixed(2)})`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (txSettings.showAll || txSettings.showScale) {\r\n                    this._graphicsContext.drawLine(Vector.Zero, tx.scale.add(Vector.Zero), txSettings.scaleColor, 2);\r\n                }\r\n            }\r\n            graphics = entity.get(GraphicsComponent);\r\n            if (graphics) {\r\n                if (graphicsSettings.showAll || graphicsSettings.showBounds) {\r\n                    const bounds = graphics.localBounds;\r\n                    bounds.draw(this._graphicsContext, graphicsSettings.boundsColor);\r\n                }\r\n            }\r\n            debugDraw = entity.get(DebugGraphicsComponent);\r\n            if (debugDraw) {\r\n                debugDraw.draw(this._graphicsContext);\r\n            }\r\n            body = entity.get(BodyComponent);\r\n            if (body) {\r\n                if (bodySettings.showAll || bodySettings.showCollisionGroup) {\r\n                    this._graphicsContext.debug.drawText(`collision group(${body.group.name})`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (bodySettings.showAll || bodySettings.showCollisionType) {\r\n                    this._graphicsContext.debug.drawText(`collision type(${body.collisionType})`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (bodySettings.showAll || bodySettings.showMass) {\r\n                    this._graphicsContext.debug.drawText(`mass(${body.mass})`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (bodySettings.showAll || bodySettings.showMotion) {\r\n                    this._graphicsContext.debug.drawText(`motion(${body.sleepMotion})`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (bodySettings.showAll || bodySettings.showSleeping) {\r\n                    this._graphicsContext.debug.drawText(`sleeping(${body.canSleep ? body.sleeping : 'cant sleep'})`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n            }\r\n            this._graphicsContext.restore();\r\n            motion = entity.get(MotionComponent);\r\n            if (motion) {\r\n                if (motionSettings.showAll || motionSettings.showVelocity) {\r\n                    this._graphicsContext.debug.drawText(`vel${motion.vel.toString(2)}`, cursor.add(tx.globalPos));\r\n                    this._graphicsContext.drawLine(tx.globalPos, tx.globalPos.add(motion.vel), motionSettings.velocityColor, 2);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (motionSettings.showAll || motionSettings.showAcceleration) {\r\n                    this._graphicsContext.drawLine(tx.globalPos, tx.globalPos.add(motion.acc), motionSettings.accelerationColor, 2);\r\n                }\r\n            }\r\n            // Colliders live in world space already so after the restore()\r\n            colliderComp = entity.get(ColliderComponent);\r\n            if (colliderComp) {\r\n                const collider = colliderComp.get();\r\n                if ((colliderSettings.showAll || colliderSettings.showGeometry) && collider) {\r\n                    collider.debug(this._graphicsContext, colliderSettings.geometryColor);\r\n                }\r\n                if (colliderSettings.showAll || colliderSettings.showBounds) {\r\n                    if (collider instanceof CompositeCollider) {\r\n                        const colliders = collider.getColliders();\r\n                        for (const collider of colliders) {\r\n                            const bounds = collider.bounds;\r\n                            const pos = vec(bounds.left, bounds.top);\r\n                            this._graphicsContext.debug.drawRect(pos.x, pos.y, bounds.width, bounds.height, { color: colliderSettings.boundsColor });\r\n                            if (colliderSettings.showAll || colliderSettings.showOwner) {\r\n                                this._graphicsContext.debug.drawText(`owner id(${collider.owner.id})`, pos);\r\n                            }\r\n                        }\r\n                        colliderComp.bounds.draw(this._graphicsContext, colliderSettings.boundsColor);\r\n                    }\r\n                    else if (collider) {\r\n                        const bounds = colliderComp.bounds;\r\n                        const pos = vec(bounds.left, bounds.top);\r\n                        this._graphicsContext.debug.drawRect(pos.x, pos.y, bounds.width, bounds.height, { color: colliderSettings.boundsColor });\r\n                        if (colliderSettings.showAll || colliderSettings.showOwner) {\r\n                            this._graphicsContext.debug.drawText(`owner id(${colliderComp.owner.id})`, pos);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            this._popCameraTransform(tx);\r\n        }\r\n        this._graphicsContext.save();\r\n        this._camera.draw(this._graphicsContext);\r\n        if (physicsSettings.showAll || physicsSettings.showBroadphaseSpacePartitionDebug) {\r\n            this._collisionSystem.debug(this._graphicsContext);\r\n        }\r\n        if (physicsSettings.showAll || physicsSettings.showCollisionContacts || physicsSettings.showCollisionNormals) {\r\n            for (const [_, contact] of this._engine.debug.stats.currFrame.physics.contacts) {\r\n                if (physicsSettings.showAll || physicsSettings.showCollisionContacts) {\r\n                    for (const point of contact.points) {\r\n                        this._graphicsContext.debug.drawPoint(point, { size: 5, color: physicsSettings.collisionContactColor });\r\n                    }\r\n                }\r\n                if (physicsSettings.showAll || physicsSettings.showCollisionNormals) {\r\n                    for (const point of contact.points) {\r\n                        this._graphicsContext.debug.drawLine(point, contact.normal.scale(30).add(point), {\r\n                            color: physicsSettings.collisionNormalColor\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        this._graphicsContext.restore();\r\n        if (cameraSettings) {\r\n            this._graphicsContext.save();\r\n            this._camera.draw(this._graphicsContext);\r\n            if (cameraSettings.showAll || cameraSettings.showFocus) {\r\n                this._graphicsContext.drawCircle(this._camera.pos, 4, cameraSettings.focusColor);\r\n            }\r\n            if (cameraSettings.showAll || cameraSettings.showZoom) {\r\n                this._graphicsContext.debug.drawText(`zoom(${this._camera.zoom})`, this._camera.pos);\r\n            }\r\n            this._graphicsContext.restore();\r\n        }\r\n        this._graphicsContext.flush();\r\n    }\r\n    /**\r\n     * This applies the current entity transform to the graphics context\r\n     * @param entity\r\n     */\r\n    _applyTransform(entity) {\r\n        const ancestors = entity.getAncestors();\r\n        for (const ancestor of ancestors) {\r\n            const transform = ancestor === null || ancestor === void 0 ? void 0 : ancestor.get(TransformComponent);\r\n            if (transform) {\r\n                this._graphicsContext.translate(transform.pos.x, transform.pos.y);\r\n                this._graphicsContext.scale(transform.scale.x, transform.scale.y);\r\n                this._graphicsContext.rotate(transform.rotation);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Applies the current camera transform if in world coordinates\r\n     * @param transform\r\n     */\r\n    _pushCameraTransform(transform) {\r\n        // Establish camera offset per entity\r\n        if (transform.coordPlane === CoordPlane.World) {\r\n            this._graphicsContext.save();\r\n            if (this._camera) {\r\n                this._camera.draw(this._graphicsContext);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Resets the current camera transform if in world coordinates\r\n     * @param transform\r\n     */\r\n    _popCameraTransform(transform) {\r\n        if (transform.coordPlane === CoordPlane.World) {\r\n            // Apply camera world offset\r\n            this._graphicsContext.restore();\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Input/PointerSystem.ts\n\r\n\r\n\r\n\r\n/**\r\n * The PointerSystem is responsible for dispatching pointer events to entities\r\n * that need them.\r\n *\r\n * The PointerSystem can be optionally configured by the [[PointerComponent]], by default Entities use\r\n * the [[Collider]]'s shape for pointer events.\r\n */\r\nclass PointerSystem extends System {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.types = ['ex.transform', 'ex.pointer'];\r\n        this.systemType = SystemType.Update;\r\n        this.priority = -1;\r\n        /**\r\n         * Optionally override component configuration for all entities\r\n         */\r\n        this.overrideUseColliderShape = false;\r\n        /**\r\n         * Optionally override component configuration for all entities\r\n         */\r\n        this.overrideUseGraphicsBounds = false;\r\n        this.lastFrameEntityToPointers = new Map();\r\n        this.currentFrameEntityToPointers = new Map();\r\n    }\r\n    initialize(scene) {\r\n        this._engine = scene.engine;\r\n        this._receiver = this._engine.input.pointers;\r\n    }\r\n    sort(a, b) {\r\n        // Sort from high to low, because things on 'top' receive the pointer events first\r\n        return b.get(TransformComponent).z - a.get(TransformComponent).z;\r\n    }\r\n    entityCurrentlyUnderPointer(entity, pointerId) {\r\n        return this.currentFrameEntityToPointers.has(entity.id) &&\r\n            this.currentFrameEntityToPointers.get(entity.id).includes(pointerId);\r\n    }\r\n    entityWasUnderPointer(entity, pointerId) {\r\n        return this.lastFrameEntityToPointers.has(entity.id) &&\r\n            this.lastFrameEntityToPointers.get(entity.id).includes(pointerId);\r\n    }\r\n    entered(entity, pointerId) {\r\n        return this.entityCurrentlyUnderPointer(entity, pointerId) &&\r\n            !this.lastFrameEntityToPointers.has(entity.id);\r\n    }\r\n    left(entity, pointerId) {\r\n        return !this.currentFrameEntityToPointers.has(entity.id) &&\r\n            this.entityWasUnderPointer(entity, pointerId);\r\n    }\r\n    addPointerToEntity(entity, pointerId) {\r\n        if (!this.currentFrameEntityToPointers.has(entity.id)) {\r\n            this.currentFrameEntityToPointers.set(entity.id, [pointerId]);\r\n            return;\r\n        }\r\n        const pointers = this.currentFrameEntityToPointers.get(entity.id);\r\n        this.currentFrameEntityToPointers.set(entity.id, pointers.concat(pointerId));\r\n    }\r\n    update(entities) {\r\n        // Locate all the pointer/entity mappings\r\n        this._processPointerToEntity(entities);\r\n        // Dispatch pointer events on entities\r\n        this._dispatchEvents(entities);\r\n        // Clear last frame's events\r\n        this._receiver.update();\r\n        this.lastFrameEntityToPointers.clear();\r\n        this.lastFrameEntityToPointers = new Map(this.currentFrameEntityToPointers);\r\n        this.currentFrameEntityToPointers.clear();\r\n        this._receiver.clear();\r\n    }\r\n    _processPointerToEntity(entities) {\r\n        var _a;\r\n        let transform;\r\n        let collider;\r\n        let graphics;\r\n        let pointer;\r\n        // TODO probably a spatial partition optimization here to quickly query bounds for pointer\r\n        // doesn't seem to cause issues tho for perf\r\n        // Pre-process find entities under pointers\r\n        for (const entity of entities) {\r\n            transform = entity.get(TransformComponent);\r\n            pointer = (_a = entity.get(PointerComponent)) !== null && _a !== void 0 ? _a : new PointerComponent;\r\n            // Check collider contains pointer\r\n            collider = entity.get(ColliderComponent);\r\n            if (collider && (pointer.useColliderShape || this.overrideUseColliderShape)) {\r\n                const geom = collider.get();\r\n                if (geom) {\r\n                    for (const [pointerId, pos] of this._receiver.currentFramePointerCoords.entries()) {\r\n                        if (geom.contains(transform.coordPlane === CoordPlane.World ? pos.worldPos : pos.screenPos)) {\r\n                            this.addPointerToEntity(entity, pointerId);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            // Check graphics contains pointer\r\n            graphics = entity.get(GraphicsComponent);\r\n            if (graphics && (pointer.useGraphicsBounds || this.overrideUseGraphicsBounds)) {\r\n                const graphicBounds = graphics.localBounds.transform(transform.getGlobalMatrix());\r\n                for (const [pointerId, pos] of this._receiver.currentFramePointerCoords.entries()) {\r\n                    if (graphicBounds.contains(transform.coordPlane === CoordPlane.World ? pos.worldPos : pos.screenPos)) {\r\n                        this.addPointerToEntity(entity, pointerId);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    _processDownAndEmit(entity) {\r\n        const lastDownPerPointer = new Map();\r\n        // Loop through down and dispatch to entities\r\n        for (const event of this._receiver.currentFrameDown) {\r\n            if (event.active && entity.active && this.entityCurrentlyUnderPointer(entity, event.pointerId)) {\r\n                entity.events.emit('pointerdown', event);\r\n                if (this._receiver.isDragStart(event.pointerId)) {\r\n                    entity.events.emit('pointerdragstart', event);\r\n                }\r\n            }\r\n            lastDownPerPointer.set(event.pointerId, event);\r\n        }\r\n        return lastDownPerPointer;\r\n    }\r\n    _processUpAndEmit(entity) {\r\n        const lastUpPerPointer = new Map();\r\n        // Loop through up and dispatch to entities\r\n        for (const event of this._receiver.currentFrameUp) {\r\n            if (event.active && entity.active && this.entityCurrentlyUnderPointer(entity, event.pointerId)) {\r\n                entity.events.emit('pointerup', event);\r\n                if (this._receiver.isDragEnd(event.pointerId)) {\r\n                    entity.events.emit('pointerdragend', event);\r\n                }\r\n            }\r\n            lastUpPerPointer.set(event.pointerId, event);\r\n        }\r\n        return lastUpPerPointer;\r\n    }\r\n    _processMoveAndEmit(entity) {\r\n        const lastMovePerPointer = new Map();\r\n        // Loop through move and dispatch to entities\r\n        for (const event of this._receiver.currentFrameMove) {\r\n            if (event.active && entity.active && this.entityCurrentlyUnderPointer(entity, event.pointerId)) {\r\n                // move\r\n                entity.events.emit('pointermove', event);\r\n                if (this._receiver.isDragging(event.pointerId)) {\r\n                    entity.events.emit('pointerdragmove', event);\r\n                }\r\n            }\r\n            lastMovePerPointer.set(event.pointerId, event);\r\n        }\r\n        return lastMovePerPointer;\r\n    }\r\n    _processEnterLeaveAndEmit(entity, lastUpDownMoveEvents) {\r\n        // up, down, and move are considered for enter and leave\r\n        for (const event of lastUpDownMoveEvents) {\r\n            // enter\r\n            if (event.active && entity.active && this.entered(entity, event.pointerId)) {\r\n                entity.events.emit('pointerenter', event);\r\n                if (this._receiver.isDragging(event.pointerId)) {\r\n                    entity.events.emit('pointerdragenter', event);\r\n                }\r\n                break;\r\n            }\r\n            if (event.active && entity.active &&\r\n                // leave can happen on move\r\n                (this.left(entity, event.pointerId) ||\r\n                    // or leave can happen on pointer up\r\n                    (this.entityCurrentlyUnderPointer(entity, event.pointerId) && event.type === 'up'))) {\r\n                entity.events.emit('pointerleave', event);\r\n                if (this._receiver.isDragging(event.pointerId)) {\r\n                    entity.events.emit('pointerdragleave', event);\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    _processCancelAndEmit(entity) {\r\n        // cancel\r\n        for (const event of this._receiver.currentFrameCancel) {\r\n            if (event.active && entity.active && this.entityCurrentlyUnderPointer(entity, event.pointerId)) {\r\n                entity.events.emit('pointercancel', event);\r\n            }\r\n        }\r\n    }\r\n    _processWheelAndEmit(entity) {\r\n        // wheel\r\n        for (const event of this._receiver.currentFrameWheel) {\r\n            // Currently the wheel only fires under the primary pointer '0'\r\n            if (event.active && entity.active && this.entityCurrentlyUnderPointer(entity, 0)) {\r\n                entity.events.emit('pointerwheel', event);\r\n            }\r\n        }\r\n    }\r\n    _dispatchEvents(entities) {\r\n        const lastFrameEntities = new Set(this.lastFrameEntityToPointers.keys());\r\n        const currentFrameEntities = new Set(this.currentFrameEntityToPointers.keys());\r\n        // Filter preserves z order\r\n        const entitiesWithEvents = entities.filter(e => lastFrameEntities.has(e.id) || currentFrameEntities.has(e.id));\r\n        let lastMovePerPointer;\r\n        let lastUpPerPointer;\r\n        let lastDownPerPointer;\r\n        // Dispatch events in entity z order\r\n        for (const entity of entitiesWithEvents) {\r\n            lastDownPerPointer = this._processDownAndEmit(entity);\r\n            lastUpPerPointer = this._processUpAndEmit(entity);\r\n            lastMovePerPointer = this._processMoveAndEmit(entity);\r\n            const lastUpDownMoveEvents = [\r\n                ...lastMovePerPointer.values(),\r\n                ...lastDownPerPointer.values(),\r\n                ...lastUpPerPointer.values()\r\n            ];\r\n            this._processEnterLeaveAndEmit(entity, lastUpDownMoveEvents);\r\n            this._processCancelAndEmit(entity);\r\n            this._processWheelAndEmit(entity);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/ActionsSystem.ts\n\r\n\r\nclass ActionsSystem extends System {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.types = ['ex.actions'];\r\n        this.systemType = SystemType.Update;\r\n        this.priority = -1;\r\n    }\r\n    update(entities, delta) {\r\n        let actions;\r\n        for (const entity of entities) {\r\n            actions = entity.get(ActionsComponent);\r\n            actions.update(delta);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Scene.ts\nvar Scene_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * [[Actor|Actors]] are composed together into groupings called Scenes in\r\n * Excalibur. The metaphor models the same idea behind real world\r\n * actors in a scene. Only actors in scenes will be updated and drawn.\r\n *\r\n * Typical usages of a scene include: levels, menus, loading screens, etc.\r\n */\r\nclass Scene extends Class {\r\n    constructor() {\r\n        super();\r\n        this._logger = Logger.getInstance();\r\n        /**\r\n         * Gets or sets the current camera for the scene\r\n         */\r\n        this.camera = new Camera();\r\n        /**\r\n         * The ECS world for the scene\r\n         */\r\n        this.world = new World(this);\r\n        this._isInitialized = false;\r\n        this._timers = [];\r\n        this._cancelQueue = [];\r\n        // Initialize systems\r\n        this.world.add(new ActionsSystem());\r\n        this.world.add(new MotionSystem());\r\n        this.world.add(new CollisionSystem());\r\n        this.world.add(new PointerSystem());\r\n        if (Flags.isEnabled(Legacy.LegacyDrawing)) {\r\n            this.world.add(new CanvasDrawingSystem());\r\n        }\r\n        else {\r\n            this.world.add(new GraphicsSystem());\r\n        }\r\n        this.world.add(new DebugSystem());\r\n    }\r\n    /**\r\n     * The actors in the current scene\r\n     */\r\n    get actors() {\r\n        return this.world.entityManager.entities.filter((e) => {\r\n            return e instanceof Actor;\r\n        });\r\n    }\r\n    /**\r\n     * The entities in the current scene\r\n     */\r\n    get entities() {\r\n        return this.world.entityManager.entities;\r\n    }\r\n    /**\r\n     * The triggers in the current scene\r\n     */\r\n    get triggers() {\r\n        return this.world.entityManager.entities.filter((e) => {\r\n            return e instanceof Trigger_Trigger;\r\n        });\r\n    }\r\n    /**\r\n     * The [[TileMap]]s in the scene, if any\r\n     */\r\n    get tileMaps() {\r\n        return this.world.entityManager.entities.filter((e) => {\r\n            return e instanceof TileMap;\r\n        });\r\n    }\r\n    /**\r\n     * The [[ScreenElement]]s in a scene, if any; these are drawn last\r\n     * @deprecated Use [[Scene.actors]]\r\n     */\r\n    get screenElements() {\r\n        return this.actors.filter((a) => a instanceof ScreenElement_ScreenElement);\r\n    }\r\n    get timers() {\r\n        return this._timers;\r\n    }\r\n    on(eventName, handler) {\r\n        super.on(eventName, handler);\r\n    }\r\n    once(eventName, handler) {\r\n        super.once(eventName, handler);\r\n    }\r\n    off(eventName, handler) {\r\n        super.off(eventName, handler);\r\n    }\r\n    /**\r\n     * This is called before the first update of the [[Scene]]. Initializes scene members like the camera. This method is meant to be\r\n     * overridden. This is where initialization of child actors should take place.\r\n     */\r\n    onInitialize(_engine) {\r\n        // will be overridden\r\n    }\r\n    /**\r\n     * This is called when the scene is made active and started. It is meant to be overridden,\r\n     * this is where you should setup any DOM UI or event handlers needed for the scene.\r\n     */\r\n    onActivate(_oldScene, _newScene) {\r\n        // will be overridden\r\n    }\r\n    /**\r\n     * This is called when the scene is made transitioned away from and stopped. It is meant to be overridden,\r\n     * this is where you should cleanup any DOM UI or event handlers needed for the scene.\r\n     */\r\n    onDeactivate(_oldScene, _newScene) {\r\n        // will be overridden\r\n    }\r\n    /**\r\n     * Safe to override onPreUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPreUpdate` is called directly before a scene is updated.\r\n     */\r\n    onPreUpdate(_engine, _delta) {\r\n        // will be overridden\r\n    }\r\n    /**\r\n     * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPostUpdate` is called directly after a scene is updated.\r\n     */\r\n    onPostUpdate(_engine, _delta) {\r\n        // will be overridden\r\n    }\r\n    /**\r\n     * Safe to override onPreDraw lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPreDraw` is called directly before a scene is drawn.\r\n     *\r\n     * @deprecated Signature will change in v0.26.0\r\n     */\r\n    onPreDraw(_ctx, _delta) {\r\n        // will be overridden\r\n    }\r\n    /**\r\n     * Safe to override onPostDraw lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPostDraw` is called directly after a scene is drawn.\r\n     *\r\n     * @deprecated Signature will change in v0.26.0\r\n     */\r\n    onPostDraw(_ctx, _delta) {\r\n        // will be overridden\r\n    }\r\n    /**\r\n     * Initializes actors in the scene\r\n     */\r\n    _initializeChildren() {\r\n        for (const child of this.entities) {\r\n            child._initialize(this.engine);\r\n        }\r\n    }\r\n    /**\r\n     * Gets whether or not the [[Scene]] has been initialized\r\n     */\r\n    get isInitialized() {\r\n        return this._isInitialized;\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Initializes the scene before the first update, meant to be called by engine not by users of\r\n     * Excalibur\r\n     * @internal\r\n     */\r\n    _initialize(engine) {\r\n        if (!this.isInitialized) {\r\n            this.engine = engine;\r\n            // Initialize camera first\r\n            this.camera._initialize(engine);\r\n            this.world.systemManager.initialize();\r\n            // This order is important! we want to be sure any custom init that add actors\r\n            // fire before the actor init\r\n            this.onInitialize.call(this, engine);\r\n            this._initializeChildren();\r\n            this._logger.debug('Scene.onInitialize', this, engine);\r\n            this.eventDispatcher.emit('initialize', new InitializeEvent(engine, this));\r\n            this._isInitialized = true;\r\n        }\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Activates the scene with the base behavior, then calls the overridable `onActivate` implementation.\r\n     * @internal\r\n     */\r\n    _activate(oldScene, newScene) {\r\n        this._logger.debug('Scene.onActivate', this);\r\n        this.onActivate(oldScene, newScene);\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Deactivates the scene with the base behavior, then calls the overridable `onDeactivate` implementation.\r\n     * @internal\r\n     */\r\n    _deactivate(oldScene, newScene) {\r\n        this._logger.debug('Scene.onDeactivate', this);\r\n        this.onDeactivate(oldScene, newScene);\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPreUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _preupdate(_engine, delta) {\r\n        this.emit('preupdate', new PreUpdateEvent(_engine, delta, this));\r\n        this.onPreUpdate(_engine, delta);\r\n    }\r\n    /**\r\n     *  It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPostUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _postupdate(_engine, delta) {\r\n        this.emit('postupdate', new PostUpdateEvent(_engine, delta, this));\r\n        this.onPostUpdate(_engine, delta);\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _predraw handler for [[onPreDraw]] lifecycle event\r\n     *\r\n     * @deprecated Signature will change in v0.26.0\r\n     * @internal\r\n     */\r\n    _predraw(_ctx, _delta) {\r\n        this.emit('predraw', new PreDrawEvent(_ctx, _delta, this));\r\n        this.onPreDraw(_ctx, _delta);\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _postdraw handler for [[onPostDraw]] lifecycle event\r\n     *\r\n     * @deprecated Signature will change in v0.26.0\r\n     * @internal\r\n     */\r\n    _postdraw(_ctx, _delta) {\r\n        this.emit('postdraw', new PostDrawEvent(_ctx, _delta, this));\r\n        this.onPostDraw(_ctx, _delta);\r\n    }\r\n    /**\r\n     * Updates all the actors and timers in the scene. Called by the [[Engine]].\r\n     * @param engine  Reference to the current Engine\r\n     * @param delta   The number of milliseconds since the last update\r\n     */\r\n    update(engine, delta) {\r\n        this._preupdate(engine, delta);\r\n        // TODO differed entity removal for timers\r\n        let i, len;\r\n        // Remove timers in the cancel queue before updating them\r\n        for (i = 0, len = this._cancelQueue.length; i < len; i++) {\r\n            this.removeTimer(this._cancelQueue[i]);\r\n        }\r\n        this._cancelQueue.length = 0;\r\n        // Cycle through timers updating timers\r\n        for (const timer of this._timers) {\r\n            timer.update(delta);\r\n        }\r\n        this.world.update(SystemType.Update, delta);\r\n        // Camera last keeps renders smooth that are based on entity/actor\r\n        if (this.camera) {\r\n            this.camera.update(engine, delta);\r\n        }\r\n        this._collectActorStats(engine);\r\n        this._postupdate(engine, delta);\r\n    }\r\n    /**\r\n     * Draws all the actors in the Scene. Called by the [[Engine]].\r\n     *\r\n     * @deprecated Signature will change in v0.26.0\r\n     * @param ctx    The current rendering context\r\n     * @param delta  The number of milliseconds since the last draw\r\n     */\r\n    draw(ctx, delta) {\r\n        var _a;\r\n        this._predraw(ctx, delta);\r\n        this.world.update(SystemType.Draw, delta);\r\n        if ((_a = this.engine) === null || _a === void 0 ? void 0 : _a.isDebug) {\r\n            this.debugDraw(ctx);\r\n        }\r\n        this._postdraw(ctx, delta);\r\n    }\r\n    /**\r\n     * Draws all the actors' debug information in the Scene. Called by the [[Engine]].\r\n     * @param ctx  The current rendering context\r\n     * @deprecated Signature will change in v0.26.0\r\n     */\r\n    /* istanbul ignore next */\r\n    debugDraw(ctx) {\r\n        this.emit('predebugdraw', new PreDebugDrawEvent(ctx, this));\r\n        // pass\r\n        this.emit('postdebugdraw', new PostDebugDrawEvent(ctx, this));\r\n    }\r\n    /**\r\n     * Checks whether an actor is contained in this scene or not\r\n     */\r\n    contains(actor) {\r\n        return this.actors.indexOf(actor) > -1;\r\n    }\r\n    add(entity) {\r\n        this.emit('entityadded', { target: entity });\r\n        this.world.add(entity);\r\n        entity.scene = this;\r\n        if (entity instanceof Timer) {\r\n            if (!contains(this._timers, entity)) {\r\n                this.addTimer(entity);\r\n            }\r\n            return;\r\n        }\r\n    }\r\n    remove(entity) {\r\n        if (entity instanceof Entity) {\r\n            this.emit('entityremoved', { target: entity });\r\n            this.world.remove(entity);\r\n        }\r\n        if (entity instanceof Timer) {\r\n            this.removeTimer(entity);\r\n        }\r\n    }\r\n    /**\r\n     * Adds (any) actor to act as a piece of UI, meaning it is always positioned\r\n     * in screen coordinates. UI actors do not participate in collisions.\r\n     * @todo Should this be `ScreenElement` only?\r\n     * @deprecated Use [[Scene.add]]\r\n     */\r\n    addScreenElement(actor) {\r\n        this.add(actor);\r\n    }\r\n    /**\r\n     * Removes an actor as a piece of UI\r\n     * @deprecated Use [[Scene.remove]]\r\n     */\r\n    removeScreenElement(actor) {\r\n        this.remove(actor);\r\n    }\r\n    /**\r\n     * Adds a [[TileMap]] to the scene, once this is done the TileMap will be drawn and updated.\r\n     * @deprecated Use [[Scene.add]]\r\n     */\r\n    addTileMap(tileMap) {\r\n        this.world.add(tileMap);\r\n    }\r\n    /**\r\n     * Removes a [[TileMap]] from the scene, it will no longer be drawn or updated.\r\n     * @deprecated Use [[Scene.remove]]\r\n     */\r\n    removeTileMap(tileMap) {\r\n        this.world.remove(tileMap);\r\n    }\r\n    /**\r\n     * Adds a [[Timer]] to the scene\r\n     * @param timer  The timer to add\r\n     */\r\n    addTimer(timer) {\r\n        this._timers.push(timer);\r\n        timer.scene = this;\r\n        return timer;\r\n    }\r\n    /**\r\n     * Removes a [[Timer]] from the scene.\r\n     * @warning Can be dangerous, use [[cancelTimer]] instead\r\n     * @param timer  The timer to remove\r\n     */\r\n    removeTimer(timer) {\r\n        const i = this._timers.indexOf(timer);\r\n        if (i !== -1) {\r\n            this._timers.splice(i, 1);\r\n        }\r\n        return timer;\r\n    }\r\n    /**\r\n     * Cancels a [[Timer]], removing it from the scene nicely\r\n     * @param timer  The timer to cancel\r\n     */\r\n    cancelTimer(timer) {\r\n        this._cancelQueue.push(timer);\r\n        return timer;\r\n    }\r\n    /**\r\n     * Tests whether a [[Timer]] is active in the scene\r\n     */\r\n    isTimerActive(timer) {\r\n        return this._timers.indexOf(timer) > -1 && !timer.complete;\r\n    }\r\n    isCurrentScene() {\r\n        if (this.engine) {\r\n            return this.engine.currentScene === this;\r\n        }\r\n        return false;\r\n    }\r\n    _collectActorStats(engine) {\r\n        const screenElements = this.actors.filter((a) => a instanceof ScreenElement_ScreenElement);\r\n        for (const _ui of screenElements) {\r\n            engine.stats.currFrame.actors.ui++;\r\n        }\r\n        for (const actor of this.actors) {\r\n            engine.stats.currFrame.actors.alive++;\r\n            for (const child of actor.children) {\r\n                if (isScreenElement(child)) {\r\n                    // TODO not true\r\n                    engine.stats.currFrame.actors.ui++;\r\n                }\r\n                else {\r\n                    engine.stats.currFrame.actors.alive++;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\nScene_decorate([\r\n    obsolete({\r\n        message: 'Will be removed in excalibur v0.26.0',\r\n        alternateMethod: 'ScreenElements now are normal actors with a Transform Coordinate Plane of Screen'\r\n    })\r\n], Scene.prototype, \"screenElements\", null);\r\nScene_decorate([\r\n    obsolete({ message: 'Will be removed in excalibur v0.26.0', alternateMethod: 'Use Scene.add' })\r\n], Scene.prototype, \"addScreenElement\", null);\r\nScene_decorate([\r\n    obsolete({ message: 'Will be removed in excalibur v0.26.0', alternateMethod: 'Use Scene.remove' })\r\n], Scene.prototype, \"removeScreenElement\", null);\r\nScene_decorate([\r\n    obsolete({ message: 'Will be removed in excalibur v0.26.0', alternateMethod: 'Use Scene.add' })\r\n], Scene.prototype, \"addTileMap\", null);\r\nScene_decorate([\r\n    obsolete({ message: 'Will be removed in excalibur v0.26.0', alternateMethod: 'Use Scene.remove' })\r\n], Scene.prototype, \"removeTileMap\", null);\r\n\n;// CONCATENATED MODULE: ./Graphics/PostProcessor/ColorBlindnessMode.ts\nvar ColorBlindnessMode;\r\n(function (ColorBlindnessMode) {\r\n    ColorBlindnessMode[\"Protanope\"] = \"Protanope\";\r\n    ColorBlindnessMode[\"Deuteranope\"] = \"Deuteranope\";\r\n    ColorBlindnessMode[\"Tritanope\"] = \"Tritanope\";\r\n})(ColorBlindnessMode || (ColorBlindnessMode = {}));\r\n\n;// CONCATENATED MODULE: ./Graphics/PostProcessor/color-blind-fragment.glsl\n/* harmony default export */ const color_blind_fragment = (\"precision mediump float;\\r\\n// our texture\\r\\nuniform sampler2D u_image;\\r\\n// the texCoords passed in from the vertex shader.\\r\\nvarying vec2 v_texcoord;\\r\\n\\r\\n// color blind type\\r\\nuniform int u_type;\\r\\n\\r\\n// simulation?\\r\\nuniform bool u_simulate;\\r\\n\\r\\nvoid main() {\\r\\n  vec4 o =  texture2D(u_image, v_texcoord);\\r\\n  // RGB to LMS matrix conversion\\r\\n  float L = (17.8824 * o.r) + (43.5161 * o.g) + (4.11935 * o.b);\\r\\n  float M = (3.45565 * o.r) + (27.1554 * o.g) + (3.86714 * o.b);\\r\\n  float S = (0.0299566 * o.r) + (0.184309 * o.g) + (1.46709 * o.b);\\r\\n  // Simulate color blindness\\r\\n  float l;\\r\\n  float m;\\r\\n  float s;\\r\\n  //MODE CODE//\\r\\n  if (u_type == 0) {\\r\\n    // Protanope\\r\\n    l = 0.0 * L + 2.02344 * M + -2.52581 * S;\\r\\n    m = 0.0 * L + 1.0 * M + 0.0 * S;\\r\\n    s = 0.0 * L + 0.0 * M + 1.0 * S;;\\r\\n  } else if (u_type == 1) {\\r\\n    // Deuteranope\\r\\n    l = 1.0 * L + 0.0 * M + 0.0 * S;\\r\\n    m = 0.494207 * L + 0.0 * M + 1.24827 * S;\\r\\n    s = 0.0 * L + 0.0 * M + 1.0 * S;\\r\\n  } else if (u_type == 2) {\\r\\n    // Tritanope\\r\\n    l = 1.0 * L + 0.0 * M + 0.0 * S;\\r\\n    m = 0.0 * L + 1.0 * M + 0.0 * S;\\r\\n    s = -0.395913 * L + 0.801109 * M + 0.0 * S;\\r\\n  }\\r\\n\\r\\n  // LMS to RGB matrix conversion\\r\\n  vec4 error; // simulate the colors\\r\\n  error.r = (0.0809444479 * l) + (-0.130504409 * m) + (0.116721066 * s);\\r\\n  error.g = (-0.0102485335 * l) + (0.0540193266 * m) + (-0.113614708 * s);\\r\\n  error.b = (-0.000365296938 * l) + (-0.00412161469 * m) + (0.693511405 * s);\\r\\n  error.a = 1.0;\\r\\n  vec4 diff = o - error;\\r\\n  vec4 correction; // correct the colors\\r\\n  correction.r = 0.0;\\r\\n  correction.g =  (diff.r * 0.7) + (diff.g * 1.0);\\r\\n  correction.b =  (diff.r * 0.7) + (diff.b * 1.0);\\r\\n  correction = o + correction;\\r\\n  correction.a = o.a;\\r\\n  //SIMULATE//\\r\\n\\r\\n  // sim \\r\\n  if (u_simulate) {\\r\\n    gl_FragColor = error.rgba;\\r\\n  } else {\\r\\n    gl_FragColor = correction.rgba;\\r\\n  }\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/PostProcessor/ScreenShader.ts\n\r\n\r\n\r\n/**\r\n * Helper that defines a whole screen renderer, just provide a fragment source!\r\n *\r\n * Currently supports 1 varying\r\n * - vec2 a_texcoord between 0-1 which corresponds to screen position\r\n */\r\nclass ScreenShader {\r\n    constructor(fragmentSource) {\r\n        this._shader = new Shader({\r\n            vertexSource: `\r\n      attribute vec2 a_position;\r\n      attribute vec2 a_texcoord;\r\n      varying vec2 v_texcoord;\r\n\r\n      void main() {\r\n        gl_Position = vec4(a_position, 0.0, 1.0);\r\n        // Pass the texcoord to the fragment shader.\r\n        v_texcoord = a_texcoord;\r\n      }`,\r\n            fragmentSource: fragmentSource\r\n        });\r\n        this._shader.compile();\r\n        // Setup memory layout\r\n        this._buffer = new VertexBuffer({\r\n            type: 'static',\r\n            // clip space quad + uv since we don't need a camera\r\n            data: new Float32Array([\r\n                -1, -1, 0, 0,\r\n                -1, 1, 0, 1,\r\n                1, -1, 1, 0,\r\n                1, -1, 1, 0,\r\n                -1, 1, 0, 1,\r\n                1, 1, 1, 1\r\n            ])\r\n        });\r\n        this._layout = new VertexLayout({\r\n            shader: this._shader,\r\n            vertexBuffer: this._buffer,\r\n            attributes: [\r\n                ['a_position', 2],\r\n                ['a_texcoord', 2]\r\n            ]\r\n        });\r\n        this._buffer.upload();\r\n    }\r\n    getShader() {\r\n        return this._shader;\r\n    }\r\n    getLayout() {\r\n        return this._layout;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/PostProcessor/ColorBlindnessPostProcessor.ts\n\r\n\r\n\r\nclass ColorBlindnessPostProcessor {\r\n    constructor(_colorBlindnessMode, simulate = false) {\r\n        this._colorBlindnessMode = _colorBlindnessMode;\r\n        this._simulate = false;\r\n        this._simulate = simulate;\r\n    }\r\n    initialize(_gl) {\r\n        this._shader = new ScreenShader(color_blind_fragment);\r\n        this.simulate = this._simulate;\r\n        this.colorBlindnessMode = this._colorBlindnessMode;\r\n    }\r\n    getShader() {\r\n        return this._shader.getShader();\r\n    }\r\n    getLayout() {\r\n        return this._shader.getLayout();\r\n    }\r\n    set colorBlindnessMode(colorBlindMode) {\r\n        this._colorBlindnessMode = colorBlindMode;\r\n        if (this._shader) {\r\n            const shader = this._shader.getShader();\r\n            shader.use();\r\n            if (this._colorBlindnessMode === ColorBlindnessMode.Protanope) {\r\n                shader.setUniformInt('u_type', 0);\r\n            }\r\n            else if (this._colorBlindnessMode === ColorBlindnessMode.Deuteranope) {\r\n                shader.setUniformInt('u_type', 1);\r\n            }\r\n            else if (this._colorBlindnessMode === ColorBlindnessMode.Tritanope) {\r\n                shader.setUniformInt('u_type', 2);\r\n            }\r\n        }\r\n    }\r\n    get colorBlindnessMode() {\r\n        return this._colorBlindnessMode;\r\n    }\r\n    set simulate(value) {\r\n        this._simulate = value;\r\n        if (this._shader) {\r\n            const shader = this._shader.getShader();\r\n            shader.use();\r\n            shader.setUniformBoolean('u_simulate', value);\r\n        }\r\n    }\r\n    get simulate() {\r\n        return this._simulate;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Debug/DebugFlags.ts\n\r\n\r\n\r\nclass ColorBlindFlags {\r\n    constructor(engine) {\r\n        this._engine = engine;\r\n        this._colorBlindPostProcessor = new ColorBlindnessPostProcessor(ColorBlindnessMode.Protanope);\r\n    }\r\n    /**\r\n     * Correct colors for a specified color blindness\r\n     * @param colorBlindness\r\n     */\r\n    correct(colorBlindness) {\r\n        if (this._engine.graphicsContext instanceof ExcaliburGraphicsContextWebGL) {\r\n            this.clear();\r\n            this._colorBlindPostProcessor.colorBlindnessMode = colorBlindness;\r\n            this._colorBlindPostProcessor.simulate = false;\r\n            this._engine.graphicsContext.addPostProcessor(this._colorBlindPostProcessor);\r\n        }\r\n    }\r\n    /**\r\n     * Simulate colors for a specified color blindness\r\n     * @param colorBlindness\r\n     */\r\n    simulate(colorBlindness) {\r\n        if (this._engine.graphicsContext instanceof ExcaliburGraphicsContextWebGL) {\r\n            this.clear();\r\n            this._colorBlindPostProcessor.colorBlindnessMode = colorBlindness;\r\n            this._colorBlindPostProcessor.simulate = true;\r\n            this._engine.graphicsContext.addPostProcessor(this._colorBlindPostProcessor);\r\n        }\r\n    }\r\n    /**\r\n     * Remove color blindness post processor\r\n     */\r\n    clear() {\r\n        this._engine.graphicsContext.removePostProcessor(this._colorBlindPostProcessor);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Debug/Debug.ts\n\r\n\r\n/**\r\n * Debug statistics and flags for Excalibur. If polling these values, it would be\r\n * best to do so on the `postupdate` event for [[Engine]], after all values have been\r\n * updated during a frame.\r\n */\r\nclass Debug {\r\n    constructor(engine) {\r\n        /**\r\n         * Performance statistics\r\n         */\r\n        this.stats = {\r\n            /**\r\n             * Current frame statistics. Engine reuses this instance, use [[FrameStats.clone]] to copy frame stats.\r\n             * Best accessed on [[postframe]] event. See [[FrameStats]]\r\n             */\r\n            currFrame: new FrameStats(),\r\n            /**\r\n             * Previous frame statistics. Engine reuses this instance, use [[FrameStats.clone]] to copy frame stats.\r\n             * Best accessed on [[preframe]] event. Best inspected on engine event `preframe`. See [[FrameStats]]\r\n             */\r\n            prevFrame: new FrameStats()\r\n        };\r\n        /**\r\n         * Filter debug context to named entities or entity ids\r\n         */\r\n        this.filter = {\r\n            /**\r\n             * Toggle filter on or off (default off) must be on for DebugDraw to use filters\r\n             */\r\n            useFilter: false,\r\n            /**\r\n             * Query for entities by name, if the entity name contains `nameQuery` it will be included\r\n             */\r\n            nameQuery: '',\r\n            /**\r\n             * Query for Entity ids, if the id matches it will be included\r\n             */\r\n            ids: []\r\n        };\r\n        /**\r\n         * Entity debug settings\r\n         */\r\n        this.entity = {\r\n            showAll: false,\r\n            showId: true,\r\n            showName: false\r\n        };\r\n        /**\r\n         * Transform component debug settings\r\n         */\r\n        this.transform = {\r\n            showAll: false,\r\n            showPosition: false,\r\n            showPositionLabel: false,\r\n            positionColor: Color.Yellow,\r\n            showScale: false,\r\n            scaleColor: Color.Green,\r\n            showRotation: false,\r\n            rotationColor: Color.Blue\r\n        };\r\n        /**\r\n         * Graphics component debug settings\r\n         */\r\n        this.graphics = {\r\n            showAll: false,\r\n            showBounds: true,\r\n            boundsColor: Color.Yellow\r\n        };\r\n        /**\r\n         * Collider component debug settings\r\n         */\r\n        this.collider = {\r\n            showAll: false,\r\n            showBounds: true,\r\n            boundsColor: Color.Blue,\r\n            showOwner: false,\r\n            showGeometry: true,\r\n            geometryColor: Color.Green\r\n        };\r\n        /**\r\n         * Physics simulation debug settings\r\n         */\r\n        this.physics = {\r\n            showAll: false,\r\n            showBroadphaseSpacePartitionDebug: false,\r\n            showCollisionNormals: false,\r\n            collisionNormalColor: Color.Cyan,\r\n            showCollisionContacts: true,\r\n            collisionContactColor: Color.Red\r\n        };\r\n        /**\r\n         * Motion component debug settings\r\n         */\r\n        this.motion = {\r\n            showAll: false,\r\n            showVelocity: false,\r\n            velocityColor: Color.Yellow,\r\n            showAcceleration: false,\r\n            accelerationColor: Color.Red\r\n        };\r\n        /**\r\n         * Body component debug settings\r\n         */\r\n        this.body = {\r\n            showAll: false,\r\n            showCollisionGroup: false,\r\n            showCollisionType: false,\r\n            showSleeping: false,\r\n            showMotion: false,\r\n            showMass: false\r\n        };\r\n        /**\r\n         * Camera debug settings\r\n         */\r\n        this.camera = {\r\n            showAll: false,\r\n            showFocus: false,\r\n            focusColor: Color.Red,\r\n            showZoom: false\r\n        };\r\n        this._engine = engine;\r\n        this.colorBlindMode = new ColorBlindFlags(this._engine);\r\n    }\r\n    /**\r\n     * Switch the current excalibur clock with the [[TestClock]] and return\r\n     * it in the same running state.\r\n     *\r\n     * This is useful when you need to debug frame by frame.\r\n     */\r\n    useTestClock() {\r\n        const clock = this._engine.clock;\r\n        const wasRunning = clock.isRunning();\r\n        clock.stop();\r\n        const testClock = clock.toTestClock();\r\n        if (wasRunning) {\r\n            testClock.start();\r\n        }\r\n        this._engine.clock = testClock;\r\n        return testClock;\r\n    }\r\n    /**\r\n     * Switch the current excalibur clock with the [[StandardClock]] and\r\n     * return it in the same running state.\r\n     *\r\n     * This is useful when you need to switch back to normal mode after\r\n     * debugging.\r\n     */\r\n    useStandardClock() {\r\n        const currentClock = this._engine.clock;\r\n        const wasRunning = currentClock.isRunning();\r\n        currentClock.stop();\r\n        const standardClock = currentClock.toStandardClock();\r\n        if (wasRunning) {\r\n            standardClock.start();\r\n        }\r\n        this._engine.clock = standardClock;\r\n        return standardClock;\r\n    }\r\n}\r\n/**\r\n * Implementation of a frame's stats. Meant to have values copied via [[FrameStats.reset]], avoid\r\n * creating instances of this every frame.\r\n */\r\nclass FrameStats {\r\n    constructor() {\r\n        this._id = 0;\r\n        this._delta = 0;\r\n        this._fps = 0;\r\n        this._actorStats = {\r\n            alive: 0,\r\n            killed: 0,\r\n            ui: 0,\r\n            get remaining() {\r\n                return this.alive - this.killed;\r\n            },\r\n            get total() {\r\n                return this.remaining + this.ui;\r\n            }\r\n        };\r\n        this._durationStats = {\r\n            update: 0,\r\n            draw: 0,\r\n            get total() {\r\n                return this.update + this.draw;\r\n            }\r\n        };\r\n        this._physicsStats = new PhysicsStats();\r\n        this._graphicsStats = {\r\n            drawCalls: 0,\r\n            drawnImages: 0\r\n        };\r\n    }\r\n    /**\r\n     * Zero out values or clone other IFrameStat stats. Allows instance reuse.\r\n     *\r\n     * @param [otherStats] Optional stats to clone\r\n     */\r\n    reset(otherStats) {\r\n        if (otherStats) {\r\n            this.id = otherStats.id;\r\n            this.delta = otherStats.delta;\r\n            this.fps = otherStats.fps;\r\n            this.actors.alive = otherStats.actors.alive;\r\n            this.actors.killed = otherStats.actors.killed;\r\n            this.actors.ui = otherStats.actors.ui;\r\n            this.duration.update = otherStats.duration.update;\r\n            this.duration.draw = otherStats.duration.draw;\r\n            this._physicsStats.reset(otherStats.physics);\r\n            this.graphics.drawCalls = otherStats.graphics.drawCalls;\r\n            this.graphics.drawnImages = otherStats.graphics.drawnImages;\r\n        }\r\n        else {\r\n            this.id = this.delta = this.fps = 0;\r\n            this.actors.alive = this.actors.killed = this.actors.ui = 0;\r\n            this.duration.update = this.duration.draw = 0;\r\n            this._physicsStats.reset();\r\n            this.graphics.drawnImages = this.graphics.drawCalls = 0;\r\n        }\r\n    }\r\n    /**\r\n     * Provides a clone of this instance.\r\n     */\r\n    clone() {\r\n        const fs = new FrameStats();\r\n        fs.reset(this);\r\n        return fs;\r\n    }\r\n    /**\r\n     * Gets the frame's id\r\n     */\r\n    get id() {\r\n        return this._id;\r\n    }\r\n    /**\r\n     * Sets the frame's id\r\n     */\r\n    set id(value) {\r\n        this._id = value;\r\n    }\r\n    /**\r\n     * Gets the frame's delta (time since last frame)\r\n     */\r\n    get delta() {\r\n        return this._delta;\r\n    }\r\n    /**\r\n     * Sets the frame's delta (time since last frame). Internal use only.\r\n     * @internal\r\n     */\r\n    set delta(value) {\r\n        this._delta = value;\r\n    }\r\n    /**\r\n     * Gets the frame's frames-per-second (FPS)\r\n     */\r\n    get fps() {\r\n        return this._fps;\r\n    }\r\n    /**\r\n     * Sets the frame's frames-per-second (FPS). Internal use only.\r\n     * @internal\r\n     */\r\n    set fps(value) {\r\n        this._fps = value;\r\n    }\r\n    /**\r\n     * Gets the frame's actor statistics\r\n     */\r\n    get actors() {\r\n        return this._actorStats;\r\n    }\r\n    /**\r\n     * Gets the frame's duration statistics\r\n     */\r\n    get duration() {\r\n        return this._durationStats;\r\n    }\r\n    /**\r\n     * Gets the frame's physics statistics\r\n     */\r\n    get physics() {\r\n        return this._physicsStats;\r\n    }\r\n    /**\r\n     * Gets the frame's graphics statistics\r\n     */\r\n    get graphics() {\r\n        return this._graphicsStats;\r\n    }\r\n}\r\nclass PhysicsStats {\r\n    constructor() {\r\n        this._pairs = 0;\r\n        this._collisions = 0;\r\n        this._contacts = new Map();\r\n        this._fastBodies = 0;\r\n        this._fastBodyCollisions = 0;\r\n        this._broadphase = 0;\r\n        this._narrowphase = 0;\r\n    }\r\n    /**\r\n     * Zero out values or clone other IPhysicsStats stats. Allows instance reuse.\r\n     *\r\n     * @param [otherStats] Optional stats to clone\r\n     */\r\n    reset(otherStats) {\r\n        if (otherStats) {\r\n            this.pairs = otherStats.pairs;\r\n            this.collisions = otherStats.collisions;\r\n            this.contacts = otherStats.contacts;\r\n            this.fastBodies = otherStats.fastBodies;\r\n            this.fastBodyCollisions = otherStats.fastBodyCollisions;\r\n            this.broadphase = otherStats.broadphase;\r\n            this.narrowphase = otherStats.narrowphase;\r\n        }\r\n        else {\r\n            this.pairs = this.collisions = this.fastBodies = 0;\r\n            this.fastBodyCollisions = this.broadphase = this.narrowphase = 0;\r\n            this.contacts.clear();\r\n        }\r\n    }\r\n    /**\r\n     * Provides a clone of this instance.\r\n     */\r\n    clone() {\r\n        const ps = new PhysicsStats();\r\n        ps.reset(this);\r\n        return ps;\r\n    }\r\n    get pairs() {\r\n        return this._pairs;\r\n    }\r\n    set pairs(value) {\r\n        this._pairs = value;\r\n    }\r\n    get collisions() {\r\n        return this._collisions;\r\n    }\r\n    set collisions(value) {\r\n        this._collisions = value;\r\n    }\r\n    get contacts() {\r\n        return this._contacts;\r\n    }\r\n    set contacts(contacts) {\r\n        this._contacts = contacts;\r\n    }\r\n    get fastBodies() {\r\n        return this._fastBodies;\r\n    }\r\n    set fastBodies(value) {\r\n        this._fastBodies = value;\r\n    }\r\n    get fastBodyCollisions() {\r\n        return this._fastBodyCollisions;\r\n    }\r\n    set fastBodyCollisions(value) {\r\n        this._fastBodyCollisions = value;\r\n    }\r\n    get broadphase() {\r\n        return this._broadphase;\r\n    }\r\n    set broadphase(value) {\r\n        this._broadphase = value;\r\n    }\r\n    get narrowphase() {\r\n        return this._narrowphase;\r\n    }\r\n    set narrowphase(value) {\r\n        this._narrowphase = value;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Input/PointerScope.ts\n/**\r\n * Determines the scope of handling mouse/touch events.\r\n */\r\nvar PointerScope;\r\n(function (PointerScope) {\r\n    /**\r\n     * Handle events on the `canvas` element only. Events originating outside the\r\n     * `canvas` will not be handled.\r\n     */\r\n    PointerScope[\"Canvas\"] = \"Canvas\";\r\n    /**\r\n     * Handles events on the entire document. All events will be handled by Excalibur.\r\n     */\r\n    PointerScope[\"Document\"] = \"Document\";\r\n})(PointerScope || (PointerScope = {}));\r\n\n;// CONCATENATED MODULE: ./Input/Keyboard.ts\n\r\n\r\n\r\n/**\r\n * Enum representing physical input key codes\r\n */\r\nvar Keys;\r\n(function (Keys) {\r\n    // NUMPAD\r\n    Keys[\"Num0\"] = \"Numpad0\";\r\n    Keys[\"Num1\"] = \"Numpad1\";\r\n    Keys[\"Num2\"] = \"Numpad2\";\r\n    Keys[\"Num3\"] = \"Numpad3\";\r\n    Keys[\"Num4\"] = \"Numpad4\";\r\n    Keys[\"Num5\"] = \"Numpad5\";\r\n    Keys[\"Num6\"] = \"Numpad6\";\r\n    Keys[\"Num7\"] = \"Numpad7\";\r\n    Keys[\"Num8\"] = \"Numpad8\";\r\n    Keys[\"Num9\"] = \"Numpad9\";\r\n    Keys[\"NumAdd\"] = \"NumpadAdd\";\r\n    Keys[\"NumSubtract\"] = \"NumpadSubtract\";\r\n    Keys[\"NumMultiply\"] = \"NumpadMultiply\";\r\n    Keys[\"NumDivide\"] = \"NumpadDivide\";\r\n    // NumComma = 'NumpadComma', // not x-browser\r\n    Keys[\"NumDecimal\"] = \"NumpadDecimal\";\r\n    Keys[\"Numpad0\"] = \"Numpad0\";\r\n    Keys[\"Numpad1\"] = \"Numpad1\";\r\n    Keys[\"Numpad2\"] = \"Numpad2\";\r\n    Keys[\"Numpad3\"] = \"Numpad3\";\r\n    Keys[\"Numpad4\"] = \"Numpad4\";\r\n    Keys[\"Numpad5\"] = \"Numpad5\";\r\n    Keys[\"Numpad6\"] = \"Numpad6\";\r\n    Keys[\"Numpad7\"] = \"Numpad7\";\r\n    Keys[\"Numpad8\"] = \"Numpad8\";\r\n    Keys[\"Numpad9\"] = \"Numpad9\";\r\n    Keys[\"NumpadAdd\"] = \"NumpadAdd\";\r\n    Keys[\"NumpadSubtract\"] = \"NumpadSubtract\";\r\n    Keys[\"NumpadMultiply\"] = \"NumpadMultiply\";\r\n    Keys[\"NumpadDivide\"] = \"NumpadDivide\";\r\n    // NumpadComma = 'NumpadComma', // not x-browser\r\n    Keys[\"NumpadDecimal\"] = \"NumpadDecimal\";\r\n    // MODIFIERS\r\n    Keys[\"NumLock\"] = \"NumLock\";\r\n    Keys[\"ShiftLeft\"] = \"ShiftLeft\";\r\n    Keys[\"ShiftRight\"] = \"ShiftRight\";\r\n    Keys[\"AltLeft\"] = \"AltLeft\";\r\n    Keys[\"AltRight\"] = \"AltRight\";\r\n    // NUMBERS\r\n    Keys[\"Key0\"] = \"Digit0\";\r\n    Keys[\"Key1\"] = \"Digit1\";\r\n    Keys[\"Key2\"] = \"Digit2\";\r\n    Keys[\"Key3\"] = \"Digit3\";\r\n    Keys[\"Key4\"] = \"Digit4\";\r\n    Keys[\"Key5\"] = \"Digit5\";\r\n    Keys[\"Key6\"] = \"Digit6\";\r\n    Keys[\"Key7\"] = \"Digit7\";\r\n    Keys[\"Key8\"] = \"Digit8\";\r\n    Keys[\"Key9\"] = \"Digit9\";\r\n    Keys[\"Digit0\"] = \"Digit0\";\r\n    Keys[\"Digit1\"] = \"Digit1\";\r\n    Keys[\"Digit2\"] = \"Digit2\";\r\n    Keys[\"Digit3\"] = \"Digit3\";\r\n    Keys[\"Digit4\"] = \"Digit4\";\r\n    Keys[\"Digit5\"] = \"Digit5\";\r\n    Keys[\"Digit6\"] = \"Digit6\";\r\n    Keys[\"Digit7\"] = \"Digit7\";\r\n    Keys[\"Digit8\"] = \"Digit8\";\r\n    Keys[\"Digit9\"] = \"Digit9\";\r\n    // LETTERS\r\n    Keys[\"A\"] = \"KeyA\";\r\n    Keys[\"B\"] = \"KeyB\";\r\n    Keys[\"C\"] = \"KeyC\";\r\n    Keys[\"D\"] = \"KeyD\";\r\n    Keys[\"E\"] = \"KeyE\";\r\n    Keys[\"F\"] = \"KeyF\";\r\n    Keys[\"G\"] = \"KeyG\";\r\n    Keys[\"H\"] = \"KeyH\";\r\n    Keys[\"I\"] = \"KeyI\";\r\n    Keys[\"J\"] = \"KeyJ\";\r\n    Keys[\"K\"] = \"KeyK\";\r\n    Keys[\"L\"] = \"KeyL\";\r\n    Keys[\"M\"] = \"KeyM\";\r\n    Keys[\"N\"] = \"KeyN\";\r\n    Keys[\"O\"] = \"KeyO\";\r\n    Keys[\"P\"] = \"KeyP\";\r\n    Keys[\"Q\"] = \"KeyQ\";\r\n    Keys[\"R\"] = \"KeyR\";\r\n    Keys[\"S\"] = \"KeyS\";\r\n    Keys[\"T\"] = \"KeyT\";\r\n    Keys[\"U\"] = \"KeyU\";\r\n    Keys[\"V\"] = \"KeyV\";\r\n    Keys[\"W\"] = \"KeyW\";\r\n    Keys[\"X\"] = \"KeyX\";\r\n    Keys[\"Y\"] = \"KeyY\";\r\n    Keys[\"Z\"] = \"KeyZ\";\r\n    Keys[\"KeyA\"] = \"KeyA\";\r\n    Keys[\"KeyB\"] = \"KeyB\";\r\n    Keys[\"KeyC\"] = \"KeyC\";\r\n    Keys[\"KeyD\"] = \"KeyD\";\r\n    Keys[\"KeyE\"] = \"KeyE\";\r\n    Keys[\"KeyF\"] = \"KeyF\";\r\n    Keys[\"KeyG\"] = \"KeyG\";\r\n    Keys[\"KeyH\"] = \"KeyH\";\r\n    Keys[\"KeyI\"] = \"KeyI\";\r\n    Keys[\"KeyJ\"] = \"KeyJ\";\r\n    Keys[\"KeyK\"] = \"KeyK\";\r\n    Keys[\"KeyL\"] = \"KeyL\";\r\n    Keys[\"KeyM\"] = \"KeyM\";\r\n    Keys[\"KeyN\"] = \"KeyN\";\r\n    Keys[\"KeyO\"] = \"KeyO\";\r\n    Keys[\"KeyP\"] = \"KeyP\";\r\n    Keys[\"KeyQ\"] = \"KeyQ\";\r\n    Keys[\"KeyR\"] = \"KeyR\";\r\n    Keys[\"KeyS\"] = \"KeyS\";\r\n    Keys[\"KeyT\"] = \"KeyT\";\r\n    Keys[\"KeyU\"] = \"KeyU\";\r\n    Keys[\"KeyV\"] = \"KeyV\";\r\n    Keys[\"KeyW\"] = \"KeyW\";\r\n    Keys[\"KeyX\"] = \"KeyX\";\r\n    Keys[\"KeyY\"] = \"KeyY\";\r\n    Keys[\"KeyZ\"] = \"KeyZ\";\r\n    // SYMBOLS\r\n    Keys[\"Semicolon\"] = \"Semicolon\";\r\n    Keys[\"Quote\"] = \"Quote\";\r\n    Keys[\"Comma\"] = \"Comma\";\r\n    Keys[\"Minus\"] = \"Minus\";\r\n    Keys[\"Period\"] = \"Period\";\r\n    Keys[\"Slash\"] = \"Slash\";\r\n    Keys[\"Equal\"] = \"Equal\";\r\n    Keys[\"BracketLeft\"] = \"BracketLeft\";\r\n    Keys[\"Backslash\"] = \"Backslash\";\r\n    Keys[\"BracketRight\"] = \"BracketRight\";\r\n    Keys[\"Backquote\"] = \"Backquote\";\r\n    // DIRECTIONS\r\n    Keys[\"Up\"] = \"ArrowUp\";\r\n    Keys[\"Down\"] = \"ArrowDown\";\r\n    Keys[\"Left\"] = \"ArrowLeft\";\r\n    Keys[\"Right\"] = \"ArrowRight\";\r\n    Keys[\"ArrowUp\"] = \"ArrowUp\";\r\n    Keys[\"ArrowDown\"] = \"ArrowDown\";\r\n    Keys[\"ArrowLeft\"] = \"ArrowLeft\";\r\n    Keys[\"ArrowRight\"] = \"ArrowRight\";\r\n    // OTHER\r\n    Keys[\"Space\"] = \"Space\";\r\n    Keys[\"Esc\"] = \"Escape\";\r\n    Keys[\"Escape\"] = \"Escape\";\r\n})(Keys || (Keys = {}));\r\n/**\r\n * Event thrown on a game object for a key event\r\n */\r\nclass KeyEvent extends GameEvent {\r\n    /**\r\n     * @param key  The key responsible for throwing the event\r\n     * @param value The key's typed value the browser detected\r\n     * @param originalEvent The original keyboard event that Excalibur handled\r\n     */\r\n    constructor(key, value, originalEvent) {\r\n        super();\r\n        this.key = key;\r\n        this.value = value;\r\n        this.originalEvent = originalEvent;\r\n    }\r\n}\r\n/**\r\n * Provides keyboard support for Excalibur.\r\n */\r\nclass Keyboard extends Class {\r\n    constructor() {\r\n        super();\r\n        this._keys = [];\r\n        this._keysUp = [];\r\n        this._keysDown = [];\r\n    }\r\n    on(eventName, handler) {\r\n        super.on(eventName, handler);\r\n    }\r\n    /**\r\n     * Initialize Keyboard event listeners\r\n     */\r\n    init(global) {\r\n        if (!global) {\r\n            try {\r\n                // Try and listen to events on top window frame if within an iframe.\r\n                //\r\n                // See https://github.com/excaliburjs/Excalibur/issues/1294\r\n                //\r\n                // Attempt to add an event listener, which triggers a DOMException on\r\n                // cross-origin iframes\r\n                const noop = () => {\r\n                    return;\r\n                };\r\n                window.top.addEventListener('blur', noop);\r\n                window.top.removeEventListener('blur', noop);\r\n                // this will be the same as window if not embedded within an iframe\r\n                global = window.top;\r\n            }\r\n            catch (_a) {\r\n                // fallback to current frame\r\n                global = window;\r\n                Logger.getInstance().warn('Failed to bind to keyboard events to top frame. ' +\r\n                    'If you are trying to embed Excalibur in a cross-origin iframe, keyboard events will not fire.');\r\n            }\r\n        }\r\n        global.addEventListener('blur', () => {\r\n            this._keys.length = 0; // empties array efficiently\r\n        });\r\n        // key up is on window because canvas cannot have focus\r\n        global.addEventListener('keyup', (ev) => {\r\n            const code = ev.code;\r\n            const key = this._keys.indexOf(code);\r\n            this._keys.splice(key, 1);\r\n            this._keysUp.push(code);\r\n            const keyEvent = new KeyEvent(code, ev.key, ev);\r\n            // alias the old api, we may want to deprecate this in the future\r\n            this.eventDispatcher.emit('up', keyEvent);\r\n            this.eventDispatcher.emit('release', keyEvent);\r\n        });\r\n        // key down is on window because canvas cannot have focus\r\n        global.addEventListener('keydown', (ev) => {\r\n            const code = ev.code;\r\n            if (this._keys.indexOf(code) === -1) {\r\n                this._keys.push(code);\r\n                this._keysDown.push(code);\r\n                const keyEvent = new KeyEvent(code, ev.key, ev);\r\n                this.eventDispatcher.emit('down', keyEvent);\r\n                this.eventDispatcher.emit('press', keyEvent);\r\n            }\r\n        });\r\n    }\r\n    update() {\r\n        // Reset keysDown and keysUp after update is complete\r\n        this._keysDown.length = 0;\r\n        this._keysUp.length = 0;\r\n        // Emit synthetic \"hold\" event\r\n        for (let i = 0; i < this._keys.length; i++) {\r\n            this.eventDispatcher.emit('hold', new KeyEvent(this._keys[i]));\r\n        }\r\n    }\r\n    /**\r\n     * Gets list of keys being pressed down\r\n     */\r\n    getKeys() {\r\n        return this._keys;\r\n    }\r\n    /**\r\n     * Tests if a certain key was just pressed this frame. This is cleared at the end of the update frame.\r\n     * @param key Test whether a key was just pressed\r\n     */\r\n    wasPressed(key) {\r\n        return this._keysDown.indexOf(key) > -1;\r\n    }\r\n    /**\r\n     * Tests if a certain key is held down. This is persisted between frames.\r\n     * @param key  Test whether a key is held down\r\n     */\r\n    isHeld(key) {\r\n        return this._keys.indexOf(key) > -1;\r\n    }\r\n    /**\r\n     * Tests if a certain key was just released this frame. This is cleared at the end of the update frame.\r\n     * @param key  Test whether a key was just released\r\n     */\r\n    wasReleased(key) {\r\n        return this._keysUp.indexOf(key) > -1;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Input/Gamepad.ts\n\r\n\r\n/**\r\n * Excalibur leverages the HTML5 Gamepad API [where it is supported](http://caniuse.com/#feat=gamepad)\r\n * to provide controller support for your games.\r\n */\r\nclass Gamepads extends Class {\r\n    constructor() {\r\n        super();\r\n        /**\r\n         * Whether or not to poll for Gamepad input (default: `false`)\r\n         */\r\n        this.enabled = false;\r\n        /**\r\n         * Whether or not Gamepad API is supported\r\n         */\r\n        this.supported = !!navigator.getGamepads;\r\n        this._gamePadTimeStamps = [0, 0, 0, 0];\r\n        this._oldPads = [];\r\n        this._pads = [];\r\n        this._initSuccess = false;\r\n        this._navigator = navigator;\r\n        this._minimumConfiguration = null;\r\n    }\r\n    init() {\r\n        if (!this.supported) {\r\n            return;\r\n        }\r\n        if (this._initSuccess) {\r\n            return;\r\n        }\r\n        // In Chrome, this will return 4 undefined items until a button is pressed\r\n        // In FF, this will not return any items until a button is pressed\r\n        this._oldPads = this._clonePads(this._navigator.getGamepads());\r\n        if (this._oldPads.length && this._oldPads[0]) {\r\n            this._initSuccess = true;\r\n        }\r\n    }\r\n    /**\r\n     * Sets the minimum gamepad configuration, for example {axis: 4, buttons: 4} means\r\n     * this game requires at minimum 4 axis inputs and 4 buttons, this is not restrictive\r\n     * all other controllers with more axis or buttons are valid as well. If no minimum\r\n     * configuration is set all pads are valid.\r\n     */\r\n    setMinimumGamepadConfiguration(config) {\r\n        this._enableAndUpdate(); // if config is used, implicitly enable\r\n        this._minimumConfiguration = config;\r\n    }\r\n    /**\r\n     * When implicitly enabled, set the enabled flag and run an update so information is updated\r\n     */\r\n    _enableAndUpdate() {\r\n        if (!this.enabled) {\r\n            this.enabled = true;\r\n            this.update();\r\n        }\r\n    }\r\n    /**\r\n     * Checks a navigator gamepad against the minimum configuration if present.\r\n     */\r\n    _isGamepadValid(pad) {\r\n        if (!this._minimumConfiguration) {\r\n            return true;\r\n        }\r\n        if (!pad) {\r\n            return false;\r\n        }\r\n        const axesLength = pad.axes.filter((value) => {\r\n            return typeof value !== undefined;\r\n        }).length;\r\n        const buttonLength = pad.buttons.filter((value) => {\r\n            return typeof value !== undefined;\r\n        }).length;\r\n        return axesLength >= this._minimumConfiguration.axis && buttonLength >= this._minimumConfiguration.buttons && pad.connected;\r\n    }\r\n    on(eventName, handler) {\r\n        this._enableAndUpdate(); // implicitly enable\r\n        super.on(eventName, handler);\r\n    }\r\n    off(eventName, handler) {\r\n        this._enableAndUpdate(); // implicitly enable\r\n        super.off(eventName, handler);\r\n    }\r\n    /**\r\n     * Updates Gamepad state and publishes Gamepad events\r\n     */\r\n    update() {\r\n        if (!this.enabled || !this.supported) {\r\n            return;\r\n        }\r\n        this.init();\r\n        const gamepads = this._navigator.getGamepads();\r\n        for (let i = 0; i < gamepads.length; i++) {\r\n            if (!gamepads[i]) {\r\n                const gamepad = this.at(i);\r\n                // If was connected, but now isn't emit the disconnect event\r\n                if (gamepad.connected) {\r\n                    this.eventDispatcher.emit('disconnect', new GamepadDisconnectEvent(i, gamepad));\r\n                }\r\n                // Reset connection status\r\n                gamepad.connected = false;\r\n                continue;\r\n            }\r\n            else {\r\n                if (!this.at(i).connected && this._isGamepadValid(gamepads[i])) {\r\n                    this.eventDispatcher.emit('connect', new GamepadConnectEvent(i, this.at(i)));\r\n                }\r\n                // Set connection status\r\n                this.at(i).connected = true;\r\n            }\r\n            // Only supported in Chrome\r\n            if (gamepads[i].timestamp && gamepads[i].timestamp === this._gamePadTimeStamps[i]) {\r\n                continue;\r\n            }\r\n            this._gamePadTimeStamps[i] = gamepads[i].timestamp;\r\n            // Add reference to navigator gamepad\r\n            this.at(i).navigatorGamepad = gamepads[i];\r\n            // Buttons\r\n            let b, bi, a, ai, value;\r\n            for (b in Buttons) {\r\n                bi = Buttons[b];\r\n                if (typeof bi === 'number') {\r\n                    if (gamepads[i].buttons[bi]) {\r\n                        value = gamepads[i].buttons[bi].value;\r\n                        if (value !== this._oldPads[i].getButton(bi)) {\r\n                            if (gamepads[i].buttons[bi].pressed) {\r\n                                this.at(i).updateButton(bi, value);\r\n                                this.at(i).eventDispatcher.emit('button', new GamepadButtonEvent(bi, value, this.at(i)));\r\n                            }\r\n                            else {\r\n                                this.at(i).updateButton(bi, 0);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            // Axes\r\n            for (a in Axes) {\r\n                ai = Axes[a];\r\n                if (typeof ai === 'number') {\r\n                    value = gamepads[i].axes[ai];\r\n                    if (value !== this._oldPads[i].getAxes(ai)) {\r\n                        this.at(i).updateAxes(ai, value);\r\n                        this.at(i).eventDispatcher.emit('axis', new GamepadAxisEvent(ai, value, this.at(i)));\r\n                    }\r\n                }\r\n            }\r\n            this._oldPads[i] = this._clonePad(gamepads[i]);\r\n        }\r\n    }\r\n    /**\r\n     * Safely retrieves a Gamepad at a specific index and creates one if it doesn't yet exist\r\n     */\r\n    at(index) {\r\n        this._enableAndUpdate(); // implicitly enable gamepads when at() is called\r\n        if (index >= this._pads.length) {\r\n            // Ensure there is a pad to retrieve\r\n            for (let i = this._pads.length - 1, max = index; i < max; i++) {\r\n                this._pads.push(new Gamepad());\r\n                this._oldPads.push(new Gamepad());\r\n            }\r\n        }\r\n        return this._pads[index];\r\n    }\r\n    /**\r\n     * Returns a list of all valid gamepads that meet the minimum configuration requirement.\r\n     */\r\n    getValidGamepads() {\r\n        this._enableAndUpdate();\r\n        const result = [];\r\n        for (let i = 0; i < this._pads.length; i++) {\r\n            if (this._isGamepadValid(this.at(i).navigatorGamepad) && this.at(i).connected) {\r\n                result.push(this.at(i));\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Gets the number of connected gamepads\r\n     */\r\n    count() {\r\n        return this._pads.filter((p) => p.connected).length;\r\n    }\r\n    _clonePads(pads) {\r\n        const arr = [];\r\n        for (let i = 0, len = pads.length; i < len; i++) {\r\n            arr.push(this._clonePad(pads[i]));\r\n        }\r\n        return arr;\r\n    }\r\n    /**\r\n     * Fastest way to clone a known object is to do it yourself\r\n     */\r\n    _clonePad(pad) {\r\n        let i, len;\r\n        const clonedPad = new Gamepad();\r\n        if (!pad) {\r\n            return clonedPad;\r\n        }\r\n        for (i = 0, len = pad.buttons.length; i < len; i++) {\r\n            if (pad.buttons[i]) {\r\n                clonedPad.updateButton(i, pad.buttons[i].value);\r\n            }\r\n        }\r\n        for (i = 0, len = pad.axes.length; i < len; i++) {\r\n            clonedPad.updateAxes(i, pad.axes[i]);\r\n        }\r\n        return clonedPad;\r\n    }\r\n}\r\n/**\r\n * The minimum value an axis has to move before considering it a change\r\n */\r\nGamepads.MinAxisMoveThreshold = 0.05;\r\n/**\r\n * Gamepad holds state information for a connected controller. See [[Gamepads]]\r\n * for more information on handling controller input.\r\n */\r\nclass Gamepad extends Class {\r\n    constructor() {\r\n        super();\r\n        this.connected = false;\r\n        this._buttons = new Array(16);\r\n        this._axes = new Array(4);\r\n        for (let i = 0; i < this._buttons.length; i++) {\r\n            this._buttons[i] = 0;\r\n        }\r\n        for (let i = 0; i < this._axes.length; i++) {\r\n            this._axes[i] = 0;\r\n        }\r\n    }\r\n    /**\r\n     * Whether or not the given button is pressed\r\n     * @param button     The button to query\r\n     * @param threshold  The threshold over which the button is considered to be pressed\r\n     */\r\n    isButtonPressed(button, threshold = 1) {\r\n        return this._buttons[button] >= threshold;\r\n    }\r\n    /**\r\n     * Gets the given button value between 0 and 1\r\n     */\r\n    getButton(button) {\r\n        return this._buttons[button];\r\n    }\r\n    /**\r\n     * Gets the given axis value between -1 and 1. Values below\r\n     * [[MinAxisMoveThreshold]] are considered 0.\r\n     */\r\n    getAxes(axes) {\r\n        const value = this._axes[axes];\r\n        if (Math.abs(value) < Gamepads.MinAxisMoveThreshold) {\r\n            return 0;\r\n        }\r\n        else {\r\n            return value;\r\n        }\r\n    }\r\n    updateButton(buttonIndex, value) {\r\n        this._buttons[buttonIndex] = value;\r\n    }\r\n    updateAxes(axesIndex, value) {\r\n        this._axes[axesIndex] = value;\r\n    }\r\n}\r\n/**\r\n * Gamepad Buttons enumeration\r\n */\r\nvar Buttons;\r\n(function (Buttons) {\r\n    /**\r\n     * Face 1 button (e.g. A)\r\n     */\r\n    Buttons[Buttons[\"Face1\"] = 0] = \"Face1\";\r\n    /**\r\n     * Face 2 button (e.g. B)\r\n     */\r\n    Buttons[Buttons[\"Face2\"] = 1] = \"Face2\";\r\n    /**\r\n     * Face 3 button (e.g. X)\r\n     */\r\n    Buttons[Buttons[\"Face3\"] = 2] = \"Face3\";\r\n    /**\r\n     * Face 4 button (e.g. Y)\r\n     */\r\n    Buttons[Buttons[\"Face4\"] = 3] = \"Face4\";\r\n    /**\r\n     * Left bumper button\r\n     */\r\n    Buttons[Buttons[\"LeftBumper\"] = 4] = \"LeftBumper\";\r\n    /**\r\n     * Right bumper button\r\n     */\r\n    Buttons[Buttons[\"RightBumper\"] = 5] = \"RightBumper\";\r\n    /**\r\n     * Left trigger button\r\n     */\r\n    Buttons[Buttons[\"LeftTrigger\"] = 6] = \"LeftTrigger\";\r\n    /**\r\n     * Right trigger button\r\n     */\r\n    Buttons[Buttons[\"RightTrigger\"] = 7] = \"RightTrigger\";\r\n    /**\r\n     * Select button\r\n     */\r\n    Buttons[Buttons[\"Select\"] = 8] = \"Select\";\r\n    /**\r\n     * Start button\r\n     */\r\n    Buttons[Buttons[\"Start\"] = 9] = \"Start\";\r\n    /**\r\n     * Left analog stick press (e.g. L3)\r\n     */\r\n    Buttons[Buttons[\"LeftStick\"] = 10] = \"LeftStick\";\r\n    /**\r\n     * Right analog stick press (e.g. R3)\r\n     */\r\n    Buttons[Buttons[\"RightStick\"] = 11] = \"RightStick\";\r\n    /**\r\n     * D-pad up\r\n     */\r\n    Buttons[Buttons[\"DpadUp\"] = 12] = \"DpadUp\";\r\n    /**\r\n     * D-pad down\r\n     */\r\n    Buttons[Buttons[\"DpadDown\"] = 13] = \"DpadDown\";\r\n    /**\r\n     * D-pad left\r\n     */\r\n    Buttons[Buttons[\"DpadLeft\"] = 14] = \"DpadLeft\";\r\n    /**\r\n     * D-pad right\r\n     */\r\n    Buttons[Buttons[\"DpadRight\"] = 15] = \"DpadRight\";\r\n})(Buttons || (Buttons = {}));\r\n/**\r\n * Gamepad Axes enumeration\r\n */\r\nvar Axes;\r\n(function (Axes) {\r\n    /**\r\n     * Left analogue stick X direction\r\n     */\r\n    Axes[Axes[\"LeftStickX\"] = 0] = \"LeftStickX\";\r\n    /**\r\n     * Left analogue stick Y direction\r\n     */\r\n    Axes[Axes[\"LeftStickY\"] = 1] = \"LeftStickY\";\r\n    /**\r\n     * Right analogue stick X direction\r\n     */\r\n    Axes[Axes[\"RightStickX\"] = 2] = \"RightStickX\";\r\n    /**\r\n     * Right analogue stick Y direction\r\n     */\r\n    Axes[Axes[\"RightStickY\"] = 3] = \"RightStickY\";\r\n})(Axes || (Axes = {}));\r\n\n;// CONCATENATED MODULE: ./Util/Browser.ts\nclass BrowserComponent {\r\n    constructor(nativeComponent) {\r\n        this.nativeComponent = nativeComponent;\r\n        this._paused = false;\r\n        this._nativeHandlers = {};\r\n    }\r\n    on(eventName, handler) {\r\n        if (this._nativeHandlers[eventName]) {\r\n            this.off(eventName, this._nativeHandlers[eventName]);\r\n        }\r\n        this._nativeHandlers[eventName] = this._decorate(handler);\r\n        this.nativeComponent.addEventListener(eventName, this._nativeHandlers[eventName]);\r\n    }\r\n    off(eventName, handler) {\r\n        if (!handler) {\r\n            handler = this._nativeHandlers[eventName];\r\n        }\r\n        this.nativeComponent.removeEventListener(eventName, handler);\r\n        this._nativeHandlers[eventName] = null;\r\n    }\r\n    _decorate(handler) {\r\n        return (evt) => {\r\n            if (!this._paused) {\r\n                handler(evt);\r\n            }\r\n        };\r\n    }\r\n    pause() {\r\n        this._paused = true;\r\n    }\r\n    resume() {\r\n        this._paused = false;\r\n    }\r\n    clear() {\r\n        for (const event in this._nativeHandlers) {\r\n            this.off(event);\r\n        }\r\n    }\r\n}\r\nclass BrowserEvents {\r\n    constructor(_windowGlobal, _documentGlobal) {\r\n        this._windowGlobal = _windowGlobal;\r\n        this._documentGlobal = _documentGlobal;\r\n        this._windowComponent = new BrowserComponent(this._windowGlobal);\r\n        this._documentComponent = new BrowserComponent(this._documentGlobal);\r\n    }\r\n    get window() {\r\n        return this._windowComponent;\r\n    }\r\n    get document() {\r\n        return this._documentComponent;\r\n    }\r\n    pause() {\r\n        this.window.pause();\r\n        this.document.pause();\r\n    }\r\n    resume() {\r\n        this.window.resume();\r\n        this.document.resume();\r\n    }\r\n    clear() {\r\n        this.window.clear();\r\n        this.document.clear();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/ExcaliburGraphicsContext2DCanvas.ts\n\r\n\r\n\r\n\r\nclass ExcaliburGraphicsContext2DCanvasDebug {\r\n    constructor(_ex) {\r\n        this._ex = _ex;\r\n        this._debugText = new DebugText();\r\n    }\r\n    /**\r\n     * Draw a debug rectangle to the context\r\n     * @param x\r\n     * @param y\r\n     * @param width\r\n     * @param height\r\n     */\r\n    drawRect(x, y, width, height) {\r\n        this._ex.__ctx.save();\r\n        this._ex.__ctx.strokeStyle = 'red';\r\n        this._ex.__ctx.strokeRect(this._ex.snapToPixel ? ~~x : x, this._ex.snapToPixel ? ~~y : y, this._ex.snapToPixel ? ~~width : width, this._ex.snapToPixel ? ~~height : height);\r\n        this._ex.__ctx.restore();\r\n    }\r\n    drawLine(start, end, lineOptions = { color: Color.Black }) {\r\n        this._ex.__ctx.save();\r\n        this._ex.__ctx.beginPath();\r\n        this._ex.__ctx.strokeStyle = lineOptions.color.toString();\r\n        this._ex.__ctx.moveTo(this._ex.snapToPixel ? ~~start.x : start.x, this._ex.snapToPixel ? ~~start.y : start.y);\r\n        this._ex.__ctx.lineTo(this._ex.snapToPixel ? ~~end.x : end.x, this._ex.snapToPixel ? ~~end.y : end.y);\r\n        this._ex.__ctx.lineWidth = 2;\r\n        this._ex.__ctx.stroke();\r\n        this._ex.__ctx.closePath();\r\n        this._ex.__ctx.restore();\r\n    }\r\n    drawPoint(point, pointOptions = { color: Color.Black, size: 5 }) {\r\n        this._ex.__ctx.save();\r\n        this._ex.__ctx.beginPath();\r\n        this._ex.__ctx.fillStyle = pointOptions.color.toString();\r\n        this._ex.__ctx.arc(this._ex.snapToPixel ? ~~point.x : point.x, this._ex.snapToPixel ? ~~point.y : point.y, pointOptions.size, 0, Math.PI * 2);\r\n        this._ex.__ctx.fill();\r\n        this._ex.__ctx.closePath();\r\n        this._ex.__ctx.restore();\r\n    }\r\n    drawText(text, pos) {\r\n        this._debugText.write(this._ex, text, pos);\r\n    }\r\n}\r\nclass ExcaliburGraphicsContext2DCanvas {\r\n    constructor(options) {\r\n        this.backgroundColor = Color.ExcaliburBlue;\r\n        this._state = new StateStack();\r\n        this.snapToPixel = true;\r\n        this.debug = new ExcaliburGraphicsContext2DCanvasDebug(this);\r\n        const { canvasElement, enableTransparency, snapToPixel, smoothing, backgroundColor } = options;\r\n        this.__ctx = canvasElement.getContext('2d', {\r\n            alpha: enableTransparency !== null && enableTransparency !== void 0 ? enableTransparency : true\r\n        });\r\n        this.backgroundColor = backgroundColor !== null && backgroundColor !== void 0 ? backgroundColor : this.backgroundColor;\r\n        this.snapToPixel = snapToPixel !== null && snapToPixel !== void 0 ? snapToPixel : this.snapToPixel;\r\n        this.smoothing = smoothing !== null && smoothing !== void 0 ? smoothing : this.smoothing;\r\n    }\r\n    get width() {\r\n        return this.__ctx.canvas.width;\r\n    }\r\n    get height() {\r\n        return this.__ctx.canvas.height;\r\n    }\r\n    get opacity() {\r\n        return this._state.current.opacity;\r\n    }\r\n    set opacity(value) {\r\n        this._state.current.opacity = value;\r\n    }\r\n    get smoothing() {\r\n        return this.__ctx.imageSmoothingEnabled;\r\n    }\r\n    set smoothing(value) {\r\n        this.__ctx.imageSmoothingEnabled = value;\r\n    }\r\n    resetTransform() {\r\n        this.__ctx.resetTransform();\r\n    }\r\n    updateViewport(_resolution) {\r\n        // pass\r\n    }\r\n    drawImage(image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight) {\r\n        if (swidth === 0 || sheight === 0) {\r\n            return; // zero dimension dest exit early\r\n        }\r\n        else if (dwidth === 0 || dheight === 0) {\r\n            return; // zero dimension dest exit early\r\n        }\r\n        else if (image.width === 0 || image.height === 0) {\r\n            return; // zero dimension source exit early\r\n        }\r\n        this.__ctx.globalAlpha = this.opacity;\r\n        const args = [image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight]\r\n            .filter((a) => a !== undefined)\r\n            .map((a) => (typeof a === 'number' && this.snapToPixel ? ~~a : a));\r\n        this.__ctx.drawImage.apply(this.__ctx, args);\r\n        GraphicsDiagnostics.DrawCallCount++;\r\n        GraphicsDiagnostics.DrawnImagesCount = 1;\r\n    }\r\n    drawLine(start, end, color, thickness = 1) {\r\n        this.__ctx.save();\r\n        this.__ctx.beginPath();\r\n        this.__ctx.strokeStyle = color.toString();\r\n        this.__ctx.moveTo(this.snapToPixel ? ~~start.x : start.x, this.snapToPixel ? ~~start.y : start.y);\r\n        this.__ctx.lineTo(this.snapToPixel ? ~~end.x : end.x, this.snapToPixel ? ~~end.y : end.y);\r\n        this.__ctx.lineWidth = thickness;\r\n        this.__ctx.stroke();\r\n        this.__ctx.closePath();\r\n        this.__ctx.restore();\r\n    }\r\n    drawRectangle(pos, width, height, color) {\r\n        this.__ctx.save();\r\n        this.__ctx.fillStyle = color.toString();\r\n        this.__ctx.fillRect(this.snapToPixel ? ~~pos.x : pos.x, this.snapToPixel ? ~~pos.y : pos.y, this.snapToPixel ? ~~width : width, this.snapToPixel ? ~~height : height);\r\n        this.__ctx.restore();\r\n    }\r\n    drawCircle(pos, radius, color, stroke, thickness) {\r\n        this.__ctx.save();\r\n        this.__ctx.beginPath();\r\n        if (stroke) {\r\n            this.__ctx.strokeStyle = stroke.toString();\r\n        }\r\n        if (thickness) {\r\n            this.__ctx.lineWidth = thickness;\r\n        }\r\n        this.__ctx.fillStyle = color.toString();\r\n        this.__ctx.arc(this.snapToPixel ? ~~pos.x : pos.x, this.snapToPixel ? ~~pos.y : pos.y, radius, 0, Math.PI * 2);\r\n        this.__ctx.fill();\r\n        if (stroke) {\r\n            this.__ctx.stroke();\r\n        }\r\n        this.__ctx.closePath();\r\n        this.__ctx.restore();\r\n    }\r\n    /**\r\n     * Save the current state of the canvas to the stack (transforms and opacity)\r\n     */\r\n    save() {\r\n        this.__ctx.save();\r\n    }\r\n    /**\r\n     * Restore the state of the canvas from the stack\r\n     */\r\n    restore() {\r\n        this.__ctx.restore();\r\n    }\r\n    /**\r\n     * Translate the origin of the context by an x and y\r\n     * @param x\r\n     * @param y\r\n     */\r\n    translate(x, y) {\r\n        this.__ctx.translate(this.snapToPixel ? ~~x : x, this.snapToPixel ? ~~y : y);\r\n    }\r\n    /**\r\n     * Rotate the context about the current origin\r\n     */\r\n    rotate(angle) {\r\n        this.__ctx.rotate(angle);\r\n    }\r\n    /**\r\n     * Scale the context by an x and y factor\r\n     * @param x\r\n     * @param y\r\n     */\r\n    scale(x, y) {\r\n        this.__ctx.scale(x, y);\r\n    }\r\n    getTransform() {\r\n        throw new Error('Not implemented');\r\n    }\r\n    multiply(_m) {\r\n        this.__ctx.setTransform(this.__ctx.getTransform().multiply(_m.toDOMMatrix()));\r\n    }\r\n    addPostProcessor(_postprocessor) {\r\n        throw Error('Not implemented');\r\n    }\r\n    removePostProcessor(_postprocessor) {\r\n        throw Error('Not implemented');\r\n    }\r\n    clearPostProcessors() {\r\n        throw Error('Not implemented');\r\n    }\r\n    beginDrawLifecycle() {\r\n        // pass\r\n    }\r\n    endDrawLifecycle() {\r\n        // pass\r\n    }\r\n    clear() {\r\n        // Clear frame\r\n        this.__ctx.clearRect(0, 0, this.width, this.height);\r\n        this.__ctx.fillStyle = this.backgroundColor.toString();\r\n        this.__ctx.fillRect(0, 0, this.width, this.height);\r\n        GraphicsDiagnostics.clear();\r\n    }\r\n    /**\r\n     * Flushes the batched draw calls to the screen\r\n     */\r\n    flush() {\r\n        // pass\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/global-coordinates.ts\n\r\nclass GlobalCoordinates {\r\n    constructor(worldPos, pagePos, screenPos) {\r\n        this.worldPos = worldPos;\r\n        this.pagePos = pagePos;\r\n        this.screenPos = screenPos;\r\n    }\r\n    static fromPagePosition(xOrPos, yOrEngine, engineOrUndefined) {\r\n        let pageX;\r\n        let pageY;\r\n        let pagePos;\r\n        let engine;\r\n        if (arguments.length === 3) {\r\n            pageX = xOrPos;\r\n            pageY = yOrEngine;\r\n            pagePos = new Vector(pageX, pageY);\r\n            engine = engineOrUndefined;\r\n        }\r\n        else {\r\n            pagePos = xOrPos;\r\n            pageX = pagePos.x;\r\n            pageY = pagePos.y;\r\n            engine = yOrEngine;\r\n        }\r\n        const screenPos = engine.screen.pageToScreenCoordinates(pagePos);\r\n        const worldPos = engine.screen.screenToWorldCoordinates(screenPos);\r\n        return new GlobalCoordinates(worldPos, pagePos, screenPos);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Input/PointerEvent.ts\nclass PointerEvent {\r\n    constructor(type, pointerId, button, pointerType, coordinates, nativeEvent) {\r\n        this.type = type;\r\n        this.pointerId = pointerId;\r\n        this.button = button;\r\n        this.pointerType = pointerType;\r\n        this.coordinates = coordinates;\r\n        this.nativeEvent = nativeEvent;\r\n        this.active = true;\r\n    }\r\n    cancel() {\r\n        this.active = false;\r\n    }\r\n    get pagePos() {\r\n        return this.coordinates.pagePos;\r\n    }\r\n    get screenPos() {\r\n        return this.coordinates.screenPos;\r\n    }\r\n    get worldPos() {\r\n        return this.coordinates.worldPos;\r\n    }\r\n    ;\r\n}\r\n\n;// CONCATENATED MODULE: ./Input/WheelEvent.ts\nclass WheelEvent {\r\n    constructor(x, y, pageX, pageY, screenX, screenY, index, deltaX, deltaY, deltaZ, deltaMode, ev) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.pageX = pageX;\r\n        this.pageY = pageY;\r\n        this.screenX = screenX;\r\n        this.screenY = screenY;\r\n        this.index = index;\r\n        this.deltaX = deltaX;\r\n        this.deltaY = deltaY;\r\n        this.deltaZ = deltaZ;\r\n        this.deltaMode = deltaMode;\r\n        this.ev = ev;\r\n        this.active = true;\r\n    }\r\n    cancel() {\r\n        this.active = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Input/PointerAbstraction.ts\n\r\n\r\nclass PointerAbstraction extends Class {\r\n    constructor() {\r\n        super();\r\n        /**\r\n         * The last position on the document this pointer was at. Can be `null` if pointer was never active.\r\n         */\r\n        this.lastPagePos = Vector.Zero;\r\n        /**\r\n         * The last position on the screen this pointer was at. Can be `null` if pointer was never active.\r\n         */\r\n        this.lastScreenPos = Vector.Zero;\r\n        /**\r\n         * The last position in the game world coordinates this pointer was at. Can be `null` if pointer was never active.\r\n         */\r\n        this.lastWorldPos = Vector.Zero;\r\n        this._onPointerMove = (ev) => {\r\n            this.lastPagePos = new Vector(ev.pagePos.x, ev.pagePos.y);\r\n            this.lastScreenPos = new Vector(ev.screenPos.x, ev.screenPos.y);\r\n            this.lastWorldPos = new Vector(ev.worldPos.x, ev.worldPos.y);\r\n        };\r\n        this._onPointerDown = (ev) => {\r\n            this.lastPagePos = new Vector(ev.pagePos.x, ev.pagePos.y);\r\n            this.lastScreenPos = new Vector(ev.screenPos.x, ev.screenPos.y);\r\n            this.lastWorldPos = new Vector(ev.worldPos.x, ev.worldPos.y);\r\n        };\r\n        this.on('move', this._onPointerMove);\r\n        this.on('down', this._onPointerDown);\r\n    }\r\n    on(event, handler) {\r\n        super.on(event, handler);\r\n    }\r\n    once(event, handler) {\r\n        super.once(event, handler);\r\n    }\r\n    off(event, handler) {\r\n        super.off(event, handler);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Input/WheelDeltaMode.ts\nvar WheelDeltaMode;\r\n(function (WheelDeltaMode) {\r\n    WheelDeltaMode[\"Pixel\"] = \"Pixel\";\r\n    WheelDeltaMode[\"Line\"] = \"Line\";\r\n    WheelDeltaMode[\"Page\"] = \"Page\";\r\n})(WheelDeltaMode || (WheelDeltaMode = {}));\r\n\n;// CONCATENATED MODULE: ./Input/NativePointerButton.ts\n/**\r\n * Native browser button enumeration\r\n */\r\nvar NativePointerButton;\r\n(function (NativePointerButton) {\r\n    NativePointerButton[NativePointerButton[\"NoButton\"] = -1] = \"NoButton\";\r\n    NativePointerButton[NativePointerButton[\"Left\"] = 0] = \"Left\";\r\n    NativePointerButton[NativePointerButton[\"Middle\"] = 1] = \"Middle\";\r\n    NativePointerButton[NativePointerButton[\"Right\"] = 2] = \"Right\";\r\n    NativePointerButton[NativePointerButton[\"Unknown\"] = 3] = \"Unknown\";\r\n})(NativePointerButton || (NativePointerButton = {}));\r\n\n;// CONCATENATED MODULE: ./Input/PointerButton.ts\n/**\r\n * The mouse button being pressed.\r\n */\r\nvar PointerButton;\r\n(function (PointerButton) {\r\n    PointerButton[\"Left\"] = \"Left\";\r\n    PointerButton[\"Middle\"] = \"Middle\";\r\n    PointerButton[\"Right\"] = \"Right\";\r\n    PointerButton[\"Unknown\"] = \"Unknown\";\r\n    PointerButton[\"NoButton\"] = \"NoButton\";\r\n})(PointerButton || (PointerButton = {}));\r\n\n;// CONCATENATED MODULE: ./Input/PointerType.ts\n/**\r\n * The type of pointer for a [[PointerEvent]].\r\n */\r\nvar PointerType;\r\n(function (PointerType) {\r\n    PointerType[\"Touch\"] = \"Touch\";\r\n    PointerType[\"Mouse\"] = \"Mouse\";\r\n    PointerType[\"Pen\"] = \"Pen\";\r\n    PointerType[\"Unknown\"] = \"Unknown\";\r\n})(PointerType || (PointerType = {}));\r\n\n;// CONCATENATED MODULE: ./Input/PointerEventReceiver.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Is this event a native touch event?\r\n */\r\nfunction isTouchEvent(value) {\r\n    // Guard for Safari <= 13.1\r\n    return globalThis.TouchEvent && value instanceof globalThis.TouchEvent;\r\n}\r\n/**\r\n * Is this event a native pointer event\r\n */\r\nfunction isPointerEvent(value) {\r\n    // Guard for Safari <= 13.1\r\n    return globalThis.PointerEvent && value instanceof globalThis.PointerEvent;\r\n}\r\n/**\r\n * The PointerEventProcessor is responsible for collecting all the events from the canvas and transforming them into GlobalCoordinates\r\n */\r\nclass PointerEventReceiver extends Class {\r\n    constructor(target, engine) {\r\n        super();\r\n        this.target = target;\r\n        this.engine = engine;\r\n        this.primary = new PointerAbstraction();\r\n        this._activeNativePointerIdsToNormalized = new Map();\r\n        this.lastFramePointerCoords = new Map();\r\n        this.currentFramePointerCoords = new Map();\r\n        this.currentFramePointerDown = new Map();\r\n        this.lastFramePointerDown = new Map();\r\n        this.currentFrameDown = [];\r\n        this.currentFrameUp = [];\r\n        this.currentFrameMove = [];\r\n        this.currentFrameCancel = [];\r\n        this.currentFrameWheel = [];\r\n        this._pointers = [this.primary];\r\n        this._boundHandle = this._handle.bind(this);\r\n        this._boundWheel = this._handleWheel.bind(this);\r\n    }\r\n    /**\r\n     * Locates a specific pointer by id, creates it if it doesn't exist\r\n     * @param index\r\n     */\r\n    at(index) {\r\n        if (index >= this._pointers.length) {\r\n            // Ensure there is a pointer to retrieve\r\n            for (let i = this._pointers.length - 1, max = index; i < max; i++) {\r\n                this._pointers.push(new PointerAbstraction());\r\n            }\r\n        }\r\n        return this._pointers[index];\r\n    }\r\n    /**\r\n     * The number of pointers currently being tracked by excalibur\r\n     */\r\n    count() {\r\n        return this._pointers.length;\r\n    }\r\n    /**\r\n     * Is the specified pointer id down this frame\r\n     * @param pointerId\r\n     */\r\n    isDown(pointerId) {\r\n        var _a;\r\n        return (_a = this.currentFramePointerDown.get(pointerId)) !== null && _a !== void 0 ? _a : false;\r\n    }\r\n    /**\r\n     * Was the specified pointer id down last frame\r\n     * @param pointerId\r\n     */\r\n    wasDown(pointerId) {\r\n        var _a;\r\n        return (_a = this.lastFramePointerDown.get(pointerId)) !== null && _a !== void 0 ? _a : false;\r\n    }\r\n    /**\r\n     * Whether the Pointer is currently dragging.\r\n     */\r\n    isDragging(pointerId) {\r\n        return this.isDown(pointerId);\r\n    }\r\n    /**\r\n     * Whether the Pointer just started dragging.\r\n     */\r\n    isDragStart(pointerId) {\r\n        return this.isDown(pointerId) && !this.wasDown(pointerId);\r\n    }\r\n    /**\r\n     * Whether the Pointer just ended dragging.\r\n     */\r\n    isDragEnd(pointerId) {\r\n        return !this.isDown(pointerId) && this.wasDown(pointerId);\r\n    }\r\n    on(event, handler) {\r\n        super.on(event, handler);\r\n    }\r\n    once(event, handler) {\r\n        super.once(event, handler);\r\n    }\r\n    off(event, handler) {\r\n        super.off(event, handler);\r\n    }\r\n    /**\r\n     * Called internally by excalibur\r\n     *\r\n     * Updates the current frame pointer info and emits raw pointer events\r\n     *\r\n     * This does not emit events to entities, see PointerSystem\r\n     */\r\n    update() {\r\n        this.lastFramePointerDown = new Map(this.currentFramePointerDown);\r\n        this.lastFramePointerCoords = new Map(this.currentFramePointerCoords);\r\n        for (const event of this.currentFrameDown) {\r\n            this.emit('down', event);\r\n            const pointer = this.at(event.pointerId);\r\n            pointer.emit('down', event);\r\n            this.primary.emit('pointerdown', event);\r\n        }\r\n        for (const event of this.currentFrameUp) {\r\n            this.emit('up', event);\r\n            const pointer = this.at(event.pointerId);\r\n            pointer.emit('up', event);\r\n        }\r\n        for (const event of this.currentFrameMove) {\r\n            this.emit('move', event);\r\n            const pointer = this.at(event.pointerId);\r\n            pointer.emit('move', event);\r\n        }\r\n        for (const event of this.currentFrameCancel) {\r\n            this.emit('cancel', event);\r\n            const pointer = this.at(event.pointerId);\r\n            pointer.emit('cancel', event);\r\n        }\r\n        for (const event of this.currentFrameWheel) {\r\n            this.emit('wheel', event);\r\n            this.primary.emit('pointerwheel', event);\r\n        }\r\n    }\r\n    /**\r\n     * Clears the current frame event and pointer data\r\n     */\r\n    clear() {\r\n        for (const event of this.currentFrameUp) {\r\n            this.currentFramePointerCoords.delete(event.pointerId);\r\n            const ids = this._activeNativePointerIdsToNormalized.entries();\r\n            for (const [native, normalized] of ids) {\r\n                if (normalized === event.pointerId) {\r\n                    this._activeNativePointerIdsToNormalized.delete(native);\r\n                }\r\n            }\r\n        }\r\n        this.currentFrameDown.length = 0;\r\n        this.currentFrameUp.length = 0;\r\n        this.currentFrameMove.length = 0;\r\n        this.currentFrameCancel.length = 0;\r\n        this.currentFrameWheel.length = 0;\r\n    }\r\n    /**\r\n     * Initializes the pointer event receiver so that it can start listening to native\r\n     * browser events.\r\n     */\r\n    init() {\r\n        // Disabling the touch action avoids browser/platform gestures from firing on the canvas\r\n        this.engine.canvas.style.touchAction = 'none';\r\n        // Preferred pointer events\r\n        if (window.PointerEvent) {\r\n            this.target.addEventListener('pointerdown', this._boundHandle);\r\n            this.target.addEventListener('pointerup', this._boundHandle);\r\n            this.target.addEventListener('pointermove', this._boundHandle);\r\n            this.target.addEventListener('pointercancel', this._boundHandle);\r\n        }\r\n        else {\r\n            // Touch Events\r\n            this.target.addEventListener('touchstart', this._boundHandle);\r\n            this.target.addEventListener('touchend', this._boundHandle);\r\n            this.target.addEventListener('touchmove', this._boundHandle);\r\n            this.target.addEventListener('touchcancel', this._boundHandle);\r\n            // Mouse Events\r\n            this.target.addEventListener('mousedown', this._boundHandle);\r\n            this.target.addEventListener('mouseup', this._boundHandle);\r\n            this.target.addEventListener('mousemove', this._boundHandle);\r\n        }\r\n        // MDN MouseWheelEvent\r\n        const wheelOptions = {\r\n            passive: !(this.engine.pageScrollPreventionMode === ScrollPreventionMode.All ||\r\n                this.engine.pageScrollPreventionMode === ScrollPreventionMode.Canvas)\r\n        };\r\n        if ('onwheel' in document.createElement('div')) {\r\n            // Modern Browsers\r\n            this.target.addEventListener('wheel', this._boundWheel, wheelOptions);\r\n        }\r\n        else if (document.onmousewheel !== undefined) {\r\n            // Webkit and IE\r\n            this.target.addEventListener('mousewheel', this._boundWheel, wheelOptions);\r\n        }\r\n        else {\r\n            // Remaining browser and older Firefox\r\n            this.target.addEventListener('MozMousePixelScroll', this._boundWheel, wheelOptions);\r\n        }\r\n    }\r\n    detach() {\r\n        // Preferred pointer events\r\n        if (window.PointerEvent) {\r\n            this.target.removeEventListener('pointerdown', this._boundHandle);\r\n            this.target.removeEventListener('pointerup', this._boundHandle);\r\n            this.target.removeEventListener('pointermove', this._boundHandle);\r\n            this.target.removeEventListener('pointercancel', this._boundHandle);\r\n        }\r\n        else {\r\n            // Touch Events\r\n            this.target.removeEventListener('touchstart', this._boundHandle);\r\n            this.target.removeEventListener('touchend', this._boundHandle);\r\n            this.target.removeEventListener('touchmove', this._boundHandle);\r\n            this.target.removeEventListener('touchcancel', this._boundHandle);\r\n            // Mouse Events\r\n            this.target.removeEventListener('mousedown', this._boundHandle);\r\n            this.target.removeEventListener('mouseup', this._boundHandle);\r\n            this.target.removeEventListener('mousemove', this._boundHandle);\r\n        }\r\n        if ('onwheel' in document.createElement('div')) {\r\n            // Modern Browsers\r\n            this.target.removeEventListener('wheel', this._boundWheel);\r\n        }\r\n        else if (document.onmousewheel !== undefined) {\r\n            // Webkit and IE\r\n            this.target.addEventListener('mousewheel', this._boundWheel);\r\n        }\r\n        else {\r\n            // Remaining browser and older Firefox\r\n            this.target.addEventListener('MozMousePixelScroll', this._boundWheel);\r\n        }\r\n    }\r\n    /**\r\n     * Take native pointer id and map it to index in active pointers\r\n     * @param nativePointerId\r\n     */\r\n    _normalizePointerId(nativePointerId) {\r\n        // Add to the the native pointer set id\r\n        this._activeNativePointerIdsToNormalized.set(nativePointerId, -1);\r\n        // Native pointer ids in ascending order\r\n        const currentPointerIds = Array.from(this._activeNativePointerIdsToNormalized.keys()).sort((a, b) => a - b);\r\n        // The index into sorted ids will be the new id, will always have an id\r\n        const id = currentPointerIds.findIndex(p => p === nativePointerId);\r\n        // Save the mapping so we can reverse it later\r\n        this._activeNativePointerIdsToNormalized.set(nativePointerId, id);\r\n        // ignore pointer because game isn't watching\r\n        return id;\r\n    }\r\n    /**\r\n     * Responsible for handling and parsing pointer events\r\n     */\r\n    _handle(ev) {\r\n        ev.preventDefault();\r\n        const eventCoords = new Map();\r\n        let button;\r\n        let pointerType;\r\n        if (isTouchEvent(ev)) {\r\n            button = PointerButton.Unknown;\r\n            pointerType = PointerType.Touch;\r\n            // https://developer.mozilla.org/en-US/docs/Web/API/TouchEvent\r\n            for (let i = 0; i < ev.changedTouches.length; i++) {\r\n                const touch = ev.changedTouches[i];\r\n                const coordinates = GlobalCoordinates.fromPagePosition(touch.pageX, touch.pageY, this.engine);\r\n                const nativePointerId = i + 1;\r\n                const pointerId = this._normalizePointerId(nativePointerId);\r\n                this.currentFramePointerCoords.set(pointerId, coordinates);\r\n                eventCoords.set(pointerId, coordinates);\r\n            }\r\n        }\r\n        else {\r\n            button = this._nativeButtonToPointerButton(ev.button);\r\n            pointerType = PointerType.Mouse;\r\n            const coordinates = GlobalCoordinates.fromPagePosition(ev.pageX, ev.pageY, this.engine);\r\n            let nativePointerId = 1;\r\n            if (isPointerEvent(ev)) {\r\n                nativePointerId = ev.pointerId;\r\n                pointerType = this._stringToPointerType(ev.pointerType);\r\n            }\r\n            const pointerId = this._normalizePointerId(nativePointerId);\r\n            this.currentFramePointerCoords.set(pointerId, coordinates);\r\n            eventCoords.set(pointerId, coordinates);\r\n        }\r\n        for (const [pointerId, coord] of eventCoords.entries()) {\r\n            switch (ev.type) {\r\n                case 'mousedown':\r\n                case 'pointerdown':\r\n                case 'touchstart':\r\n                    this.currentFrameDown.push(new PointerEvent('down', pointerId, button, pointerType, coord, ev));\r\n                    this.currentFramePointerDown.set(pointerId, true);\r\n                    break;\r\n                case 'mouseup':\r\n                case 'pointerup':\r\n                case 'touchend':\r\n                    this.currentFrameUp.push(new PointerEvent('up', pointerId, button, pointerType, coord, ev));\r\n                    this.currentFramePointerDown.set(pointerId, false);\r\n                    break;\r\n                case 'mousemove':\r\n                case 'pointermove':\r\n                case 'touchmove':\r\n                    this.currentFrameMove.push(new PointerEvent('move', pointerId, button, pointerType, coord, ev));\r\n                    break;\r\n                case 'touchcancel':\r\n                case 'pointercancel':\r\n                    this.currentFrameCancel.push(new PointerEvent('cancel', pointerId, button, pointerType, coord, ev));\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n    _handleWheel(ev) {\r\n        // Should we prevent page scroll because of this event\r\n        if (this.engine.pageScrollPreventionMode === ScrollPreventionMode.All ||\r\n            (this.engine.pageScrollPreventionMode === ScrollPreventionMode.Canvas && ev.target === this.engine.canvas)) {\r\n            ev.preventDefault();\r\n        }\r\n        const screen = this.engine.screen.pageToScreenCoordinates(vec(ev.pageX, ev.pageY));\r\n        const world = this.engine.screen.screenToWorldCoordinates(screen);\r\n        /**\r\n         * A constant used to normalize wheel events across different browsers\r\n         *\r\n         * This normalization factor is pulled from\r\n         * https://developer.mozilla.org/en-US/docs/Web/Events/wheel#Listening_to_this_event_across_browser\r\n         */\r\n        const ScrollWheelNormalizationFactor = -1 / 40;\r\n        const deltaX = ev.deltaX || ev.wheelDeltaX * ScrollWheelNormalizationFactor || 0;\r\n        const deltaY = ev.deltaY || ev.wheelDeltaY * ScrollWheelNormalizationFactor || ev.wheelDelta * ScrollWheelNormalizationFactor || ev.detail || 0;\r\n        const deltaZ = ev.deltaZ || 0;\r\n        let deltaMode = WheelDeltaMode.Pixel;\r\n        if (ev.deltaMode) {\r\n            if (ev.deltaMode === 1) {\r\n                deltaMode = WheelDeltaMode.Line;\r\n            }\r\n            else if (ev.deltaMode === 2) {\r\n                deltaMode = WheelDeltaMode.Page;\r\n            }\r\n        }\r\n        const we = new WheelEvent(world.x, world.y, ev.pageX, ev.pageY, screen.x, screen.y, 0, deltaX, deltaY, deltaZ, deltaMode, ev);\r\n        this.currentFrameWheel.push(we);\r\n    }\r\n    /**\r\n     * Triggers an excalibur pointer event in a world space pos\r\n     *\r\n     * Useful for testing pointers in excalibur\r\n     * @param type\r\n     * @param pos\r\n     */\r\n    triggerEvent(type, pos) {\r\n        const page = this.engine.screen.worldToPageCoordinates(pos);\r\n        // Send an event to the event receiver\r\n        if (window.PointerEvent) {\r\n            this._handle(new window.PointerEvent('pointer' + type, {\r\n                pointerId: 0,\r\n                clientX: page.x,\r\n                clientY: page.y\r\n            }));\r\n        }\r\n        else {\r\n            // Safari hack\r\n            this._handle(new window.MouseEvent('mouse' + type, {\r\n                clientX: page.x,\r\n                clientY: page.y\r\n            }));\r\n        }\r\n        // Force update pointer system\r\n        const pointerSystem = this.engine.currentScene.world.systemManager.get(PointerSystem);\r\n        const transformEntities = this.engine.currentScene.world.queryManager.createQuery(pointerSystem.types);\r\n        pointerSystem.update(transformEntities.getEntities());\r\n    }\r\n    _nativeButtonToPointerButton(s) {\r\n        switch (s) {\r\n            case NativePointerButton.NoButton:\r\n                return PointerButton.NoButton;\r\n            case NativePointerButton.Left:\r\n                return PointerButton.Left;\r\n            case NativePointerButton.Middle:\r\n                return PointerButton.Middle;\r\n            case NativePointerButton.Right:\r\n                return PointerButton.Right;\r\n            case NativePointerButton.Unknown:\r\n                return PointerButton.Unknown;\r\n            default:\r\n                return fail(s);\r\n        }\r\n    }\r\n    _stringToPointerType(s) {\r\n        switch (s) {\r\n            case 'touch':\r\n                return PointerType.Touch;\r\n            case 'mouse':\r\n                return PointerType.Mouse;\r\n            case 'pen':\r\n                return PointerType.Pen;\r\n            default:\r\n                return PointerType.Unknown;\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Fps.ts\nclass FpsSampler {\r\n    constructor(options) {\r\n        var _a;\r\n        this._samplePeriod = 100;\r\n        this._currentFrameTime = 0;\r\n        this._frames = 0;\r\n        this._previousSampleTime = 0;\r\n        this._beginFrameTime = 0;\r\n        this._fps = options.initialFps;\r\n        this._samplePeriod = (_a = options.samplePeriod) !== null && _a !== void 0 ? _a : this._samplePeriod;\r\n        this._currentFrameTime = 1000 / options.initialFps;\r\n        this._nowFn = options.nowFn;\r\n        this._previousSampleTime = this._nowFn();\r\n    }\r\n    /**\r\n     * Start of code block to sample FPS for\r\n     */\r\n    start() {\r\n        this._beginFrameTime = this._nowFn();\r\n    }\r\n    /**\r\n     * End of code block to sample FPS for\r\n     */\r\n    end() {\r\n        this._frames++;\r\n        const time = this._nowFn();\r\n        this._currentFrameTime = time - this._beginFrameTime;\r\n        if (time >= this._previousSampleTime + this._samplePeriod) {\r\n            this._fps = (this._frames * 1000) / (time - this._previousSampleTime);\r\n            this._previousSampleTime = time;\r\n            this._frames = 0;\r\n        }\r\n    }\r\n    /**\r\n     * Return the currently sampled fps over the last sample period, by default every 100ms\r\n     */\r\n    get fps() {\r\n        return this._fps;\r\n    }\r\n    /**\r\n     * Return the instantaneous fps, this can be less useful because it will fluctuate given the current frames time\r\n     */\r\n    get instant() {\r\n        return 1000 / this._currentFrameTime;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Clock.ts\n\r\n\r\n/**\r\n * Abstract Clock is the base type of all Clocks\r\n *\r\n * It has a few opinions\r\n * 1. It manages the calculation of what \"elapsed\" time means and thus maximum fps\r\n * 2. The default timing api is implemented in now()\r\n *\r\n * To implement your own clock, extend Clock and override start/stop to start and stop the clock, then call update() with whatever\r\n * method is unique to your clock implementation.\r\n */\r\nclass Clock {\r\n    constructor(options) {\r\n        var _a, _b, _c;\r\n        this._onFatalException = () => { };\r\n        this._maxFps = Infinity;\r\n        this._lastTime = 0;\r\n        this._elapsed = 1;\r\n        this._scheduledCbs = [];\r\n        this._totalElapsed = 0;\r\n        this._options = options;\r\n        this.tick = options.tick;\r\n        this._lastTime = (_a = this.now()) !== null && _a !== void 0 ? _a : 0;\r\n        this._maxFps = (_b = options.maxFps) !== null && _b !== void 0 ? _b : this._maxFps;\r\n        this._onFatalException = (_c = options.onFatalException) !== null && _c !== void 0 ? _c : this._onFatalException;\r\n        this.fpsSampler = new FpsSampler({\r\n            initialFps: 60,\r\n            nowFn: () => this.now()\r\n        });\r\n    }\r\n    /**\r\n     * Get the elapsed time for the last completed frame\r\n     */\r\n    elapsed() {\r\n        return this._elapsed;\r\n    }\r\n    /**\r\n     * Get the current time in milliseconds\r\n     */\r\n    now() {\r\n        return performance.now();\r\n    }\r\n    toTestClock() {\r\n        const testClock = new TestClock({\r\n            ...this._options,\r\n            defaultUpdateMs: 16.6\r\n        });\r\n        return testClock;\r\n    }\r\n    toStandardClock() {\r\n        const clock = new StandardClock({\r\n            ...this._options\r\n        });\r\n        return clock;\r\n    }\r\n    setFatalExceptionHandler(handler) {\r\n        this._onFatalException = handler;\r\n    }\r\n    /**\r\n     * Schedule a callback to fire given a timeout in milliseconds using the excalibur [[Clock]]\r\n     *\r\n     * This is useful to use over the built in browser `setTimeout` because callbacks will be tied to the\r\n     * excalibur update clock, instead of browser time, this means that callbacks wont fire if the game is\r\n     * stopped or paused.\r\n     *\r\n     * @param cb callback to fire\r\n     * @param timeoutMs Optionally specify a timeout in milliseconds from now, default is 0ms which means the next possible tick\r\n     */\r\n    schedule(cb, timeoutMs = 0) {\r\n        const scheduledTime = this.now() + timeoutMs;\r\n        this._scheduledCbs.push([cb, scheduledTime]);\r\n    }\r\n    _runScheduledCbs() {\r\n        // walk backwards to delete items as we loop\r\n        for (let i = this._scheduledCbs.length - 1; i > -1; i--) {\r\n            if (this._scheduledCbs[i][1] <= this._totalElapsed) {\r\n                this._scheduledCbs[i][0]();\r\n                this._scheduledCbs.splice(i, 1);\r\n            }\r\n        }\r\n    }\r\n    update(overrideUpdateMs) {\r\n        try {\r\n            this.fpsSampler.start();\r\n            // Get the time to calculate time-elapsed\r\n            const now = this.now();\r\n            let elapsed = now - this._lastTime || 1; // first frame\r\n            // Constrain fps\r\n            const fpsInterval = (1000 / this._maxFps);\r\n            // only run frame if enough time has elapsed\r\n            if (elapsed >= fpsInterval) {\r\n                let leftover = 0;\r\n                if (fpsInterval !== 0) {\r\n                    leftover = (elapsed % fpsInterval);\r\n                    elapsed = elapsed - leftover; // shift elapsed to be \"in phase\" with the current loop fps\r\n                }\r\n                // Resolves issue #138 if the game has been paused, or blurred for\r\n                // more than a 200 milliseconds, reset elapsed time to 1. This improves reliability\r\n                // and provides more expected behavior when the engine comes back\r\n                // into focus\r\n                if (elapsed > 200) {\r\n                    elapsed = 1;\r\n                }\r\n                // tick the mainloop and run scheduled callbacks\r\n                this._elapsed = overrideUpdateMs || elapsed;\r\n                this._totalElapsed += this._elapsed;\r\n                this._runScheduledCbs();\r\n                this.tick(overrideUpdateMs || elapsed);\r\n                if (fpsInterval !== 0) {\r\n                    this._lastTime = now - leftover;\r\n                }\r\n                else {\r\n                    this._lastTime = now;\r\n                }\r\n                this.fpsSampler.end();\r\n            }\r\n        }\r\n        catch (e) {\r\n            this._onFatalException(e);\r\n            this.stop();\r\n        }\r\n    }\r\n}\r\n/**\r\n * The [[StandardClock]] implements the requestAnimationFrame browser api to run the tick()\r\n */\r\nclass StandardClock extends Clock {\r\n    constructor(options) {\r\n        super(options);\r\n        this._running = false;\r\n    }\r\n    isRunning() {\r\n        return this._running;\r\n    }\r\n    start() {\r\n        if (this._running) {\r\n            return;\r\n        }\r\n        this._running = true;\r\n        const mainloop = () => {\r\n            // stop the loop\r\n            if (!this._running) {\r\n                return;\r\n            }\r\n            try {\r\n                // request next loop\r\n                this._requestId = window.requestAnimationFrame(mainloop);\r\n                this.update();\r\n            }\r\n            catch (e) {\r\n                window.cancelAnimationFrame(this._requestId);\r\n                throw e;\r\n            }\r\n        };\r\n        // begin the first frame\r\n        mainloop();\r\n    }\r\n    stop() {\r\n        this._running = false;\r\n    }\r\n}\r\n/**\r\n * The TestClock is meant for debugging interactions in excalibur that require precise timing to replicate or test\r\n */\r\nclass TestClock extends Clock {\r\n    constructor(options) {\r\n        super({\r\n            ...options\r\n        });\r\n        this._logger = Logger.getInstance();\r\n        this._running = false;\r\n        this._currentTime = 0;\r\n        this._updateMs = options.defaultUpdateMs;\r\n    }\r\n    /**\r\n     * Get the current time in milliseconds\r\n     */\r\n    now() {\r\n        var _a;\r\n        return (_a = this._currentTime) !== null && _a !== void 0 ? _a : 0;\r\n    }\r\n    isRunning() {\r\n        return this._running;\r\n    }\r\n    start() {\r\n        this._running = true;\r\n    }\r\n    stop() {\r\n        this._running = false;\r\n    }\r\n    /**\r\n     * Manually step the clock forward 1 tick, optionally specify an elapsed time in milliseconds\r\n     * @param overrideUpdateMs\r\n     */\r\n    step(overrideUpdateMs) {\r\n        const time = overrideUpdateMs !== null && overrideUpdateMs !== void 0 ? overrideUpdateMs : this._updateMs;\r\n        if (this._running) {\r\n            // to be comparable to RAF this needs to be a full blown Task\r\n            // For example, images cannot decode synchronously in a single step\r\n            this.update(time);\r\n            this._currentTime += time;\r\n        }\r\n        else {\r\n            this._logger.warn('The clock is not running, no step will be performed');\r\n        }\r\n    }\r\n    /**\r\n     * Run a number of steps that tick the clock, optionally specify an elapsed time in milliseconds\r\n     * @param numberOfSteps\r\n     * @param overrideUpdateMs\r\n     */\r\n    run(numberOfSteps, overrideUpdateMs) {\r\n        for (let i = 0; i < numberOfSteps; i++) {\r\n            this.step(overrideUpdateMs !== null && overrideUpdateMs !== void 0 ? overrideUpdateMs : this._updateMs);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Engine.ts\nvar Engine_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\n\r\n\r\npolyfill();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Enum representing the different mousewheel event bubble prevention\r\n */\r\nvar ScrollPreventionMode;\r\n(function (ScrollPreventionMode) {\r\n    /**\r\n     * Do not prevent any page scrolling\r\n     */\r\n    ScrollPreventionMode[ScrollPreventionMode[\"None\"] = 0] = \"None\";\r\n    /**\r\n     * Prevent page scroll if mouse is over the game canvas\r\n     */\r\n    ScrollPreventionMode[ScrollPreventionMode[\"Canvas\"] = 1] = \"Canvas\";\r\n    /**\r\n     * Prevent all page scrolling via mouse wheel\r\n     */\r\n    ScrollPreventionMode[ScrollPreventionMode[\"All\"] = 2] = \"All\";\r\n})(ScrollPreventionMode || (ScrollPreventionMode = {}));\r\n/**\r\n * The Excalibur Engine\r\n *\r\n * The [[Engine]] is the main driver for a game. It is responsible for\r\n * starting/stopping the game, maintaining state, transmitting events,\r\n * loading resources, and managing the scene.\r\n */\r\nclass Engine extends Class {\r\n    /**\r\n     * Creates a new game using the given [[EngineOptions]]. By default, if no options are provided,\r\n     * the game will be rendered full screen (taking up all available browser window space).\r\n     * You can customize the game rendering through [[EngineOptions]].\r\n     *\r\n     * Example:\r\n     *\r\n     * ```js\r\n     * var game = new ex.Engine({\r\n     *   width: 0, // the width of the canvas\r\n     *   height: 0, // the height of the canvas\r\n     *   enableCanvasTransparency: true, // the transparencySection of the canvas\r\n     *   canvasElementId: '', // the DOM canvas element ID, if you are providing your own\r\n     *   displayMode: ex.DisplayMode.FullScreen, // the display mode\r\n     *   pointerScope: ex.Input.PointerScope.Document, // the scope of capturing pointer (mouse/touch) events\r\n     *   backgroundColor: ex.Color.fromHex('#2185d0') // background color of the engine\r\n     * });\r\n     *\r\n     * // call game.start, which is a Promise\r\n     * game.start().then(function () {\r\n     *   // ready, set, go!\r\n     * });\r\n     * ```\r\n     */\r\n    constructor(options) {\r\n        var _a, _b, _c, _d;\r\n        super();\r\n        /**\r\n         * Optionally set the maximum fps if not set Excalibur will go as fast as the device allows.\r\n         *\r\n         * You may want to constrain max fps if your game cannot maintain fps consistently, it can look and feel better to have a 30fps game than\r\n         * one that bounces between 30fps and 60fps\r\n         */\r\n        this.maxFps = Number.POSITIVE_INFINITY;\r\n        this._hasStarted = false;\r\n        /**\r\n         * Contains all the scenes currently registered with Excalibur\r\n         */\r\n        this.scenes = {};\r\n        /**\r\n         * @hidden\r\n         * @deprecated will be removed in v0.26.0\r\n         */\r\n        this._animations = [];\r\n        this._suppressPlayButton = false;\r\n        /**\r\n         * Indicates whether audio should be paused when the game is no longer visible.\r\n         */\r\n        this.pauseAudioWhenHidden = true;\r\n        /**\r\n         * Indicates whether the engine should draw with debug information\r\n         */\r\n        this._isDebug = false;\r\n        /**\r\n         * No longer used\r\n         * @deprecated will be removed in v0.26.0\r\n         */\r\n        this.debugColor = new Color(255, 255, 255);\r\n        /**\r\n         * Sets the Transparency for the engine.\r\n         */\r\n        this.enableCanvasTransparency = true;\r\n        /**\r\n         * The action to take when a fatal exception is thrown\r\n         */\r\n        this.onFatalException = (e) => {\r\n            Logger.getInstance().fatal(e);\r\n        };\r\n        this._timescale = 1.0;\r\n        this._isInitialized = false;\r\n        this._deferredGoTo = null;\r\n        this._loadingComplete = false;\r\n        this._isReady = false;\r\n        this._isReadyPromise = new Promise(resolve => {\r\n            this._isReadyResolve = resolve;\r\n        });\r\n        options = { ...Engine._DEFAULT_ENGINE_OPTIONS, ...options };\r\n        Flags.freeze();\r\n        // Initialize browser events facade\r\n        this.browser = new BrowserEvents(window, document);\r\n        // Check compatibility\r\n        const detector = new Detector();\r\n        if (!options.suppressMinimumBrowserFeatureDetection && !(this._compatible = detector.test())) {\r\n            const message = document.createElement('div');\r\n            message.innerText = 'Sorry, your browser does not support all the features needed for Excalibur';\r\n            document.body.appendChild(message);\r\n            detector.failedTests.forEach(function (test) {\r\n                const testMessage = document.createElement('div');\r\n                testMessage.innerText = 'Browser feature missing ' + test;\r\n                document.body.appendChild(testMessage);\r\n            });\r\n            if (options.canvasElementId) {\r\n                const canvas = document.getElementById(options.canvasElementId);\r\n                if (canvas) {\r\n                    canvas.parentElement.removeChild(canvas);\r\n                }\r\n            }\r\n            return;\r\n        }\r\n        else {\r\n            this._compatible = true;\r\n        }\r\n        // Use native console API for color fun\r\n        // eslint-disable-next-line no-console\r\n        if (console.log && !options.suppressConsoleBootMessage) {\r\n            // eslint-disable-next-line no-console\r\n            console.log(`%cPowered by Excalibur.js (v${EX_VERSION})`, 'background: #176BAA; color: white; border-radius: 5px; padding: 15px; font-size: 1.5em; line-height: 80px;');\r\n            // eslint-disable-next-line no-console\r\n            console.log('\\n\\\r\n      /| ________________\\n\\\r\nO|===|* >________________>\\n\\\r\n      \\\\|');\r\n            // eslint-disable-next-line no-console\r\n            console.log('Visit', 'http://excaliburjs.com', 'for more information');\r\n        }\r\n        // Suppress play button\r\n        if (options.suppressPlayButton) {\r\n            this._suppressPlayButton = true;\r\n        }\r\n        this._logger = Logger.getInstance();\r\n        // If debug is enabled, let's log browser features to the console.\r\n        if (this._logger.defaultLevel === LogLevel.Debug) {\r\n            detector.logBrowserFeatures();\r\n        }\r\n        this._logger.debug('Building engine...');\r\n        this.canvasElementId = options.canvasElementId;\r\n        if (options.canvasElementId) {\r\n            this._logger.debug('Using Canvas element specified: ' + options.canvasElementId);\r\n            this.canvas = document.getElementById(options.canvasElementId);\r\n        }\r\n        else if (options.canvasElement) {\r\n            this._logger.debug('Using Canvas element specified:', options.canvasElement);\r\n            this.canvas = options.canvasElement;\r\n        }\r\n        else {\r\n            this._logger.debug('Using generated canvas element');\r\n            this.canvas = document.createElement('canvas');\r\n        }\r\n        let displayMode = (_a = options.displayMode) !== null && _a !== void 0 ? _a : DisplayMode.Fixed;\r\n        if ((options.width && options.height) || options.viewport) {\r\n            if (options.displayMode === undefined) {\r\n                displayMode = DisplayMode.Fixed;\r\n            }\r\n            this._logger.debug('Engine viewport is size ' + options.width + ' x ' + options.height);\r\n        }\r\n        else if (!options.displayMode) {\r\n            this._logger.debug('Engine viewport is fit');\r\n            displayMode = DisplayMode.FitScreen;\r\n        }\r\n        if (Flags.isEnabled(Legacy.Canvas)) {\r\n            const ex2dCtx = new ExcaliburGraphicsContext2DCanvas({\r\n                canvasElement: this.canvas,\r\n                enableTransparency: this.enableCanvasTransparency,\r\n                smoothing: options.antialiasing,\r\n                backgroundColor: options.backgroundColor,\r\n                snapToPixel: options.snapToPixel\r\n            });\r\n            this.graphicsContext = ex2dCtx;\r\n            this.ctx = ex2dCtx.__ctx;\r\n        }\r\n        else {\r\n            const exWebglCtx = new ExcaliburGraphicsContextWebGL({\r\n                canvasElement: this.canvas,\r\n                enableTransparency: this.enableCanvasTransparency,\r\n                smoothing: options.antialiasing,\r\n                backgroundColor: options.backgroundColor,\r\n                snapToPixel: options.snapToPixel\r\n            });\r\n            this.graphicsContext = exWebglCtx;\r\n            this.ctx = exWebglCtx.__ctx;\r\n        }\r\n        this.screen = new Screen({\r\n            canvas: this.canvas,\r\n            context: this.graphicsContext,\r\n            antialiasing: (_b = options.antialiasing) !== null && _b !== void 0 ? _b : true,\r\n            browser: this.browser,\r\n            viewport: (_c = options.viewport) !== null && _c !== void 0 ? _c : (options.width && options.height ? { width: options.width, height: options.height } : Resolution.SVGA),\r\n            resolution: options.resolution,\r\n            displayMode,\r\n            position: options.position,\r\n            pixelRatio: options.suppressHiDPIScaling ? 1 : null\r\n        });\r\n        TextureLoader.filtering = options.antialiasing ? ImageFiltering.Blended : ImageFiltering.Pixel;\r\n        if (options.backgroundColor) {\r\n            this.backgroundColor = options.backgroundColor.clone();\r\n        }\r\n        this.maxFps = (_d = options.maxFps) !== null && _d !== void 0 ? _d : this.maxFps;\r\n        this.clock = new StandardClock({\r\n            maxFps: this.maxFps,\r\n            tick: this._mainloop.bind(this),\r\n            onFatalException: (e) => this.onFatalException(e)\r\n        });\r\n        this.enableCanvasTransparency = options.enableCanvasTransparency;\r\n        this._loader = new Loader();\r\n        this._loader.wireEngine(this);\r\n        this.debug = new Debug(this);\r\n        this._initialize(options);\r\n        this.rootScene = this.currentScene = new Scene();\r\n        this.addScene('root', this.rootScene);\r\n        window.___EXCALIBUR_DEVTOOL = this;\r\n    }\r\n    /**\r\n     * The width of the game canvas in pixels (physical width component of the\r\n     * resolution of the canvas element)\r\n     */\r\n    get canvasWidth() {\r\n        return this.screen.canvasWidth;\r\n    }\r\n    /**\r\n     * Returns half width of the game canvas in pixels (half physical width component)\r\n     */\r\n    get halfCanvasWidth() {\r\n        return this.screen.halfCanvasWidth;\r\n    }\r\n    /**\r\n     * The height of the game canvas in pixels, (physical height component of\r\n     * the resolution of the canvas element)\r\n     */\r\n    get canvasHeight() {\r\n        return this.screen.canvasHeight;\r\n    }\r\n    /**\r\n     * Returns half height of the game canvas in pixels (half physical height component)\r\n     */\r\n    get halfCanvasHeight() {\r\n        return this.screen.halfCanvasHeight;\r\n    }\r\n    /**\r\n     * Returns the width of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get drawWidth() {\r\n        return this.screen.drawWidth;\r\n    }\r\n    /**\r\n     * Returns half the width of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get halfDrawWidth() {\r\n        return this.screen.halfDrawWidth;\r\n    }\r\n    /**\r\n     * Returns the height of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get drawHeight() {\r\n        return this.screen.drawHeight;\r\n    }\r\n    /**\r\n     * Returns half the height of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get halfDrawHeight() {\r\n        return this.screen.halfDrawHeight;\r\n    }\r\n    /**\r\n     * Returns whether excalibur detects the current screen to be HiDPI\r\n     */\r\n    get isHiDpi() {\r\n        return this.screen.isHiDpi;\r\n    }\r\n    /**\r\n     * Access [[stats]] that holds frame statistics.\r\n     */\r\n    get stats() {\r\n        return this.debug.stats;\r\n    }\r\n    /**\r\n     * Indicates whether the engine is set to fullscreen or not\r\n     */\r\n    get isFullscreen() {\r\n        return this.screen.isFullScreen;\r\n    }\r\n    /**\r\n     * Indicates the current [[DisplayMode]] of the engine.\r\n     */\r\n    get displayMode() {\r\n        return this.screen.displayMode;\r\n    }\r\n    /**\r\n     * Returns the calculated pixel ration for use in rendering\r\n     */\r\n    get pixelRatio() {\r\n        return this.screen.pixelRatio;\r\n    }\r\n    get isDebug() {\r\n        return this._isDebug;\r\n    }\r\n    /**\r\n     * Hints the graphics context to truncate fractional world space coordinates\r\n     */\r\n    get snapToPixel() {\r\n        return this.graphicsContext.snapToPixel;\r\n    }\r\n    ;\r\n    set snapToPixel(shouldSnapToPixel) {\r\n        this.graphicsContext.snapToPixel = shouldSnapToPixel;\r\n    }\r\n    ;\r\n    on(eventName, handler) {\r\n        super.on(eventName, handler);\r\n    }\r\n    once(eventName, handler) {\r\n        super.once(eventName, handler);\r\n    }\r\n    off(eventName, handler) {\r\n        super.off(eventName, handler);\r\n    }\r\n    /**\r\n     * Returns a BoundingBox of the top left corner of the screen\r\n     * and the bottom right corner of the screen.\r\n     */\r\n    getWorldBounds() {\r\n        return this.screen.getWorldBounds();\r\n    }\r\n    /**\r\n     * Gets the current engine timescale factor (default is 1.0 which is 1:1 time)\r\n     */\r\n    get timescale() {\r\n        return this._timescale;\r\n    }\r\n    /**\r\n     * Sets the current engine timescale factor. Useful for creating slow-motion effects or fast-forward effects\r\n     * when using time-based movement.\r\n     */\r\n    set timescale(value) {\r\n        if (value <= 0) {\r\n            Logger.getInstance().error('Cannot set engine.timescale to a value of 0 or less than 0.');\r\n            return;\r\n        }\r\n        this._timescale = value;\r\n    }\r\n    /**\r\n     * Plays a sprite animation on the screen at the specified `x` and `y`\r\n     * (in game coordinates, not screen pixels). These animations play\r\n     * independent of actors, and will be cleaned up internally as soon\r\n     * as they are complete. Note animations that loop will never be\r\n     * cleaned up.\r\n     *\r\n     * @param animation  Animation to play\r\n     * @param x          x game coordinate to play the animation\r\n     * @param y          y game coordinate to play the animation\r\n     * @deprecated\r\n     */\r\n    playAnimation(animation, x, y) {\r\n        this._animations.push(new AnimationNode(animation, x, y));\r\n    }\r\n    /**\r\n     * Adds a [[TileMap]] to the [[currentScene]], once this is done the TileMap\r\n     * will be drawn and updated.\r\n     */\r\n    addTileMap(tileMap) {\r\n        this.currentScene.addTileMap(tileMap);\r\n    }\r\n    /**\r\n     * Removes a [[TileMap]] from the [[currentScene]], it will no longer be drawn or updated.\r\n     */\r\n    removeTileMap(tileMap) {\r\n        this.currentScene.removeTileMap(tileMap);\r\n    }\r\n    /**\r\n     * Adds a [[Timer]] to the [[currentScene]].\r\n     * @param timer  The timer to add to the [[currentScene]].\r\n     */\r\n    addTimer(timer) {\r\n        return this.currentScene.addTimer(timer);\r\n    }\r\n    /**\r\n     * Removes a [[Timer]] from the [[currentScene]].\r\n     * @param timer  The timer to remove to the [[currentScene]].\r\n     */\r\n    removeTimer(timer) {\r\n        return this.currentScene.removeTimer(timer);\r\n    }\r\n    /**\r\n     * Adds a [[Scene]] to the engine, think of scenes in Excalibur as you\r\n     * would levels or menus.\r\n     *\r\n     * @param key  The name of the scene, must be unique\r\n     * @param scene The scene to add to the engine\r\n     */\r\n    addScene(key, scene) {\r\n        if (this.scenes[key]) {\r\n            this._logger.warn('Scene', key, 'already exists overwriting');\r\n        }\r\n        this.scenes[key] = scene;\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    removeScene(entity) {\r\n        if (entity instanceof Scene) {\r\n            // remove scene\r\n            for (const key in this.scenes) {\r\n                if (this.scenes.hasOwnProperty(key)) {\r\n                    if (this.scenes[key] === entity) {\r\n                        delete this.scenes[key];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (typeof entity === 'string') {\r\n            // remove scene\r\n            delete this.scenes[entity];\r\n        }\r\n    }\r\n    add(entity) {\r\n        if (arguments.length === 2) {\r\n            this.addScene(arguments[0], arguments[1]);\r\n            return;\r\n        }\r\n        if (this._deferredGoTo && this.scenes[this._deferredGoTo]) {\r\n            this.scenes[this._deferredGoTo].add(entity);\r\n        }\r\n        else {\r\n            this.currentScene.add(entity);\r\n        }\r\n    }\r\n    remove(entity) {\r\n        if (entity instanceof Entity) {\r\n            this.currentScene.remove(entity);\r\n        }\r\n        if (entity instanceof Scene) {\r\n            this.removeScene(entity);\r\n        }\r\n        if (typeof entity === 'string') {\r\n            this.removeScene(entity);\r\n        }\r\n    }\r\n    /**\r\n     * Changes the currently updating and drawing scene to a different,\r\n     * named scene. Calls the [[Scene]] lifecycle events.\r\n     * @param key  The key of the scene to transition to.\r\n     */\r\n    goToScene(key) {\r\n        // if not yet initialized defer goToScene\r\n        if (!this.isInitialized) {\r\n            this._deferredGoTo = key;\r\n            return;\r\n        }\r\n        if (this.scenes[key]) {\r\n            const oldScene = this.currentScene;\r\n            const newScene = this.scenes[key];\r\n            this._logger.debug('Going to scene:', key);\r\n            // only deactivate when initialized\r\n            if (this.currentScene.isInitialized) {\r\n                this.currentScene._deactivate.apply(this.currentScene, [oldScene, newScene]);\r\n                this.currentScene.eventDispatcher.emit('deactivate', new DeactivateEvent(newScene, this.currentScene));\r\n            }\r\n            // set current scene to new one\r\n            this.currentScene = newScene;\r\n            this.screen.setCurrentCamera(newScene.camera);\r\n            // initialize the current scene if has not been already\r\n            this.currentScene._initialize(this);\r\n            this.currentScene._activate.apply(this.currentScene, [oldScene, newScene]);\r\n            this.currentScene.eventDispatcher.emit('activate', new ActivateEvent(oldScene, this.currentScene));\r\n        }\r\n        else {\r\n            this._logger.error('Scene', key, 'does not exist!');\r\n        }\r\n    }\r\n    /**\r\n     * Transforms the current x, y from screen coordinates to world coordinates\r\n     * @param point  Screen coordinate to convert\r\n     */\r\n    screenToWorldCoordinates(point) {\r\n        return this.screen.screenToWorldCoordinates(point);\r\n    }\r\n    /**\r\n     * Transforms a world coordinate, to a screen coordinate\r\n     * @param point  World coordinate to convert\r\n     */\r\n    worldToScreenCoordinates(point) {\r\n        return this.screen.worldToScreenCoordinates(point);\r\n    }\r\n    /**\r\n     * Initializes the internal canvas, rendering context, display mode, and native event listeners\r\n     */\r\n    _initialize(options) {\r\n        this.pageScrollPreventionMode = options.scrollPreventionMode;\r\n        // initialize inputs\r\n        const pointerTarget = options && options.pointerScope === PointerScope.Document ? document : this.canvas;\r\n        this.input = {\r\n            keyboard: new Keyboard(),\r\n            pointers: new PointerEventReceiver(pointerTarget, this),\r\n            gamepads: new Gamepads()\r\n        };\r\n        this.input.keyboard.init();\r\n        this.input.pointers.init();\r\n        this.input.gamepads.init();\r\n        // Issue #385 make use of the visibility api\r\n        // https://developer.mozilla.org/en-US/docs/Web/Guide/User_experience/Using_the_Page_Visibility_API\r\n        let hidden, visibilityChange;\r\n        if (typeof document.hidden !== 'undefined') {\r\n            // Opera 12.10 and Firefox 18 and later support\r\n            hidden = 'hidden';\r\n            visibilityChange = 'visibilitychange';\r\n        }\r\n        else if ('msHidden' in document) {\r\n            hidden = 'msHidden';\r\n            visibilityChange = 'msvisibilitychange';\r\n        }\r\n        else if ('webkitHidden' in document) {\r\n            hidden = 'webkitHidden';\r\n            visibilityChange = 'webkitvisibilitychange';\r\n        }\r\n        this.browser.document.on(visibilityChange, () => {\r\n            if (document[hidden]) {\r\n                this.eventDispatcher.emit('hidden', new HiddenEvent(this));\r\n                this._logger.debug('Window hidden');\r\n            }\r\n            else {\r\n                this.eventDispatcher.emit('visible', new VisibleEvent(this));\r\n                this._logger.debug('Window visible');\r\n            }\r\n        });\r\n        if (!this.canvasElementId && !options.canvasElement) {\r\n            document.body.appendChild(this.canvas);\r\n        }\r\n    }\r\n    onInitialize(_engine) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * If supported by the browser, this will set the antialiasing flag on the\r\n     * canvas. Set this to `false` if you want a 'jagged' pixel art look to your\r\n     * image resources.\r\n     * @param isSmooth  Set smoothing to true or false\r\n     */\r\n    setAntialiasing(isSmooth) {\r\n        this.screen.antialiasing = isSmooth;\r\n    }\r\n    /**\r\n     * Return the current smoothing status of the canvas\r\n     */\r\n    getAntialiasing() {\r\n        return this.screen.antialiasing;\r\n    }\r\n    /**\r\n     * Gets whether the actor is Initialized\r\n     */\r\n    get isInitialized() {\r\n        return this._isInitialized;\r\n    }\r\n    _overrideInitialize(engine) {\r\n        if (!this.isInitialized) {\r\n            this.onInitialize(engine);\r\n            super.emit('initialize', new InitializeEvent(engine, this));\r\n            this._isInitialized = true;\r\n            if (this._deferredGoTo) {\r\n                this.goToScene(this._deferredGoTo);\r\n            }\r\n            else {\r\n                this.goToScene('root');\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Updates the entire state of the game\r\n     * @param delta  Number of milliseconds elapsed since the last update.\r\n     */\r\n    _update(delta) {\r\n        if (!this.ready) {\r\n            // suspend updates until loading is finished\r\n            this._loader.update(this, delta);\r\n            // Update input listeners\r\n            this.input.keyboard.update();\r\n            this.input.gamepads.update();\r\n            return;\r\n        }\r\n        // Publish preupdate events\r\n        this._preupdate(delta);\r\n        // process engine level events\r\n        this.currentScene.update(this, delta);\r\n        // update animations\r\n        // TODO remove\r\n        this._animations = this._animations.filter(function (a) {\r\n            return !a.animation.isDone();\r\n        });\r\n        // Update input listeners\r\n        this.input.keyboard.update();\r\n        this.input.gamepads.update();\r\n        // Publish update event\r\n        this._postupdate(delta);\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    _preupdate(delta) {\r\n        this.emit('preupdate', new PreUpdateEvent(this, delta, this));\r\n        this.onPreUpdate(this, delta);\r\n    }\r\n    onPreUpdate(_engine, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    _postupdate(delta) {\r\n        this.emit('postupdate', new PostUpdateEvent(this, delta, this));\r\n        this.onPostUpdate(this, delta);\r\n    }\r\n    onPostUpdate(_engine, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * Draws the entire game\r\n     * @param delta  Number of milliseconds elapsed since the last draw.\r\n     */\r\n    _draw(delta) {\r\n        const ctx = this.ctx;\r\n        this.graphicsContext.beginDrawLifecycle();\r\n        this.graphicsContext.clear();\r\n        this._predraw(ctx, delta);\r\n        // Drawing nothing else while loading\r\n        if (!this._isReady) {\r\n            this._loader.canvas.draw(this.graphicsContext, 0, 0);\r\n            this.graphicsContext.flush();\r\n            return;\r\n        }\r\n        // TODO move to graphics systems?\r\n        this.graphicsContext.backgroundColor = this.backgroundColor;\r\n        this.currentScene.draw(this.ctx, delta);\r\n        // todo needs to be a better way of doing this\r\n        let a = 0;\r\n        const len = this._animations.length;\r\n        for (a; a < len; a++) {\r\n            this._animations[a].animation.draw(ctx, this._animations[a].x, this._animations[a].y);\r\n        }\r\n        // Draw debug information\r\n        // TODO don't access ctx directly\r\n        if (this.isDebug) {\r\n            this.ctx.font = 'Consolas';\r\n            this.ctx.fillStyle = this.debugColor.toString();\r\n            const keys = this.input.keyboard.getKeys();\r\n            for (let j = 0; j < keys.length; j++) {\r\n                this.ctx.fillText(keys[j].toString() + ' : ' + (Keys[keys[j]] ? Keys[keys[j]] : 'Not Mapped'), 100, 10 * j + 10);\r\n            }\r\n            this.ctx.fillText('FPS:' + this.stats.currFrame.fps.toFixed(2).toString(), 10, 10);\r\n        }\r\n        this._postdraw(ctx, delta);\r\n        // Flush any pending drawings\r\n        this.graphicsContext.flush();\r\n        this.graphicsContext.endDrawLifecycle();\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    _predraw(_ctx, delta) {\r\n        this.emit('predraw', new PreDrawEvent(_ctx, delta, this));\r\n        this.onPreDraw(_ctx, delta);\r\n    }\r\n    onPreDraw(_ctx, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    _postdraw(_ctx, delta) {\r\n        this.emit('postdraw', new PostDrawEvent(_ctx, delta, this));\r\n        this.onPostDraw(_ctx, delta);\r\n    }\r\n    onPostDraw(_ctx, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * Enable or disable Excalibur debugging functionality.\r\n     * @param toggle a value that debug drawing will be changed to\r\n     */\r\n    showDebug(toggle) {\r\n        this._isDebug = toggle;\r\n    }\r\n    /**\r\n     * Toggle Excalibur debugging functionality.\r\n     */\r\n    toggleDebug() {\r\n        this._isDebug = !this._isDebug;\r\n        return this._isDebug;\r\n    }\r\n    /**\r\n     * Returns true when loading is totally complete and the player has clicked start\r\n     */\r\n    get loadingComplete() {\r\n        return this._loadingComplete;\r\n    }\r\n    get ready() {\r\n        return this._isReady;\r\n    }\r\n    isReady() {\r\n        return this._isReadyPromise;\r\n    }\r\n    /**\r\n     * Starts the internal game loop for Excalibur after loading\r\n     * any provided assets.\r\n     * @param loader  Optional [[Loader]] to use to load resources. The default loader is [[Loader]], override to provide your own\r\n     * custom loader.\r\n     *\r\n     * Note: start() only resolves AFTER the user has clicked the play button\r\n     */\r\n    async start(loader) {\r\n        if (!this._compatible) {\r\n            throw new Error('Excalibur is incompatible with your browser');\r\n        }\r\n        // Wire loader if we have it\r\n        if (loader) {\r\n            // Push the current user entered resolution/viewport\r\n            this.screen.pushResolutionAndViewport();\r\n            // Configure resolution for loader, it expects resolution === viewport\r\n            this.screen.resolution = this.screen.viewport;\r\n            this.screen.applyResolutionAndViewport();\r\n            this._loader = loader;\r\n            this._loader.suppressPlayButton = this._suppressPlayButton || this._loader.suppressPlayButton;\r\n            this._loader.wireEngine(this);\r\n        }\r\n        // Start the excalibur clock which drives the mainloop\r\n        // has started is a slight misnomer, it's really mainloop started\r\n        this._logger.debug('Starting game clock...');\r\n        this.browser.resume();\r\n        this.clock.start();\r\n        this._logger.debug('Game clock started');\r\n        if (loader) {\r\n            await this.load(this._loader);\r\n            this._loadingComplete = true;\r\n            // reset back to previous user resolution/viewport\r\n            this.screen.popResolutionAndViewport();\r\n            this.screen.applyResolutionAndViewport();\r\n        }\r\n        this._loadingComplete = true;\r\n        // Initialize before ready\r\n        this._overrideInitialize(this);\r\n        this._isReady = true;\r\n        this._isReadyResolve();\r\n        this.emit('start', new GameStartEvent(this));\r\n        return this._isReadyPromise;\r\n    }\r\n    _mainloop(elapsed) {\r\n        this.emit('preframe', new PreFrameEvent(this, this.stats.prevFrame));\r\n        const delta = elapsed * this.timescale;\r\n        // reset frame stats (reuse existing instances)\r\n        const frameId = this.stats.prevFrame.id + 1;\r\n        this.stats.currFrame.reset();\r\n        this.stats.currFrame.id = frameId;\r\n        this.stats.currFrame.delta = delta;\r\n        this.stats.currFrame.fps = this.clock.fpsSampler.fps;\r\n        GraphicsDiagnostics.clear();\r\n        const beforeUpdate = this.clock.now();\r\n        this._update(delta);\r\n        const afterUpdate = this.clock.now();\r\n        this._draw(delta);\r\n        const afterDraw = this.clock.now();\r\n        this.stats.currFrame.duration.update = afterUpdate - beforeUpdate;\r\n        this.stats.currFrame.duration.draw = afterDraw - afterUpdate;\r\n        this.stats.currFrame.graphics.drawnImages = GraphicsDiagnostics.DrawnImagesCount;\r\n        this.stats.currFrame.graphics.drawCalls = GraphicsDiagnostics.DrawCallCount;\r\n        this.emit('postframe', new PostFrameEvent(this, this.stats.currFrame));\r\n        this.stats.prevFrame.reset(this.stats.currFrame);\r\n    }\r\n    /**\r\n     *\r\n     * @param game\r\n     * @param raf\r\n     * @param nowFn\r\n     * @deprecated Use [[Clock]] to run the mainloop, will be removed in v0.26.0\r\n     */\r\n    static createMainLoop(game, raf, nowFn) {\r\n        let lastTime = nowFn();\r\n        const fpsSampler = new FpsSampler({\r\n            nowFn,\r\n            initialFps: game.maxFps === Infinity ? 60 : game.maxFps\r\n        });\r\n        return function mainloop() {\r\n            if (!game._hasStarted) {\r\n                return;\r\n            }\r\n            try {\r\n                game._requestId = raf(mainloop);\r\n                fpsSampler.start();\r\n                game.emit('preframe', new PreFrameEvent(game, game.stats.prevFrame));\r\n                // Get the time to calculate time-elapsed\r\n                const now = nowFn();\r\n                let elapsed = now - lastTime || 1; // first frame\r\n                // Constrain fps\r\n                const fpsInterval = game.maxFps === Number.POSITIVE_INFINITY ? 0 : 1000 / game.maxFps;\r\n                if (elapsed <= fpsInterval) {\r\n                    return; // too fast 😎 skip this frame\r\n                }\r\n                // Resolves issue #138 if the game has been paused, or blurred for\r\n                // more than a 200 milliseconds, reset elapsed time to 1. This improves reliability\r\n                // and provides more expected behavior when the engine comes back\r\n                // into focus\r\n                if (elapsed > 200) {\r\n                    elapsed = 1;\r\n                }\r\n                const delta = elapsed * game.timescale;\r\n                // reset frame stats (reuse existing instances)\r\n                const frameId = game.stats.prevFrame.id + 1;\r\n                game.stats.currFrame.reset();\r\n                game.stats.currFrame.id = frameId;\r\n                game.stats.currFrame.delta = delta;\r\n                game.stats.currFrame.fps = fpsSampler.fps;\r\n                const beforeUpdate = nowFn();\r\n                game._update(delta);\r\n                const afterUpdate = nowFn();\r\n                game._draw(delta);\r\n                const afterDraw = nowFn();\r\n                game.stats.currFrame.duration.update = afterUpdate - beforeUpdate;\r\n                game.stats.currFrame.duration.draw = afterDraw - afterUpdate;\r\n                // if fps interval is not a multiple\r\n                if (fpsInterval > 0) {\r\n                    lastTime = now - (elapsed % fpsInterval);\r\n                }\r\n                else {\r\n                    lastTime = now;\r\n                }\r\n                game.emit('postframe', new PostFrameEvent(game, game.stats.currFrame));\r\n                fpsSampler.end();\r\n                game.stats.prevFrame.reset(game.stats.currFrame);\r\n            }\r\n            catch (e) {\r\n                window.cancelAnimationFrame(game._requestId);\r\n                game.stop();\r\n                game.onFatalException(e);\r\n            }\r\n        };\r\n    }\r\n    /**\r\n     * Stops Excalibur's main loop, useful for pausing the game.\r\n     */\r\n    stop() {\r\n        if (this.clock.isRunning()) {\r\n            this.emit('stop', new GameStopEvent(this));\r\n            this.browser.pause();\r\n            this.clock.stop();\r\n            this._logger.debug('Game stopped');\r\n        }\r\n    }\r\n    /**\r\n     * Returns the Engine's Running status, Useful for checking whether engine is running or paused.\r\n     * @deprecated will be removed in v0.26.0, use isRunning()\r\n     */\r\n    isPaused() {\r\n        return !this.clock.isRunning();\r\n    }\r\n    /**\r\n     * Returns the Engine's running status, Useful for checking whether engine is running or paused.\r\n     */\r\n    isRunning() {\r\n        return this.clock.isRunning();\r\n    }\r\n    /**\r\n     * Takes a screen shot of the current viewport and returns it as an\r\n     * HTML Image Element.\r\n     */\r\n    screenshot() {\r\n        const result = new Image();\r\n        const raw = this.canvas.toDataURL('image/png');\r\n        result.src = raw;\r\n        return result;\r\n    }\r\n    /**\r\n     * Another option available to you to load resources into the game.\r\n     * Immediately after calling this the game will pause and the loading screen\r\n     * will appear.\r\n     * @param loader  Some [[Loadable]] such as a [[Loader]] collection, [[Sound]], or [[Texture]].\r\n     */\r\n    async load(loader) {\r\n        try {\r\n            await loader.load();\r\n        }\r\n        catch (_a) {\r\n            await Promise.resolve();\r\n        }\r\n    }\r\n}\r\n/**\r\n * Default [[EngineOptions]]\r\n */\r\nEngine._DEFAULT_ENGINE_OPTIONS = {\r\n    width: 0,\r\n    height: 0,\r\n    enableCanvasTransparency: true,\r\n    canvasElementId: '',\r\n    canvasElement: undefined,\r\n    snapToPixel: false,\r\n    pointerScope: PointerScope.Canvas,\r\n    suppressConsoleBootMessage: null,\r\n    suppressMinimumBrowserFeatureDetection: null,\r\n    suppressHiDPIScaling: null,\r\n    suppressPlayButton: null,\r\n    scrollPreventionMode: ScrollPreventionMode.Canvas,\r\n    backgroundColor: Color.fromHex('#2185d0') // Excalibur blue\r\n};\r\nEngine_decorate([\r\n    obsolete({ message: 'Will be removed in excalibur v0.26.0', alternateMethod: 'Use Actor.graphics' })\r\n], Engine.prototype, \"playAnimation\", null);\r\n/**\r\n * @internal\r\n * @deprecated\r\n */\r\nlet AnimationNode = class AnimationNode {\r\n    constructor(animation, x, y) {\r\n        this.animation = animation;\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n};\r\nAnimationNode = Engine_decorate([\r\n    obsolete({ message: 'Will be removed in excalibur v0.26.0' })\r\n], AnimationNode);\r\n\n;// CONCATENATED MODULE: ./Math/Index.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Debug/index.ts\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Events/MediaEvents.ts\n\r\nclass MediaEvent extends GameEvent {\r\n    constructor(target, _name = 'MediaEvent') {\r\n        super();\r\n        this.target = target;\r\n        this._name = _name;\r\n    }\r\n    /**\r\n     * Media event cannot bubble\r\n     */\r\n    set bubbles(_value) {\r\n        // stubbed\r\n    }\r\n    /**\r\n     * Media event cannot bubble\r\n     */\r\n    get bubbles() {\r\n        return false;\r\n    }\r\n    /**\r\n     * Media event cannot bubble, so they have no path\r\n     */\r\n    get _path() {\r\n        return null;\r\n    }\r\n    /**\r\n     * Media event cannot bubble, so they have no path\r\n     */\r\n    set _path(_val) {\r\n        // stubbed\r\n    }\r\n    /**\r\n     * Prevents event from bubbling\r\n     */\r\n    stopPropagation() {\r\n        /**\r\n         * Stub\r\n         */\r\n    }\r\n    /**\r\n     * Action, that calls when event happens\r\n     */\r\n    action() {\r\n        /**\r\n         * Stub\r\n         */\r\n    }\r\n    /**\r\n     * Propagate event further through event path\r\n     */\r\n    propagate() {\r\n        /**\r\n         * Stub\r\n         */\r\n    }\r\n    layPath(_actor) {\r\n        /**\r\n         * Stub\r\n         */\r\n    }\r\n}\r\nclass NativeSoundEvent extends MediaEvent {\r\n    constructor(target, track) {\r\n        super(target, 'NativeSoundEvent');\r\n        this.track = track;\r\n    }\r\n}\r\nclass NativeSoundProcessedEvent extends MediaEvent {\r\n    constructor(target, _processedData) {\r\n        super(target, 'NativeSoundProcessedEvent');\r\n        this._processedData = _processedData;\r\n        this.data = this._processedData;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Label.ts\nvar Label_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Labels are the way to draw small amounts of text to the screen. They are\r\n * actors and inherit all of the benefits and capabilities.\r\n */\r\nclass Label_Label extends Actor {\r\n    /**\r\n     * Build a new label\r\n     * @param options\r\n     */\r\n    constructor(options) {\r\n        super(options);\r\n        this._font = new Font();\r\n        this._text = new Text({ text: '', font: this._font });\r\n        /**\r\n         * Gets or sets the letter spacing on a Label. Only supported with Sprite Fonts.\r\n         * @deprecated Use [[SpriteFont.spacing]]\r\n         */\r\n        this.letterSpacing = 0; //px\r\n        /**\r\n         * Whether or not the [[SpriteFont]] will be case-sensitive when matching characters.\r\n         * @deprecated Use Graphics.SpriteFont.caseInsensitive\r\n         */\r\n        this.caseInsensitive = true;\r\n        const { text, pos, x, y, spriteFont, font, color } = options;\r\n        this.pos = pos !== null && pos !== void 0 ? pos : (x && y ? vec(x, y) : this.pos);\r\n        this.text = text !== null && text !== void 0 ? text : this.text;\r\n        this.font = font !== null && font !== void 0 ? font : this.font;\r\n        this.spriteFont = spriteFont !== null && spriteFont !== void 0 ? spriteFont : this.spriteFont;\r\n        this._text.color = color !== null && color !== void 0 ? color : this.color;\r\n        const gfx = this.get(GraphicsComponent);\r\n        gfx.anchor = Vector.Zero;\r\n        gfx.use(this._text);\r\n    }\r\n    get font() {\r\n        return this._font;\r\n    }\r\n    set font(newFont) {\r\n        this._font = newFont;\r\n        this._text.font = newFont;\r\n    }\r\n    /**\r\n     * The text to draw.\r\n     */\r\n    get text() {\r\n        return this._text.text;\r\n    }\r\n    set text(text) {\r\n        this._text.text = text;\r\n    }\r\n    get color() {\r\n        return this._text.color;\r\n    }\r\n    set color(color) {\r\n        if (this._text) {\r\n            this._text.color = color;\r\n        }\r\n    }\r\n    get opacity() {\r\n        return this._text.opacity;\r\n    }\r\n    set opacity(opacity) {\r\n        this._text.opacity = opacity;\r\n    }\r\n    /**\r\n     * Sets or gets the bold property of the label's text, by default it's false\r\n     * @deprecated Use [[Font.bold|Label.font.bold]]\r\n     */\r\n    get bold() {\r\n        return this.font.bold;\r\n    }\r\n    set bold(isBold) {\r\n        this.font.bold = isBold;\r\n    }\r\n    /**\r\n     * The CSS font family string (e.g. `sans-serif`, `Droid Sans Pro`). Web fonts\r\n     * are supported, same as in CSS.\r\n     * @deprecated Use [[Font.family|Label.font.family]]\r\n     */\r\n    get fontFamily() {\r\n        return this.font.family;\r\n    }\r\n    set fontFamily(family) {\r\n        this.font.family = family;\r\n    }\r\n    /**\r\n     * The font size in the selected units, default is 10 (default units is pixel)\r\n     * @deprecated Use [[Font.size|Label.font.size]]\r\n     */\r\n    get fontSize() {\r\n        return this.font.size;\r\n    }\r\n    set fontSize(sizeInUnit) {\r\n        this.font.size = sizeInUnit;\r\n    }\r\n    /**\r\n     * The font style for this label, the default is [[FontStyle.Normal]]\r\n     * @deprecated Use [[Font.style|Label.font.style]]\r\n     */\r\n    get fontStyle() {\r\n        return this.font.style;\r\n    }\r\n    set fontStyle(style) {\r\n        this.font.style = style;\r\n    }\r\n    /**\r\n     * The css units for a font size such as px, pt, em (SpriteFont only support px), by default is 'px';\r\n     * @deprecated Use [[Font.unit|Label.font.unit]]\r\n     */\r\n    get fontUnit() {\r\n        return this.font.unit;\r\n    }\r\n    set fontUnit(unit) {\r\n        this.font.unit = unit;\r\n    }\r\n    /**\r\n     * Gets or sets the horizontal text alignment property for the label.\r\n     * @deprecated Use [[Font.textAlign|Label.font.textAlign]]\r\n     */\r\n    get textAlign() {\r\n        return this.font.textAlign;\r\n    }\r\n    set textAlign(align) {\r\n        this.font.textAlign = align;\r\n    }\r\n    /**\r\n     * Gets or sets the baseline alignment property for the label.\r\n     * @deprecated Use [[Font.baseAlign|Label.font.baseAlign]]\r\n     */\r\n    get baseAlign() {\r\n        return this.font.baseAlign;\r\n    }\r\n    set baseAlign(align) {\r\n        this.font.baseAlign = align;\r\n    }\r\n    /**\r\n     * The [[LegacyDrawing.SpriteFont]] to use, if any. Overrides [[fontFamily]] if present.\r\n     * @deprecated Use [[SpriteFont]]\r\n     */\r\n    get spriteFont() {\r\n        return this._legacySpriteFont;\r\n    }\r\n    set spriteFont(sf) {\r\n        if (sf) {\r\n            if (sf instanceof SpriteFont) {\r\n                this._legacySpriteFont = sf;\r\n                this._spriteFont = SpriteFont_SpriteFont.fromLegacySpriteFont(sf);\r\n                this._text.font = this._spriteFont;\r\n                return;\r\n            }\r\n            this._spriteFont = sf;\r\n            this._text.font = this._spriteFont;\r\n        }\r\n    }\r\n    _initialize(engine) {\r\n        super._initialize(engine);\r\n        this._graphicsContext = engine.graphicsContext;\r\n    }\r\n    /**\r\n     * Returns the width of the text in the label (in pixels);\r\n     */\r\n    getTextWidth() {\r\n        return this._text.width;\r\n    }\r\n    /**\r\n     * Sets the text shadow for sprite fonts\r\n     * @param offsetX      The x offset in pixels to place the shadow\r\n     * @param offsetY      The y offset in pixels to place the shadow\r\n     * @param shadowColor  The color of the text shadow\r\n     * @deprecated Use [[Font.shadow|Label.font.shadow]]\r\n     */\r\n    setTextShadow(offsetX, offsetY, shadowColor) {\r\n        this.font.shadow = { offset: vec(offsetX, offsetY), blur: 2, color: shadowColor };\r\n    }\r\n    /**\r\n     * Toggles text shadows on or off, only applies when using sprite fonts\r\n     * @deprecated Use [[Font.shadow|Label.font.shadow]]\r\n     */\r\n    useTextShadow(on) {\r\n        if (this.spriteFont) {\r\n            this.spriteFont.useTextShadow(on);\r\n        }\r\n    }\r\n    /**\r\n     * Clears the current text shadow\r\n     * @deprecated Use [[Font.shadow|Label.font.shadow]]\r\n     */\r\n    clearTextShadow() {\r\n        this.font.shadow = null;\r\n    }\r\n    /**\r\n     * @deprecated signature will change in v0.26.0\r\n     * @param _ctx\r\n     * @param _delta\r\n     */\r\n    draw(_ctx, _delta) {\r\n        const exctx = this._graphicsContext;\r\n        this._text.draw(exctx, 0, 0);\r\n    }\r\n}\r\nLabel_decorate([\r\n    obsolete({\r\n        message: 'Label.bold will be removed in v0.26.0',\r\n        alternateMethod: 'Use Label.font.bold'\r\n    })\r\n], Label_Label.prototype, \"bold\", null);\r\nLabel_decorate([\r\n    obsolete({\r\n        message: 'Label.fontFamily will be removed in v0.26.0',\r\n        alternateMethod: 'Use Label.font.family'\r\n    })\r\n], Label_Label.prototype, \"fontFamily\", null);\r\nLabel_decorate([\r\n    obsolete({\r\n        message: 'Label.fontSize will be removed in v0.26.0',\r\n        alternateMethod: 'Use Label.font.size'\r\n    })\r\n], Label_Label.prototype, \"fontSize\", null);\r\nLabel_decorate([\r\n    obsolete({\r\n        message: 'Label.fontStyle will be removed in v0.26.0',\r\n        alternateMethod: 'Use Label.font.style'\r\n    })\r\n], Label_Label.prototype, \"fontStyle\", null);\r\nLabel_decorate([\r\n    obsolete({\r\n        message: 'Label.fontUnit will be removed in v0.26.0',\r\n        alternateMethod: 'Use Label.font.unit'\r\n    })\r\n], Label_Label.prototype, \"fontUnit\", null);\r\nLabel_decorate([\r\n    obsolete({\r\n        message: 'Label.textAlign will be removed in v0.26.0',\r\n        alternateMethod: 'Use Label.font.textAlign'\r\n    })\r\n], Label_Label.prototype, \"textAlign\", null);\r\nLabel_decorate([\r\n    obsolete({\r\n        message: 'Label.baseAlign will be removed in v0.26.0',\r\n        alternateMethod: 'Use Label.font.baseAlign'\r\n    })\r\n], Label_Label.prototype, \"baseAlign\", null);\r\nLabel_decorate([\r\n    obsolete({\r\n        message: 'Label.setTextShadow will be removed in v0.26.0',\r\n        alternateMethod: 'Use Label.font.shadow'\r\n    })\r\n], Label_Label.prototype, \"setTextShadow\", null);\r\nLabel_decorate([\r\n    obsolete({\r\n        message: 'Label.useTextShadow will be removed in v0.26.0',\r\n        alternateMethod: 'Use Label.font.shadow'\r\n    })\r\n], Label_Label.prototype, \"useTextShadow\", null);\r\nLabel_decorate([\r\n    obsolete({\r\n        message: 'Label.clearTextShadow will be removed in v0.26.0',\r\n        alternateMethod: 'Use Label.font.shadow'\r\n    })\r\n], Label_Label.prototype, \"clearTextShadow\", null);\r\n\n;// CONCATENATED MODULE: ./Actions/Index.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Collision/Group/CollisionGroupManager.ts\n\r\n/**\r\n * Static class for managing collision groups in excalibur, there is a maximum of 32 collision groups possible in excalibur\r\n */\r\nclass CollisionGroupManager {\r\n    /**\r\n     * Create a new named collision group up to a max of 32.\r\n     * @param name Name for the collision group\r\n     * @param mask Optionally provide your own 32-bit mask, if none is provide the manager will generate one\r\n     */\r\n    static create(name, mask) {\r\n        if (this._CURRENT_GROUP > this._MAX_GROUPS) {\r\n            throw new Error(`Cannot have more than ${this._MAX_GROUPS} collision groups`);\r\n        }\r\n        if (this._GROUPS.get(name)) {\r\n            throw new Error(`Collision group ${name} already exists`);\r\n        }\r\n        const group = new CollisionGroup(name, this._CURRENT_BIT, mask !== undefined ? mask : ~this._CURRENT_BIT);\r\n        this._CURRENT_BIT = (this._CURRENT_BIT << 1) | 0;\r\n        this._CURRENT_GROUP++;\r\n        this._GROUPS.set(name, group);\r\n        return group;\r\n    }\r\n    /**\r\n     * Get all collision groups currently tracked by excalibur\r\n     */\r\n    static get groups() {\r\n        return Array.from(this._GROUPS.values());\r\n    }\r\n    /**\r\n     * Get a collision group by it's name\r\n     * @param name\r\n     */\r\n    static groupByName(name) {\r\n        return this._GROUPS.get(name);\r\n    }\r\n    /**\r\n     * Resets the managers internal group management state\r\n     */\r\n    static reset() {\r\n        this._GROUPS = new Map();\r\n        this._CURRENT_BIT = this._STARTING_BIT;\r\n        this._CURRENT_GROUP = 1;\r\n    }\r\n}\r\n// using bitmasking the maximum number of groups is 32, because that is the highest 32bit integer that JS can present.\r\nCollisionGroupManager._STARTING_BIT = 0b1 | 0;\r\nCollisionGroupManager._MAX_GROUPS = 32;\r\nCollisionGroupManager._CURRENT_GROUP = 1;\r\nCollisionGroupManager._CURRENT_BIT = CollisionGroupManager._STARTING_BIT;\r\nCollisionGroupManager._GROUPS = new Map();\r\n\n;// CONCATENATED MODULE: ./Collision/Index.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Drawing/Polygon.ts\nvar Polygon_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\n\r\n/**\r\n * Creates a closed polygon drawing given a list of [[Vector]]s.\r\n *\r\n * @deprecated Use [[Polygon]]\r\n * @warning Use sparingly as Polygons are performance intensive\r\n */\r\nlet Polygon = class Polygon {\r\n    /**\r\n     * @param points  The vectors to use to build the polygon in order\r\n     */\r\n    constructor(points) {\r\n        /**\r\n         * The width of the lines of the polygon\r\n         */\r\n        this.lineWidth = 5;\r\n        /**\r\n         * Indicates whether the polygon is filled or not.\r\n         */\r\n        this.filled = false;\r\n        this._points = [];\r\n        this.anchor = Vector.Zero;\r\n        this.offset = Vector.Zero;\r\n        this.rotation = 0;\r\n        this.scale = Vector.One;\r\n        this.opacity = 1;\r\n        this._points = points;\r\n        const minX = this._points.reduce((prev, curr) => {\r\n            return Math.min(prev, curr.x);\r\n        }, 0);\r\n        const maxX = this._points.reduce((prev, curr) => {\r\n            return Math.max(prev, curr.x);\r\n        }, 0);\r\n        this.drawWidth = maxX - minX;\r\n        const minY = this._points.reduce((prev, curr) => {\r\n            return Math.min(prev, curr.y);\r\n        }, 0);\r\n        const maxY = this._points.reduce((prev, curr) => {\r\n            return Math.max(prev, curr.y);\r\n        }, 0);\r\n        this.drawHeight = maxY - minY;\r\n        this.height = this.drawHeight;\r\n        this.width = this.drawWidth;\r\n    }\r\n    /**\r\n     * @notimplemented Effects are not supported on `Polygon`\r\n     */\r\n    addEffect() {\r\n        // not supported on polygons\r\n    }\r\n    /**\r\n     * @notimplemented Effects are not supported on `Polygon`\r\n     */\r\n    removeEffect() {\r\n        // not supported on polygons\r\n    }\r\n    /**\r\n     * @notimplemented Effects are not supported on `Polygon`\r\n     */\r\n    clearEffects() {\r\n        // not supported on polygons\r\n    }\r\n    reset() {\r\n        //pass\r\n    }\r\n    draw(ctxOrOptions, x, y) {\r\n        if (ctxOrOptions instanceof CanvasRenderingContext2D) {\r\n            this._drawWithOptions({ ctx: ctxOrOptions, x, y });\r\n        }\r\n        else {\r\n            this._drawWithOptions(ctxOrOptions);\r\n        }\r\n    }\r\n    _drawWithOptions(options) {\r\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j;\r\n        const { ctx, x, y, rotation, drawWidth, drawHeight, anchor, offset, opacity, flipHorizontal, flipVertical } = {\r\n            ...options,\r\n            rotation: (_a = options.rotation) !== null && _a !== void 0 ? _a : this.rotation,\r\n            drawWidth: (_b = options.drawWidth) !== null && _b !== void 0 ? _b : this.drawWidth,\r\n            drawHeight: (_c = options.drawHeight) !== null && _c !== void 0 ? _c : this.drawHeight,\r\n            flipHorizontal: (_d = options.flipHorizontal) !== null && _d !== void 0 ? _d : this.flipHorizontal,\r\n            flipVertical: (_e = options.flipVertical) !== null && _e !== void 0 ? _e : this.flipVertical,\r\n            anchor: (_f = options.anchor) !== null && _f !== void 0 ? _f : this.anchor,\r\n            offset: (_g = options.offset) !== null && _g !== void 0 ? _g : this.offset,\r\n            opacity: ((_h = options.opacity) !== null && _h !== void 0 ? _h : 1) * ((_j = this.opacity) !== null && _j !== void 0 ? _j : 1)\r\n        };\r\n        const xpoint = drawWidth * anchor.x + offset.x + x;\r\n        const ypoint = drawHeight * anchor.y + offset.y + y;\r\n        ctx.save();\r\n        ctx.translate(xpoint, ypoint);\r\n        ctx.scale(this.scale.x, this.scale.y);\r\n        ctx.rotate(rotation);\r\n        ctx.beginPath();\r\n        ctx.lineWidth = this.lineWidth;\r\n        // Iterate through the supplied points and construct a 'polygon'\r\n        const firstPoint = this._points[0];\r\n        ctx.moveTo(firstPoint.x, firstPoint.y);\r\n        let i = 0;\r\n        const len = this._points.length;\r\n        for (i; i < len; i++) {\r\n            ctx.lineTo(this._points[i].x, this._points[i].y);\r\n        }\r\n        ctx.lineTo(firstPoint.x, firstPoint.y);\r\n        ctx.closePath();\r\n        if (this.filled) {\r\n            ctx.fillStyle = this.fillColor.toString();\r\n            ctx.fill();\r\n        }\r\n        ctx.strokeStyle = this.lineColor.toString();\r\n        if (flipHorizontal) {\r\n            ctx.translate(drawWidth, 0);\r\n            ctx.scale(-1, 1);\r\n        }\r\n        if (flipVertical) {\r\n            ctx.translate(0, drawHeight);\r\n            ctx.scale(1, -1);\r\n        }\r\n        const oldAlpha = ctx.globalAlpha;\r\n        ctx.globalAlpha = opacity;\r\n        ctx.stroke();\r\n        ctx.globalAlpha = oldAlpha;\r\n        ctx.restore();\r\n    }\r\n};\r\nPolygon = Polygon_decorate([\r\n    obsolete({\r\n        message: 'Polygon will be removed in v0.26.0',\r\n        alternateMethod: 'Use Graphics.Polygon'\r\n    })\r\n], Polygon);\r\n\r\n\n;// CONCATENATED MODULE: ./Drawing/Index.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Interfaces/AudioImplementation.ts\nclass ExResponse {\r\n}\r\nExResponse.type = {\r\n    any: '',\r\n    blob: 'blob',\r\n    json: 'json',\r\n    text: 'text',\r\n    document: 'document',\r\n    arraybuffer: 'arraybuffer'\r\n};\r\n\n;// CONCATENATED MODULE: ./Interfaces/LifecycleEvents.ts\n/**\r\n * Type guard checking for internal initialize method\r\n * @internal\r\n * @param a\r\n */\r\nfunction has_initialize(a) {\r\n    return !!a._initialize;\r\n}\r\n/**\r\n *\r\n */\r\nfunction hasOnInitialize(a) {\r\n    return !!a.onInitialize;\r\n}\r\n/**\r\n *\r\n */\r\nfunction has_preupdate(a) {\r\n    return !!a._preupdate;\r\n}\r\n/**\r\n *\r\n */\r\nfunction hasOnPreUpdate(a) {\r\n    return !!a.onPreUpdate;\r\n}\r\n/**\r\n *\r\n */\r\nfunction has_postupdate(a) {\r\n    return !!a.onPostUpdate;\r\n}\r\n/**\r\n *\r\n */\r\nfunction hasOnPostUpdate(a) {\r\n    return !!a.onPostUpdate;\r\n}\r\n/**\r\n *\r\n */\r\nfunction hasPreDraw(a) {\r\n    return !!a.onPreDraw;\r\n}\r\n/**\r\n *\r\n */\r\nfunction hasPostDraw(a) {\r\n    return !!a.onPostDraw;\r\n}\r\n\n;// CONCATENATED MODULE: ./Interfaces/Index.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Resources/Sound/WebAudioInstance.ts\n\r\n\r\n/**\r\n * Internal class representing a Web Audio AudioBufferSourceNode instance\r\n * @see https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API\r\n */\r\nclass WebAudioInstance {\r\n    constructor(_src) {\r\n        this._src = _src;\r\n        this._volume = 1;\r\n        this._duration = undefined;\r\n        this._loop = false;\r\n        this._isPlaying = false;\r\n        this._isPaused = false;\r\n        this._audioContext = AudioContextFactory.create();\r\n        this._volumeNode = this._audioContext.createGain();\r\n        /**\r\n         * Current playback offset (in seconds)\r\n         */\r\n        this._currentOffset = 0;\r\n        this._createNewBufferSource();\r\n    }\r\n    set loop(value) {\r\n        this._loop = value;\r\n        if (this._instance) {\r\n            this._instance.loop = value;\r\n            this._wireUpOnEnded();\r\n        }\r\n    }\r\n    get loop() {\r\n        return this._loop;\r\n    }\r\n    set volume(value) {\r\n        value = clamp(value, 0, 1.0);\r\n        this._volume = value;\r\n        if (this._isPlaying && this._volumeNode.gain.setTargetAtTime) {\r\n            // https://developer.mozilla.org/en-US/docs/Web/API/AudioParam/setTargetAtTime\r\n            // After each .1 seconds timestep, the target value will ~63.2% closer to the target value.\r\n            // This exponential ramp provides a more pleasant transition in gain\r\n            this._volumeNode.gain.setTargetAtTime(value, this._audioContext.currentTime, 0.1);\r\n        }\r\n        else {\r\n            this._volumeNode.gain.value = value;\r\n        }\r\n    }\r\n    get volume() {\r\n        return this._volume;\r\n    }\r\n    set duration(value) {\r\n        this._duration = value;\r\n    }\r\n    /**\r\n     * Duration of the sound, in seconds.\r\n     */\r\n    get duration() {\r\n        return this._duration;\r\n    }\r\n    get _playbackRate() {\r\n        return this._instance ? 1 / (this._instance.playbackRate.value || 1.0) : null;\r\n    }\r\n    isPlaying() {\r\n        return this._isPlaying;\r\n    }\r\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\r\n    play(playStarted = () => { }) {\r\n        if (this._isPaused) {\r\n            this._resumePlayBack();\r\n            playStarted();\r\n        }\r\n        if (!this._isPlaying) {\r\n            this._startPlayBack();\r\n            playStarted();\r\n        }\r\n        return this._playingPromise;\r\n    }\r\n    pause() {\r\n        if (!this._isPlaying) {\r\n            return;\r\n        }\r\n        this._isPaused = true;\r\n        this._isPlaying = false;\r\n        this._instance.stop(0);\r\n        // Playback rate will be a scale factor of how fast/slow the audio is being played\r\n        // default is 1.0\r\n        // we need to invert it to get the time scale\r\n        this._setPauseOffset();\r\n    }\r\n    stop() {\r\n        if (!this._isPlaying) {\r\n            return;\r\n        }\r\n        this._isPlaying = false;\r\n        this._isPaused = false;\r\n        this._currentOffset = 0;\r\n        this._instance.stop(0);\r\n        // handler will not be wired up if we were looping\r\n        if (!this._instance.onended) {\r\n            this._handleOnEnded();\r\n        }\r\n    }\r\n    _startPlayBack() {\r\n        this._isPlaying = true;\r\n        this._isPaused = false;\r\n        this._playingPromise = new Promise((resolve) => {\r\n            this._playingResolve = resolve;\r\n        });\r\n        if (!this._instance) {\r\n            this._createNewBufferSource();\r\n        }\r\n        this._rememberStartTime();\r\n        this._volumeNode.connect(this._audioContext.destination);\r\n        this._instance.start(0, 0);\r\n        this._currentOffset = 0;\r\n        this._wireUpOnEnded();\r\n    }\r\n    _resumePlayBack() {\r\n        if (!this._isPaused) {\r\n            return;\r\n        }\r\n        this._isPaused = false;\r\n        this._isPlaying = true;\r\n        // a buffer source can only be started once\r\n        // so we need to dispose of the previous instance before\r\n        // \"resuming\" the next one\r\n        this._instance.onended = null; // dispose of any previous event handler\r\n        this._createNewBufferSource();\r\n        const duration = this._playbackRate * this._src.duration;\r\n        const restartTime = this._currentOffset % duration;\r\n        this._rememberStartTime(restartTime * -1000);\r\n        this._instance.start(0, restartTime);\r\n        this._wireUpOnEnded();\r\n    }\r\n    _wireUpOnEnded() {\r\n        if (!this.loop) {\r\n            this._instance.onended = () => this._handleOnEnded();\r\n        }\r\n    }\r\n    _handleOnEnded() {\r\n        // pausing calls stop(0) which triggers onended event\r\n        // so we don't \"resolve\" yet (when we resume we'll try again)\r\n        if (!this._isPaused) {\r\n            this._isPlaying = false;\r\n            this._playingResolve(true);\r\n        }\r\n    }\r\n    _rememberStartTime(amend) {\r\n        this._startTime = new Date().getTime() + (amend | 0);\r\n    }\r\n    _setPauseOffset() {\r\n        this._currentOffset = ((new Date().getTime() - this._startTime) * this._playbackRate) / 1000; // in seconds\r\n    }\r\n    _createNewBufferSource() {\r\n        this._instance = this._audioContext.createBufferSource();\r\n        this._instance.buffer = this._src;\r\n        this._instance.loop = this.loop;\r\n        this._instance.playbackRate.setValueAtTime(1.0, 0);\r\n        this._instance.connect(this._volumeNode);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Sound.ts\n\r\n/**\r\n * Whether or not the browser can play this file as HTML5 Audio\r\n */\r\nfunction canPlayFile(file) {\r\n    try {\r\n        const a = new Audio();\r\n        const filetype = /.*\\.([A-Za-z0-9]+)$/;\r\n        const type = file.match(filetype)[1];\r\n        if (a.canPlayType('audio/' + type)) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    catch (e) {\r\n        Logger.getInstance().warn('Cannot determine audio support, assuming no support for the Audio Tag', e);\r\n        return false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Resources/Sound/Sound.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * The [[Sound]] object allows games built in Excalibur to load audio\r\n * components, from soundtracks to sound effects. [[Sound]] is an [[Loadable]]\r\n * which means it can be passed to a [[Loader]] to pre-load before a game or level.\r\n */\r\nclass Sound extends Class {\r\n    /**\r\n     * @param paths A list of audio sources (clip.wav, clip.mp3, clip.ogg) for this audio clip. This is done for browser compatibility.\r\n     */\r\n    constructor(...paths) {\r\n        super();\r\n        this.logger = Logger.getInstance();\r\n        this._loop = false;\r\n        this._volume = 1;\r\n        this._duration = undefined;\r\n        this._isStopped = false;\r\n        this._isPaused = false;\r\n        this._tracks = [];\r\n        this._wasPlayingOnHidden = false;\r\n        this._audioContext = AudioContextFactory.create();\r\n        this._resource = new Resource('', ExResponse.type.arraybuffer);\r\n        /**\r\n         * Chrome : MP3, WAV, Ogg\r\n         * Firefox : WAV, Ogg,\r\n         * IE : MP3, WAV coming soon\r\n         * Safari MP3, WAV, Ogg\r\n         */\r\n        for (const path of paths) {\r\n            if (canPlayFile(path)) {\r\n                this.path = path;\r\n                break;\r\n            }\r\n        }\r\n        if (!this.path) {\r\n            this.logger.warn('This browser does not support any of the audio files specified:', paths.join(', '));\r\n            this.logger.warn('Attempting to use', paths[0]);\r\n            this.path = paths[0]; // select the first specified\r\n        }\r\n    }\r\n    /**\r\n     * Indicates whether the clip should loop when complete\r\n     * @param value  Set the looping flag\r\n     */\r\n    set loop(value) {\r\n        this._loop = value;\r\n        for (const track of this._tracks) {\r\n            track.loop = this._loop;\r\n        }\r\n        this.logger.debug('Set loop for all instances of sound', this.path, 'to', this._loop);\r\n    }\r\n    get loop() {\r\n        return this._loop;\r\n    }\r\n    set volume(value) {\r\n        this._volume = value;\r\n        for (const track of this._tracks) {\r\n            track.volume = this._volume;\r\n        }\r\n        this.emit('volumechange', new NativeSoundEvent(this));\r\n        this.logger.debug('Set loop for all instances of sound', this.path, 'to', this._volume);\r\n    }\r\n    get volume() {\r\n        return this._volume;\r\n    }\r\n    get duration() {\r\n        return this._duration;\r\n    }\r\n    /**\r\n     * Return array of Current AudioInstances playing or being paused\r\n     */\r\n    get instances() {\r\n        return this._tracks;\r\n    }\r\n    get path() {\r\n        return this._resource.path;\r\n    }\r\n    set path(val) {\r\n        this._resource.path = val;\r\n    }\r\n    isLoaded() {\r\n        return !!this.data;\r\n    }\r\n    async load() {\r\n        if (this.data) {\r\n            return this.data;\r\n        }\r\n        const arraybuffer = await this._resource.load();\r\n        const audiobuffer = await this.decodeAudio(arraybuffer.slice(0));\r\n        this._duration = typeof audiobuffer === 'object' ? audiobuffer.duration : undefined;\r\n        this.emit('processed', new NativeSoundProcessedEvent(this, audiobuffer));\r\n        return this.data = audiobuffer;\r\n    }\r\n    async decodeAudio(data) {\r\n        try {\r\n            return await this._audioContext.decodeAudioData(data.slice(0));\r\n        }\r\n        catch (e) {\r\n            this.logger.error('Unable to decode ' +\r\n                ' this browser may not fully support this format, or the file may be corrupt, ' +\r\n                'if this is an mp3 try removing id3 tags and album art from the file.');\r\n            return await Promise.reject();\r\n        }\r\n    }\r\n    wireEngine(engine) {\r\n        if (engine) {\r\n            this._engine = engine;\r\n            this._engine.on('hidden', () => {\r\n                if (engine.pauseAudioWhenHidden && this.isPlaying()) {\r\n                    this._wasPlayingOnHidden = true;\r\n                    this.pause();\r\n                }\r\n            });\r\n            this._engine.on('visible', () => {\r\n                if (engine.pauseAudioWhenHidden && this._wasPlayingOnHidden) {\r\n                    this.play();\r\n                    this._wasPlayingOnHidden = false;\r\n                }\r\n            });\r\n            this._engine.on('start', () => {\r\n                this._isStopped = false;\r\n            });\r\n            this._engine.on('stop', () => {\r\n                this.stop();\r\n                this._isStopped = true;\r\n            });\r\n        }\r\n    }\r\n    /**\r\n     * Returns how many instances of the sound are currently playing\r\n     */\r\n    instanceCount() {\r\n        return this._tracks.length;\r\n    }\r\n    /**\r\n     * Whether or not the sound is playing right now\r\n     */\r\n    isPlaying() {\r\n        return this._tracks.some((t) => t.isPlaying());\r\n    }\r\n    /**\r\n     * Play the sound, returns a promise that resolves when the sound is done playing\r\n     * An optional volume argument can be passed in to play the sound. Max volume is 1.0\r\n     */\r\n    play(volume) {\r\n        if (!this.isLoaded()) {\r\n            this.logger.warn('Cannot start playing. Resource', this.path, 'is not loaded yet');\r\n            return Promise.resolve(true);\r\n        }\r\n        if (this._isStopped) {\r\n            this.logger.warn('Cannot start playing. Engine is in a stopped state.');\r\n            return Promise.resolve(false);\r\n        }\r\n        this.volume = volume || this.volume;\r\n        if (this._isPaused) {\r\n            return this._resumePlayback();\r\n        }\r\n        else {\r\n            return this._startPlayback();\r\n        }\r\n    }\r\n    /**\r\n     * Stop the sound, and do not rewind\r\n     */\r\n    pause() {\r\n        if (!this.isPlaying()) {\r\n            return;\r\n        }\r\n        for (const track of this._tracks) {\r\n            track.pause();\r\n        }\r\n        this._isPaused = true;\r\n        this.emit('pause', new NativeSoundEvent(this));\r\n        this.logger.debug('Paused all instances of sound', this.path);\r\n    }\r\n    /**\r\n     * Stop the sound if it is currently playing and rewind the track. If the sound is not playing, rewinds the track.\r\n     */\r\n    stop() {\r\n        for (const track of this._tracks) {\r\n            track.stop();\r\n        }\r\n        this.emit('stop', new NativeSoundEvent(this));\r\n        this._isPaused = false;\r\n        this._tracks.length = 0;\r\n        this.logger.debug('Stopped all instances of sound', this.path);\r\n    }\r\n    /**\r\n     * Get Id of provided AudioInstance in current trackList\r\n     * @param track [[Audio]] which Id is to be given\r\n     */\r\n    getTrackId(track) {\r\n        return this._tracks.indexOf(track);\r\n    }\r\n    async _resumePlayback() {\r\n        if (this._isPaused) {\r\n            const resumed = [];\r\n            // ensure we resume *current* tracks (if paused)\r\n            for (const track of this._tracks) {\r\n                resumed.push(track.play());\r\n            }\r\n            this._isPaused = false;\r\n            this.emit('resume', new NativeSoundEvent(this));\r\n            this.logger.debug('Resuming paused instances for sound', this.path, this._tracks);\r\n            // resolve when resumed tracks are done\r\n            await Promise.all(resumed);\r\n        }\r\n        return true;\r\n    }\r\n    /**\r\n     * Starts playback, returns a promise that resolves when playback is complete\r\n     */\r\n    async _startPlayback() {\r\n        const track = await this._getTrackInstance(this.data);\r\n        const complete = await track.play(() => {\r\n            this.emit('playbackstart', new NativeSoundEvent(this, track));\r\n            this.logger.debug('Playing new instance for sound', this.path);\r\n        });\r\n        // when done, remove track\r\n        this.emit('playbackend', new NativeSoundEvent(this, track));\r\n        this._tracks.splice(this.getTrackId(track), 1);\r\n        return complete;\r\n    }\r\n    _getTrackInstance(data) {\r\n        const newTrack = new WebAudioInstance(data);\r\n        newTrack.loop = this.loop;\r\n        newTrack.volume = this.volume;\r\n        newTrack.duration = this.duration;\r\n        this._tracks.push(newTrack);\r\n        return newTrack;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Resources/Sound/Index.ts\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Resources/Gif.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * The [[Texture]] object allows games built in Excalibur to load image resources.\r\n * [[Texture]] is an [[Loadable]] which means it can be passed to a [[Loader]]\r\n * to pre-load before starting a level or game.\r\n */\r\nclass Gif {\r\n    /**\r\n     * @param path       Path to the image resource\r\n     * @param color      Optionally set the color to treat as transparent the gif, by default [[Color.Magenta]]\r\n     * @param bustCache  Optionally load texture with cache busting\r\n     */\r\n    constructor(path, color = Color.Magenta, bustCache = true) {\r\n        this.path = path;\r\n        this.color = color;\r\n        this.bustCache = bustCache;\r\n        this._stream = null;\r\n        this._gif = null;\r\n        this._textures = [];\r\n        this._animation = null;\r\n        this._transparentColor = null;\r\n        this._resource = new Resource(path, 'arraybuffer', bustCache);\r\n        this._transparentColor = color;\r\n    }\r\n    /**\r\n     * Begins loading the texture and returns a promise to be resolved on completion\r\n     */\r\n    async load() {\r\n        const arraybuffer = await this._resource.load();\r\n        this._stream = new Stream(arraybuffer);\r\n        this._gif = new ParseGif(this._stream, this._transparentColor);\r\n        const images = this._gif.images.map(i => new ImageSource(i.src, false));\r\n        // Load all textures\r\n        await Promise.all(images.map(t => t.load()));\r\n        return this.data = this._textures = images;\r\n    }\r\n    isLoaded() {\r\n        return !!this.data;\r\n    }\r\n    /**\r\n     * Return a frame of the gif as a legacy sprite by index\r\n     * @deprecated\r\n     */\r\n    toLegacySprite(id = 0) {\r\n        return Sprite.toLegacySprite(this.toSprite(id));\r\n    }\r\n    /**\r\n     * Return the gif as a legacy spritesheet\r\n     * @deprecated\r\n     */\r\n    toLegacySpriteSheet() {\r\n        return SpriteSheet.toLegacySpriteSheet(this.toSpriteSheet());\r\n    }\r\n    /**\r\n     * Return the gif as a legacy animation\r\n     * @deprecated\r\n     * @param engine\r\n     * @param speed\r\n     */\r\n    toLegacyAnimation(engine, speed) {\r\n        return Animation.toLegacyAnimation(engine, this.toAnimation(speed));\r\n    }\r\n    /**\r\n     * Return a frame of the gif as a sprite by id\r\n     * @param id\r\n     */\r\n    toSprite(id = 0) {\r\n        const sprite = this._textures[id].toSprite();\r\n        return sprite;\r\n    }\r\n    /**\r\n     * Return the gif as a spritesheet\r\n     */\r\n    toSpriteSheet() {\r\n        const sprites = this._textures.map((image) => {\r\n            return image.toSprite();\r\n        });\r\n        return new SpriteSheet({ sprites });\r\n    }\r\n    /**\r\n     * Transform the GIF into an animation with duration per frame\r\n     */\r\n    toAnimation(durationPerFrameMs) {\r\n        const spriteSheet = this.toSpriteSheet();\r\n        const length = spriteSheet.sprites.length;\r\n        this._animation = Animation.fromSpriteSheet(spriteSheet, range(0, length), durationPerFrameMs);\r\n        return this._animation;\r\n    }\r\n    get readCheckBytes() {\r\n        return this._gif.checkBytes;\r\n    }\r\n}\r\nconst bitsToNum = (ba) => {\r\n    return ba.reduce(function (s, n) {\r\n        return s * 2 + n;\r\n    }, 0);\r\n};\r\nconst byteToBitArr = (bite) => {\r\n    const a = [];\r\n    for (let i = 7; i >= 0; i--) {\r\n        a.push(!!(bite & (1 << i)));\r\n    }\r\n    return a;\r\n};\r\nclass Stream {\r\n    constructor(dataArray) {\r\n        this.data = null;\r\n        this.len = 0;\r\n        this.position = 0;\r\n        this.readByte = () => {\r\n            if (this.position >= this.data.byteLength) {\r\n                throw new Error('Attempted to read past end of stream.');\r\n            }\r\n            return this.data[this.position++];\r\n        };\r\n        this.readBytes = (n) => {\r\n            const bytes = [];\r\n            for (let i = 0; i < n; i++) {\r\n                bytes.push(this.readByte());\r\n            }\r\n            return bytes;\r\n        };\r\n        this.read = (n) => {\r\n            let s = '';\r\n            for (let i = 0; i < n; i++) {\r\n                s += String.fromCharCode(this.readByte());\r\n            }\r\n            return s;\r\n        };\r\n        this.readUnsigned = () => {\r\n            // Little-endian.\r\n            const a = this.readBytes(2);\r\n            return (a[1] << 8) + a[0];\r\n        };\r\n        this.data = new Uint8Array(dataArray);\r\n        this.len = this.data.byteLength;\r\n        if (this.len === 0) {\r\n            throw new Error('No data loaded from file');\r\n        }\r\n    }\r\n}\r\nconst lzwDecode = function (minCodeSize, data) {\r\n    // TODO: Now that the GIF parser is a bit different, maybe this should get an array of bytes instead of a String?\r\n    let pos = 0; // Maybe this streaming thing should be merged with the Stream?\r\n    const readCode = function (size) {\r\n        let code = 0;\r\n        for (let i = 0; i < size; i++) {\r\n            if (data.charCodeAt(pos >> 3) & (1 << (pos & 7))) {\r\n                code |= 1 << i;\r\n            }\r\n            pos++;\r\n        }\r\n        return code;\r\n    };\r\n    const output = [];\r\n    const clearCode = 1 << minCodeSize;\r\n    const eoiCode = clearCode + 1;\r\n    let codeSize = minCodeSize + 1;\r\n    let dict = [];\r\n    const clear = function () {\r\n        dict = [];\r\n        codeSize = minCodeSize + 1;\r\n        for (let i = 0; i < clearCode; i++) {\r\n            dict[i] = [i];\r\n        }\r\n        dict[clearCode] = [];\r\n        dict[eoiCode] = null;\r\n    };\r\n    let code;\r\n    let last;\r\n    while (true) {\r\n        last = code;\r\n        code = readCode(codeSize);\r\n        if (code === clearCode) {\r\n            clear();\r\n            continue;\r\n        }\r\n        if (code === eoiCode) {\r\n            break;\r\n        }\r\n        if (code < dict.length) {\r\n            if (last !== clearCode) {\r\n                dict.push(dict[last].concat(dict[code][0]));\r\n            }\r\n        }\r\n        else {\r\n            if (code !== dict.length) {\r\n                throw new Error('Invalid LZW code.');\r\n            }\r\n            dict.push(dict[last].concat(dict[last][0]));\r\n        }\r\n        output.push.apply(output, dict[code]);\r\n        if (dict.length === 1 << codeSize && codeSize < 12) {\r\n            // If we're at the last code and codeSize is 12, the next code will be a clearCode, and it'll be 12 bits long.\r\n            codeSize++;\r\n        }\r\n    }\r\n    // I don't know if this is technically an error, but some GIFs do it.\r\n    //if (Math.ceil(pos / 8) !== data.length) throw new Error('Extraneous LZW bytes.');\r\n    return output;\r\n};\r\n// The actual parsing; returns an object with properties.\r\nclass ParseGif {\r\n    constructor(stream, color = Color.Magenta) {\r\n        this._st = null;\r\n        this._handler = {};\r\n        this._transparentColor = null;\r\n        this.frames = [];\r\n        this.images = [];\r\n        this.globalColorTable = [];\r\n        this.checkBytes = [];\r\n        // LZW (GIF-specific)\r\n        this.parseColorTable = (entries) => {\r\n            // Each entry is 3 bytes, for RGB.\r\n            const ct = [];\r\n            for (let i = 0; i < entries; i++) {\r\n                const rgb = this._st.readBytes(3);\r\n                const rgba = '#' +\r\n                    rgb\r\n                        .map((x) => {\r\n                        const hex = x.toString(16);\r\n                        return hex.length === 1 ? '0' + hex : hex;\r\n                    })\r\n                        .join('');\r\n                ct.push(rgba);\r\n            }\r\n            return ct;\r\n        };\r\n        this.readSubBlocks = () => {\r\n            let size, data;\r\n            data = '';\r\n            do {\r\n                size = this._st.readByte();\r\n                data += this._st.read(size);\r\n            } while (size !== 0);\r\n            return data;\r\n        };\r\n        this.parseHeader = () => {\r\n            const hdr = {\r\n                sig: null,\r\n                ver: null,\r\n                width: null,\r\n                height: null,\r\n                colorRes: null,\r\n                globalColorTableSize: null,\r\n                gctFlag: null,\r\n                sorted: null,\r\n                globalColorTable: [],\r\n                bgColor: null,\r\n                pixelAspectRatio: null // if not 0, aspectRatio = (pixelAspectRatio + 15) / 64\r\n            };\r\n            hdr.sig = this._st.read(3);\r\n            hdr.ver = this._st.read(3);\r\n            if (hdr.sig !== 'GIF') {\r\n                throw new Error('Not a GIF file.'); // XXX: This should probably be handled more nicely.\r\n            }\r\n            hdr.width = this._st.readUnsigned();\r\n            hdr.height = this._st.readUnsigned();\r\n            const bits = byteToBitArr(this._st.readByte());\r\n            hdr.gctFlag = bits.shift();\r\n            hdr.colorRes = bitsToNum(bits.splice(0, 3));\r\n            hdr.sorted = bits.shift();\r\n            hdr.globalColorTableSize = bitsToNum(bits.splice(0, 3));\r\n            hdr.bgColor = this._st.readByte();\r\n            hdr.pixelAspectRatio = this._st.readByte(); // if not 0, aspectRatio = (pixelAspectRatio + 15) / 64\r\n            if (hdr.gctFlag) {\r\n                hdr.globalColorTable = this.parseColorTable(1 << (hdr.globalColorTableSize + 1));\r\n                this.globalColorTable = hdr.globalColorTable;\r\n            }\r\n            if (this._handler.hdr && this._handler.hdr(hdr)) {\r\n                this.checkBytes.push(this._handler.hdr);\r\n            }\r\n        };\r\n        this.parseExt = (block) => {\r\n            const parseGCExt = (block) => {\r\n                this.checkBytes.push(this._st.readByte()); // Always 4\r\n                const bits = byteToBitArr(this._st.readByte());\r\n                block.reserved = bits.splice(0, 3); // Reserved; should be 000.\r\n                block.disposalMethod = bitsToNum(bits.splice(0, 3));\r\n                block.userInput = bits.shift();\r\n                block.transparencyGiven = bits.shift();\r\n                block.delayTime = this._st.readUnsigned();\r\n                block.transparencyIndex = this._st.readByte();\r\n                block.terminator = this._st.readByte();\r\n                if (this._handler.gce && this._handler.gce(block)) {\r\n                    this.checkBytes.push(this._handler.gce);\r\n                }\r\n            };\r\n            const parseComExt = (block) => {\r\n                block.comment = this.readSubBlocks();\r\n                if (this._handler.com && this._handler.com(block)) {\r\n                    this.checkBytes.push(this._handler.com);\r\n                }\r\n            };\r\n            const parsePTExt = (block) => {\r\n                this.checkBytes.push(this._st.readByte()); // Always 12\r\n                block.ptHeader = this._st.readBytes(12);\r\n                block.ptData = this.readSubBlocks();\r\n                if (this._handler.pte && this._handler.pte(block)) {\r\n                    this.checkBytes.push(this._handler.pte);\r\n                }\r\n            };\r\n            const parseAppExt = (block) => {\r\n                const parseNetscapeExt = (block) => {\r\n                    this.checkBytes.push(this._st.readByte()); // Always 3\r\n                    block.unknown = this._st.readByte(); // Q: Always 1? What is this?\r\n                    block.iterations = this._st.readUnsigned();\r\n                    block.terminator = this._st.readByte();\r\n                    if (this._handler.app && this._handler.app.NETSCAPE && this._handler.app.NETSCAPE(block)) {\r\n                        this.checkBytes.push(this._handler.app);\r\n                    }\r\n                };\r\n                const parseUnknownAppExt = (block) => {\r\n                    block.appData = this.readSubBlocks();\r\n                    // FIXME: This won't work if a handler wants to match on any identifier.\r\n                    if (this._handler.app && this._handler.app[block.identifier] && this._handler.app[block.identifier](block)) {\r\n                        this.checkBytes.push(this._handler.app[block.identifier]);\r\n                    }\r\n                };\r\n                this.checkBytes.push(this._st.readByte()); // Always 11\r\n                block.identifier = this._st.read(8);\r\n                block.authCode = this._st.read(3);\r\n                switch (block.identifier) {\r\n                    case 'NETSCAPE':\r\n                        parseNetscapeExt(block);\r\n                        break;\r\n                    default:\r\n                        parseUnknownAppExt(block);\r\n                        break;\r\n                }\r\n            };\r\n            const parseUnknownExt = (block) => {\r\n                block.data = this.readSubBlocks();\r\n                if (this._handler.unknown && this._handler.unknown(block)) {\r\n                    this.checkBytes.push(this._handler.unknown);\r\n                }\r\n            };\r\n            block.label = this._st.readByte();\r\n            switch (block.label) {\r\n                case 0xf9:\r\n                    block.extType = 'gce';\r\n                    parseGCExt(block);\r\n                    break;\r\n                case 0xfe:\r\n                    block.extType = 'com';\r\n                    parseComExt(block);\r\n                    break;\r\n                case 0x01:\r\n                    block.extType = 'pte';\r\n                    parsePTExt(block);\r\n                    break;\r\n                case 0xff:\r\n                    block.extType = 'app';\r\n                    parseAppExt(block);\r\n                    break;\r\n                default:\r\n                    block.extType = 'unknown';\r\n                    parseUnknownExt(block);\r\n                    break;\r\n            }\r\n        };\r\n        this.parseImg = (img) => {\r\n            const deinterlace = (pixels, width) => {\r\n                // Of course this defeats the purpose of interlacing. And it's *probably*\r\n                // the least efficient way it's ever been implemented. But nevertheless...\r\n                const newPixels = new Array(pixels.length);\r\n                const rows = pixels.length / width;\r\n                const cpRow = (toRow, fromRow) => {\r\n                    const fromPixels = pixels.slice(fromRow * width, (fromRow + 1) * width);\r\n                    newPixels.splice.apply(newPixels, [toRow * width, width].concat(fromPixels));\r\n                };\r\n                const offsets = [0, 4, 2, 1];\r\n                const steps = [8, 8, 4, 2];\r\n                let fromRow = 0;\r\n                for (let pass = 0; pass < 4; pass++) {\r\n                    for (let toRow = offsets[pass]; toRow < rows; toRow += steps[pass]) {\r\n                        cpRow(toRow, fromRow);\r\n                        fromRow++;\r\n                    }\r\n                }\r\n                return newPixels;\r\n            };\r\n            img.leftPos = this._st.readUnsigned();\r\n            img.topPos = this._st.readUnsigned();\r\n            img.width = this._st.readUnsigned();\r\n            img.height = this._st.readUnsigned();\r\n            const bits = byteToBitArr(this._st.readByte());\r\n            img.lctFlag = bits.shift();\r\n            img.interlaced = bits.shift();\r\n            img.sorted = bits.shift();\r\n            img.reserved = bits.splice(0, 2);\r\n            img.lctSize = bitsToNum(bits.splice(0, 3));\r\n            if (img.lctFlag) {\r\n                img.lct = this.parseColorTable(1 << (img.lctSize + 1));\r\n            }\r\n            img.lzwMinCodeSize = this._st.readByte();\r\n            const lzwData = this.readSubBlocks();\r\n            img.pixels = lzwDecode(img.lzwMinCodeSize, lzwData);\r\n            if (img.interlaced) {\r\n                // Move\r\n                img.pixels = deinterlace(img.pixels, img.width);\r\n            }\r\n            this.frames.push(img);\r\n            this.arrayToImage(img);\r\n            if (this._handler.img && this._handler.img(img)) {\r\n                this.checkBytes.push(this._handler);\r\n            }\r\n        };\r\n        this.parseBlock = () => {\r\n            const block = {\r\n                sentinel: this._st.readByte(),\r\n                type: ''\r\n            };\r\n            const blockChar = String.fromCharCode(block.sentinel);\r\n            switch (blockChar) {\r\n                case '!':\r\n                    block.type = 'ext';\r\n                    this.parseExt(block);\r\n                    break;\r\n                case ',':\r\n                    block.type = 'img';\r\n                    this.parseImg(block);\r\n                    break;\r\n                case ';':\r\n                    block.type = 'eof';\r\n                    if (this._handler.eof && this._handler.eof(block)) {\r\n                        this.checkBytes.push(this._handler.eof);\r\n                    }\r\n                    break;\r\n                default:\r\n                    throw new Error('Unknown block: 0x' + block.sentinel.toString(16));\r\n            }\r\n            if (block.type !== 'eof') {\r\n                this.parseBlock();\r\n            }\r\n        };\r\n        this.arrayToImage = (frame) => {\r\n            let count = 0;\r\n            const c = document.createElement('canvas');\r\n            c.id = count.toString();\r\n            c.width = frame.width;\r\n            c.height = frame.height;\r\n            count++;\r\n            const context = c.getContext('2d');\r\n            const pixSize = 1;\r\n            let y = 0;\r\n            let x = 0;\r\n            for (let i = 0; i < frame.pixels.length; i++) {\r\n                if (x % frame.width === 0) {\r\n                    y++;\r\n                    x = 0;\r\n                }\r\n                if (this.globalColorTable[frame.pixels[i]] === this._transparentColor.toHex()) {\r\n                    context.fillStyle = `rgba(0, 0, 0, 0)`;\r\n                }\r\n                else {\r\n                    context.fillStyle = this.globalColorTable[frame.pixels[i]];\r\n                }\r\n                context.fillRect(x, y, pixSize, pixSize);\r\n                x++;\r\n            }\r\n            const img = new Image();\r\n            img.src = c.toDataURL();\r\n            this.images.push(img);\r\n        };\r\n        this._st = stream;\r\n        this._handler = {};\r\n        this._transparentColor = color;\r\n        this.parseHeader();\r\n        this.parseBlock();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Resources/Index.ts\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/index.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Graphics/Polygon.ts\n\r\n\r\n\r\n/**\r\n * A polygon [[Graphic]] for drawing arbitrary polygons to the [[ExcaliburGraphicsContext]]\r\n *\r\n * Polygons default to [[ImageFiltering.Blended]]\r\n */\r\nclass Polygon_Polygon extends Raster {\r\n    constructor(options) {\r\n        super(options);\r\n        this.points = options.points;\r\n        this.filtering = ImageFiltering.Blended;\r\n        this.rasterize();\r\n    }\r\n    get points() {\r\n        return this._points;\r\n    }\r\n    set points(points) {\r\n        this._points = points;\r\n        const min = this.minPoint;\r\n        this.width = this._points.reduce((max, p) => Math.max(p.x, max), 0) - min.x;\r\n        this.height = this._points.reduce((max, p) => Math.max(p.y, max), 0) - min.y;\r\n        this.flagDirty();\r\n    }\r\n    get minPoint() {\r\n        const minX = this._points.reduce((min, p) => Math.min(p.x, min), Infinity);\r\n        const minY = this._points.reduce((min, p) => Math.min(p.y, min), Infinity);\r\n        return vec(minX, minY);\r\n    }\r\n    clone() {\r\n        return new Polygon_Polygon({\r\n            points: this.points.map((p) => p.clone()),\r\n            ...this.cloneGraphicOptions(),\r\n            ...this.cloneRasterOptions()\r\n        });\r\n    }\r\n    execute(ctx) {\r\n        if (this.points && this.points.length) {\r\n            ctx.beginPath();\r\n            // Iterate through the supplied points and construct a 'polygon'\r\n            const min = this.minPoint.negate();\r\n            const firstPoint = this.points[0].add(min);\r\n            ctx.moveTo(firstPoint.x, firstPoint.y);\r\n            this.points.forEach((point) => {\r\n                ctx.lineTo(point.x + min.x, point.y + min.y);\r\n            });\r\n            ctx.lineTo(firstPoint.x, firstPoint.y);\r\n            ctx.closePath();\r\n            if (this.color) {\r\n                ctx.fill();\r\n            }\r\n            if (this.strokeColor) {\r\n                ctx.stroke();\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/index.ts\n// Graphics\r\n\r\n\r\n\r\n\r\n\r\n\r\n// Graphics ECS\r\n\r\n\r\n\r\n// Raster graphics\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// Post Processor\r\n\r\n\r\n\r\n\r\n\r\n\r\n// Rendering\r\n\r\n\r\n\r\n\r\n\r\n// Util\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Input/Index.ts\n/**\r\n * @module\r\n * Provides support for mice, keyboards, and controllers.\r\n */\r\n/**\r\n * @typedoc\r\n */\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Traits/Index.ts\n/**\r\n * @module\r\n */\r\n\r\n\n;// CONCATENATED MODULE: ./Util/Index.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Util/SortedList.ts\nvar SortedList_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\n/**\r\n * A sorted list implementation. NOTE: this implementation is not self-balancing\r\n * @deprecated WIll be removed in v0.26.0 Use built in JS array.sort\r\n */\r\nlet SortedList = class SortedList {\r\n    constructor(getComparable) {\r\n        this._getComparable = getComparable;\r\n    }\r\n    find(element) {\r\n        return this._find(this._root, element);\r\n    }\r\n    _find(node, element) {\r\n        if (node == null) {\r\n            return false;\r\n        }\r\n        else if (this._getComparable(element) === node.getKey()) {\r\n            if (node.getData().indexOf(element) > -1) {\r\n                return true;\r\n            }\r\n            else {\r\n                return false;\r\n            }\r\n        }\r\n        else if (this._getComparable(element) < node.getKey()) {\r\n            return this._find(node.getLeft(), element);\r\n        }\r\n        else {\r\n            return this._find(node.getRight(), element);\r\n        }\r\n    }\r\n    // returns the array of elements at a specific key value\r\n    get(key) {\r\n        return this._get(this._root, key);\r\n    }\r\n    _get(node, key) {\r\n        if (node == null) {\r\n            return [];\r\n        }\r\n        else if (key === node.getKey()) {\r\n            return node.getData();\r\n        }\r\n        else if (key < node.getKey()) {\r\n            return this._get(node.getLeft(), key);\r\n        }\r\n        else {\r\n            return this._get(node.getRight(), key);\r\n        }\r\n    }\r\n    add(element) {\r\n        if (this._root == null) {\r\n            this._root = new BinaryTreeNode(this._getComparable(element), [element], null, null);\r\n            return true;\r\n        }\r\n        else {\r\n            return this._insert(this._root, element);\r\n        }\r\n    }\r\n    _insert(node, element) {\r\n        if (node != null) {\r\n            if (this._getComparable(element) === node.getKey()) {\r\n                if (node.getData().indexOf(element) > -1) {\r\n                    return false; // the element we're trying to insert already exists\r\n                }\r\n                else {\r\n                    node.getData().push(element);\r\n                    return true;\r\n                }\r\n            }\r\n            else if (this._getComparable(element) < node.getKey()) {\r\n                if (node.getLeft() == null) {\r\n                    node.setLeft(new BinaryTreeNode(this._getComparable(element), [element], null, null));\r\n                    return true;\r\n                }\r\n                else {\r\n                    return this._insert(node.getLeft(), element);\r\n                }\r\n            }\r\n            else {\r\n                if (node.getRight() == null) {\r\n                    node.setRight(new BinaryTreeNode(this._getComparable(element), [element], null, null));\r\n                    return true;\r\n                }\r\n                else {\r\n                    return this._insert(node.getRight(), element);\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    removeByComparable(element) {\r\n        this._root = this._remove(this._root, element);\r\n    }\r\n    _remove(node, element) {\r\n        if (node == null) {\r\n            return null;\r\n        }\r\n        else if (this._getComparable(element) === node.getKey()) {\r\n            const elementIndex = node.getData().indexOf(element);\r\n            // if the node contains the element, remove the element\r\n            if (elementIndex > -1) {\r\n                node.getData().splice(elementIndex, 1);\r\n                // if we have removed the last element at this node, remove the node\r\n                if (node.getData().length === 0) {\r\n                    // if the node is a leaf\r\n                    if (node.getLeft() == null && node.getRight() == null) {\r\n                        return null;\r\n                    }\r\n                    else if (node.getLeft() == null) {\r\n                        return node.getRight();\r\n                    }\r\n                    else if (node.getRight() == null) {\r\n                        return node.getLeft();\r\n                    }\r\n                    // if node has 2 children\r\n                    const temp = this._findMinNode(node.getRight());\r\n                    node.setKey(temp.getKey());\r\n                    node.setData(temp.getData());\r\n                    node.setRight(this._cleanup(node.getRight(), temp)); //\"cleanup nodes\" (move them up recursively)\r\n                    return node;\r\n                }\r\n                else {\r\n                    // this prevents the node from being removed since it still contains elements\r\n                    return node;\r\n                }\r\n            }\r\n        }\r\n        else if (this._getComparable(element) < node.getKey()) {\r\n            node.setLeft(this._remove(node.getLeft(), element));\r\n            return node;\r\n        }\r\n        else {\r\n            node.setRight(this._remove(node.getRight(), element));\r\n            return node;\r\n        }\r\n        return null;\r\n    }\r\n    // called once we have successfully removed the element we wanted, recursively corrects the part of the tree below the removed node\r\n    _cleanup(node, element) {\r\n        const comparable = element.getKey();\r\n        if (node == null) {\r\n            return null;\r\n        }\r\n        else if (comparable === node.getKey()) {\r\n            // if the node is a leaf\r\n            if (node.getLeft() == null && node.getRight() == null) {\r\n                return null;\r\n            }\r\n            else if (node.getLeft() == null) {\r\n                return node.getRight();\r\n            }\r\n            else if (node.getRight() == null) {\r\n                return node.getLeft();\r\n            }\r\n            // if node has 2 children\r\n            const temp = this._findMinNode(node.getRight());\r\n            node.setKey(temp.getKey());\r\n            node.setData(temp.getData());\r\n            node.setRight(this._cleanup(node.getRight(), temp));\r\n            return node;\r\n        }\r\n        else if (element.getKey() < node.getKey()) {\r\n            node.setLeft(this._cleanup(node.getLeft(), element));\r\n            return node;\r\n        }\r\n        else {\r\n            node.setRight(this._cleanup(node.getRight(), element));\r\n            return node;\r\n        }\r\n    }\r\n    _findMinNode(node) {\r\n        let current = node;\r\n        while (current.getLeft() != null) {\r\n            current = current.getLeft();\r\n        }\r\n        return current;\r\n    }\r\n    list() {\r\n        const results = new Array();\r\n        this._list(this._root, results);\r\n        return results;\r\n    }\r\n    _list(treeNode, results) {\r\n        if (treeNode != null) {\r\n            this._list(treeNode.getLeft(), results);\r\n            treeNode.getData().forEach((element) => {\r\n                results.push(element);\r\n            });\r\n            this._list(treeNode.getRight(), results);\r\n        }\r\n    }\r\n};\r\nSortedList = SortedList_decorate([\r\n    obsolete({ message: 'Will be removed in excalibur v0.26.0', alternateMethod: 'Use built in JS array.sort' })\r\n], SortedList);\r\n\r\n/**\r\n * A tree node part of [[SortedList]]\r\n * @deprecated Will be removed in v0.26.0\r\n */\r\nlet BinaryTreeNode = class BinaryTreeNode {\r\n    constructor(key, data, left, right) {\r\n        this._key = key;\r\n        this._data = data;\r\n        this._left = left;\r\n        this._right = right;\r\n    }\r\n    getKey() {\r\n        return this._key;\r\n    }\r\n    setKey(key) {\r\n        this._key = key;\r\n    }\r\n    getData() {\r\n        return this._data;\r\n    }\r\n    setData(data) {\r\n        this._data = data;\r\n    }\r\n    getLeft() {\r\n        return this._left;\r\n    }\r\n    setLeft(left) {\r\n        this._left = left;\r\n    }\r\n    getRight() {\r\n        return this._right;\r\n    }\r\n    setRight(right) {\r\n        this._right = right;\r\n    }\r\n};\r\nBinaryTreeNode = SortedList_decorate([\r\n    obsolete({ message: 'Will be removed in excalibur v0.26.0' })\r\n], BinaryTreeNode);\r\n\r\n/**\r\n * Mock element for testing\r\n *\r\n * @internal\r\n * @deprecated Will be removed in v0.26.0\r\n */\r\nclass MockedElement {\r\n    constructor(key) {\r\n        this._key = 0;\r\n        this._key = key;\r\n    }\r\n    getTheKey() {\r\n        return this._key;\r\n    }\r\n    setKey(key) {\r\n        this._key = key;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Pool.ts\n\r\nclass Pool {\r\n    constructor(builder, recycler, maxObjects = 100) {\r\n        this.builder = builder;\r\n        this.recycler = recycler;\r\n        this.maxObjects = maxObjects;\r\n        this.totalAllocations = 0;\r\n        this.index = 0;\r\n        this.objects = [];\r\n        this._logger = Logger.getInstance();\r\n    }\r\n    /**\r\n     * Use many instances out of the in the context and return all to the pool.\r\n     *\r\n     * By returning values out of the context they will be un-hooked from the pool and are free to be passed to consumers\r\n     * @param context\r\n     */\r\n    using(context) {\r\n        const result = context(this);\r\n        if (result) {\r\n            return this.done(...result);\r\n        }\r\n        return this.done();\r\n    }\r\n    /**\r\n     * Use a single instance out of th pool and immediately return it to the pool\r\n     * @param context\r\n     */\r\n    borrow(context) {\r\n        const object = this.get();\r\n        context(object);\r\n        this.index--;\r\n    }\r\n    /**\r\n     * Retrieve a value from the pool, will allocate a new instance if necessary or recycle from the pool\r\n     * @param args\r\n     */\r\n    get(...args) {\r\n        if (this.index === this.maxObjects) {\r\n            this._logger.warn('Max pooled objects reached, possible memory leak? Doubling');\r\n            this.maxObjects = this.maxObjects * 2;\r\n        }\r\n        if (this.objects[this.index]) {\r\n            // Pool has an available object already constructed\r\n            return this.recycler(this.objects[this.index++], ...args);\r\n        }\r\n        else {\r\n            // New allocation\r\n            this.totalAllocations++;\r\n            const object = (this.objects[this.index++] = this.builder(...args));\r\n            return object;\r\n        }\r\n    }\r\n    done(...objects) {\r\n        // All objects in pool now considered \"free\"\r\n        this.index = 0;\r\n        for (const object of objects) {\r\n            const poolIndex = this.objects.indexOf(object);\r\n            // Build a new object to take the pool place\r\n            this.objects[poolIndex] = this.builder(); // TODO problematic 0-arg only support\r\n            this.totalAllocations++;\r\n        }\r\n        return objects;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Promises.ts\n// Promises/A+ Spec http://promises-aplus.github.io/promises-spec/\r\nvar Promises_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar Promise_1;\r\n\r\n/**\r\n * Valid states for a promise to be in\r\n * @deprecated Will be removed in v0.26.0\r\n */\r\nvar PromiseState;\r\n(function (PromiseState) {\r\n    PromiseState[PromiseState[\"Resolved\"] = 0] = \"Resolved\";\r\n    PromiseState[PromiseState[\"Rejected\"] = 1] = \"Rejected\";\r\n    PromiseState[PromiseState[\"Pending\"] = 2] = \"Pending\";\r\n})(PromiseState || (PromiseState = {}));\r\n/**\r\n * Promises are used to do asynchronous work and they are useful for\r\n * creating a chain of actions. In Excalibur they are used for loading,\r\n * sounds, animation, actions, and more.\r\n * @deprecated Will be removed in v0.26.0\r\n */\r\nlet Promises_Promise = Promise_1 = class Promise {\r\n    constructor() {\r\n        this._state = PromiseState.Pending;\r\n        this._successCallbacks = [];\r\n        this._rejectCallback = () => {\r\n            return;\r\n        };\r\n    }\r\n    /**\r\n     * Create and resolve a Promise with an optional value\r\n     * @param value  An optional value to wrap in a resolved promise\r\n     * @deprecated Use browser native promises\r\n     */\r\n    static resolve(value) {\r\n        const promise = new Promise_1().resolve(value);\r\n        return promise;\r\n    }\r\n    /**\r\n     * Create and reject a Promise with an optional value\r\n     * @param value  An optional value to wrap in a rejected promise\r\n     * @deprecated Use browser native promises\r\n     */\r\n    static reject(value) {\r\n        const promise = new Promise_1().reject(value);\r\n        return promise;\r\n    }\r\n    static join() {\r\n        let promises = [];\r\n        if (arguments.length > 0 && !Array.isArray(arguments[0])) {\r\n            for (let _i = 0; _i < arguments.length; _i++) {\r\n                promises[_i - 0] = arguments[_i];\r\n            }\r\n        }\r\n        else if (arguments.length === 1 && Array.isArray(arguments[0])) {\r\n            promises = arguments[0];\r\n        }\r\n        const joinedPromise = new Promise_1();\r\n        if (!promises || !promises.length) {\r\n            return joinedPromise.resolve();\r\n        }\r\n        const total = promises.length;\r\n        let successes = 0;\r\n        let rejects = 0;\r\n        const errors = [];\r\n        promises.forEach((p) => {\r\n            p.then(() => {\r\n                successes += 1;\r\n                if (successes === total) {\r\n                    joinedPromise.resolve();\r\n                }\r\n                else if (successes + rejects + errors.length === total) {\r\n                    joinedPromise.reject(errors);\r\n                }\r\n            }, () => {\r\n                rejects += 1;\r\n                if (successes + rejects + errors.length === total) {\r\n                    joinedPromise.reject(errors);\r\n                }\r\n            }).error((e) => {\r\n                errors.push(e);\r\n                if (errors.length + successes + rejects === total) {\r\n                    joinedPromise.reject(errors);\r\n                }\r\n            });\r\n        });\r\n        return joinedPromise;\r\n    }\r\n    /**\r\n     * Chain success and reject callbacks after the promise is resolved\r\n     * @param successCallback  Call on resolution of promise\r\n     * @param rejectCallback   Call on rejection of promise\r\n     * @deprecated Use browser native promises\r\n     */\r\n    then(successCallback, rejectCallback) {\r\n        if (successCallback) {\r\n            this._successCallbacks.push(successCallback);\r\n            // If the promise is already resolved call immediately\r\n            if (this.state() === PromiseState.Resolved) {\r\n                try {\r\n                    successCallback.call(this, this._value);\r\n                }\r\n                catch (e) {\r\n                    this._handleError(e);\r\n                }\r\n            }\r\n        }\r\n        if (rejectCallback) {\r\n            this._rejectCallback = rejectCallback;\r\n            // If the promise is already rejected call immediately\r\n            if (this.state() === PromiseState.Rejected) {\r\n                try {\r\n                    rejectCallback.call(this, this._value);\r\n                }\r\n                catch (e) {\r\n                    this._handleError(e);\r\n                }\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Add an error callback to the promise\r\n     * @param errorCallback  Call if there was an error in a callback\r\n     * @deprecated Use browser native promises\r\n     */\r\n    error(errorCallback) {\r\n        if (errorCallback) {\r\n            this._errorCallback = errorCallback;\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Resolve the promise and pass an option value to the success callbacks\r\n     * @param value  Value to pass to the success callbacks\r\n     * @deprecated Use browser native promises\r\n     */\r\n    resolve(value) {\r\n        if (this._state === PromiseState.Pending) {\r\n            this._value = value;\r\n            try {\r\n                this._state = PromiseState.Resolved;\r\n                this._successCallbacks.forEach((cb) => {\r\n                    cb.call(this, this._value);\r\n                });\r\n            }\r\n            catch (e) {\r\n                this._handleError(e);\r\n            }\r\n        }\r\n        else {\r\n            throw new Error('Cannot resolve a promise that is not in a pending state!');\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Reject the promise and pass an option value to the reject callbacks\r\n     * @param value  Value to pass to the reject callbacks\r\n     * @deprecated Use browser native promises\r\n     */\r\n    reject(value) {\r\n        if (this._state === PromiseState.Pending) {\r\n            this._value = value;\r\n            try {\r\n                this._state = PromiseState.Rejected;\r\n                this._rejectCallback.call(this, this._value);\r\n            }\r\n            catch (e) {\r\n                this._handleError(e);\r\n            }\r\n        }\r\n        else {\r\n            throw new Error('Cannot reject a promise that is not in a pending state!');\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Inspect the current state of a promise\r\n     * @deprecated Use browser native promises\r\n     */\r\n    state() {\r\n        return this._state;\r\n    }\r\n    _handleError(e) {\r\n        if (this._errorCallback) {\r\n            this._errorCallback.call(this, e);\r\n        }\r\n        else {\r\n            // rethrow error\r\n            throw e;\r\n        }\r\n    }\r\n};\r\nPromises_Promise = Promise_1 = Promises_decorate([\r\n    obsolete({\r\n        message: 'ex.Promises are being replaced by native browser promises in v0.26.0',\r\n        alternateMethod: 'Use browser native promises'\r\n    })\r\n], Promises_Promise);\r\n\r\n\n;// CONCATENATED MODULE: ./index.ts\n/**\r\n * The current Excalibur version string\r\n * @description `process.env.__EX_VERSION` gets replaced by Webpack on build\r\n */\r\nconst EX_VERSION = \"0.25.2\";\r\n\r\npolyfill();\r\n// This file is used as the bundle entry point and exports everything\r\n// that will be exposed as the `ex` global variable.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// ex.LegacyDrawing namespace\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// ex.Events namespace\r\n\r\n\r\n// ex.Input namespace\r\n\r\n\r\n\r\n\r\n// ex.Traits namespace\r\n\r\n\r\n// ex.Util namespaces\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// ex.Deprecated\r\n\r\n// import * as deprecated from './Deprecated';\r\n// export { deprecated as Deprecated };\r\n// export * from './Deprecated';\r\n\n})();\n\nvar __webpack_exports__ActionContext = __webpack_exports__.fWn;\nvar __webpack_exports__ActionQueue = __webpack_exports__.Ia8;\nvar __webpack_exports__ActionsComponent = __webpack_exports__.hLI;\nvar __webpack_exports__ActionsSystem = __webpack_exports__.yyv;\nvar __webpack_exports__ActivateEvent = __webpack_exports__.tX5;\nvar __webpack_exports__Actor = __webpack_exports__.vtX;\nvar __webpack_exports__AddedComponent = __webpack_exports__.r7K;\nvar __webpack_exports__AddedEntity = __webpack_exports__.lCh;\nvar __webpack_exports__Animation = __webpack_exports__.fwF;\nvar __webpack_exports__AnimationDirection = __webpack_exports__.sce;\nvar __webpack_exports__AnimationStrategy = __webpack_exports__._c7;\nvar __webpack_exports__ArcadeSolver = __webpack_exports__.KUs;\nvar __webpack_exports__AudioContextFactory = __webpack_exports__.Ajp;\nvar __webpack_exports__Axis = __webpack_exports__.RDh;\nvar __webpack_exports__BaseAlign = __webpack_exports__._H9;\nvar __webpack_exports__BinaryTreeNode = __webpack_exports__.Ulf;\nvar __webpack_exports__Blink = __webpack_exports__.mxs;\nvar __webpack_exports__BodyComponent = __webpack_exports__.OmD;\nvar __webpack_exports__BoundingBox = __webpack_exports__.kBf;\nvar __webpack_exports__BroadphaseStrategy = __webpack_exports__.C4F;\nvar __webpack_exports__BrowserComponent = __webpack_exports__.NQt;\nvar __webpack_exports__BrowserEvents = __webpack_exports__.JjN;\nvar __webpack_exports__Camera = __webpack_exports__.V1s;\nvar __webpack_exports__Canvas = __webpack_exports__.Xz7;\nvar __webpack_exports__Cell = __webpack_exports__.bLd;\nvar __webpack_exports__Circle = __webpack_exports__.Cdc;\nvar __webpack_exports__CircleCollider = __webpack_exports__.FKn;\nvar __webpack_exports__Class = __webpack_exports__.wTW;\nvar __webpack_exports__Clock = __webpack_exports__.SUY;\nvar __webpack_exports__ClosestLine = __webpack_exports__.ab2;\nvar __webpack_exports__ClosestLineJumpTable = __webpack_exports__.GfZ;\nvar __webpack_exports__Collider = __webpack_exports__.YMS;\nvar __webpack_exports__ColliderComponent = __webpack_exports__.oyv;\nvar __webpack_exports__CollisionContact = __webpack_exports__.aUb;\nvar __webpack_exports__CollisionEndEvent = __webpack_exports__.SdD;\nvar __webpack_exports__CollisionGroup = __webpack_exports__.JUv;\nvar __webpack_exports__CollisionGroupManager = __webpack_exports__.jEj;\nvar __webpack_exports__CollisionJumpTable = __webpack_exports__.TFq;\nvar __webpack_exports__CollisionPostSolveEvent = __webpack_exports__.HDU;\nvar __webpack_exports__CollisionPreSolveEvent = __webpack_exports__.R_y;\nvar __webpack_exports__CollisionResolutionStrategy = __webpack_exports__.ydN;\nvar __webpack_exports__CollisionSolver = __webpack_exports__._N2;\nvar __webpack_exports__CollisionStartEvent = __webpack_exports__.t50;\nvar __webpack_exports__CollisionSystem = __webpack_exports__.s$$;\nvar __webpack_exports__CollisionType = __webpack_exports__.v2G;\nvar __webpack_exports__Color = __webpack_exports__.Ilk;\nvar __webpack_exports__ColorBlindFlags = __webpack_exports__.s9i;\nvar __webpack_exports__ColorBlindnessMode = __webpack_exports__.dxL;\nvar __webpack_exports__ColorBlindnessPostProcessor = __webpack_exports__.LLX;\nvar __webpack_exports__Component = __webpack_exports__.wA2;\nvar __webpack_exports__CompositeCollider = __webpack_exports__.R_p;\nvar __webpack_exports__Configurable = __webpack_exports__.IQ$;\nvar __webpack_exports__ConsoleAppender = __webpack_exports__.I5F;\nvar __webpack_exports__ContactConstraintPoint = __webpack_exports__.X8$;\nvar __webpack_exports__ContactEndEvent = __webpack_exports__.FR6;\nvar __webpack_exports__ContactStartEvent = __webpack_exports__.U8o;\nvar __webpack_exports__CoordPlane = __webpack_exports__.kbG;\nvar __webpack_exports__CullingBox = __webpack_exports__.oeJ;\nvar __webpack_exports__DeactivateEvent = __webpack_exports__.iS_;\nvar __webpack_exports__Debug = __webpack_exports__.cGG;\nvar __webpack_exports__DebugGraphicsComponent = __webpack_exports__.RPN;\nvar __webpack_exports__DebugSystem = __webpack_exports__.skb;\nvar __webpack_exports__DebugText = __webpack_exports__.SLU;\nvar __webpack_exports__DegreeOfFreedom = __webpack_exports__.RdJ;\nvar __webpack_exports__Detector = __webpack_exports__.gU7;\nvar __webpack_exports__Die = __webpack_exports__.LSk;\nvar __webpack_exports__Direction = __webpack_exports__.Nmp;\nvar __webpack_exports__DisplayMode = __webpack_exports__.d1Y;\nvar __webpack_exports__DynamicTree = __webpack_exports__.xrL;\nvar __webpack_exports__DynamicTreeCollisionProcessor = __webpack_exports__.sRW;\nvar __webpack_exports__EX_VERSION = __webpack_exports__.cmV;\nvar __webpack_exports__EaseTo = __webpack_exports__.N0Q;\nvar __webpack_exports__EasingFunctions = __webpack_exports__.q8b;\nvar __webpack_exports__EdgeCollider = __webpack_exports__.ynB;\nvar __webpack_exports__ElasticToActorStrategy = __webpack_exports__.jT9;\nvar __webpack_exports__EmitterType = __webpack_exports__.wAz;\nvar __webpack_exports__Engine = __webpack_exports__.D4V;\nvar __webpack_exports__EnterTriggerEvent = __webpack_exports__.N6H;\nvar __webpack_exports__EnterViewPortEvent = __webpack_exports__.W1A;\nvar __webpack_exports__Entity = __webpack_exports__.JHW;\nvar __webpack_exports__EntityManager = __webpack_exports__.v2K;\nvar __webpack_exports__EventDispatcher = __webpack_exports__.pBf;\nvar __webpack_exports__EventTypes = __webpack_exports__.GMl;\nvar __webpack_exports__Events = __webpack_exports__.zW2;\nvar __webpack_exports__ExResponse = __webpack_exports__.B0K;\nvar __webpack_exports__ExcaliburGraphicsContext2DCanvas = __webpack_exports__.Nv7;\nvar __webpack_exports__ExcaliburGraphicsContextWebGL = __webpack_exports__.C_p;\nvar __webpack_exports__ExcaliburWebGLContextAccessor = __webpack_exports__.iqw;\nvar __webpack_exports__ExitTriggerEvent = __webpack_exports__.MUA;\nvar __webpack_exports__ExitViewPortEvent = __webpack_exports__.xqU;\nvar __webpack_exports__Experiments = __webpack_exports__.peG;\nvar __webpack_exports__Fade = __webpack_exports__.pTp;\nvar __webpack_exports__Flags = __webpack_exports__.vUK;\nvar __webpack_exports__Follow = __webpack_exports__.j9l;\nvar __webpack_exports__Font = __webpack_exports__.Zxw;\nvar __webpack_exports__FontStyle = __webpack_exports__.Hdx;\nvar __webpack_exports__FontUnit = __webpack_exports__.Z$d;\nvar __webpack_exports__FpsSampler = __webpack_exports__.iqV;\nvar __webpack_exports__FrameStats = __webpack_exports__.o$7;\nvar __webpack_exports__GameEvent = __webpack_exports__.Zm$;\nvar __webpack_exports__GameStartEvent = __webpack_exports__.$QH;\nvar __webpack_exports__GameStopEvent = __webpack_exports__.i78;\nvar __webpack_exports__GamepadAxisEvent = __webpack_exports__.h6u;\nvar __webpack_exports__GamepadButtonEvent = __webpack_exports__.hts;\nvar __webpack_exports__GamepadConnectEvent = __webpack_exports__.j88;\nvar __webpack_exports__GamepadDisconnectEvent = __webpack_exports__.VME;\nvar __webpack_exports__Gif = __webpack_exports__.nt;\nvar __webpack_exports__GlobalCoordinates = __webpack_exports__.Ukr;\nvar __webpack_exports__Graphic = __webpack_exports__.zsu;\nvar __webpack_exports__GraphicsComponent = __webpack_exports__.oA6;\nvar __webpack_exports__GraphicsGroup = __webpack_exports__.TVh;\nvar __webpack_exports__GraphicsLayer = __webpack_exports__.TwZ;\nvar __webpack_exports__GraphicsLayers = __webpack_exports__.GTT;\nvar __webpack_exports__GraphicsSystem = __webpack_exports__.xxj;\nvar __webpack_exports__HiddenEvent = __webpack_exports__.XdK;\nvar __webpack_exports__ImageFiltering = __webpack_exports__.Jmb;\nvar __webpack_exports__ImageSource = __webpack_exports__.cXo;\nvar __webpack_exports__InitializeEvent = __webpack_exports__.Dm5;\nvar __webpack_exports__Input = __webpack_exports__.IIB;\nvar __webpack_exports__Integrator = __webpack_exports__.zI0;\nvar __webpack_exports__KillEvent = __webpack_exports__.SKZ;\nvar __webpack_exports__Label = __webpack_exports__.__J;\nvar __webpack_exports__Legacy = __webpack_exports__.Dvr;\nvar __webpack_exports__LegacyDrawing = __webpack_exports__.Tf9;\nvar __webpack_exports__LimitCameraBoundsStrategy = __webpack_exports__.RI$;\nvar __webpack_exports__Line = __webpack_exports__.x12;\nvar __webpack_exports__Loader = __webpack_exports__.aNw;\nvar __webpack_exports__LockCameraToActorAxisStrategy = __webpack_exports__.xwn;\nvar __webpack_exports__LockCameraToActorStrategy = __webpack_exports__.dNK;\nvar __webpack_exports__LogLevel = __webpack_exports__.ini;\nvar __webpack_exports__Logger = __webpack_exports__.YdH;\nvar __webpack_exports__Matrix = __webpack_exports__.y3G;\nvar __webpack_exports__MatrixLocations = __webpack_exports__.l57;\nvar __webpack_exports__MediaEvent = __webpack_exports__.xn0;\nvar __webpack_exports__Meet = __webpack_exports__.t2V;\nvar __webpack_exports__MockedElement = __webpack_exports__.ZyS;\nvar __webpack_exports__MotionComponent = __webpack_exports__.uxB;\nvar __webpack_exports__MotionSystem = __webpack_exports__.cpd;\nvar __webpack_exports__MoveBy = __webpack_exports__.fiy;\nvar __webpack_exports__MoveTo = __webpack_exports__.$XZ;\nvar __webpack_exports__NativeSoundEvent = __webpack_exports__.uqK;\nvar __webpack_exports__NativeSoundProcessedEvent = __webpack_exports__.STE;\nvar __webpack_exports__Observable = __webpack_exports__.y$z;\nvar __webpack_exports__Pair = __webpack_exports__.sOq;\nvar __webpack_exports__ParseGif = __webpack_exports__.Sqs;\nvar __webpack_exports__Particle = __webpack_exports__.hpZ;\nvar __webpack_exports__ParticleEmitter = __webpack_exports__.Vol;\nvar __webpack_exports__Physics = __webpack_exports__.wIZ;\nvar __webpack_exports__PhysicsStats = __webpack_exports__.cBi;\nvar __webpack_exports__PointerComponent = __webpack_exports__.RFv;\nvar __webpack_exports__PointerSystem = __webpack_exports__.kfC;\nvar __webpack_exports__Polygon = __webpack_exports__.mgq;\nvar __webpack_exports__PolygonCollider = __webpack_exports__.YVA;\nvar __webpack_exports__Pool = __webpack_exports__.Kgp;\nvar __webpack_exports__PostCollisionEvent = __webpack_exports__.HH$;\nvar __webpack_exports__PostDebugDrawEvent = __webpack_exports__.M_d;\nvar __webpack_exports__PostDrawEvent = __webpack_exports__.rgh;\nvar __webpack_exports__PostFrameEvent = __webpack_exports__.Ra6;\nvar __webpack_exports__PostKillEvent = __webpack_exports__.KhR;\nvar __webpack_exports__PostUpdateEvent = __webpack_exports__.BS5;\nvar __webpack_exports__PreCollisionEvent = __webpack_exports__.xhz;\nvar __webpack_exports__PreDebugDrawEvent = __webpack_exports__.xOq;\nvar __webpack_exports__PreDrawEvent = __webpack_exports__.a9j;\nvar __webpack_exports__PreFrameEvent = __webpack_exports__.bHk;\nvar __webpack_exports__PreKillEvent = __webpack_exports__.CgK;\nvar __webpack_exports__PreUpdateEvent = __webpack_exports__.cuY;\nvar __webpack_exports__Projection = __webpack_exports__.kvE;\nvar __webpack_exports__Promise = __webpack_exports__.JDb;\nvar __webpack_exports__PromiseState = __webpack_exports__.Cbi;\nvar __webpack_exports__QuadIndexBuffer = __webpack_exports__.SBu;\nvar __webpack_exports__Query = __webpack_exports__.AE_;\nvar __webpack_exports__QueryManager = __webpack_exports__.ctO;\nvar __webpack_exports__RadiusAroundActorStrategy = __webpack_exports__.OLH;\nvar __webpack_exports__Random = __webpack_exports__.kky;\nvar __webpack_exports__Raster = __webpack_exports__.nSF;\nvar __webpack_exports__Ray = __webpack_exports__.zHn;\nvar __webpack_exports__RealisticSolver = __webpack_exports__.zwx;\nvar __webpack_exports__Rectangle = __webpack_exports__.AeJ;\nvar __webpack_exports__RemovedComponent = __webpack_exports__.hLz;\nvar __webpack_exports__RemovedEntity = __webpack_exports__.D9g;\nvar __webpack_exports__Repeat = __webpack_exports__.wA;\nvar __webpack_exports__RepeatForever = __webpack_exports__.jhr;\nvar __webpack_exports__Resolution = __webpack_exports__.GVs;\nvar __webpack_exports__Resource = __webpack_exports__._zO;\nvar __webpack_exports__RotateBy = __webpack_exports__.w6$;\nvar __webpack_exports__RotateTo = __webpack_exports__.mhV;\nvar __webpack_exports__RotationType = __webpack_exports__.MOD;\nvar __webpack_exports__ScaleBy = __webpack_exports__.kwd;\nvar __webpack_exports__ScaleTo = __webpack_exports__.Lmr;\nvar __webpack_exports__Scene = __webpack_exports__.xsS;\nvar __webpack_exports__Screen = __webpack_exports__.lLr;\nvar __webpack_exports__ScreenAppender = __webpack_exports__.Z$r;\nvar __webpack_exports__ScreenElement = __webpack_exports__.IXb;\nvar __webpack_exports__ScreenShader = __webpack_exports__.SGH;\nvar __webpack_exports__ScrollPreventionMode = __webpack_exports__.SMj;\nvar __webpack_exports__Shader = __webpack_exports__.exe;\nvar __webpack_exports__Shape = __webpack_exports__.bnF;\nvar __webpack_exports__Side = __webpack_exports__.MFA;\nvar __webpack_exports__SortedList = __webpack_exports__.$XC;\nvar __webpack_exports__Sound = __webpack_exports__.$uU;\nvar __webpack_exports__Sprite = __webpack_exports__.jyi;\nvar __webpack_exports__SpriteFont = __webpack_exports__.E03;\nvar __webpack_exports__SpriteSheet = __webpack_exports__.V6q;\nvar __webpack_exports__StandardClock = __webpack_exports__.rg2;\nvar __webpack_exports__StrategyContainer = __webpack_exports__.nVo;\nvar __webpack_exports__Stream = __webpack_exports__.F6N;\nvar __webpack_exports__SubscribeEvent = __webpack_exports__.ad3;\nvar __webpack_exports__System = __webpack_exports__.xP7;\nvar __webpack_exports__SystemManager = __webpack_exports__.Odq;\nvar __webpack_exports__SystemType = __webpack_exports__.Zif;\nvar __webpack_exports__TagComponent = __webpack_exports__.ZGJ;\nvar __webpack_exports__TestClock = __webpack_exports__.MJk;\nvar __webpack_exports__Text = __webpack_exports__.xvT;\nvar __webpack_exports__TextAlign = __webpack_exports__.PHM;\nvar __webpack_exports__TextureLoader = __webpack_exports__.dpR;\nvar __webpack_exports__TileMap = __webpack_exports__.KwO;\nvar __webpack_exports__Timer = __webpack_exports__.B7y;\nvar __webpack_exports__Traits = __webpack_exports__.SFp;\nvar __webpack_exports__TransformComponent = __webpack_exports__.Uvn;\nvar __webpack_exports__TreeNode = __webpack_exports__.OFT;\nvar __webpack_exports__Trigger = __webpack_exports__.xzN;\nvar __webpack_exports__TwoPI = __webpack_exports__.M5Z;\nvar __webpack_exports__UnsubscribeEvent = __webpack_exports__.H6j;\nvar __webpack_exports__Util = __webpack_exports__.ZrN;\nvar __webpack_exports__Vector = __webpack_exports__.OWs;\nvar __webpack_exports__VectorView = __webpack_exports__.dF9;\nvar __webpack_exports__VertexBuffer = __webpack_exports__.oZy;\nvar __webpack_exports__VertexLayout = __webpack_exports__.rD2;\nvar __webpack_exports__VisibleEvent = __webpack_exports__.VHo;\nvar __webpack_exports__WebAudio = __webpack_exports__.ohE;\nvar __webpack_exports__WebAudioInstance = __webpack_exports__.R$E;\nvar __webpack_exports__World = __webpack_exports__.q3I;\nvar __webpack_exports__canonicalizeAngle = __webpack_exports__.Pab;\nvar __webpack_exports__clamp = __webpack_exports__.uZ5;\nvar __webpack_exports__createId = __webpack_exports__.McK;\nvar __webpack_exports__frac = __webpack_exports__.F9c;\nvar __webpack_exports__hasGraphicsTick = __webpack_exports__.k0b;\nvar __webpack_exports__hasOnInitialize = __webpack_exports__.hnT;\nvar __webpack_exports__hasOnPostUpdate = __webpack_exports__.RSJ;\nvar __webpack_exports__hasOnPreUpdate = __webpack_exports__.Mku;\nvar __webpack_exports__hasPostDraw = __webpack_exports__.h90;\nvar __webpack_exports__hasPreDraw = __webpack_exports__.rms;\nvar __webpack_exports__has_initialize = __webpack_exports__.ErP;\nvar __webpack_exports__has_postupdate = __webpack_exports__.aVg;\nvar __webpack_exports__has_preupdate = __webpack_exports__.lPc;\nvar __webpack_exports__isAddedComponent = __webpack_exports__.Z8E;\nvar __webpack_exports__isAddedSystemEntity = __webpack_exports__.NNA;\nvar __webpack_exports__isRemoveSystemEntity = __webpack_exports__.yFn;\nvar __webpack_exports__isRemovedComponent = __webpack_exports__.lNv;\nvar __webpack_exports__maxMessages = __webpack_exports__.MZQ;\nvar __webpack_exports__obsolete = __webpack_exports__.FUM;\nvar __webpack_exports__randomInRange = __webpack_exports__.vdf;\nvar __webpack_exports__randomIntInRange = __webpack_exports__.iaL;\nvar __webpack_exports__range = __webpack_exports__.w6H;\nvar __webpack_exports__resetObsoleteCounter = __webpack_exports__.Q4c;\nvar __webpack_exports__sign = __webpack_exports__.Xxe;\nvar __webpack_exports__toDegrees = __webpack_exports__.Uxb;\nvar __webpack_exports__toRadians = __webpack_exports__.Yr5;\nvar __webpack_exports__vec = __webpack_exports__.Bhw;\nvar __webpack_exports__webgl = __webpack_exports__.yOA;\nexport { __webpack_exports__ActionContext as ActionContext, __webpack_exports__ActionQueue as ActionQueue, __webpack_exports__ActionsComponent as ActionsComponent, __webpack_exports__ActionsSystem as ActionsSystem, __webpack_exports__ActivateEvent as ActivateEvent, __webpack_exports__Actor as Actor, __webpack_exports__AddedComponent as AddedComponent, __webpack_exports__AddedEntity as AddedEntity, __webpack_exports__Animation as Animation, __webpack_exports__AnimationDirection as AnimationDirection, __webpack_exports__AnimationStrategy as AnimationStrategy, __webpack_exports__ArcadeSolver as ArcadeSolver, __webpack_exports__AudioContextFactory as AudioContextFactory, __webpack_exports__Axis as Axis, __webpack_exports__BaseAlign as BaseAlign, __webpack_exports__BinaryTreeNode as BinaryTreeNode, __webpack_exports__Blink as Blink, __webpack_exports__BodyComponent as BodyComponent, __webpack_exports__BoundingBox as BoundingBox, __webpack_exports__BroadphaseStrategy as BroadphaseStrategy, __webpack_exports__BrowserComponent as BrowserComponent, __webpack_exports__BrowserEvents as BrowserEvents, __webpack_exports__Camera as Camera, __webpack_exports__Canvas as Canvas, __webpack_exports__Cell as Cell, __webpack_exports__Circle as Circle, __webpack_exports__CircleCollider as CircleCollider, __webpack_exports__Class as Class, __webpack_exports__Clock as Clock, __webpack_exports__ClosestLine as ClosestLine, __webpack_exports__ClosestLineJumpTable as ClosestLineJumpTable, __webpack_exports__Collider as Collider, __webpack_exports__ColliderComponent as ColliderComponent, __webpack_exports__CollisionContact as CollisionContact, __webpack_exports__CollisionEndEvent as CollisionEndEvent, __webpack_exports__CollisionGroup as CollisionGroup, __webpack_exports__CollisionGroupManager as CollisionGroupManager, __webpack_exports__CollisionJumpTable as CollisionJumpTable, __webpack_exports__CollisionPostSolveEvent as CollisionPostSolveEvent, __webpack_exports__CollisionPreSolveEvent as CollisionPreSolveEvent, __webpack_exports__CollisionResolutionStrategy as CollisionResolutionStrategy, __webpack_exports__CollisionSolver as CollisionSolver, __webpack_exports__CollisionStartEvent as CollisionStartEvent, __webpack_exports__CollisionSystem as CollisionSystem, __webpack_exports__CollisionType as CollisionType, __webpack_exports__Color as Color, __webpack_exports__ColorBlindFlags as ColorBlindFlags, __webpack_exports__ColorBlindnessMode as ColorBlindnessMode, __webpack_exports__ColorBlindnessPostProcessor as ColorBlindnessPostProcessor, __webpack_exports__Component as Component, __webpack_exports__CompositeCollider as CompositeCollider, __webpack_exports__Configurable as Configurable, __webpack_exports__ConsoleAppender as ConsoleAppender, __webpack_exports__ContactConstraintPoint as ContactConstraintPoint, __webpack_exports__ContactEndEvent as ContactEndEvent, __webpack_exports__ContactStartEvent as ContactStartEvent, __webpack_exports__CoordPlane as CoordPlane, __webpack_exports__CullingBox as CullingBox, __webpack_exports__DeactivateEvent as DeactivateEvent, __webpack_exports__Debug as Debug, __webpack_exports__DebugGraphicsComponent as DebugGraphicsComponent, __webpack_exports__DebugSystem as DebugSystem, __webpack_exports__DebugText as DebugText, __webpack_exports__DegreeOfFreedom as DegreeOfFreedom, __webpack_exports__Detector as Detector, __webpack_exports__Die as Die, __webpack_exports__Direction as Direction, __webpack_exports__DisplayMode as DisplayMode, __webpack_exports__DynamicTree as DynamicTree, __webpack_exports__DynamicTreeCollisionProcessor as DynamicTreeCollisionProcessor, __webpack_exports__EX_VERSION as EX_VERSION, __webpack_exports__EaseTo as EaseTo, __webpack_exports__EasingFunctions as EasingFunctions, __webpack_exports__EdgeCollider as EdgeCollider, __webpack_exports__ElasticToActorStrategy as ElasticToActorStrategy, __webpack_exports__EmitterType as EmitterType, __webpack_exports__Engine as Engine, __webpack_exports__EnterTriggerEvent as EnterTriggerEvent, __webpack_exports__EnterViewPortEvent as EnterViewPortEvent, __webpack_exports__Entity as Entity, __webpack_exports__EntityManager as EntityManager, __webpack_exports__EventDispatcher as EventDispatcher, __webpack_exports__EventTypes as EventTypes, __webpack_exports__Events as Events, __webpack_exports__ExResponse as ExResponse, __webpack_exports__ExcaliburGraphicsContext2DCanvas as ExcaliburGraphicsContext2DCanvas, __webpack_exports__ExcaliburGraphicsContextWebGL as ExcaliburGraphicsContextWebGL, __webpack_exports__ExcaliburWebGLContextAccessor as ExcaliburWebGLContextAccessor, __webpack_exports__ExitTriggerEvent as ExitTriggerEvent, __webpack_exports__ExitViewPortEvent as ExitViewPortEvent, __webpack_exports__Experiments as Experiments, __webpack_exports__Fade as Fade, __webpack_exports__Flags as Flags, __webpack_exports__Follow as Follow, __webpack_exports__Font as Font, __webpack_exports__FontStyle as FontStyle, __webpack_exports__FontUnit as FontUnit, __webpack_exports__FpsSampler as FpsSampler, __webpack_exports__FrameStats as FrameStats, __webpack_exports__GameEvent as GameEvent, __webpack_exports__GameStartEvent as GameStartEvent, __webpack_exports__GameStopEvent as GameStopEvent, __webpack_exports__GamepadAxisEvent as GamepadAxisEvent, __webpack_exports__GamepadButtonEvent as GamepadButtonEvent, __webpack_exports__GamepadConnectEvent as GamepadConnectEvent, __webpack_exports__GamepadDisconnectEvent as GamepadDisconnectEvent, __webpack_exports__Gif as Gif, __webpack_exports__GlobalCoordinates as GlobalCoordinates, __webpack_exports__Graphic as Graphic, __webpack_exports__GraphicsComponent as GraphicsComponent, __webpack_exports__GraphicsGroup as GraphicsGroup, __webpack_exports__GraphicsLayer as GraphicsLayer, __webpack_exports__GraphicsLayers as GraphicsLayers, __webpack_exports__GraphicsSystem as GraphicsSystem, __webpack_exports__HiddenEvent as HiddenEvent, __webpack_exports__ImageFiltering as ImageFiltering, __webpack_exports__ImageSource as ImageSource, __webpack_exports__InitializeEvent as InitializeEvent, __webpack_exports__Input as Input, __webpack_exports__Integrator as Integrator, __webpack_exports__KillEvent as KillEvent, __webpack_exports__Label as Label, __webpack_exports__Legacy as Legacy, __webpack_exports__LegacyDrawing as LegacyDrawing, __webpack_exports__LimitCameraBoundsStrategy as LimitCameraBoundsStrategy, __webpack_exports__Line as Line, __webpack_exports__Loader as Loader, __webpack_exports__LockCameraToActorAxisStrategy as LockCameraToActorAxisStrategy, __webpack_exports__LockCameraToActorStrategy as LockCameraToActorStrategy, __webpack_exports__LogLevel as LogLevel, __webpack_exports__Logger as Logger, __webpack_exports__Matrix as Matrix, __webpack_exports__MatrixLocations as MatrixLocations, __webpack_exports__MediaEvent as MediaEvent, __webpack_exports__Meet as Meet, __webpack_exports__MockedElement as MockedElement, __webpack_exports__MotionComponent as MotionComponent, __webpack_exports__MotionSystem as MotionSystem, __webpack_exports__MoveBy as MoveBy, __webpack_exports__MoveTo as MoveTo, __webpack_exports__NativeSoundEvent as NativeSoundEvent, __webpack_exports__NativeSoundProcessedEvent as NativeSoundProcessedEvent, __webpack_exports__Observable as Observable, __webpack_exports__Pair as Pair, __webpack_exports__ParseGif as ParseGif, __webpack_exports__Particle as Particle, __webpack_exports__ParticleEmitter as ParticleEmitter, __webpack_exports__Physics as Physics, __webpack_exports__PhysicsStats as PhysicsStats, __webpack_exports__PointerComponent as PointerComponent, __webpack_exports__PointerSystem as PointerSystem, __webpack_exports__Polygon as Polygon, __webpack_exports__PolygonCollider as PolygonCollider, __webpack_exports__Pool as Pool, __webpack_exports__PostCollisionEvent as PostCollisionEvent, __webpack_exports__PostDebugDrawEvent as PostDebugDrawEvent, __webpack_exports__PostDrawEvent as PostDrawEvent, __webpack_exports__PostFrameEvent as PostFrameEvent, __webpack_exports__PostKillEvent as PostKillEvent, __webpack_exports__PostUpdateEvent as PostUpdateEvent, __webpack_exports__PreCollisionEvent as PreCollisionEvent, __webpack_exports__PreDebugDrawEvent as PreDebugDrawEvent, __webpack_exports__PreDrawEvent as PreDrawEvent, __webpack_exports__PreFrameEvent as PreFrameEvent, __webpack_exports__PreKillEvent as PreKillEvent, __webpack_exports__PreUpdateEvent as PreUpdateEvent, __webpack_exports__Projection as Projection, __webpack_exports__Promise as Promise, __webpack_exports__PromiseState as PromiseState, __webpack_exports__QuadIndexBuffer as QuadIndexBuffer, __webpack_exports__Query as Query, __webpack_exports__QueryManager as QueryManager, __webpack_exports__RadiusAroundActorStrategy as RadiusAroundActorStrategy, __webpack_exports__Random as Random, __webpack_exports__Raster as Raster, __webpack_exports__Ray as Ray, __webpack_exports__RealisticSolver as RealisticSolver, __webpack_exports__Rectangle as Rectangle, __webpack_exports__RemovedComponent as RemovedComponent, __webpack_exports__RemovedEntity as RemovedEntity, __webpack_exports__Repeat as Repeat, __webpack_exports__RepeatForever as RepeatForever, __webpack_exports__Resolution as Resolution, __webpack_exports__Resource as Resource, __webpack_exports__RotateBy as RotateBy, __webpack_exports__RotateTo as RotateTo, __webpack_exports__RotationType as RotationType, __webpack_exports__ScaleBy as ScaleBy, __webpack_exports__ScaleTo as ScaleTo, __webpack_exports__Scene as Scene, __webpack_exports__Screen as Screen, __webpack_exports__ScreenAppender as ScreenAppender, __webpack_exports__ScreenElement as ScreenElement, __webpack_exports__ScreenShader as ScreenShader, __webpack_exports__ScrollPreventionMode as ScrollPreventionMode, __webpack_exports__Shader as Shader, __webpack_exports__Shape as Shape, __webpack_exports__Side as Side, __webpack_exports__SortedList as SortedList, __webpack_exports__Sound as Sound, __webpack_exports__Sprite as Sprite, __webpack_exports__SpriteFont as SpriteFont, __webpack_exports__SpriteSheet as SpriteSheet, __webpack_exports__StandardClock as StandardClock, __webpack_exports__StrategyContainer as StrategyContainer, __webpack_exports__Stream as Stream, __webpack_exports__SubscribeEvent as SubscribeEvent, __webpack_exports__System as System, __webpack_exports__SystemManager as SystemManager, __webpack_exports__SystemType as SystemType, __webpack_exports__TagComponent as TagComponent, __webpack_exports__TestClock as TestClock, __webpack_exports__Text as Text, __webpack_exports__TextAlign as TextAlign, __webpack_exports__TextureLoader as TextureLoader, __webpack_exports__TileMap as TileMap, __webpack_exports__Timer as Timer, __webpack_exports__Traits as Traits, __webpack_exports__TransformComponent as TransformComponent, __webpack_exports__TreeNode as TreeNode, __webpack_exports__Trigger as Trigger, __webpack_exports__TwoPI as TwoPI, __webpack_exports__UnsubscribeEvent as UnsubscribeEvent, __webpack_exports__Util as Util, __webpack_exports__Vector as Vector, __webpack_exports__VectorView as VectorView, __webpack_exports__VertexBuffer as VertexBuffer, __webpack_exports__VertexLayout as VertexLayout, __webpack_exports__VisibleEvent as VisibleEvent, __webpack_exports__WebAudio as WebAudio, __webpack_exports__WebAudioInstance as WebAudioInstance, __webpack_exports__World as World, __webpack_exports__canonicalizeAngle as canonicalizeAngle, __webpack_exports__clamp as clamp, __webpack_exports__createId as createId, __webpack_exports__frac as frac, __webpack_exports__hasGraphicsTick as hasGraphicsTick, __webpack_exports__hasOnInitialize as hasOnInitialize, __webpack_exports__hasOnPostUpdate as hasOnPostUpdate, __webpack_exports__hasOnPreUpdate as hasOnPreUpdate, __webpack_exports__hasPostDraw as hasPostDraw, __webpack_exports__hasPreDraw as hasPreDraw, __webpack_exports__has_initialize as has_initialize, __webpack_exports__has_postupdate as has_postupdate, __webpack_exports__has_preupdate as has_preupdate, __webpack_exports__isAddedComponent as isAddedComponent, __webpack_exports__isAddedSystemEntity as isAddedSystemEntity, __webpack_exports__isRemoveSystemEntity as isRemoveSystemEntity, __webpack_exports__isRemovedComponent as isRemovedComponent, __webpack_exports__maxMessages as maxMessages, __webpack_exports__obsolete as obsolete, __webpack_exports__randomInRange as randomInRange, __webpack_exports__randomIntInRange as randomIntInRange, __webpack_exports__range as range, __webpack_exports__resetObsoleteCounter as resetObsoleteCounter, __webpack_exports__sign as sign, __webpack_exports__toDegrees as toDegrees, __webpack_exports__toRadians as toRadians, __webpack_exports__vec as vec, __webpack_exports__webgl as webgl };\n\n//# sourceMappingURL=excalibur.js.map","module.exports = __webpack_public_path__ + \"cf46998813a16deda5b1df84e8ba4a58.png\";","module.exports = __webpack_public_path__ + \"5f7dc58022982b36f3e7f336df2e1fe3.png\";","module.exports = __webpack_public_path__ + \"bd99eb41ea5cc3d44e26b5d2809fce41.png\";","module.exports = __webpack_public_path__ + \"9b8606ea9f0f4b78b4cd7ce817564074.png\";","module.exports = __webpack_public_path__ + \"81bc95ba9d9e1dca2626111d8282fc01.wav\";","module.exports = __webpack_public_path__ + \"d292f5f80075fd4216d6da8d459f64c5.wav\";","module.exports = __webpack_public_path__ + \"8934b41ac754a9dbdf0fdfffa1807d52.wav\";","module.exports = __webpack_public_path__ + \"61977b58651acbc9a3245a94f185238b.png\";","import * as ex from 'excalibur';\nimport { baddieSpriteSheet, Resources } from \"./resources\";\nimport { Bot } from './bot';\n\nexport class Baddie extends ex.Actor {\n    constructor(x: number, y: number, public dir: number) {\n        super({\n            name: 'Baddie',\n            pos: new ex.Vector(x, y),\n            collisionGroup: ex.CollisionGroupManager.groupByName(\"enemy\"),\n            collisionType: ex.CollisionType.Active,\n            collider: ex.Shape.Box(32, 50, ex.Vector.Half, ex.vec(0, -1)) \n        });\n    }\n\n    // OnInitialize is called before the 1st actor update\n    onInitialize(engine: ex.Engine) {\n        // Initialize actor\n\n        // Setup visuals\n        const left = ex.Animation.fromSpriteSheet(baddieSpriteSheet, [2, 3, 4, 5], 100);\n        left.scale = new ex.Vector(2, 2);\n        const right = ex.Animation.fromSpriteSheet(baddieSpriteSheet, [2, 3, 4, 5], 100);\n        right.scale = new ex.Vector(2, 2);\n        right.flipHorizontal = true;\n\n        // Register animation\n        this.graphics.add(\"left\", left)\n        this.graphics.add(\"right\", right);\n        this.graphics.use(\"left\");\n\n        if ((window as any).__TESTING) {\n            left.pause();\n        }\n\n        // Setup patroling behavior\n\n        // For the test harness to be predicable\n        if (!(window as any).__TESTING) {\n            this.actions.delay(1000)\n                        .repeatForever(ctx => ctx\n                            .moveBy(400 * this.dir, 0, 100)\n                            .moveBy(-400 * this.dir, 0, 100));\n        }\n\n        // Handle being stomped by the player\n        this.on('postcollision', (evt) => this.onPostCollision(evt));\n    }\n\n    onPostCollision(evt: ex.PostCollisionEvent) {\n        if (evt.other instanceof Bot && evt.side === ex.Side.Top) {\n            Resources.gotEm.play(.1);\n            // Clear patrolling\n            this.actions.clearActions();\n            // Remove ability to collide\n            this.body.collisionType = ex.CollisionType.PreventCollision;\n\n            // Launch into air with rotation\n            this.vel = new ex.Vector(0, -300);\n            this.acc = ex.Physics.acc;\n            this.angularVelocity = 2;\n        }\n    }\n\n    // Change animation based on velocity \n    onPostUpdate() {\n        if (this.vel.x < 0) {\n            this.graphics.use(\"left\");\n        } else if (this.vel.x > 0) {\n            this.graphics.use(\"right\");\n        }\n    }\n    \n}","import * as ex from 'excalibur';\nimport { botSpriteSheet, Resources } from './resources';\nimport { Baddie } from './baddie';\n\nexport class Bot extends ex.Actor {\n    public onGround = true;\n    public jumped = false;\n    public hurt = false;\n    public hurtTime: number = 0;\n    constructor(x: number, y: number) {\n        super({\n            name: 'Bot',\n            pos: new ex.Vector(x, y),\n            collisionType: ex.CollisionType.Active,\n            collisionGroup: ex.CollisionGroupManager.groupByName(\"player\"),\n            collider: ex.Shape.Box(32, 50, ex.Vector.Half, ex.vec(0, 3))\n        });\n    }\n\n    // OnInitialize is called before the 1st actor update\n    onInitialize(engine: ex.Engine) {\n        // Initialize actor\n\n        // Setup visuals\n        const hurtleft = ex.Animation.fromSpriteSheet(botSpriteSheet, [0, 1, 0, 1, 0, 1], 150);\n        hurtleft.scale = new ex.Vector(2, 2);\n\n        const hurtright = ex.Animation.fromSpriteSheet(botSpriteSheet, [0, 1, 0, 1, 0, 1], 150);\n        hurtright.scale = new ex.Vector(2, 2);\n        hurtright.flipHorizontal = true;\n\n        const idle = ex.Animation.fromSpriteSheet(botSpriteSheet, [2, 3], 800);\n        idle.scale = new ex.Vector(2, 2);\n\n        const left = ex.Animation.fromSpriteSheet(botSpriteSheet, [3, 4, 5, 6, 7], 100);\n        left.scale = new ex.Vector(2, 2);\n\n        const right = ex.Animation.fromSpriteSheet(botSpriteSheet, [3, 4, 5, 6, 7], 100);\n        right.scale = new ex.Vector(2, 2);\n        right.flipHorizontal = true;;\n\n        // Register animations with actor\n        this.graphics.add(\"hurtleft\", hurtleft);\n        this.graphics.add(\"hurtright\", hurtright);\n        this.graphics.add(\"idle\", idle);\n        this.graphics.add(\"left\", left);\n        this.graphics.add(\"right\", right);\n\n        // onPostCollision is an event, not a lifecycle meaning it can be subscribed to by other things\n        this.on('postcollision', (evt) => this.onPostCollision(evt));\n    }\n\n    onPostCollision(evt: ex.PostCollisionEvent) {\n        // Bot has collided with it's Top of another collider\n        console.log(evt.other.name);\n        if (evt.side === ex.Side.Bottom) {\n            this.onGround = true;\n        }\n\n        // Bot has collided on the side, display hurt animation\n        if ((evt.side === ex.Side.Left ||\n             evt.side === ex.Side.Right) &&\n            evt.other instanceof Baddie) {\n            if (this.vel.x < 0 && !this.hurt) {\n                this.graphics.use(\"hurtleft\");\n            } \n            if (this.vel.x >= 0 && !this.hurt) {\n                this.graphics.use(\"hurtright\");\n            }\n            this.hurt = true;\n            this.hurtTime = 1000;\n            Resources.hit.play(.1);\n        }\n    }\n\n    // After main update, once per frame execute this code\n    onPreUpdate(engine: ex.Engine, delta: number) {\n        // If hurt, count down\n        if (this.hurtTime >= 0 && this.hurt) {\n            this.hurtTime -= delta;\n            if (this.hurtTime < 0) {\n                this.hurt = false;\n            }\n        }\n\n        // Reset x velocity\n        this.vel.x = 0;\n\n        // Player input\n        if(engine.input.keyboard.isHeld(ex.Input.Keys.Left)) {\n            this.vel.x = -150;\n        }\n\n        if(engine.input.keyboard.isHeld(ex.Input.Keys.Right)) {\n            this.vel.x = 150;\n        }\n\n        if(engine.input.keyboard.isHeld(ex.Input.Keys.Up) && this.onGround) {\n            this.vel.y = -400;\n            this.onGround = false;\n            Resources.jump.play(.1);\n        }\n\n        // Change animation based on velocity\n        if (this.vel.x < 0 && !this.hurt) {\n            this.graphics.use(\"left\");\n        } \n        if (this.vel.x > 0 && !this.hurt) {\n            this.graphics.use(\"right\");\n        }\n        if (this.vel.x === 0 && !this.hurt){\n            this.graphics.use(\"idle\")\n        }\n    }\n}","import * as ex from 'excalibur';\nimport { ExcaliburGraphicsContext } from 'excalibur';\nimport { blockSprite } from './resources';\n\nexport class Floor extends ex.Actor {\n    constructor(x: number, y: number, public cols: number, public rows: number) {\n        super({\n            name: 'Floor',\n            pos: new ex.Vector(x, y),\n            scale: new ex.Vector(2, 2),\n            anchor: ex.Vector.Zero,\n            collider: ex.Shape.Box(20 * cols, 15 * rows, ex.Vector.Zero),\n            collisionType: ex.CollisionType.Fixed,\n            collisionGroup: ex.CollisionGroupManager.groupByName(\"floor\"),\n        });\n\n        for (let i = 0; i < this.cols; i++) {\n            for (let j = 0; j < this.rows; j++) {\n                this.graphics.show(blockSprite, { \n                    anchor: ex.Vector.Zero,\n                    offset: ex.vec(i * blockSprite.width, j * blockSprite.height)\n                })\n            }\n        }\n    }\n}\n","import * as ex from 'excalibur';\nimport { Baddie } from './baddie';\nimport { Bot } from './bot';\nimport { Floor } from './floor';\nimport { NPC } from './npc';\n\nexport class Level extends ex.Scene {\n    constructor() {\n        super();\n    }\n\n    onInitialize(engine: ex.Engine) {\n\n        // Create collision groups for the game\n        ex.CollisionGroupManager.create(\"player\");\n        ex.CollisionGroupManager.create(\"enemy\");\n        ex.CollisionGroupManager.create(\"floor\");\n\n        // Compose actors in scene\n        const actor = new Bot(engine.halfDrawWidth + 100, engine.halfDrawHeight - 100);\n\n        const baddie = new Baddie(engine.halfDrawWidth - 200, 300 - 30, 1);\n        const baddie2 = new Baddie(engine.halfDrawWidth + 200, 300 - 30, -1);\n\n        const npc = new NPC(400, 170);\n        \n        const floor = new Floor(0, 300, 15, 1);\n        const otherFloor = new Floor(engine.halfDrawWidth + 50, 200, 5, 1);\n\n        engine.add(actor);\n        engine.add(npc);\n        engine.add(baddie);\n        engine.add(baddie2);\n        engine.add(floor);\n        engine.add(otherFloor);\n\n        // For the test harness to be predicable\n        if (!(window as any).__TESTING) {\n            // Create camera strategy\n            this.camera.clearAllStrategies();\n            this.camera.strategy.elasticToActor(actor, 0.05, 0.1);\n        }\n    }\n}","import * as ex from 'excalibur';\nimport { loader } from './resources';\nimport { Level } from './level';\n\nconst engine = new ex.Engine({\n    backgroundColor: ex.Color.fromHex('#5fcde4'),\n    width: 600,\n    height: 400,\n    // Turn off anti-aliasing for pixel art graphics\n    antialiasing: false\n});\n\n// Set global gravity, 800 pixels/sec^2\nex.Physics.acc = new ex.Vector(0, 800);\n\n// Setup first level as a custom scene\nconst level = new Level();\nengine.add('level', level);\nengine.goToScene('level');\n\n// Game events to handle\nengine.on('hidden', () => {\n    console.log('pause');\n    engine.stop();\n});\nengine.on('visible', () => {\n    console.log('start');\n    engine.start();\n});\n\n// Start the engine\nengine.start(loader).then(() => {\n    console.log('game start');\n});\n\n// For test hook\n(window as any).engine = engine;\n(window as any).level = level;","import * as ex from 'excalibur';\nimport { botRedSpriteSheet, Resources, npcSprite } from './resources';\n\nexport class NPC extends ex.Actor {\n    public onGround = true;\n    public hurt = false;\n    public hurtTime: number = 0;\n    constructor(x: number, y: number) {\n        super({\n            pos: new ex.Vector(x, y),\n            collisionType: ex.CollisionType.Active,\n            collisionGroup: ex.CollisionGroupManager.groupByName(\"player\"),\n            collider: ex.Shape.Box(32, 50, ex.Vector.Half, ex.vec(0, 3))\n        });\n    }\n\n    // OnInitialize is called before the 1st actor update\n    onInitialize(engine: ex.Engine) {\n        // Initialize actor\n\n        // Set the z-index to be behind everything\n        this.z = -1;\n\n        // Setup visuals\n        const hurtleft = ex.Animation.fromSpriteSheet(botRedSpriteSheet, [0, 1, 0, 1, 0, 1], 150);\n        hurtleft.scale = new ex.Vector(2, 2);\n\n        const hurtright = ex.Animation.fromSpriteSheet(botRedSpriteSheet, [0, 1, 0, 1, 0, 1], 150);\n        hurtright.scale = new ex.Vector(2, 2);\n        hurtright.flipHorizontal = true;\n\n        const idle = ex.Animation.fromSpriteSheet(botRedSpriteSheet, [2, 3], 800);\n        idle.scale = new ex.Vector(2, 2);\n\n        const left = ex.Animation.fromSpriteSheet(botRedSpriteSheet, [3, 4, 5, 6, 7], 100);\n        left.scale = new ex.Vector(2, 2);\n\n        const right = ex.Animation.fromSpriteSheet(botRedSpriteSheet, [3, 4, 5, 6, 7], 100);\n        right.scale = new ex.Vector(2, 2);\n        right.flipHorizontal = true;\n\n        // Register drawings\n        this.graphics.add(\"hurtleft\", hurtleft);\n        this.graphics.add(\"hurtright\", hurtright);\n        this.graphics.add(\"idle\", idle);\n        this.graphics.add(\"left\", left);\n        this.graphics.add(\"right\", right);\n\n        // Setup patroling behavior\n\n        // For the test harness to be predicable\n        if (!(window as any).__TESTING) {\n            this.actions.delay(1000)\n                        .repeatForever(ctx => ctx\n                            .moveBy(100, 0, 20)\n                            .moveBy(-100, 0, 20));\n        }\n\n\n        // Custom draw after local tranform, draws word bubble\n        this.graphics.onPostDraw = (ctx) => {\n            npcSprite.draw(ctx, -10, -100);\n        }\n\n    }\n\n    onPostUpdate(engine: ex.Engine, delta: number) {\n        if (this.vel.x < 0) {\n            this.graphics.use(\"left\");\n        }\n        if (this.vel.x > 0) {\n            this.graphics.use(\"right\");\n        }\n        if (this.vel.x === 0) {\n            this.graphics.use(\"idle\")\n        }\n    }\n}","import * as ex from 'excalibur';\n\nconst botFile = require('../res/excalibot.png');\nconst botRedFile = require('../res/excalibot-red.png');\nconst baddieFile = require('../res/baddie.png');\nconst blockFile = require('../res/block.png');\nconst npcFile = require('../res/npc.png');\nconst jumpSound = require('../res/jump.wav');\nconst hitSound = require('../res/hurt.wav');\nconst gotEmSound = require('../res/gottem.wav');\n\nconst Resources = {\n    bot: new ex.ImageSource(botFile),\n    botRed: new ex.ImageSource(botRedFile),\n    baddie: new ex.ImageSource(baddieFile),\n    block: new ex.ImageSource(blockFile),\n    npc: new ex.ImageSource(npcFile),\n    jump: new ex.Sound(jumpSound),\n    hit: new ex.Sound(hitSound),\n    gotEm: new ex.Sound(gotEmSound)\n}\n\nconst loader = new ex.Loader();\n\nconst botSpriteSheet = ex.SpriteSheet.fromImageSource({\n    image:Resources.bot, \n    grid: { \n        columns: 8,\n        rows: 1, \n        spriteWidth: 32,\n        spriteHeight: 32\n    }\n});\nconst botRedSpriteSheet = ex.SpriteSheet.fromImageSource({\n    image: Resources.botRed,\n    grid: {\n        columns: 8, \n        rows: 1,\n        spriteWidth: 32,\n        spriteHeight: 32\n    }\n});\nconst baddieSpriteSheet = ex.SpriteSheet.fromImageSource({\n    image: Resources.baddie,\n    grid: {\n        columns: 6, \n        rows: 1,\n        spriteWidth: 32,\n        spriteHeight: 32\n    }\n});\nconst blockSprite = Resources.block.toSprite();\nconst npcSprite = Resources.npc.toSprite();\n\nfor (const res in Resources) {\n    loader.addResource((Resources as any)[res]);\n}\n\nexport { Resources, loader, botSpriteSheet, botRedSpriteSheet, baddieSpriteSheet, blockSprite, npcSprite }","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) scriptUrl = scripts[scripts.length - 1].src\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(519);\n"],"names":["__webpack_modules__","module","__unused_webpack_exports","entryUnbind","exports","path","Object","keys","global","isCallable","tryToString","TypeError","argument","isObject","String","toIndexedObject","toAbsoluteIndex","lengthOfArrayLike","createMethod","IS_INCLUDES","$this","el","fromIndex","value","O","length","index","includes","indexOf","fails","METHOD_NAME","method","call","createProperty","Array","max","Math","start","end","k","fin","undefined","result","n","arraySlice","floor","mergeSort","array","comparefn","middle","insertionSort","merge","element","j","i","left","right","llength","rlength","lindex","rindex","uncurryThis","toString","stringSlice","slice","it","TO_STRING_TAG_SUPPORT","classofRaw","TO_STRING_TAG","wellKnownSymbol","CORRECT_ARGUMENTS","arguments","tag","key","error","tryGet","callee","hasOwn","ownKeys","getOwnPropertyDescriptorModule","definePropertyModule","target","source","exceptions","defineProperty","f","getOwnPropertyDescriptor","DESCRIPTORS","createPropertyDescriptor","object","bitmap","enumerable","configurable","writable","toPropertyKey","propertyKey","get","document","EXISTS","createElement","firefox","match","UA","test","getBuiltIn","version","userAgent","process","Deno","versions","v8","split","webkit","CONSTRUCTOR","METHOD","prototype","createNonEnumerableProperty","redefine","setGlobal","copyConstructorProperties","isForced","options","targetProperty","sourceProperty","descriptor","TARGET","GLOBAL","STATIC","stat","noTargetGet","forced","sham","exec","Function","bind","apply","FunctionPrototype","getDescriptor","PROPER","name","CONFIGURABLE","fn","aFunction","namespace","aCallable","V","P","func","check","globalThis","window","self","g","this","toObject","hasOwnProperty","a","classof","propertyIsEnumerable","store","functionToString","inspectSource","set","has","NATIVE_WEAK_MAP","shared","sharedKey","hiddenKeys","OBJECT_ALREADY_INITIALIZED","WeakMap","state","wmget","wmhas","wmset","metadata","facade","STATE","enforce","getterFor","TYPE","type","replacement","feature","detection","data","normalize","POLYFILL","NATIVE","string","replace","toLowerCase","isPrototypeOf","USE_SYMBOL_AS_UID","$Symbol","toLength","obj","V8_VERSION","getOwnPropertySymbols","symbol","Symbol","__unused_webpack_module","IE8_DOM_DEFINE","V8_PROTOTYPE_DEFINE_BUG","anObject","$defineProperty","$getOwnPropertyDescriptor","Attributes","current","propertyIsEnumerableModule","internalObjectKeys","concat","getOwnPropertyNames","push","names","enumBugKeys","$propertyIsEnumerable","NASHORN_BUG","input","pref","val","valueOf","getOwnPropertyNamesModule","getOwnPropertySymbolsModule","InternalStateModule","CONFIGURABLE_FUNCTION_NAME","getInternalState","enforceInternalState","TEMPLATE","unsafe","simple","join","uid","SHARED","IS_PURE","mode","copyright","toIntegerOrInfinity","min","integer","IndexedObject","requireObjectCoercible","ceil","number","isSymbol","getMethod","ordinaryToPrimitive","TO_PRIMITIVE","exoticToPrim","toPrimitive","id","postfix","random","NATIVE_SYMBOL","iterator","WellKnownSymbolsStore","symbolFor","createWellKnownSymbol","withoutSetter","description","$","internalSort","arrayMethodIsStrict","FF","IE_OR_EDGE","V8","WEBKIT","un$Sort","sort","FAILS_ON_UNDEFINED","FAILS_ON_NULL","STRICT_METHOD","STABLE_SORT","code","chr","fromCharCode","v","b","charAt","proto","itemsLength","items","arrayLength","x","y","getSortCompare","nativeKeys","__webpack_exports__","d","_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__","_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default","_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__","___CSS_LOADER_EXPORT___","_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default","__WEBPACK_DEFAULT_EXPORT__","cssWithMappingToString","list","map","item","content","needLayer","modules","media","dedupe","supports","layer","alreadyImportedModules","_k","cssMapping","btoa","base64","unescape","encodeURIComponent","JSON","stringify","sourceMapping","sourceURLs","sources","sourceRoot","__webpack_module_cache__","moduleId","cachedModule","getter","__esModule","definition","o","e","prop","r","toStringTag","webgl_util_namespaceObject","Events_namespaceObject","SpriteEffects_namespaceObject","DrawUtil_namespaceObject","Drawing_Index_namespaceObject","Input_Index_namespaceObject","Traits_Index_namespaceObject","Experiments","Legacy","LogLevel","Util_Index_namespaceObject","polyfill","audioContext","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","callback","setInterval","cancelAnimationFrame","webkitCancelAnimationFrame","mozCancelAnimationFrame","AudioContext","webkitAudioContext","replaceMe","decodeAudioData","arrayBuffer","Promise","resolve","reject","mozAudioContext","msAudioContext","oAudioContext","devicePixelRatio","Flags","static","_FROZEN","_FLAGS","enable","WebGL","Canvas","LegacyDrawing","flagName","Error","createId","Logger","constructor","_appenders","defaultLevel","Info","_INSTANCE","addAppender","ConsoleAppender","appender","clearAppenders","_log","level","args","len","log","debug","Debug","info","warn","Warn","fatal","Fatal","console","consoleArgs","unshift","ScreenAppender","width","height","_messages","_canvas","innerWidth","innerHeight","style","position","_ctx","getContext","body","appendChild","message","clearRect","pos","opacity","fillStyle","toFixed","fillText","maxMessages","obsoleteMessage","resetObsoleteCounter","logMessage","suppressObsoleteMessages","isEnabled","getInstance","trace","showStackTrace","obsolete","alternateMethod","property","SyntaxError","DecoratedClass","super","Vector","_x","_y","Zero","One","Half","Up","Down","Left","Right","angle","cos","sin","vec","isNaN","Infinity","vec1","vec2","sqrt","pow","setTo","equals","vector","tolerance","abs","distance","squareDistance","magnitude","size","newLength","scale","average","add","sizeOrScale","sub","addEqual","subEqual","scaleEqual","dot","cross","num","perpendicular","normal","negate","toAngle","atan2","rotate","anchor","sinAngle","cosAngle","clone","fixed","decorators","desc","c","Reflect","decorate","__decorate","Side","Color_decorate","Color","parseInt","parseFloat","hex","h","s","l","HSLColor","toRGBA","lighten","factor","temp","fromRGBA","darken","saturate","desaturate","multiply","color","newR","newG","newB","newA","mulitiply","screen","color1","invert","color2","equal","format","toHSLA","toHex","_componentToHex","Black","fromHex","White","Gray","LightGray","DarkGray","Yellow","Orange","Red","Vermilion","Vermillion","Rose","Magenta","Violet","Blue","Azure","Cyan","Viridian","Green","Chartreuse","Transparent","ExcaliburBlue","p","q","t","hue2rgb","getOpposite","side","Top","Bottom","None","fromDirection","direction","directions","directionEnum","Number","MAX_VALUE","maxIndex","BoundingBox","leftOrOptions","top","bottom","intersection","points","minX","minY","maxX","maxY","hasZeroDimensions","center","translate","point","getPoints","fromPoints","shifted","transform","matrix","multv","getPerimeter","results","rayCast","ray","farClipDistance","tmin","tmax","xinv","dir","yinv","tx1","tx2","ty1","ty2","rayCastTime","contains","combine","other","dimensions","intersect","totalBoundingBox","overlapX","overlapY","intersectWithSide","bb","getSideFromIntersection","debugDraw","ctx","strokeStyle","strokeRect","draw","ex","drawRect","BITMASK32","Random","seed","_lowerMask","_upperMask","_w","_n","_m","_a","_u","_s","_b","_t","_c","_l","_f","_mt","Date","now","_index","_twist","mag01","nextInt","next","floating","bool","likelihood","pickOne","pickSet","numPicks","allowDuplicates","_pickSetWithDuplicates","_pickSetWithoutDuplicates","currentPick","tempArray","splice","shuffle","swap","randomIndex","range","d4","d6","d8","d10","d12","d20","TwoPI","PI","frac","sign","clamp","canonicalizeAngle","tmpAngle","toDegrees","radians","toRadians","degrees","from","to","randomInRange","randomIntInRange","round","Util_TwoPI","Util_clamp","Util_randomInRange","Util_randomIntInRange","Util_canonicalizeAngle","Util_toDegrees","Util_toRadians","Util_range","getPosition","oLeft","oTop","calcOffsetLeft","parent","offsetLeft","offsetParent","calcOffsetTop","offsetTop","addItemToArray","removeItemFromArray","getOppositeSide","getSideFromDirection","Collection","initialSize","DefaultSize","_internalArray","_endPointer","_resize","newSize","newArray","count","pop","clear","internalSize","elementAt","insert","remove","removed","removeElement","toArray","forEach","fail","delay","milliseconds","clock","schedule","setTimeout","MatrixLocations","ImageFiltering","EventTypes","Matrix","Float32Array","_scaleSignX","_scaleSignY","near","far","mat","toDOMMatrix","DOMMatrix","reset","identity","sx","sy","angleRadians","multm","dest","a11","a21","a31","a41","a12","a22","a32","a42","a13","a23","a33","a43","a14","a24","a34","a44","b11","b21","b31","b41","b12","b22","b32","b42","b13","b23","b33","b43","b14","b24","b34","b44","getScale","setPosition","sine","cosine","setRotation","currentScale","getRotation","getScaleY","getScaleX","xscale","yscale","setScaleX","setScaleY","setScale","getBasisDeterminant","getAffineInverse","inverseDet","m","tx","ty","isIdentity","TransformStack","_transforms","_currentTransform","save","restore","StateStack","_states","_currentState","_getDefaultState","_cloneState","watch","change","__isProxy","Proxy","watchAny","Graphic","_d","_e","_ID","_transformStale","showDebug","_flipHorizontal","_flipVertical","_rotation","_scale","_origin","_width","_height","origin","flipHorizontal","flipVertical","rotation","isStale","cloneGraphicOptions","localBounds","fromDimension","_preDraw","_drawImage","_postDraw","_rotate","_flip","scaleDirX","scaleDirY","isPowerOfTwo","nextHighestPowerOfTwo","ensurePowerOfTwo","getGlTypeSizeBytes","gl","FLOAT","SHORT","UNSIGNED_SHORT","BYTE","UNSIGNED_BYTE","getAttributeComponentSize","LOW_FLOAT","HIGH_FLOAT","FLOAT_VEC2","FLOAT_VEC3","FLOAT_VEC4","getAttributePointerType","TextureLoader","context","_GL","image","_TEXTURE_MAP","filtering","forceUpdate","tex","bindTexture","TEXTURE_2D","toPowerOfTwoImage","texImage2D","RGBA","createTexture","pixelStorei","UNPACK_PREMULTIPLY_ALPHA_WEBGL","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","filterMode","TEXTURE_MIN_FILTER","Pixel","NEAREST","LINEAR","TEXTURE_MAG_FILTER","potCanvas","_POT_CANVAS","potCtx","_POT_CTX","imageSmoothingEnabled","drawImage","Blended","Map","Raster","_g","_h","_dirty","_smoothing","_color","flagDirty","_lineWidth","_lineDash","_padding","strokeColor","smoothing","lineWidth","lineDash","padding","_bitmap","bitmapWidth","bitmapHeight","maybeCtx","cloneRasterOptions","dirty","_getTotalWidth","_originalWidth","_getTotalHeight","_originalHeight","_strokeColor","rasterize","_applyRasterProperties","execute","load","setLineDash","getLineDash","_options","cache","GameEvent","_bubbles","bubbles","stopPropagation","KillEvent","PreKillEvent","PostKillEvent","GameStartEvent","GameStopEvent","PreDrawEvent","delta","PostDrawEvent","PreDebugDrawEvent","PostDebugDrawEvent","PreUpdateEvent","engine","PostUpdateEvent","PreFrameEvent","prevStats","PostFrameEvent","stats","GamepadConnectEvent","gamepad","GamepadDisconnectEvent","GamepadButtonEvent","button","GamepadAxisEvent","axis","SubscribeEvent","topic","handler","UnsubscribeEvent","VisibleEvent","HiddenEvent","PreCollisionEvent","actor","PostCollisionEvent","ContactStartEvent","contact","ContactEndEvent","CollisionPreSolveEvent","CollisionPostSolveEvent","CollisionStartEvent","CollisionEndEvent","InitializeEvent","ActivateEvent","oldScene","DeactivateEvent","newScene","ExitViewPortEvent","EnterViewPortEvent","EnterTriggerEvent","ExitTriggerEvent","EventDispatcher","_handlers","_wiredEventDispatchers","emit","eventName","event","on","off","eventHandlers","once","ev","wire","eventDispatcher","unwire","Resource","responseType","bustCache","logger","events","isLoaded","_cacheBust","uri","request","XMLHttpRequest","open","addEventListener","status","response","statusText","send","SpriteEffects_decorate","Grayscale","updatePixel","imageData","firstPixel","pixel","avg","Invert","Opacity","Colorize","Lighten","fromRGB","Darken","Saturate","Desaturate","Fill","Texture","_sprite","loaded","_loadedResolve","_resource","Sprite_Sprite","async","url","blob","URL","createObjectURL","Image","src","decode","naturalWidth","naturalHeight","asSprite","Configurable","base","assign","props","filter","SpriteImpl","imageOrConfig","offset","drawAroundAnchor","effects","_spriteCanvas","_spriteCtx","_pixelData","_pixelsLoaded","_dirtyEffect","_opacity","texture","_initPixelsFromTexture","drawWidth","drawHeight","_loadPixels","_flushTexture","grayscale","addEffect","fill","colorize","effect","_applyEffects","removeEffect","param","indexToRemove","getImageData","putImageData","clearEffects","xpoint","ypoint","ctxOrOptions","CanvasRenderingContext2D","_drawWithOptions","_j","anchorX","anchorY","oldAlpha","globalAlpha","Sprite_decorate","Sprite","sourceView","destSize","_updateSpriteDimensions","ready","then","newWidth","newHeight","nativeWidth","nativeHeight","sprite","ImageSource","fromLegacyTexture","_logger","_filtering","endsWith","_src","toSprite","unload","AnimationImpl","engineOrConfig","sprites","speed","loop","currentFrame","_timeLeftInFrame","_idempotencyToken","freezeFrame","Engine","config","_engine","_setAnchor","_setRotation","_setScale","isDone","tick","elapsed","idempotencyToken","_updateValues","skip","frames","animOptions","currSprite","play","playAnimation","Animation_Animation","images","FontUnit","TextAlign","BaseAlign","FontStyle","Direction","Animation_decorate","SpriteSheet_SpriteSheet","imageOrConfigOrSprites","columns","rows","spWidth","spHeight","spacing","_sprites","_image","_columns","_rows","_spWidth","_spHeight","_spacing","loadFromImage","isWidthError","isHeightError","RangeError","getSpacingDimensions","row","col","margin","getAnimationByIndices","indices","getAnimationBetween","beginIndex","endIndex","getAnimationForAll","getSprite","getAnimationByCoords","spriteCoordinates","maxWidth","maxHeight","coord","anim","SpriteFont","alphabet","caseInsensitive","_currentColor","_currentOpacity","_spriteRecord","_textShadowOn","_textShadowDirty","_textShadowColor","_textShadowSprites","_shadowOffsetX","_shadowOffsetY","getTextSprites","lookup","char","setTextShadow","offsetX","offsetY","shadowColor","character","useTextShadow","text","_parseOptions","characterShadow","fontSize","letterSpacing","currX","textAlign","Start","End","Center","currY","baseAlign","Hanging","Ideographic","Alphabetic","Middle","charSprite","SpriteSheet_decorate","SpriteSheet","spriteIndex","legacySpriteSheet","oldSprite","fromLegacySprite","spriteSheet","toLegacySprite","grid","cols","spriteWidth","spriteHeight","originOffset","offsetDefaults","marginDefaults","SpriteFont_SpriteFont","_text","shadow","_alreadyWarnedAlphabet","_alreadyWarnedSpriteSheet","spriteFont","_getCharacterSprites","textToRender","toLocaleLowerCase","letterIndex","letter","letterSprite","measureText","lines","maxWidthLine","reduce","xCursor","yCursor","line","render","bounds","DebugText","fontSheet","_imageSource","_spriteSheet","fromImageSource","_spriteFont","write","RenderSource","_gl","_texture","use","activeTexture","TEXTURE0","disable","RenderTarget","_setupFramebuffer","setResolution","_frameTexture","frameBuffer","_frameBuffer","frameTexture","attachmentPoint","COLOR_ATTACHMENT0","createFramebuffer","bindFramebuffer","FRAMEBUFFER","framebufferTexture2D","toRenderSource","viewport","ExcaliburWebGLContextAccessor","Shader","uniforms","attributes","_compiled","vertexSource","fragmentSource","compiled","useProgram","program","_ACTIVE_SHADER_INSTANCE","isCurrentlyBound","compile","vertexShader","_compileShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","_createProgram","getAttributes","attribute","getUniforms","uniform","uniformCount","getProgramParameter","ACTIVE_UNIFORMS","getActiveUniform","uniformLocation","getUniformLocation","glType","location","attributeCount","ACTIVE_ATTRIBUTES","getActiveAttrib","attributeLocation","getAttribLocation","normalized","setTexture","slotNumber","setUniformInt","setUniform","setUniformIntArray","setUniformBoolean","setUniformFloat","setUniformFloatArray","setUniformFloatVector","setUniformMatrix","uniformType","createProgram","attachShader","linkProgram","LINK_STATUS","getProgramInfoLog","typeName","shader","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","errorInfo","getShaderInfoLog","_processSourceForError","errorLineStart","search","errorLineEnd","_","error2","VertexBuffer","buffer","createBuffer","bufferData","bindBuffer","ARRAY_BUFFER","upload","STATIC_DRAW","DYNAMIC_DRAW","VertexLayout","_layout","_attributes","_vertexTotalSizeBytes","vertexBuffer","_vertexBuffer","_shader","initialize","totalVertexSizeBytes","shaderAttributes","attrib","componentsPerVertex","vertAttribute","typeSize","uploadBuffer","vert","vertexAttribPointer","enableVertexAttribArray","GraphicsDiagnostics","DrawCallCount","DrawnImagesCount","LineRenderer","priority","_maxLines","_vertexIndex","_lineCount","_context","ortho","_isFull","flush","getTransform","finalStart","finalEnd","hasPendingDraws","drawArrays","LINES","PointRenderer","_maxPoints","_pointCount","_buffer","finalPoint","POINTS","ScreenPassPainter","renderWithPostProcessor","postprocessor","getShader","getLayout","TRIANGLES","renderToScreen","QuadIndexBuffer","numberOfQuads","useUint16","ELEMENT_ARRAY_BUFFER","totalVertices","getExtension","Uint32Array","maxUint16","maxUint16Index","bufferGlType","Uint16Array","currentQuad","ImageRenderer","_maxImages","_maxTextures","_imageCount","_textures","getParameter","MAX_TEXTURE_IMAGE_UNITS","transformedFrag","_transformFragmentSource","_quads","maxTextures","newSource","texturePickerBuilder","_addImageAsTexture","_bindTextures","_getTextureIdForImage","swidth","sheight","dx","dy","dwidth","dheight","view","sw","sh","snapToPixel","topleft","topRight","bottomLeft","bottomRight","textureId","potWidth","potHeight","uvx0","uvy0","uvx1","uvy1","drawElements","RectangleRenderer","_maxRectangles","_rectangleCount","drawLine","thickness","halfThick","startTop","startBottom","endTop","endBottom","stroke","strokeThickness","topLeft","CircleRenderer","_maxCircles","_circleCount","radius","ExcaliburGraphicsContextWebGLDebug","_webglCtx","_debugText","rectOptions","lineOptions","drawPoint","pointOptions","drawText","ExcaliburGraphicsContextWebGL","_renderers","_isDrawLifecycle","_postProcessTargets","_postprocessors","_transform","_state","backgroundColor","_alreadyWarnedDrawLifecycle","canvasElement","enableTransparency","__gl","antialias","premultipliedAlpha","alpha","depth","powerPreference","register","_init","canvas","_ortho","checkIfResolutionSupported","dim","maxDim","MAX_TEXTURE_SIZE","supported","clearColor","COLOR_BUFFER_BIT","BLEND","blendEquation","FUNC_ADD","blendFunc","ONE","ONE_MINUS_SRC_ALPHA","blendEquationSeparate","blendFuncSeparate","_screenRenderer","_renderTarget","__ctx","renderer","rendererName","_isCurrentRenderer","_currentRenderer","beginDrawLifecycle","endDrawLifecycle","resetTransform","updateViewport","resolution","drawRectangle","drawCircle","addPostProcessor","removePostProcessor","clearPostProcessors","values","DisplayMode","Resolution","SVGA","Standard","Atari2600","GameBoy","GameBoyAdvance","NintendoDS","NES","SNES","Screen","_antialiasing","_resolutionStack","_viewportStack","_pixelRatioOverride","_isFullScreen","_isDisposed","_fullscreenChangeHandler","_pixelRatioChangeHandler","_listenForPixelRatio","_devicePixelRatio","_calculateDevicePixelRatio","applyResolutionAndViewport","_resizeHandler","_setResolutionAndViewportByDisplayMode","_alreadyWarned","_displayMode","displayMode","Fixed","graphicsContext","antialiasing","_browser","browser","_position","pixelRatio","_applyDisplayMode","_mediaQueryList","removeListener","nativeComponent","matchMedia","addListener","dispose","_resizeObserver","disconnect","removeEventListener","isHiDpi","FillContainer","FitContainer","parentElement","_resolution","_viewport","aspectRatio","scaledWidth","scaledHeight","setCurrentCamera","camera","_camera","pushResolutionAndViewport","peekViewport","peekResolution","popResolutionAndViewport","imageRendering","isSmooth","isFullScreen","goFullScreen","requestFullscreen","exitFullScreen","exitFullscreen","pageToScreenCoordinates","newX","newY","screenHeight","screenWidth","screenToPageCoordinates","screenMarginY","screenMarginX","screenToWorldCoordinates","inverse","worldToScreenCoordinates","pageToWorldCoordinates","worldToPageCoordinates","getWorldBounds","canvasWidth","halfCanvasWidth","canvasHeight","halfCanvasHeight","zoom","halfDrawWidth","halfDrawHeight","_computeFit","overflow","aspect","adjustedWidth","adjustedHeight","_computeFitContainer","clientWidth","clientHeight","Position","_initializeDisplayModePosition","Window","ResizeObserver","observe","FillScreen","FitScreen","display","specifiedPosition","marginTop","marginLeft","AudioContextFactory","WebAudio","_UNLOCKED","create","unlockTimeoutTimer","resume","createBufferSource","ended","connect","destination","onended","playbackState","isLegacyWebAudioSource","currentTime","PLAYING_STATE","FINISHED_STATE","clearTimeout","Class","eventObject","x1","y1","x2","y2","cap","beginPath","lineCap","moveTo","lineTo","closePath","arc","roundRect","br","tl","tr","bl","defaultRadius","quadraticCurveTo","circle","Loader_0","Loader","loadables","_resourceList","_playButtonShown","_resourceCount","_numLoaded","_progressCounts","_totalCounts","logo","logoWidth","logoHeight","loadingBarColor","suppressPlayButton","_playButtonStyles","Z","playButtonText","startButtonFactory","buttonElement","getElementById","textContent","_isLoadedPromise","_isLoadedResolve","addResources","_imageElement","playButtonRootElement","_playButtonRootElement","playButtonElement","_playButtonElement","_playButton","existingRoot","_styleBlock","head","wireEngine","addResource","loadable","resizeHandler","_positionPlayButton","evt","click","playButtonClicked","startButtonHandler","hidePlayButton","removeChild","update","_delta","areResourcesLoaded","all","finally","showPlayButton","unlock","markResourceComplete","progress","buttonWidth","buttonHeight","playButtonPosition","fillRect","logoY","logoX","logoPosition","imageHeight","oldAntialias","getAntialiasing","setAntialiasing","loadingX","loadingY","loadingBarPosition","progressWidth","REPORTED_FEATURES","webgl","webaudio","gamepadapi","Detector","_features","failedTests","_criticalTests","canvasSupport","elem","arrayBufferSupport","xhr","dataUrlSupport","toDataURL","objectUrlSupport","rgbaSupport","cssText","_warningTest","webAudioSupport","webglSupport","_loadBrowserFeatures","getBrowserFeatures","logBrowserFeatures","msg","arraybuffer","dataurl","objecturl","rgba","navigator","getGamepads","failedCritical","warning","CollisionType","CollisionResolutionStrategy","BroadphaseStrategy","Integrator","CoordPlane","Physics","gravity","acc","collisionResolutionStrategy","Arcade","Realistic","dynamicTreeVelocityMultiplyer","dynamicTreeVelocityMultiplier","enabled","broadphaseStrategy","DynamicAABBTree","defaultMass","integrator","Euler","boundsPadding","positionIterations","velocityIterations","slop","steeringFactor","warmStart","bodiesCanSleepByDefault","surfaceEpsilon","sleepEpsilon","wakeThreshold","sleepBias","checkForFastBodies","disableMinimumSpeedForFastBody","Physics_decorate","VectorView","_getX","getX","_getY","getY","_setX","setX","_setY","setY","Component","owner","newComponent","TagComponent","TransformComponent","X","Y","createPosView","createScaleView","coordPlane","World","z","_recalculate","getGlobalMatrix","getGlobalTransform","globalPos","globalScale","globalRotation","parentTransform","globalScaleX","globalScaleY","applyInverse","MotionComponent","vel","scaleFactor","angularVelocity","torque","inertia","CollisionGroup","category","mask","_name","_category","_mask","canCollide","collisionGroups","combinedName","combinedCategory","All","Observable","observers","subscriptions","observer","subscribe","unregister","unsubscribe","notifyAll","notify","cb","Pair","colliderA","colliderB","calculatePairHash","bodyA","BodyComponent","bodyB","group","collisionType","PreventCollision","active","collide","hasCollider","collider","idA","idB","Projection","overlaps","projection","getOverlap","TreeNode","isLeaf","DynamicTree","worldBounds","root","nodes","_insert","leaf","leafAABB","currentRoot","area","combinedArea","cost","inheritanceCost","leftCost","leftCombined","newArea","oldArea","rightCost","rightCombined","oldParent","newParent","currentNode","_balance","_remove","grandParent","sibling","trackCollider","node","updateCollider","untrackCollider","multdx","multdy","balance","getHeight","query","helper","rayCastQuery","getNodes","Ray","numerator","begin","getSlope","divisor","u","getLength","intersectPoint","time","getPoint","DynamicTreeCollisionProcessor","_dynamicCollisionTree","_pairs","Set","_collisionPairCache","_colliders","getColliders","track","CompositeCollider","colliders","untrack","_pairExists","hash","broadphase","targets","seconds","potentialColliders","pair","physics","pairs","Active","updateDistance","minDimension","fastBodies","updateVec","oldPos","centerPoint","furthestPoint","getFurthestPoint","minCollider","minTranslate","hitPoint","isValid","shift","fastBodyCollisions","narrowphase","contacts","newContacts","collisions","updated","Collider","touching","_collisionProcessor","_dynamicAABBTree","addCollider","clearColliders","removeCollider","worldPos","axes","furthestPoints","bestPoint","maxDistance","getInertia","mass","totalInertia","otherColliders","potentialCollider","getClosestLineBetween","maybeLine","minLength","minLine","minPoint","minDistance","project","projs","proj","newProjection","Line","slope","intercept","getEdge","midpoint","flip","below","clip","sideVector","clipTime","distanceToPoint","signed","x0","y0","findVectorToPoint","aMinusP","findPoint","hasPoint","currPoint","threshold","dxc","dyc","dx1","dy1","ClosestLine","p0","q0","w0","denom","sDenom","tDenom","tClosestParallel","sClosest","tClosest","ClosestLineJumpTable","PolygonPolygonClosestLine","polygonA","polygonB","otherWorldPos","otherDirection","thisDirection","rayTowardsOther","rayTowardsThis","thisPoint","otherPoint","thisFace","getClosestFace","otherFace","face","PolygonEdgeClosestLine","polygon","edge","edgeLine","asLine","PolygonCircleClosestLine","circlex","circley","CircleCircleClosestLine","circleA","circleB","CircleEdgeClosestLine","circleWorlPos","EdgeEdgeClosestLine","edgeA","edgeB","edgeLineA","edgeLineB","CircleCollider","_naturalRadius","orig","discriminant","toi","toi1","toi2","positiveToi","mintoi","shape","PolygonCollider","EdgeCollider","CollisionJumpTable","CollideCircleCircle","CollideCirclePolygon","CollideCircleEdge","getFurthestLocalPoint","scalars","dotProduct","newPos","CollisionContact","mtv","tangent","localPoints","_canceled","matchAwake","sleeping","sleepMotion","setSleeping","isCanceled","cancel","SeparatingAxis","polyA","polyB","bestSeparation","bestSide","bestAxis","bestSideIndex","bestOtherPoint","sides","getSides","localSides","getLocalSides","vertB","vertSeparation","separation","localSide","sideId","localPoint","polyDir","closestPointOnPoly","minOverlap","minAxis","minIndex","proj1","proj2","overlap","circleAPos","circleBPos","combinedRadius","mvt","local","findCirclePolygonSeparation","samedir","findSide","findLocalSide","cc","edgeWorld","asLocalLine","da","dda","db","ddb","den","pointOnEdge","dd","CollideEdgeEdge","CollidePolygonEdge","pc","linePoly","CollidePolygonPolygon","separationA","findPolygonPolygonSeparation","separationB","incident","reference","refDir","clipRight","clipLeft","xf","FindContactSeparation","shapeA","txA","shapeB","txB","worldPoint","circlePoint","dist","_getBodyPos","_getTransformedBegin","_getTransformedEnd","transformedBegin","transformedEnd","_boundsFromBeginEnd","edgeNormal","_transformedPoints","_axes","_sides","_localSides","winding","clockwiseWinding","reverse","_calculateTransformation","getTransformedPoints","currentSide","mostDirection","testRay","accum","pts","POSITIVE_INFINITY","faceIndex","denominator","iplusone","crossTerm","minContactTime","contactIndex","contactTime","scalar","effectiveOffset","firstPoint","Shape","Circle","Box","ColliderComponent","$colliderAdded","$colliderRemoved","_collider","flipped","onAdd","entity","precollision","postcollision","onRemove","useBoxCollider","usePolygonCollider","poly","Polygon","useCircleCollider","useEdgeCollider","Edge","useCompositeCollider","DegreeOfFreedom","dependencies","canSleep","_sleeping","bounciness","friction","useGravity","limitDegreeOfFreedom","oldVel","oldAcc","oldRotation","oldScale","inverseMass","updateMotion","currentMotion","bias","inverseInertia","motion","xFactor","yFactor","rx","applyImpulse","impulse","finalImpulse","Rotation","distanceFromCenter","applyLinearImpulse","applyAngularImpulse","captureOldTransform","CullingBox","_topLeft","_topRight","_bottomLeft","_bottomRight","isSpriteOffScreen","drawingWidth","currentDrawing","drawingHeight","getGlobalPos","topLeftScreen","topRightScreen","bottomLeftScreen","bottomRightScreen","_xCoords","_yCoords","_xMin","_yMin","_xMax","_yMax","minWorld","maxWorld","_xMinWorld","_yMinWorld","_xMaxWorld","_yMaxWorld","boundingPoints","rect","OffscreenCulling","cullingBox","actorBoundsOffscreen","currentScene","isOffScreen","removeComponent","addComponent","AddedComponent","isAddedComponent","RemovedComponent","isRemovedComponent","Entity","components","_componentsToRemove","_componentTypeToInstance","_componentStringToInstance","_tagsMemo","_typesMemo","componentAdded$","componentRemoved$","_parent","childrenAdded$","childrenRemoved$","_children","_isInitialized","_setName","component","kill","isKilled","tags","hasTag","addTag","removeTag","force","types","_rebuildMemos","getComponents","_notifyAddComponent","added","_notifyRemoveComponent","children","unparent","addChild","getAncestors","removeAllChildren","getDescendants","queue","curr","newEntity","child","addTemplate","templateEntity","ctor","constuctorType","componentOrType","_removeComponentByType","delete","processComponentRemoval","isInitialized","_initialize","onInitialize","_preupdate","onPreUpdate","_postupdate","onPostUpdate","CanvasDrawComponent","hasGraphicsTick","graphic","GraphicsLayer","_graphics","graphics","hide","nameOrGraphic","gfx","getGraphic","show","copyGraphics","getNames","order","currentKeys","GraphicsLayers","_component","_layers","_layerMap","default","_maybeAddLayer","_getLayer","graphicsLayerKeys","GraphicsComponent","visible","_bounds","onPreDraw","onPostDraw","layers","graphicToSet","Rectangle","_radius","PointerComponent","useColliderShape","useGraphicsBounds","RotationType","EasingFunctions","easing","duration","CreateReversibleEasingFunction","Linear","startValue","endValue","EaseInQuad","EaseOutQuad","EaseInOutQuad","EaseInCubic","EaseOutCubic","EaseInOutCubic","EasingFunctions_decorate","ActionQueue","_actions","_completedActions","_entity","action","clearActions","_currentAction","stop","getActions","hasNext","isComplete","elapsedMs","Repeat","repeatBuilder","repeat","_stopped","_repeatBuilder","_repeatContext","ActionContext","_actionQueue","getQueue","_repeat","_originalRepeat","RepeatForever","MoveBy","_started","_tx","_motion","_speed","_offset","_start","_end","_distance","_dir","MoveTo","destx","desty","RotateTo","rotationType","_rotationType","ShortestPath","_currentNonCannonAngle","distance1","distance2","_shortDistance","_longDistance","_shortestPathIsPositive","_direction","LongestPath","Clockwise","CounterClockwise","distanceTravelled","RotateBy","angleRadiansOffset","ScaleTo","scaleX","scaleY","speedX","speedY","_endX","_endY","_speedX","_speedY","_startX","_startY","_distanceX","_distanceY","directionX","directionY","ScaleBy","scaleOffsetX","scaleOffsetY","_startScale","_endScale","_directionX","_directionY","CallMethod","_method","_hasBeenCalled","EaseTo","easingFcn","_currentLerpTime","_lerpDuration","_lerpStart","_lerpEnd","_initialized","Blink","timeVisible","timeNotVisible","numBlinks","_timeVisible","_timeNotVisible","_elapsedTime","_totalTime","_duration","Fade","endOpacity","_multiplier","_endOpacity","Delay","_delay","Die","ActionsComponent","Follow","entityToFollow","followDistance","_followTx","_followMotion","_current","_maximumDistance","_distanceBetween","actorToFollowSpeed","Meet","actorToMeet","_speedWasSpecified","_meetTx","_meetMotion","actorToMeetSpeed","_queue","easeTo","xOrPos","yOrSpeed","speedOrUndefined","moveBy","xOffsetOrVector","yOffsetOrSpeed","xOffset","yOffset","rotateTo","rotateBy","scaleTo","sizeXOrVector","sizeYOrSpeed","speedXOrUndefined","speedYOrUndefined","sizeX","sizeY","scaleBy","sizeOffsetXOrVector","sizeOffsetYOrSpeed","sizeOffsetX","sizeOffsetY","blink","fade","die","callMethod","times","repeatForever","follow","meet","asPromise","toPromise","Font","_o","_p","_q","_r","quality","family","Normal","bold","unit","Px","LeftToRight","_textBounds","_textToBitmap","_bitmapUsage","blur","fontString","_ex","_getTextBitmap","_applyFont","metrics","textHeight","actualBoundingBoxAscent","actualBoundingBoxDescent","lineAdjustedHeight","bottomBounds","actualBoundingBoxLeft","actualBoundingBoxRight","_setDimension","textBounds","_getRasterPropertiesHash","textBaseline","font","shadowBlur","shadowOffsetX","shadowOffsetY","_drawText","colorOverride","lineHeight","strokeText","textAndHash","clearCache","checkAndClearCache","isNewBitmap","rasterWidth","rasterHeight","performance","cacheSize","entries","Text","_textWidth","_textHeight","_font","_calculateDimension","Actor_decorate","Actor","_anchor","_handleAnchorChange","scene","_draggable","_dragging","_pointerDragStartHandler","_pointerDragEndHandler","_pointerDragMoveHandler","pe","_pointerDragLeaveHandler","traits","collisionGroup","defaults","Passive","pointer","actions","thePos","theVel","theAcc","theAngle","isVisible","draggable","isDraggable","currentGraphic","_prekill","_scene","onPreKill","_postkill","onPostKill","unkill","setDrawing","addDrawing","getZIndex","newZ","setZIndex","newIndex","localCenter","getGlobalScale","getGlobalRotation","recurse","geom","containment","some","within","otherCollider","me","drawing","currFrame","trait","_predraw","_postdraw","ScreenElement_ScreenElement","useWorld","coords","Timer","fcn","interval","repeats","numberOfRepeats","_totalTimeAlive","_running","_numberOfTicks","maxNumberOfRepeats","_complete","_MAX_ID","_callbacks","complete","newInterval","newNumberOfRepeats","timesRepeated","getTimeRunning","timeToNextAction","timeElapsedTowardNextAction","isRunning","pause","unpause","cancelTimer","Timer_decorate","DebugGraphicsComponent","Axis","TileMap_decorate","TileMapImpl","xOrConfig","cellWidth","cellHeight","_token","_onScreenXStart","_onScreenXEnd","_onScreenYStart","_onScreenYEnd","_spriteSheets","_legacySpriteMap","_cols","isOffscreen","_composite","currentCol","cd","Cell","registerSpriteSheet","fromLegacySpriteSheet","_updateColliders","tile","solid","prev","getCellByIndex","getCell","getCellByPoint","cell","getRows","getColumns","worldCoordsUpperLeft","worldCoordsLowerRight","xEnd","yEnd","graphicsIndex","graphicsLen","grayish","TileMap","CellImpl","_solid","pushSprite","addGraphic","removeGraphic","clearGraphics","StrategyContainer","lockToActor","addStrategy","LockCameraToActorStrategy","lockToActorAxis","LockCameraToActorAxisStrategy","elasticToActor","cameraElasticity","cameraFriction","ElasticToActorStrategy","radiusAroundActor","RadiusAroundActorStrategy","limitCameraBounds","box","LimitCameraBoundsStrategy","_cam","_eng","cam","currentFocus","getFocus","focus","cameraVel","stretch","boundSizeChecked","focusX","focusY","Camera","_cameraStrategies","strategy","_z","dz","az","_posChanged","_pos","_cameraMoving","_isShaking","_shakeMagnitudeX","_shakeMagnitudeY","_shakeDuration","_elapsedShakeTime","_xShake","_yShake","_isZooming","_zoomStart","_zoomEnd","_currentZoomTime","_zoomDuration","_zoomEasing","_easing","_halfWidth","_halfHeight","_follow","ax","ay","move","easingFn","_lerpPromise","_lerpResolve","shake","magnitudeX","magnitudeY","zoomOverTime","_zoomPromise","_zoomResolve","cameraStrategy","removeStrategy","clearAllStrategies","_screen","currentRes","loadingComplete","res","updateTransform","runStrategies","newZoom","zoomEasing","lerpPoint","CreateVectorEasingFunction","moveEasing","_isDoneShaking","newCanvasWidth","newCanvasHeight","cameraPos","isScreenElement","triggerDefaults","Trigger_Trigger","opts","_dispatchAction","_target","wp","SystemType","System","_entityAddedOrRemoved","AddedEntity","isAddedSystemEntity","RemovedEntity","isRemoveSystemEntity","EntityManager","_world","entities","_entityIndex","_entitiesToRemove","updateEntities","removeEntity","findEntitiesForRemoval","queryManager","addEntity","idOrEntity","deferred","actors","killed","processEntityRemovals","processComponentRemovals","getById","getByName","buildTypeKey","localeCompare","Query","_entities","T","_key","getEntities","matches","typesOrEntity","contain","QueryManager","_queries","_addQuery","entityManager","maybeRemoveQuery","queryType","createQuery","maybeExistingQuery","getQuery","SystemManager","systems","initialized","systemType","find","addSystem","system","removeSystem","updateSystems","preupdate","Scene","postupdate","systemManager","Update","entityOrSystem","clearEntities","clearSystems","EulerIntegrator","totalAcc","MotionSystem","optionalBody","integrate","CollisionSolver","solve","preSolve","solveVelocity","solvePosition","postSolve","ArcadeSolver","opposite","velAdj","ContactConstraintPoint","normalImpulse","tangentImpulse","normalMass","tangentMass","aToContact","bToContact","aToContactNormal","bToContactNormal","aToContactTangent","bToContactTangent","getRelativeVelocity","velA","RealisticSolver","lastFrameContacts","idToContactConstraint","getContactConstraints","finishedContactIds","contactPoints","pointIndex","constraints","maxCorrection","steeringForce","restitution","impulseDelta","maxFriction","newImpulse","CollisionSystem","_realisticSolver","_arcadeSolver","_processor","_lastFrameContacts","_currentFrameContacts","_trackCollider","_untrackCollider","colliderComponent","colliderComp","getSolver","runContactStartEnd","AnimationDirection","AnimationStrategy","EmitterType","Animation","Loop","frameDuration","timeScale","_firstTick","_currentFrame","_done","_playing","_reversed","totalDuration","goToFrame","maybeFrame","frameIndices","durationPerFrameMs","invalidIndices","_LOGGER","animation","legacySprites","Freeze","currentFrameIndex","isPlaying","Backward","Forward","canFinish","done","frameNumber","_nextFrame","PingPong","elapsedMilliseconds","GraphicsGroup","members","_updateDimensions","_isAnimationOrGroup","member","maybeAnimation","ParticleImpl","emitterOrConfig","life","beginColor","endColor","velocity","acceleration","startSize","endSize","particleRotationalVelocity","currentRotation","focusAccel","fadeFlag","_rRate","_gRate","_bRate","_aRate","emitter","particleSize","particleSprite","sizeRate","elapsedMultiplier","ParticleEmitter","tmpColor","removeParticle","accel","Particle","_particlesToEmit","numParticles","isEmitting","particles","deadParticles","minVel","maxVel","minAngle","maxAngle","emitRate","particleLife","minSize","maxSize","_og","emitterType","randomRotation","particle","emitParticles","particleCount","_createParticle","world","clearParticles","ranX","ranY","GraphicsSystem","Draw","_graphicsContext","entityOffscreen","_isOffscreen","_pushCameraTransform","_applyTransform","particleOpacity","_drawGraphicsComponent","_popCameraTransform","graphicsComponent","isDebug","showBounds","boundsColor","ancestors","ancestor","CanvasDrawingSystem","canvasdraw","_clearScreen","offscreen","drawnImages","drawCalls","DebugSystem","_collisionSystem","filterSettings","entitySettings","txSettings","motionSettings","colliderSettings","physicsSettings","graphicsSettings","bodySettings","cameraSettings","useFilter","ids","nameQuery","cursor","showAll","showPosition","positionColor","showPositionLabel","showId","showName","showRotation","fromAngle","rotationColor","showScale","scaleColor","showCollisionGroup","showCollisionType","showMass","showMotion","showSleeping","showVelocity","velocityColor","showAcceleration","accelerationColor","showGeometry","geometryColor","showOwner","showBroadphaseSpacePartitionDebug","showCollisionContacts","showCollisionNormals","collisionContactColor","collisionNormalColor","showFocus","focusColor","showZoom","PointerSystem","overrideUseColliderShape","overrideUseGraphicsBounds","lastFrameEntityToPointers","currentFrameEntityToPointers","_receiver","pointers","entityCurrentlyUnderPointer","pointerId","entityWasUnderPointer","entered","addPointerToEntity","_processPointerToEntity","_dispatchEvents","currentFramePointerCoords","screenPos","graphicBounds","_processDownAndEmit","lastDownPerPointer","currentFrameDown","isDragStart","_processUpAndEmit","lastUpPerPointer","currentFrameUp","isDragEnd","_processMoveAndEmit","lastMovePerPointer","currentFrameMove","isDragging","_processEnterLeaveAndEmit","lastUpDownMoveEvents","_processCancelAndEmit","currentFrameCancel","_processWheelAndEmit","currentFrameWheel","lastFrameEntities","currentFrameEntities","entitiesWithEvents","ActionsSystem","ColorBlindnessMode","PointerScope","Keys","Buttons","Axes","WheelDeltaMode","NativePointerButton","PointerButton","PointerType","Scene_decorate","_timers","_cancelQueue","triggers","tileMaps","screenElements","timers","onActivate","_oldScene","_newScene","onDeactivate","_initializeChildren","_activate","_deactivate","removeTimer","timer","_collectActorStats","addTimer","addScreenElement","removeScreenElement","addTileMap","tileMap","removeTileMap","isTimerActive","isCurrentScene","_ui","ui","alive","ScreenShader","ColorBlindnessPostProcessor","_colorBlindnessMode","simulate","_simulate","colorBlindnessMode","colorBlindMode","Protanope","Deuteranope","Tritanope","ColorBlindFlags","_colorBlindPostProcessor","correct","colorBlindness","FrameStats","prevFrame","useTestClock","wasRunning","testClock","toTestClock","useStandardClock","currentClock","standardClock","toStandardClock","_id","_fps","_actorStats","remaining","total","_durationStats","_physicsStats","PhysicsStats","_graphicsStats","otherStats","fps","fs","_collisions","_contacts","_fastBodies","_fastBodyCollisions","_broadphase","_narrowphase","ps","KeyEvent","originalEvent","Keyboard","_keys","_keysUp","_keysDown","init","noop","keyEvent","getKeys","wasPressed","isHeld","wasReleased","Gamepads","_gamePadTimeStamps","_oldPads","_pads","_initSuccess","_navigator","_minimumConfiguration","_clonePads","setMinimumGamepadConfiguration","_enableAndUpdate","_isGamepadValid","pad","axesLength","buttonLength","buttons","connected","gamepads","at","timestamp","bi","ai","navigatorGamepad","getButton","pressed","updateButton","getAxes","updateAxes","_clonePad","Gamepad","getValidGamepads","pads","arr","clonedPad","MinAxisMoveThreshold","_buttons","isButtonPressed","buttonIndex","axesIndex","BrowserComponent","_paused","_nativeHandlers","_decorate","BrowserEvents","_windowGlobal","_documentGlobal","_windowComponent","_documentComponent","ExcaliburGraphicsContext2DCanvasDebug","ExcaliburGraphicsContext2DCanvas","setTransform","_postprocessor","GlobalCoordinates","pagePos","yOrEngine","engineOrUndefined","pageX","pageY","PointerEvent","pointerType","coordinates","nativeEvent","WheelEvent","screenX","screenY","deltaX","deltaY","deltaZ","deltaMode","PointerAbstraction","lastPagePos","lastScreenPos","lastWorldPos","_onPointerMove","_onPointerDown","PointerEventReceiver","primary","_activeNativePointerIdsToNormalized","lastFramePointerCoords","currentFramePointerDown","lastFramePointerDown","_pointers","_boundHandle","_handle","_boundWheel","_handleWheel","isDown","wasDown","native","touchAction","wheelOptions","passive","pageScrollPreventionMode","ScrollPreventionMode","onmousewheel","detach","_normalizePointerId","nativePointerId","findIndex","preventDefault","eventCoords","TouchEvent","Unknown","Touch","changedTouches","touch","fromPagePosition","_nativeButtonToPointerButton","Mouse","isPointerEvent","_stringToPointerType","ScrollWheelNormalizationFactor","wheelDeltaX","wheelDeltaY","wheelDelta","detail","Page","we","triggerEvent","page","clientX","clientY","MouseEvent","pointerSystem","transformEntities","NoButton","Pen","FpsSampler","_samplePeriod","_currentFrameTime","_frames","_previousSampleTime","_beginFrameTime","initialFps","samplePeriod","_nowFn","nowFn","instant","Clock","_onFatalException","_maxFps","_lastTime","_elapsed","_scheduledCbs","_totalElapsed","maxFps","onFatalException","fpsSampler","TestClock","defaultUpdateMs","StandardClock","setFatalExceptionHandler","timeoutMs","scheduledTime","_runScheduledCbs","overrideUpdateMs","fpsInterval","leftover","mainloop","_requestId","_currentTime","_updateMs","step","run","numberOfSteps","Engine_decorate","_hasStarted","scenes","_animations","_suppressPlayButton","pauseAudioWhenHidden","_isDebug","debugColor","enableCanvasTransparency","_timescale","_deferredGoTo","_loadingComplete","_isReady","_isReadyPromise","_isReadyResolve","_DEFAULT_ENGINE_OPTIONS","freeze","detector","suppressMinimumBrowserFeatureDetection","_compatible","innerText","testMessage","canvasElementId","suppressConsoleBootMessage","EX_VERSION","ex2dCtx","exWebglCtx","suppressHiDPIScaling","_mainloop","_loader","rootScene","addScene","___EXCALIBUR_DEVTOOL","isFullscreen","shouldSnapToPixel","timescale","AnimationNode","removeScene","goToScene","scrollPreventionMode","pointerTarget","pointerScope","Document","hidden","visibilityChange","keyboard","_overrideInitialize","_update","_draw","toggle","toggleDebug","isReady","loader","frameId","beforeUpdate","afterUpdate","afterDraw","game","raf","lastTime","isPaused","screenshot","raw","MediaEvent","_value","_path","_val","propagate","layPath","_actor","NativeSoundEvent","NativeSoundProcessedEvent","_processedData","Label_decorate","Label_Label","newFont","isBold","fontFamily","sizeInUnit","fontStyle","fontUnit","align","_legacySpriteFont","sf","fromLegacySpriteFont","getTextWidth","clearTextShadow","exctx","CollisionGroupManager","_CURRENT_GROUP","_MAX_GROUPS","_GROUPS","_CURRENT_BIT","groups","_STARTING_BIT","filled","_points","fillColor","lineColor","Polygon_decorate","ExResponse","has_initialize","hasOnInitialize","has_preupdate","hasOnPreUpdate","has_postupdate","hasOnPostUpdate","hasPreDraw","hasPostDraw","any","json","WebAudioInstance","_volume","_loop","_isPlaying","_isPaused","_audioContext","_volumeNode","createGain","_currentOffset","_createNewBufferSource","_instance","_wireUpOnEnded","volume","gain","setTargetAtTime","_playbackRate","playbackRate","playStarted","_resumePlayBack","_startPlayBack","_playingPromise","_setPauseOffset","_handleOnEnded","_playingResolve","_rememberStartTime","restartTime","amend","_startTime","getTime","setValueAtTime","canPlayFile","file","Audio","filetype","canPlayType","Sound","paths","_isStopped","_tracks","_wasPlayingOnHidden","instances","audiobuffer","decodeAudio","instanceCount","_resumePlayback","_startPlayback","getTrackId","resumed","_getTrackInstance","newTrack","Gif","_stream","_gif","_animation","_transparentColor","Stream","ParseGif","toLegacySpriteSheet","toSpriteSheet","toLegacyAnimation","toAnimation","fromSpriteSheet","readCheckBytes","checkBytes","bitsToNum","ba","byteToBitArr","bite","dataArray","readByte","byteLength","readBytes","bytes","read","readUnsigned","Uint8Array","stream","_st","_handler","globalColorTable","parseColorTable","ct","readSubBlocks","parseHeader","hdr","sig","ver","colorRes","globalColorTableSize","gctFlag","sorted","bgColor","pixelAspectRatio","bits","parseExt","block","parseGCExt","reserved","disposalMethod","userInput","transparencyGiven","delayTime","transparencyIndex","terminator","gce","parseComExt","comment","com","parsePTExt","ptHeader","ptData","pte","parseAppExt","identifier","authCode","unknown","iterations","app","NETSCAPE","parseNetscapeExt","appData","parseUnknownAppExt","parseUnknownExt","label","extType","parseImg","img","leftPos","topPos","lctFlag","interlaced","lctSize","lct","lzwMinCodeSize","lzwData","pixels","minCodeSize","readCode","charCodeAt","output","clearCode","eoiCode","codeSize","dict","last","lzwDecode","newPixels","cpRow","toRow","fromRow","fromPixels","offsets","steps","pass","deinterlace","arrayToImage","parseBlock","sentinel","eof","frame","Polygon_Polygon","SortedList_decorate","SortedList","getComparable","_getComparable","_find","_root","getKey","getData","getLeft","getRight","_get","BinaryTreeNode","setLeft","setRight","removeByComparable","elementIndex","_findMinNode","setKey","setData","_cleanup","comparable","_list","treeNode","_data","_left","_right","MockedElement","getTheKey","Pool","builder","recycler","maxObjects","totalAllocations","objects","using","borrow","poolIndex","Promise_1","PromiseState","Promises_Promise","Pending","_successCallbacks","_rejectCallback","promises","isArray","_i","joinedPromise","successes","rejects","errors","successCallback","rejectCallback","Resolved","_handleError","Rejected","errorCallback","_errorCallback","Promises_decorate","__webpack_exports__ActionContext","fWn","__webpack_exports__ActionQueue","Ia8","__webpack_exports__ActionsComponent","hLI","__webpack_exports__ActionsSystem","yyv","__webpack_exports__ActivateEvent","tX5","__webpack_exports__Actor","vtX","__webpack_exports__AddedComponent","r7K","__webpack_exports__AddedEntity","lCh","__webpack_exports__Animation","fwF","__webpack_exports__AnimationDirection","sce","__webpack_exports__AnimationStrategy","_c7","__webpack_exports__ArcadeSolver","KUs","__webpack_exports__AudioContextFactory","Ajp","__webpack_exports__Axis","RDh","__webpack_exports__BaseAlign","_H9","__webpack_exports__BinaryTreeNode","Ulf","__webpack_exports__Blink","mxs","__webpack_exports__BodyComponent","OmD","__webpack_exports__BoundingBox","kBf","__webpack_exports__BroadphaseStrategy","C4F","__webpack_exports__BrowserComponent","NQt","__webpack_exports__BrowserEvents","JjN","__webpack_exports__Camera","V1s","__webpack_exports__Canvas","Xz7","__webpack_exports__Cell","bLd","__webpack_exports__Circle","Cdc","__webpack_exports__CircleCollider","FKn","__webpack_exports__Class","wTW","__webpack_exports__Clock","SUY","__webpack_exports__ClosestLine","ab2","__webpack_exports__ClosestLineJumpTable","GfZ","__webpack_exports__Collider","YMS","__webpack_exports__ColliderComponent","oyv","__webpack_exports__CollisionContact","aUb","__webpack_exports__CollisionEndEvent","SdD","__webpack_exports__CollisionGroup","JUv","__webpack_exports__CollisionGroupManager","jEj","__webpack_exports__CollisionJumpTable","TFq","__webpack_exports__CollisionPostSolveEvent","HDU","__webpack_exports__CollisionPreSolveEvent","R_y","__webpack_exports__CollisionResolutionStrategy","ydN","__webpack_exports__CollisionSolver","_N2","__webpack_exports__CollisionStartEvent","t50","__webpack_exports__CollisionSystem","s$$","__webpack_exports__CollisionType","v2G","__webpack_exports__Color","Ilk","__webpack_exports__ColorBlindFlags","s9i","__webpack_exports__ColorBlindnessMode","dxL","__webpack_exports__ColorBlindnessPostProcessor","LLX","__webpack_exports__Component","wA2","__webpack_exports__CompositeCollider","R_p","__webpack_exports__Configurable","IQ$","__webpack_exports__ConsoleAppender","I5F","__webpack_exports__ContactConstraintPoint","X8$","__webpack_exports__ContactEndEvent","FR6","__webpack_exports__ContactStartEvent","U8o","__webpack_exports__CoordPlane","kbG","__webpack_exports__CullingBox","oeJ","__webpack_exports__DeactivateEvent","iS_","__webpack_exports__Debug","cGG","__webpack_exports__DebugGraphicsComponent","RPN","__webpack_exports__DebugSystem","skb","__webpack_exports__DebugText","SLU","__webpack_exports__DegreeOfFreedom","RdJ","__webpack_exports__Detector","gU7","__webpack_exports__Die","LSk","__webpack_exports__Direction","Nmp","__webpack_exports__DisplayMode","d1Y","__webpack_exports__DynamicTree","xrL","__webpack_exports__DynamicTreeCollisionProcessor","sRW","__webpack_exports__EX_VERSION","cmV","__webpack_exports__EaseTo","N0Q","__webpack_exports__EasingFunctions","q8b","__webpack_exports__EdgeCollider","ynB","__webpack_exports__ElasticToActorStrategy","jT9","__webpack_exports__EmitterType","wAz","__webpack_exports__Engine","D4V","__webpack_exports__EnterTriggerEvent","N6H","__webpack_exports__EnterViewPortEvent","W1A","__webpack_exports__Entity","JHW","__webpack_exports__EntityManager","v2K","__webpack_exports__EventDispatcher","pBf","__webpack_exports__EventTypes","GMl","__webpack_exports__Events","zW2","__webpack_exports__ExResponse","B0K","__webpack_exports__ExcaliburGraphicsContext2DCanvas","Nv7","__webpack_exports__ExcaliburGraphicsContextWebGL","C_p","__webpack_exports__ExcaliburWebGLContextAccessor","iqw","__webpack_exports__ExitTriggerEvent","MUA","__webpack_exports__ExitViewPortEvent","xqU","__webpack_exports__Experiments","peG","__webpack_exports__Fade","pTp","__webpack_exports__Flags","vUK","__webpack_exports__Follow","j9l","__webpack_exports__Font","Zxw","__webpack_exports__FontStyle","Hdx","__webpack_exports__FontUnit","Z$d","__webpack_exports__FpsSampler","iqV","__webpack_exports__FrameStats","o$7","__webpack_exports__GameEvent","Zm$","__webpack_exports__GameStartEvent","$QH","__webpack_exports__GameStopEvent","i78","__webpack_exports__GamepadAxisEvent","h6u","__webpack_exports__GamepadButtonEvent","hts","__webpack_exports__GamepadConnectEvent","j88","__webpack_exports__GamepadDisconnectEvent","VME","__webpack_exports__Gif","nt","__webpack_exports__GlobalCoordinates","Ukr","__webpack_exports__Graphic","zsu","__webpack_exports__GraphicsComponent","oA6","__webpack_exports__GraphicsGroup","TVh","__webpack_exports__GraphicsLayer","TwZ","__webpack_exports__GraphicsLayers","GTT","__webpack_exports__GraphicsSystem","xxj","__webpack_exports__HiddenEvent","XdK","__webpack_exports__ImageFiltering","Jmb","__webpack_exports__ImageSource","cXo","__webpack_exports__InitializeEvent","Dm5","__webpack_exports__Input","IIB","__webpack_exports__Integrator","zI0","__webpack_exports__KillEvent","SKZ","__webpack_exports__Label","__J","__webpack_exports__Legacy","Dvr","__webpack_exports__LegacyDrawing","Tf9","__webpack_exports__LimitCameraBoundsStrategy","RI$","__webpack_exports__Line","x12","__webpack_exports__Loader","aNw","__webpack_exports__LockCameraToActorAxisStrategy","xwn","__webpack_exports__LockCameraToActorStrategy","dNK","__webpack_exports__LogLevel","ini","__webpack_exports__Logger","YdH","__webpack_exports__Matrix","y3G","__webpack_exports__MatrixLocations","l57","__webpack_exports__MediaEvent","xn0","__webpack_exports__Meet","t2V","__webpack_exports__MockedElement","ZyS","__webpack_exports__MotionComponent","uxB","__webpack_exports__MotionSystem","cpd","__webpack_exports__MoveBy","fiy","__webpack_exports__MoveTo","$XZ","__webpack_exports__NativeSoundEvent","uqK","__webpack_exports__NativeSoundProcessedEvent","STE","__webpack_exports__Observable","y$z","__webpack_exports__Pair","sOq","__webpack_exports__ParseGif","Sqs","__webpack_exports__Particle","hpZ","__webpack_exports__ParticleEmitter","Vol","__webpack_exports__Physics","wIZ","__webpack_exports__PhysicsStats","cBi","__webpack_exports__PointerComponent","RFv","__webpack_exports__PointerSystem","kfC","__webpack_exports__Polygon","mgq","__webpack_exports__PolygonCollider","YVA","__webpack_exports__Pool","Kgp","__webpack_exports__PostCollisionEvent","HH$","__webpack_exports__PostDebugDrawEvent","M_d","__webpack_exports__PostDrawEvent","rgh","__webpack_exports__PostFrameEvent","Ra6","__webpack_exports__PostKillEvent","KhR","__webpack_exports__PostUpdateEvent","BS5","__webpack_exports__PreCollisionEvent","xhz","__webpack_exports__PreDebugDrawEvent","xOq","__webpack_exports__PreDrawEvent","a9j","__webpack_exports__PreFrameEvent","bHk","__webpack_exports__PreKillEvent","CgK","__webpack_exports__PreUpdateEvent","cuY","__webpack_exports__Projection","kvE","__webpack_exports__Promise","JDb","__webpack_exports__PromiseState","Cbi","__webpack_exports__QuadIndexBuffer","SBu","__webpack_exports__Query","AE_","__webpack_exports__QueryManager","ctO","__webpack_exports__RadiusAroundActorStrategy","OLH","__webpack_exports__Random","kky","__webpack_exports__Raster","nSF","__webpack_exports__Ray","zHn","__webpack_exports__RealisticSolver","zwx","__webpack_exports__Rectangle","AeJ","__webpack_exports__RemovedComponent","hLz","__webpack_exports__RemovedEntity","D9g","__webpack_exports__Repeat","wA","__webpack_exports__RepeatForever","jhr","__webpack_exports__Resolution","GVs","__webpack_exports__Resource","_zO","__webpack_exports__RotateBy","w6$","__webpack_exports__RotateTo","mhV","__webpack_exports__RotationType","MOD","__webpack_exports__ScaleBy","kwd","__webpack_exports__ScaleTo","Lmr","__webpack_exports__Scene","xsS","__webpack_exports__Screen","lLr","__webpack_exports__ScreenAppender","Z$r","__webpack_exports__ScreenElement","IXb","__webpack_exports__ScreenShader","SGH","__webpack_exports__ScrollPreventionMode","SMj","__webpack_exports__Shader","exe","__webpack_exports__Shape","bnF","__webpack_exports__Side","MFA","__webpack_exports__SortedList","$XC","__webpack_exports__Sound","$uU","__webpack_exports__Sprite","jyi","__webpack_exports__SpriteFont","E03","__webpack_exports__SpriteSheet","V6q","__webpack_exports__StandardClock","rg2","__webpack_exports__StrategyContainer","nVo","__webpack_exports__Stream","F6N","__webpack_exports__SubscribeEvent","ad3","__webpack_exports__System","xP7","__webpack_exports__SystemManager","Odq","__webpack_exports__SystemType","Zif","__webpack_exports__TagComponent","ZGJ","__webpack_exports__TestClock","MJk","__webpack_exports__Text","xvT","__webpack_exports__TextAlign","PHM","__webpack_exports__TextureLoader","dpR","__webpack_exports__TileMap","KwO","__webpack_exports__Timer","B7y","__webpack_exports__Traits","SFp","__webpack_exports__TransformComponent","Uvn","__webpack_exports__TreeNode","OFT","__webpack_exports__Trigger","xzN","__webpack_exports__TwoPI","M5Z","__webpack_exports__UnsubscribeEvent","H6j","__webpack_exports__Util","ZrN","__webpack_exports__Vector","OWs","__webpack_exports__VectorView","dF9","__webpack_exports__VertexBuffer","oZy","__webpack_exports__VertexLayout","rD2","__webpack_exports__VisibleEvent","VHo","__webpack_exports__WebAudio","ohE","__webpack_exports__WebAudioInstance","R$E","__webpack_exports__World","q3I","__webpack_exports__canonicalizeAngle","Pab","__webpack_exports__clamp","uZ5","__webpack_exports__createId","McK","__webpack_exports__frac","F9c","__webpack_exports__hasGraphicsTick","k0b","__webpack_exports__hasOnInitialize","hnT","__webpack_exports__hasOnPostUpdate","RSJ","__webpack_exports__hasOnPreUpdate","Mku","__webpack_exports__hasPostDraw","h90","__webpack_exports__hasPreDraw","rms","__webpack_exports__has_initialize","ErP","__webpack_exports__has_postupdate","aVg","__webpack_exports__has_preupdate","lPc","__webpack_exports__isAddedComponent","Z8E","__webpack_exports__isAddedSystemEntity","NNA","__webpack_exports__isRemoveSystemEntity","yFn","__webpack_exports__isRemovedComponent","lNv","__webpack_exports__maxMessages","MZQ","__webpack_exports__obsolete","FUM","__webpack_exports__randomInRange","vdf","__webpack_exports__randomIntInRange","iaL","__webpack_exports__range","w6H","__webpack_exports__resetObsoleteCounter","Q4c","__webpack_exports__sign","Xxe","__webpack_exports__toDegrees","Uxb","__webpack_exports__toRadians","Yr5","__webpack_exports__vec","Bhw","__webpack_exports__webgl","yOA","Baddie","groupByName","baddieSpriteSheet","__TESTING","onPostCollision","Bot","Resources","gotEm","onGround","jumped","hurt","hurtTime","hurtleft","botSpriteSheet","hurtright","idle","hit","Input","jump","Floor","blockSprite","Level","baddie","baddie2","npc","NPC","otherFloor","botRedSpriteSheet","npcSprite","botFile","botRedFile","baddieFile","blockFile","npcFile","jumpSound","hitSound","gotEmSound","bot","botRed","__webpack_require__","scriptUrl","importScripts","currentScript","scripts","getElementsByTagName"],"sourceRoot":""}