{"version":3,"file":"main.js","mappings":"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,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,EACb,IAAO,IAAM,EACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,GAAM,IAAM,GACZ,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,EACb,IAAO,IAAM,EACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,GAAM,IAAM,GACZ,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb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","sources":["webpack://sample-platformer/./node_modules/excalibur/build/esm/excalibur.js","webpack://sample-platformer/./res/baddie.png","webpack://sample-platformer/./res/block.png","webpack://sample-platformer/./res/excalibot-red.png","webpack://sample-platformer/./res/excalibot.png","webpack://sample-platformer/./res/gottem.wav","webpack://sample-platformer/./res/hurt.wav","webpack://sample-platformer/./res/jump.wav","webpack://sample-platformer/./res/npc.png","webpack://sample-platformer/./src/baddie.ts","webpack://sample-platformer/./src/bot.ts","webpack://sample-platformer/./src/floor.ts","webpack://sample-platformer/./src/level.ts","webpack://sample-platformer/./src/main.ts","webpack://sample-platformer/./src/npc.ts","webpack://sample-platformer/./src/resources.ts","webpack://sample-platformer/webpack/bootstrap","webpack://sample-platformer/webpack/runtime/define property getters","webpack://sample-platformer/webpack/runtime/global","webpack://sample-platformer/webpack/runtime/hasOwnProperty shorthand","webpack://sample-platformer/webpack/runtime/make namespace object","webpack://sample-platformer/webpack/runtime/publicPath","webpack://sample-platformer/webpack/startup"],"sourcesContent":["/*!\n * excalibur - 0.27.0 - 2022-7-8\n * https://github.com/excaliburjs/Excalibur\n * Copyright (c) 2022 Excalibur.js <https://github.com/excaliburjs/Excalibur/graphs/contributors>\n * Licensed BSD-2-Clause\n * @preserve\n */\n/******/ var __webpack_modules__ = ({\n\n/***/ 4662:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n__webpack_require__(3430);\nvar entryUnbind = __webpack_require__(8791);\n\nmodule.exports = entryUnbind('Array', 'sort');\n\n\n/***/ }),\n\n/***/ 8343:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n__webpack_require__(4769);\nvar path = __webpack_require__(9276);\n\nmodule.exports = path.Object.keys;\n\n\n/***/ }),\n\n/***/ 7111:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar isCallable = __webpack_require__(6733);\nvar tryToString = __webpack_require__(9821);\n\nvar $TypeError = TypeError;\n\n// `Assert: IsCallable(argument) is true`\nmodule.exports = function (argument) {\n  if (isCallable(argument)) return argument;\n  throw $TypeError(tryToString(argument) + ' is not a function');\n};\n\n\n/***/ }),\n\n/***/ 1176:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar isObject = __webpack_require__(5052);\n\nvar $String = String;\nvar $TypeError = TypeError;\n\n// `Assert: Type(argument) is Object`\nmodule.exports = function (argument) {\n  if (isObject(argument)) return argument;\n  throw $TypeError($String(argument) + ' is not an object');\n};\n\n\n/***/ }),\n\n/***/ 9540:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar toIndexedObject = __webpack_require__(905);\nvar toAbsoluteIndex = __webpack_require__(3231);\nvar lengthOfArrayLike = __webpack_require__(9646);\n\n// `Array.prototype.{ indexOf, includes }` methods implementation\nvar createMethod = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIndexedObject($this);\n    var length = lengthOfArrayLike(O);\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare -- NaN check\n    if (IS_INCLUDES && el != el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare -- NaN check\n      if (value != value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) {\n      if ((IS_INCLUDES || index in O) && O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.includes` method\n  // https://tc39.es/ecma262/#sec-array.prototype.includes\n  includes: createMethod(true),\n  // `Array.prototype.indexOf` method\n  // https://tc39.es/ecma262/#sec-array.prototype.indexof\n  indexOf: createMethod(false)\n};\n\n\n/***/ }),\n\n/***/ 6038:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar fails = __webpack_require__(4229);\n\nmodule.exports = function (METHOD_NAME, argument) {\n  var method = [][METHOD_NAME];\n  return !!method && fails(function () {\n    // eslint-disable-next-line no-useless-call -- required for testing\n    method.call(null, argument || function () { return 1; }, 1);\n  });\n};\n\n\n/***/ }),\n\n/***/ 9794:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar toAbsoluteIndex = __webpack_require__(3231);\nvar lengthOfArrayLike = __webpack_require__(9646);\nvar createProperty = __webpack_require__(2324);\n\nvar $Array = Array;\nvar max = Math.max;\n\nmodule.exports = function (O, start, end) {\n  var length = lengthOfArrayLike(O);\n  var k = toAbsoluteIndex(start, length);\n  var fin = toAbsoluteIndex(end === undefined ? length : end, length);\n  var result = $Array(max(fin - k, 0));\n  for (var n = 0; k < fin; k++, n++) createProperty(result, n, O[k]);\n  result.length = n;\n  return result;\n};\n\n\n/***/ }),\n\n/***/ 3867:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar arraySlice = __webpack_require__(9794);\n\nvar floor = Math.floor;\n\nvar mergeSort = function (array, comparefn) {\n  var length = array.length;\n  var middle = floor(length / 2);\n  return length < 8 ? insertionSort(array, comparefn) : merge(\n    array,\n    mergeSort(arraySlice(array, 0, middle), comparefn),\n    mergeSort(arraySlice(array, middle), comparefn),\n    comparefn\n  );\n};\n\nvar insertionSort = function (array, comparefn) {\n  var length = array.length;\n  var i = 1;\n  var element, j;\n\n  while (i < length) {\n    j = i;\n    element = array[i];\n    while (j && comparefn(array[j - 1], element) > 0) {\n      array[j] = array[--j];\n    }\n    if (j !== i++) array[j] = element;\n  } return array;\n};\n\nvar merge = function (array, left, right, comparefn) {\n  var llength = left.length;\n  var rlength = right.length;\n  var lindex = 0;\n  var rindex = 0;\n\n  while (lindex < llength || rindex < rlength) {\n    array[lindex + rindex] = (lindex < llength && rindex < rlength)\n      ? comparefn(left[lindex], right[rindex]) <= 0 ? left[lindex++] : right[rindex++]\n      : lindex < llength ? left[lindex++] : right[rindex++];\n  } return array;\n};\n\nmodule.exports = mergeSort;\n\n\n/***/ }),\n\n/***/ 7079:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar uncurryThis = __webpack_require__(5968);\n\nvar toString = uncurryThis({}.toString);\nvar stringSlice = uncurryThis(''.slice);\n\nmodule.exports = function (it) {\n  return stringSlice(toString(it), 8, -1);\n};\n\n\n/***/ }),\n\n/***/ 1589:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar TO_STRING_TAG_SUPPORT = __webpack_require__(1601);\nvar isCallable = __webpack_require__(6733);\nvar classofRaw = __webpack_require__(7079);\nvar wellKnownSymbol = __webpack_require__(95);\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar $Object = Object;\n\n// ES3 wrong here\nvar CORRECT_ARGUMENTS = classofRaw(function () { return arguments; }()) == 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (error) { /* empty */ }\n};\n\n// getting tag from ES6+ `Object.prototype.toString`\nmodule.exports = TO_STRING_TAG_SUPPORT ? classofRaw : function (it) {\n  var O, tag, result;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (tag = tryGet(O = $Object(it), TO_STRING_TAG)) == 'string' ? tag\n    // builtinTag case\n    : CORRECT_ARGUMENTS ? classofRaw(O)\n    // ES3 arguments fallback\n    : (result = classofRaw(O)) == 'Object' && isCallable(O.callee) ? 'Arguments' : result;\n};\n\n\n/***/ }),\n\n/***/ 7081:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar hasOwn = __webpack_require__(8270);\nvar ownKeys = __webpack_require__(4826);\nvar getOwnPropertyDescriptorModule = __webpack_require__(7933);\nvar definePropertyModule = __webpack_require__(1787);\n\nmodule.exports = function (target, source, exceptions) {\n  var keys = ownKeys(source);\n  var defineProperty = definePropertyModule.f;\n  var getOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    if (!hasOwn(target, key) && !(exceptions && hasOwn(exceptions, key))) {\n      defineProperty(target, key, getOwnPropertyDescriptor(source, key));\n    }\n  }\n};\n\n\n/***/ }),\n\n/***/ 5762:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar DESCRIPTORS = __webpack_require__(7400);\nvar definePropertyModule = __webpack_require__(1787);\nvar createPropertyDescriptor = __webpack_require__(5358);\n\nmodule.exports = DESCRIPTORS ? function (object, key, value) {\n  return definePropertyModule.f(object, key, createPropertyDescriptor(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n\n\n/***/ }),\n\n/***/ 5358:\n/***/ ((module) => {\n\nmodule.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n\n\n/***/ }),\n\n/***/ 2324:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar toPropertyKey = __webpack_require__(9310);\nvar definePropertyModule = __webpack_require__(1787);\nvar createPropertyDescriptor = __webpack_require__(5358);\n\nmodule.exports = function (object, key, value) {\n  var propertyKey = toPropertyKey(key);\n  if (propertyKey in object) definePropertyModule.f(object, propertyKey, createPropertyDescriptor(0, value));\n  else object[propertyKey] = value;\n};\n\n\n/***/ }),\n\n/***/ 4768:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar isCallable = __webpack_require__(6733);\nvar definePropertyModule = __webpack_require__(1787);\nvar makeBuiltIn = __webpack_require__(6039);\nvar defineGlobalProperty = __webpack_require__(8400);\n\nmodule.exports = function (O, key, value, options) {\n  if (!options) options = {};\n  var simple = options.enumerable;\n  var name = options.name !== undefined ? options.name : key;\n  if (isCallable(value)) makeBuiltIn(value, name, options);\n  if (options.global) {\n    if (simple) O[key] = value;\n    else defineGlobalProperty(key, value);\n  } else {\n    try {\n      if (!options.unsafe) delete O[key];\n      else if (O[key]) simple = true;\n    } catch (error) { /* empty */ }\n    if (simple) O[key] = value;\n    else definePropertyModule.f(O, key, {\n      value: value,\n      enumerable: false,\n      configurable: !options.nonConfigurable,\n      writable: !options.nonWritable\n    });\n  } return O;\n};\n\n\n/***/ }),\n\n/***/ 8400:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\n\n// eslint-disable-next-line es-x/no-object-defineproperty -- safe\nvar defineProperty = Object.defineProperty;\n\nmodule.exports = function (key, value) {\n  try {\n    defineProperty(global, key, { value: value, configurable: true, writable: true });\n  } catch (error) {\n    global[key] = value;\n  } return value;\n};\n\n\n/***/ }),\n\n/***/ 9563:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar tryToString = __webpack_require__(9821);\n\nvar $TypeError = TypeError;\n\nmodule.exports = function (O, P) {\n  if (!delete O[P]) throw $TypeError('Cannot delete property ' + tryToString(P) + ' of ' + tryToString(O));\n};\n\n\n/***/ }),\n\n/***/ 7400:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar fails = __webpack_require__(4229);\n\n// Detect IE8's incomplete defineProperty implementation\nmodule.exports = !fails(function () {\n  // eslint-disable-next-line es-x/no-object-defineproperty -- required for testing\n  return Object.defineProperty({}, 1, { get: function () { return 7; } })[1] != 7;\n});\n\n\n/***/ }),\n\n/***/ 2635:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar isObject = __webpack_require__(5052);\n\nvar document = global.document;\n// typeof document.createElement is 'object' in old IE\nvar EXISTS = isObject(document) && isObject(document.createElement);\n\nmodule.exports = function (it) {\n  return EXISTS ? document.createElement(it) : {};\n};\n\n\n/***/ }),\n\n/***/ 2671:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar userAgent = __webpack_require__(598);\n\nvar firefox = userAgent.match(/firefox\\/(\\d+)/i);\n\nmodule.exports = !!firefox && +firefox[1];\n\n\n/***/ }),\n\n/***/ 8506:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar UA = __webpack_require__(598);\n\nmodule.exports = /MSIE|Trident/.test(UA);\n\n\n/***/ }),\n\n/***/ 598:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar getBuiltIn = __webpack_require__(1333);\n\nmodule.exports = getBuiltIn('navigator', 'userAgent') || '';\n\n\n/***/ }),\n\n/***/ 6358:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar userAgent = __webpack_require__(598);\n\nvar process = global.process;\nvar Deno = global.Deno;\nvar versions = process && process.versions || Deno && Deno.version;\nvar v8 = versions && versions.v8;\nvar match, version;\n\nif (v8) {\n  match = v8.split('.');\n  // in old Chrome, versions of V8 isn't V8 = Chrome / 10\n  // but their correct versions are not interesting for us\n  version = match[0] > 0 && match[0] < 4 ? 1 : +(match[0] + match[1]);\n}\n\n// BrowserFS NodeJS `process` polyfill incorrectly set `.v8` to `0.0`\n// so check `userAgent` even if `.v8` exists, but 0\nif (!version && userAgent) {\n  match = userAgent.match(/Edge\\/(\\d+)/);\n  if (!match || match[1] >= 74) {\n    match = userAgent.match(/Chrome\\/(\\d+)/);\n    if (match) version = +match[1];\n  }\n}\n\nmodule.exports = version;\n\n\n/***/ }),\n\n/***/ 9811:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar userAgent = __webpack_require__(598);\n\nvar webkit = userAgent.match(/AppleWebKit\\/(\\d+)\\./);\n\nmodule.exports = !!webkit && +webkit[1];\n\n\n/***/ }),\n\n/***/ 8791:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar uncurryThis = __webpack_require__(5968);\n\nmodule.exports = function (CONSTRUCTOR, METHOD) {\n  return uncurryThis(global[CONSTRUCTOR].prototype[METHOD]);\n};\n\n\n/***/ }),\n\n/***/ 3837:\n/***/ ((module) => {\n\n// IE8- don't enum bug keys\nmodule.exports = [\n  'constructor',\n  'hasOwnProperty',\n  'isPrototypeOf',\n  'propertyIsEnumerable',\n  'toLocaleString',\n  'toString',\n  'valueOf'\n];\n\n\n/***/ }),\n\n/***/ 3103:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar getOwnPropertyDescriptor = (__webpack_require__(7933).f);\nvar createNonEnumerableProperty = __webpack_require__(5762);\nvar defineBuiltIn = __webpack_require__(4768);\nvar defineGlobalProperty = __webpack_require__(8400);\nvar copyConstructorProperties = __webpack_require__(7081);\nvar isForced = __webpack_require__(6541);\n\n/*\n  options.target         - name of the target object\n  options.global         - target is the global object\n  options.stat           - export as static methods of target\n  options.proto          - export as prototype methods of target\n  options.real           - real prototype method for the `pure` version\n  options.forced         - export even if the native feature is available\n  options.bind           - bind methods to the target, required for the `pure` version\n  options.wrap           - wrap constructors to preventing global pollution, required for the `pure` version\n  options.unsafe         - use the simple assignment of property instead of delete + defineProperty\n  options.sham           - add a flag to not completely full polyfills\n  options.enumerable     - export as enumerable property\n  options.dontCallGetSet - prevent calling a getter on target\n  options.name           - the .name of the function if it does not match the key\n*/\nmodule.exports = function (options, source) {\n  var TARGET = options.target;\n  var GLOBAL = options.global;\n  var STATIC = options.stat;\n  var FORCED, target, key, targetProperty, sourceProperty, descriptor;\n  if (GLOBAL) {\n    target = global;\n  } else if (STATIC) {\n    target = global[TARGET] || defineGlobalProperty(TARGET, {});\n  } else {\n    target = (global[TARGET] || {}).prototype;\n  }\n  if (target) for (key in source) {\n    sourceProperty = source[key];\n    if (options.dontCallGetSet) {\n      descriptor = getOwnPropertyDescriptor(target, key);\n      targetProperty = descriptor && descriptor.value;\n    } else targetProperty = target[key];\n    FORCED = isForced(GLOBAL ? key : TARGET + (STATIC ? '.' : '#') + key, options.forced);\n    // contained in target\n    if (!FORCED && targetProperty !== undefined) {\n      if (typeof sourceProperty == typeof targetProperty) continue;\n      copyConstructorProperties(sourceProperty, targetProperty);\n    }\n    // add a flag to not completely full polyfills\n    if (options.sham || (targetProperty && targetProperty.sham)) {\n      createNonEnumerableProperty(sourceProperty, 'sham', true);\n    }\n    defineBuiltIn(target, key, sourceProperty, options);\n  }\n};\n\n\n/***/ }),\n\n/***/ 4229:\n/***/ ((module) => {\n\nmodule.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (error) {\n    return true;\n  }\n};\n\n\n/***/ }),\n\n/***/ 7188:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar fails = __webpack_require__(4229);\n\nmodule.exports = !fails(function () {\n  // eslint-disable-next-line es-x/no-function-prototype-bind -- safe\n  var test = (function () { /* empty */ }).bind();\n  // eslint-disable-next-line no-prototype-builtins -- safe\n  return typeof test != 'function' || test.hasOwnProperty('prototype');\n});\n\n\n/***/ }),\n\n/***/ 266:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar NATIVE_BIND = __webpack_require__(7188);\n\nvar call = Function.prototype.call;\n\nmodule.exports = NATIVE_BIND ? call.bind(call) : function () {\n  return call.apply(call, arguments);\n};\n\n\n/***/ }),\n\n/***/ 1805:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar DESCRIPTORS = __webpack_require__(7400);\nvar hasOwn = __webpack_require__(8270);\n\nvar FunctionPrototype = Function.prototype;\n// eslint-disable-next-line es-x/no-object-getownpropertydescriptor -- safe\nvar getDescriptor = DESCRIPTORS && Object.getOwnPropertyDescriptor;\n\nvar EXISTS = hasOwn(FunctionPrototype, 'name');\n// additional protection from minified / mangled / dropped function names\nvar PROPER = EXISTS && (function something() { /* empty */ }).name === 'something';\nvar CONFIGURABLE = EXISTS && (!DESCRIPTORS || (DESCRIPTORS && getDescriptor(FunctionPrototype, 'name').configurable));\n\nmodule.exports = {\n  EXISTS: EXISTS,\n  PROPER: PROPER,\n  CONFIGURABLE: CONFIGURABLE\n};\n\n\n/***/ }),\n\n/***/ 5968:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar NATIVE_BIND = __webpack_require__(7188);\n\nvar FunctionPrototype = Function.prototype;\nvar bind = FunctionPrototype.bind;\nvar call = FunctionPrototype.call;\nvar uncurryThis = NATIVE_BIND && bind.bind(call, call);\n\nmodule.exports = NATIVE_BIND ? function (fn) {\n  return fn && uncurryThis(fn);\n} : function (fn) {\n  return fn && function () {\n    return call.apply(fn, arguments);\n  };\n};\n\n\n/***/ }),\n\n/***/ 1333:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar isCallable = __webpack_require__(6733);\n\nvar aFunction = function (argument) {\n  return isCallable(argument) ? argument : undefined;\n};\n\nmodule.exports = function (namespace, method) {\n  return arguments.length < 2 ? aFunction(global[namespace]) : global[namespace] && global[namespace][method];\n};\n\n\n/***/ }),\n\n/***/ 5300:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar aCallable = __webpack_require__(7111);\n\n// `GetMethod` abstract operation\n// https://tc39.es/ecma262/#sec-getmethod\nmodule.exports = function (V, P) {\n  var func = V[P];\n  return func == null ? undefined : aCallable(func);\n};\n\n\n/***/ }),\n\n/***/ 9859:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar check = function (it) {\n  return it && it.Math == Math && it;\n};\n\n// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nmodule.exports =\n  // eslint-disable-next-line es-x/no-global-this -- safe\n  check(typeof globalThis == 'object' && globalThis) ||\n  check(typeof window == 'object' && window) ||\n  // eslint-disable-next-line no-restricted-globals -- safe\n  check(typeof self == 'object' && self) ||\n  check(typeof __webpack_require__.g == 'object' && __webpack_require__.g) ||\n  // eslint-disable-next-line no-new-func -- fallback\n  (function () { return this; })() || Function('return this')();\n\n\n/***/ }),\n\n/***/ 8270:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar uncurryThis = __webpack_require__(5968);\nvar toObject = __webpack_require__(2991);\n\nvar hasOwnProperty = uncurryThis({}.hasOwnProperty);\n\n// `HasOwnProperty` abstract operation\n// https://tc39.es/ecma262/#sec-hasownproperty\n// eslint-disable-next-line es-x/no-object-hasown -- safe\nmodule.exports = Object.hasOwn || function hasOwn(it, key) {\n  return hasOwnProperty(toObject(it), key);\n};\n\n\n/***/ }),\n\n/***/ 5977:\n/***/ ((module) => {\n\nmodule.exports = {};\n\n\n/***/ }),\n\n/***/ 4394:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar DESCRIPTORS = __webpack_require__(7400);\nvar fails = __webpack_require__(4229);\nvar createElement = __webpack_require__(2635);\n\n// Thanks to IE8 for its funny defineProperty\nmodule.exports = !DESCRIPTORS && !fails(function () {\n  // eslint-disable-next-line es-x/no-object-defineproperty -- required for testing\n  return Object.defineProperty(createElement('div'), 'a', {\n    get: function () { return 7; }\n  }).a != 7;\n});\n\n\n/***/ }),\n\n/***/ 9337:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar uncurryThis = __webpack_require__(5968);\nvar fails = __webpack_require__(4229);\nvar classof = __webpack_require__(7079);\n\nvar $Object = Object;\nvar split = uncurryThis(''.split);\n\n// fallback for non-array-like ES3 and non-enumerable old V8 strings\nmodule.exports = fails(function () {\n  // throws an error in rhino, see https://github.com/mozilla/rhino/issues/346\n  // eslint-disable-next-line no-prototype-builtins -- safe\n  return !$Object('z').propertyIsEnumerable(0);\n}) ? function (it) {\n  return classof(it) == 'String' ? split(it, '') : $Object(it);\n} : $Object;\n\n\n/***/ }),\n\n/***/ 8511:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar uncurryThis = __webpack_require__(5968);\nvar isCallable = __webpack_require__(6733);\nvar store = __webpack_require__(5353);\n\nvar functionToString = uncurryThis(Function.toString);\n\n// this helper broken in `core-js@3.4.1-3.4.4`, so we can't use `shared` helper\nif (!isCallable(store.inspectSource)) {\n  store.inspectSource = function (it) {\n    return functionToString(it);\n  };\n}\n\nmodule.exports = store.inspectSource;\n\n\n/***/ }),\n\n/***/ 6407:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar NATIVE_WEAK_MAP = __webpack_require__(8694);\nvar global = __webpack_require__(9859);\nvar uncurryThis = __webpack_require__(5968);\nvar isObject = __webpack_require__(5052);\nvar createNonEnumerableProperty = __webpack_require__(5762);\nvar hasOwn = __webpack_require__(8270);\nvar shared = __webpack_require__(5353);\nvar sharedKey = __webpack_require__(4399);\nvar hiddenKeys = __webpack_require__(5977);\n\nvar OBJECT_ALREADY_INITIALIZED = 'Object already initialized';\nvar TypeError = global.TypeError;\nvar WeakMap = global.WeakMap;\nvar set, get, has;\n\nvar enforce = function (it) {\n  return has(it) ? get(it) : set(it, {});\n};\n\nvar getterFor = function (TYPE) {\n  return function (it) {\n    var state;\n    if (!isObject(it) || (state = get(it)).type !== TYPE) {\n      throw TypeError('Incompatible receiver, ' + TYPE + ' required');\n    } return state;\n  };\n};\n\nif (NATIVE_WEAK_MAP || shared.state) {\n  var store = shared.state || (shared.state = new WeakMap());\n  var wmget = uncurryThis(store.get);\n  var wmhas = uncurryThis(store.has);\n  var wmset = uncurryThis(store.set);\n  set = function (it, metadata) {\n    if (wmhas(store, it)) throw new TypeError(OBJECT_ALREADY_INITIALIZED);\n    metadata.facade = it;\n    wmset(store, it, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return wmget(store, it) || {};\n  };\n  has = function (it) {\n    return wmhas(store, it);\n  };\n} else {\n  var STATE = sharedKey('state');\n  hiddenKeys[STATE] = true;\n  set = function (it, metadata) {\n    if (hasOwn(it, STATE)) throw new TypeError(OBJECT_ALREADY_INITIALIZED);\n    metadata.facade = it;\n    createNonEnumerableProperty(it, STATE, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return hasOwn(it, STATE) ? it[STATE] : {};\n  };\n  has = function (it) {\n    return hasOwn(it, STATE);\n  };\n}\n\nmodule.exports = {\n  set: set,\n  get: get,\n  has: has,\n  enforce: enforce,\n  getterFor: getterFor\n};\n\n\n/***/ }),\n\n/***/ 6733:\n/***/ ((module) => {\n\n// `IsCallable` abstract operation\n// https://tc39.es/ecma262/#sec-iscallable\nmodule.exports = function (argument) {\n  return typeof argument == 'function';\n};\n\n\n/***/ }),\n\n/***/ 6541:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar fails = __webpack_require__(4229);\nvar isCallable = __webpack_require__(6733);\n\nvar replacement = /#|\\.prototype\\./;\n\nvar isForced = function (feature, detection) {\n  var value = data[normalize(feature)];\n  return value == POLYFILL ? true\n    : value == NATIVE ? false\n    : isCallable(detection) ? fails(detection)\n    : !!detection;\n};\n\nvar normalize = isForced.normalize = function (string) {\n  return String(string).replace(replacement, '.').toLowerCase();\n};\n\nvar data = isForced.data = {};\nvar NATIVE = isForced.NATIVE = 'N';\nvar POLYFILL = isForced.POLYFILL = 'P';\n\nmodule.exports = isForced;\n\n\n/***/ }),\n\n/***/ 5052:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar isCallable = __webpack_require__(6733);\n\nmodule.exports = function (it) {\n  return typeof it == 'object' ? it !== null : isCallable(it);\n};\n\n\n/***/ }),\n\n/***/ 4231:\n/***/ ((module) => {\n\nmodule.exports = false;\n\n\n/***/ }),\n\n/***/ 9395:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar getBuiltIn = __webpack_require__(1333);\nvar isCallable = __webpack_require__(6733);\nvar isPrototypeOf = __webpack_require__(1321);\nvar USE_SYMBOL_AS_UID = __webpack_require__(6969);\n\nvar $Object = Object;\n\nmodule.exports = USE_SYMBOL_AS_UID ? function (it) {\n  return typeof it == 'symbol';\n} : function (it) {\n  var $Symbol = getBuiltIn('Symbol');\n  return isCallable($Symbol) && isPrototypeOf($Symbol.prototype, $Object(it));\n};\n\n\n/***/ }),\n\n/***/ 9646:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar toLength = __webpack_require__(4237);\n\n// `LengthOfArrayLike` abstract operation\n// https://tc39.es/ecma262/#sec-lengthofarraylike\nmodule.exports = function (obj) {\n  return toLength(obj.length);\n};\n\n\n/***/ }),\n\n/***/ 6039:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar fails = __webpack_require__(4229);\nvar isCallable = __webpack_require__(6733);\nvar hasOwn = __webpack_require__(8270);\nvar DESCRIPTORS = __webpack_require__(7400);\nvar CONFIGURABLE_FUNCTION_NAME = (__webpack_require__(1805).CONFIGURABLE);\nvar inspectSource = __webpack_require__(8511);\nvar InternalStateModule = __webpack_require__(6407);\n\nvar enforceInternalState = InternalStateModule.enforce;\nvar getInternalState = InternalStateModule.get;\n// eslint-disable-next-line es-x/no-object-defineproperty -- safe\nvar defineProperty = Object.defineProperty;\n\nvar CONFIGURABLE_LENGTH = DESCRIPTORS && !fails(function () {\n  return defineProperty(function () { /* empty */ }, 'length', { value: 8 }).length !== 8;\n});\n\nvar TEMPLATE = String(String).split('String');\n\nvar makeBuiltIn = module.exports = function (value, name, options) {\n  if (String(name).slice(0, 7) === 'Symbol(') {\n    name = '[' + String(name).replace(/^Symbol\\(([^)]*)\\)/, '$1') + ']';\n  }\n  if (options && options.getter) name = 'get ' + name;\n  if (options && options.setter) name = 'set ' + name;\n  if (!hasOwn(value, 'name') || (CONFIGURABLE_FUNCTION_NAME && value.name !== name)) {\n    if (DESCRIPTORS) defineProperty(value, 'name', { value: name, configurable: true });\n    else value.name = name;\n  }\n  if (CONFIGURABLE_LENGTH && options && hasOwn(options, 'arity') && value.length !== options.arity) {\n    defineProperty(value, 'length', { value: options.arity });\n  }\n  try {\n    if (options && hasOwn(options, 'constructor') && options.constructor) {\n      if (DESCRIPTORS) defineProperty(value, 'prototype', { writable: false });\n    // in V8 ~ Chrome 53, prototypes of some methods, like `Array.prototype.values`, are non-writable\n    } else if (value.prototype) value.prototype = undefined;\n  } catch (error) { /* empty */ }\n  var state = enforceInternalState(value);\n  if (!hasOwn(state, 'source')) {\n    state.source = TEMPLATE.join(typeof name == 'string' ? name : '');\n  } return value;\n};\n\n// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative\n// eslint-disable-next-line no-extend-native -- required\nFunction.prototype.toString = makeBuiltIn(function toString() {\n  return isCallable(this) && getInternalState(this).source || inspectSource(this);\n}, 'toString');\n\n\n/***/ }),\n\n/***/ 917:\n/***/ ((module) => {\n\nvar ceil = Math.ceil;\nvar floor = Math.floor;\n\n// `Math.trunc` method\n// https://tc39.es/ecma262/#sec-math.trunc\n// eslint-disable-next-line es-x/no-math-trunc -- safe\nmodule.exports = Math.trunc || function trunc(x) {\n  var n = +x;\n  return (n > 0 ? floor : ceil)(n);\n};\n\n\n/***/ }),\n\n/***/ 3839:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n/* eslint-disable es-x/no-symbol -- required for testing */\nvar V8_VERSION = __webpack_require__(6358);\nvar fails = __webpack_require__(4229);\n\n// eslint-disable-next-line es-x/no-object-getownpropertysymbols -- required for testing\nmodule.exports = !!Object.getOwnPropertySymbols && !fails(function () {\n  var symbol = Symbol();\n  // Chrome 38 Symbol has incorrect toString conversion\n  // `get-own-property-symbols` polyfill symbols converted to object are not Symbol instances\n  return !String(symbol) || !(Object(symbol) instanceof Symbol) ||\n    // Chrome 38-40 symbols are not inherited from DOM collections prototypes to instances\n    !Symbol.sham && V8_VERSION && V8_VERSION < 41;\n});\n\n\n/***/ }),\n\n/***/ 8694:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar isCallable = __webpack_require__(6733);\nvar inspectSource = __webpack_require__(8511);\n\nvar WeakMap = global.WeakMap;\n\nmodule.exports = isCallable(WeakMap) && /native code/.test(inspectSource(WeakMap));\n\n\n/***/ }),\n\n/***/ 1787:\n/***/ ((__unused_webpack_module, exports, __webpack_require__) => {\n\nvar DESCRIPTORS = __webpack_require__(7400);\nvar IE8_DOM_DEFINE = __webpack_require__(4394);\nvar V8_PROTOTYPE_DEFINE_BUG = __webpack_require__(7137);\nvar anObject = __webpack_require__(1176);\nvar toPropertyKey = __webpack_require__(9310);\n\nvar $TypeError = TypeError;\n// eslint-disable-next-line es-x/no-object-defineproperty -- safe\nvar $defineProperty = Object.defineProperty;\n// eslint-disable-next-line es-x/no-object-getownpropertydescriptor -- safe\nvar $getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\nvar ENUMERABLE = 'enumerable';\nvar CONFIGURABLE = 'configurable';\nvar WRITABLE = 'writable';\n\n// `Object.defineProperty` method\n// https://tc39.es/ecma262/#sec-object.defineproperty\nexports.f = DESCRIPTORS ? V8_PROTOTYPE_DEFINE_BUG ? function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPropertyKey(P);\n  anObject(Attributes);\n  if (typeof O === 'function' && P === 'prototype' && 'value' in Attributes && WRITABLE in Attributes && !Attributes[WRITABLE]) {\n    var current = $getOwnPropertyDescriptor(O, P);\n    if (current && current[WRITABLE]) {\n      O[P] = Attributes.value;\n      Attributes = {\n        configurable: CONFIGURABLE in Attributes ? Attributes[CONFIGURABLE] : current[CONFIGURABLE],\n        enumerable: ENUMERABLE in Attributes ? Attributes[ENUMERABLE] : current[ENUMERABLE],\n        writable: false\n      };\n    }\n  } return $defineProperty(O, P, Attributes);\n} : $defineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPropertyKey(P);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return $defineProperty(O, P, Attributes);\n  } catch (error) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw $TypeError('Accessors not supported');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n\n\n/***/ }),\n\n/***/ 7933:\n/***/ ((__unused_webpack_module, exports, __webpack_require__) => {\n\nvar DESCRIPTORS = __webpack_require__(7400);\nvar call = __webpack_require__(266);\nvar propertyIsEnumerableModule = __webpack_require__(9195);\nvar createPropertyDescriptor = __webpack_require__(5358);\nvar toIndexedObject = __webpack_require__(905);\nvar toPropertyKey = __webpack_require__(9310);\nvar hasOwn = __webpack_require__(8270);\nvar IE8_DOM_DEFINE = __webpack_require__(4394);\n\n// eslint-disable-next-line es-x/no-object-getownpropertydescriptor -- safe\nvar $getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// `Object.getOwnPropertyDescriptor` method\n// https://tc39.es/ecma262/#sec-object.getownpropertydescriptor\nexports.f = DESCRIPTORS ? $getOwnPropertyDescriptor : function getOwnPropertyDescriptor(O, P) {\n  O = toIndexedObject(O);\n  P = toPropertyKey(P);\n  if (IE8_DOM_DEFINE) try {\n    return $getOwnPropertyDescriptor(O, P);\n  } catch (error) { /* empty */ }\n  if (hasOwn(O, P)) return createPropertyDescriptor(!call(propertyIsEnumerableModule.f, O, P), O[P]);\n};\n\n\n/***/ }),\n\n/***/ 8151:\n/***/ ((__unused_webpack_module, exports, __webpack_require__) => {\n\nvar internalObjectKeys = __webpack_require__(140);\nvar enumBugKeys = __webpack_require__(3837);\n\nvar hiddenKeys = enumBugKeys.concat('length', 'prototype');\n\n// `Object.getOwnPropertyNames` method\n// https://tc39.es/ecma262/#sec-object.getownpropertynames\n// eslint-disable-next-line es-x/no-object-getownpropertynames -- safe\nexports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {\n  return internalObjectKeys(O, hiddenKeys);\n};\n\n\n/***/ }),\n\n/***/ 894:\n/***/ ((__unused_webpack_module, exports) => {\n\n// eslint-disable-next-line es-x/no-object-getownpropertysymbols -- safe\nexports.f = Object.getOwnPropertySymbols;\n\n\n/***/ }),\n\n/***/ 1321:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar uncurryThis = __webpack_require__(5968);\n\nmodule.exports = uncurryThis({}.isPrototypeOf);\n\n\n/***/ }),\n\n/***/ 140:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar uncurryThis = __webpack_require__(5968);\nvar hasOwn = __webpack_require__(8270);\nvar toIndexedObject = __webpack_require__(905);\nvar indexOf = (__webpack_require__(9540).indexOf);\nvar hiddenKeys = __webpack_require__(5977);\n\nvar push = uncurryThis([].push);\n\nmodule.exports = function (object, names) {\n  var O = toIndexedObject(object);\n  var i = 0;\n  var result = [];\n  var key;\n  for (key in O) !hasOwn(hiddenKeys, key) && hasOwn(O, key) && push(result, key);\n  // Don't enum bug & hidden keys\n  while (names.length > i) if (hasOwn(O, key = names[i++])) {\n    ~indexOf(result, key) || push(result, key);\n  }\n  return result;\n};\n\n\n/***/ }),\n\n/***/ 5632:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar internalObjectKeys = __webpack_require__(140);\nvar enumBugKeys = __webpack_require__(3837);\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n// eslint-disable-next-line es-x/no-object-keys -- safe\nmodule.exports = Object.keys || function keys(O) {\n  return internalObjectKeys(O, enumBugKeys);\n};\n\n\n/***/ }),\n\n/***/ 9195:\n/***/ ((__unused_webpack_module, exports) => {\n\n\nvar $propertyIsEnumerable = {}.propertyIsEnumerable;\n// eslint-disable-next-line es-x/no-object-getownpropertydescriptor -- safe\nvar getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// Nashorn ~ JDK8 bug\nvar NASHORN_BUG = getOwnPropertyDescriptor && !$propertyIsEnumerable.call({ 1: 2 }, 1);\n\n// `Object.prototype.propertyIsEnumerable` method implementation\n// https://tc39.es/ecma262/#sec-object.prototype.propertyisenumerable\nexports.f = NASHORN_BUG ? function propertyIsEnumerable(V) {\n  var descriptor = getOwnPropertyDescriptor(this, V);\n  return !!descriptor && descriptor.enumerable;\n} : $propertyIsEnumerable;\n\n\n/***/ }),\n\n/***/ 2914:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar call = __webpack_require__(266);\nvar isCallable = __webpack_require__(6733);\nvar isObject = __webpack_require__(5052);\n\nvar $TypeError = TypeError;\n\n// `OrdinaryToPrimitive` abstract operation\n// https://tc39.es/ecma262/#sec-ordinarytoprimitive\nmodule.exports = function (input, pref) {\n  var fn, val;\n  if (pref === 'string' && isCallable(fn = input.toString) && !isObject(val = call(fn, input))) return val;\n  if (isCallable(fn = input.valueOf) && !isObject(val = call(fn, input))) return val;\n  if (pref !== 'string' && isCallable(fn = input.toString) && !isObject(val = call(fn, input))) return val;\n  throw $TypeError(\"Can't convert object to primitive value\");\n};\n\n\n/***/ }),\n\n/***/ 4826:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar getBuiltIn = __webpack_require__(1333);\nvar uncurryThis = __webpack_require__(5968);\nvar getOwnPropertyNamesModule = __webpack_require__(8151);\nvar getOwnPropertySymbolsModule = __webpack_require__(894);\nvar anObject = __webpack_require__(1176);\n\nvar concat = uncurryThis([].concat);\n\n// all object keys, includes non-enumerable and symbols\nmodule.exports = getBuiltIn('Reflect', 'ownKeys') || function ownKeys(it) {\n  var keys = getOwnPropertyNamesModule.f(anObject(it));\n  var getOwnPropertySymbols = getOwnPropertySymbolsModule.f;\n  return getOwnPropertySymbols ? concat(keys, getOwnPropertySymbols(it)) : keys;\n};\n\n\n/***/ }),\n\n/***/ 9276:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\n\nmodule.exports = global;\n\n\n/***/ }),\n\n/***/ 8885:\n/***/ ((module) => {\n\nvar $TypeError = TypeError;\n\n// `RequireObjectCoercible` abstract operation\n// https://tc39.es/ecma262/#sec-requireobjectcoercible\nmodule.exports = function (it) {\n  if (it == undefined) throw $TypeError(\"Can't call method on \" + it);\n  return it;\n};\n\n\n/***/ }),\n\n/***/ 4399:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar shared = __webpack_require__(3036);\nvar uid = __webpack_require__(1441);\n\nvar keys = shared('keys');\n\nmodule.exports = function (key) {\n  return keys[key] || (keys[key] = uid(key));\n};\n\n\n/***/ }),\n\n/***/ 5353:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar defineGlobalProperty = __webpack_require__(8400);\n\nvar SHARED = '__core-js_shared__';\nvar store = global[SHARED] || defineGlobalProperty(SHARED, {});\n\nmodule.exports = store;\n\n\n/***/ }),\n\n/***/ 3036:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar IS_PURE = __webpack_require__(4231);\nvar store = __webpack_require__(5353);\n\n(module.exports = function (key, value) {\n  return store[key] || (store[key] = value !== undefined ? value : {});\n})('versions', []).push({\n  version: '3.23.3',\n  mode: IS_PURE ? 'pure' : 'global',\n  copyright: '© 2014-2022 Denis Pushkarev (zloirock.ru)',\n  license: 'https://github.com/zloirock/core-js/blob/v3.23.3/LICENSE',\n  source: 'https://github.com/zloirock/core-js'\n});\n\n\n/***/ }),\n\n/***/ 3231:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar toIntegerOrInfinity = __webpack_require__(3329);\n\nvar max = Math.max;\nvar min = Math.min;\n\n// Helper for a popular repeating case of the spec:\n// Let integer be ? ToInteger(index).\n// If integer < 0, let result be max((length + integer), 0); else let result be min(integer, length).\nmodule.exports = function (index, length) {\n  var integer = toIntegerOrInfinity(index);\n  return integer < 0 ? max(integer + length, 0) : min(integer, length);\n};\n\n\n/***/ }),\n\n/***/ 905:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n// toObject with fallback for non-array-like ES3 strings\nvar IndexedObject = __webpack_require__(9337);\nvar requireObjectCoercible = __webpack_require__(8885);\n\nmodule.exports = function (it) {\n  return IndexedObject(requireObjectCoercible(it));\n};\n\n\n/***/ }),\n\n/***/ 3329:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar trunc = __webpack_require__(917);\n\n// `ToIntegerOrInfinity` abstract operation\n// https://tc39.es/ecma262/#sec-tointegerorinfinity\nmodule.exports = function (argument) {\n  var number = +argument;\n  // eslint-disable-next-line no-self-compare -- NaN check\n  return number !== number || number === 0 ? 0 : trunc(number);\n};\n\n\n/***/ }),\n\n/***/ 4237:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar toIntegerOrInfinity = __webpack_require__(3329);\n\nvar min = Math.min;\n\n// `ToLength` abstract operation\n// https://tc39.es/ecma262/#sec-tolength\nmodule.exports = function (argument) {\n  return argument > 0 ? min(toIntegerOrInfinity(argument), 0x1FFFFFFFFFFFFF) : 0; // 2 ** 53 - 1 == 9007199254740991\n};\n\n\n/***/ }),\n\n/***/ 2991:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar requireObjectCoercible = __webpack_require__(8885);\n\nvar $Object = Object;\n\n// `ToObject` abstract operation\n// https://tc39.es/ecma262/#sec-toobject\nmodule.exports = function (argument) {\n  return $Object(requireObjectCoercible(argument));\n};\n\n\n/***/ }),\n\n/***/ 2066:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar call = __webpack_require__(266);\nvar isObject = __webpack_require__(5052);\nvar isSymbol = __webpack_require__(9395);\nvar getMethod = __webpack_require__(5300);\nvar ordinaryToPrimitive = __webpack_require__(2914);\nvar wellKnownSymbol = __webpack_require__(95);\n\nvar $TypeError = TypeError;\nvar TO_PRIMITIVE = wellKnownSymbol('toPrimitive');\n\n// `ToPrimitive` abstract operation\n// https://tc39.es/ecma262/#sec-toprimitive\nmodule.exports = function (input, pref) {\n  if (!isObject(input) || isSymbol(input)) return input;\n  var exoticToPrim = getMethod(input, TO_PRIMITIVE);\n  var result;\n  if (exoticToPrim) {\n    if (pref === undefined) pref = 'default';\n    result = call(exoticToPrim, input, pref);\n    if (!isObject(result) || isSymbol(result)) return result;\n    throw $TypeError(\"Can't convert object to primitive value\");\n  }\n  if (pref === undefined) pref = 'number';\n  return ordinaryToPrimitive(input, pref);\n};\n\n\n/***/ }),\n\n/***/ 9310:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar toPrimitive = __webpack_require__(2066);\nvar isSymbol = __webpack_require__(9395);\n\n// `ToPropertyKey` abstract operation\n// https://tc39.es/ecma262/#sec-topropertykey\nmodule.exports = function (argument) {\n  var key = toPrimitive(argument, 'string');\n  return isSymbol(key) ? key : key + '';\n};\n\n\n/***/ }),\n\n/***/ 1601:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar wellKnownSymbol = __webpack_require__(95);\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar test = {};\n\ntest[TO_STRING_TAG] = 'z';\n\nmodule.exports = String(test) === '[object z]';\n\n\n/***/ }),\n\n/***/ 3326:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar classof = __webpack_require__(1589);\n\nvar $String = String;\n\nmodule.exports = function (argument) {\n  if (classof(argument) === 'Symbol') throw TypeError('Cannot convert a Symbol value to a string');\n  return $String(argument);\n};\n\n\n/***/ }),\n\n/***/ 9821:\n/***/ ((module) => {\n\nvar $String = String;\n\nmodule.exports = function (argument) {\n  try {\n    return $String(argument);\n  } catch (error) {\n    return 'Object';\n  }\n};\n\n\n/***/ }),\n\n/***/ 1441:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar uncurryThis = __webpack_require__(5968);\n\nvar id = 0;\nvar postfix = Math.random();\nvar toString = uncurryThis(1.0.toString);\n\nmodule.exports = function (key) {\n  return 'Symbol(' + (key === undefined ? '' : key) + ')_' + toString(++id + postfix, 36);\n};\n\n\n/***/ }),\n\n/***/ 6969:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n/* eslint-disable es-x/no-symbol -- required for testing */\nvar NATIVE_SYMBOL = __webpack_require__(3839);\n\nmodule.exports = NATIVE_SYMBOL\n  && !Symbol.sham\n  && typeof Symbol.iterator == 'symbol';\n\n\n/***/ }),\n\n/***/ 7137:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar DESCRIPTORS = __webpack_require__(7400);\nvar fails = __webpack_require__(4229);\n\n// V8 ~ Chrome 36-\n// https://bugs.chromium.org/p/v8/issues/detail?id=3334\nmodule.exports = DESCRIPTORS && fails(function () {\n  // eslint-disable-next-line es-x/no-object-defineproperty -- required for testing\n  return Object.defineProperty(function () { /* empty */ }, 'prototype', {\n    value: 42,\n    writable: false\n  }).prototype != 42;\n});\n\n\n/***/ }),\n\n/***/ 95:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar shared = __webpack_require__(3036);\nvar hasOwn = __webpack_require__(8270);\nvar uid = __webpack_require__(1441);\nvar NATIVE_SYMBOL = __webpack_require__(3839);\nvar USE_SYMBOL_AS_UID = __webpack_require__(6969);\n\nvar WellKnownSymbolsStore = shared('wks');\nvar Symbol = global.Symbol;\nvar symbolFor = Symbol && Symbol['for'];\nvar createWellKnownSymbol = USE_SYMBOL_AS_UID ? Symbol : Symbol && Symbol.withoutSetter || uid;\n\nmodule.exports = function (name) {\n  if (!hasOwn(WellKnownSymbolsStore, name) || !(NATIVE_SYMBOL || typeof WellKnownSymbolsStore[name] == 'string')) {\n    var description = 'Symbol.' + name;\n    if (NATIVE_SYMBOL && hasOwn(Symbol, name)) {\n      WellKnownSymbolsStore[name] = Symbol[name];\n    } else if (USE_SYMBOL_AS_UID && symbolFor) {\n      WellKnownSymbolsStore[name] = symbolFor(description);\n    } else {\n      WellKnownSymbolsStore[name] = createWellKnownSymbol(description);\n    }\n  } return WellKnownSymbolsStore[name];\n};\n\n\n/***/ }),\n\n/***/ 3430:\n/***/ ((__unused_webpack_module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar $ = __webpack_require__(3103);\nvar uncurryThis = __webpack_require__(5968);\nvar aCallable = __webpack_require__(7111);\nvar toObject = __webpack_require__(2991);\nvar lengthOfArrayLike = __webpack_require__(9646);\nvar deletePropertyOrThrow = __webpack_require__(9563);\nvar toString = __webpack_require__(3326);\nvar fails = __webpack_require__(4229);\nvar internalSort = __webpack_require__(3867);\nvar arrayMethodIsStrict = __webpack_require__(6038);\nvar FF = __webpack_require__(2671);\nvar IE_OR_EDGE = __webpack_require__(8506);\nvar V8 = __webpack_require__(6358);\nvar WEBKIT = __webpack_require__(9811);\n\nvar test = [];\nvar un$Sort = uncurryThis(test.sort);\nvar push = uncurryThis(test.push);\n\n// IE8-\nvar FAILS_ON_UNDEFINED = fails(function () {\n  test.sort(undefined);\n});\n// V8 bug\nvar FAILS_ON_NULL = fails(function () {\n  test.sort(null);\n});\n// Old WebKit\nvar STRICT_METHOD = arrayMethodIsStrict('sort');\n\nvar STABLE_SORT = !fails(function () {\n  // feature detection can be too slow, so check engines versions\n  if (V8) return V8 < 70;\n  if (FF && FF > 3) return;\n  if (IE_OR_EDGE) return true;\n  if (WEBKIT) return WEBKIT < 603;\n\n  var result = '';\n  var code, chr, value, index;\n\n  // generate an array with more 512 elements (Chakra and old V8 fails only in this case)\n  for (code = 65; code < 76; code++) {\n    chr = String.fromCharCode(code);\n\n    switch (code) {\n      case 66: case 69: case 70: case 72: value = 3; break;\n      case 68: case 71: value = 4; break;\n      default: value = 2;\n    }\n\n    for (index = 0; index < 47; index++) {\n      test.push({ k: chr + index, v: value });\n    }\n  }\n\n  test.sort(function (a, b) { return b.v - a.v; });\n\n  for (index = 0; index < test.length; index++) {\n    chr = test[index].k.charAt(0);\n    if (result.charAt(result.length - 1) !== chr) result += chr;\n  }\n\n  return result !== 'DGBEFHACIJK';\n});\n\nvar FORCED = FAILS_ON_UNDEFINED || !FAILS_ON_NULL || !STRICT_METHOD || !STABLE_SORT;\n\nvar getSortCompare = function (comparefn) {\n  return function (x, y) {\n    if (y === undefined) return -1;\n    if (x === undefined) return 1;\n    if (comparefn !== undefined) return +comparefn(x, y) || 0;\n    return toString(x) > toString(y) ? 1 : -1;\n  };\n};\n\n// `Array.prototype.sort` method\n// https://tc39.es/ecma262/#sec-array.prototype.sort\n$({ target: 'Array', proto: true, forced: FORCED }, {\n  sort: function sort(comparefn) {\n    if (comparefn !== undefined) aCallable(comparefn);\n\n    var array = toObject(this);\n\n    if (STABLE_SORT) return comparefn === undefined ? un$Sort(array) : un$Sort(array, comparefn);\n\n    var items = [];\n    var arrayLength = lengthOfArrayLike(array);\n    var itemsLength, index;\n\n    for (index = 0; index < arrayLength; index++) {\n      if (index in array) push(items, array[index]);\n    }\n\n    internalSort(items, getSortCompare(comparefn));\n\n    itemsLength = items.length;\n    index = 0;\n\n    while (index < itemsLength) array[index] = items[index++];\n    while (index < arrayLength) deletePropertyOrThrow(array, index++);\n\n    return array;\n  }\n});\n\n\n/***/ }),\n\n/***/ 4769:\n/***/ ((__unused_webpack_module, __unused_webpack_exports, __webpack_require__) => {\n\nvar $ = __webpack_require__(3103);\nvar toObject = __webpack_require__(2991);\nvar nativeKeys = __webpack_require__(5632);\nvar fails = __webpack_require__(4229);\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeKeys(1); });\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES }, {\n  keys: function keys(it) {\n    return nativeKeys(toObject(it));\n  }\n});\n\n\n/***/ }),\n\n/***/ 1388:\n/***/ ((module, __webpack_exports__, __webpack_require__) => {\n\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"Z\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(272);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(2609);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__);\n// Imports\n\n\nvar ___CSS_LOADER_EXPORT___ = _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default()((_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default()));\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"/* Buttons styles start */\\r\\n\\r\\nbutton#excalibur-play {\\r\\n  display: inline-block;\\r\\n  position: relative;\\r\\n  z-index: 999;\\r\\n  border-radius: 6px;\\r\\n  border: none;\\r\\n  /*border: 3px solid;\\r\\n    border-color: white;\\r\\n    box-shadow: 0 0 10px #ccc;*/\\r\\n  padding: 1rem 1.5rem 1rem 4rem;\\r\\n  margin: 0;\\r\\n  text-decoration: none;\\r\\n  background: #00b233;\\r\\n  color: #ffffff;\\r\\n  font-family: sans-serif;\\r\\n  font-size: 2rem;\\r\\n  white-space: nowrap;\\r\\n  line-height: 1;\\r\\n  cursor: pointer;\\r\\n  text-align: center;\\r\\n  transition: background 250ms ease-in-out, transform 150ms ease;\\r\\n  -webkit-appearance: none;\\r\\n  -moz-appearance: none;\\r\\n\\r\\n  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\\r\\n  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\\r\\n  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\\r\\n  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\\r\\n  animation: excalibur-button-fadein 200ms;\\r\\n}\\r\\n\\r\\n/*\\r\\nbutton#excalibur-play {\\r\\n  display: none;\\r\\n}*/\\r\\n\\r\\nbutton#excalibur-play:after {\\r\\n  position: absolute;\\r\\n  content: '';\\r\\n  border: 8px solid;\\r\\n  border-color: transparent transparent transparent white;\\r\\n  left: 35px;\\r\\n  top: 24px;\\r\\n  width: 0;\\r\\n  height: 0;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:before {\\r\\n  position: absolute;\\r\\n  content: '';\\r\\n  border: 3px solid;\\r\\n  left: 19px;\\r\\n  top: 14px;\\r\\n  border-radius: 20px;\\r\\n  width: 30px;\\r\\n  height: 30px;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:hover,\\r\\nbutton#excalibur-play:focus {\\r\\n  background: #00982c;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:focus {\\r\\n  outline: 1px solid #fff;\\r\\n  outline-offset: -4px;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:active {\\r\\n  transform: scale(0.99);\\r\\n}\\r\\n\\r\\n@keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Firefox < 16 */\\r\\n@-moz-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Safari, Chrome and Opera > 12.1 */\\r\\n@-webkit-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Internet Explorer */\\r\\n@-ms-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Opera < 12.1 */\\r\\n@-o-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./Loader.css\"],\"names\":[],\"mappings\":\"AAAA,yBAAyB;;AAEzB;EACE,qBAAqB;EACrB,kBAAkB;EAClB,YAAY;EACZ,kBAAkB;EAClB,YAAY;EACZ;;+BAE6B;EAC7B,8BAA8B;EAC9B,SAAS;EACT,qBAAqB;EACrB,mBAAmB;EACnB,cAAc;EACd,uBAAuB;EACvB,eAAe;EACf,mBAAmB;EACnB,cAAc;EACd,eAAe;EACf,kBAAkB;EAClB,8DAA8D;EAC9D,wBAAwB;EACxB,qBAAqB;;EAErB,gDAAgD,EAAE,oCAAoC;EACtF,6CAA6C,EAAE,iBAAiB;EAChE,4CAA4C,EAAE,sBAAsB;EACpE,2CAA2C,EAAE,iBAAiB;EAC9D,wCAAwC;AAC1C;;AAEA;;;EAGE;;AAEF;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,uDAAuD;EACvD,UAAU;EACV,SAAS;EACT,QAAQ;EACR,SAAS;AACX;;AAEA;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,UAAU;EACV,SAAS;EACT,mBAAmB;EACnB,WAAW;EACX,YAAY;AACd;;AAEA;;EAEE,mBAAmB;AACrB;;AAEA;EACE,uBAAuB;EACvB,oBAAoB;AACtB;;AAEA;EACE,sBAAsB;AACxB;;AAEA;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,oCAAoC;AACpC;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,sBAAsB;AACtB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF\",\"sourcesContent\":[\"/* Buttons styles start */\\r\\n\\r\\nbutton#excalibur-play {\\r\\n  display: inline-block;\\r\\n  position: relative;\\r\\n  z-index: 999;\\r\\n  border-radius: 6px;\\r\\n  border: none;\\r\\n  /*border: 3px solid;\\r\\n    border-color: white;\\r\\n    box-shadow: 0 0 10px #ccc;*/\\r\\n  padding: 1rem 1.5rem 1rem 4rem;\\r\\n  margin: 0;\\r\\n  text-decoration: none;\\r\\n  background: #00b233;\\r\\n  color: #ffffff;\\r\\n  font-family: sans-serif;\\r\\n  font-size: 2rem;\\r\\n  white-space: nowrap;\\r\\n  line-height: 1;\\r\\n  cursor: pointer;\\r\\n  text-align: center;\\r\\n  transition: background 250ms ease-in-out, transform 150ms ease;\\r\\n  -webkit-appearance: none;\\r\\n  -moz-appearance: none;\\r\\n\\r\\n  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\\r\\n  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\\r\\n  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\\r\\n  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\\r\\n  animation: excalibur-button-fadein 200ms;\\r\\n}\\r\\n\\r\\n/*\\r\\nbutton#excalibur-play {\\r\\n  display: none;\\r\\n}*/\\r\\n\\r\\nbutton#excalibur-play:after {\\r\\n  position: absolute;\\r\\n  content: '';\\r\\n  border: 8px solid;\\r\\n  border-color: transparent transparent transparent white;\\r\\n  left: 35px;\\r\\n  top: 24px;\\r\\n  width: 0;\\r\\n  height: 0;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:before {\\r\\n  position: absolute;\\r\\n  content: '';\\r\\n  border: 3px solid;\\r\\n  left: 19px;\\r\\n  top: 14px;\\r\\n  border-radius: 20px;\\r\\n  width: 30px;\\r\\n  height: 30px;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:hover,\\r\\nbutton#excalibur-play:focus {\\r\\n  background: #00982c;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:focus {\\r\\n  outline: 1px solid #fff;\\r\\n  outline-offset: -4px;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:active {\\r\\n  transform: scale(0.99);\\r\\n}\\r\\n\\r\\n@keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Firefox < 16 */\\r\\n@-moz-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Safari, Chrome and Opera > 12.1 */\\r\\n@-webkit-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Internet Explorer */\\r\\n@-ms-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Opera < 12.1 */\\r\\n@-o-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (___CSS_LOADER_EXPORT___);\n\n\n/***/ }),\n\n/***/ 7379:\n/***/ ((module, __webpack_exports__, __webpack_require__) => {\n\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"Z\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(272);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(2609);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__);\n// Imports\n\n\nvar ___CSS_LOADER_EXPORT___ = _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default()((_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default()));\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"\\r\\n#ex-toast-container {\\r\\n  position: absolute;\\r\\n  height: 0;\\r\\n  min-width: 50%;\\r\\n  left: 50%;\\r\\n  top: 0;\\r\\n}\\r\\n\\r\\n.ex-toast-message {\\r\\n  left: -50%;\\r\\n  position: relative;\\r\\n  display: flex;\\r\\n  justify-content: space-between;\\r\\n\\r\\n\\r\\n  padding: 10px;\\r\\n  margin-top: 5px;\\r\\n  font-size: 18px;\\r\\n  font-family: sans-serif;\\r\\n  border-radius: 6px;\\r\\n  border: 3px solid #b7b779;\\r\\n  background-color: rgb(253, 253, 192);\\r\\n}\\r\\n\\r\\n\\r\\n.ex-toast-message button {\\r\\n  align-self: flex-start;\\r\\n}\", \"\",{\"version\":3,\"sources\":[\"webpack://./Util/Toaster.css\"],\"names\":[],\"mappings\":\";AACA;EACE,kBAAkB;EAClB,SAAS;EACT,cAAc;EACd,SAAS;EACT,MAAM;AACR;;AAEA;EACE,UAAU;EACV,kBAAkB;EAClB,aAAa;EACb,8BAA8B;;;EAG9B,aAAa;EACb,eAAe;EACf,eAAe;EACf,uBAAuB;EACvB,kBAAkB;EAClB,yBAAyB;EACzB,oCAAoC;AACtC;;;AAGA;EACE,sBAAsB;AACxB\",\"sourcesContent\":[\"\\r\\n#ex-toast-container {\\r\\n  position: absolute;\\r\\n  height: 0;\\r\\n  min-width: 50%;\\r\\n  left: 50%;\\r\\n  top: 0;\\r\\n}\\r\\n\\r\\n.ex-toast-message {\\r\\n  left: -50%;\\r\\n  position: relative;\\r\\n  display: flex;\\r\\n  justify-content: space-between;\\r\\n\\r\\n\\r\\n  padding: 10px;\\r\\n  margin-top: 5px;\\r\\n  font-size: 18px;\\r\\n  font-family: sans-serif;\\r\\n  border-radius: 6px;\\r\\n  border: 3px solid #b7b779;\\r\\n  background-color: rgb(253, 253, 192);\\r\\n}\\r\\n\\r\\n\\r\\n.ex-toast-message button {\\r\\n  align-self: flex-start;\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (___CSS_LOADER_EXPORT___);\n\n\n/***/ }),\n\n/***/ 2609:\n/***/ ((module) => {\n\n\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\nmodule.exports = function (cssWithMappingToString) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = \"\";\n      var needLayer = typeof item[5] !== \"undefined\";\n\n      if (item[4]) {\n        content += \"@supports (\".concat(item[4], \") {\");\n      }\n\n      if (item[2]) {\n        content += \"@media \".concat(item[2], \" {\");\n      }\n\n      if (needLayer) {\n        content += \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\");\n      }\n\n      content += cssWithMappingToString(item);\n\n      if (needLayer) {\n        content += \"}\";\n      }\n\n      if (item[2]) {\n        content += \"}\";\n      }\n\n      if (item[4]) {\n        content += \"}\";\n      }\n\n      return content;\n    }).join(\"\");\n  }; // import a list of modules into the list\n\n\n  list.i = function i(modules, media, dedupe, supports, layer) {\n    if (typeof modules === \"string\") {\n      modules = [[null, modules, undefined]];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var k = 0; k < this.length; k++) {\n        var id = this[k][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _k = 0; _k < modules.length; _k++) {\n      var item = [].concat(modules[_k]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        continue;\n      }\n\n      if (typeof layer !== \"undefined\") {\n        if (typeof item[5] === \"undefined\") {\n          item[5] = layer;\n        } else {\n          item[1] = \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\").concat(item[1], \"}\");\n          item[5] = layer;\n        }\n      }\n\n      if (media) {\n        if (!item[2]) {\n          item[2] = media;\n        } else {\n          item[1] = \"@media \".concat(item[2], \" {\").concat(item[1], \"}\");\n          item[2] = media;\n        }\n      }\n\n      if (supports) {\n        if (!item[4]) {\n          item[4] = \"\".concat(supports);\n        } else {\n          item[1] = \"@supports (\".concat(item[4], \") {\").concat(item[1], \"}\");\n          item[4] = supports;\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};\n\n/***/ }),\n\n/***/ 272:\n/***/ ((module) => {\n\n\n\nmodule.exports = function (item) {\n  var content = item[1];\n  var cssMapping = item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (typeof btoa === \"function\") {\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || \"\").concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join(\"\\n\");\n  }\n\n  return [content].join(\"\\n\");\n};\n\n/***/ })\n\n/******/ });\n/************************************************************************/\n/******/ // The module cache\n/******/ var __webpack_module_cache__ = {};\n/******/ \n/******/ // The require function\n/******/ function __webpack_require__(moduleId) {\n/******/ \t// Check if module is in cache\n/******/ \tvar cachedModule = __webpack_module_cache__[moduleId];\n/******/ \tif (cachedModule !== undefined) {\n/******/ \t\treturn cachedModule.exports;\n/******/ \t}\n/******/ \t// Create a new module (and put it into the cache)\n/******/ \tvar module = __webpack_module_cache__[moduleId] = {\n/******/ \t\tid: moduleId,\n/******/ \t\t// no module.loaded needed\n/******/ \t\texports: {}\n/******/ \t};\n/******/ \n/******/ \t// Execute the module function\n/******/ \t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n/******/ \n/******/ \t// Return the exports of the module\n/******/ \treturn module.exports;\n/******/ }\n/******/ \n/************************************************************************/\n/******/ /* webpack/runtime/compat get default export */\n/******/ (() => {\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = (module) => {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\t() => (module['default']) :\n/******/ \t\t\t() => (module);\n/******/ \t\t__webpack_require__.d(getter, { a: getter });\n/******/ \t\treturn getter;\n/******/ \t};\n/******/ })();\n/******/ \n/******/ /* webpack/runtime/define property getters */\n/******/ (() => {\n/******/ \t// define getter functions for harmony exports\n/******/ \t__webpack_require__.d = (exports, definition) => {\n/******/ \t\tfor(var key in definition) {\n/******/ \t\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n/******/ \t\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n/******/ \t\t\t}\n/******/ \t\t}\n/******/ \t};\n/******/ })();\n/******/ \n/******/ /* webpack/runtime/global */\n/******/ (() => {\n/******/ \t__webpack_require__.g = (function() {\n/******/ \t\tif (typeof globalThis === 'object') return globalThis;\n/******/ \t\ttry {\n/******/ \t\t\treturn this || new Function('return this')();\n/******/ \t\t} catch (e) {\n/******/ \t\t\tif (typeof window === 'object') return window;\n/******/ \t\t}\n/******/ \t})();\n/******/ })();\n/******/ \n/******/ /* webpack/runtime/hasOwnProperty shorthand */\n/******/ (() => {\n/******/ \t__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))\n/******/ })();\n/******/ \n/******/ /* webpack/runtime/make namespace object */\n/******/ (() => {\n/******/ \t// define __esModule on exports\n/******/ \t__webpack_require__.r = (exports) => {\n/******/ \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n/******/ \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n/******/ \t\t}\n/******/ \t\tObject.defineProperty(exports, '__esModule', { value: true });\n/******/ \t};\n/******/ })();\n/******/ \n/************************************************************************/\nvar __webpack_exports__ = {};\n// This entry need to be wrapped in an IIFE because it need to be isolated against other modules in the chunk.\n(() => {\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, {\n  \"fWn\": () => (/* reexport */ ActionContext),\n  \"Ia8\": () => (/* reexport */ ActionQueue),\n  \"rqv\": () => (/* reexport */ ActionSequence),\n  \"hLI\": () => (/* reexport */ ActionsComponent),\n  \"yyv\": () => (/* reexport */ ActionsSystem),\n  \"tX5\": () => (/* reexport */ ActivateEvent),\n  \"vtX\": () => (/* reexport */ Actor),\n  \"r7K\": () => (/* reexport */ AddedComponent),\n  \"lCh\": () => (/* reexport */ AddedEntity),\n  \"cE4\": () => (/* reexport */ AffineMatrix),\n  \"fwF\": () => (/* reexport */ Animation),\n  \"sce\": () => (/* reexport */ AnimationDirection),\n  \"_c7\": () => (/* reexport */ AnimationStrategy),\n  \"KUs\": () => (/* reexport */ ArcadeSolver),\n  \"Ajp\": () => (/* reexport */ AudioContextFactory),\n  \"RDh\": () => (/* reexport */ Axis),\n  \"_H9\": () => (/* reexport */ BaseAlign),\n  \"mxs\": () => (/* reexport */ Blink),\n  \"OmD\": () => (/* reexport */ BodyComponent),\n  \"kBf\": () => (/* reexport */ BoundingBox),\n  \"C4F\": () => (/* reexport */ BroadphaseStrategy),\n  \"NQt\": () => (/* reexport */ BrowserComponent),\n  \"JjN\": () => (/* reexport */ BrowserEvents),\n  \"V1s\": () => (/* reexport */ Camera),\n  \"Xz7\": () => (/* reexport */ Canvas),\n  \"Cdc\": () => (/* reexport */ Circle),\n  \"FKn\": () => (/* reexport */ CircleCollider),\n  \"wTW\": () => (/* reexport */ Class),\n  \"SUY\": () => (/* reexport */ Clock),\n  \"ab2\": () => (/* reexport */ ClosestLine),\n  \"GfZ\": () => (/* reexport */ ClosestLineJumpTable),\n  \"YMS\": () => (/* reexport */ Collider),\n  \"oyv\": () => (/* reexport */ ColliderComponent),\n  \"aUb\": () => (/* reexport */ CollisionContact),\n  \"SdD\": () => (/* reexport */ CollisionEndEvent),\n  \"JUv\": () => (/* reexport */ CollisionGroup),\n  \"jEj\": () => (/* reexport */ CollisionGroupManager),\n  \"TFq\": () => (/* reexport */ CollisionJumpTable),\n  \"HDU\": () => (/* reexport */ CollisionPostSolveEvent),\n  \"R_y\": () => (/* reexport */ CollisionPreSolveEvent),\n  \"ydN\": () => (/* reexport */ CollisionResolutionStrategy),\n  \"t50\": () => (/* reexport */ CollisionStartEvent),\n  \"s$$\": () => (/* reexport */ CollisionSystem),\n  \"v2G\": () => (/* reexport */ CollisionType),\n  \"Ilk\": () => (/* reexport */ Color),\n  \"s9i\": () => (/* reexport */ ColorBlindFlags),\n  \"dxL\": () => (/* reexport */ ColorBlindnessMode),\n  \"LLX\": () => (/* reexport */ ColorBlindnessPostProcessor),\n  \"wA2\": () => (/* reexport */ Component),\n  \"R_p\": () => (/* reexport */ CompositeCollider),\n  \"IQ$\": () => (/* reexport */ Configurable),\n  \"I5F\": () => (/* reexport */ ConsoleAppender),\n  \"X8$\": () => (/* reexport */ ContactConstraintPoint),\n  \"FR6\": () => (/* reexport */ ContactEndEvent),\n  \"U8o\": () => (/* reexport */ ContactStartEvent),\n  \"kbG\": () => (/* reexport */ CoordPlane),\n  \"iS_\": () => (/* reexport */ DeactivateEvent),\n  \"cGG\": () => (/* reexport */ Debug),\n  \"RPN\": () => (/* reexport */ DebugGraphicsComponent),\n  \"skb\": () => (/* reexport */ DebugSystem),\n  \"SLU\": () => (/* reexport */ DebugText),\n  \"RdJ\": () => (/* reexport */ DegreeOfFreedom),\n  \"cNu\": () => (/* reexport */ Delay),\n  \"gU7\": () => (/* reexport */ Detector),\n  \"LSk\": () => (/* reexport */ Die),\n  \"Nmp\": () => (/* reexport */ Direction),\n  \"d1Y\": () => (/* reexport */ DisplayMode),\n  \"xrL\": () => (/* reexport */ DynamicTree),\n  \"sRW\": () => (/* reexport */ DynamicTreeCollisionProcessor),\n  \"cmV\": () => (/* binding */ EX_VERSION),\n  \"qWz\": () => (/* reexport */ EaseBy),\n  \"N0Q\": () => (/* reexport */ EaseTo),\n  \"q8b\": () => (/* reexport */ EasingFunctions),\n  \"ynB\": () => (/* reexport */ EdgeCollider),\n  \"jT9\": () => (/* reexport */ ElasticToActorStrategy),\n  \"wAz\": () => (/* reexport */ EmitterType),\n  \"D4V\": () => (/* reexport */ Engine),\n  \"N6H\": () => (/* reexport */ EnterTriggerEvent),\n  \"W1A\": () => (/* reexport */ EnterViewPortEvent),\n  \"JHW\": () => (/* reexport */ Entity),\n  \"v2K\": () => (/* reexport */ EntityManager),\n  \"pBf\": () => (/* reexport */ EventDispatcher),\n  \"GMl\": () => (/* reexport */ EventTypes),\n  \"zW2\": () => (/* reexport */ Events_namespaceObject),\n  \"B0K\": () => (/* reexport */ ExResponse),\n  \"Nv7\": () => (/* reexport */ ExcaliburGraphicsContext2DCanvas),\n  \"C_p\": () => (/* reexport */ ExcaliburGraphicsContextWebGL),\n  \"iqw\": () => (/* reexport */ ExcaliburWebGLContextAccessor),\n  \"MUA\": () => (/* reexport */ ExitTriggerEvent),\n  \"xqU\": () => (/* reexport */ ExitViewPortEvent),\n  \"pTp\": () => (/* reexport */ Fade),\n  \"vUK\": () => (/* reexport */ Flags),\n  \"j9l\": () => (/* reexport */ Follow),\n  \"Zxw\": () => (/* reexport */ Font),\n  \"Hdx\": () => (/* reexport */ FontStyle),\n  \"Z$d\": () => (/* reexport */ FontUnit),\n  \"iqV\": () => (/* reexport */ FpsSampler),\n  \"o$7\": () => (/* reexport */ FrameStats),\n  \"olM\": () => (/* reexport */ Future),\n  \"Zm$\": () => (/* reexport */ GameEvent),\n  \"$QH\": () => (/* reexport */ GameStartEvent),\n  \"i78\": () => (/* reexport */ GameStopEvent),\n  \"h6u\": () => (/* reexport */ GamepadAxisEvent),\n  \"hts\": () => (/* reexport */ GamepadButtonEvent),\n  \"j88\": () => (/* reexport */ GamepadConnectEvent),\n  \"VME\": () => (/* reexport */ GamepadDisconnectEvent),\n  \"nt\": () => (/* reexport */ Gif),\n  \"Ukr\": () => (/* reexport */ GlobalCoordinates),\n  \"zsu\": () => (/* reexport */ Graphic),\n  \"oA6\": () => (/* reexport */ GraphicsComponent),\n  \"TVh\": () => (/* reexport */ GraphicsGroup),\n  \"TwZ\": () => (/* reexport */ GraphicsLayer),\n  \"GTT\": () => (/* reexport */ GraphicsLayers),\n  \"xxj\": () => (/* reexport */ GraphicsSystem),\n  \"XdK\": () => (/* reexport */ HiddenEvent),\n  \"Jmb\": () => (/* reexport */ ImageFiltering),\n  \"cXo\": () => (/* reexport */ ImageSource),\n  \"Dm5\": () => (/* reexport */ InitializeEvent),\n  \"IIB\": () => (/* reexport */ Input_Index_namespaceObject),\n  \"zI0\": () => (/* reexport */ Integrator),\n  \"LYD\": () => (/* reexport */ IsometricEntityComponent),\n  \"cEG\": () => (/* reexport */ IsometricEntitySystem),\n  \"SEl\": () => (/* reexport */ IsometricMap),\n  \"t9V\": () => (/* reexport */ IsometricTile),\n  \"SKZ\": () => (/* reexport */ KillEvent),\n  \"__J\": () => (/* reexport */ Label),\n  \"RI$\": () => (/* reexport */ LimitCameraBoundsStrategy),\n  \"x12\": () => (/* reexport */ Line),\n  \"ccz\": () => (/* reexport */ LineSegment),\n  \"aNw\": () => (/* reexport */ Loader),\n  \"xwn\": () => (/* reexport */ LockCameraToActorAxisStrategy),\n  \"dNK\": () => (/* reexport */ LockCameraToActorStrategy),\n  \"ini\": () => (/* reexport */ LogLevel),\n  \"YdH\": () => (/* reexport */ Logger),\n  \"y3G\": () => (/* reexport */ Matrix),\n  \"l57\": () => (/* reexport */ MatrixLocations),\n  \"xn0\": () => (/* reexport */ MediaEvent),\n  \"t2V\": () => (/* reexport */ Meet),\n  \"uxB\": () => (/* reexport */ MotionComponent),\n  \"cpd\": () => (/* reexport */ MotionSystem),\n  \"fiy\": () => (/* reexport */ MoveBy),\n  \"$XZ\": () => (/* reexport */ MoveTo),\n  \"uqK\": () => (/* reexport */ NativeSoundEvent),\n  \"STE\": () => (/* reexport */ NativeSoundProcessedEvent),\n  \"y$z\": () => (/* reexport */ Observable),\n  \"mAD\": () => (/* reexport */ OffscreenSystem),\n  \"sOq\": () => (/* reexport */ Pair),\n  \"hUw\": () => (/* reexport */ ParallaxComponent),\n  \"_0G\": () => (/* reexport */ ParallelActions),\n  \"Sqs\": () => (/* reexport */ ParseGif),\n  \"hpZ\": () => (/* reexport */ Particle),\n  \"Vol\": () => (/* reexport */ ParticleEmitter),\n  \"wIZ\": () => (/* reexport */ Physics),\n  \"cBi\": () => (/* reexport */ PhysicsStats),\n  \"RFv\": () => (/* reexport */ PointerComponent),\n  \"kfC\": () => (/* reexport */ PointerSystem),\n  \"mgq\": () => (/* reexport */ Polygon),\n  \"YVA\": () => (/* reexport */ PolygonCollider),\n  \"Kgp\": () => (/* reexport */ Pool),\n  \"HH$\": () => (/* reexport */ PostCollisionEvent),\n  \"M_d\": () => (/* reexport */ PostDebugDrawEvent),\n  \"rgh\": () => (/* reexport */ PostDrawEvent),\n  \"Ra6\": () => (/* reexport */ PostFrameEvent),\n  \"KhR\": () => (/* reexport */ PostKillEvent),\n  \"BS5\": () => (/* reexport */ PostUpdateEvent),\n  \"xhz\": () => (/* reexport */ PreCollisionEvent),\n  \"xOq\": () => (/* reexport */ PreDebugDrawEvent),\n  \"a9j\": () => (/* reexport */ PreDrawEvent),\n  \"bHk\": () => (/* reexport */ PreFrameEvent),\n  \"CgK\": () => (/* reexport */ PreKillEvent),\n  \"cuY\": () => (/* reexport */ PreUpdateEvent),\n  \"kvE\": () => (/* reexport */ Projection),\n  \"SBu\": () => (/* reexport */ QuadIndexBuffer),\n  \"AE_\": () => (/* reexport */ Query),\n  \"ctO\": () => (/* reexport */ QueryManager),\n  \"OLH\": () => (/* reexport */ RadiusAroundActorStrategy),\n  \"kky\": () => (/* reexport */ Random),\n  \"nSF\": () => (/* reexport */ Raster),\n  \"zHn\": () => (/* reexport */ Ray),\n  \"zwx\": () => (/* reexport */ RealisticSolver),\n  \"AeJ\": () => (/* reexport */ Rectangle),\n  \"hLz\": () => (/* reexport */ RemovedComponent),\n  \"D9g\": () => (/* reexport */ RemovedEntity),\n  \"wA\": () => (/* reexport */ Repeat),\n  \"jhr\": () => (/* reexport */ RepeatForever),\n  \"GVs\": () => (/* reexport */ Resolution),\n  \"_zO\": () => (/* reexport */ Resource),\n  \"w6$\": () => (/* reexport */ RotateBy),\n  \"mhV\": () => (/* reexport */ RotateTo),\n  \"MOD\": () => (/* reexport */ RotationType),\n  \"kwd\": () => (/* reexport */ ScaleBy),\n  \"Lmr\": () => (/* reexport */ ScaleTo),\n  \"xsS\": () => (/* reexport */ Scene),\n  \"lLr\": () => (/* reexport */ Screen),\n  \"Z$r\": () => (/* reexport */ ScreenAppender),\n  \"IXb\": () => (/* reexport */ ScreenElement),\n  \"SGH\": () => (/* reexport */ ScreenShader),\n  \"SMj\": () => (/* reexport */ ScrollPreventionMode),\n  \"L34\": () => (/* reexport */ Semaphore),\n  \"exe\": () => (/* reexport */ Shader),\n  \"bnF\": () => (/* reexport */ Shape),\n  \"MFA\": () => (/* reexport */ Side),\n  \"$uU\": () => (/* reexport */ Sound),\n  \"jyi\": () => (/* reexport */ Sprite),\n  \"E03\": () => (/* reexport */ SpriteFont),\n  \"V6q\": () => (/* reexport */ SpriteSheet),\n  \"rg2\": () => (/* reexport */ StandardClock),\n  \"DVW\": () => (/* reexport */ StateMachine),\n  \"nVo\": () => (/* reexport */ StrategyContainer),\n  \"F6N\": () => (/* reexport */ Stream),\n  \"xP7\": () => (/* reexport */ System),\n  \"Odq\": () => (/* reexport */ SystemManager),\n  \"Zif\": () => (/* reexport */ SystemType),\n  \"ZGJ\": () => (/* reexport */ TagComponent),\n  \"MJk\": () => (/* reexport */ TestClock),\n  \"xvT\": () => (/* reexport */ Text),\n  \"PHM\": () => (/* reexport */ TextAlign),\n  \"dpR\": () => (/* reexport */ TextureLoader),\n  \"n9L\": () => (/* reexport */ Tile),\n  \"KwO\": () => (/* reexport */ TileMap),\n  \"B7y\": () => (/* reexport */ Timer),\n  \"x7r\": () => (/* reexport */ Toaster),\n  \"wx7\": () => (/* reexport */ Transform),\n  \"Uvn\": () => (/* reexport */ TransformComponent),\n  \"OFT\": () => (/* reexport */ TreeNode),\n  \"xzN\": () => (/* reexport */ Trigger),\n  \"M5Z\": () => (/* reexport */ TwoPI),\n  \"ZrN\": () => (/* reexport */ Util_Index_namespaceObject),\n  \"OWs\": () => (/* reexport */ Vector),\n  \"dF9\": () => (/* reexport */ VectorView),\n  \"oZy\": () => (/* reexport */ VertexBuffer),\n  \"rD2\": () => (/* reexport */ VertexLayout),\n  \"VHo\": () => (/* reexport */ VisibleEvent),\n  \"ohE\": () => (/* reexport */ WebAudio),\n  \"R$E\": () => (/* reexport */ WebAudioInstance),\n  \"q3I\": () => (/* reexport */ World),\n  \"Pab\": () => (/* reexport */ canonicalizeAngle),\n  \"uZ5\": () => (/* reexport */ clamp),\n  \"McK\": () => (/* reexport */ createId),\n  \"F9c\": () => (/* reexport */ frac),\n  \"k0b\": () => (/* reexport */ hasGraphicsTick),\n  \"hnT\": () => (/* reexport */ hasOnInitialize),\n  \"RSJ\": () => (/* reexport */ hasOnPostUpdate),\n  \"Mku\": () => (/* reexport */ hasOnPreUpdate),\n  \"h90\": () => (/* reexport */ hasPostDraw),\n  \"rms\": () => (/* reexport */ hasPreDraw),\n  \"ErP\": () => (/* reexport */ has_initialize),\n  \"aVg\": () => (/* reexport */ has_postupdate),\n  \"lPc\": () => (/* reexport */ has_preupdate),\n  \"Z8E\": () => (/* reexport */ isAddedComponent),\n  \"_N2\": () => (/* reexport */ isAddedSystemEntity),\n  \"yFn\": () => (/* reexport */ isRemoveSystemEntity),\n  \"lNv\": () => (/* reexport */ isRemovedComponent),\n  \"cu9\": () => (/* reexport */ isScreenElement),\n  \"MZQ\": () => (/* reexport */ maxMessages),\n  \"FUM\": () => (/* reexport */ obsolete),\n  \"BxR\": () => (/* reexport */ pixelSnapEpsilon),\n  \"vdf\": () => (/* reexport */ randomInRange),\n  \"iaL\": () => (/* reexport */ randomIntInRange),\n  \"w6H\": () => (/* reexport */ range),\n  \"Q4c\": () => (/* reexport */ resetObsoleteCounter),\n  \"Xxe\": () => (/* reexport */ sign),\n  \"Uxb\": () => (/* reexport */ toDegrees),\n  \"Yr5\": () => (/* reexport */ toRadians),\n  \"Bhw\": () => (/* reexport */ vec),\n  \"yOA\": () => (/* reexport */ webgl_util_namespaceObject)\n});\n\n// NAMESPACE OBJECT: ./Events.ts\nvar Events_namespaceObject = {};\n__webpack_require__.r(Events_namespaceObject);\n__webpack_require__.d(Events_namespaceObject, {\n  \"ActivateEvent\": () => (ActivateEvent),\n  \"CollisionEndEvent\": () => (CollisionEndEvent),\n  \"CollisionPostSolveEvent\": () => (CollisionPostSolveEvent),\n  \"CollisionPreSolveEvent\": () => (CollisionPreSolveEvent),\n  \"CollisionStartEvent\": () => (CollisionStartEvent),\n  \"ContactEndEvent\": () => (ContactEndEvent),\n  \"ContactStartEvent\": () => (ContactStartEvent),\n  \"DeactivateEvent\": () => (DeactivateEvent),\n  \"EnterTriggerEvent\": () => (EnterTriggerEvent),\n  \"EnterViewPortEvent\": () => (EnterViewPortEvent),\n  \"EventTypes\": () => (EventTypes),\n  \"ExitTriggerEvent\": () => (ExitTriggerEvent),\n  \"ExitViewPortEvent\": () => (ExitViewPortEvent),\n  \"GameEvent\": () => (GameEvent),\n  \"GameStartEvent\": () => (GameStartEvent),\n  \"GameStopEvent\": () => (GameStopEvent),\n  \"GamepadAxisEvent\": () => (GamepadAxisEvent),\n  \"GamepadButtonEvent\": () => (GamepadButtonEvent),\n  \"GamepadConnectEvent\": () => (GamepadConnectEvent),\n  \"GamepadDisconnectEvent\": () => (GamepadDisconnectEvent),\n  \"HiddenEvent\": () => (HiddenEvent),\n  \"InitializeEvent\": () => (InitializeEvent),\n  \"KillEvent\": () => (KillEvent),\n  \"PostCollisionEvent\": () => (PostCollisionEvent),\n  \"PostDebugDrawEvent\": () => (PostDebugDrawEvent),\n  \"PostDrawEvent\": () => (PostDrawEvent),\n  \"PostFrameEvent\": () => (PostFrameEvent),\n  \"PostKillEvent\": () => (PostKillEvent),\n  \"PostUpdateEvent\": () => (PostUpdateEvent),\n  \"PreCollisionEvent\": () => (PreCollisionEvent),\n  \"PreDebugDrawEvent\": () => (PreDebugDrawEvent),\n  \"PreDrawEvent\": () => (PreDrawEvent),\n  \"PreFrameEvent\": () => (PreFrameEvent),\n  \"PreKillEvent\": () => (PreKillEvent),\n  \"PreUpdateEvent\": () => (PreUpdateEvent),\n  \"VisibleEvent\": () => (VisibleEvent)\n});\n\n// NAMESPACE OBJECT: ./Graphics/Context/webgl-util.ts\nvar webgl_util_namespaceObject = {};\n__webpack_require__.r(webgl_util_namespaceObject);\n__webpack_require__.d(webgl_util_namespaceObject, {\n  \"getAttributeComponentSize\": () => (getAttributeComponentSize),\n  \"getAttributePointerType\": () => (getAttributePointerType),\n  \"getGlTypeSizeBytes\": () => (getGlTypeSizeBytes)\n});\n\n// NAMESPACE OBJECT: ./Util/DrawUtil.ts\nvar DrawUtil_namespaceObject = {};\n__webpack_require__.r(DrawUtil_namespaceObject);\n__webpack_require__.d(DrawUtil_namespaceObject, {\n  \"circle\": () => (circle),\n  \"line\": () => (line),\n  \"point\": () => (point),\n  \"roundRect\": () => (roundRect),\n  \"vector\": () => (vector)\n});\n\n// NAMESPACE OBJECT: ./Input/Index.ts\nvar Input_Index_namespaceObject = {};\n__webpack_require__.r(Input_Index_namespaceObject);\n__webpack_require__.d(Input_Index_namespaceObject, {\n  \"Axes\": () => (Axes),\n  \"Buttons\": () => (Buttons),\n  \"Gamepad\": () => (Gamepad),\n  \"Gamepads\": () => (Gamepads),\n  \"KeyEvent\": () => (KeyEvent),\n  \"Keyboard\": () => (Keyboard),\n  \"Keys\": () => (Keys),\n  \"NativePointerButton\": () => (NativePointerButton),\n  \"PointerButton\": () => (PointerButton),\n  \"PointerComponent\": () => (PointerComponent),\n  \"PointerEvent\": () => (PointerEvent),\n  \"PointerEventReceiver\": () => (PointerEventReceiver),\n  \"PointerScope\": () => (PointerScope),\n  \"PointerSystem\": () => (PointerSystem),\n  \"PointerType\": () => (PointerType),\n  \"WheelDeltaMode\": () => (WheelDeltaMode),\n  \"WheelEvent\": () => (WheelEvent)\n});\n\n// NAMESPACE OBJECT: ./Util/Index.ts\nvar Util_Index_namespaceObject = {};\n__webpack_require__.r(Util_Index_namespaceObject);\n__webpack_require__.d(Util_Index_namespaceObject, {\n  \"ConsoleAppender\": () => (ConsoleAppender),\n  \"DrawUtil\": () => (DrawUtil_namespaceObject),\n  \"EasingFunctions\": () => (EasingFunctions),\n  \"LogLevel\": () => (LogLevel),\n  \"Logger\": () => (Logger),\n  \"Observable\": () => (Observable),\n  \"ScreenAppender\": () => (ScreenAppender),\n  \"addItemToArray\": () => (addItemToArray),\n  \"contains\": () => (contains),\n  \"delay\": () => (delay),\n  \"fail\": () => (fail),\n  \"getPosition\": () => (getPosition),\n  \"removeItemFromArray\": () => (removeItemFromArray)\n});\n\n// EXTERNAL MODULE: ../../node_modules/core-js/es/array/sort.js\nvar sort = __webpack_require__(4662);\n// EXTERNAL MODULE: ../../node_modules/core-js/es/object/keys.js\nvar keys = __webpack_require__(8343);\n;// CONCATENATED MODULE: ./Polyfill.ts\n\r\n\r\n/**\r\n * Polyfill adding function\r\n */\r\nfunction polyfill() {\r\n    /* istanbul ignore next */\r\n    if (typeof window === 'undefined') {\r\n        window = {\r\n            audioContext: function () {\r\n                return;\r\n            }\r\n        };\r\n    }\r\n    /* istanbul ignore next */\r\n    if (typeof window !== 'undefined' && !window.requestAnimationFrame) {\r\n        window.requestAnimationFrame =\r\n            window.webkitRequestAnimationFrame ||\r\n                window.mozRequestAnimationFrame ||\r\n                function (callback) {\r\n                    window.setInterval(callback, 1000 / 60);\r\n                };\r\n    }\r\n    /* istanbul ignore next */\r\n    if (typeof window !== 'undefined' && !window.cancelAnimationFrame) {\r\n        window.cancelAnimationFrame =\r\n            window.webkitCancelAnimationFrame ||\r\n                window.mozCancelAnimationFrame ||\r\n                function () {\r\n                    return;\r\n                };\r\n    }\r\n    /* istanbul ignore next */\r\n    if (typeof window !== 'undefined' && !window.AudioContext) {\r\n        if (window.webkitAudioContext) {\r\n            const ctx = window.webkitAudioContext;\r\n            const replaceMe = ctx.prototype.decodeAudioData;\r\n            window.webkitAudioContext.prototype.decodeAudioData = function (arrayBuffer) {\r\n                return new Promise((resolve, reject) => {\r\n                    replaceMe.call(this, arrayBuffer, resolve, reject);\r\n                });\r\n            };\r\n        }\r\n        window.AudioContext =\r\n            window.AudioContext ||\r\n                window.webkitAudioContext ||\r\n                window.mozAudioContext ||\r\n                window.msAudioContext ||\r\n                window.oAudioContext;\r\n    }\r\n    /* istanbul ignore next */\r\n    if (typeof window !== 'undefined' && !window.devicePixelRatio) {\r\n        window.devicePixelRatio = window.devicePixelRatio || 1;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Flags.ts\n/**\r\n * Flags is a feature flag implementation for Excalibur. They can only be operated **before [[Engine]] construction**\r\n * after which they are frozen and are read-only.\r\n *\r\n * Flags are used to enable experimental or preview features in Excalibur.\r\n */\r\nclass Flags {\r\n    /**\r\n     * Force excalibur to load the Canvas 2D graphics context fallback\r\n     *\r\n     * @warning not all features of excalibur are supported in the Canvas 2D fallback\r\n     */\r\n    static useCanvasGraphicsContext() {\r\n        Flags.enable('use-canvas-context');\r\n    }\r\n    /**\r\n     * Freeze all flag modifications making them readonly\r\n     */\r\n    static freeze() {\r\n        Flags._FROZEN = true;\r\n    }\r\n    /**\r\n     * Resets internal flag state, not meant to be called by users. Only used for testing.\r\n     *\r\n     * Calling this in your game is UNSUPPORTED\r\n     * @internal\r\n     */\r\n    static _reset() {\r\n        Flags._FROZEN = false;\r\n        Flags._FLAGS = {};\r\n    }\r\n    /**\r\n     * Enable a specific feature flag by name. **Note: can only be set before [[Engine]] constructor time**\r\n     * @param flagName\r\n     */\r\n    static enable(flagName) {\r\n        if (this._FROZEN) {\r\n            throw Error('Feature flags can only be enabled before Engine constructor time');\r\n        }\r\n        Flags._FLAGS[flagName] = true;\r\n    }\r\n    /**\r\n     * Disable a specific feature flag by name. **Note: can only be set before [[Engine]] constructor time**\r\n     * @param flagName\r\n     */\r\n    static disable(flagName) {\r\n        if (this._FROZEN) {\r\n            throw Error('Feature flags can only be disabled before Engine constructor time');\r\n        }\r\n        Flags._FLAGS[flagName] = false;\r\n    }\r\n    /**\r\n     * Check if a flag is enabled. If the flag is disabled or does not exist `false` is returned\r\n     * @param flagName\r\n     */\r\n    static isEnabled(flagName) {\r\n        return !!Flags._FLAGS[flagName];\r\n    }\r\n    /**\r\n     * Show a list of currently known flags\r\n     */\r\n    static show() {\r\n        return Object.keys(Flags._FLAGS);\r\n    }\r\n}\r\nFlags._FROZEN = false;\r\nFlags._FLAGS = {};\r\n\n;// CONCATENATED MODULE: ./Id.ts\n/**\r\n * Create a branded ID type from a number\r\n */\r\nfunction createId(type, value) {\r\n    return { type, value };\r\n}\r\n;\r\n\n;// CONCATENATED MODULE: ./Math/Random.ts\n/**\r\n * @module\r\n * Pseudo-Random Utility\r\n *\r\n * A pseudo-random utility to add seeded random support for help in\r\n * generating things like terrain or reproducible randomness. Uses the\r\n * [Mersenne Twister](https://en.wikipedia.org/wiki/Mersenne_Twister) algorithm.\r\n */\r\n/**\r\n * 32-bit mask\r\n */\r\nconst BITMASK32 = 0xffffffff;\r\n/**\r\n * Pseudo-random number generator following the Mersenne_Twister algorithm. Given a seed this generator will produce the same sequence\r\n * of numbers each time it is called.\r\n * See https://en.wikipedia.org/wiki/Mersenne_Twister for more details.\r\n * Uses the MT19937-32 (2002) implementation documented here http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/MT2002/emt19937ar.html\r\n *\r\n * Api inspired by http://chancejs.com/# https://github.com/chancejs/chancejs\r\n */\r\nclass Random {\r\n    /**\r\n     * If no seed is specified, the Date.now() is used\r\n     */\r\n    constructor(seed) {\r\n        this.seed = seed;\r\n        // Separation point of one one word, the number of bits in the lower bitmask 0 <= r <= w-1\r\n        this._lowerMask = 0x7fffffff; // 31 bits same as _r\r\n        this._upperMask = 0x80000000; // 34 high bits\r\n        // Word size, 64 bits\r\n        this._w = 32;\r\n        // Degree of recurrence\r\n        this._n = 624;\r\n        // Middle word, an offset used in the recurrence defining the series x, 1<=m<n\r\n        this._m = 397;\r\n        // coefficients of teh rational normal form twist matrix\r\n        this._a = 0x9908b0df;\r\n        // tempering bit shifts and masks\r\n        this._u = 11;\r\n        this._s = 7;\r\n        this._b = 0x9d2c5680;\r\n        this._t = 15;\r\n        this._c = 0xefc60000;\r\n        this._l = 18;\r\n        this._f = 1812433253;\r\n        this._mt = new Array(this._n);\r\n        // need to mask to support higher bit machines\r\n        this._mt[0] = (seed || Date.now()) >>> 0;\r\n        for (let i = 1; i < this._n; i++) {\r\n            const s = this._mt[i - 1] ^ (this._mt[i - 1] >>> (this._w - 2));\r\n            // numbers are bigger than the JS max safe int, add in 16-bit chunks to prevent IEEE rounding errors on high bits\r\n            this._mt[i] = (((this._f * ((s & 0xffff0000) >>> 16)) << 16) + this._f * (s & 0xffff) + i) >>> 0;\r\n        }\r\n        this._index = this._n;\r\n    }\r\n    /**\r\n     * Apply the twist\r\n     */\r\n    _twist() {\r\n        const mag01 = [0x0, this._a];\r\n        let y = 0, i = 0;\r\n        for (; i < this._n - this._m; i++) {\r\n            y = (this._mt[i] & this._upperMask) | (this._mt[i + 1] & this._lowerMask);\r\n            this._mt[i] = this._mt[i + this._m] ^ (y >>> 1) ^ (mag01[y & 0x1] & BITMASK32);\r\n        }\r\n        for (; i < this._n - 1; i++) {\r\n            y = (this._mt[i] & this._upperMask) | (this._mt[i + 1] & this._lowerMask);\r\n            this._mt[i] = this._mt[i + (this._m - this._n)] ^ (y >>> 1) ^ (mag01[y & 0x1] & BITMASK32);\r\n        }\r\n        y = (this._mt[this._n - 1] & this._upperMask) | (this._mt[0] & this._lowerMask);\r\n        this._mt[this._n - 1] = this._mt[this._m - 1] ^ (y >>> 1) ^ (mag01[y & 0x1] & BITMASK32);\r\n        this._index = 0;\r\n    }\r\n    /**\r\n     * Return next 32 bit integer number in sequence\r\n     */\r\n    nextInt() {\r\n        if (this._index >= this._n) {\r\n            this._twist();\r\n        }\r\n        let y = this._mt[this._index++];\r\n        y ^= y >>> this._u;\r\n        y ^= (y << this._s) & this._b;\r\n        y ^= (y << this._t) & this._c;\r\n        y ^= y >>> this._l;\r\n        return y >>> 0;\r\n    }\r\n    /**\r\n     * Return a random floating point number between [0, 1)\r\n     */\r\n    next() {\r\n        return this.nextInt() * (1.0 / 4294967296.0); // divided by 2^32\r\n    }\r\n    /**\r\n     * Return a random floating point in range [min, max) min is included, max is not included\r\n     */\r\n    floating(min, max) {\r\n        return (max - min) * this.next() + min;\r\n    }\r\n    /**\r\n     * Return a random integer in range [min, max] min is included, max is included.\r\n     * Implemented with rejection sampling, see https://medium.com/@betable/tifu-by-using-math-random-f1c308c4fd9d#.i13tdiu5a\r\n     */\r\n    integer(min, max) {\r\n        return Math.floor((max - min + 1) * this.next() + min);\r\n    }\r\n    /**\r\n     * Returns true or false randomly with 50/50 odds by default.\r\n     * By default the likelihood of returning a true is .5 (50%).\r\n     * @param likelihood takes values between [0, 1]\r\n     */\r\n    bool(likelihood = 0.5) {\r\n        return this.next() <= likelihood;\r\n    }\r\n    /**\r\n     * Returns one element from an array at random\r\n     */\r\n    pickOne(array) {\r\n        return array[this.integer(0, array.length - 1)];\r\n    }\r\n    /**\r\n     * Returns a new array random picking elements from the original\r\n     * @param array Original array to pick from\r\n     * @param numPicks can be any positive number\r\n     * @param allowDuplicates indicates whether the returned set is allowed duplicates (it does not mean there will always be duplicates\r\n     * just that it is possible)\r\n     */\r\n    pickSet(array, numPicks, allowDuplicates = false) {\r\n        if (allowDuplicates) {\r\n            return this._pickSetWithDuplicates(array, numPicks);\r\n        }\r\n        else {\r\n            return this._pickSetWithoutDuplicates(array, numPicks);\r\n        }\r\n    }\r\n    /**\r\n     * Returns a new array randomly picking elements in the original (not reused)\r\n     * @param array Array to pick elements out of\r\n     * @param numPicks must be less than or equal to the number of elements in the array.\r\n     */\r\n    _pickSetWithoutDuplicates(array, numPicks) {\r\n        if (numPicks > array.length || numPicks < 0) {\r\n            throw new Error('Invalid number of elements to pick, must pick a value 0 < n <= length');\r\n        }\r\n        if (numPicks === array.length) {\r\n            return array;\r\n        }\r\n        const result = new Array(numPicks);\r\n        let currentPick = 0;\r\n        const tempArray = array.slice(0);\r\n        while (currentPick < numPicks) {\r\n            const index = this.integer(0, tempArray.length - 1);\r\n            result[currentPick++] = tempArray[index];\r\n            tempArray.splice(index, 1);\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Returns a new array random picking elements from the original allowing duplicates\r\n     * @param array Array to pick elements out of\r\n     * @param numPicks can be any positive number\r\n     */\r\n    _pickSetWithDuplicates(array, numPicks) {\r\n        // Typescript numbers are all floating point, so do we add check for int? (or floor the input?)\r\n        if (numPicks < 0) {\r\n            throw new Error('Invalid number of elements to pick, must pick a value 0 <= n < MAX_INT');\r\n        }\r\n        const result = new Array(numPicks);\r\n        for (let i = 0; i < numPicks; i++) {\r\n            result[i] = this.pickOne(array);\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Returns a new array that has its elements shuffled. Using the Fisher/Yates method\r\n     * https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle\r\n     */\r\n    shuffle(array) {\r\n        const tempArray = array.slice(0);\r\n        let swap = null;\r\n        for (let i = 0; i < tempArray.length - 2; i++) {\r\n            const randomIndex = this.integer(i, tempArray.length - 1);\r\n            swap = tempArray[i];\r\n            tempArray[i] = tempArray[randomIndex];\r\n            tempArray[randomIndex] = swap;\r\n        }\r\n        return tempArray;\r\n    }\r\n    /**\r\n     * Generate a list of random integer numbers\r\n     * @param length the length of the final array\r\n     * @param min the minimum integer number to generate inclusive\r\n     * @param max the maximum integer number to generate inclusive\r\n     */\r\n    range(length, min, max) {\r\n        const result = new Array(length);\r\n        for (let i = 0; i < length; i++) {\r\n            result[i] = this.integer(min, max);\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Returns the result of a d4 dice roll\r\n     */\r\n    d4() {\r\n        return this.integer(1, 4);\r\n    }\r\n    /**\r\n     * Returns the result of a d6 dice roll\r\n     */\r\n    d6() {\r\n        return this.integer(1, 6);\r\n    }\r\n    /**\r\n     * Returns the result of a d8 dice roll\r\n     */\r\n    d8() {\r\n        return this.integer(1, 8);\r\n    }\r\n    /**\r\n     * Returns the result of a d10 dice roll\r\n     */\r\n    d10() {\r\n        return this.integer(1, 10);\r\n    }\r\n    /**\r\n     * Returns the result of a d12 dice roll\r\n     */\r\n    d12() {\r\n        return this.integer(1, 12);\r\n    }\r\n    /**\r\n     * Returns the result of a d20 dice roll\r\n     */\r\n    d20() {\r\n        return this.integer(1, 20);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/util.ts\n\r\n/**\r\n * Two PI constant\r\n */\r\nconst TwoPI = Math.PI * 2;\r\n/**\r\n * Returns the fractional part of a number\r\n * @param x\r\n */\r\nfunction frac(x) {\r\n    if (x >= 0) {\r\n        return x - Math.floor(x);\r\n    }\r\n    else {\r\n        return x - Math.ceil(x);\r\n    }\r\n}\r\n/**\r\n * Returns the sign of a number, if 0 returns 0\r\n */\r\nfunction sign(val) {\r\n    if (val === 0) {\r\n        return 0;\r\n    }\r\n    return val < 0 ? -1 : 1;\r\n}\r\n;\r\n/**\r\n * Clamps a value between a min and max inclusive\r\n */\r\nfunction clamp(val, min, max) {\r\n    return Math.min(Math.max(min, val), max);\r\n}\r\n/**\r\n * Convert an angle to be the equivalent in the range [0, 2PI]\r\n */\r\nfunction canonicalizeAngle(angle) {\r\n    let tmpAngle = angle;\r\n    if (angle > TwoPI) {\r\n        while (tmpAngle > TwoPI) {\r\n            tmpAngle -= TwoPI;\r\n        }\r\n    }\r\n    if (angle < 0) {\r\n        while (tmpAngle < 0) {\r\n            tmpAngle += TwoPI;\r\n        }\r\n    }\r\n    return tmpAngle;\r\n}\r\n/**\r\n * Convert radians to degrees\r\n */\r\nfunction toDegrees(radians) {\r\n    return (180 / Math.PI) * radians;\r\n}\r\n/**\r\n * Convert degrees to radians\r\n */\r\nfunction toRadians(degrees) {\r\n    return (degrees / 180) * Math.PI;\r\n}\r\n/**\r\n * Generate a range of numbers\r\n * For example: range(0, 5) -> [0, 1, 2, 3, 4, 5]\r\n * @param from inclusive\r\n * @param to inclusive\r\n */\r\nconst range = (from, to) => Array.from(new Array(to - from + 1), (_x, i) => i + from);\r\n/**\r\n * Find a random floating point number in range\r\n */\r\nfunction randomInRange(min, max, random = new Random()) {\r\n    return random ? random.floating(min, max) : min + Math.random() * (max - min);\r\n}\r\n/**\r\n * Find a random integer in a range\r\n */\r\nfunction randomIntInRange(min, max, random = new Random()) {\r\n    return random ? random.integer(min, max) : Math.round(randomInRange(min, max));\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/vector.ts\n\r\n/**\r\n * A 2D vector on a plane.\r\n */\r\nclass Vector {\r\n    /**\r\n     * @param x  X component of the Vector\r\n     * @param y  Y component of the Vector\r\n     */\r\n    constructor(x, y) {\r\n        this._x = 0;\r\n        this._y = 0;\r\n        this._x = x;\r\n        this._y = y;\r\n    }\r\n    /**\r\n     * A (0, 0) vector\r\n     */\r\n    static get Zero() {\r\n        return new Vector(0, 0);\r\n    }\r\n    /**\r\n     * A (1, 1) vector\r\n     */\r\n    static get One() {\r\n        return new Vector(1, 1);\r\n    }\r\n    /**\r\n     * A (0.5, 0.5) vector\r\n     */\r\n    static get Half() {\r\n        return new Vector(0.5, 0.5);\r\n    }\r\n    /**\r\n     * A unit vector pointing up (0, -1)\r\n     */\r\n    static get Up() {\r\n        return new Vector(0, -1);\r\n    }\r\n    /**\r\n     * A unit vector pointing down (0, 1)\r\n     */\r\n    static get Down() {\r\n        return new Vector(0, 1);\r\n    }\r\n    /**\r\n     * A unit vector pointing left (-1, 0)\r\n     */\r\n    static get Left() {\r\n        return new Vector(-1, 0);\r\n    }\r\n    /**\r\n     * A unit vector pointing right (1, 0)\r\n     */\r\n    static get Right() {\r\n        return new Vector(1, 0);\r\n    }\r\n    /**\r\n     * Returns a vector of unit length in the direction of the specified angle in Radians.\r\n     * @param angle The angle to generate the vector\r\n     */\r\n    static fromAngle(angle) {\r\n        return new Vector(Math.cos(angle), Math.sin(angle));\r\n    }\r\n    /**\r\n     * Checks if vector is not null, undefined, or if any of its components are NaN or Infinity.\r\n     */\r\n    static isValid(vec) {\r\n        if (vec === null || vec === undefined) {\r\n            return false;\r\n        }\r\n        if (isNaN(vec.x) || isNaN(vec.y)) {\r\n            return false;\r\n        }\r\n        if (vec.x === Infinity || vec.y === Infinity || vec.x === -Infinity || vec.y === -Infinity) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    /**\r\n     * Calculates distance between two Vectors\r\n     * @param vec1\r\n     * @param vec2\r\n     */\r\n    static distance(vec1, vec2) {\r\n        return Math.sqrt(Math.pow(vec1.x - vec2.x, 2) + Math.pow(vec1.y - vec2.y, 2));\r\n    }\r\n    static min(vec1, vec2) {\r\n        return new Vector(Math.min(vec1.x, vec2.x), Math.min(vec1.y, vec2.y));\r\n    }\r\n    static max(vec1, vec2) {\r\n        return new Vector(Math.max(vec1.x, vec2.x), Math.max(vec1.y, vec2.y));\r\n    }\r\n    /**\r\n     * Get the x component of the vector\r\n     */\r\n    get x() {\r\n        return this._x;\r\n    }\r\n    /**\r\n     * Set the x component, THIS MUTATES the current vector. It is usually better to create a new vector.\r\n     * @warning **Be very careful setting components on shared vectors, mutating shared vectors can cause hard to find bugs**\r\n     */\r\n    set x(val) {\r\n        this._x = val;\r\n    }\r\n    /**\r\n     * Get the y component of the vector\r\n     */\r\n    get y() {\r\n        return this._y;\r\n    }\r\n    /**\r\n     * Set the y component, THIS MUTATES the current vector. It is usually better to create a new vector.\r\n     * @warning **Be very careful setting components on shared vectors, mutating shared vectors can cause hard to find bugs**\r\n     */\r\n    set y(val) {\r\n        this._y = val;\r\n    }\r\n    /**\r\n     * Sets the x and y components at once, THIS MUTATES the current vector. It is usually better to create a new vector.\r\n     *\r\n     * @warning **Be very careful using this, mutating vectors can cause hard to find bugs**\r\n     */\r\n    setTo(x, y) {\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n    /**\r\n     * Compares this point against another and tests for equality\r\n     * @param vector The other point to compare to\r\n     * @param tolerance Amount of euclidean distance off we are willing to tolerate\r\n     */\r\n    equals(vector, tolerance = 0.001) {\r\n        return Math.abs(this.x - vector.x) <= tolerance && Math.abs(this.y - vector.y) <= tolerance;\r\n    }\r\n    /**\r\n     * The distance to another vector. If no other Vector is specified, this will return the [[magnitude]].\r\n     * @param v  The other vector. Leave blank to use origin vector.\r\n     */\r\n    distance(v) {\r\n        if (!v) {\r\n            return Math.sqrt(this.x * this.x + this.y * this.y);\r\n        }\r\n        const deltaX = this.x - v.x;\r\n        const deltaY = this.y - v.y;\r\n        return Math.sqrt(deltaX * deltaX + deltaY * deltaY);\r\n    }\r\n    squareDistance(v) {\r\n        if (!v) {\r\n            v = Vector.Zero;\r\n        }\r\n        const deltaX = this.x - v.x;\r\n        const deltaY = this.y - v.y;\r\n        return deltaX * deltaX + deltaY * deltaY;\r\n    }\r\n    /**\r\n     * Clamps the current vector's magnitude mutating it\r\n     * @param magnitude\r\n     */\r\n    clampMagnitude(magnitude) {\r\n        const size = this.size;\r\n        const newSize = clamp(size, 0, magnitude);\r\n        this.size = newSize;\r\n        return this;\r\n    }\r\n    /**\r\n     * The size (magnitude) of the Vector\r\n     */\r\n    get size() {\r\n        return this.distance();\r\n    }\r\n    /**\r\n     * Setting the size mutates the current vector\r\n     *\r\n     * @warning Can be used to set the size of the vector, **be very careful using this, mutating vectors can cause hard to find bugs**\r\n     */\r\n    set size(newLength) {\r\n        const v = this.normalize().scale(newLength);\r\n        this.setTo(v.x, v.y);\r\n    }\r\n    /**\r\n     * Normalizes a vector to have a magnitude of 1.\r\n     */\r\n    normalize() {\r\n        const d = this.distance();\r\n        if (d > 0) {\r\n            return new Vector(this.x / d, this.y / d);\r\n        }\r\n        else {\r\n            return new Vector(0, 1);\r\n        }\r\n    }\r\n    /**\r\n     * Returns the average (midpoint) between the current point and the specified\r\n     */\r\n    average(vec) {\r\n        return this.add(vec).scale(0.5);\r\n    }\r\n    scale(sizeOrScale, dest) {\r\n        const result = dest || new Vector(0, 0);\r\n        if (sizeOrScale instanceof Vector) {\r\n            result.x = this.x * sizeOrScale.x;\r\n            result.y = this.y * sizeOrScale.y;\r\n        }\r\n        else {\r\n            result.x = this.x * sizeOrScale;\r\n            result.y = this.y * sizeOrScale;\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Adds one vector to another\r\n     * @param v The vector to add\r\n     * @param dest Optionally copy the result into a provided vector\r\n     */\r\n    add(v, dest) {\r\n        if (dest) {\r\n            dest.x = this.x + v.x;\r\n            dest.y = this.y + v.y;\r\n            return dest;\r\n        }\r\n        return new Vector(this.x + v.x, this.y + v.y);\r\n    }\r\n    /**\r\n     * Subtracts a vector from another, if you subtract vector `B.sub(A)` the resulting vector points from A -> B\r\n     * @param v The vector to subtract\r\n     */\r\n    sub(v) {\r\n        return new Vector(this.x - v.x, this.y - v.y);\r\n    }\r\n    /**\r\n     * Adds one vector to this one modifying the original\r\n     * @param v The vector to add\r\n     * @warning Be very careful using this, mutating vectors can cause hard to find bugs\r\n     */\r\n    addEqual(v) {\r\n        this.setTo(this.x + v.x, this.y + v.y);\r\n        return this;\r\n    }\r\n    /**\r\n     * Subtracts a vector from this one modifying the original\r\n     * @param v The vector to subtract\r\n     * @warning Be very careful using this, mutating vectors can cause hard to find bugs\r\n     */\r\n    subEqual(v) {\r\n        this.setTo(this.x - v.x, this.y - v.y);\r\n        return this;\r\n    }\r\n    /**\r\n     * Scales this vector by a factor of size and modifies the original\r\n     * @warning Be very careful using this, mutating vectors can cause hard to find bugs\r\n     */\r\n    scaleEqual(size) {\r\n        this.setTo(this.x * size, this.y * size);\r\n        return this;\r\n    }\r\n    /**\r\n     * Performs a dot product with another vector\r\n     * @param v  The vector to dot\r\n     */\r\n    dot(v) {\r\n        return this.x * v.x + this.y * v.y;\r\n    }\r\n    cross(v) {\r\n        if (v instanceof Vector) {\r\n            return this.x * v.y - this.y * v.x;\r\n        }\r\n        else if (typeof v === 'number') {\r\n            return new Vector(v * this.y, -v * this.x);\r\n        }\r\n    }\r\n    static cross(num, vec) {\r\n        return new Vector(-num * vec.y, num * vec.x);\r\n    }\r\n    /**\r\n     * Returns the perpendicular vector to this one\r\n     */\r\n    perpendicular() {\r\n        return new Vector(this.y, -this.x);\r\n    }\r\n    /**\r\n     * Returns the normal vector to this one, same as the perpendicular of length 1\r\n     */\r\n    normal() {\r\n        return this.perpendicular().normalize();\r\n    }\r\n    /**\r\n     * Negate the current vector\r\n     */\r\n    negate() {\r\n        return this.scale(-1);\r\n    }\r\n    /**\r\n     * Returns the angle of this vector.\r\n     */\r\n    toAngle() {\r\n        return Math.atan2(this.y, this.x);\r\n    }\r\n    /**\r\n     * Rotates the current vector around a point by a certain number of\r\n     * degrees in radians\r\n     */\r\n    rotate(angle, anchor) {\r\n        if (!anchor) {\r\n            anchor = new Vector(0, 0);\r\n        }\r\n        const sinAngle = Math.sin(angle);\r\n        const cosAngle = Math.cos(angle);\r\n        const x = cosAngle * (this.x - anchor.x) - sinAngle * (this.y - anchor.y) + anchor.x;\r\n        const y = sinAngle * (this.x - anchor.x) + cosAngle * (this.y - anchor.y) + anchor.y;\r\n        return new Vector(x, y);\r\n    }\r\n    /**\r\n     * Creates new vector that has the same values as the previous.\r\n     */\r\n    clone(dest) {\r\n        const v = dest !== null && dest !== void 0 ? dest : new Vector(0, 0);\r\n        v.x = this.x;\r\n        v.y = this.y;\r\n        return v;\r\n    }\r\n    /**\r\n     * Returns a string representation of the vector.\r\n     */\r\n    toString(fixed) {\r\n        if (fixed) {\r\n            return `(${this.x.toFixed(fixed)}, ${this.y.toFixed(fixed)})`;\r\n        }\r\n        return `(${this.x}, ${this.y})`;\r\n    }\r\n}\r\n/**\r\n * Shorthand for creating new Vectors - returns a new Vector instance with the\r\n * provided X and Y components.\r\n *\r\n * @param x  X component of the Vector\r\n * @param y  Y component of the Vector\r\n */\r\nfunction vec(x, y) {\r\n    return new Vector(x, y);\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Log.ts\n/* eslint-disable no-console */\r\n/**\r\n * Logging level that Excalibur will tag\r\n */\r\nvar LogLevel;\r\n(function (LogLevel) {\r\n    LogLevel[LogLevel[\"Debug\"] = 0] = \"Debug\";\r\n    LogLevel[LogLevel[\"Info\"] = 1] = \"Info\";\r\n    LogLevel[LogLevel[\"Warn\"] = 2] = \"Warn\";\r\n    LogLevel[LogLevel[\"Error\"] = 3] = \"Error\";\r\n    LogLevel[LogLevel[\"Fatal\"] = 4] = \"Fatal\";\r\n})(LogLevel || (LogLevel = {}));\r\n/**\r\n * Static singleton that represents the logging facility for Excalibur.\r\n * Excalibur comes built-in with a [[ConsoleAppender]] and [[ScreenAppender]].\r\n * Derive from [[Appender]] to create your own logging appenders.\r\n */\r\nclass Logger {\r\n    constructor() {\r\n        this._appenders = [];\r\n        /**\r\n         * Gets or sets the default logging level. Excalibur will only log\r\n         * messages if equal to or above this level. Default: [[LogLevel.Info]]\r\n         */\r\n        this.defaultLevel = LogLevel.Info;\r\n        if (Logger._INSTANCE) {\r\n            throw new Error('Logger is a singleton');\r\n        }\r\n        Logger._INSTANCE = this;\r\n        // Default console appender\r\n        Logger._INSTANCE.addAppender(new ConsoleAppender());\r\n        return Logger._INSTANCE;\r\n    }\r\n    /**\r\n     * Gets the current static instance of Logger\r\n     */\r\n    static getInstance() {\r\n        if (Logger._INSTANCE == null) {\r\n            Logger._INSTANCE = new Logger();\r\n        }\r\n        return Logger._INSTANCE;\r\n    }\r\n    /**\r\n     * Adds a new [[Appender]] to the list of appenders to write to\r\n     */\r\n    addAppender(appender) {\r\n        this._appenders.push(appender);\r\n    }\r\n    /**\r\n     * Clears all appenders from the logger\r\n     */\r\n    clearAppenders() {\r\n        this._appenders.length = 0;\r\n    }\r\n    /**\r\n     * Logs a message at a given LogLevel\r\n     * @param level  The LogLevel`to log the message at\r\n     * @param args   An array of arguments to write to an appender\r\n     */\r\n    _log(level, args) {\r\n        if (level == null) {\r\n            level = this.defaultLevel;\r\n        }\r\n        const len = this._appenders.length;\r\n        for (let i = 0; i < len; i++) {\r\n            if (level >= this.defaultLevel) {\r\n                this._appenders[i].log(level, args);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Writes a log message at the [[LogLevel.Debug]] level\r\n     * @param args  Accepts any number of arguments\r\n     */\r\n    debug(...args) {\r\n        this._log(LogLevel.Debug, args);\r\n    }\r\n    /**\r\n     * Writes a log message at the [[LogLevel.Info]] level\r\n     * @param args  Accepts any number of arguments\r\n     */\r\n    info(...args) {\r\n        this._log(LogLevel.Info, args);\r\n    }\r\n    /**\r\n     * Writes a log message at the [[LogLevel.Warn]] level\r\n     * @param args  Accepts any number of arguments\r\n     */\r\n    warn(...args) {\r\n        this._log(LogLevel.Warn, args);\r\n    }\r\n    /**\r\n     * Writes a log message at the [[LogLevel.Error]] level\r\n     * @param args  Accepts any number of arguments\r\n     */\r\n    error(...args) {\r\n        this._log(LogLevel.Error, args);\r\n    }\r\n    /**\r\n     * Writes a log message at the [[LogLevel.Fatal]] level\r\n     * @param args  Accepts any number of arguments\r\n     */\r\n    fatal(...args) {\r\n        this._log(LogLevel.Fatal, args);\r\n    }\r\n}\r\nLogger._INSTANCE = null;\r\n/**\r\n * Console appender for browsers (i.e. `console.log`)\r\n */\r\nclass ConsoleAppender {\r\n    /**\r\n     * Logs a message at the given [[LogLevel]]\r\n     * @param level  Level to log at\r\n     * @param args   Arguments to log\r\n     */\r\n    log(level, args) {\r\n        // Check for console support\r\n        if (!console && !console.log && console.warn && console.error) {\r\n            // todo maybe do something better than nothing\r\n            return;\r\n        }\r\n        // Create a new console args array\r\n        const consoleArgs = [];\r\n        consoleArgs.unshift.apply(consoleArgs, args);\r\n        consoleArgs.unshift('[' + LogLevel[level] + '] : ');\r\n        if (level < LogLevel.Warn) {\r\n            // Call .log for Debug/Info\r\n            if (console.log.apply) {\r\n                // this is required on some older browsers that don't support apply on console.log :(\r\n                console.log.apply(console, consoleArgs);\r\n            }\r\n            else {\r\n                console.log(consoleArgs.join(' '));\r\n            }\r\n        }\r\n        else if (level < LogLevel.Error) {\r\n            // Call .warn for Warn\r\n            if (console.warn.apply) {\r\n                console.warn.apply(console, consoleArgs);\r\n            }\r\n            else {\r\n                console.warn(consoleArgs.join(' '));\r\n            }\r\n        }\r\n        else {\r\n            // Call .error for Error/Fatal\r\n            if (console.error.apply) {\r\n                console.error.apply(console, consoleArgs);\r\n            }\r\n            else {\r\n                console.error(consoleArgs.join(' '));\r\n            }\r\n        }\r\n    }\r\n}\r\n/**\r\n * On-screen (canvas) appender\r\n */\r\nclass ScreenAppender {\r\n    /**\r\n     * @param width   Width of the screen appender in pixels\r\n     * @param height  Height of the screen appender in pixels\r\n     */\r\n    constructor(width, height) {\r\n        // @todo Clean this up\r\n        this._messages = [];\r\n        this._canvas = document.createElement('canvas');\r\n        this._canvas.width = width || window.innerWidth;\r\n        this._canvas.height = height || window.innerHeight;\r\n        this._canvas.style.position = 'absolute';\r\n        // eslint-disable-next-line\r\n        this._ctx = this._canvas.getContext('2d'); // eslint-disable-line\r\n        document.body.appendChild(this._canvas);\r\n    }\r\n    /**\r\n     * Logs a message at the given [[LogLevel]]\r\n     * @param level  Level to log at\r\n     * @param args   Arguments to log\r\n     */\r\n    log(level, args) {\r\n        const message = args.join(',');\r\n        this._ctx.clearRect(0, 0, this._canvas.width, this._canvas.height);\r\n        this._messages.unshift('[' + LogLevel[level] + '] : ' + message);\r\n        let pos = 10;\r\n        let opacity = 1.0;\r\n        for (let i = 0; i < this._messages.length; i++) {\r\n            this._ctx.fillStyle = 'rgba(255,255,255,' + opacity.toFixed(2) + ')';\r\n            this._ctx.fillText(this._messages[i], 200, pos);\r\n            pos += 10;\r\n            opacity = opacity > 0 ? opacity - 0.05 : 0;\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Color.ts\n/**\r\n * Provides standard colors (e.g. [[Color.Black]])\r\n * but you can also create custom colors using RGB, HSL, or Hex. Also provides\r\n * useful color operations like [[Color.lighten]], [[Color.darken]], and more.\r\n */\r\nclass Color {\r\n    /**\r\n     * Creates a new instance of Color from an r, g, b, a\r\n     *\r\n     * @param r  The red component of color (0-255)\r\n     * @param g  The green component of color (0-255)\r\n     * @param b  The blue component of color (0-255)\r\n     * @param a  The alpha component of color (0-1.0)\r\n     */\r\n    constructor(r, g, b, a) {\r\n        this.r = r;\r\n        this.g = g;\r\n        this.b = b;\r\n        this.a = a != null ? a : 1;\r\n    }\r\n    /**\r\n     * Creates a new instance of Color from an r, g, b, a\r\n     *\r\n     * @param r  The red component of color (0-255)\r\n     * @param g  The green component of color (0-255)\r\n     * @param b  The blue component of color (0-255)\r\n     * @param a  The alpha component of color (0-1.0)\r\n     */\r\n    static fromRGB(r, g, b, a) {\r\n        return new Color(r, g, b, a);\r\n    }\r\n    /**\r\n     * Creates a new instance of Color from a rgb string\r\n     *\r\n     * @param string  CSS color string of the form rgba(255, 255, 255, 1) or rgb(255, 255, 255)\r\n     */\r\n    static fromRGBString(string) {\r\n        const rgbaRegEx = /^rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)(?:,\\s*(\\d+(?:\\.\\d+)?))?\\)/i;\r\n        let match = null;\r\n        if ((match = string.match(rgbaRegEx))) {\r\n            const r = parseInt(match[1], 10);\r\n            const g = parseInt(match[2], 10);\r\n            const b = parseInt(match[3], 10);\r\n            let a = 1;\r\n            if (match[4]) {\r\n                a = parseFloat(match[4]);\r\n            }\r\n            return new Color(r, g, b, a);\r\n        }\r\n        else {\r\n            throw new Error('Invalid rgb/a string: ' + string);\r\n        }\r\n    }\r\n    /**\r\n     * Creates a new instance of Color from a hex string\r\n     *\r\n     * @param hex  CSS color string of the form #ffffff, the alpha component is optional\r\n     */\r\n    static fromHex(hex) {\r\n        const hexRegEx = /^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i;\r\n        let match = null;\r\n        if ((match = hex.match(hexRegEx))) {\r\n            const r = parseInt(match[1], 16);\r\n            const g = parseInt(match[2], 16);\r\n            const b = parseInt(match[3], 16);\r\n            let a = 1;\r\n            if (match[4]) {\r\n                a = parseInt(match[4], 16) / 255;\r\n            }\r\n            return new Color(r, g, b, a);\r\n        }\r\n        else {\r\n            throw new Error('Invalid hex string: ' + hex);\r\n        }\r\n    }\r\n    /**\r\n     * Creates a new instance of Color from hsla values\r\n     *\r\n     * @param h  Hue is represented [0-1]\r\n     * @param s  Saturation is represented [0-1]\r\n     * @param l  Luminance is represented [0-1]\r\n     * @param a  Alpha is represented [0-1]\r\n     */\r\n    static fromHSL(h, s, l, a = 1.0) {\r\n        const temp = new HSLColor(h, s, l, a);\r\n        return temp.toRGBA();\r\n    }\r\n    /**\r\n     * Lightens the current color by a specified amount\r\n     *\r\n     * @param factor  The amount to lighten by [0-1]\r\n     */\r\n    lighten(factor = 0.1) {\r\n        const temp = HSLColor.fromRGBA(this.r, this.g, this.b, this.a);\r\n        temp.l += (1 - temp.l) * factor;\r\n        return temp.toRGBA();\r\n    }\r\n    /**\r\n     * Darkens the current color by a specified amount\r\n     *\r\n     * @param factor  The amount to darken by [0-1]\r\n     */\r\n    darken(factor = 0.1) {\r\n        const temp = HSLColor.fromRGBA(this.r, this.g, this.b, this.a);\r\n        temp.l -= temp.l * factor;\r\n        return temp.toRGBA();\r\n    }\r\n    /**\r\n     * Saturates the current color by a specified amount\r\n     *\r\n     * @param factor  The amount to saturate by [0-1]\r\n     */\r\n    saturate(factor = 0.1) {\r\n        const temp = HSLColor.fromRGBA(this.r, this.g, this.b, this.a);\r\n        temp.s += temp.s * factor;\r\n        return temp.toRGBA();\r\n    }\r\n    /**\r\n     * Desaturates the current color by a specified amount\r\n     *\r\n     * @param factor  The amount to desaturate by [0-1]\r\n     */\r\n    desaturate(factor = 0.1) {\r\n        const temp = HSLColor.fromRGBA(this.r, this.g, this.b, this.a);\r\n        temp.s -= temp.s * factor;\r\n        return temp.toRGBA();\r\n    }\r\n    /**\r\n     * Multiplies a color by another, results in a darker color\r\n     *\r\n     * @param color  The other color\r\n     */\r\n    multiply(color) {\r\n        const newR = (((color.r / 255) * this.r) / 255) * 255;\r\n        const newG = (((color.g / 255) * this.g) / 255) * 255;\r\n        const newB = (((color.b / 255) * this.b) / 255) * 255;\r\n        const newA = color.a * this.a;\r\n        return new Color(newR, newG, newB, newA);\r\n    }\r\n    /**\r\n     * Screens a color by another, results in a lighter color\r\n     *\r\n     * @param color  The other color\r\n     */\r\n    screen(color) {\r\n        const color1 = color.invert();\r\n        const color2 = color.invert();\r\n        return color1.multiply(color2).invert();\r\n    }\r\n    /**\r\n     * Inverts the current color\r\n     */\r\n    invert() {\r\n        return new Color(255 - this.r, 255 - this.g, 255 - this.b, 1.0 - this.a);\r\n    }\r\n    /**\r\n     * Averages the current color with another\r\n     *\r\n     * @param color  The other color\r\n     */\r\n    average(color) {\r\n        const newR = (color.r + this.r) / 2;\r\n        const newG = (color.g + this.g) / 2;\r\n        const newB = (color.b + this.b) / 2;\r\n        const newA = (color.a + this.a) / 2;\r\n        return new Color(newR, newG, newB, newA);\r\n    }\r\n    equal(color) {\r\n        return this.toString() === color.toString();\r\n    }\r\n    /**\r\n     * Returns a CSS string representation of a color.\r\n     *\r\n     * @param format Color representation, accepts: rgb, hsl, or hex\r\n     */\r\n    toString(format = 'rgb') {\r\n        switch (format) {\r\n            case 'rgb':\r\n                return this.toRGBA();\r\n            case 'hsl':\r\n                return this.toHSLA();\r\n            case 'hex':\r\n                return this.toHex();\r\n            default:\r\n                throw new Error('Invalid Color format');\r\n        }\r\n    }\r\n    /**\r\n     * Returns Hex Value of a color component\r\n     * @param c color component\r\n     * @see https://stackoverflow.com/questions/5623838/rgb-to-hex-and-hex-to-rgb\r\n     */\r\n    _componentToHex(c) {\r\n        const hex = c.toString(16);\r\n        return hex.length === 1 ? '0' + hex : hex;\r\n    }\r\n    /**\r\n     * Return Hex representation of a color.\r\n     */\r\n    toHex() {\r\n        return '#' + this._componentToHex(this.r) + this._componentToHex(this.g) + this._componentToHex(this.b);\r\n    }\r\n    /**\r\n     * Return RGBA representation of a color.\r\n     */\r\n    toRGBA() {\r\n        const result = String(this.r.toFixed(0)) + ', ' + String(this.g.toFixed(0)) + ', ' + String(this.b.toFixed(0));\r\n        if (this.a !== undefined || this.a !== null) {\r\n            return 'rgba(' + result + ', ' + String(this.a) + ')';\r\n        }\r\n        return 'rgb(' + result + ')';\r\n    }\r\n    /**\r\n     * Return HSLA representation of a color.\r\n     */\r\n    toHSLA() {\r\n        return HSLColor.fromRGBA(this.r, this.g, this.b, this.a).toString();\r\n    }\r\n    /**\r\n     * Returns a CSS string representation of a color.\r\n     */\r\n    fillStyle() {\r\n        return this.toString();\r\n    }\r\n    /**\r\n     * Returns a clone of the current color.\r\n     */\r\n    clone() {\r\n        return new Color(this.r, this.g, this.b, this.a);\r\n    }\r\n    /**\r\n     * Black (#000000)\r\n     */\r\n    static get Black() {\r\n        return Color.fromHex('#000000');\r\n    }\r\n    /**\r\n     * White (#FFFFFF)\r\n     */\r\n    static get White() {\r\n        return Color.fromHex('#FFFFFF');\r\n    }\r\n    /**\r\n     * Gray (#808080)\r\n     */\r\n    static get Gray() {\r\n        return Color.fromHex('#808080');\r\n    }\r\n    /**\r\n     * Light gray (#D3D3D3)\r\n     */\r\n    static get LightGray() {\r\n        return Color.fromHex('#D3D3D3');\r\n    }\r\n    /**\r\n     * Dark gray (#A9A9A9)\r\n     */\r\n    static get DarkGray() {\r\n        return Color.fromHex('#A9A9A9');\r\n    }\r\n    /**\r\n     * Yellow (#FFFF00)\r\n     */\r\n    static get Yellow() {\r\n        return Color.fromHex('#FFFF00');\r\n    }\r\n    /**\r\n     * Orange (#FFA500)\r\n     */\r\n    static get Orange() {\r\n        return Color.fromHex('#FFA500');\r\n    }\r\n    /**\r\n     * Red (#FF0000)\r\n     */\r\n    static get Red() {\r\n        return Color.fromHex('#FF0000');\r\n    }\r\n    /**\r\n     * Vermilion (#FF5B31)\r\n     */\r\n    static get Vermilion() {\r\n        return Color.fromHex('#FF5B31');\r\n    }\r\n    /**\r\n     * Rose (#FF007F)\r\n     */\r\n    static get Rose() {\r\n        return Color.fromHex('#FF007F');\r\n    }\r\n    /**\r\n     * Magenta (#FF00FF)\r\n     */\r\n    static get Magenta() {\r\n        return Color.fromHex('#FF00FF');\r\n    }\r\n    /**\r\n     * Violet (#7F00FF)\r\n     */\r\n    static get Violet() {\r\n        return Color.fromHex('#7F00FF');\r\n    }\r\n    /**\r\n     * Blue (#0000FF)\r\n     */\r\n    static get Blue() {\r\n        return Color.fromHex('#0000FF');\r\n    }\r\n    /**\r\n     * Azure (#007FFF)\r\n     */\r\n    static get Azure() {\r\n        return Color.fromHex('#007FFF');\r\n    }\r\n    /**\r\n     * Cyan (#00FFFF)\r\n     */\r\n    static get Cyan() {\r\n        return Color.fromHex('#00FFFF');\r\n    }\r\n    /**\r\n     * Viridian (#59978F)\r\n     */\r\n    static get Viridian() {\r\n        return Color.fromHex('#59978F');\r\n    }\r\n    /**\r\n     * Green (#00FF00)\r\n     */\r\n    static get Green() {\r\n        return Color.fromHex('#00FF00');\r\n    }\r\n    /**\r\n     * Chartreuse (#7FFF00)\r\n     */\r\n    static get Chartreuse() {\r\n        return Color.fromHex('#7FFF00');\r\n    }\r\n    /**\r\n     * Transparent (#FFFFFF00)\r\n     */\r\n    static get Transparent() {\r\n        return Color.fromHex('#FFFFFF00');\r\n    }\r\n    /**\r\n     * ExcaliburBlue (#176BAA)\r\n     */\r\n    static get ExcaliburBlue() {\r\n        return Color.fromHex('#176BAA');\r\n    }\r\n}\r\n/**\r\n * Internal HSL Color representation\r\n *\r\n * http://en.wikipedia.org/wiki/HSL_and_HSV\r\n * http://axonflux.com/handy-rgb-to-hsl-and-rgb-to-hsv-color-model-c\r\n */\r\nclass HSLColor {\r\n    constructor(h, s, l, a) {\r\n        this.h = h;\r\n        this.s = s;\r\n        this.l = l;\r\n        this.a = a;\r\n    }\r\n    static hue2rgb(p, q, t) {\r\n        if (t < 0) {\r\n            t += 1;\r\n        }\r\n        if (t > 1) {\r\n            t -= 1;\r\n        }\r\n        if (t < 1 / 6) {\r\n            return p + (q - p) * 6 * t;\r\n        }\r\n        if (t < 1 / 2) {\r\n            return q;\r\n        }\r\n        if (t < 2 / 3) {\r\n            return p + (q - p) * (2 / 3 - t) * 6;\r\n        }\r\n        return p;\r\n    }\r\n    static fromRGBA(r, g, b, a) {\r\n        r /= 255;\r\n        g /= 255;\r\n        b /= 255;\r\n        const max = Math.max(r, g, b), min = Math.min(r, g, b);\r\n        let h, s;\r\n        const l = (max + min) / 2;\r\n        if (max === min) {\r\n            h = s = 0; // achromatic\r\n        }\r\n        else {\r\n            const d = max - min;\r\n            s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\r\n            switch (max) {\r\n                case r:\r\n                    h = (g - b) / d + (g < b ? 6 : 0);\r\n                    break;\r\n                case g:\r\n                    h = (b - r) / d + 2;\r\n                    break;\r\n                case b:\r\n                    h = (r - g) / d + 4;\r\n                    break;\r\n            }\r\n            h /= 6;\r\n        }\r\n        return new HSLColor(h, s, l, a);\r\n    }\r\n    toRGBA() {\r\n        let r, g, b;\r\n        if (this.s === 0) {\r\n            r = g = b = this.l; // achromatic\r\n        }\r\n        else {\r\n            const q = this.l < 0.5 ? this.l * (1 + this.s) : this.l + this.s - this.l * this.s;\r\n            const p = 2 * this.l - q;\r\n            r = HSLColor.hue2rgb(p, q, this.h + 1 / 3);\r\n            g = HSLColor.hue2rgb(p, q, this.h);\r\n            b = HSLColor.hue2rgb(p, q, this.h - 1 / 3);\r\n        }\r\n        return new Color(r * 255, g * 255, b * 255, this.a);\r\n    }\r\n    toString() {\r\n        const h = this.h.toFixed(0), s = this.s.toFixed(0), l = this.l.toFixed(0), a = this.a.toFixed(0);\r\n        return `hsla(${h}, ${s}, ${l}, ${a})`;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Side.ts\n\r\n/**\r\n * An enum that describes the sides of an axis aligned box for collision\r\n */\r\nvar Side;\r\n(function (Side) {\r\n    Side[\"None\"] = \"None\";\r\n    Side[\"Top\"] = \"Top\";\r\n    Side[\"Bottom\"] = \"Bottom\";\r\n    Side[\"Left\"] = \"Left\";\r\n    Side[\"Right\"] = \"Right\";\r\n})(Side || (Side = {}));\r\n(function (Side) {\r\n    /**\r\n     * Returns the opposite side from the current\r\n     */\r\n    function getOpposite(side) {\r\n        if (side === Side.Top) {\r\n            return Side.Bottom;\r\n        }\r\n        if (side === Side.Bottom) {\r\n            return Side.Top;\r\n        }\r\n        if (side === Side.Left) {\r\n            return Side.Right;\r\n        }\r\n        if (side === Side.Right) {\r\n            return Side.Left;\r\n        }\r\n        return Side.None;\r\n    }\r\n    Side.getOpposite = getOpposite;\r\n    /**\r\n     * Given a vector, return the Side most in that direction (via dot product)\r\n     */\r\n    function fromDirection(direction) {\r\n        const directions = [Vector.Left, Vector.Right, Vector.Up, Vector.Down];\r\n        const directionEnum = [Side.Left, Side.Right, Side.Top, Side.Bottom];\r\n        let max = -Number.MAX_VALUE;\r\n        let maxIndex = -1;\r\n        for (let i = 0; i < directions.length; i++) {\r\n            if (directions[i].dot(direction) > max) {\r\n                max = directions[i].dot(direction);\r\n                maxIndex = i;\r\n            }\r\n        }\r\n        return directionEnum[maxIndex];\r\n    }\r\n    Side.fromDirection = fromDirection;\r\n})(Side || (Side = {}));\r\n\n;// CONCATENATED MODULE: ./Collision/BoundingBox.ts\n\r\n\r\n\r\n/**\r\n * Axis Aligned collision primitive for Excalibur.\r\n */\r\nclass BoundingBox {\r\n    /**\r\n     * Constructor allows passing of either an object with all coordinate components,\r\n     * or the coordinate components passed separately.\r\n     * @param leftOrOptions    Either x coordinate of the left edge or an options object\r\n     * containing the four coordinate components.\r\n     * @param top     y coordinate of the top edge\r\n     * @param right   x coordinate of the right edge\r\n     * @param bottom  y coordinate of the bottom edge\r\n     */\r\n    constructor(leftOrOptions = 0, top = 0, right = 0, bottom = 0) {\r\n        if (typeof leftOrOptions === 'object') {\r\n            this.left = leftOrOptions.left;\r\n            this.top = leftOrOptions.top;\r\n            this.right = leftOrOptions.right;\r\n            this.bottom = leftOrOptions.bottom;\r\n        }\r\n        else if (typeof leftOrOptions === 'number') {\r\n            this.left = leftOrOptions;\r\n            this.top = top;\r\n            this.right = right;\r\n            this.bottom = bottom;\r\n        }\r\n    }\r\n    /**\r\n     * Returns a new instance of [[BoundingBox]] that is a copy of the current instance\r\n     */\r\n    clone() {\r\n        return new BoundingBox(this.left, this.top, this.right, this.bottom);\r\n    }\r\n    /**\r\n     * Given bounding box A & B, returns the side relative to A when intersection is performed.\r\n     * @param intersection Intersection vector between 2 bounding boxes\r\n     */\r\n    static getSideFromIntersection(intersection) {\r\n        if (!intersection) {\r\n            return Side.None;\r\n        }\r\n        if (intersection) {\r\n            if (Math.abs(intersection.x) > Math.abs(intersection.y)) {\r\n                if (intersection.x < 0) {\r\n                    return Side.Right;\r\n                }\r\n                return Side.Left;\r\n            }\r\n            else {\r\n                if (intersection.y < 0) {\r\n                    return Side.Bottom;\r\n                }\r\n                return Side.Top;\r\n            }\r\n        }\r\n        return Side.None;\r\n    }\r\n    static fromPoints(points) {\r\n        let minX = Infinity;\r\n        let minY = Infinity;\r\n        let maxX = -Infinity;\r\n        let maxY = -Infinity;\r\n        for (let i = 0; i < points.length; i++) {\r\n            if (points[i].x < minX) {\r\n                minX = points[i].x;\r\n            }\r\n            if (points[i].x > maxX) {\r\n                maxX = points[i].x;\r\n            }\r\n            if (points[i].y < minY) {\r\n                minY = points[i].y;\r\n            }\r\n            if (points[i].y > maxY) {\r\n                maxY = points[i].y;\r\n            }\r\n        }\r\n        return new BoundingBox(minX, minY, maxX, maxY);\r\n    }\r\n    static fromDimension(width, height, anchor = Vector.Half, pos = Vector.Zero) {\r\n        return new BoundingBox(-width * anchor.x + pos.x, -height * anchor.y + pos.y, width - width * anchor.x + pos.x, height - height * anchor.y + pos.y);\r\n    }\r\n    /**\r\n     * Returns the calculated width of the bounding box\r\n     */\r\n    get width() {\r\n        return this.right - this.left;\r\n    }\r\n    /**\r\n     * Returns the calculated height of the bounding box\r\n     */\r\n    get height() {\r\n        return this.bottom - this.top;\r\n    }\r\n    /**\r\n     * Return whether the bounding box has zero dimensions in height,width or both\r\n     */\r\n    hasZeroDimensions() {\r\n        return this.width === 0 || this.height === 0;\r\n    }\r\n    /**\r\n     * Returns the center of the bounding box\r\n     */\r\n    get center() {\r\n        return new Vector((this.left + this.right) / 2, (this.top + this.bottom) / 2);\r\n    }\r\n    translate(pos) {\r\n        return new BoundingBox(this.left + pos.x, this.top + pos.y, this.right + pos.x, this.bottom + pos.y);\r\n    }\r\n    /**\r\n     * Rotates a bounding box by and angle and around a point, if no point is specified (0, 0) is used by default. The resulting bounding\r\n     * box is also axis-align. This is useful when a new axis-aligned bounding box is needed for rotated geometry.\r\n     */\r\n    rotate(angle, point = Vector.Zero) {\r\n        const points = this.getPoints().map((p) => p.rotate(angle, point));\r\n        return BoundingBox.fromPoints(points);\r\n    }\r\n    /**\r\n     * Scale a bounding box by a scale factor, optionally provide a point\r\n     * @param scale\r\n     * @param point\r\n     */\r\n    scale(scale, point = Vector.Zero) {\r\n        const shifted = this.translate(point);\r\n        return new BoundingBox(shifted.left * scale.x, shifted.top * scale.y, shifted.right * scale.x, shifted.bottom * scale.y);\r\n    }\r\n    /**\r\n     * Transform the axis aligned bounding box by a [[Matrix]], producing a new axis aligned bounding box\r\n     * @param matrix\r\n     */\r\n    transform(matrix) {\r\n        // inlined these calculations to not use vectors would speed it up slightly\r\n        // const matFirstColumn = vec(matrix.data[0], matrix.data[1]);\r\n        // const xa = matFirstColumn.scale(this.left);\r\n        const xa1 = matrix.data[0] * this.left;\r\n        const xa2 = matrix.data[1] * this.left;\r\n        // const xb = matFirstColumn.scale(this.right);\r\n        const xb1 = matrix.data[0] * this.right;\r\n        const xb2 = matrix.data[1] * this.right;\r\n        // const matSecondColumn = vec(matrix.data[2], matrix.data[3]);\r\n        // const ya = matSecondColumn.scale(this.top);\r\n        const ya1 = matrix.data[2] * this.top;\r\n        const ya2 = matrix.data[3] * this.top;\r\n        // const yb = matSecondColumn.scale(this.bottom);\r\n        const yb1 = matrix.data[2] * this.bottom;\r\n        const yb2 = matrix.data[3] * this.bottom;\r\n        const matrixPos = matrix.getPosition();\r\n        // const topLeft = Vector.min(xa, xb).add(Vector.min(ya, yb)).add(matrixPos);\r\n        // const bottomRight = Vector.max(xa, xb).add(Vector.max(ya, yb)).add(matrixPos);\r\n        const left = Math.min(xa1, xb1) + Math.min(ya1, yb1) + matrixPos.x;\r\n        const top = Math.min(xa2, xb2) + Math.min(ya2, yb2) + matrixPos.y;\r\n        const right = Math.max(xa1, xb1) + Math.max(ya1, yb1) + matrixPos.x;\r\n        const bottom = Math.max(xa2, xb2) + Math.max(ya2, yb2) + matrixPos.y;\r\n        return new BoundingBox({\r\n            left,\r\n            top,\r\n            right,\r\n            bottom //: bottomRight.y\r\n        });\r\n    }\r\n    /**\r\n     * Returns the perimeter of the bounding box\r\n     */\r\n    getPerimeter() {\r\n        const wx = this.width;\r\n        const wy = this.height;\r\n        return 2 * (wx + wy);\r\n    }\r\n    getPoints() {\r\n        const results = [];\r\n        results.push(new Vector(this.left, this.top));\r\n        results.push(new Vector(this.right, this.top));\r\n        results.push(new Vector(this.right, this.bottom));\r\n        results.push(new Vector(this.left, this.bottom));\r\n        return results;\r\n    }\r\n    /**\r\n     * Determines whether a ray intersects with a bounding box\r\n     */\r\n    rayCast(ray, farClipDistance = Infinity) {\r\n        // algorithm from https://tavianator.com/fast-branchless-raybounding-box-intersections/\r\n        let tmin = -Infinity;\r\n        let tmax = +Infinity;\r\n        const xinv = ray.dir.x === 0 ? Number.MAX_VALUE : 1 / ray.dir.x;\r\n        const yinv = ray.dir.y === 0 ? Number.MAX_VALUE : 1 / ray.dir.y;\r\n        const tx1 = (this.left - ray.pos.x) * xinv;\r\n        const tx2 = (this.right - ray.pos.x) * xinv;\r\n        tmin = Math.min(tx1, tx2);\r\n        tmax = Math.max(tx1, tx2);\r\n        const ty1 = (this.top - ray.pos.y) * yinv;\r\n        const ty2 = (this.bottom - ray.pos.y) * yinv;\r\n        tmin = Math.max(tmin, Math.min(ty1, ty2));\r\n        tmax = Math.min(tmax, Math.max(ty1, ty2));\r\n        return tmax >= Math.max(0, tmin) && tmin < farClipDistance;\r\n    }\r\n    rayCastTime(ray, farClipDistance = Infinity) {\r\n        // algorithm from https://tavianator.com/fast-branchless-raybounding-box-intersections/\r\n        let tmin = -Infinity;\r\n        let tmax = +Infinity;\r\n        const xinv = ray.dir.x === 0 ? Number.MAX_VALUE : 1 / ray.dir.x;\r\n        const yinv = ray.dir.y === 0 ? Number.MAX_VALUE : 1 / ray.dir.y;\r\n        const tx1 = (this.left - ray.pos.x) * xinv;\r\n        const tx2 = (this.right - ray.pos.x) * xinv;\r\n        tmin = Math.min(tx1, tx2);\r\n        tmax = Math.max(tx1, tx2);\r\n        const ty1 = (this.top - ray.pos.y) * yinv;\r\n        const ty2 = (this.bottom - ray.pos.y) * yinv;\r\n        tmin = Math.max(tmin, Math.min(ty1, ty2));\r\n        tmax = Math.min(tmax, Math.max(ty1, ty2));\r\n        if (tmax >= Math.max(0, tmin) && tmin < farClipDistance) {\r\n            return tmin;\r\n        }\r\n        return -1;\r\n    }\r\n    contains(val) {\r\n        if (val instanceof Vector) {\r\n            return this.left <= val.x && this.top <= val.y && this.bottom >= val.y && this.right >= val.x;\r\n        }\r\n        else if (val instanceof BoundingBox) {\r\n            if (this.left <= val.left && this.top <= val.top && val.bottom <= this.bottom && val.right <= this.right) {\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n        return false;\r\n    }\r\n    /**\r\n     * Combines this bounding box and another together returning a new bounding box\r\n     * @param other  The bounding box to combine\r\n     */\r\n    combine(other) {\r\n        const compositeBB = new BoundingBox(Math.min(this.left, other.left), Math.min(this.top, other.top), Math.max(this.right, other.right), Math.max(this.bottom, other.bottom));\r\n        return compositeBB;\r\n    }\r\n    get dimensions() {\r\n        return new Vector(this.width, this.height);\r\n    }\r\n    /**\r\n     * Returns true if the bounding boxes overlap.\r\n     * @param other\r\n     * @param epsilon Optionally specify a small epsilon (default 0) as amount of overlap to ignore as overlap.\r\n     * This epsilon is useful in stable collision simulations.\r\n     */\r\n    overlaps(other, epsilon) {\r\n        const e = epsilon || 0;\r\n        if (other.hasZeroDimensions()) {\r\n            return this.contains(other);\r\n        }\r\n        if (this.hasZeroDimensions()) {\r\n            return other.contains(this);\r\n        }\r\n        const totalBoundingBox = this.combine(other);\r\n        return totalBoundingBox.width + e < other.width + this.width &&\r\n            totalBoundingBox.height + e < other.height + this.height;\r\n    }\r\n    /**\r\n     * Test wether this bounding box intersects with another returning\r\n     * the intersection vector that can be used to resolve the collision. If there\r\n     * is no intersection null is returned.\r\n     *\r\n     * @param other  Other [[BoundingBox]] to test intersection with\r\n     * @returns A Vector in the direction of the current BoundingBox, this <- other\r\n     */\r\n    intersect(other) {\r\n        const totalBoundingBox = this.combine(other);\r\n        // If the total bounding box is less than or equal the sum of the 2 bounds then there is collision\r\n        if (totalBoundingBox.width < other.width + this.width &&\r\n            totalBoundingBox.height < other.height + this.height &&\r\n            !totalBoundingBox.dimensions.equals(other.dimensions) &&\r\n            !totalBoundingBox.dimensions.equals(this.dimensions)) {\r\n            // collision\r\n            let overlapX = 0;\r\n            // right edge is between the other's left and right edge\r\n            /**\r\n             *     +-this-+\r\n             *     |      |\r\n             *     |    +-other-+\r\n             *     +----|-+     |\r\n             *          |       |\r\n             *          +-------+\r\n             *         <---\r\n             *          ^ overlap\r\n             */\r\n            if (this.right >= other.left && this.right <= other.right) {\r\n                overlapX = other.left - this.right;\r\n                // right edge is past the other's right edge\r\n                /**\r\n                 *     +-other-+\r\n                 *     |       |\r\n                 *     |    +-this-+\r\n                 *     +----|--+   |\r\n                 *          |      |\r\n                 *          +------+\r\n                 *          --->\r\n                 *          ^ overlap\r\n                 */\r\n            }\r\n            else {\r\n                overlapX = other.right - this.left;\r\n            }\r\n            let overlapY = 0;\r\n            // top edge is between the other's top and bottom edge\r\n            /**\r\n             *     +-other-+\r\n             *     |       |\r\n             *     |    +-this-+   | <- overlap\r\n             *     +----|--+   |   |\r\n             *          |      |  \\ /\r\n             *          +------+   '\r\n             */\r\n            if (this.top <= other.bottom && this.top >= other.top) {\r\n                overlapY = other.bottom - this.top;\r\n                // top edge is above the other top edge\r\n                /**\r\n                 *     +-this-+         .\r\n                 *     |      |        / \\\r\n                 *     |    +-other-+   | <- overlap\r\n                 *     +----|-+     |   |\r\n                 *          |       |\r\n                 *          +-------+\r\n                 */\r\n            }\r\n            else {\r\n                overlapY = other.top - this.bottom;\r\n            }\r\n            if (Math.abs(overlapX) < Math.abs(overlapY)) {\r\n                return new Vector(overlapX, 0);\r\n            }\r\n            else {\r\n                return new Vector(0, overlapY);\r\n            }\r\n            // Case of total containment of one bounding box by another\r\n        }\r\n        else if (totalBoundingBox.dimensions.equals(other.dimensions) || totalBoundingBox.dimensions.equals(this.dimensions)) {\r\n            let overlapX = 0;\r\n            // this is wider than the other\r\n            if (this.width - other.width >= 0) {\r\n                // This right edge is closest to the others right edge\r\n                if (this.right - other.right <= other.left - this.left) {\r\n                    overlapX = other.left - this.right;\r\n                    // This left edge is closest to the others left edge\r\n                }\r\n                else {\r\n                    overlapX = other.right - this.left;\r\n                }\r\n                // other is wider than this\r\n            }\r\n            else {\r\n                // This right edge is closest to the others right edge\r\n                if (other.right - this.right <= this.left - other.left) {\r\n                    overlapX = this.left - other.right;\r\n                    // This left edge is closest to the others left edge\r\n                }\r\n                else {\r\n                    overlapX = this.right - other.left;\r\n                }\r\n            }\r\n            let overlapY = 0;\r\n            // this is taller than other\r\n            if (this.height - other.height >= 0) {\r\n                // The bottom edge is closest to the others bottom edge\r\n                if (this.bottom - other.bottom <= other.top - this.top) {\r\n                    overlapY = other.top - this.bottom;\r\n                }\r\n                else {\r\n                    overlapY = other.bottom - this.top;\r\n                }\r\n                // other is taller than this\r\n            }\r\n            else {\r\n                // The bottom edge is closest to the others bottom edge\r\n                if (other.bottom - this.bottom <= this.top - other.top) {\r\n                    overlapY = this.top - other.bottom;\r\n                }\r\n                else {\r\n                    overlapY = this.bottom - other.top;\r\n                }\r\n            }\r\n            if (Math.abs(overlapX) < Math.abs(overlapY)) {\r\n                return new Vector(overlapX, 0);\r\n            }\r\n            else {\r\n                return new Vector(0, overlapY);\r\n            }\r\n        }\r\n        else {\r\n            return null;\r\n        }\r\n    }\r\n    /**\r\n     * Test whether the bounding box has intersected with another bounding box, returns the side of the current bb that intersected.\r\n     * @param bb The other actor to test\r\n     */\r\n    intersectWithSide(bb) {\r\n        const intersect = this.intersect(bb);\r\n        return BoundingBox.getSideFromIntersection(intersect);\r\n    }\r\n    /**\r\n     * Draw a debug bounding box\r\n     * @param ex\r\n     * @param color\r\n     */\r\n    draw(ex, color = Color.Yellow) {\r\n        ex.debug.drawRect(this.left, this.top, this.width, this.height, { color });\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Future.ts\n/**\r\n * Future is a wrapper around a native browser Promise to allow resolving/rejecting at any time\r\n */\r\nclass Future {\r\n    constructor() {\r\n        this._isCompleted = false;\r\n        this.promise = new Promise((resolve, reject) => {\r\n            this._resolver = resolve;\r\n            this._rejecter = reject;\r\n        });\r\n    }\r\n    get isCompleted() {\r\n        return this._isCompleted;\r\n    }\r\n    resolve(value) {\r\n        if (this._isCompleted) {\r\n            return;\r\n        }\r\n        this._isCompleted = true;\r\n        this._resolver(value);\r\n    }\r\n    reject(error) {\r\n        if (this._isCompleted) {\r\n            return;\r\n        }\r\n        this._isCompleted = true;\r\n        this._rejecter(error);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Util.ts\n\r\n\r\n/**\r\n * Find the screen position of an HTML element\r\n */\r\nfunction getPosition(el) {\r\n    let oLeft = 0, oTop = 0;\r\n    const calcOffsetLeft = (parent) => {\r\n        oLeft += parent.offsetLeft;\r\n        if (parent.offsetParent) {\r\n            calcOffsetLeft(parent.offsetParent);\r\n        }\r\n    };\r\n    const calcOffsetTop = (parent) => {\r\n        oTop += parent.offsetTop;\r\n        if (parent.offsetParent) {\r\n            calcOffsetTop(parent.offsetParent);\r\n        }\r\n    };\r\n    calcOffsetLeft(el);\r\n    calcOffsetTop(el);\r\n    return new Vector(oLeft, oTop);\r\n}\r\n/**\r\n * Add an item to an array list if it doesn't already exist. Returns true if added, false if not and already exists in the array.\r\n * @deprecated Will be removed in v0.26.0\r\n */\r\nfunction addItemToArray(item, array) {\r\n    if (array.indexOf(item) === -1) {\r\n        array.push(item);\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * Remove an item from an list\r\n * @deprecated Will be removed in v0.26.0\r\n */\r\nfunction removeItemFromArray(item, array) {\r\n    let index = -1;\r\n    if ((index = array.indexOf(item)) > -1) {\r\n        array.splice(index, 1);\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * See if an array contains something\r\n */\r\nfunction contains(array, obj) {\r\n    for (let i = 0; i < array.length; i++) {\r\n        if (array[i] === obj) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * Used for exhaustive checks at compile time\r\n */\r\nfunction fail(message) {\r\n    throw new Error(message);\r\n}\r\n/**\r\n * Create a promise that resolves after a certain number of milliseconds\r\n *\r\n * It is strongly recommended you pass the excalibur clock so delays are bound to the\r\n * excalibur clock which would be unaffected by stop/pause.\r\n * @param milliseconds\r\n * @param clock\r\n */\r\nfunction delay(milliseconds, clock) {\r\n    var _a;\r\n    const future = new Future();\r\n    const schedule = (_a = clock === null || clock === void 0 ? void 0 : clock.schedule.bind(clock)) !== null && _a !== void 0 ? _a : setTimeout;\r\n    schedule(() => {\r\n        future.resolve();\r\n    }, milliseconds);\r\n    return future.promise;\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/matrix.ts\n\r\n\r\n\r\nvar MatrixLocations;\r\n(function (MatrixLocations) {\r\n    MatrixLocations[MatrixLocations[\"X\"] = 12] = \"X\";\r\n    MatrixLocations[MatrixLocations[\"Y\"] = 13] = \"Y\";\r\n})(MatrixLocations || (MatrixLocations = {}));\r\n/**\r\n * Excalibur Matrix helper for 4x4 matrices\r\n *\r\n * Useful for webgl 4x4 matrices\r\n */\r\nclass Matrix {\r\n    constructor() {\r\n        /**\r\n         *  4x4 matrix in column major order\r\n         *\r\n         * |         |         |          |          |\r\n         * | ------- | ------- | -------- | -------- |\r\n         * | data[0] | data[4] | data[8]  | data[12] |\r\n         * | data[1] | data[5] | data[9]  | data[13] |\r\n         * | data[2] | data[6] | data[10] | data[14] |\r\n         * | data[3] | data[7] | data[11] | data[15] |\r\n         *\r\n         */\r\n        this.data = new Float32Array(16);\r\n        this._scaleX = 1;\r\n        this._scaleSignX = 1;\r\n        this._scaleY = 1;\r\n        this._scaleSignY = 1;\r\n    }\r\n    /**\r\n     * Creates an orthographic (flat non-perspective) projection\r\n     * https://en.wikipedia.org/wiki/Orthographic_projection\r\n     * @param left\r\n     * @param right\r\n     * @param bottom\r\n     * @param top\r\n     * @param near\r\n     * @param far\r\n     */\r\n    static ortho(left, right, bottom, top, near, far) {\r\n        const mat = new Matrix();\r\n        mat.data[0] = 2 / (right - left);\r\n        mat.data[1] = 0;\r\n        mat.data[2] = 0;\r\n        mat.data[3] = 0;\r\n        mat.data[4] = 0;\r\n        mat.data[5] = 2 / (top - bottom);\r\n        mat.data[6] = 0;\r\n        mat.data[7] = 0;\r\n        mat.data[8] = 0;\r\n        mat.data[9] = 0;\r\n        mat.data[10] = -2 / (far - near);\r\n        mat.data[11] = 0;\r\n        mat.data[12] = -(right + left) / (right - left);\r\n        mat.data[13] = -(top + bottom) / (top - bottom);\r\n        mat.data[14] = -(far + near) / (far - near);\r\n        mat.data[15] = 1;\r\n        return mat;\r\n    }\r\n    /**\r\n     * Creates a new Matrix with the same data as the current 4x4\r\n     */\r\n    clone(dest) {\r\n        const mat = dest || new Matrix();\r\n        mat.data[0] = this.data[0];\r\n        mat.data[1] = this.data[1];\r\n        mat.data[2] = this.data[2];\r\n        mat.data[3] = this.data[3];\r\n        mat.data[4] = this.data[4];\r\n        mat.data[5] = this.data[5];\r\n        mat.data[6] = this.data[6];\r\n        mat.data[7] = this.data[7];\r\n        mat.data[8] = this.data[8];\r\n        mat.data[9] = this.data[9];\r\n        mat.data[10] = this.data[10];\r\n        mat.data[11] = this.data[11];\r\n        mat.data[12] = this.data[12];\r\n        mat.data[13] = this.data[13];\r\n        mat.data[14] = this.data[14];\r\n        mat.data[15] = this.data[15];\r\n        return mat;\r\n    }\r\n    /**\r\n     * Converts the current matrix into a DOMMatrix\r\n     *\r\n     * This is useful when working with the browser Canvas context\r\n     * @returns {DOMMatrix} DOMMatrix\r\n     */\r\n    toDOMMatrix() {\r\n        return new DOMMatrix([...this.data]);\r\n    }\r\n    static fromFloat32Array(data) {\r\n        const matrix = new Matrix();\r\n        matrix.data = data;\r\n        return matrix;\r\n    }\r\n    /**\r\n     * Creates a new identity matrix (a matrix that when applied does nothing)\r\n     */\r\n    static identity() {\r\n        const mat = new Matrix();\r\n        mat.data[0] = 1;\r\n        mat.data[1] = 0;\r\n        mat.data[2] = 0;\r\n        mat.data[3] = 0;\r\n        mat.data[4] = 0;\r\n        mat.data[5] = 1;\r\n        mat.data[6] = 0;\r\n        mat.data[7] = 0;\r\n        mat.data[8] = 0;\r\n        mat.data[9] = 0;\r\n        mat.data[10] = 1;\r\n        mat.data[11] = 0;\r\n        mat.data[12] = 0;\r\n        mat.data[13] = 0;\r\n        mat.data[14] = 0;\r\n        mat.data[15] = 1;\r\n        return mat;\r\n    }\r\n    /**\r\n     * Resets the current matrix to the identity matrix, mutating it\r\n     * @returns {Matrix} Current matrix as identity\r\n     */\r\n    reset() {\r\n        const mat = this;\r\n        mat.data[0] = 1;\r\n        mat.data[1] = 0;\r\n        mat.data[2] = 0;\r\n        mat.data[3] = 0;\r\n        mat.data[4] = 0;\r\n        mat.data[5] = 1;\r\n        mat.data[6] = 0;\r\n        mat.data[7] = 0;\r\n        mat.data[8] = 0;\r\n        mat.data[9] = 0;\r\n        mat.data[10] = 1;\r\n        mat.data[11] = 0;\r\n        mat.data[12] = 0;\r\n        mat.data[13] = 0;\r\n        mat.data[14] = 0;\r\n        mat.data[15] = 1;\r\n        return mat;\r\n    }\r\n    /**\r\n     * Creates a brand new translation matrix at the specified 3d point\r\n     * @param x\r\n     * @param y\r\n     */\r\n    static translation(x, y) {\r\n        const mat = Matrix.identity();\r\n        mat.data[12] = x;\r\n        mat.data[13] = y;\r\n        return mat;\r\n    }\r\n    /**\r\n     * Creates a brand new scaling matrix with the specified scaling factor\r\n     * @param sx\r\n     * @param sy\r\n     */\r\n    static scale(sx, sy) {\r\n        const mat = Matrix.identity();\r\n        mat.data[0] = sx;\r\n        mat.data[5] = sy;\r\n        mat.data[10] = 1;\r\n        mat.data[15] = 1;\r\n        return mat;\r\n    }\r\n    /**\r\n     * Creates a brand new rotation matrix with the specified angle\r\n     * @param angleRadians\r\n     */\r\n    static rotation(angleRadians) {\r\n        const mat = Matrix.identity();\r\n        mat.data[0] = Math.cos(angleRadians);\r\n        mat.data[4] = -Math.sin(angleRadians);\r\n        mat.data[1] = Math.sin(angleRadians);\r\n        mat.data[5] = Math.cos(angleRadians);\r\n        return mat;\r\n    }\r\n    multiply(vectorOrMatrix, dest) {\r\n        if (vectorOrMatrix instanceof Vector) {\r\n            const result = dest || new Vector(0, 0);\r\n            const vector = vectorOrMatrix;\r\n            // these shenanigans are to allow dest and vector to be the same instance\r\n            const resultX = vector.x * this.data[0] + vector.y * this.data[4] + this.data[12];\r\n            const resultY = vector.x * this.data[1] + vector.y * this.data[5] + this.data[13];\r\n            result.x = resultX;\r\n            result.y = resultY;\r\n            return result;\r\n        }\r\n        else {\r\n            const result = dest || new Matrix();\r\n            const other = vectorOrMatrix;\r\n            const a11 = this.data[0];\r\n            const a21 = this.data[1];\r\n            const a31 = this.data[2];\r\n            const a41 = this.data[3];\r\n            const a12 = this.data[4];\r\n            const a22 = this.data[5];\r\n            const a32 = this.data[6];\r\n            const a42 = this.data[7];\r\n            const a13 = this.data[8];\r\n            const a23 = this.data[9];\r\n            const a33 = this.data[10];\r\n            const a43 = this.data[11];\r\n            const a14 = this.data[12];\r\n            const a24 = this.data[13];\r\n            const a34 = this.data[14];\r\n            const a44 = this.data[15];\r\n            const b11 = other.data[0];\r\n            const b21 = other.data[1];\r\n            const b31 = other.data[2];\r\n            const b41 = other.data[3];\r\n            const b12 = other.data[4];\r\n            const b22 = other.data[5];\r\n            const b32 = other.data[6];\r\n            const b42 = other.data[7];\r\n            const b13 = other.data[8];\r\n            const b23 = other.data[9];\r\n            const b33 = other.data[10];\r\n            const b43 = other.data[11];\r\n            const b14 = other.data[12];\r\n            const b24 = other.data[13];\r\n            const b34 = other.data[14];\r\n            const b44 = other.data[15];\r\n            result.data[0] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;\r\n            result.data[1] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;\r\n            result.data[2] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;\r\n            result.data[3] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;\r\n            result.data[4] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;\r\n            result.data[5] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;\r\n            result.data[6] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;\r\n            result.data[7] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;\r\n            result.data[8] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;\r\n            result.data[9] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;\r\n            result.data[10] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;\r\n            result.data[11] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;\r\n            result.data[12] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;\r\n            result.data[13] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;\r\n            result.data[14] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;\r\n            result.data[15] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;\r\n            const s = this.getScale();\r\n            result._scaleSignX = sign(s.x) * sign(result._scaleSignX);\r\n            result._scaleSignY = sign(s.y) * sign(result._scaleSignY);\r\n            return result;\r\n        }\r\n    }\r\n    /**\r\n     * Applies translation to the current matrix mutating it\r\n     * @param x\r\n     * @param y\r\n     */\r\n    translate(x, y) {\r\n        const a11 = this.data[0];\r\n        const a21 = this.data[1];\r\n        const a31 = this.data[2];\r\n        const a41 = this.data[3];\r\n        const a12 = this.data[4];\r\n        const a22 = this.data[5];\r\n        const a32 = this.data[6];\r\n        const a42 = this.data[7];\r\n        const a13 = this.data[8];\r\n        const a23 = this.data[9];\r\n        const a33 = this.data[10];\r\n        const a43 = this.data[11];\r\n        const a14 = this.data[12];\r\n        const a24 = this.data[13];\r\n        const a34 = this.data[14];\r\n        const a44 = this.data[15];\r\n        // Doesn't change z\r\n        const z = 0;\r\n        const w = 1;\r\n        this.data[12] = a11 * x + a12 * y + a13 * z + a14 * w;\r\n        this.data[13] = a21 * x + a22 * y + a23 * z + a24 * w;\r\n        this.data[14] = a31 * x + a32 * y + a33 * z + a34 * w;\r\n        this.data[15] = a41 * x + a42 * y + a43 * z + a44 * w;\r\n        return this;\r\n    }\r\n    setPosition(x, y) {\r\n        this.data[12] = x;\r\n        this.data[13] = y;\r\n    }\r\n    getPosition() {\r\n        return vec(this.data[12], this.data[13]);\r\n    }\r\n    /**\r\n     * Applies rotation to the current matrix mutating it\r\n     * @param angle in Radians\r\n     */\r\n    rotate(angle) {\r\n        const a11 = this.data[0];\r\n        const a21 = this.data[1];\r\n        const a31 = this.data[2];\r\n        const a41 = this.data[3];\r\n        const a12 = this.data[4];\r\n        const a22 = this.data[5];\r\n        const a32 = this.data[6];\r\n        const a42 = this.data[7];\r\n        const sine = Math.sin(angle);\r\n        const cosine = Math.cos(angle);\r\n        this.data[0] = cosine * a11 + sine * a12;\r\n        this.data[1] = cosine * a21 + sine * a22;\r\n        this.data[2] = cosine * a31 + sine * a32;\r\n        this.data[3] = cosine * a41 + sine * a42;\r\n        this.data[4] = cosine * a12 - sine * a11;\r\n        this.data[5] = cosine * a22 - sine * a21;\r\n        this.data[6] = cosine * a32 - sine * a31;\r\n        this.data[7] = cosine * a42 - sine * a41;\r\n        return this;\r\n    }\r\n    /**\r\n     * Applies scaling to the current matrix mutating it\r\n     * @param x\r\n     * @param y\r\n     */\r\n    scale(x, y) {\r\n        const a11 = this.data[0];\r\n        const a21 = this.data[1];\r\n        const a31 = this.data[2];\r\n        const a41 = this.data[3];\r\n        const a12 = this.data[4];\r\n        const a22 = this.data[5];\r\n        const a32 = this.data[6];\r\n        const a42 = this.data[7];\r\n        this.data[0] = a11 * x;\r\n        this.data[1] = a21 * x;\r\n        this.data[2] = a31 * x;\r\n        this.data[3] = a41 * x;\r\n        this.data[4] = a12 * y;\r\n        this.data[5] = a22 * y;\r\n        this.data[6] = a32 * y;\r\n        this.data[7] = a42 * y;\r\n        return this;\r\n    }\r\n    setRotation(angle) {\r\n        const currentScale = this.getScale();\r\n        const sine = Math.sin(angle);\r\n        const cosine = Math.cos(angle);\r\n        this.data[0] = cosine * currentScale.x;\r\n        this.data[1] = sine * currentScale.y;\r\n        this.data[4] = -sine * currentScale.x;\r\n        this.data[5] = cosine * currentScale.y;\r\n    }\r\n    getRotation() {\r\n        const angle = Math.atan2(this.data[1] / this.getScaleY(), this.data[0] / this.getScaleX());\r\n        return canonicalizeAngle(angle);\r\n    }\r\n    getScaleX() {\r\n        // absolute scale of the matrix (we lose sign so need to add it back)\r\n        const xscale = vec(this.data[0], this.data[4]).size;\r\n        return this._scaleSignX * xscale;\r\n    }\r\n    getScaleY() {\r\n        // absolute scale of the matrix (we lose sign so need to add it back)\r\n        const yscale = vec(this.data[1], this.data[5]).size;\r\n        return this._scaleSignY * yscale;\r\n    }\r\n    /**\r\n     * Get the scale of the matrix\r\n     */\r\n    getScale() {\r\n        return vec(this.getScaleX(), this.getScaleY());\r\n    }\r\n    setScaleX(val) {\r\n        if (this._scaleX === val) {\r\n            return;\r\n        }\r\n        this._scaleSignX = sign(val);\r\n        // negative scale acts like a 180 rotation, so flip\r\n        const xscale = vec(this.data[0] * this._scaleSignX, this.data[4] * this._scaleSignX).normalize();\r\n        this.data[0] = xscale.x * val;\r\n        this.data[4] = xscale.y * val;\r\n        this._scaleX = val;\r\n    }\r\n    setScaleY(val) {\r\n        if (this._scaleY === val) {\r\n            return;\r\n        }\r\n        this._scaleSignY = sign(val);\r\n        // negative scale acts like a 180 rotation, so flip\r\n        const yscale = vec(this.data[1] * this._scaleSignY, this.data[5] * this._scaleSignY).normalize();\r\n        this.data[1] = yscale.x * val;\r\n        this.data[5] = yscale.y * val;\r\n        this._scaleY = val;\r\n    }\r\n    setScale(scale) {\r\n        this.setScaleX(scale.x);\r\n        this.setScaleY(scale.y);\r\n    }\r\n    /**\r\n     * Determinant of the upper left 2x2 matrix\r\n     */\r\n    getBasisDeterminant() {\r\n        return this.data[0] * this.data[5] - this.data[1] * this.data[4];\r\n    }\r\n    /**\r\n     * Return the affine inverse, optionally store it in a target matrix.\r\n     *\r\n     * It's recommended you call .reset() the target unless you know what you're doing\r\n     * @param target\r\n     */\r\n    getAffineInverse(target) {\r\n        // See http://negativeprobability.blogspot.com/2011/11/affine-transformations-and-their.html\r\n        // See https://www.mathsisfun.com/algebra/matrix-inverse.html\r\n        // Since we are actually only doing 2D transformations we can use this hack\r\n        // We don't actually use the 3rd or 4th dimension\r\n        const det = this.getBasisDeterminant();\r\n        const inverseDet = 1 / det; // todo zero check\r\n        const a = this.data[0];\r\n        const b = this.data[4];\r\n        const c = this.data[1];\r\n        const d = this.data[5];\r\n        const m = target || Matrix.identity();\r\n        // inverts rotation and scale\r\n        m.data[0] = d * inverseDet;\r\n        m.data[1] = -c * inverseDet;\r\n        m.data[4] = -b * inverseDet;\r\n        m.data[5] = a * inverseDet;\r\n        const tx = this.data[12];\r\n        const ty = this.data[13];\r\n        // invert translation\r\n        // transform translation into the matrix basis created by rot/scale\r\n        m.data[12] = -(tx * m.data[0] + ty * m.data[4]);\r\n        m.data[13] = -(tx * m.data[1] + ty * m.data[5]);\r\n        return m;\r\n    }\r\n    isIdentity() {\r\n        return (this.data[0] === 1 &&\r\n            this.data[1] === 0 &&\r\n            this.data[2] === 0 &&\r\n            this.data[3] === 0 &&\r\n            this.data[4] === 0 &&\r\n            this.data[5] === 1 &&\r\n            this.data[6] === 0 &&\r\n            this.data[7] === 0 &&\r\n            this.data[8] === 0 &&\r\n            this.data[9] === 0 &&\r\n            this.data[10] === 1 &&\r\n            this.data[11] === 0 &&\r\n            this.data[12] === 0 &&\r\n            this.data[13] === 0 &&\r\n            this.data[14] === 0 &&\r\n            this.data[15] === 1);\r\n    }\r\n    toString() {\r\n        return `\r\n[${this.data[0]} ${this.data[4]} ${this.data[8]} ${this.data[12]}]\r\n[${this.data[1]} ${this.data[5]} ${this.data[9]} ${this.data[13]}]\r\n[${this.data[2]} ${this.data[6]} ${this.data[10]} ${this.data[14]}]\r\n[${this.data[3]} ${this.data[7]} ${this.data[11]} ${this.data[15]}]\r\n`;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/affine-matrix.ts\n\r\n\r\n\r\nclass AffineMatrix {\r\n    constructor() {\r\n        /**\r\n         * |         |         |          |\r\n         * | ------- | ------- | -------- |\r\n         * | data[0] | data[2] | data[4]  |\r\n         * | data[1] | data[3] | data[5]  |\r\n         * |   0     |    0    |    1     |\r\n         */\r\n        this.data = new Float64Array(6);\r\n        this._scale = new Float64Array([1, 1]);\r\n        this._scaleSignX = 1;\r\n        this._scaleSignY = 1;\r\n    }\r\n    /**\r\n     * Converts the current matrix into a DOMMatrix\r\n     *\r\n     * This is useful when working with the browser Canvas context\r\n     * @returns {DOMMatrix} DOMMatrix\r\n     */\r\n    toDOMMatrix() {\r\n        return new DOMMatrix([...this.data]);\r\n    }\r\n    static identity() {\r\n        const mat = new AffineMatrix();\r\n        mat.data[0] = 1;\r\n        mat.data[1] = 0;\r\n        mat.data[2] = 0;\r\n        mat.data[3] = 1;\r\n        mat.data[4] = 0;\r\n        mat.data[5] = 0;\r\n        return mat;\r\n    }\r\n    /**\r\n     * Creates a brand new translation matrix at the specified 3d point\r\n     * @param x\r\n     * @param y\r\n     */\r\n    static translation(x, y) {\r\n        const mat = AffineMatrix.identity();\r\n        mat.data[4] = x;\r\n        mat.data[5] = y;\r\n        return mat;\r\n    }\r\n    /**\r\n     * Creates a brand new scaling matrix with the specified scaling factor\r\n     * @param sx\r\n     * @param sy\r\n     */\r\n    static scale(sx, sy) {\r\n        const mat = AffineMatrix.identity();\r\n        mat.data[0] = sx;\r\n        mat.data[3] = sy;\r\n        mat._scale[0] = sx;\r\n        mat._scale[1] = sy;\r\n        return mat;\r\n    }\r\n    /**\r\n     * Creates a brand new rotation matrix with the specified angle\r\n     * @param angleRadians\r\n     */\r\n    static rotation(angleRadians) {\r\n        const mat = AffineMatrix.identity();\r\n        mat.data[0] = Math.cos(angleRadians);\r\n        mat.data[1] = Math.sin(angleRadians);\r\n        mat.data[2] = -Math.sin(angleRadians);\r\n        mat.data[3] = Math.cos(angleRadians);\r\n        return mat;\r\n    }\r\n    setPosition(x, y) {\r\n        this.data[4] = x;\r\n        this.data[5] = y;\r\n    }\r\n    getPosition() {\r\n        return vec(this.data[4], this.data[5]);\r\n    }\r\n    /**\r\n     * Applies rotation to the current matrix mutating it\r\n     * @param angle in Radians\r\n     */\r\n    rotate(angle) {\r\n        const a11 = this.data[0];\r\n        const a21 = this.data[1];\r\n        const a12 = this.data[2];\r\n        const a22 = this.data[3];\r\n        const sine = Math.sin(angle);\r\n        const cosine = Math.cos(angle);\r\n        this.data[0] = cosine * a11 + sine * a12;\r\n        this.data[1] = cosine * a21 + sine * a22;\r\n        this.data[2] = cosine * a12 - sine * a11;\r\n        this.data[3] = cosine * a22 - sine * a21;\r\n        return this;\r\n    }\r\n    /**\r\n     * Applies translation to the current matrix mutating it\r\n     * @param x\r\n     * @param y\r\n     */\r\n    translate(x, y) {\r\n        const a11 = this.data[0];\r\n        const a21 = this.data[1];\r\n        // const a31 = 0;\r\n        const a12 = this.data[2];\r\n        const a22 = this.data[3];\r\n        // const a32 = 0;\r\n        const a13 = this.data[4];\r\n        const a23 = this.data[5];\r\n        // const a33 = 1;\r\n        // Doesn't change z\r\n        this.data[4] = a11 * x + a12 * y + a13;\r\n        this.data[5] = a21 * x + a22 * y + a23;\r\n        return this;\r\n    }\r\n    /**\r\n     * Applies scaling to the current matrix mutating it\r\n     * @param x\r\n     * @param y\r\n     */\r\n    scale(x, y) {\r\n        const a11 = this.data[0];\r\n        const a21 = this.data[1];\r\n        const a12 = this.data[2];\r\n        const a22 = this.data[3];\r\n        this.data[0] = a11 * x;\r\n        this.data[1] = a21 * x;\r\n        this.data[2] = a12 * y;\r\n        this.data[3] = a22 * y;\r\n        this._scale[0] = x;\r\n        this._scale[1] = y;\r\n        return this;\r\n    }\r\n    determinant() {\r\n        return this.data[0] * this.data[3] - this.data[1] * this.data[2];\r\n    }\r\n    /**\r\n     * Return the affine inverse, optionally store it in a target matrix.\r\n     *\r\n     * It's recommended you call .reset() the target unless you know what you're doing\r\n     * @param target\r\n     */\r\n    inverse(target) {\r\n        // See http://negativeprobability.blogspot.com/2011/11/affine-transformations-and-their.html\r\n        // See https://www.mathsisfun.com/algebra/matrix-inverse.html\r\n        // Since we are actually only doing 2D transformations we can use this hack\r\n        // We don't actually use the 3rd or 4th dimension\r\n        const det = this.determinant();\r\n        const inverseDet = 1 / det; // TODO zero check\r\n        const a = this.data[0];\r\n        const b = this.data[2];\r\n        const c = this.data[1];\r\n        const d = this.data[3];\r\n        const m = target || AffineMatrix.identity();\r\n        // inverts rotation and scale\r\n        m.data[0] = d * inverseDet;\r\n        m.data[1] = -c * inverseDet;\r\n        m.data[2] = -b * inverseDet;\r\n        m.data[3] = a * inverseDet;\r\n        const tx = this.data[4];\r\n        const ty = this.data[5];\r\n        // invert translation\r\n        // transform translation into the matrix basis created by rot/scale\r\n        m.data[4] = -(tx * m.data[0] + ty * m.data[2]);\r\n        m.data[5] = -(tx * m.data[1] + ty * m.data[3]);\r\n        return m;\r\n    }\r\n    multiply(vectorOrMatrix, dest) {\r\n        if (vectorOrMatrix instanceof Vector) {\r\n            const result = dest || new Vector(0, 0);\r\n            const vector = vectorOrMatrix;\r\n            // these shenanigans are to allow dest and vector to be the same instance\r\n            const resultX = vector.x * this.data[0] + vector.y * this.data[2] + this.data[4];\r\n            const resultY = vector.x * this.data[1] + vector.y * this.data[3] + this.data[5];\r\n            result.x = resultX;\r\n            result.y = resultY;\r\n            return result;\r\n        }\r\n        else {\r\n            const result = dest || new AffineMatrix();\r\n            const other = vectorOrMatrix;\r\n            const a11 = this.data[0];\r\n            const a21 = this.data[1];\r\n            //  const a31 = 0;\r\n            const a12 = this.data[2];\r\n            const a22 = this.data[3];\r\n            //  const a32 = 0;\r\n            const a13 = this.data[4];\r\n            const a23 = this.data[5];\r\n            //  const a33 = 1;\r\n            const b11 = other.data[0];\r\n            const b21 = other.data[1];\r\n            //  const b31 = 0;\r\n            const b12 = other.data[2];\r\n            const b22 = other.data[3];\r\n            //  const b32 = 0;\r\n            const b13 = other.data[4];\r\n            const b23 = other.data[5];\r\n            //  const b33 = 1;\r\n            result.data[0] = a11 * b11 + a12 * b21; // + a13 * b31; // zero\r\n            result.data[1] = a21 * b11 + a22 * b21; // + a23 * b31; // zero\r\n            result.data[2] = a11 * b12 + a12 * b22; // + a13 * b32; // zero\r\n            result.data[3] = a21 * b12 + a22 * b22; // + a23 * b32; // zero\r\n            result.data[4] = a11 * b13 + a12 * b23 + a13; // * b33; // one\r\n            result.data[5] = a21 * b13 + a22 * b23 + a23; // * b33; // one\r\n            const s = this.getScale();\r\n            result._scaleSignX = sign(s.x) * sign(result._scaleSignX);\r\n            result._scaleSignY = sign(s.y) * sign(result._scaleSignY);\r\n            return result;\r\n        }\r\n    }\r\n    to4x4() {\r\n        const mat = new Matrix();\r\n        mat.data[0] = this.data[0];\r\n        mat.data[1] = this.data[1];\r\n        mat.data[2] = 0;\r\n        mat.data[3] = 0;\r\n        mat.data[4] = this.data[2];\r\n        mat.data[5] = this.data[3];\r\n        mat.data[6] = 0;\r\n        mat.data[7] = 0;\r\n        mat.data[8] = 0;\r\n        mat.data[9] = 0;\r\n        mat.data[10] = 1;\r\n        mat.data[11] = 0;\r\n        mat.data[12] = this.data[4];\r\n        mat.data[13] = this.data[5];\r\n        mat.data[14] = 0;\r\n        mat.data[15] = 1;\r\n        return mat;\r\n    }\r\n    setRotation(angle) {\r\n        const currentScale = this.getScale();\r\n        const sine = Math.sin(angle);\r\n        const cosine = Math.cos(angle);\r\n        this.data[0] = cosine * currentScale.x;\r\n        this.data[1] = sine * currentScale.y;\r\n        this.data[2] = -sine * currentScale.x;\r\n        this.data[3] = cosine * currentScale.y;\r\n    }\r\n    getRotation() {\r\n        const angle = Math.atan2(this.data[1] / this.getScaleY(), this.data[0] / this.getScaleX());\r\n        return canonicalizeAngle(angle);\r\n    }\r\n    getScaleX() {\r\n        // absolute scale of the matrix (we lose sign so need to add it back)\r\n        const xscale = vec(this.data[0], this.data[2]).distance();\r\n        return this._scaleSignX * xscale;\r\n    }\r\n    getScaleY() {\r\n        // absolute scale of the matrix (we lose sign so need to add it back)\r\n        const yscale = vec(this.data[1], this.data[3]).distance();\r\n        return this._scaleSignY * yscale;\r\n    }\r\n    /**\r\n     * Get the scale of the matrix\r\n     */\r\n    getScale() {\r\n        return vec(this.getScaleX(), this.getScaleY());\r\n    }\r\n    setScaleX(val) {\r\n        if (val === this._scale[0]) {\r\n            return;\r\n        }\r\n        this._scaleSignX = sign(val);\r\n        // negative scale acts like a 180 rotation, so flip\r\n        const xscale = vec(this.data[0] * this._scaleSignX, this.data[2] * this._scaleSignX).normalize();\r\n        this.data[0] = xscale.x * val;\r\n        this.data[2] = xscale.y * val;\r\n        this._scale[0] = val;\r\n    }\r\n    setScaleY(val) {\r\n        if (val === this._scale[1]) {\r\n            return;\r\n        }\r\n        this._scaleSignY = sign(val);\r\n        // negative scale acts like a 180 rotation, so flip\r\n        const yscale = vec(this.data[1] * this._scaleSignY, this.data[3] * this._scaleSignY).normalize();\r\n        this.data[1] = yscale.x * val;\r\n        this.data[3] = yscale.y * val;\r\n        this._scale[1] = val;\r\n    }\r\n    setScale(scale) {\r\n        this.setScaleX(scale.x);\r\n        this.setScaleY(scale.y);\r\n    }\r\n    isIdentity() {\r\n        return (this.data[0] === 1 &&\r\n            this.data[1] === 0 &&\r\n            this.data[2] === 0 &&\r\n            this.data[3] === 1 &&\r\n            this.data[4] === 0 &&\r\n            this.data[5] === 0);\r\n    }\r\n    /**\r\n     * Resets the current matrix to the identity matrix, mutating it\r\n     * @returns {AffineMatrix} Current matrix as identity\r\n     */\r\n    reset() {\r\n        const mat = this;\r\n        mat.data[0] = 1;\r\n        mat.data[1] = 0;\r\n        mat.data[2] = 0;\r\n        mat.data[3] = 1;\r\n        mat.data[4] = 0;\r\n        mat.data[5] = 0;\r\n        return mat;\r\n    }\r\n    /**\r\n     * Creates a new Matrix with the same data as the current 4x4\r\n     */\r\n    clone(dest) {\r\n        const mat = dest || new AffineMatrix();\r\n        mat.data[0] = this.data[0];\r\n        mat.data[1] = this.data[1];\r\n        mat.data[2] = this.data[2];\r\n        mat.data[3] = this.data[3];\r\n        mat.data[4] = this.data[4];\r\n        mat.data[5] = this.data[5];\r\n        return mat;\r\n    }\r\n    toString() {\r\n        return `\r\n[${this.data[0]} ${this.data[2]} ${this.data[4]}]\r\n[${this.data[1]} ${this.data[3]} ${this.data[5]}]\r\n[0 0 1]\r\n`;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/transform-stack.ts\n\r\nclass TransformStack {\r\n    constructor() {\r\n        this._transforms = [];\r\n        this._currentTransform = AffineMatrix.identity();\r\n    }\r\n    save() {\r\n        this._transforms.push(this._currentTransform);\r\n        this._currentTransform = this._currentTransform.clone();\r\n    }\r\n    restore() {\r\n        this._currentTransform = this._transforms.pop();\r\n    }\r\n    translate(x, y) {\r\n        return this._currentTransform.translate(x, y);\r\n    }\r\n    rotate(angle) {\r\n        return this._currentTransform.rotate(angle);\r\n    }\r\n    scale(x, y) {\r\n        return this._currentTransform.scale(x, y);\r\n    }\r\n    set current(matrix) {\r\n        this._currentTransform = matrix;\r\n    }\r\n    get current() {\r\n        return this._currentTransform;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/state-stack.ts\n\r\nclass StateStack {\r\n    constructor() {\r\n        this._states = [];\r\n        this._currentState = this._getDefaultState();\r\n    }\r\n    _getDefaultState() {\r\n        return {\r\n            opacity: 1,\r\n            z: 0,\r\n            tint: Color.White\r\n        };\r\n    }\r\n    _cloneState() {\r\n        return {\r\n            opacity: this._currentState.opacity,\r\n            z: this._currentState.z,\r\n            tint: this._currentState.tint.clone()\r\n        };\r\n    }\r\n    save() {\r\n        this._states.push(this._currentState);\r\n        this._currentState = this._cloneState();\r\n    }\r\n    restore() {\r\n        this._currentState = this._states.pop();\r\n    }\r\n    get current() {\r\n        return this._currentState;\r\n    }\r\n    set current(val) {\r\n        this._currentState = val;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Events.ts\nvar EventTypes;\r\n(function (EventTypes) {\r\n    EventTypes[\"Kill\"] = \"kill\";\r\n    EventTypes[\"PreKill\"] = \"prekill\";\r\n    EventTypes[\"PostKill\"] = \"postkill\";\r\n    EventTypes[\"PreDraw\"] = \"predraw\";\r\n    EventTypes[\"PostDraw\"] = \"postdraw\";\r\n    EventTypes[\"PreDebugDraw\"] = \"predebugdraw\";\r\n    EventTypes[\"PostDebugDraw\"] = \"postdebugdraw\";\r\n    EventTypes[\"PreUpdate\"] = \"preupdate\";\r\n    EventTypes[\"PostUpdate\"] = \"postupdate\";\r\n    EventTypes[\"PreFrame\"] = \"preframe\";\r\n    EventTypes[\"PostFrame\"] = \"postframe\";\r\n    EventTypes[\"PreCollision\"] = \"precollision\";\r\n    EventTypes[\"CollisionStart\"] = \"collisionstart\";\r\n    EventTypes[\"CollisionEnd\"] = \"collisionend\";\r\n    EventTypes[\"PostCollision\"] = \"postcollision\";\r\n    EventTypes[\"Initialize\"] = \"initialize\";\r\n    EventTypes[\"Activate\"] = \"activate\";\r\n    EventTypes[\"Deactivate\"] = \"deactivate\";\r\n    EventTypes[\"ExitViewport\"] = \"exitviewport\";\r\n    EventTypes[\"EnterViewport\"] = \"enterviewport\";\r\n    EventTypes[\"ExitTrigger\"] = \"exit\";\r\n    EventTypes[\"EnterTrigger\"] = \"enter\";\r\n    EventTypes[\"Connect\"] = \"connect\";\r\n    EventTypes[\"Disconnect\"] = \"disconnect\";\r\n    EventTypes[\"Button\"] = \"button\";\r\n    EventTypes[\"Axis\"] = \"axis\";\r\n    EventTypes[\"Visible\"] = \"visible\";\r\n    EventTypes[\"Hidden\"] = \"hidden\";\r\n    EventTypes[\"Start\"] = \"start\";\r\n    EventTypes[\"Stop\"] = \"stop\";\r\n    EventTypes[\"PointerUp\"] = \"pointerup\";\r\n    EventTypes[\"PointerDown\"] = \"pointerdown\";\r\n    EventTypes[\"PointerMove\"] = \"pointermove\";\r\n    EventTypes[\"PointerEnter\"] = \"pointerenter\";\r\n    EventTypes[\"PointerLeave\"] = \"pointerleave\";\r\n    EventTypes[\"PointerCancel\"] = \"pointercancel\";\r\n    EventTypes[\"PointerWheel\"] = \"pointerwheel\";\r\n    EventTypes[\"Up\"] = \"up\";\r\n    EventTypes[\"Down\"] = \"down\";\r\n    EventTypes[\"Move\"] = \"move\";\r\n    EventTypes[\"Enter\"] = \"enter\";\r\n    EventTypes[\"Leave\"] = \"leave\";\r\n    EventTypes[\"Cancel\"] = \"cancel\";\r\n    EventTypes[\"Wheel\"] = \"wheel\";\r\n    EventTypes[\"Press\"] = \"press\";\r\n    EventTypes[\"Release\"] = \"release\";\r\n    EventTypes[\"Hold\"] = \"hold\";\r\n    EventTypes[\"PointerDragStart\"] = \"pointerdragstart\";\r\n    EventTypes[\"PointerDragEnd\"] = \"pointerdragend\";\r\n    EventTypes[\"PointerDragEnter\"] = \"pointerdragenter\";\r\n    EventTypes[\"PointerDragLeave\"] = \"pointerdragleave\";\r\n    EventTypes[\"PointerDragMove\"] = \"pointerdragmove\";\r\n})(EventTypes || (EventTypes = {}));\r\n/**\r\n * Base event type in Excalibur that all other event types derive from. Not all event types are thrown on all Excalibur game objects,\r\n * some events are unique to a type, others are not.\r\n *\r\n */\r\nclass GameEvent {\r\n    constructor() {\r\n        this._bubbles = true;\r\n    }\r\n    /**\r\n     * If set to false, prevents event from propagating to other actors. If true it will be propagated\r\n     * to all actors that apply.\r\n     */\r\n    get bubbles() {\r\n        return this._bubbles;\r\n    }\r\n    set bubbles(value) {\r\n        this._bubbles = value;\r\n    }\r\n    /**\r\n     * Prevents event from bubbling\r\n     */\r\n    stopPropagation() {\r\n        this.bubbles = false;\r\n    }\r\n}\r\n/**\r\n * The 'kill' event is emitted on actors when it is killed. The target is the actor that was killed.\r\n */\r\nclass KillEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'prekill' event is emitted directly before an actor is killed.\r\n */\r\nclass PreKillEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'postkill' event is emitted directly after the actor is killed.\r\n */\r\nclass PostKillEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'start' event is emitted on engine when has started and is ready for interaction.\r\n */\r\nclass GameStartEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'stop' event is emitted on engine when has been stopped and will no longer take input, update or draw.\r\n */\r\nclass GameStopEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'predraw' event is emitted on actors, scenes, and engine before drawing starts. Actors' predraw happens inside their graphics\r\n * transform so that all drawing takes place with the actor as the origin.\r\n *\r\n */\r\nclass PreDrawEvent extends GameEvent {\r\n    constructor(ctx, delta, target) {\r\n        super();\r\n        this.ctx = ctx;\r\n        this.delta = delta;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'postdraw' event is emitted on actors, scenes, and engine after drawing finishes. Actors' postdraw happens inside their graphics\r\n * transform so that all drawing takes place with the actor as the origin.\r\n *\r\n */\r\nclass PostDrawEvent extends GameEvent {\r\n    constructor(ctx, delta, target) {\r\n        super();\r\n        this.ctx = ctx;\r\n        this.delta = delta;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'predebugdraw' event is emitted on actors, scenes, and engine before debug drawing starts.\r\n */\r\nclass PreDebugDrawEvent extends GameEvent {\r\n    constructor(ctx, target) {\r\n        super();\r\n        this.ctx = ctx;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'postdebugdraw' event is emitted on actors, scenes, and engine after debug drawing starts.\r\n */\r\nclass PostDebugDrawEvent extends GameEvent {\r\n    constructor(ctx, target) {\r\n        super();\r\n        this.ctx = ctx;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'preupdate' event is emitted on actors, scenes, camera, and engine before the update starts.\r\n */\r\nclass PreUpdateEvent extends GameEvent {\r\n    constructor(engine, delta, target) {\r\n        super();\r\n        this.engine = engine;\r\n        this.delta = delta;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'postupdate' event is emitted on actors, scenes, camera, and engine after the update ends.\r\n */\r\nclass PostUpdateEvent extends GameEvent {\r\n    constructor(engine, delta, target) {\r\n        super();\r\n        this.engine = engine;\r\n        this.delta = delta;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'preframe' event is emitted on the engine, before the frame begins.\r\n */\r\nclass PreFrameEvent extends GameEvent {\r\n    constructor(engine, prevStats) {\r\n        super();\r\n        this.engine = engine;\r\n        this.prevStats = prevStats;\r\n        this.target = engine;\r\n    }\r\n}\r\n/**\r\n * The 'postframe' event is emitted on the engine, after a frame ends.\r\n */\r\nclass PostFrameEvent extends GameEvent {\r\n    constructor(engine, stats) {\r\n        super();\r\n        this.engine = engine;\r\n        this.stats = stats;\r\n        this.target = engine;\r\n    }\r\n}\r\n/**\r\n * Event received when a gamepad is connected to Excalibur. [[Gamepads]] receives this event.\r\n */\r\nclass GamepadConnectEvent extends GameEvent {\r\n    constructor(index, gamepad) {\r\n        super();\r\n        this.index = index;\r\n        this.gamepad = gamepad;\r\n        this.target = gamepad;\r\n    }\r\n}\r\n/**\r\n * Event received when a gamepad is disconnected from Excalibur. [[Gamepads]] receives this event.\r\n */\r\nclass GamepadDisconnectEvent extends GameEvent {\r\n    constructor(index, gamepad) {\r\n        super();\r\n        this.index = index;\r\n        this.gamepad = gamepad;\r\n        this.target = gamepad;\r\n    }\r\n}\r\n/**\r\n * Gamepad button event. See [[Gamepads]] for information on responding to controller input. [[Gamepad]] instances receive this event;\r\n */\r\nclass GamepadButtonEvent extends GameEvent {\r\n    /**\r\n     * @param button  The Gamepad button\r\n     * @param value   A numeric value between 0 and 1\r\n     */\r\n    constructor(button, value, target) {\r\n        super();\r\n        this.button = button;\r\n        this.value = value;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Gamepad axis event. See [[Gamepads]] for information on responding to controller input. [[Gamepad]] instances receive this event;\r\n */\r\nclass GamepadAxisEvent extends GameEvent {\r\n    /**\r\n     * @param axis  The Gamepad axis\r\n     * @param value A numeric value between -1 and 1\r\n     */\r\n    constructor(axis, value, target) {\r\n        super();\r\n        this.axis = axis;\r\n        this.value = value;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Event received by the [[Engine]] when the browser window is visible on a screen.\r\n */\r\nclass VisibleEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Event received by the [[Engine]] when the browser window is hidden from all screens.\r\n */\r\nclass HiddenEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Event thrown on an [[Actor|actor]] when a collision will occur this frame if it resolves\r\n */\r\nclass PreCollisionEvent extends GameEvent {\r\n    /**\r\n     * @param actor         The actor the event was thrown on\r\n     * @param other         The actor that will collided with the current actor\r\n     * @param side          The side that will be collided with the current actor\r\n     * @param intersection  Intersection vector\r\n     */\r\n    constructor(actor, other, side, intersection) {\r\n        super();\r\n        this.other = other;\r\n        this.side = side;\r\n        this.intersection = intersection;\r\n        this.target = actor;\r\n    }\r\n}\r\n/**\r\n * Event thrown on an [[Actor|actor]] when a collision has been resolved (body reacted) this frame\r\n */\r\nclass PostCollisionEvent extends GameEvent {\r\n    /**\r\n     * @param actor         The actor the event was thrown on\r\n     * @param other         The actor that did collide with the current actor\r\n     * @param side          The side that did collide with the current actor\r\n     * @param intersection  Intersection vector\r\n     */\r\n    constructor(actor, other, side, intersection) {\r\n        super();\r\n        this.other = other;\r\n        this.side = side;\r\n        this.intersection = intersection;\r\n        this.target = actor;\r\n    }\r\n    get actor() {\r\n        return this.target;\r\n    }\r\n    set actor(actor) {\r\n        this.target = actor;\r\n    }\r\n}\r\nclass ContactStartEvent {\r\n    constructor(target, other, contact) {\r\n        this.target = target;\r\n        this.other = other;\r\n        this.contact = contact;\r\n    }\r\n}\r\nclass ContactEndEvent {\r\n    constructor(target, other) {\r\n        this.target = target;\r\n        this.other = other;\r\n    }\r\n}\r\nclass CollisionPreSolveEvent {\r\n    constructor(target, other, side, intersection, contact) {\r\n        this.target = target;\r\n        this.other = other;\r\n        this.side = side;\r\n        this.intersection = intersection;\r\n        this.contact = contact;\r\n    }\r\n}\r\nclass CollisionPostSolveEvent {\r\n    constructor(target, other, side, intersection, contact) {\r\n        this.target = target;\r\n        this.other = other;\r\n        this.side = side;\r\n        this.intersection = intersection;\r\n        this.contact = contact;\r\n    }\r\n}\r\n/**\r\n * Event thrown the first time an [[Actor|actor]] collides with another, after an actor is in contact normal collision events are fired.\r\n */\r\nclass CollisionStartEvent extends GameEvent {\r\n    /**\r\n     *\r\n     * @param actor\r\n     * @param other\r\n     * @param contact\r\n     */\r\n    constructor(actor, other, contact) {\r\n        super();\r\n        this.other = other;\r\n        this.contact = contact;\r\n        this.target = actor;\r\n    }\r\n    get actor() {\r\n        return this.target;\r\n    }\r\n    set actor(actor) {\r\n        this.target = actor;\r\n    }\r\n}\r\n/**\r\n * Event thrown when the [[Actor|actor]] is no longer colliding with another\r\n */\r\nclass CollisionEndEvent extends GameEvent {\r\n    /**\r\n     *\r\n     */\r\n    constructor(actor, other) {\r\n        super();\r\n        this.other = other;\r\n        this.target = actor;\r\n    }\r\n    get actor() {\r\n        return this.target;\r\n    }\r\n    set actor(actor) {\r\n        this.target = actor;\r\n    }\r\n}\r\n/**\r\n * Event thrown on an [[Actor]] and a [[Scene]] only once before the first update call\r\n */\r\nclass InitializeEvent extends GameEvent {\r\n    /**\r\n     * @param engine  The reference to the current engine\r\n     */\r\n    constructor(engine, target) {\r\n        super();\r\n        this.engine = engine;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Event thrown on a [[Scene]] on activation\r\n */\r\nclass ActivateEvent extends GameEvent {\r\n    /**\r\n     * @param context  The context for the scene activation\r\n     */\r\n    constructor(context, target) {\r\n        super();\r\n        this.context = context;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Event thrown on a [[Scene]] on deactivation\r\n */\r\nclass DeactivateEvent extends GameEvent {\r\n    /**\r\n     * @param context  The context for the scene deactivation\r\n     */\r\n    constructor(context, target) {\r\n        super();\r\n        this.context = context;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Event thrown on an [[Actor]] when it completely leaves the screen.\r\n */\r\nclass ExitViewPortEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Event thrown on an [[Actor]] when it completely leaves the screen.\r\n */\r\nclass EnterViewPortEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\nclass EnterTriggerEvent extends GameEvent {\r\n    constructor(target, actor) {\r\n        super();\r\n        this.target = target;\r\n        this.actor = actor;\r\n    }\r\n}\r\nclass ExitTriggerEvent extends GameEvent {\r\n    constructor(target, actor) {\r\n        super();\r\n        this.target = target;\r\n        this.actor = actor;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EventDispatcher.ts\n\r\nclass EventDispatcher {\r\n    constructor() {\r\n        this._handlers = {};\r\n        this._wiredEventDispatchers = [];\r\n        this._deferedHandlerRemovals = [];\r\n    }\r\n    /**\r\n     * Clears any existing handlers or wired event dispatchers on this event dispatcher\r\n     */\r\n    clear() {\r\n        this._handlers = {};\r\n        this._wiredEventDispatchers = [];\r\n    }\r\n    _processDeferredHandlerRemovals() {\r\n        for (const eventHandler of this._deferedHandlerRemovals) {\r\n            this._removeHandler(eventHandler.name, eventHandler.handler);\r\n        }\r\n        this._deferedHandlerRemovals.length = 0;\r\n    }\r\n    /**\r\n     * Emits an event for target\r\n     * @param eventName  The name of the event to publish\r\n     * @param event      Optionally pass an event data object to the handler\r\n     */\r\n    emit(eventName, event) {\r\n        this._processDeferredHandlerRemovals();\r\n        if (!eventName) {\r\n            // key not mapped\r\n            return;\r\n        }\r\n        eventName = eventName.toLowerCase();\r\n        if (!event) {\r\n            event = new GameEvent();\r\n        }\r\n        let i, len;\r\n        if (this._handlers[eventName]) {\r\n            i = 0;\r\n            len = this._handlers[eventName].length;\r\n            for (i; i < len; i++) {\r\n                this._handlers[eventName][i](event);\r\n            }\r\n        }\r\n        i = 0;\r\n        len = this._wiredEventDispatchers.length;\r\n        for (i; i < len; i++) {\r\n            this._wiredEventDispatchers[i].emit(eventName, event);\r\n        }\r\n    }\r\n    /**\r\n     * Subscribe an event handler to a particular event name, multiple handlers per event name are allowed.\r\n     * @param eventName  The name of the event to subscribe to\r\n     * @param handler    The handler callback to fire on this event\r\n     */\r\n    on(eventName, handler) {\r\n        this._processDeferredHandlerRemovals();\r\n        eventName = eventName.toLowerCase();\r\n        if (!this._handlers[eventName]) {\r\n            this._handlers[eventName] = [];\r\n        }\r\n        this._handlers[eventName].push(handler);\r\n    }\r\n    /**\r\n     * Unsubscribe an event handler(s) from an event. If a specific handler\r\n     * is specified for an event, only that handler will be unsubscribed.\r\n     * Otherwise all handlers will be unsubscribed for that event.\r\n     *\r\n     * @param eventName  The name of the event to unsubscribe\r\n     * @param handler    Optionally the specific handler to unsubscribe\r\n     */\r\n    off(eventName, handler) {\r\n        this._deferedHandlerRemovals.push({ name: eventName, handler });\r\n    }\r\n    _removeHandler(eventName, handler) {\r\n        eventName = eventName.toLowerCase();\r\n        const eventHandlers = this._handlers[eventName];\r\n        if (eventHandlers) {\r\n            // if no explicit handler is give with the event name clear all handlers\r\n            if (!handler) {\r\n                this._handlers[eventName].length = 0;\r\n            }\r\n            else {\r\n                const index = eventHandlers.indexOf(handler);\r\n                if (index > -1) {\r\n                    this._handlers[eventName].splice(index, 1);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Once listens to an event one time, then unsubscribes from that event\r\n     *\r\n     * @param eventName The name of the event to subscribe to once\r\n     * @param handler   The handler of the event that will be auto unsubscribed\r\n     */\r\n    once(eventName, handler) {\r\n        this._processDeferredHandlerRemovals();\r\n        const metaHandler = (event) => {\r\n            const ev = event || new GameEvent();\r\n            this.off(eventName, metaHandler);\r\n            handler(ev);\r\n        };\r\n        this.on(eventName, metaHandler);\r\n    }\r\n    /**\r\n     * Wires this event dispatcher to also receive events from another\r\n     */\r\n    wire(eventDispatcher) {\r\n        eventDispatcher._wiredEventDispatchers.push(this);\r\n    }\r\n    /**\r\n     * Unwires this event dispatcher from another\r\n     */\r\n    unwire(eventDispatcher) {\r\n        const index = eventDispatcher._wiredEventDispatchers.indexOf(this);\r\n        if (index > -1) {\r\n            eventDispatcher._wiredEventDispatchers.splice(index, 1);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Resources/Resource.ts\n\r\n\r\n/**\r\n * The [[Resource]] type allows games built in Excalibur to load generic resources.\r\n * For any type of remote resource it is recommended to use [[Resource]] for preloading.\r\n */\r\nclass Resource {\r\n    /**\r\n     * @param path          Path to the remote resource\r\n     * @param responseType  The type to expect as a response: \"\" | \"arraybuffer\" | \"blob\" | \"document\" | \"json\" | \"text\";\r\n     * @param bustCache     Whether or not to cache-bust requests\r\n     */\r\n    constructor(path, responseType, bustCache = true) {\r\n        this.path = path;\r\n        this.responseType = responseType;\r\n        this.bustCache = bustCache;\r\n        this.data = null;\r\n        this.logger = Logger.getInstance();\r\n        this.events = new EventDispatcher();\r\n    }\r\n    /**\r\n     * Returns true if the Resource is completely loaded and is ready\r\n     * to be drawn.\r\n     */\r\n    isLoaded() {\r\n        return this.data !== null;\r\n    }\r\n    _cacheBust(uri) {\r\n        const query = /\\?\\w*=\\w*/;\r\n        if (query.test(uri)) {\r\n            uri += '&__=' + Date.now();\r\n        }\r\n        else {\r\n            uri += '?__=' + Date.now();\r\n        }\r\n        return uri;\r\n    }\r\n    /**\r\n     * Begin loading the resource and returns a promise to be resolved on completion\r\n     */\r\n    load() {\r\n        return new Promise((resolve, reject) => {\r\n            // Exit early if we already have data\r\n            if (this.data !== null) {\r\n                this.logger.debug('Already have data for resource', this.path);\r\n                this.events.emit('complete', this.data);\r\n                resolve(this.data);\r\n                return;\r\n            }\r\n            const request = new XMLHttpRequest();\r\n            request.open('GET', this.bustCache ? this._cacheBust(this.path) : this.path, true);\r\n            request.responseType = this.responseType;\r\n            request.addEventListener('loadstart', (e) => this.events.emit('loadstart', e));\r\n            request.addEventListener('progress', (e) => this.events.emit('progress', e));\r\n            request.addEventListener('error', (e) => this.events.emit('error', e));\r\n            request.addEventListener('load', (e) => this.events.emit('load', e));\r\n            request.addEventListener('load', () => {\r\n                // XHR on file:// success status is 0, such as with PhantomJS\r\n                if (request.status !== 0 && request.status !== 200) {\r\n                    this.logger.error('Failed to load resource ', this.path, ' server responded with error code', request.status);\r\n                    this.events.emit('error', request.response);\r\n                    reject(new Error(request.statusText));\r\n                    return;\r\n                }\r\n                this.data = request.response;\r\n                this.events.emit('complete', this.data);\r\n                this.logger.debug('Completed loading resource', this.path);\r\n                resolve(this.data);\r\n            });\r\n            request.send();\r\n        });\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Watch.ts\n/**\r\n * Watch an object with a proxy, only fires if property value is different\r\n */\r\nfunction watch(type, change) {\r\n    if (!type) {\r\n        return type;\r\n    }\r\n    if (type.__isProxy === undefined) {\r\n        // expando hack to mark a proxy\r\n        return new Proxy(type, {\r\n            set: (obj, prop, value) => {\r\n                // The default behavior to store the value\r\n                if (obj[prop] !== value) {\r\n                    obj[prop] = value;\r\n                    // Avoid watching private junk\r\n                    if (typeof prop === 'string') {\r\n                        if (prop[0] !== '_') {\r\n                            change(obj);\r\n                        }\r\n                    }\r\n                }\r\n                // Indicate success\r\n                return true;\r\n            },\r\n            get: (obj, prop) => {\r\n                if (prop !== '__isProxy') {\r\n                    return obj[prop];\r\n                }\r\n                return true;\r\n            }\r\n        });\r\n    }\r\n    return type;\r\n}\r\n/**\r\n * Watch an object with a proxy, fires change on any property value change\r\n */\r\nfunction watchAny(type, change) {\r\n    if (!type) {\r\n        return type;\r\n    }\r\n    if (type.__isProxy === undefined) {\r\n        // expando hack to mark a proxy\r\n        return new Proxy(type, {\r\n            set: (obj, prop, value) => {\r\n                // The default behavior to store the value\r\n                obj[prop] = value;\r\n                // Avoid watching private junk\r\n                if (typeof prop === 'string') {\r\n                    if (prop[0] !== '_') {\r\n                        change(obj);\r\n                    }\r\n                }\r\n                // Indicate success\r\n                return true;\r\n            },\r\n            get: (obj, prop) => {\r\n                if (prop !== '__isProxy') {\r\n                    return obj[prop];\r\n                }\r\n                return true;\r\n            }\r\n        });\r\n    }\r\n    return type;\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Graphic.ts\n\r\n\r\n\r\n\r\n/**\r\n * A Graphic is the base Excalibur primitive for something that can be drawn to the [[ExcaliburGraphicsContext]].\r\n * [[Sprite]], [[Animation]], [[GraphicsGroup]], [[Canvas]], [[Rectangle]], [[Circle]], and [[Polygon]] all derive from the\r\n * [[Graphic]] abstract class.\r\n *\r\n * Implementors of a Graphic must override the abstract [[Graphic._drawImage]] method to render an image to the graphics context. Graphic\r\n * handles all the position, rotation, and scale transformations in [[Graphic._preDraw]] and [[Graphic._postDraw]]\r\n */\r\nclass Graphic {\r\n    constructor(options) {\r\n        var _a, _b, _c, _d, _e, _f;\r\n        this.id = Graphic._ID++;\r\n        this.transform = AffineMatrix.identity();\r\n        this.tint = null;\r\n        this._transformStale = true;\r\n        /**\r\n         * Gets or sets wether to show debug information about the graphic\r\n         */\r\n        this.showDebug = false;\r\n        this._flipHorizontal = false;\r\n        this._flipVertical = false;\r\n        this._rotation = 0;\r\n        /**\r\n         * Gets or sets the opacity of the graphic, 0 is transparent, 1 is solid (opaque).\r\n         */\r\n        this.opacity = 1;\r\n        this._scale = Vector.One;\r\n        this._origin = null;\r\n        this._width = 0;\r\n        this._height = 0;\r\n        if (options) {\r\n            this.origin = (_a = options.origin) !== null && _a !== void 0 ? _a : this.origin;\r\n            this.flipHorizontal = (_b = options.flipHorizontal) !== null && _b !== void 0 ? _b : this.flipHorizontal;\r\n            this.flipVertical = (_c = options.flipVertical) !== null && _c !== void 0 ? _c : this.flipVertical;\r\n            this.rotation = (_d = options.rotation) !== null && _d !== void 0 ? _d : this.rotation;\r\n            this.opacity = (_e = options.opacity) !== null && _e !== void 0 ? _e : this.opacity;\r\n            this.scale = (_f = options.scale) !== null && _f !== void 0 ? _f : this.scale;\r\n        }\r\n    }\r\n    isStale() {\r\n        return this._transformStale;\r\n    }\r\n    /**\r\n     * Gets or sets the flipHorizontal, which will flip the graphic horizontally (across the y axis)\r\n     */\r\n    get flipHorizontal() {\r\n        return this._flipHorizontal;\r\n    }\r\n    set flipHorizontal(value) {\r\n        this._flipHorizontal = value;\r\n        this._transformStale = true;\r\n    }\r\n    /**\r\n     * Gets or sets the flipVertical, which will flip the graphic vertically (across the x axis)\r\n     */\r\n    get flipVertical() {\r\n        return this._flipVertical;\r\n    }\r\n    set flipVertical(value) {\r\n        this._flipVertical = value;\r\n        this._transformStale = true;\r\n    }\r\n    /**\r\n     * Gets or sets the rotation of the graphic\r\n     */\r\n    get rotation() {\r\n        return this._rotation;\r\n    }\r\n    set rotation(value) {\r\n        this._rotation = value;\r\n        this._transformStale = true;\r\n    }\r\n    /**\r\n     * Gets or sets the scale of the graphic, this affects the width and\r\n     */\r\n    get scale() {\r\n        return this._scale;\r\n    }\r\n    set scale(value) {\r\n        this._scale = watch(value, () => {\r\n            this._transformStale = true;\r\n        });\r\n        this._transformStale = true;\r\n    }\r\n    /**\r\n     * Gets or sets the origin of the graphic, if not set the center of the graphic is the origin\r\n     */\r\n    get origin() {\r\n        return this._origin;\r\n    }\r\n    set origin(value) {\r\n        this._origin = watch(value, () => {\r\n            this._transformStale = true;\r\n        });\r\n        this._transformStale = true;\r\n    }\r\n    cloneGraphicOptions() {\r\n        return {\r\n            origin: this.origin ? this.origin.clone() : null,\r\n            flipHorizontal: this.flipHorizontal,\r\n            flipVertical: this.flipVertical,\r\n            rotation: this.rotation,\r\n            opacity: this.opacity,\r\n            scale: this.scale ? this.scale.clone() : null\r\n        };\r\n    }\r\n    /**\r\n     * Gets or sets the width of the graphic (always positive)\r\n     */\r\n    get width() {\r\n        return Math.abs(this._width * this.scale.x);\r\n    }\r\n    /**\r\n     * Gets or sets the height of the graphic (always positive)\r\n     */\r\n    get height() {\r\n        return Math.abs(this._height * this.scale.y);\r\n    }\r\n    set width(value) {\r\n        this._width = value;\r\n        this._transformStale = true;\r\n    }\r\n    set height(value) {\r\n        this._height = value;\r\n        this._transformStale = true;\r\n    }\r\n    /**\r\n     * Gets a copy of the bounds in pixels occupied by the graphic on the the screen. This includes scale.\r\n     */\r\n    get localBounds() {\r\n        return BoundingBox.fromDimension(this.width, this.height, Vector.Zero);\r\n    }\r\n    /**\r\n     * Draw the whole graphic to the context including transform\r\n     * @param ex The excalibur graphics context\r\n     * @param x\r\n     * @param y\r\n     */\r\n    draw(ex, x, y) {\r\n        this._preDraw(ex, x, y);\r\n        this._drawImage(ex, 0, 0);\r\n        this._postDraw(ex);\r\n    }\r\n    /**\r\n     * Apply affine transformations to the graphics context to manipulate the graphic before [[Graphic._drawImage]]\r\n     * @param ex\r\n     * @param x\r\n     * @param y\r\n     */\r\n    _preDraw(ex, x, y) {\r\n        ex.save();\r\n        ex.translate(x, y);\r\n        if (this._transformStale) {\r\n            this.transform.reset();\r\n            this.transform.scale(Math.abs(this.scale.x), Math.abs(this.scale.y));\r\n            this._rotate(this.transform);\r\n            this._flip(this.transform);\r\n            this._transformStale = false;\r\n        }\r\n        ex.multiply(this.transform);\r\n        // it is important to multiply alphas so graphics respect the current context\r\n        ex.opacity = ex.opacity * this.opacity;\r\n        if (this.tint) {\r\n            ex.tint = this.tint;\r\n        }\r\n    }\r\n    _rotate(ex) {\r\n        var _a;\r\n        const scaleDirX = this.scale.x > 0 ? 1 : -1;\r\n        const scaleDirY = this.scale.y > 0 ? 1 : -1;\r\n        const origin = (_a = this.origin) !== null && _a !== void 0 ? _a : vec(this.width / 2, this.height / 2);\r\n        ex.translate(origin.x, origin.y);\r\n        ex.rotate(this.rotation);\r\n        // This is for handling direction changes 1 or -1, that way we don't have mismatched translates()\r\n        ex.scale(scaleDirX, scaleDirY);\r\n        ex.translate(-origin.x, -origin.y);\r\n    }\r\n    _flip(ex) {\r\n        if (this.flipHorizontal) {\r\n            ex.translate(this.width / this.scale.x, 0);\r\n            ex.scale(-1, 1);\r\n        }\r\n        if (this.flipVertical) {\r\n            ex.translate(0, this.height / this.scale.y);\r\n            ex.scale(1, -1);\r\n        }\r\n    }\r\n    /**\r\n     * Apply any additional work after [[Graphic._drawImage]] and restore the context state.\r\n     * @param ex\r\n     */\r\n    _postDraw(ex) {\r\n        if (this.showDebug) {\r\n            ex.debug.drawRect(0, 0, this.width, this.height);\r\n        }\r\n        ex.restore();\r\n    }\r\n}\r\nGraphic._ID = 0;\r\n\n;// CONCATENATED MODULE: ./Graphics/Sprite.ts\n\r\n\r\nclass Sprite extends Graphic {\r\n    constructor(options) {\r\n        var _a, _b;\r\n        super(options);\r\n        this._logger = Logger.getInstance();\r\n        this._dirty = true;\r\n        this._logNotLoadedWarning = false;\r\n        this.image = options.image;\r\n        const { width, height } = options;\r\n        this.sourceView = (_a = options.sourceView) !== null && _a !== void 0 ? _a : { x: 0, y: 0, width: width !== null && width !== void 0 ? width : 0, height: height !== null && height !== void 0 ? height : 0 };\r\n        this.destSize = (_b = options.destSize) !== null && _b !== void 0 ? _b : { width: width !== null && width !== void 0 ? width : 0, height: height !== null && height !== void 0 ? height : 0 };\r\n        this._updateSpriteDimensions();\r\n        this.image.ready.then(() => {\r\n            this._updateSpriteDimensions();\r\n        });\r\n    }\r\n    static from(image) {\r\n        return new Sprite({\r\n            image: image\r\n        });\r\n    }\r\n    get width() {\r\n        return Math.abs(this.destSize.width * this.scale.x);\r\n    }\r\n    get height() {\r\n        return Math.abs(this.destSize.height * this.scale.y);\r\n    }\r\n    set width(newWidth) {\r\n        newWidth /= Math.abs(this.scale.x);\r\n        this.destSize.width = newWidth;\r\n        super.width = Math.ceil(this.destSize.width);\r\n    }\r\n    set height(newHeight) {\r\n        newHeight /= Math.abs(this.scale.y);\r\n        this.destSize.height = newHeight;\r\n        super.height = Math.ceil(this.destSize.height);\r\n    }\r\n    _updateSpriteDimensions() {\r\n        var _a, _b, _c, _d, _e, _f;\r\n        const { width: nativeWidth, height: nativeHeight } = this.image;\r\n        // This code uses || to avoid 0's\r\n        // If the source is not specified, use the native dimension\r\n        this.sourceView.width = ((_a = this.sourceView) === null || _a === void 0 ? void 0 : _a.width) || nativeWidth;\r\n        this.sourceView.height = ((_b = this.sourceView) === null || _b === void 0 ? void 0 : _b.height) || nativeHeight;\r\n        // If the destination is not specified, use the source if specified, then native\r\n        this.destSize.width = ((_c = this.destSize) === null || _c === void 0 ? void 0 : _c.width) || ((_d = this.sourceView) === null || _d === void 0 ? void 0 : _d.width) || nativeWidth;\r\n        this.destSize.height = ((_e = this.destSize) === null || _e === void 0 ? void 0 : _e.height) || ((_f = this.sourceView) === null || _f === void 0 ? void 0 : _f.height) || nativeHeight;\r\n        this.width = Math.ceil(this.destSize.width) * this.scale.x;\r\n        this.height = Math.ceil(this.destSize.height) * this.scale.y;\r\n    }\r\n    _preDraw(ex, x, y) {\r\n        if (this.image.isLoaded() && this._dirty) {\r\n            this._dirty = false;\r\n            this._updateSpriteDimensions();\r\n        }\r\n        super._preDraw(ex, x, y);\r\n    }\r\n    _drawImage(ex, x, y) {\r\n        if (this.image.isLoaded()) {\r\n            ex.drawImage(this.image.image, this.sourceView.x, this.sourceView.y, this.sourceView.width, this.sourceView.height, x, y, this.destSize.width, this.destSize.height);\r\n        }\r\n        else {\r\n            if (!this._logNotLoadedWarning) {\r\n                this._logger.warn(`ImageSource ${this.image.path}` +\r\n                    ` is not yet loaded and won't be drawn. Please call .load() or include in a Loader.\\n\\n` +\r\n                    `Read https://excaliburjs.com/docs/imagesource for more information.`);\r\n            }\r\n            this._logNotLoadedWarning = true;\r\n        }\r\n    }\r\n    clone() {\r\n        return new Sprite({\r\n            image: this.image,\r\n            sourceView: { ...this.sourceView },\r\n            destSize: { ...this.destSize },\r\n            ...this.cloneGraphicOptions()\r\n        });\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Filtering.ts\n/**\r\n * Describes the different image filtering modes\r\n */\r\nvar ImageFiltering;\r\n(function (ImageFiltering) {\r\n    /**\r\n     * Pixel is useful when you do not want smoothing aka antialiasing applied to your graphics.\r\n     *\r\n     * Useful for Pixel art aesthetics.\r\n     */\r\n    ImageFiltering[\"Pixel\"] = \"Pixel\";\r\n    /**\r\n     * Blended is useful when you have high resolution artwork and would like it blended and smoothed\r\n     */\r\n    ImageFiltering[\"Blended\"] = \"Blended\";\r\n})(ImageFiltering || (ImageFiltering = {}));\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/texture-loader.ts\n\r\n\r\n/**\r\n * Manages loading image sources into webgl textures, a unique id is associated with all sources\r\n */\r\nclass TextureLoader {\r\n    static register(context) {\r\n        TextureLoader._GL = context;\r\n        TextureLoader._MAX_TEXTURE_SIZE = context.getParameter(context.MAX_TEXTURE_SIZE);\r\n    }\r\n    /**\r\n     * Get the WebGL Texture from a source image\r\n     * @param image\r\n     */\r\n    static get(image) {\r\n        return TextureLoader._TEXTURE_MAP.get(image);\r\n    }\r\n    /**\r\n     * Returns whether a source image has been loaded as a texture\r\n     * @param image\r\n     */\r\n    static has(image) {\r\n        return TextureLoader._TEXTURE_MAP.has(image);\r\n    }\r\n    /**\r\n     * Loads a graphic into webgl and returns it's texture info, a webgl context must be previously registered\r\n     * @param image Source graphic\r\n     * @param filtering {ImageFiltering} The ImageFiltering mode to apply to the loaded texture\r\n     * @param forceUpdate Optionally force a texture to be reloaded, useful if the source graphic has changed\r\n     */\r\n    static load(image, filtering, forceUpdate = false) {\r\n        // Ignore loading if webgl is not registered\r\n        const gl = TextureLoader._GL;\r\n        if (!gl) {\r\n            return null;\r\n        }\r\n        let tex = null;\r\n        // If reuse the texture if it's from the same source\r\n        if (TextureLoader.has(image)) {\r\n            tex = TextureLoader.get(image);\r\n        }\r\n        // Update existing webgl texture and return early\r\n        if (tex) {\r\n            if (forceUpdate) {\r\n                gl.bindTexture(gl.TEXTURE_2D, tex);\r\n                gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, image);\r\n            }\r\n            return tex;\r\n        }\r\n        // No texture exists create a new one\r\n        tex = gl.createTexture();\r\n        TextureLoader.checkImageSizeSupportedAndLog(image);\r\n        gl.bindTexture(gl.TEXTURE_2D, tex);\r\n        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n        // NEAREST for pixel art, LINEAR for hi-res\r\n        const filterMode = filtering !== null && filtering !== void 0 ? filtering : TextureLoader.filtering;\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, filterMode === ImageFiltering.Pixel ? gl.NEAREST : gl.LINEAR);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, filterMode === ImageFiltering.Pixel ? gl.NEAREST : gl.LINEAR);\r\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, image);\r\n        TextureLoader._TEXTURE_MAP.set(image, tex);\r\n        return tex;\r\n    }\r\n    static delete(image) {\r\n        // Ignore loading if webgl is not registered\r\n        const gl = TextureLoader._GL;\r\n        if (!gl) {\r\n            return null;\r\n        }\r\n        let tex = null;\r\n        if (TextureLoader.has(image)) {\r\n            tex = TextureLoader.get(image);\r\n            gl.deleteTexture(tex);\r\n        }\r\n    }\r\n    /**\r\n     * Takes an image and returns if it meets size criteria for hardware\r\n     * @param image\r\n     * @returns if the image will be supported at runtime\r\n     */\r\n    static checkImageSizeSupportedAndLog(image) {\r\n        var _a;\r\n        const originalSrc = (_a = image.dataset.originalSrc) !== null && _a !== void 0 ? _a : 'internal canvas bitmap';\r\n        if (image.width > TextureLoader._MAX_TEXTURE_SIZE || image.height > TextureLoader._MAX_TEXTURE_SIZE) {\r\n            TextureLoader._LOGGER.error(`The image [${originalSrc}] provided to Excalibur is too large for the device's maximum texture size of ` +\r\n                `(${TextureLoader._MAX_TEXTURE_SIZE}x${TextureLoader._MAX_TEXTURE_SIZE}) please resize to an image `\r\n                + `for excalibur to render properly.\\n\\nImages will likely render as black rectangles.\\n\\n` +\r\n                `Read more here: https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices#understand_system_limits`);\r\n            return false;\r\n        }\r\n        else if (image.width > 4096 || image.height > 4096) {\r\n            // https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices#understand_system_limits\r\n            TextureLoader._LOGGER.warn(`The image [${originalSrc}] provided to excalibur is too large may not work on all mobile devices, ` +\r\n                `it is recommended you resize images to a maximum (4096x4096).\\n\\n` +\r\n                `Images will likely render as black rectangles on some mobile platforms.\\n\\n` +\r\n                `Read more here: https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices#understand_system_limits`);\r\n        }\r\n        return true;\r\n    }\r\n}\r\nTextureLoader._LOGGER = Logger.getInstance();\r\n/**\r\n * Sets the default filtering for the Excalibur texture loader, default [[ImageFiltering.Blended]]\r\n */\r\nTextureLoader.filtering = ImageFiltering.Blended;\r\nTextureLoader._TEXTURE_MAP = new Map();\r\nTextureLoader._MAX_TEXTURE_SIZE = 0;\r\n\n;// CONCATENATED MODULE: ./Graphics/ImageSource.ts\n\r\n\r\n\r\n\r\n\r\nclass ImageSource {\r\n    /**\r\n     * The path to the image, can also be a data url like 'data:image/'\r\n     * @param path {string} Path to the image resource relative from the HTML document hosting the game, or absolute\r\n     * @param bustCache {boolean} Should excalibur add a cache busting querystring?\r\n     * @param filtering {ImageFiltering} Optionally override the image filtering set by [[EngineOptions.antialiasing]]\r\n     */\r\n    constructor(path, bustCache = false, filtering) {\r\n        this.path = path;\r\n        this._logger = Logger.getInstance();\r\n        /**\r\n         * Access to the underlying html image element\r\n         */\r\n        this.data = new Image();\r\n        this._readyFuture = new Future();\r\n        /**\r\n         * Promise the resolves when the image is loaded and ready for use, does not initiate loading\r\n         */\r\n        this.ready = this._readyFuture.promise;\r\n        this._resource = new Resource(path, 'blob', bustCache);\r\n        this._filtering = filtering;\r\n        if (path.endsWith('.svg') || path.endsWith('.gif')) {\r\n            this._logger.warn(`Image type is not fully supported, you may have mixed results ${path}. Fully supported: jpg, bmp, and png`);\r\n        }\r\n    }\r\n    /**\r\n     * The original size of the source image in pixels\r\n     */\r\n    get width() {\r\n        return this.image.naturalWidth;\r\n    }\r\n    /**\r\n     * The original height of the source image in pixels\r\n     */\r\n    get height() {\r\n        return this.image.naturalHeight;\r\n    }\r\n    /**\r\n     * Returns true if the Texture is completely loaded and is ready\r\n     * to be drawn.\r\n     */\r\n    isLoaded() {\r\n        if (!this._src) {\r\n            // this boosts speed of access\r\n            this._src = this.data.src;\r\n        }\r\n        return !!this._src;\r\n    }\r\n    get image() {\r\n        return this.data;\r\n    }\r\n    /**\r\n     * Begins loading the image and returns a promise that resolves when the image is loaded\r\n     */\r\n    async load() {\r\n        if (this.isLoaded()) {\r\n            return this.data;\r\n        }\r\n        try {\r\n            // Load base64 or blob if needed\r\n            let url;\r\n            if (!this.path.includes('data:image/')) {\r\n                const blob = await this._resource.load();\r\n                url = URL.createObjectURL(blob);\r\n            }\r\n            else {\r\n                url = this.path;\r\n            }\r\n            // Decode the image\r\n            const image = new Image();\r\n            // Use Image.onload over Image.decode()\r\n            // https://bugs.chromium.org/p/chromium/issues/detail?id=1055828#c7\r\n            // Otherwise chrome will throw still Image.decode() failures for large textures\r\n            const loadedFuture = new Future();\r\n            image.onload = () => loadedFuture.resolve();\r\n            image.src = url;\r\n            image.setAttribute('data-original-src', this.path);\r\n            await loadedFuture.promise;\r\n            // Set results\r\n            this.data = image;\r\n        }\r\n        catch (error) {\r\n            throw `Error loading ImageSource from path '${this.path}' with error [${error.message}]`;\r\n        }\r\n        TextureLoader.load(this.data, this._filtering);\r\n        // todo emit complete\r\n        this._readyFuture.resolve(this.data);\r\n        return this.data;\r\n    }\r\n    /**\r\n     * Build a sprite from this ImageSource\r\n     */\r\n    toSprite() {\r\n        return Sprite.from(this);\r\n    }\r\n    /**\r\n     * Unload images from memory\r\n     */\r\n    unload() {\r\n        this.data = new Image();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/SpriteSheet.ts\n\r\n\r\n/**\r\n * Represents a collection of sprites from a source image with some organization in a grid\r\n */\r\nclass SpriteSheet {\r\n    /**\r\n     * Build a new sprite sheet from a list of sprites\r\n     *\r\n     * Use [[SpriteSheet.fromImageSource]] to create a SpriteSheet from an [[ImageSource]] organized in a grid\r\n     * @param options\r\n     */\r\n    constructor(options) {\r\n        this._logger = Logger.getInstance();\r\n        this.sprites = [];\r\n        const { sprites, rows, columns } = options;\r\n        this.sprites = sprites;\r\n        this.rows = rows !== null && rows !== void 0 ? rows : 1;\r\n        this.columns = columns !== null && columns !== void 0 ? columns : this.sprites.length;\r\n    }\r\n    /**\r\n     * Find a sprite by their x/y position in the SpriteSheet, for example `getSprite(0, 0)` is the [[Sprite]] in the top-left\r\n     * @param x\r\n     * @param y\r\n     */\r\n    getSprite(x, y) {\r\n        if (x >= this.columns || x < 0) {\r\n            this._logger.warn(`No sprite exists in the SpriteSheet at (${x}, ${y}), x: ${x} should be between 0 and ${this.columns - 1}`);\r\n            return null;\r\n        }\r\n        if (y >= this.rows || y < 0) {\r\n            this._logger.warn(`No sprite exists in the SpriteSheet at (${x}, ${y}), y: ${y} should be between 0 and ${this.rows - 1}`);\r\n            return null;\r\n        }\r\n        const spriteIndex = x + y * this.columns;\r\n        return this.sprites[spriteIndex];\r\n    }\r\n    /**\r\n     * Create a sprite sheet from a sparse set of [[SourceView]] rectangles\r\n     * @param options\r\n     */\r\n    static fromImageSourceWithSourceViews(options) {\r\n        const sprites = options.sourceViews.map(sourceView => {\r\n            return new Sprite({\r\n                image: options.image,\r\n                sourceView\r\n            });\r\n        });\r\n        return new SpriteSheet({ sprites });\r\n    }\r\n    /**\r\n     * Create a SpriteSheet from an [[ImageSource]] organized in a grid\r\n     *\r\n     * Example:\r\n     * ```\r\n     * const spriteSheet = SpriteSheet.fromImageSource({\r\n     *   image: imageSource,\r\n     *   grid: {\r\n     *     rows: 5,\r\n     *     columns: 2,\r\n     *     spriteWidth: 32, // pixels\r\n     *     spriteHeight: 32 // pixels\r\n     *   },\r\n     *   // Optionally specify spacing\r\n     *   spacing: {\r\n     *     // pixels from the top left to start the sprite parsing\r\n     *     originOffset: {\r\n     *       x: 5,\r\n     *       y: 5\r\n     *     },\r\n     *     // pixels between each sprite while parsing\r\n     *     margin: {\r\n     *       x: 1,\r\n     *       y: 1\r\n     *     }\r\n     *   }\r\n     * })\r\n     * ```\r\n     *\r\n     * @param options\r\n     */\r\n    static fromImageSource(options) {\r\n        var _a;\r\n        const sprites = [];\r\n        options.spacing = (_a = options.spacing) !== null && _a !== void 0 ? _a : {};\r\n        const { image, grid: { rows, columns: cols, spriteWidth, spriteHeight }, spacing: { originOffset, margin } } = options;\r\n        const offsetDefaults = { x: 0, y: 0, ...originOffset };\r\n        const marginDefaults = { x: 0, y: 0, ...margin };\r\n        for (let x = 0; x < cols; x++) {\r\n            for (let y = 0; y < rows; y++) {\r\n                sprites[x + y * cols] = new Sprite({\r\n                    image: image,\r\n                    sourceView: {\r\n                        x: x * spriteWidth + marginDefaults.x * x + offsetDefaults.x,\r\n                        y: y * spriteHeight + marginDefaults.y * y + offsetDefaults.y,\r\n                        width: spriteWidth,\r\n                        height: spriteHeight\r\n                    },\r\n                    destSize: { height: spriteHeight, width: spriteWidth }\r\n                });\r\n            }\r\n        }\r\n        return new SpriteSheet({\r\n            sprites: sprites,\r\n            rows: rows,\r\n            columns: cols\r\n        });\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/SpriteFont.ts\n\r\n\r\n\r\n\r\nclass SpriteFont extends Graphic {\r\n    constructor(options) {\r\n        super(options);\r\n        this._text = '';\r\n        this.alphabet = '';\r\n        this.shadow = null;\r\n        this.caseInsensitive = false;\r\n        this.spacing = 0;\r\n        this._logger = Logger.getInstance();\r\n        this._alreadyWarnedAlphabet = false;\r\n        this._alreadyWarnedSpriteSheet = false;\r\n        const { alphabet, spriteSheet, caseInsensitive, spacing, shadow } = options;\r\n        this.alphabet = alphabet;\r\n        this.spriteSheet = spriteSheet;\r\n        this.caseInsensitive = caseInsensitive !== null && caseInsensitive !== void 0 ? caseInsensitive : this.caseInsensitive;\r\n        this.spacing = spacing !== null && spacing !== void 0 ? spacing : this.spacing;\r\n        this.shadow = shadow !== null && shadow !== void 0 ? shadow : this.shadow;\r\n    }\r\n    _getCharacterSprites(text) {\r\n        const results = [];\r\n        // handle case insensitive\r\n        const textToRender = this.caseInsensitive ? text.toLocaleLowerCase() : text;\r\n        const alphabet = this.caseInsensitive ? this.alphabet.toLocaleLowerCase() : this.alphabet;\r\n        // for each letter in text\r\n        for (let letterIndex = 0; letterIndex < textToRender.length; letterIndex++) {\r\n            // find the sprite index in alphabet , if there is an error pick the first\r\n            const letter = textToRender[letterIndex];\r\n            let spriteIndex = alphabet.indexOf(letter);\r\n            if (spriteIndex === -1) {\r\n                spriteIndex = 0;\r\n                if (!this._alreadyWarnedAlphabet) {\r\n                    this._logger.warn(`SpriteFont - Cannot find letter '${letter}' in configured alphabet '${alphabet}'.`);\r\n                    this._logger.warn('There maybe be more issues in the SpriteFont configuration. No additional warnings will be logged.');\r\n                    this._alreadyWarnedAlphabet = true;\r\n                }\r\n            }\r\n            const letterSprite = this.spriteSheet.sprites[spriteIndex];\r\n            if (letterSprite) {\r\n                results.push(letterSprite);\r\n            }\r\n            else {\r\n                if (!this._alreadyWarnedSpriteSheet) {\r\n                    this._logger.warn(`SpriteFont - Cannot find sprite for '${letter}' at index '${spriteIndex}' in configured SpriteSheet`);\r\n                    this._logger.warn('There maybe be more issues in the SpriteFont configuration. No additional warnings will be logged.');\r\n                    this._alreadyWarnedSpriteSheet = true;\r\n                }\r\n            }\r\n        }\r\n        return results;\r\n    }\r\n    measureText(text) {\r\n        const lines = text.split('\\n');\r\n        const maxWidthLine = lines.reduce((a, b) => {\r\n            return a.length > b.length ? a : b;\r\n        });\r\n        const sprites = this._getCharacterSprites(maxWidthLine);\r\n        let width = 0;\r\n        let height = 0;\r\n        for (const sprite of sprites) {\r\n            width += sprite.width + this.spacing;\r\n            height = Math.max(height, sprite.height);\r\n        }\r\n        return BoundingBox.fromDimension(width, height * lines.length, Vector.Zero);\r\n    }\r\n    _drawImage(ex, x, y) {\r\n        let xCursor = 0;\r\n        let yCursor = 0;\r\n        let height = 0;\r\n        const lines = this._text.split('\\n');\r\n        for (const line of lines) {\r\n            for (const sprite of this._getCharacterSprites(line)) {\r\n                // draw it in the right spot and increase the cursor by sprite width\r\n                sprite.draw(ex, x + xCursor, y + yCursor);\r\n                xCursor += sprite.width + this.spacing;\r\n                height = Math.max(height, sprite.height);\r\n            }\r\n            xCursor = 0;\r\n            yCursor += height;\r\n        }\r\n    }\r\n    render(ex, text, _color, x, y) {\r\n        // SpriteFont doesn't support _color, yet...\r\n        this._text = text;\r\n        const bounds = this.measureText(text);\r\n        this.width = bounds.width;\r\n        this.height = bounds.height;\r\n        if (this.shadow) {\r\n            ex.save();\r\n            ex.translate(this.shadow.offset.x, this.shadow.offset.y);\r\n            this.draw(ex, x, y);\r\n            ex.restore();\r\n        }\r\n        this.draw(ex, x, y);\r\n    }\r\n    clone() {\r\n        return new SpriteFont({\r\n            alphabet: this.alphabet,\r\n            spriteSheet: this.spriteSheet,\r\n            spacing: this.spacing\r\n        });\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/debug-font.png\n/* harmony default export */ const debug_font = (\"data:image/png;base64,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\");\n;// CONCATENATED MODULE: ./Graphics/Context/debug-text.ts\n\r\n\r\n/**\r\n * Internal debugtext helper\r\n */\r\nclass DebugText {\r\n    constructor() {\r\n        /**\r\n         * base64 font\r\n         */\r\n        this.fontSheet = debug_font;\r\n        this.size = 16;\r\n        this.load();\r\n    }\r\n    load() {\r\n        this._imageSource = new ImageSource(this.fontSheet);\r\n        return this._imageSource.load().then(() => {\r\n            this._spriteSheet = SpriteSheet.fromImageSource({\r\n                image: this._imageSource,\r\n                grid: {\r\n                    rows: 3,\r\n                    columns: 16,\r\n                    spriteWidth: 16,\r\n                    spriteHeight: 16\r\n                }\r\n            });\r\n            this._spriteFont = new SpriteFont({\r\n                alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ,!\\'&.\"?-()+ ',\r\n                caseInsensitive: true,\r\n                spriteSheet: this._spriteSheet,\r\n                spacing: -6\r\n            });\r\n        });\r\n    }\r\n    /**\r\n     * Writes debug text using the built in sprint font\r\n     * @param ctx\r\n     * @param text\r\n     * @param pos\r\n     */\r\n    write(ctx, text, pos) {\r\n        if (this._imageSource.isLoaded()) {\r\n            this._spriteFont.render(ctx, text, null, pos.x, pos.y);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/render-source.ts\nclass RenderSource {\r\n    constructor(_gl, _texture) {\r\n        this._gl = _gl;\r\n        this._texture = _texture;\r\n    }\r\n    use() {\r\n        const gl = this._gl;\r\n        gl.activeTexture(gl.TEXTURE0);\r\n        gl.bindTexture(gl.TEXTURE_2D, this._texture);\r\n    }\r\n    disable() {\r\n        const gl = this._gl;\r\n        gl.bindTexture(gl.TEXTURE_2D, null);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/render-target.ts\n\r\nclass RenderTarget {\r\n    constructor(options) {\r\n        this.width = options.width;\r\n        this.height = options.height;\r\n        this._gl = options.gl;\r\n        this._setupFramebuffer();\r\n    }\r\n    setResolution(width, height) {\r\n        const gl = this._gl;\r\n        this.width = width;\r\n        this.height = height;\r\n        gl.bindTexture(gl.TEXTURE_2D, this._frameTexture);\r\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, this.width, this.height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\r\n    }\r\n    get frameBuffer() {\r\n        return this._frameBuffer;\r\n    }\r\n    get frameTexture() {\r\n        return this._frameTexture;\r\n    }\r\n    _setupFramebuffer() {\r\n        // Allocates frame buffer\r\n        const gl = this._gl;\r\n        this._frameTexture = gl.createTexture();\r\n        gl.bindTexture(gl.TEXTURE_2D, this._frameTexture);\r\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, this.width, this.height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\r\n        // set the filtering so we don't need mips\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n        // attach the texture as the first color attachment\r\n        const attachmentPoint = gl.COLOR_ATTACHMENT0;\r\n        // After this bind all draw calls will draw to this framebuffer texture\r\n        this._frameBuffer = gl.createFramebuffer();\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, this._frameBuffer);\r\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, attachmentPoint, gl.TEXTURE_2D, this._frameTexture, 0);\r\n        // Reset after initialized\r\n        this.disable();\r\n    }\r\n    toRenderSource() {\r\n        const source = new RenderSource(this._gl, this._frameTexture);\r\n        return source;\r\n    }\r\n    /**\r\n     * When called, all drawing gets redirected to this render target\r\n     */\r\n    use() {\r\n        const gl = this._gl;\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, this._frameBuffer);\r\n        // very important to set the viewport to the size of the framebuffer texture\r\n        gl.viewport(0, 0, this.width, this.height);\r\n    }\r\n    /**\r\n     * When called, all drawing is sent back to the canvas\r\n     */\r\n    disable() {\r\n        const gl = this._gl;\r\n        // passing null switches rendering back to the canvas\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n        gl.bindTexture(gl.TEXTURE_2D, null);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/webgl-adapter.ts\n/**\r\n * Must be accessed after Engine construction time to ensure the context has been created\r\n */\r\nclass ExcaliburWebGLContextAccessor {\r\n    static clear() {\r\n        ExcaliburWebGLContextAccessor._GL = null;\r\n    }\r\n    static register(gl) {\r\n        ExcaliburWebGLContextAccessor._GL = gl;\r\n    }\r\n    // current webgl context\r\n    static get gl() {\r\n        if (!ExcaliburWebGLContextAccessor._GL) {\r\n            throw Error('Attempted gl access before init');\r\n        }\r\n        return ExcaliburWebGLContextAccessor._GL;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/line-renderer/line-vertex.glsl\n/* harmony default export */ const line_vertex = (\"#version 300 es\\r\\nin vec2 a_position;\\r\\nin vec4 a_color;\\r\\n\\r\\nout lowp vec4 v_color;\\r\\n\\r\\nuniform mat4 u_matrix;\\r\\n\\r\\nvoid main() {\\r\\n   // Set the vertex position using the ortho transform matrix\\r\\n   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\\r\\n\\r\\n   // Passthrough the color\\r\\n   v_color = a_color;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/line-renderer/line-fragment.glsl\n/* harmony default export */ const line_fragment = (\"#version 300 es\\r\\nprecision mediump float;\\r\\n\\r\\n// Color\\r\\nin lowp vec4 v_color;\\r\\n\\r\\nout vec4 fragColor;\\r\\n\\r\\nvoid main() {\\r\\n  fragColor = v_color;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/webgl-util.ts\n/**\r\n * Return the size of the GlType in bytes\r\n * @param gl\r\n * @param type\r\n */\r\nfunction getGlTypeSizeBytes(gl, type) {\r\n    switch (type) {\r\n        case gl.FLOAT:\r\n            return 4;\r\n        case gl.SHORT:\r\n            return 2;\r\n        case gl.UNSIGNED_SHORT:\r\n            return 2;\r\n        case gl.BYTE:\r\n            return 1;\r\n        case gl.UNSIGNED_BYTE:\r\n            return 1;\r\n        default:\r\n            return 1;\r\n    }\r\n}\r\n/**\r\n * Based on the type return the number of attribute components\r\n *\r\n * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/vertexAttribPointer\r\n * @param gl\r\n * @param type\r\n */\r\nfunction getAttributeComponentSize(gl, type) {\r\n    switch (type) {\r\n        case gl.LOW_FLOAT:\r\n        case gl.HIGH_FLOAT:\r\n        case gl.FLOAT:\r\n            return 1;\r\n        case gl.FLOAT_VEC2:\r\n            return 2;\r\n        case gl.FLOAT_VEC3:\r\n            return 3;\r\n        case gl.FLOAT_VEC4:\r\n            return 4;\r\n        case gl.BYTE:\r\n            return 1;\r\n        case gl.UNSIGNED_BYTE:\r\n            return 1;\r\n        case gl.UNSIGNED_SHORT:\r\n        case gl.SHORT:\r\n            return 1;\r\n        default:\r\n            return 1;\r\n    }\r\n}\r\n/**\r\n * Based on the attribute return the corresponding supported attrib pointer type\r\n * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/vertexAttribPointer\r\n *\r\n * @param gl\r\n * @param type\r\n */\r\nfunction getAttributePointerType(gl, type) {\r\n    switch (type) {\r\n        case gl.LOW_FLOAT:\r\n        case gl.HIGH_FLOAT:\r\n        case gl.FLOAT:\r\n        case gl.FLOAT_VEC2:\r\n        case gl.FLOAT_VEC3:\r\n        case gl.FLOAT_VEC4:\r\n            return gl.FLOAT;\r\n        case gl.BYTE:\r\n            return gl.BYTE;\r\n        case gl.UNSIGNED_BYTE:\r\n            return gl.UNSIGNED_BYTE;\r\n        case gl.SHORT:\r\n            return gl.SHORT;\r\n        case gl.UNSIGNED_SHORT:\r\n            return gl.UNSIGNED_SHORT;\r\n        default:\r\n            return gl.FLOAT;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/shader.ts\n\r\n\r\nclass Shader {\r\n    /**\r\n     * Create a shader program in excalibur\r\n     * @param options specify shader vertex and fragment source\r\n     */\r\n    constructor(options) {\r\n        this._gl = ExcaliburWebGLContextAccessor.gl;\r\n        this.uniforms = {};\r\n        this.attributes = {};\r\n        this._compiled = false;\r\n        const { vertexSource, fragmentSource } = options;\r\n        this.vertexSource = vertexSource;\r\n        this.fragmentSource = fragmentSource;\r\n    }\r\n    get compiled() {\r\n        return this._compiled;\r\n    }\r\n    /**\r\n     * Binds the shader program\r\n     */\r\n    use() {\r\n        const gl = this._gl;\r\n        gl.useProgram(this.program);\r\n        Shader._ACTIVE_SHADER_INSTANCE = this;\r\n    }\r\n    isCurrentlyBound() {\r\n        return Shader._ACTIVE_SHADER_INSTANCE === this;\r\n    }\r\n    /**\r\n     * Compile the current shader against a webgl context\r\n     */\r\n    compile() {\r\n        const gl = this._gl;\r\n        const vertexShader = this._compileShader(gl, this.vertexSource, gl.VERTEX_SHADER);\r\n        const fragmentShader = this._compileShader(gl, this.fragmentSource, gl.FRAGMENT_SHADER);\r\n        this.program = this._createProgram(gl, vertexShader, fragmentShader);\r\n        const attributes = this.getAttributes();\r\n        for (const attribute of attributes) {\r\n            this.attributes[attribute.name] = attribute;\r\n        }\r\n        const uniforms = this.getUniforms();\r\n        for (const uniform of uniforms) {\r\n            this.uniforms[uniform.name] = uniform;\r\n        }\r\n        this._compiled = true;\r\n        return this.program;\r\n    }\r\n    getUniforms() {\r\n        const gl = this._gl;\r\n        const uniformCount = gl.getProgramParameter(this.program, gl.ACTIVE_UNIFORMS);\r\n        const uniforms = [];\r\n        for (let i = 0; i < uniformCount; i++) {\r\n            const uniform = gl.getActiveUniform(this.program, i);\r\n            const uniformLocation = gl.getUniformLocation(this.program, uniform.name);\r\n            uniforms.push({\r\n                name: uniform.name,\r\n                glType: uniform.type,\r\n                location: uniformLocation\r\n            });\r\n        }\r\n        return uniforms;\r\n    }\r\n    getAttributes() {\r\n        const gl = this._gl;\r\n        const attributeCount = gl.getProgramParameter(this.program, gl.ACTIVE_ATTRIBUTES);\r\n        const attributes = [];\r\n        for (let i = 0; i < attributeCount; i++) {\r\n            const attribute = gl.getActiveAttrib(this.program, i);\r\n            const attributeLocation = gl.getAttribLocation(this.program, attribute.name);\r\n            attributes.push({\r\n                name: attribute.name,\r\n                glType: getAttributePointerType(gl, attribute.type),\r\n                size: getAttributeComponentSize(gl, attribute.type),\r\n                location: attributeLocation,\r\n                normalized: false\r\n            });\r\n        }\r\n        return attributes;\r\n    }\r\n    /**\r\n     * Set a texture in a gpu texture slot\r\n     * @param slotNumber\r\n     * @param texture\r\n     */\r\n    setTexture(slotNumber, texture) {\r\n        const gl = this._gl;\r\n        gl.activeTexture(gl.TEXTURE0 + slotNumber);\r\n        gl.bindTexture(gl.TEXTURE_2D, texture);\r\n    }\r\n    /**\r\n     * Set an integer uniform for the current shader\r\n     *\r\n     * **Important** Must call ex.Shader.use() before setting a uniform!\r\n     *\r\n     * @param name\r\n     * @param value\r\n     */\r\n    setUniformInt(name, value) {\r\n        this.setUniform('uniform1i', name, ~~value);\r\n    }\r\n    /**\r\n     * Set an integer array uniform for the current shader\r\n     *\r\n     * **Important** Must call ex.Shader.use() before setting a uniform!\r\n     *\r\n     * @param name\r\n     * @param value\r\n     */\r\n    setUniformIntArray(name, value) {\r\n        this.setUniform('uniform1iv', name, value);\r\n    }\r\n    /**\r\n     * Set a boolean uniform for the current shader\r\n     *\r\n     * **Important** Must call ex.Shader.use() before setting a uniform!\r\n     *\r\n     * @param name\r\n     * @param value\r\n     */\r\n    setUniformBoolean(name, value) {\r\n        this.setUniform('uniform1i', name, value ? 1 : 0);\r\n    }\r\n    /**\r\n     * Set a float uniform for the current shader\r\n     *\r\n     * **Important** Must call ex.Shader.use() before setting a uniform!\r\n     *\r\n     * @param name\r\n     * @param value\r\n     */\r\n    setUniformFloat(name, value) {\r\n        this.setUniform('uniform1f', name, value);\r\n    }\r\n    /**\r\n     * Set a float array uniform for the current shader\r\n     *\r\n     * **Important** Must call ex.Shader.use() before setting a uniform!\r\n     *\r\n     * @param name\r\n     * @param value\r\n     */\r\n    setUniformFloatArray(name, value) {\r\n        this.setUniform('uniform1fv', name, value);\r\n    }\r\n    /**\r\n     * Set a [[Vector]] uniform for the current shader\r\n     *\r\n     * **Important** Must call ex.Shader.use() before setting a uniform!\r\n     *\r\n     * @param name\r\n     * @param value\r\n     */\r\n    setUniformFloatVector(name, value) {\r\n        this.setUniform('uniform2f', name, value.x, value.y);\r\n    }\r\n    /**\r\n     * Set an [[Matrix]] uniform for the current shader\r\n     *\r\n     * **Important** Must call ex.Shader.use() before setting a uniform!\r\n     *\r\n     * @param name\r\n     * @param value\r\n     */\r\n    setUniformMatrix(name, value) {\r\n        this.setUniform('uniformMatrix4fv', name, false, value.data);\r\n    }\r\n    /**\r\n     * Set any available uniform type in webgl\r\n     *\r\n     * For example setUniform('uniformMatrix2fv', 'u_my2x2_mat`, ...);\r\n     */\r\n    setUniform(uniformType, name, ...value) {\r\n        if (!this._compiled) {\r\n            throw Error(`Must compile shader before setting a uniform ${uniformType}:${name}`);\r\n        }\r\n        if (!this.isCurrentlyBound()) {\r\n            throw Error('Currently accessed shader instance is not the current active shader in WebGL,' +\r\n                ' must call `shader.use()` before setting uniforms');\r\n        }\r\n        const gl = this._gl;\r\n        const location = gl.getUniformLocation(this.program, name);\r\n        if (location) {\r\n            const args = [location, ...value];\r\n            this._gl[uniformType].apply(this._gl, args);\r\n        }\r\n        else {\r\n            throw Error(`Uniform ${uniformType}:${name} doesn\\'t exist or is not used in the shader source code,` +\r\n                ' unused uniforms are optimized away by most browsers');\r\n        }\r\n    }\r\n    _createProgram(gl, vertexShader, fragmentShader) {\r\n        const program = gl.createProgram();\r\n        if (program === null) {\r\n            throw Error('Could not create graphics shader program');\r\n        }\r\n        // attach the shaders.\r\n        gl.attachShader(program, vertexShader);\r\n        gl.attachShader(program, fragmentShader);\r\n        // link the program.\r\n        gl.linkProgram(program);\r\n        const success = gl.getProgramParameter(program, gl.LINK_STATUS);\r\n        if (!success) {\r\n            throw Error(`Could not link the program: [${gl.getProgramInfoLog(program)}]`);\r\n        }\r\n        return program;\r\n    }\r\n    _compileShader(gl, source, type) {\r\n        const typeName = gl.VERTEX_SHADER === type ? 'vertex' : 'fragment';\r\n        const shader = gl.createShader(type);\r\n        if (shader === null) {\r\n            throw Error(`Could not build shader: [${source}]`);\r\n        }\r\n        gl.shaderSource(shader, source);\r\n        gl.compileShader(shader);\r\n        const success = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\r\n        if (!success) {\r\n            const errorInfo = gl.getShaderInfoLog(shader);\r\n            throw Error(`Could not compile ${typeName} shader:\\n\\n${errorInfo}${this._processSourceForError(source, errorInfo)}`);\r\n        }\r\n        return shader;\r\n    }\r\n    _processSourceForError(source, errorInfo) {\r\n        const lines = source.split('\\n');\r\n        const errorLineStart = errorInfo.search(/\\d:\\d/);\r\n        const errorLineEnd = errorInfo.indexOf(' ', errorLineStart);\r\n        const [_, error2] = errorInfo.slice(errorLineStart, errorLineEnd).split(':').map(v => Number(v));\r\n        for (let i = 0; i < lines.length; i++) {\r\n            lines[i] = `${i + 1}: ${lines[i]}${error2 === (i + 1) ? ' <----- ERROR!' : ''}`;\r\n        }\r\n        return '\\n\\nSource:\\n' + lines.join('\\n');\r\n    }\r\n}\r\nShader._ACTIVE_SHADER_INSTANCE = null;\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/vertex-buffer.ts\n\r\n/**\r\n * Helper around vertex buffer to simplify creating and uploading geometry\r\n *\r\n * Under the hood uses Float32Array\r\n */\r\nclass VertexBuffer {\r\n    constructor(options) {\r\n        this._gl = ExcaliburWebGLContextAccessor.gl;\r\n        /**\r\n         * If the vertices never change switching 'static' can be more efficient on the gpu\r\n         *\r\n         * Default is 'dynamic'\r\n         */\r\n        this.type = 'dynamic';\r\n        const { size, type, data } = options;\r\n        this.buffer = this._gl.createBuffer();\r\n        if (!data && !size) {\r\n            throw Error('Must either provide data or a size to the VertexBuffer');\r\n        }\r\n        if (!data) {\r\n            this.bufferData = new Float32Array(size);\r\n        }\r\n        else {\r\n            this.bufferData = data;\r\n        }\r\n        this.type = type !== null && type !== void 0 ? type : this.type;\r\n        // Allocate buffer\r\n        const gl = this._gl;\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.buffer);\r\n        gl.bufferData(gl.ARRAY_BUFFER, this.bufferData, this.type === 'static' ? gl.STATIC_DRAW : gl.DYNAMIC_DRAW);\r\n    }\r\n    /**\r\n     * Bind this vertex buffer\r\n     */\r\n    bind() {\r\n        const gl = this._gl;\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.buffer);\r\n    }\r\n    /**\r\n     * Upload vertex buffer geometry to the GPU\r\n     */\r\n    upload(count) {\r\n        const gl = this._gl;\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.buffer);\r\n        if (count) {\r\n            gl.bufferSubData(gl.ARRAY_BUFFER, 0, this.bufferData, 0, count);\r\n        }\r\n        else {\r\n            // TODO always use bufferSubData? need to perf test it\r\n            gl.bufferData(gl.ARRAY_BUFFER, this.bufferData, this.type === 'static' ? gl.STATIC_DRAW : gl.DYNAMIC_DRAW);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/vertex-layout.ts\n\r\n\r\n\r\n/**\r\n * Helper around creating vertex attributes in a given [[VertexBuffer]], this is useful for describing\r\n * the memory layout for your vertices inside a particular buffer\r\n *\r\n * Note: This helper assumes interleaved attributes in one [[VertexBuffer]], not many.\r\n *\r\n * Working with `gl.vertexAttribPointer` can be tricky, and this attempts to double check you\r\n */\r\nclass VertexLayout {\r\n    constructor(options) {\r\n        this._gl = ExcaliburWebGLContextAccessor.gl;\r\n        this._logger = Logger.getInstance();\r\n        this._layout = [];\r\n        this._attributes = [];\r\n        this._vertexTotalSizeBytes = 0;\r\n        const { shader, vertexBuffer, attributes } = options;\r\n        this._vertexBuffer = vertexBuffer;\r\n        this._attributes = attributes;\r\n        this._shader = shader;\r\n        this.initialize();\r\n    }\r\n    get vertexBuffer() {\r\n        return this._vertexBuffer;\r\n    }\r\n    get attributes() {\r\n        return this._attributes;\r\n    }\r\n    /**\r\n     * Total number of bytes that the vertex will take up\r\n     */\r\n    get totalVertexSizeBytes() {\r\n        return this._vertexTotalSizeBytes;\r\n    }\r\n    /**\r\n     * Layouts need shader locations and must be bound to a shader\r\n     */\r\n    initialize() {\r\n        if (!this._shader.compiled) {\r\n            throw Error('Shader not compiled, shader must be compiled before defining a vertex layout');\r\n        }\r\n        this._layout.length = 0;\r\n        const shaderAttributes = this._shader.attributes;\r\n        for (const attribute of this._attributes) {\r\n            const attrib = shaderAttributes[attribute[0]];\r\n            if (!attrib) {\r\n                throw Error(`The attribute named: ${attribute[0]} size ${attribute[1]}` +\r\n                    ` not found in the shader source code:\\n ${this._shader.vertexSource}`);\r\n            }\r\n            if (attrib.size !== attribute[1]) {\r\n                throw Error(`VertexLayout size definition for attribute: [${attribute[0]}, ${attribute[1]}],`\r\n                    + ` doesnt match shader source size ${attrib.size}:\\n ${this._shader.vertexSource}`);\r\n            }\r\n            this._layout.push(attrib);\r\n        }\r\n        // calc size\r\n        let componentsPerVertex = 0;\r\n        for (const vertAttribute of this._layout) {\r\n            const typeSize = getGlTypeSizeBytes(this._gl, vertAttribute.glType);\r\n            this._vertexTotalSizeBytes += typeSize * vertAttribute.size;\r\n            componentsPerVertex += vertAttribute.size;\r\n        }\r\n        if (this._vertexBuffer.bufferData.length % componentsPerVertex !== 0) {\r\n            this._logger.warn(`The vertex component size (${componentsPerVertex})  does divide evenly into the specified vertex buffer`\r\n                + ` (${this._vertexBuffer.bufferData.length})`);\r\n        }\r\n    }\r\n    /**\r\n     * Bind this layout with it's associated vertex buffer\r\n     *\r\n     * @param uploadBuffer Optionally indicate you wish to upload the buffer to the GPU associated with this layout\r\n     */\r\n    use(uploadBuffer = false, count) {\r\n        const gl = this._gl;\r\n        if (!this._shader.isCurrentlyBound()) {\r\n            throw Error('Shader associated with this vertex layout is not active! Call shader.use() before layout.use()');\r\n        }\r\n        this._vertexBuffer.bind();\r\n        if (uploadBuffer) {\r\n            this._vertexBuffer.upload(count);\r\n        }\r\n        let offset = 0;\r\n        // TODO switch to VAOs if the extension is\r\n        for (const vert of this._layout) {\r\n            gl.vertexAttribPointer(vert.location, vert.size, vert.glType, vert.normalized, this.totalVertexSizeBytes, offset);\r\n            gl.enableVertexAttribArray(vert.location);\r\n            offset += getGlTypeSizeBytes(gl, vert.glType) * vert.size;\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/GraphicsDiagnostics.ts\nclass GraphicsDiagnostics {\r\n    static clear() {\r\n        GraphicsDiagnostics.DrawCallCount = 0;\r\n        GraphicsDiagnostics.DrawnImagesCount = 0;\r\n    }\r\n}\r\nGraphicsDiagnostics.DrawCallCount = 0;\r\nGraphicsDiagnostics.DrawnImagesCount = 0;\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/line-renderer/line-renderer.ts\n\r\n\r\n\r\n\r\nclass LineRenderer {\r\n    constructor() {\r\n        this.type = 'ex.line';\r\n        this.priority = 0;\r\n        this._maxLines = 10922;\r\n        this._vertexIndex = 0;\r\n        this._lineCount = 0;\r\n    }\r\n    initialize(gl, context) {\r\n        this._gl = gl;\r\n        this._context = context;\r\n        this._shader = new Shader({\r\n            vertexSource: line_vertex,\r\n            fragmentSource: line_fragment\r\n        });\r\n        this._shader.compile();\r\n        this._shader.use();\r\n        this._shader.setUniformMatrix('u_matrix', this._context.ortho);\r\n        this._vertexBuffer = new VertexBuffer({\r\n            size: 6 * 2 * this._maxLines,\r\n            type: 'dynamic'\r\n        });\r\n        this._layout = new VertexLayout({\r\n            vertexBuffer: this._vertexBuffer,\r\n            shader: this._shader,\r\n            attributes: [\r\n                ['a_position', 2],\r\n                ['a_color', 4]\r\n            ]\r\n        });\r\n    }\r\n    draw(start, end, color) {\r\n        // Force a render if the batch is full\r\n        if (this._isFull()) {\r\n            this.flush();\r\n        }\r\n        this._lineCount++;\r\n        const transform = this._context.getTransform();\r\n        const finalStart = transform.multiply(start);\r\n        const finalEnd = transform.multiply(end);\r\n        const vertexBuffer = this._vertexBuffer.bufferData;\r\n        // Start\r\n        vertexBuffer[this._vertexIndex++] = finalStart.x;\r\n        vertexBuffer[this._vertexIndex++] = finalStart.y;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        // End\r\n        vertexBuffer[this._vertexIndex++] = finalEnd.x;\r\n        vertexBuffer[this._vertexIndex++] = finalEnd.y;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n    }\r\n    _isFull() {\r\n        if (this._lineCount >= this._maxLines) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    hasPendingDraws() {\r\n        return this._lineCount !== 0;\r\n    }\r\n    flush() {\r\n        // nothing to draw early exit\r\n        if (this._lineCount === 0) {\r\n            return;\r\n        }\r\n        const gl = this._gl;\r\n        this._shader.use();\r\n        this._layout.use(true);\r\n        this._shader.setUniformMatrix('u_matrix', this._context.ortho);\r\n        gl.drawArrays(gl.LINES, 0, this._lineCount * 2); // 2 verts per line\r\n        GraphicsDiagnostics.DrawnImagesCount += this._lineCount;\r\n        GraphicsDiagnostics.DrawCallCount++;\r\n        // reset\r\n        this._vertexIndex = 0;\r\n        this._lineCount = 0;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/point-renderer/point-vertex.glsl\n/* harmony default export */ const point_vertex = (\"#version 300 es\\r\\nin vec2 a_position;\\r\\nin vec4 a_color;\\r\\nin float a_size;\\r\\nout lowp vec4 v_color;\\r\\nuniform mat4 u_matrix;\\r\\n\\r\\nvoid main() {\\r\\n  gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\\r\\n  gl_PointSize = a_size * 2.0;\\r\\n  v_color = a_color;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/point-renderer/point-fragment.glsl\n/* harmony default export */ const point_fragment = (\"#version 300 es\\r\\n\\r\\nprecision mediump float;\\r\\nin lowp vec4 v_color;\\r\\n\\r\\nout vec4 fragColor;\\r\\n\\r\\nvoid main() {\\r\\n  float r = 0.0, delta = 0.0, alpha = 1.0;\\r\\n  vec2 cxy = 2.0 * gl_PointCoord - 1.0;\\r\\n  r = dot(cxy, cxy);\\r\\n\\r\\n  delta = fwidth(r);\\r\\n  alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\\r\\n  // \\\"premultiply\\\" the color by alpha\\r\\n  vec4 color = v_color;\\r\\n  color.a = color.a * alpha;\\r\\n  color.rgb = color.rgb * color.a;\\r\\n  fragColor = color;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/point-renderer/point-renderer.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass PointRenderer {\r\n    constructor() {\r\n        this.type = 'ex.point';\r\n        this.priority = 0;\r\n        this._maxPoints = 10922;\r\n        this._pointCount = 0;\r\n        this._vertexIndex = 0;\r\n    }\r\n    initialize(gl, context) {\r\n        this._gl = gl;\r\n        this._context = context;\r\n        this._shader = new Shader({\r\n            vertexSource: point_vertex,\r\n            fragmentSource: point_fragment\r\n        });\r\n        this._shader.compile();\r\n        this._shader.use();\r\n        this._shader.setUniformMatrix('u_matrix', this._context.ortho);\r\n        this._buffer = new VertexBuffer({\r\n            size: 7 * this._maxPoints,\r\n            type: 'dynamic'\r\n        });\r\n        this._layout = new VertexLayout({\r\n            shader: this._shader,\r\n            vertexBuffer: this._buffer,\r\n            attributes: [\r\n                ['a_position', 2],\r\n                ['a_color', 4],\r\n                ['a_size', 1]\r\n            ]\r\n        });\r\n    }\r\n    draw(point, color, size) {\r\n        // Force a render if the batch is full\r\n        if (this._isFull()) {\r\n            this.flush();\r\n        }\r\n        this._pointCount++;\r\n        const transform = this._context.getTransform();\r\n        const opacity = this._context.opacity;\r\n        const snapToPixel = this._context.snapToPixel;\r\n        const finalPoint = transform.multiply(point);\r\n        if (snapToPixel) {\r\n            finalPoint.x = ~~(finalPoint.x + pixelSnapEpsilon);\r\n            finalPoint.y = ~~(finalPoint.y + pixelSnapEpsilon);\r\n        }\r\n        const vertexBuffer = this._buffer.bufferData;\r\n        vertexBuffer[this._vertexIndex++] = finalPoint.x;\r\n        vertexBuffer[this._vertexIndex++] = finalPoint.y;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a * opacity;\r\n        vertexBuffer[this._vertexIndex++] = size * Math.max(transform.getScaleX(), transform.getScaleY());\r\n    }\r\n    _isFull() {\r\n        if (this._pointCount >= this._maxPoints) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    hasPendingDraws() {\r\n        return this._pointCount !== 0;\r\n    }\r\n    flush() {\r\n        // nothing to draw early exit\r\n        if (this._pointCount === 0) {\r\n            return;\r\n        }\r\n        const gl = this._gl;\r\n        this._shader.use();\r\n        this._layout.use(true);\r\n        this._shader.setUniformMatrix('u_matrix', this._context.ortho);\r\n        gl.drawArrays(gl.POINTS, 0, this._pointCount);\r\n        GraphicsDiagnostics.DrawnImagesCount += this._pointCount;\r\n        GraphicsDiagnostics.DrawCallCount++;\r\n        this._pointCount = 0;\r\n        this._vertexIndex = 0;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/screen-pass-painter/screen-vertex.glsl\n/* harmony default export */ const screen_vertex = (\"#version 300 es\\r\\nin vec2 a_position;\\r\\n\\r\\nin vec2 a_texcoord;\\r\\nout vec2 v_texcoord;\\r\\n\\r\\nvoid main() {\\r\\n  gl_Position = vec4(a_position, 0.0, 1.0);\\r\\n\\r\\n  // Pass the texcoord to the fragment shader.\\r\\n  v_texcoord = a_texcoord;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/screen-pass-painter/screen-fragment.glsl\n/* harmony default export */ const screen_fragment = (\"#version 300 es\\r\\nprecision mediump float;\\r\\n\\r\\n// Passed in from the vertex shader.\\r\\nin vec2 v_texcoord;\\r\\n\\r\\n// The texture.\\r\\nuniform sampler2D u_texture;\\r\\n\\r\\nout vec4 fragColor;\\r\\n\\r\\nvoid main() {\\r\\n   fragColor = texture(u_texture, v_texcoord);\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/screen-pass-painter/screen-pass-painter.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * This is responsible for painting the entire screen during the render passes\r\n */\r\nclass ScreenPassPainter {\r\n    constructor(gl) {\r\n        this._gl = gl;\r\n        this._shader = new Shader({\r\n            vertexSource: screen_vertex,\r\n            fragmentSource: screen_fragment\r\n        });\r\n        this._shader.compile();\r\n        // Setup memory layout\r\n        this._buffer = new VertexBuffer({\r\n            type: 'static',\r\n            // clip space quad + uv since we don't need a camera\r\n            data: new Float32Array([\r\n                -1, -1, 0, 0,\r\n                -1, 1, 0, 1,\r\n                1, -1, 1, 0,\r\n                1, -1, 1, 0,\r\n                -1, 1, 0, 1,\r\n                1, 1, 1, 1\r\n            ])\r\n        });\r\n        this._layout = new VertexLayout({\r\n            shader: this._shader,\r\n            vertexBuffer: this._buffer,\r\n            attributes: [\r\n                ['a_position', 2],\r\n                ['a_texcoord', 2]\r\n            ]\r\n        });\r\n        this._buffer.upload();\r\n    }\r\n    renderWithPostProcessor(postprocessor) {\r\n        const gl = this._gl;\r\n        postprocessor.getShader().use();\r\n        postprocessor.getLayout().use();\r\n        gl.drawArrays(gl.TRIANGLES, 0, 6);\r\n    }\r\n    renderToScreen() {\r\n        const gl = this._gl;\r\n        this._shader.use();\r\n        this._layout.use();\r\n        gl.drawArrays(gl.TRIANGLES, 0, 6);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/quad-index-buffer.ts\n\r\n\r\n/**\r\n * Helper that defines and index buffer for quad geometry\r\n *\r\n * Index buffers allow you to save space in vertex buffers when you share vertices in geometry\r\n * it is almost always worth it in terms of performance to use an index buffer.\r\n */\r\nclass QuadIndexBuffer {\r\n    /**\r\n     * @param numberOfQuads Specify the max number of quads you want to draw\r\n     * @param useUint16 Optionally force a uint16 buffer\r\n     */\r\n    constructor(numberOfQuads, useUint16) {\r\n        this._gl = ExcaliburWebGLContextAccessor.gl;\r\n        this._logger = Logger.getInstance();\r\n        const gl = this._gl;\r\n        this.buffer = gl.createBuffer();\r\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.buffer);\r\n        const totalVertices = numberOfQuads * 6;\r\n        if (!useUint16) {\r\n            this.bufferData = new Uint32Array(totalVertices);\r\n        }\r\n        else {\r\n            // fall back to using gl.UNSIGNED_SHORT or tell the user they are out of luck\r\n            const maxUint16 = 65535;\r\n            const maxUint16Index = Math.floor((maxUint16 - 1) / 4); // max quads\r\n            this.bufferGlType = gl.UNSIGNED_SHORT;\r\n            this.bufferData = new Uint16Array(totalVertices);\r\n            // TODO Should we error if this happens?? maybe not might crash mid game\r\n            if (numberOfQuads > maxUint16Index) {\r\n                this._logger.warn(`Total quads exceeds hardware index buffer limit (uint16), max(${maxUint16Index}) requested quads(${numberOfQuads})`);\r\n            }\r\n        }\r\n        let currentQuad = 0;\r\n        for (let i = 0; i < totalVertices; i += 6) {\r\n            // first triangle\r\n            this.bufferData[i + 0] = currentQuad + 0;\r\n            this.bufferData[i + 1] = currentQuad + 1;\r\n            this.bufferData[i + 2] = currentQuad + 2;\r\n            // second triangle\r\n            this.bufferData[i + 3] = currentQuad + 2;\r\n            this.bufferData[i + 4] = currentQuad + 1;\r\n            this.bufferData[i + 5] = currentQuad + 3;\r\n            currentQuad += 4;\r\n        }\r\n        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, this.bufferData, gl.STATIC_DRAW);\r\n    }\r\n    get size() {\r\n        return this.bufferData.length;\r\n    }\r\n    /**\r\n     * Upload data to the GPU\r\n     */\r\n    upload() {\r\n        const gl = this._gl;\r\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.buffer);\r\n        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, this.bufferData, gl.STATIC_DRAW);\r\n    }\r\n    /**\r\n     * Bind this index buffer\r\n     */\r\n    bind() {\r\n        const gl = this._gl;\r\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.buffer);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/image-renderer/image-renderer.frag.glsl\n/* harmony default export */ const image_renderer_frag = (\"#version 300 es\\r\\nprecision mediump float;\\r\\n\\r\\n// UV coord\\r\\nin vec2 v_texcoord;\\r\\n\\r\\n// Texture index\\r\\nin lowp float v_textureIndex;\\r\\n\\r\\n// Textures in the current draw\\r\\nuniform sampler2D u_textures[%%count%%];\\r\\n\\r\\n// Opacity\\r\\nin float v_opacity;\\r\\n\\r\\nin vec4 v_tint;\\r\\n\\r\\nout vec4 fragColor;\\r\\n\\r\\nvoid main() {\\r\\n   // In order to support the most efficient sprite batching, we have multiple\\r\\n   // textures loaded into the gpu (usually 8) this picker logic skips over textures\\r\\n   // that do not apply to a particular sprite.\\r\\n\\r\\n   vec4 color = vec4(1.0, 0, 0, 1.0);\\r\\n\\r\\n   // GLSL is templated out to pick the right texture and set the vec4 color\\r\\n   %%texture_picker%%\\r\\n\\r\\n   color.rgb = color.rgb * v_opacity;\\r\\n   color.a = color.a * v_opacity;\\r\\n   fragColor = color * v_tint;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/image-renderer/image-renderer.vert.glsl\n/* harmony default export */ const image_renderer_vert = (\"#version 300 es\\r\\nin vec2 a_position;\\r\\n\\r\\n// Opacity \\r\\nin float a_opacity;\\r\\nout float v_opacity;\\r\\n\\r\\n// UV coordinate\\r\\nin vec2 a_texcoord;\\r\\nout vec2 v_texcoord;\\r\\n\\r\\n// Texture number\\r\\nin lowp float a_textureIndex;\\r\\nout lowp float v_textureIndex;\\r\\n\\r\\nin vec4 a_tint;\\r\\nout vec4 v_tint;\\r\\n\\r\\nuniform mat4 u_matrix;\\r\\n\\r\\nvoid main() {\\r\\n   // Set the vertex position using the ortho transform matrix\\r\\n   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\\r\\n\\r\\n   // Pass through the Opacity to the fragment shader\\r\\n   v_opacity = a_opacity;\\r\\n   // Pass through the UV coord to the fragment shader\\r\\n   v_texcoord = a_texcoord;\\r\\n   // Pass through the texture number to the fragment shader\\r\\n   v_textureIndex = a_textureIndex;\\r\\n   // Pass through the tint\\r\\n   v_tint = a_tint;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/image-renderer/image-renderer.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass ImageRenderer {\r\n    constructor() {\r\n        this.type = 'ex.image';\r\n        this.priority = 0;\r\n        this._maxImages = 10922; // max(uint16) / 6 verts\r\n        this._maxTextures = 0;\r\n        // Per flush vars\r\n        this._imageCount = 0;\r\n        this._textures = [];\r\n        this._vertexIndex = 0;\r\n    }\r\n    initialize(gl, context) {\r\n        this._gl = gl;\r\n        this._context = context;\r\n        // Transform shader source\r\n        // FIXME: PIXEL 6 complains `ERROR: Expression too complex.` if we use it's reported max texture units, 125 seems to work for now...\r\n        this._maxTextures = Math.min(gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS), 125);\r\n        const transformedFrag = this._transformFragmentSource(image_renderer_frag, this._maxTextures);\r\n        // Compile shader\r\n        this._shader = new Shader({\r\n            fragmentSource: transformedFrag,\r\n            vertexSource: image_renderer_vert\r\n        });\r\n        this._shader.compile();\r\n        // setup uniforms\r\n        this._shader.use();\r\n        this._shader.setUniformMatrix('u_matrix', context.ortho);\r\n        // Initialize texture slots to [0, 1, 2, 3, 4, .... maxGPUTextures]\r\n        this._shader.setUniformIntArray('u_textures', [...Array(this._maxTextures)].map((_, i) => i));\r\n        // Setup memory layout\r\n        this._buffer = new VertexBuffer({\r\n            size: 10 * 4 * this._maxImages,\r\n            type: 'dynamic'\r\n        });\r\n        this._layout = new VertexLayout({\r\n            shader: this._shader,\r\n            vertexBuffer: this._buffer,\r\n            attributes: [\r\n                ['a_position', 2],\r\n                ['a_opacity', 1],\r\n                ['a_texcoord', 2],\r\n                ['a_textureIndex', 1],\r\n                ['a_tint', 4]\r\n            ]\r\n        });\r\n        // Setup index buffer\r\n        this._quads = new QuadIndexBuffer(this._maxImages, true);\r\n    }\r\n    _transformFragmentSource(source, maxTextures) {\r\n        let newSource = source.replace('%%count%%', maxTextures.toString());\r\n        let texturePickerBuilder = '';\r\n        for (let i = 0; i < maxTextures; i++) {\r\n            if (i === 0) {\r\n                texturePickerBuilder += `if (v_textureIndex <= ${i}.5) {\\n`;\r\n            }\r\n            else {\r\n                texturePickerBuilder += `   else if (v_textureIndex <= ${i}.5) {\\n`;\r\n            }\r\n            texturePickerBuilder += `      color = texture(u_textures[${i}], v_texcoord);\\n`;\r\n            texturePickerBuilder += `   }\\n`;\r\n        }\r\n        newSource = newSource.replace('%%texture_picker%%', texturePickerBuilder);\r\n        return newSource;\r\n    }\r\n    _addImageAsTexture(image) {\r\n        const texture = TextureLoader.load(image);\r\n        if (this._textures.indexOf(texture) === -1) {\r\n            this._textures.push(texture);\r\n        }\r\n    }\r\n    _bindTextures(gl) {\r\n        // Bind textures in the correct order\r\n        for (let i = 0; i < this._maxTextures; i++) {\r\n            gl.activeTexture(gl.TEXTURE0 + i);\r\n            gl.bindTexture(gl.TEXTURE_2D, this._textures[i] || this._textures[0]);\r\n        }\r\n    }\r\n    _getTextureIdForImage(image) {\r\n        if (image) {\r\n            return this._textures.indexOf(TextureLoader.get(image));\r\n        }\r\n        return -1;\r\n    }\r\n    _isFull() {\r\n        if (this._imageCount >= this._maxImages) {\r\n            return true;\r\n        }\r\n        if (this._textures.length >= this._maxTextures) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    draw(image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight) {\r\n        var _a, _b, _c, _d;\r\n        // Force a render if the batch is full\r\n        if (this._isFull()) {\r\n            this.flush();\r\n        }\r\n        this._imageCount++;\r\n        this._addImageAsTexture(image);\r\n        let width = (image === null || image === void 0 ? void 0 : image.width) || swidth || 0;\r\n        let height = (image === null || image === void 0 ? void 0 : image.height) || sheight || 0;\r\n        let view = [0, 0, (_a = swidth !== null && swidth !== void 0 ? swidth : image === null || image === void 0 ? void 0 : image.width) !== null && _a !== void 0 ? _a : 0, (_b = sheight !== null && sheight !== void 0 ? sheight : image === null || image === void 0 ? void 0 : image.height) !== null && _b !== void 0 ? _b : 0];\r\n        let dest = [sx !== null && sx !== void 0 ? sx : 1, sy !== null && sy !== void 0 ? sy : 1];\r\n        // If destination is specified, update view and dest\r\n        if (dx !== undefined && dy !== undefined && dwidth !== undefined && dheight !== undefined) {\r\n            view = [sx !== null && sx !== void 0 ? sx : 1, sy !== null && sy !== void 0 ? sy : 1, (_c = swidth !== null && swidth !== void 0 ? swidth : image === null || image === void 0 ? void 0 : image.width) !== null && _c !== void 0 ? _c : 0, (_d = sheight !== null && sheight !== void 0 ? sheight : image === null || image === void 0 ? void 0 : image.height) !== null && _d !== void 0 ? _d : 0];\r\n            dest = [dx, dy];\r\n            width = dwidth;\r\n            height = dheight;\r\n        }\r\n        sx = view[0];\r\n        sy = view[1];\r\n        const sw = view[2];\r\n        const sh = view[3];\r\n        // transform based on current context\r\n        const transform = this._context.getTransform();\r\n        const opacity = this._context.opacity;\r\n        const snapToPixel = this._context.snapToPixel;\r\n        let topLeft = vec(dest[0], dest[1]);\r\n        let topRight = vec(dest[0] + width, dest[1]);\r\n        let bottomLeft = vec(dest[0], dest[1] + height);\r\n        let bottomRight = vec(dest[0] + width, dest[1] + height);\r\n        topLeft = transform.multiply(topLeft);\r\n        topRight = transform.multiply(topRight);\r\n        bottomLeft = transform.multiply(bottomLeft);\r\n        bottomRight = transform.multiply(bottomRight);\r\n        if (snapToPixel) {\r\n            topLeft.x = ~~(topLeft.x + pixelSnapEpsilon);\r\n            topLeft.y = ~~(topLeft.y + pixelSnapEpsilon);\r\n            topRight.x = ~~(topRight.x + pixelSnapEpsilon);\r\n            topRight.y = ~~(topRight.y + pixelSnapEpsilon);\r\n            bottomLeft.x = ~~(bottomLeft.x + pixelSnapEpsilon);\r\n            bottomLeft.y = ~~(bottomLeft.y + pixelSnapEpsilon);\r\n            bottomRight.x = ~~(bottomRight.x + pixelSnapEpsilon);\r\n            bottomRight.y = ~~(bottomRight.y + pixelSnapEpsilon);\r\n        }\r\n        const tint = this._context.tint;\r\n        const textureId = this._getTextureIdForImage(image);\r\n        const imageWidth = image.width || width;\r\n        const imageHeight = image.height || height;\r\n        const uvx0 = (sx) / imageWidth;\r\n        const uvy0 = (sy) / imageHeight;\r\n        const uvx1 = (sx + sw - 0.01) / imageWidth;\r\n        const uvy1 = (sy + sh - 0.01) / imageHeight;\r\n        // update data\r\n        const vertexBuffer = this._layout.vertexBuffer.bufferData;\r\n        // (0, 0) - 0\r\n        vertexBuffer[this._vertexIndex++] = topLeft.x;\r\n        vertexBuffer[this._vertexIndex++] = topLeft.y;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = uvx0;\r\n        vertexBuffer[this._vertexIndex++] = uvy0;\r\n        vertexBuffer[this._vertexIndex++] = textureId;\r\n        vertexBuffer[this._vertexIndex++] = tint.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = tint.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = tint.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = tint.a;\r\n        // (0, 1) - 1\r\n        vertexBuffer[this._vertexIndex++] = bottomLeft.x;\r\n        vertexBuffer[this._vertexIndex++] = bottomLeft.y;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = uvx0;\r\n        vertexBuffer[this._vertexIndex++] = uvy1;\r\n        vertexBuffer[this._vertexIndex++] = textureId;\r\n        vertexBuffer[this._vertexIndex++] = tint.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = tint.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = tint.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = tint.a;\r\n        // (1, 0) - 2\r\n        vertexBuffer[this._vertexIndex++] = topRight.x;\r\n        vertexBuffer[this._vertexIndex++] = topRight.y;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = uvx1;\r\n        vertexBuffer[this._vertexIndex++] = uvy0;\r\n        vertexBuffer[this._vertexIndex++] = textureId;\r\n        vertexBuffer[this._vertexIndex++] = tint.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = tint.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = tint.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = tint.a;\r\n        // (1, 1) - 3\r\n        vertexBuffer[this._vertexIndex++] = bottomRight.x;\r\n        vertexBuffer[this._vertexIndex++] = bottomRight.y;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = uvx1;\r\n        vertexBuffer[this._vertexIndex++] = uvy1;\r\n        vertexBuffer[this._vertexIndex++] = textureId;\r\n        vertexBuffer[this._vertexIndex++] = tint.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = tint.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = tint.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = tint.a;\r\n    }\r\n    hasPendingDraws() {\r\n        return this._imageCount !== 0;\r\n    }\r\n    flush() {\r\n        // nothing to draw early exit\r\n        if (this._imageCount === 0) {\r\n            return;\r\n        }\r\n        const gl = this._gl;\r\n        // Bind the shader\r\n        this._shader.use();\r\n        // Bind the memory layout and upload data\r\n        this._layout.use(true, 4 * 10 * this._imageCount);\r\n        // Update ortho matrix uniform\r\n        this._shader.setUniformMatrix('u_matrix', this._context.ortho);\r\n        // Bind textures to\r\n        this._bindTextures(gl);\r\n        // Bind index buffer\r\n        this._quads.bind();\r\n        // Draw all the quads\r\n        gl.drawElements(gl.TRIANGLES, this._imageCount * 6, this._quads.bufferGlType, 0);\r\n        GraphicsDiagnostics.DrawnImagesCount += this._imageCount;\r\n        GraphicsDiagnostics.DrawCallCount++;\r\n        // Reset\r\n        this._imageCount = 0;\r\n        this._vertexIndex = 0;\r\n        this._textures.length = 0;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/rectangle-renderer/rectangle-renderer.frag.glsl\n/* harmony default export */ const rectangle_renderer_frag = (\"#version 300 es\\r\\n\\r\\nprecision mediump float;\\r\\n\\r\\n// UV coord\\r\\nin vec2 v_uv;\\r\\n\\r\\nin vec2 v_size; // in pixels\\r\\n\\r\\n// Color coord to blend with image\\r\\nin lowp vec4 v_color;\\r\\n\\r\\n// Stroke color if used\\r\\nin lowp vec4 v_strokeColor;\\r\\n\\r\\n// Stroke thickness if used\\r\\nin lowp float v_strokeThickness; // in pixels\\r\\n\\r\\n// Opacity\\r\\nin float v_opacity;\\r\\n\\r\\nout vec4 fragColor;\\r\\n\\r\\nvoid main() {\\r\\n    // modified from https://stackoverflow.com/questions/59197671/glsl-rounded-rectangle-with-variable-border\\r\\n    vec2 uv = v_uv;\\r\\n    vec2 fragCoord = uv * v_size;\\r\\n    float maxX = v_size.x - v_strokeThickness;\\r\\n    float minX = v_strokeThickness;\\r\\n    float maxY = v_size.y - v_strokeThickness;\\r\\n    float minY = v_strokeThickness;\\r\\n\\r\\n    if (fragCoord.x < maxX && fragCoord.x > minX &&\\r\\n        fragCoord.y < maxY && fragCoord.y > minY) {\\r\\n      fragColor = v_color;\\r\\n    } else {\\r\\n      fragColor = v_strokeColor;\\r\\n    }\\r\\n    fragColor.a *= v_opacity;\\r\\n    fragColor.rgb *= fragColor.a;\\r\\n\\r\\n    // vec2 v2CenteredPos     = abs(fragCoord - v_size.xy / 2.0);\\r\\n    // vec2 v2HalfShapeSizePx = v_size.xy/2.0 - v_strokeThickness/2.0;\\r\\n\\r\\n    // float fHalfBorderDist      = 0.0;\\r\\n    // float fHalfBorderThickness = 0.0;\\r\\n\\r\\n    // if (fragCoord.x > max(v_radius, v_strokeThickness) && \\r\\n    //     fragCoord.x < v_size.x - max(v_radius, v_strokeThickness))\\r\\n    // {\\r\\n    //     fHalfBorderDist      = v2CenteredPos.y - v2HalfShapeSizePx.y;\\r\\n    //     fHalfBorderThickness = v_strokeThickness / 2.0;\\r\\n    // }\\r\\n    // else if (fragCoord.y > max(v_radius, v_strokeThickness) && \\r\\n    //          fragCoord.y < v_size.y - max(v_radius, v_strokeThickness))\\r\\n    // {\\r\\n    //     fHalfBorderDist      = v2CenteredPos.x - v2HalfShapeSizePx.x;\\r\\n    //     fHalfBorderThickness = v_strokeThickness / 2.0;\\r\\n    // }\\r\\n    // else\\r\\n    // {\\r\\n    //     vec2 edgeVec = max(vec2(0.0), v_radius - vec2(\\r\\n    //         uv.x > 0.5 ? v_size.x - fragCoord.x : fragCoord.x,\\r\\n    //         uv.y > 0.5 ? v_size.y - fragCoord.y : fragCoord.y));\\r\\n        \\r\\n    //     float ellipse_ab    = v_radius-v_strokeThickness;\\r\\n    //     vec2 ellipse_isect = (v_strokeThickness > v_radius || v_strokeThickness > v_radius) ? vec2(0.0) :\\r\\n    //                             edgeVec.xy * ellipse_ab*ellipse_ab / length(ellipse_ab*edgeVec.yx); \\r\\n            \\r\\n    //     fHalfBorderThickness = (v_radius - length(ellipse_isect)) / 2.0;\\r\\n    //     fHalfBorderDist      = length(edgeVec) - (v_radius - fHalfBorderThickness);\\r\\n    // }\\r\\n\\r\\n    // vec4 v4FromColor = v_strokeColor;\\r\\n    // v4FromColor.rgb *= v4FromColor.a;\\r\\n    // vec4 v4ToColor   = vec4(0.0); // background color is transparent\\r\\n    // if (fHalfBorderDist < 0.0) {\\r\\n    //     v4ToColor = v_color;\\r\\n    //     v4ToColor.rgb *= v4ToColor.a;\\r\\n    // }\\r\\n\\r\\n    // float mixPct = abs(fHalfBorderDist) - fHalfBorderThickness;\\r\\n\\r\\n    // vec4 finalColor = mix(v4FromColor, v4ToColor, mixPct);\\r\\n    // gl_FragColor = finalColor;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/rectangle-renderer/rectangle-renderer.vert.glsl\n/* harmony default export */ const rectangle_renderer_vert = (\"#version 300 es\\r\\nin vec2 a_position;\\r\\n\\r\\n// UV coordinate\\r\\nin vec2 a_uv;\\r\\nout vec2 v_uv;\\r\\n\\r\\nin vec2 a_size;\\r\\nout vec2 v_size;\\r\\n\\r\\n// Opacity \\r\\nin float a_opacity;\\r\\nout float v_opacity;\\r\\n\\r\\nin vec4 a_color;\\r\\nout vec4 v_color;\\r\\n\\r\\nin vec4 a_strokeColor;\\r\\nout vec4 v_strokeColor;\\r\\n\\r\\nin float a_strokeThickness;\\r\\nout float v_strokeThickness;\\r\\n\\r\\nuniform mat4 u_matrix;\\r\\n\\r\\n\\r\\nvoid main() {\\r\\n   // Set the vertex position using the ortho transform matrix\\r\\n   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\\r\\n\\r\\n   // Pass through UV coords\\r\\n   v_uv = a_uv;\\r\\n   // Pass through size\\r\\n   v_size = a_size;\\r\\n   // Pass through the Opacity to the fragment shader\\r\\n   v_opacity = a_opacity;\\r\\n   // Pass through the color to the fragment shader\\r\\n   v_color = a_color;\\r\\n   // Pass through the stroke color to the fragment shader\\r\\n   v_strokeColor = a_strokeColor;\\r\\n   // Pass through the stroke thickenss to the fragment shader\\r\\n   v_strokeThickness = a_strokeThickness;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/rectangle-renderer/rectangle-renderer.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass RectangleRenderer {\r\n    constructor() {\r\n        this.type = 'ex.rectangle';\r\n        this.priority = 0;\r\n        this._maxRectangles = 10922; // max(uint16) / 6 verts\r\n        this._rectangleCount = 0;\r\n        this._vertexIndex = 0;\r\n    }\r\n    initialize(gl, context) {\r\n        this._gl = gl;\r\n        this._context = context;\r\n        // https://stackoverflow.com/questions/59197671/glsl-rounded-rectangle-with-variable-border\r\n        this._shader = new Shader({\r\n            fragmentSource: rectangle_renderer_frag,\r\n            vertexSource: rectangle_renderer_vert\r\n        });\r\n        this._shader.compile();\r\n        // setup uniforms\r\n        this._shader.use();\r\n        this._shader.setUniformMatrix('u_matrix', context.ortho);\r\n        this._buffer = new VertexBuffer({\r\n            size: 16 * 4 * this._maxRectangles,\r\n            type: 'dynamic'\r\n        });\r\n        this._layout = new VertexLayout({\r\n            shader: this._shader,\r\n            vertexBuffer: this._buffer,\r\n            attributes: [\r\n                ['a_position', 2],\r\n                ['a_uv', 2],\r\n                ['a_size', 2],\r\n                ['a_opacity', 1],\r\n                ['a_color', 4],\r\n                ['a_strokeColor', 4],\r\n                ['a_strokeThickness', 1]\r\n            ]\r\n        });\r\n        this._quads = new QuadIndexBuffer(this._maxRectangles, true);\r\n    }\r\n    _isFull() {\r\n        if (this._rectangleCount >= this._maxRectangles) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    draw(...args) {\r\n        if (args[0] instanceof Vector && args[1] instanceof Vector) {\r\n            this.drawLine.apply(this, args);\r\n        }\r\n        else {\r\n            this.drawRectangle.apply(this, args);\r\n        }\r\n    }\r\n    drawLine(start, end, color, thickness = 1) {\r\n        if (this._isFull()) {\r\n            this.flush();\r\n        }\r\n        this._rectangleCount++;\r\n        // transform based on current context\r\n        const transform = this._context.getTransform();\r\n        const opacity = this._context.opacity;\r\n        const snapToPixel = this._context.snapToPixel;\r\n        const dir = end.sub(start);\r\n        const length = dir.size;\r\n        const normal = dir.normalize().perpendicular();\r\n        const halfThick = thickness / 2;\r\n        /**\r\n         *    +---------------------^----------------------+\r\n         *    |                     | (normal)             |\r\n         *   (startx, starty)------------------>(endx, endy)\r\n         *    |                                            |\r\n         *    + -------------------------------------------+\r\n         */\r\n        const startTop = transform.multiply(normal.scale(halfThick).add(start));\r\n        const startBottom = transform.multiply(normal.scale(-halfThick).add(start));\r\n        const endTop = transform.multiply(normal.scale(halfThick).add(end));\r\n        const endBottom = transform.multiply(normal.scale(-halfThick).add(end));\r\n        if (snapToPixel) {\r\n            startTop.x = ~~(startTop.x + pixelSnapEpsilon);\r\n            startTop.y = ~~(startTop.y + pixelSnapEpsilon);\r\n            endTop.x = ~~(endTop.x + pixelSnapEpsilon);\r\n            endTop.y = ~~(endTop.y + pixelSnapEpsilon);\r\n            startBottom.x = ~~(startBottom.x + pixelSnapEpsilon);\r\n            startBottom.y = ~~(startBottom.y + pixelSnapEpsilon);\r\n            endBottom.x = ~~(endBottom.x + pixelSnapEpsilon);\r\n            endBottom.y = ~~(endBottom.y + pixelSnapEpsilon);\r\n        }\r\n        // TODO uv could be static vertex buffer\r\n        const uvx0 = 0;\r\n        const uvy0 = 0;\r\n        const uvx1 = 1;\r\n        const uvy1 = 1;\r\n        const stroke = Color.Transparent;\r\n        const strokeThickness = 0;\r\n        const width = 1;\r\n        // update data\r\n        const vertexBuffer = this._layout.vertexBuffer.bufferData;\r\n        // (0, 0) - 0\r\n        vertexBuffer[this._vertexIndex++] = startTop.x;\r\n        vertexBuffer[this._vertexIndex++] = startTop.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx0;\r\n        vertexBuffer[this._vertexIndex++] = uvy0;\r\n        vertexBuffer[this._vertexIndex++] = length;\r\n        vertexBuffer[this._vertexIndex++] = thickness;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness / width;\r\n        // (0, 1) - 1\r\n        vertexBuffer[this._vertexIndex++] = startBottom.x;\r\n        vertexBuffer[this._vertexIndex++] = startBottom.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx0;\r\n        vertexBuffer[this._vertexIndex++] = uvy1;\r\n        vertexBuffer[this._vertexIndex++] = length;\r\n        vertexBuffer[this._vertexIndex++] = thickness;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness / width;\r\n        // (1, 0) - 2\r\n        vertexBuffer[this._vertexIndex++] = endTop.x;\r\n        vertexBuffer[this._vertexIndex++] = endTop.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx1;\r\n        vertexBuffer[this._vertexIndex++] = uvy0;\r\n        vertexBuffer[this._vertexIndex++] = length;\r\n        vertexBuffer[this._vertexIndex++] = thickness;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness / width;\r\n        // (1, 1) - 3\r\n        vertexBuffer[this._vertexIndex++] = endBottom.x;\r\n        vertexBuffer[this._vertexIndex++] = endBottom.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx1;\r\n        vertexBuffer[this._vertexIndex++] = uvy1;\r\n        vertexBuffer[this._vertexIndex++] = length;\r\n        vertexBuffer[this._vertexIndex++] = thickness;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness / width;\r\n    }\r\n    drawRectangle(pos, width, height, color, stroke = Color.Transparent, strokeThickness = 0) {\r\n        if (this._isFull()) {\r\n            this.flush();\r\n        }\r\n        this._rectangleCount++;\r\n        // transform based on current context\r\n        const transform = this._context.getTransform();\r\n        const opacity = this._context.opacity;\r\n        const snapToPixel = this._context.snapToPixel;\r\n        const topLeft = transform.multiply(pos.add(vec(0, 0)));\r\n        const topRight = transform.multiply(pos.add(vec(width, 0)));\r\n        const bottomRight = transform.multiply(pos.add(vec(width, height)));\r\n        const bottomLeft = transform.multiply(pos.add(vec(0, height)));\r\n        if (snapToPixel) {\r\n            topLeft.x = ~~(topLeft.x + pixelSnapEpsilon);\r\n            topLeft.y = ~~(topLeft.y + pixelSnapEpsilon);\r\n            topRight.x = ~~(topRight.x + pixelSnapEpsilon);\r\n            topRight.y = ~~(topRight.y + pixelSnapEpsilon);\r\n            bottomLeft.x = ~~(bottomLeft.x + pixelSnapEpsilon);\r\n            bottomLeft.y = ~~(bottomLeft.y + pixelSnapEpsilon);\r\n            bottomRight.x = ~~(bottomRight.x + pixelSnapEpsilon);\r\n            bottomRight.y = ~~(bottomRight.y + pixelSnapEpsilon);\r\n        }\r\n        // TODO uv could be static vertex buffer\r\n        const uvx0 = 0;\r\n        const uvy0 = 0;\r\n        const uvx1 = 1;\r\n        const uvy1 = 1;\r\n        // update data\r\n        const vertexBuffer = this._layout.vertexBuffer.bufferData;\r\n        // (0, 0) - 0\r\n        vertexBuffer[this._vertexIndex++] = topLeft.x;\r\n        vertexBuffer[this._vertexIndex++] = topLeft.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx0;\r\n        vertexBuffer[this._vertexIndex++] = uvy0;\r\n        vertexBuffer[this._vertexIndex++] = width;\r\n        vertexBuffer[this._vertexIndex++] = height;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness;\r\n        // (0, 1) - 1\r\n        vertexBuffer[this._vertexIndex++] = bottomLeft.x;\r\n        vertexBuffer[this._vertexIndex++] = bottomLeft.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx0;\r\n        vertexBuffer[this._vertexIndex++] = uvy1;\r\n        vertexBuffer[this._vertexIndex++] = width;\r\n        vertexBuffer[this._vertexIndex++] = height;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness;\r\n        // (1, 0) - 2\r\n        vertexBuffer[this._vertexIndex++] = topRight.x;\r\n        vertexBuffer[this._vertexIndex++] = topRight.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx1;\r\n        vertexBuffer[this._vertexIndex++] = uvy0;\r\n        vertexBuffer[this._vertexIndex++] = width;\r\n        vertexBuffer[this._vertexIndex++] = height;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness;\r\n        // (1, 1) - 3\r\n        vertexBuffer[this._vertexIndex++] = bottomRight.x;\r\n        vertexBuffer[this._vertexIndex++] = bottomRight.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx1;\r\n        vertexBuffer[this._vertexIndex++] = uvy1;\r\n        vertexBuffer[this._vertexIndex++] = width;\r\n        vertexBuffer[this._vertexIndex++] = height;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness;\r\n    }\r\n    hasPendingDraws() {\r\n        return this._rectangleCount !== 0;\r\n    }\r\n    flush() {\r\n        // nothing to draw early exit\r\n        if (this._rectangleCount === 0) {\r\n            return;\r\n        }\r\n        const gl = this._gl;\r\n        // Bind the shader\r\n        this._shader.use();\r\n        // Bind the memory layout and upload data\r\n        this._layout.use(true);\r\n        // Update ortho matrix uniform\r\n        this._shader.setUniformMatrix('u_matrix', this._context.ortho);\r\n        // Bind index buffer\r\n        this._quads.bind();\r\n        // Draw all the quads\r\n        gl.drawElements(gl.TRIANGLES, this._rectangleCount * 6, this._quads.bufferGlType, 0);\r\n        GraphicsDiagnostics.DrawnImagesCount += this._rectangleCount;\r\n        GraphicsDiagnostics.DrawCallCount++;\r\n        // Reset\r\n        this._rectangleCount = 0;\r\n        this._vertexIndex = 0;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/circle-renderer/circle-renderer.frag.glsl\n/* harmony default export */ const circle_renderer_frag = (\"#version 300 es\\r\\nprecision highp float;\\r\\n\\r\\n// UV coord\\r\\nin vec2 v_uv;\\r\\n\\r\\n// Color coord to blend with image\\r\\nin lowp vec4 v_color;\\r\\n\\r\\n// Stroke color if used\\r\\nin lowp vec4 v_strokeColor;\\r\\n\\r\\n// Stroke thickness if used\\r\\nin lowp float v_strokeThickness;\\r\\n\\r\\n// Opacity\\r\\nin float v_opacity;\\r\\n\\r\\nout vec4 fragColor;\\r\\n\\r\\nvoid main() {\\r\\n  // make (0, 0) the center the uv \\r\\n  vec2 uv = v_uv * 2.0 - 1.0;\\r\\n\\r\\n  vec4 color = v_color;\\r\\n  vec4 strokeColor = v_strokeColor;\\r\\n\\r\\n  // circle border is at radius 1.0 \\r\\n  // dist is > 0 when inside the circle \\r\\n  float d = length(uv);\\r\\n  float dist = 1.0 - length(uv);\\r\\n\\r\\n  // Fade based on fwidth\\r\\n  float fade = fwidth(dot(uv, uv));\\r\\n\\r\\n  // if dist is greater than 0 step to 1;\\r\\n  // when we cross this 0 threshold add a smooth fade\\r\\n  float fill = smoothstep(-fade/2.0, fade/2.0, dist);\\r\\n\\r\\n  // if dist is greater than the stroke thickness step to 1\\r\\n  float stroke = 1.0 - smoothstep(v_strokeThickness, v_strokeThickness + fade, dist);\\r\\n\\r\\n  strokeColor.a *= fill * stroke;\\r\\n  strokeColor.rgb *= strokeColor.a;\\r\\n\\r\\n  color.a *= fill * (1.0 - stroke);\\r\\n  color.rgb *= color.a;\\r\\n\\r\\n  vec4 finalColor = mix(vec4(0.0), (color + strokeColor), fill);\\r\\n  finalColor.rgb = finalColor.rgb * v_opacity;\\r\\n  finalColor.a = finalColor.a * v_opacity;\\r\\n  fragColor = finalColor;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/circle-renderer/circle-renderer.vert.glsl\n/* harmony default export */ const circle_renderer_vert = (\"#version 300 es\\r\\nin vec2 a_position;\\r\\n\\r\\n// UV coordinate\\r\\nin vec2 a_uv;\\r\\nout vec2 v_uv;\\r\\n\\r\\n// Opacity \\r\\nin float a_opacity;\\r\\nout float v_opacity;\\r\\n\\r\\nin vec4 a_color;\\r\\nout vec4 v_color;\\r\\n\\r\\nin vec4 a_strokeColor;\\r\\nout vec4 v_strokeColor;\\r\\n\\r\\nin float a_strokeThickness;\\r\\nout float v_strokeThickness;\\r\\n\\r\\nuniform mat4 u_matrix;\\r\\n\\r\\n\\r\\nvoid main() {\\r\\n   // Set the vertex position using the ortho transform matrix\\r\\n   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\\r\\n\\r\\n   // Pass through UV coords\\r\\n   v_uv = a_uv;\\r\\n   // Pass through the Opacity to the fragment shader\\r\\n   v_opacity = a_opacity;\\r\\n   // Pass through the color to the fragment shader\\r\\n   v_color = a_color;\\r\\n   // Pass through the stroke color to the fragment shader\\r\\n   v_strokeColor = a_strokeColor;\\r\\n   // Pass through the stroke thickenss to the fragment shader\\r\\n   v_strokeThickness = a_strokeThickness;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/circle-renderer/circle-renderer.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass CircleRenderer {\r\n    constructor() {\r\n        this.type = 'ex.circle';\r\n        this.priority = 0;\r\n        this._maxCircles = 10922; // max(uint16) / 6 verts\r\n        this._circleCount = 0;\r\n        this._vertexIndex = 0;\r\n    }\r\n    initialize(gl, context) {\r\n        this._gl = gl;\r\n        this._context = context;\r\n        this._shader = new Shader({\r\n            fragmentSource: circle_renderer_frag,\r\n            vertexSource: circle_renderer_vert\r\n        });\r\n        this._shader.compile();\r\n        // setup uniforms\r\n        this._shader.use();\r\n        this._shader.setUniformMatrix('u_matrix', context.ortho);\r\n        this._buffer = new VertexBuffer({\r\n            size: 14 * 4 * this._maxCircles,\r\n            type: 'dynamic'\r\n        });\r\n        this._layout = new VertexLayout({\r\n            shader: this._shader,\r\n            vertexBuffer: this._buffer,\r\n            attributes: [\r\n                ['a_position', 2],\r\n                ['a_uv', 2],\r\n                ['a_opacity', 1],\r\n                ['a_color', 4],\r\n                ['a_strokeColor', 4],\r\n                ['a_strokeThickness', 1]\r\n            ]\r\n        });\r\n        this._quads = new QuadIndexBuffer(this._maxCircles, true);\r\n    }\r\n    _isFull() {\r\n        if (this._circleCount >= this._maxCircles) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    draw(pos, radius, color, stroke = Color.Transparent, strokeThickness = 0) {\r\n        if (this._isFull()) {\r\n            this.flush();\r\n        }\r\n        this._circleCount++;\r\n        // transform based on current context\r\n        const transform = this._context.getTransform();\r\n        const opacity = this._context.opacity;\r\n        const snapToPixel = this._context.snapToPixel;\r\n        const topLeft = transform.multiply(pos.add(vec(-radius, -radius)));\r\n        const topRight = transform.multiply(pos.add(vec(radius, -radius)));\r\n        const bottomRight = transform.multiply(pos.add(vec(radius, radius)));\r\n        const bottomLeft = transform.multiply(pos.add(vec(-radius, radius)));\r\n        if (snapToPixel) {\r\n            topLeft.x = ~~(topLeft.x + pixelSnapEpsilon);\r\n            topLeft.y = ~~(topLeft.y + pixelSnapEpsilon);\r\n            topRight.x = ~~(topRight.x + pixelSnapEpsilon);\r\n            topRight.y = ~~(topRight.y + pixelSnapEpsilon);\r\n            bottomLeft.x = ~~(bottomLeft.x + pixelSnapEpsilon);\r\n            bottomLeft.y = ~~(bottomLeft.y + pixelSnapEpsilon);\r\n            bottomRight.x = ~~(bottomRight.x + pixelSnapEpsilon);\r\n            bottomRight.y = ~~(bottomRight.y + pixelSnapEpsilon);\r\n        }\r\n        // TODO UV could be static vertex buffer\r\n        const uvx0 = 0;\r\n        const uvy0 = 0;\r\n        const uvx1 = 1;\r\n        const uvy1 = 1;\r\n        // update data\r\n        const vertexBuffer = this._layout.vertexBuffer.bufferData;\r\n        // (0, 0) - 0\r\n        vertexBuffer[this._vertexIndex++] = topLeft.x;\r\n        vertexBuffer[this._vertexIndex++] = topLeft.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx0;\r\n        vertexBuffer[this._vertexIndex++] = uvy0;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness / radius;\r\n        // (0, 1) - 1\r\n        vertexBuffer[this._vertexIndex++] = bottomLeft.x;\r\n        vertexBuffer[this._vertexIndex++] = bottomLeft.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx0;\r\n        vertexBuffer[this._vertexIndex++] = uvy1;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness / radius;\r\n        // (1, 0) - 2\r\n        vertexBuffer[this._vertexIndex++] = topRight.x;\r\n        vertexBuffer[this._vertexIndex++] = topRight.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx1;\r\n        vertexBuffer[this._vertexIndex++] = uvy0;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness / radius;\r\n        // (1, 1) - 3\r\n        vertexBuffer[this._vertexIndex++] = bottomRight.x;\r\n        vertexBuffer[this._vertexIndex++] = bottomRight.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx1;\r\n        vertexBuffer[this._vertexIndex++] = uvy1;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness / radius;\r\n    }\r\n    hasPendingDraws() {\r\n        return this._circleCount !== 0;\r\n    }\r\n    flush() {\r\n        // nothing to draw early exit\r\n        if (this._circleCount === 0) {\r\n            return;\r\n        }\r\n        const gl = this._gl;\r\n        // Bind the shader\r\n        this._shader.use();\r\n        // Bind the memory layout and upload data\r\n        this._layout.use(true);\r\n        // Update ortho matrix uniform\r\n        this._shader.setUniformMatrix('u_matrix', this._context.ortho);\r\n        // Bind index buffer\r\n        this._quads.bind();\r\n        // Draw all the quads\r\n        gl.drawElements(gl.TRIANGLES, this._circleCount * 6, this._quads.bufferGlType, 0);\r\n        GraphicsDiagnostics.DrawnImagesCount += this._circleCount;\r\n        GraphicsDiagnostics.DrawCallCount++;\r\n        // Reset\r\n        this._circleCount = 0;\r\n        this._vertexIndex = 0;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Pool.ts\n\r\nclass Pool {\r\n    constructor(builder, recycler, maxObjects = 100) {\r\n        this.builder = builder;\r\n        this.recycler = recycler;\r\n        this.maxObjects = maxObjects;\r\n        this.totalAllocations = 0;\r\n        this.index = 0;\r\n        this.objects = [];\r\n        this.disableWarnings = false;\r\n        this._logger = Logger.getInstance();\r\n    }\r\n    preallocate() {\r\n        for (let i = 0; i < this.maxObjects; i++) {\r\n            this.objects[i] = this.builder();\r\n        }\r\n    }\r\n    /**\r\n     * Use many instances out of the in the context and return all to the pool.\r\n     *\r\n     * By returning values out of the context they will be un-hooked from the pool and are free to be passed to consumers\r\n     * @param context\r\n     */\r\n    using(context) {\r\n        const result = context(this);\r\n        if (result) {\r\n            return this.done(...result);\r\n        }\r\n        return this.done();\r\n    }\r\n    /**\r\n     * Use a single instance out of th pool and immediately return it to the pool\r\n     * @param context\r\n     */\r\n    borrow(context) {\r\n        const object = this.get();\r\n        context(object);\r\n        this.index--;\r\n    }\r\n    /**\r\n     * Retrieve a value from the pool, will allocate a new instance if necessary or recycle from the pool\r\n     * @param args\r\n     */\r\n    get(...args) {\r\n        if (this.index === this.maxObjects) {\r\n            if (!this.disableWarnings) {\r\n                this._logger.warn('Max pooled objects reached, possible memory leak? Doubling');\r\n            }\r\n            this.maxObjects = this.maxObjects * 2;\r\n        }\r\n        if (this.objects[this.index]) {\r\n            // Pool has an available object already constructed\r\n            return this.recycler(this.objects[this.index++], ...args);\r\n        }\r\n        else {\r\n            // New allocation\r\n            this.totalAllocations++;\r\n            const object = (this.objects[this.index++] = this.builder(...args));\r\n            return object;\r\n        }\r\n    }\r\n    done(...objects) {\r\n        // All objects in pool now considered \"free\"\r\n        this.index = 0;\r\n        for (const object of objects) {\r\n            const poolIndex = this.objects.indexOf(object);\r\n            // Build a new object to take the pool place\r\n            this.objects[poolIndex] = this.builder(); // TODO problematic 0-arg only support\r\n            this.totalAllocations++;\r\n        }\r\n        return objects;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/draw-call.ts\n\r\n\r\nclass DrawCall {\r\n    constructor() {\r\n        this.z = 0;\r\n        this.priority = 0;\r\n        this.transform = AffineMatrix.identity();\r\n        this.state = {\r\n            z: 0,\r\n            opacity: 1,\r\n            tint: Color.White\r\n        };\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/ExcaliburGraphicsContextWebGL.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// renderers\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst pixelSnapEpsilon = 0.0001;\r\nclass ExcaliburGraphicsContextWebGLDebug {\r\n    constructor(_webglCtx) {\r\n        this._webglCtx = _webglCtx;\r\n        this._debugText = new DebugText();\r\n    }\r\n    /**\r\n     * Draw a debugging rectangle to the context\r\n     * @param x\r\n     * @param y\r\n     * @param width\r\n     * @param height\r\n     */\r\n    drawRect(x, y, width, height, rectOptions = { color: Color.Black }) {\r\n        this.drawLine(vec(x, y), vec(x + width, y), { ...rectOptions });\r\n        this.drawLine(vec(x + width, y), vec(x + width, y + height), { ...rectOptions });\r\n        this.drawLine(vec(x + width, y + height), vec(x, y + height), { ...rectOptions });\r\n        this.drawLine(vec(x, y + height), vec(x, y), { ...rectOptions });\r\n    }\r\n    /**\r\n     * Draw a debugging line to the context\r\n     * @param start\r\n     * @param end\r\n     * @param lineOptions\r\n     */\r\n    drawLine(start, end, lineOptions = { color: Color.Black }) {\r\n        this._webglCtx.draw('ex.line', start, end, lineOptions.color);\r\n    }\r\n    /**\r\n     * Draw a debugging point to the context\r\n     * @param point\r\n     * @param pointOptions\r\n     */\r\n    drawPoint(point, pointOptions = { color: Color.Black, size: 5 }) {\r\n        this._webglCtx.draw('ex.point', point, pointOptions.color, pointOptions.size);\r\n    }\r\n    drawText(text, pos) {\r\n        this._debugText.write(this._webglCtx, text, pos);\r\n    }\r\n}\r\nclass ExcaliburGraphicsContextWebGL {\r\n    constructor(options) {\r\n        this._logger = Logger.getInstance();\r\n        this._renderers = new Map();\r\n        this._isDrawLifecycle = false;\r\n        this.useDrawSorting = true;\r\n        this._drawCallPool = new Pool(() => new DrawCall(), (instance) => {\r\n            instance.priority = 0;\r\n            instance.z = 0;\r\n            instance.renderer = undefined;\r\n            instance.args = undefined;\r\n            return instance;\r\n        }, 4000);\r\n        this._drawCalls = [];\r\n        // Postprocessing is a tuple with 2 render targets, these are flip-flopped during the postprocessing process\r\n        this._postProcessTargets = [];\r\n        this._postprocessors = [];\r\n        this._transform = new TransformStack();\r\n        this._state = new StateStack();\r\n        this.snapToPixel = false;\r\n        this.smoothing = false;\r\n        this.backgroundColor = Color.ExcaliburBlue;\r\n        this._alreadyWarnedDrawLifecycle = false;\r\n        this.debug = new ExcaliburGraphicsContextWebGLDebug(this);\r\n        const { canvasElement, enableTransparency, smoothing, snapToPixel, backgroundColor, useDrawSorting } = options;\r\n        this.__gl = canvasElement.getContext('webgl2', {\r\n            antialias: smoothing !== null && smoothing !== void 0 ? smoothing : this.smoothing,\r\n            premultipliedAlpha: false,\r\n            alpha: enableTransparency !== null && enableTransparency !== void 0 ? enableTransparency : true,\r\n            depth: true,\r\n            powerPreference: 'high-performance'\r\n            // TODO Chromium fixed the bug where this didn't work now it breaks CI :(\r\n            // failIfMajorPerformanceCaveat: true\r\n        });\r\n        if (!this.__gl) {\r\n            throw Error('Failed to retrieve webgl context from browser');\r\n        }\r\n        ExcaliburWebGLContextAccessor.register(this.__gl);\r\n        TextureLoader.register(this.__gl);\r\n        this.snapToPixel = snapToPixel !== null && snapToPixel !== void 0 ? snapToPixel : this.snapToPixel;\r\n        this.smoothing = smoothing !== null && smoothing !== void 0 ? smoothing : this.smoothing;\r\n        this.backgroundColor = backgroundColor !== null && backgroundColor !== void 0 ? backgroundColor : this.backgroundColor;\r\n        this.useDrawSorting = useDrawSorting !== null && useDrawSorting !== void 0 ? useDrawSorting : this.useDrawSorting;\r\n        this._drawCallPool.disableWarnings = true;\r\n        this._drawCallPool.preallocate();\r\n        this._init();\r\n    }\r\n    get z() {\r\n        return this._state.current.z;\r\n    }\r\n    set z(value) {\r\n        this._state.current.z = value;\r\n    }\r\n    get opacity() {\r\n        return this._state.current.opacity;\r\n    }\r\n    set opacity(value) {\r\n        this._state.current.opacity = value;\r\n    }\r\n    get tint() {\r\n        return this._state.current.tint;\r\n    }\r\n    set tint(color) {\r\n        this._state.current.tint = color;\r\n    }\r\n    get width() {\r\n        return this.__gl.canvas.width;\r\n    }\r\n    get height() {\r\n        return this.__gl.canvas.height;\r\n    }\r\n    get ortho() {\r\n        return this._ortho;\r\n    }\r\n    /**\r\n     * Checks the underlying webgl implementation if the requested internal resolution is supported\r\n     * @param dim\r\n     */\r\n    checkIfResolutionSupported(dim) {\r\n        // Slight hack based on this thread https://groups.google.com/g/webgl-dev-list/c/AHONvz3oQTo\r\n        let supported = true;\r\n        if (dim.width > 4096 || dim.height > 4096) {\r\n            supported = false;\r\n        }\r\n        return supported;\r\n    }\r\n    _init() {\r\n        const gl = this.__gl;\r\n        // Setup viewport and view matrix\r\n        this._ortho = Matrix.ortho(0, gl.canvas.width, gl.canvas.height, 0, 400, -400);\r\n        gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);\r\n        // Clear background\r\n        gl.clearColor(this.backgroundColor.r / 255, this.backgroundColor.g / 255, this.backgroundColor.b / 255, this.backgroundColor.a);\r\n        gl.clear(gl.COLOR_BUFFER_BIT);\r\n        // Enable alpha blending\r\n        // https://www.realtimerendering.com/blog/gpus-prefer-premultiplication/\r\n        gl.enable(gl.BLEND);\r\n        gl.blendEquation(gl.FUNC_ADD);\r\n        gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\r\n        gl.blendEquationSeparate(gl.FUNC_ADD, gl.FUNC_ADD);\r\n        gl.blendFuncSeparate(gl.ONE, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\r\n        // Setup builtin renderers\r\n        this.register(new ImageRenderer());\r\n        this.register(new RectangleRenderer());\r\n        this.register(new CircleRenderer());\r\n        this.register(new PointRenderer());\r\n        this.register(new LineRenderer());\r\n        this._screenRenderer = new ScreenPassPainter(gl);\r\n        this._renderTarget = new RenderTarget({\r\n            gl,\r\n            width: gl.canvas.width,\r\n            height: gl.canvas.height\r\n        });\r\n        this._postProcessTargets = [\r\n            new RenderTarget({\r\n                gl,\r\n                width: gl.canvas.width,\r\n                height: gl.canvas.height\r\n            }),\r\n            new RenderTarget({\r\n                gl,\r\n                width: gl.canvas.width,\r\n                height: gl.canvas.height\r\n            })\r\n        ];\r\n    }\r\n    register(renderer) {\r\n        this._renderers.set(renderer.type, renderer);\r\n        renderer.initialize(this.__gl, this);\r\n    }\r\n    get(rendererName) {\r\n        return this._renderers.get(rendererName);\r\n    }\r\n    _isCurrentRenderer(renderer) {\r\n        if (!this._currentRenderer || this._currentRenderer === renderer) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    beginDrawLifecycle() {\r\n        this._isDrawLifecycle = true;\r\n    }\r\n    endDrawLifecycle() {\r\n        this._isDrawLifecycle = false;\r\n    }\r\n    draw(rendererName, ...args) {\r\n        if (!this._isDrawLifecycle && !this._alreadyWarnedDrawLifecycle) {\r\n            this._logger.warn(`Attempting to draw outside the the drawing lifecycle (preDraw/postDraw) is not supported and is a source of bugs/errors.\\n` +\r\n                `If you want to do custom drawing, use Actor.graphics, or any onPreDraw or onPostDraw handler.`);\r\n            this._alreadyWarnedDrawLifecycle = true;\r\n        }\r\n        const renderer = this._renderers.get(rendererName);\r\n        if (renderer) {\r\n            if (this.useDrawSorting) {\r\n                const drawCall = this._drawCallPool.get();\r\n                drawCall.z = this._state.current.z;\r\n                drawCall.priority = renderer.priority;\r\n                drawCall.renderer = rendererName;\r\n                this.getTransform().clone(drawCall.transform);\r\n                drawCall.state.z = this._state.current.z;\r\n                drawCall.state.opacity = this._state.current.opacity;\r\n                drawCall.state.tint = this._state.current.tint;\r\n                drawCall.args = args;\r\n                this._drawCalls.push(drawCall);\r\n            }\r\n            else {\r\n                // Set the current renderer if not defined\r\n                if (!this._currentRenderer) {\r\n                    this._currentRenderer = renderer;\r\n                }\r\n                if (!this._isCurrentRenderer(renderer)) {\r\n                    // switching graphics means we must flush the previous\r\n                    this._currentRenderer.flush();\r\n                }\r\n                // If we are still using the same renderer we can add to the current batch\r\n                renderer.draw(...args);\r\n                this._currentRenderer = renderer;\r\n            }\r\n        }\r\n        else {\r\n            throw Error(`No renderer with name ${rendererName} has been registered`);\r\n        }\r\n    }\r\n    resetTransform() {\r\n        this._transform.current = AffineMatrix.identity();\r\n    }\r\n    updateViewport(resolution) {\r\n        const gl = this.__gl;\r\n        this._ortho = this._ortho = Matrix.ortho(0, resolution.width, resolution.height, 0, 400, -400);\r\n        this._renderTarget.setResolution(gl.canvas.width, gl.canvas.height);\r\n        this._postProcessTargets[0].setResolution(gl.canvas.width, gl.canvas.height);\r\n        this._postProcessTargets[1].setResolution(gl.canvas.width, gl.canvas.height);\r\n    }\r\n    drawImage(image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight) {\r\n        if (swidth === 0 || sheight === 0) {\r\n            return; // zero dimension dest exit early\r\n        }\r\n        else if (dwidth === 0 || dheight === 0) {\r\n            return; // zero dimension dest exit early\r\n        }\r\n        else if (image.width === 0 || image.height === 0) {\r\n            return; // zero dimension source exit early\r\n        }\r\n        if (!image) {\r\n            Logger.getInstance().warn('Cannot draw a null or undefined image');\r\n            // tslint:disable-next-line: no-console\r\n            if (console.trace) {\r\n                // tslint:disable-next-line: no-console\r\n                console.trace();\r\n            }\r\n            return;\r\n        }\r\n        this.draw('ex.image', image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight);\r\n    }\r\n    drawLine(start, end, color, thickness = 1) {\r\n        this.draw('ex.rectangle', start, end, color, thickness);\r\n    }\r\n    drawRectangle(pos, width, height, color, stroke, strokeThickness) {\r\n        this.draw('ex.rectangle', pos, width, height, color, stroke, strokeThickness);\r\n    }\r\n    drawCircle(pos, radius, color, stroke, thickness) {\r\n        this.draw('ex.circle', pos, radius, color, stroke, thickness);\r\n    }\r\n    save() {\r\n        this._transform.save();\r\n        this._state.save();\r\n    }\r\n    restore() {\r\n        this._transform.restore();\r\n        this._state.restore();\r\n    }\r\n    translate(x, y) {\r\n        this._transform.translate(this.snapToPixel ? ~~(x + pixelSnapEpsilon) : x, this.snapToPixel ? ~~(y + pixelSnapEpsilon) : y);\r\n    }\r\n    rotate(angle) {\r\n        this._transform.rotate(angle);\r\n    }\r\n    scale(x, y) {\r\n        this._transform.scale(x, y);\r\n    }\r\n    transform(matrix) {\r\n        this._transform.current = matrix;\r\n    }\r\n    getTransform() {\r\n        return this._transform.current;\r\n    }\r\n    multiply(m) {\r\n        this._transform.current.multiply(m, this._transform.current);\r\n    }\r\n    addPostProcessor(postprocessor) {\r\n        this._postprocessors.push(postprocessor);\r\n        postprocessor.initialize(this.__gl);\r\n    }\r\n    removePostProcessor(postprocessor) {\r\n        const index = this._postprocessors.indexOf(postprocessor);\r\n        if (index !== -1) {\r\n            this._postprocessors.splice(index, 1);\r\n        }\r\n    }\r\n    clearPostProcessors() {\r\n        this._postprocessors.length = 0;\r\n    }\r\n    clear() {\r\n        const gl = this.__gl;\r\n        this._renderTarget.use();\r\n        gl.clearColor(this.backgroundColor.r / 255, this.backgroundColor.g / 255, this.backgroundColor.b / 255, this.backgroundColor.a);\r\n        // Clear the context with the newly set color. This is\r\n        // the function call that actually does the drawing.\r\n        gl.clear(gl.COLOR_BUFFER_BIT);\r\n    }\r\n    /**\r\n     * Flushes all batched rendering to the screen\r\n     */\r\n    flush() {\r\n        const gl = this.__gl;\r\n        // render target captures all draws and redirects to the render target\r\n        this._renderTarget.use();\r\n        if (this.useDrawSorting) {\r\n            // sort draw calls\r\n            // Find the original order of the first instance of the draw call\r\n            const originalSort = new Map();\r\n            for (const [name] of this._renderers) {\r\n                const firstIndex = this._drawCalls.findIndex(dc => dc.renderer === name);\r\n                originalSort.set(name, firstIndex);\r\n            }\r\n            this._drawCalls.sort((a, b) => {\r\n                const zIndex = a.z - b.z;\r\n                const originalSortOrder = originalSort.get(a.renderer) - originalSort.get(b.renderer);\r\n                const priority = a.priority - b.priority;\r\n                if (zIndex === 0) { // sort by z first\r\n                    if (priority === 0) { // sort by priority\r\n                        return originalSortOrder; // use the original order to inform draw call packing to maximally preserve painter order\r\n                    }\r\n                    return priority;\r\n                }\r\n                return zIndex;\r\n            });\r\n            const oldTransform = this._transform.current;\r\n            const oldState = this._state.current;\r\n            if (this._drawCalls.length) {\r\n                let currentRendererName = this._drawCalls[0].renderer;\r\n                let currentRenderer = this._renderers.get(currentRendererName);\r\n                for (let i = 0; i < this._drawCalls.length; i++) {\r\n                    // hydrate the state for renderers\r\n                    this._transform.current = this._drawCalls[i].transform;\r\n                    this._state.current = this._drawCalls[i].state;\r\n                    if (this._drawCalls[i].renderer !== currentRendererName) {\r\n                        // switching graphics renderer means we must flush the previous\r\n                        currentRenderer.flush();\r\n                        currentRendererName = this._drawCalls[i].renderer;\r\n                        currentRenderer = this._renderers.get(currentRendererName);\r\n                    }\r\n                    // If we are still using the same renderer we can add to the current batch\r\n                    currentRenderer.draw(...this._drawCalls[i].args);\r\n                }\r\n                if (currentRenderer.hasPendingDraws()) {\r\n                    currentRenderer.flush();\r\n                }\r\n            }\r\n            // reset state\r\n            this._transform.current = oldTransform;\r\n            this._state.current = oldState;\r\n            // reclaim draw calls\r\n            this._drawCallPool.done();\r\n            this._drawCalls.length = 0;\r\n        }\r\n        else {\r\n            // This is the final flush at the moment to draw any leftover pending draw\r\n            for (const renderer of this._renderers.values()) {\r\n                if (renderer.hasPendingDraws()) {\r\n                    renderer.flush();\r\n                }\r\n            }\r\n        }\r\n        this._renderTarget.disable();\r\n        // post process step\r\n        const source = this._renderTarget.toRenderSource();\r\n        source.use();\r\n        // flip flop render targets\r\n        for (let i = 0; i < this._postprocessors.length; i++) {\r\n            this._postProcessTargets[i % 2].use();\r\n            this._screenRenderer.renderWithPostProcessor(this._postprocessors[i]);\r\n            this._postProcessTargets[i % 2].toRenderSource().use();\r\n        }\r\n        // passing null switches rendering back to the canvas\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n        this._screenRenderer.renderToScreen();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/ExcaliburGraphicsContext2DCanvas.ts\n\r\n\r\n\r\n\r\nconst ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon = 0.0001;\r\nclass ExcaliburGraphicsContext2DCanvasDebug {\r\n    constructor(_ex) {\r\n        this._ex = _ex;\r\n        this._debugText = new DebugText();\r\n    }\r\n    /**\r\n     * Draw a debug rectangle to the context\r\n     * @param x\r\n     * @param y\r\n     * @param width\r\n     * @param height\r\n     */\r\n    drawRect(x, y, width, height) {\r\n        this._ex.__ctx.save();\r\n        this._ex.__ctx.strokeStyle = 'red';\r\n        this._ex.__ctx.strokeRect(this._ex.snapToPixel ? ~~(x + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : x, this._ex.snapToPixel ? ~~(y + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : y, this._ex.snapToPixel ? ~~(width + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : width, this._ex.snapToPixel ? ~~(height + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : height);\r\n        this._ex.__ctx.restore();\r\n    }\r\n    drawLine(start, end, lineOptions = { color: Color.Black }) {\r\n        this._ex.__ctx.save();\r\n        this._ex.__ctx.beginPath();\r\n        this._ex.__ctx.strokeStyle = lineOptions.color.toString();\r\n        this._ex.__ctx.moveTo(this._ex.snapToPixel ? ~~(start.x + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : start.x, this._ex.snapToPixel ? ~~(start.y + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : start.y);\r\n        this._ex.__ctx.lineTo(this._ex.snapToPixel ? ~~(end.x + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : end.x, this._ex.snapToPixel ? ~~(end.y + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : end.y);\r\n        this._ex.__ctx.lineWidth = 2;\r\n        this._ex.__ctx.stroke();\r\n        this._ex.__ctx.closePath();\r\n        this._ex.__ctx.restore();\r\n    }\r\n    drawPoint(point, pointOptions = { color: Color.Black, size: 5 }) {\r\n        this._ex.__ctx.save();\r\n        this._ex.__ctx.beginPath();\r\n        this._ex.__ctx.fillStyle = pointOptions.color.toString();\r\n        this._ex.__ctx.arc(this._ex.snapToPixel ? ~~(point.x + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : point.x, this._ex.snapToPixel ? ~~(point.y + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : point.y, pointOptions.size, 0, Math.PI * 2);\r\n        this._ex.__ctx.fill();\r\n        this._ex.__ctx.closePath();\r\n        this._ex.__ctx.restore();\r\n    }\r\n    drawText(text, pos) {\r\n        this._debugText.write(this._ex, text, pos);\r\n    }\r\n}\r\nclass ExcaliburGraphicsContext2DCanvas {\r\n    constructor(options) {\r\n        /**\r\n         * Unused in Canvas implementation\r\n         */\r\n        this.useDrawSorting = false;\r\n        /**\r\n         * Unused in Canvas implementation\r\n         */\r\n        this.z = 0;\r\n        this.backgroundColor = Color.ExcaliburBlue;\r\n        this._state = new StateStack();\r\n        this.snapToPixel = false;\r\n        this.debug = new ExcaliburGraphicsContext2DCanvasDebug(this);\r\n        const { canvasElement, enableTransparency, snapToPixel, smoothing, backgroundColor } = options;\r\n        this.__ctx = canvasElement.getContext('2d', {\r\n            alpha: enableTransparency !== null && enableTransparency !== void 0 ? enableTransparency : true\r\n        });\r\n        this.backgroundColor = backgroundColor !== null && backgroundColor !== void 0 ? backgroundColor : this.backgroundColor;\r\n        this.snapToPixel = snapToPixel !== null && snapToPixel !== void 0 ? snapToPixel : this.snapToPixel;\r\n        this.smoothing = smoothing !== null && smoothing !== void 0 ? smoothing : this.smoothing;\r\n    }\r\n    get width() {\r\n        return this.__ctx.canvas.width;\r\n    }\r\n    get height() {\r\n        return this.__ctx.canvas.height;\r\n    }\r\n    get opacity() {\r\n        return this._state.current.opacity;\r\n    }\r\n    set opacity(value) {\r\n        this._state.current.opacity = value;\r\n    }\r\n    get tint() {\r\n        return this._state.current.tint;\r\n    }\r\n    set tint(color) {\r\n        this._state.current.tint = color;\r\n    }\r\n    get smoothing() {\r\n        return this.__ctx.imageSmoothingEnabled;\r\n    }\r\n    set smoothing(value) {\r\n        this.__ctx.imageSmoothingEnabled = value;\r\n    }\r\n    resetTransform() {\r\n        this.__ctx.resetTransform();\r\n    }\r\n    updateViewport(_resolution) {\r\n        // pass\r\n    }\r\n    drawImage(image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight) {\r\n        if (swidth === 0 || sheight === 0) {\r\n            return; // zero dimension dest exit early\r\n        }\r\n        else if (dwidth === 0 || dheight === 0) {\r\n            return; // zero dimension dest exit early\r\n        }\r\n        else if (image.width === 0 || image.height === 0) {\r\n            return; // zero dimension source exit early\r\n        }\r\n        this.__ctx.globalAlpha = this.opacity;\r\n        const args = [image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight]\r\n            .filter((a) => a !== undefined)\r\n            .map((a) => (typeof a === 'number' && this.snapToPixel ? ~~a : a));\r\n        this.__ctx.drawImage.apply(this.__ctx, args);\r\n        GraphicsDiagnostics.DrawCallCount++;\r\n        GraphicsDiagnostics.DrawnImagesCount = 1;\r\n    }\r\n    drawLine(start, end, color, thickness = 1) {\r\n        this.__ctx.save();\r\n        this.__ctx.beginPath();\r\n        this.__ctx.strokeStyle = color.toString();\r\n        this.__ctx.moveTo(this.snapToPixel ? ~~(start.x + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : start.x, this.snapToPixel ? ~~(start.y + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : start.y);\r\n        this.__ctx.lineTo(this.snapToPixel ? ~~(end.x + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : end.x, this.snapToPixel ? ~~(end.y + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : end.y);\r\n        this.__ctx.lineWidth = thickness;\r\n        this.__ctx.stroke();\r\n        this.__ctx.closePath();\r\n        this.__ctx.restore();\r\n    }\r\n    drawRectangle(pos, width, height, color) {\r\n        this.__ctx.save();\r\n        this.__ctx.fillStyle = color.toString();\r\n        this.__ctx.fillRect(this.snapToPixel ? ~~(pos.x + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : pos.x, this.snapToPixel ? ~~(pos.y + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : pos.y, this.snapToPixel ? ~~(width + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : width, this.snapToPixel ? ~~(height + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : height);\r\n        this.__ctx.restore();\r\n    }\r\n    drawCircle(pos, radius, color, stroke, thickness) {\r\n        this.__ctx.save();\r\n        this.__ctx.beginPath();\r\n        if (stroke) {\r\n            this.__ctx.strokeStyle = stroke.toString();\r\n        }\r\n        if (thickness) {\r\n            this.__ctx.lineWidth = thickness;\r\n        }\r\n        this.__ctx.fillStyle = color.toString();\r\n        this.__ctx.arc(this.snapToPixel ? ~~(pos.x + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : pos.x, this.snapToPixel ? ~~(pos.y + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : pos.y, radius, 0, Math.PI * 2);\r\n        this.__ctx.fill();\r\n        if (stroke) {\r\n            this.__ctx.stroke();\r\n        }\r\n        this.__ctx.closePath();\r\n        this.__ctx.restore();\r\n    }\r\n    /**\r\n     * Save the current state of the canvas to the stack (transforms and opacity)\r\n     */\r\n    save() {\r\n        this.__ctx.save();\r\n    }\r\n    /**\r\n     * Restore the state of the canvas from the stack\r\n     */\r\n    restore() {\r\n        this.__ctx.restore();\r\n    }\r\n    /**\r\n     * Translate the origin of the context by an x and y\r\n     * @param x\r\n     * @param y\r\n     */\r\n    translate(x, y) {\r\n        this.__ctx.translate(this.snapToPixel ? ~~(x + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : x, this.snapToPixel ? ~~(y + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : y);\r\n    }\r\n    /**\r\n     * Rotate the context about the current origin\r\n     */\r\n    rotate(angle) {\r\n        this.__ctx.rotate(angle);\r\n    }\r\n    /**\r\n     * Scale the context by an x and y factor\r\n     * @param x\r\n     * @param y\r\n     */\r\n    scale(x, y) {\r\n        this.__ctx.scale(x, y);\r\n    }\r\n    getTransform() {\r\n        throw new Error('Not implemented');\r\n    }\r\n    multiply(_m) {\r\n        this.__ctx.setTransform(this.__ctx.getTransform().multiply(_m.toDOMMatrix()));\r\n    }\r\n    addPostProcessor(_postprocessor) {\r\n        // pass\r\n    }\r\n    removePostProcessor(_postprocessor) {\r\n        // pass\r\n    }\r\n    clearPostProcessors() {\r\n        // pass\r\n    }\r\n    beginDrawLifecycle() {\r\n        // pass\r\n    }\r\n    endDrawLifecycle() {\r\n        // pass\r\n    }\r\n    clear() {\r\n        // Clear frame\r\n        this.__ctx.clearRect(0, 0, this.width, this.height);\r\n        this.__ctx.fillStyle = this.backgroundColor.toString();\r\n        this.__ctx.fillRect(0, 0, this.width, this.height);\r\n        GraphicsDiagnostics.clear();\r\n    }\r\n    /**\r\n     * Flushes the batched draw calls to the screen\r\n     */\r\n    flush() {\r\n        // pass\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Screen.ts\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Enum representing the different display modes available to Excalibur.\r\n */\r\nvar DisplayMode;\r\n(function (DisplayMode) {\r\n    /**\r\n     * Default, use a specified resolution for the game. Like 800x600 pixels for example.\r\n     */\r\n    DisplayMode[\"Fixed\"] = \"Fixed\";\r\n    /**\r\n     * Fit the aspect ratio given by the game resolution within the container at all times will fill any gaps with canvas.\r\n     * The displayed area outside the aspect ratio is not guaranteed to be on the screen, only the [[Screen.contentArea]]\r\n     * is guaranteed to be on screen.\r\n     */\r\n    DisplayMode[\"FitContainerAndFill\"] = \"FitContainerAndFill\";\r\n    /**\r\n     * Fit the aspect ratio given by the game resolution the screen at all times will fill the screen.\r\n     * This displayed area outside the aspect ratio is not guaranteed to be on the screen, only the [[Screen.contentArea]]\r\n     * is guaranteed to be on screen.\r\n     */\r\n    DisplayMode[\"FitScreenAndFill\"] = \"FitScreenAndFill\";\r\n    /**\r\n     * Fit the viewport to the parent element maintaining aspect ratio given by the game resolution, but zooms in to avoid the black bars\r\n     * (letterbox) that would otherwise be present in [[FitContainer]].\r\n     *\r\n     * **warning** This will clip some drawable area from the user because of the zoom,\r\n     * use [[Screen.contentArea]] to know the safe to draw area.\r\n     */\r\n    DisplayMode[\"FitContainerAndZoom\"] = \"FitContainerAndZoom\";\r\n    /**\r\n     * Fit the viewport to the device screen maintaining aspect ratio given by the game resolution, but zooms in to avoid the black bars\r\n     * (letterbox) that would otherwise be present in [[FitScreen]].\r\n     *\r\n     * **warning** This will clip some drawable area from the user because of the zoom,\r\n     * use [[Screen.contentArea]] to know the safe to draw area.\r\n     */\r\n    DisplayMode[\"FitScreenAndZoom\"] = \"FitScreenAndZoom\";\r\n    /**\r\n     * Fit to screen using as much space as possible while maintaining aspect ratio and resolution.\r\n     * This is not the same as [[Screen.goFullScreen]] but behaves in a similar way maintaining aspect ratio.\r\n     *\r\n     * You may want to center your game here is an example\r\n     * ```html\r\n     * <!-- html -->\r\n     * <body>\r\n     * <main>\r\n     *   <canvas id=\"game\"></canvas>\r\n     * </main>\r\n     * </body>\r\n     * ```\r\n     *\r\n     * ```css\r\n     * // css\r\n     * main {\r\n     *   display: flex;\r\n     *   align-items: center;\r\n     *   justify-content: center;\r\n     *   height: 100%;\r\n     *   width: 100%;\r\n     * }\r\n     * ```\r\n     */\r\n    DisplayMode[\"FitScreen\"] = \"FitScreen\";\r\n    /**\r\n     * Fill the entire screen's css width/height for the game resolution dynamically. This means the resolution of the game will\r\n     * change dynamically as the window is resized. This is not the same as [[Screen.goFullScreen]]\r\n     */\r\n    DisplayMode[\"FillScreen\"] = \"FillScreen\";\r\n    /**\r\n     * Fit to parent element width/height using as much space as possible while maintaining aspect ratio and resolution.\r\n     */\r\n    DisplayMode[\"FitContainer\"] = \"FitContainer\";\r\n    /**\r\n     * Use the parent DOM container's css width/height for the game resolution dynamically\r\n     */\r\n    DisplayMode[\"FillContainer\"] = \"FillContainer\";\r\n})(DisplayMode || (DisplayMode = {}));\r\n/**\r\n * Convenience class for quick resolutions\r\n * Mostly sourced from https://emulation.gametechwiki.com/index.php/Resolution\r\n */\r\nclass Resolution {\r\n    /* istanbul ignore next */\r\n    static get SVGA() {\r\n        return { width: 800, height: 600 };\r\n    }\r\n    /* istanbul ignore next */\r\n    static get Standard() {\r\n        return { width: 1920, height: 1080 };\r\n    }\r\n    /* istanbul ignore next */\r\n    static get Atari2600() {\r\n        return { width: 160, height: 192 };\r\n    }\r\n    /* istanbul ignore next */\r\n    static get GameBoy() {\r\n        return { width: 160, height: 144 };\r\n    }\r\n    /* istanbul ignore next */\r\n    static get GameBoyAdvance() {\r\n        return { width: 240, height: 160 };\r\n    }\r\n    /* istanbul ignore next */\r\n    static get NintendoDS() {\r\n        return { width: 256, height: 192 };\r\n    }\r\n    /* istanbul ignore next */\r\n    static get NES() {\r\n        return { width: 256, height: 224 };\r\n    }\r\n    /* istanbul ignore next */\r\n    static get SNES() {\r\n        return { width: 256, height: 244 };\r\n    }\r\n}\r\n/**\r\n * The Screen handles all aspects of interacting with the screen for Excalibur.\r\n */\r\nclass Screen {\r\n    constructor(options) {\r\n        var _a, _b, _c;\r\n        this._antialiasing = true;\r\n        this._resolutionStack = [];\r\n        this._viewportStack = [];\r\n        this._pixelRatioOverride = null;\r\n        this._isFullScreen = false;\r\n        this._isDisposed = false;\r\n        this._logger = Logger.getInstance();\r\n        this._fullscreenChangeHandler = () => {\r\n            this._isFullScreen = !this._isFullScreen;\r\n            this._logger.debug('Fullscreen Change', this._isFullScreen);\r\n        };\r\n        this._pixelRatioChangeHandler = () => {\r\n            this._logger.debug('Pixel Ratio Change', window.devicePixelRatio);\r\n            this._listenForPixelRatio();\r\n            this._devicePixelRatio = this._calculateDevicePixelRatio();\r\n            this.applyResolutionAndViewport();\r\n        };\r\n        this._resizeHandler = () => {\r\n            const parent = this.parent;\r\n            this._logger.debug('View port resized');\r\n            this._setResolutionAndViewportByDisplayMode(parent);\r\n            this.applyResolutionAndViewport();\r\n        };\r\n        // Asking the window.devicePixelRatio is expensive we do it once\r\n        this._devicePixelRatio = this._calculateDevicePixelRatio();\r\n        this._alreadyWarned = false;\r\n        this._contentArea = new BoundingBox();\r\n        this.viewport = options.viewport;\r\n        this.resolution = (_a = options.resolution) !== null && _a !== void 0 ? _a : { ...this.viewport };\r\n        this._contentResolution = this.resolution;\r\n        this._displayMode = (_b = options.displayMode) !== null && _b !== void 0 ? _b : DisplayMode.Fixed;\r\n        this._canvas = options.canvas;\r\n        this.graphicsContext = options.context;\r\n        this._antialiasing = (_c = options.antialiasing) !== null && _c !== void 0 ? _c : this._antialiasing;\r\n        this._browser = options.browser;\r\n        this._pixelRatioOverride = options.pixelRatio;\r\n        this._applyDisplayMode();\r\n        this._listenForPixelRatio();\r\n        this._canvas.addEventListener('fullscreenchange', this._fullscreenChangeHandler);\r\n        this.applyResolutionAndViewport();\r\n    }\r\n    _listenForPixelRatio() {\r\n        if (this._mediaQueryList && !this._mediaQueryList.addEventListener) {\r\n            // Safari <=13.1 workaround, remove any existing handlers\r\n            this._mediaQueryList.removeListener(this._pixelRatioChangeHandler);\r\n        }\r\n        this._mediaQueryList = this._browser.window.nativeComponent.matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);\r\n        // Safari <=13.1 workaround\r\n        if (this._mediaQueryList.addEventListener) {\r\n            this._mediaQueryList.addEventListener('change', this._pixelRatioChangeHandler, { once: true });\r\n        }\r\n        else {\r\n            this._mediaQueryList.addListener(this._pixelRatioChangeHandler);\r\n        }\r\n    }\r\n    dispose() {\r\n        if (!this._isDisposed) {\r\n            // Clean up handlers\r\n            this._isDisposed = true;\r\n            this._browser.window.off('resize', this._resizeHandler);\r\n            if (this._resizeObserver) {\r\n                this._resizeObserver.disconnect();\r\n            }\r\n            this.parent.removeEventListener('resize', this._resizeHandler);\r\n            // Safari <=13.1 workaround\r\n            if (this._mediaQueryList.removeEventListener) {\r\n                this._mediaQueryList.removeEventListener('change', this._pixelRatioChangeHandler);\r\n            }\r\n            else {\r\n                this._mediaQueryList.removeListener(this._pixelRatioChangeHandler);\r\n            }\r\n            this._canvas.removeEventListener('fullscreenchange', this._fullscreenChangeHandler);\r\n        }\r\n    }\r\n    _calculateDevicePixelRatio() {\r\n        if (window.devicePixelRatio < 1) {\r\n            return 1;\r\n        }\r\n        const devicePixelRatio = window.devicePixelRatio || 1;\r\n        return devicePixelRatio;\r\n    }\r\n    get pixelRatio() {\r\n        if (this._pixelRatioOverride) {\r\n            return this._pixelRatioOverride;\r\n        }\r\n        return this._devicePixelRatio;\r\n    }\r\n    get isHiDpi() {\r\n        return this.pixelRatio !== 1;\r\n    }\r\n    get displayMode() {\r\n        return this._displayMode;\r\n    }\r\n    get canvas() {\r\n        return this._canvas;\r\n    }\r\n    get parent() {\r\n        switch (this.displayMode) {\r\n            case DisplayMode.FillContainer:\r\n            case DisplayMode.FitContainer:\r\n            case DisplayMode.FitContainerAndFill:\r\n            case DisplayMode.FitContainerAndZoom:\r\n                return this.canvas.parentElement || document.body;\r\n            default:\r\n                return window;\r\n        }\r\n    }\r\n    get resolution() {\r\n        return this._resolution;\r\n    }\r\n    set resolution(resolution) {\r\n        this._resolution = resolution;\r\n    }\r\n    get viewport() {\r\n        if (this._viewport) {\r\n            return this._viewport;\r\n        }\r\n        return this._resolution;\r\n    }\r\n    set viewport(viewport) {\r\n        this._viewport = viewport;\r\n    }\r\n    get aspectRatio() {\r\n        return this._resolution.width / this._resolution.height;\r\n    }\r\n    get scaledWidth() {\r\n        return this._resolution.width * this.pixelRatio;\r\n    }\r\n    get scaledHeight() {\r\n        return this._resolution.height * this.pixelRatio;\r\n    }\r\n    setCurrentCamera(camera) {\r\n        this._camera = camera;\r\n    }\r\n    pushResolutionAndViewport() {\r\n        this._resolutionStack.push(this.resolution);\r\n        this._viewportStack.push(this.viewport);\r\n        this.resolution = { ...this.resolution };\r\n        this.viewport = { ...this.viewport };\r\n    }\r\n    peekViewport() {\r\n        return this._viewportStack[this._viewportStack.length - 1];\r\n    }\r\n    peekResolution() {\r\n        return this._resolutionStack[this._resolutionStack.length - 1];\r\n    }\r\n    popResolutionAndViewport() {\r\n        this.resolution = this._resolutionStack.pop();\r\n        this.viewport = this._viewportStack.pop();\r\n    }\r\n    applyResolutionAndViewport() {\r\n        this._canvas.width = this.scaledWidth;\r\n        this._canvas.height = this.scaledHeight;\r\n        if (this.graphicsContext instanceof ExcaliburGraphicsContextWebGL) {\r\n            const supported = this.graphicsContext.checkIfResolutionSupported({\r\n                width: this.scaledWidth,\r\n                height: this.scaledHeight\r\n            });\r\n            if (!supported && !this._alreadyWarned) {\r\n                this._alreadyWarned = true; // warn once\r\n                this._logger.warn(`The currently configured resolution (${this.resolution.width}x${this.resolution.height}) and pixel ratio (${this.pixelRatio})` +\r\n                    ' are too large for the platform WebGL implementation, this may work but cause WebGL rendering to behave oddly.' +\r\n                    ' Try reducing the resolution or disabling Hi DPI scaling to avoid this' +\r\n                    ' (read more here https://excaliburjs.com/docs/screens#understanding-viewport--resolution).');\r\n            }\r\n        }\r\n        if (this._antialiasing) {\r\n            this._canvas.style.imageRendering = 'auto';\r\n        }\r\n        else {\r\n            this._canvas.style.imageRendering = 'pixelated';\r\n            // Fall back to 'crisp-edges' if 'pixelated' is not supported\r\n            // Currently for firefox https://developer.mozilla.org/en-US/docs/Web/CSS/image-rendering\r\n            if (this._canvas.style.imageRendering === '') {\r\n                this._canvas.style.imageRendering = 'crisp-edges';\r\n            }\r\n        }\r\n        this._canvas.style.width = this.viewport.width + 'px';\r\n        this._canvas.style.height = this.viewport.height + 'px';\r\n        // After messing with the canvas width/height the graphics context is invalidated and needs to have some properties reset\r\n        this.graphicsContext.updateViewport(this.resolution);\r\n        this.graphicsContext.resetTransform();\r\n        this.graphicsContext.smoothing = this._antialiasing;\r\n        if (this.graphicsContext instanceof ExcaliburGraphicsContext2DCanvas) {\r\n            this.graphicsContext.scale(this.pixelRatio, this.pixelRatio);\r\n        }\r\n    }\r\n    get antialiasing() {\r\n        return this._antialiasing;\r\n    }\r\n    set antialiasing(isSmooth) {\r\n        this._antialiasing = isSmooth;\r\n        this.graphicsContext.smoothing = this._antialiasing;\r\n    }\r\n    /**\r\n     * Returns true if excalibur is fullscreen using the browser fullscreen api\r\n     */\r\n    get isFullScreen() {\r\n        return this._isFullScreen;\r\n    }\r\n    /**\r\n     * Requests to go fullscreen using the browser fullscreen api, requires user interaction to be successful.\r\n     * For example, wire this to a user click handler.\r\n     *\r\n     * Optionally specify a target element id to go fullscreen, by default the game canvas is used\r\n     * @param elementId\r\n     */\r\n    goFullScreen(elementId) {\r\n        if (elementId) {\r\n            const maybeElement = document.getElementById(elementId);\r\n            if (maybeElement) {\r\n                return maybeElement.requestFullscreen();\r\n            }\r\n        }\r\n        return this._canvas.requestFullscreen();\r\n    }\r\n    /**\r\n     * Requests to exit fullscreen using the browser fullscreen api\r\n     */\r\n    exitFullScreen() {\r\n        return document.exitFullscreen();\r\n    }\r\n    /**\r\n     * Takes a coordinate in normal html page space, for example from a pointer move event, and translates it to\r\n     * Excalibur screen space.\r\n     *\r\n     * Excalibur screen space starts at the top left (0, 0) corner of the viewport, and extends to the\r\n     * bottom right corner (resolutionX, resolutionY)\r\n     * @param point\r\n     */\r\n    pageToScreenCoordinates(point) {\r\n        let newX = point.x;\r\n        let newY = point.y;\r\n        if (!this._isFullScreen) {\r\n            newX -= getPosition(this._canvas).x;\r\n            newY -= getPosition(this._canvas).y;\r\n        }\r\n        // if fullscreen api on it centers with black bars\r\n        // we need to adjust the screen to world coordinates in this case\r\n        if (this._isFullScreen) {\r\n            if (window.innerWidth / this.aspectRatio < window.innerHeight) {\r\n                const screenHeight = window.innerWidth / this.aspectRatio;\r\n                const screenMarginY = (window.innerHeight - screenHeight) / 2;\r\n                newY = ((newY - screenMarginY) / screenHeight) * this.viewport.height;\r\n                newX = (newX / window.innerWidth) * this.viewport.width;\r\n            }\r\n            else {\r\n                const screenWidth = window.innerHeight * this.aspectRatio;\r\n                const screenMarginX = (window.innerWidth - screenWidth) / 2;\r\n                newX = ((newX - screenMarginX) / screenWidth) * this.viewport.width;\r\n                newY = (newY / window.innerHeight) * this.viewport.height;\r\n            }\r\n        }\r\n        newX = (newX / this.viewport.width) * this.resolution.width;\r\n        newY = (newY / this.viewport.height) * this.resolution.height;\r\n        return new Vector(newX, newY);\r\n    }\r\n    /**\r\n     * Takes a coordinate in Excalibur screen space, and translates it to normal html page space. For example,\r\n     * this is where html elements might live if you want to position them relative to Excalibur.\r\n     *\r\n     * Excalibur screen space starts at the top left (0, 0) corner of the viewport, and extends to the\r\n     * bottom right corner (resolutionX, resolutionY)\r\n     * @param point\r\n     */\r\n    screenToPageCoordinates(point) {\r\n        let newX = point.x;\r\n        let newY = point.y;\r\n        newX = (newX / this.resolution.width) * this.viewport.width;\r\n        newY = (newY / this.resolution.height) * this.viewport.height;\r\n        if (this._isFullScreen) {\r\n            if (window.innerWidth / this.aspectRatio < window.innerHeight) {\r\n                const screenHeight = window.innerWidth / this.aspectRatio;\r\n                const screenMarginY = (window.innerHeight - screenHeight) / 2;\r\n                newY = (newY / this.viewport.height) * screenHeight + screenMarginY;\r\n                newX = (newX / this.viewport.width) * window.innerWidth;\r\n            }\r\n            else {\r\n                const screenWidth = window.innerHeight * this.aspectRatio;\r\n                const screenMarginX = (window.innerWidth - screenWidth) / 2;\r\n                newX = (newX / this.viewport.width) * screenWidth + screenMarginX;\r\n                newY = (newY / this.viewport.height) * window.innerHeight;\r\n            }\r\n        }\r\n        if (!this._isFullScreen) {\r\n            newX += getPosition(this._canvas).x;\r\n            newY += getPosition(this._canvas).y;\r\n        }\r\n        return new Vector(newX, newY);\r\n    }\r\n    /**\r\n     * Takes a coordinate in Excalibur screen space, and translates it to Excalibur world space.\r\n     *\r\n     * World space is where [[Entity|entities]] in Excalibur live by default [[CoordPlane.World]]\r\n     * and extends infinitely out relative from the [[Camera]].\r\n     * @param point  Screen coordinate to convert\r\n     */\r\n    screenToWorldCoordinates(point) {\r\n        // the only difference between screen & world is the camera transform\r\n        if (this._camera) {\r\n            return this._camera.inverse.multiply(point);\r\n        }\r\n        return point.sub(vec(this.resolution.width / 2, this.resolution.height / 2));\r\n    }\r\n    /**\r\n     * Takes a coordinate in Excalibur world space, and translates it to Excalibur screen space.\r\n     *\r\n     * Screen space is where [[ScreenElement|screen elements]] and [[Entity|entities]] with [[CoordPlane.Screen]] live.\r\n     * @param point  World coordinate to convert\r\n     */\r\n    worldToScreenCoordinates(point) {\r\n        if (this._camera) {\r\n            return this._camera.transform.multiply(point);\r\n        }\r\n        return point.add(vec(this.resolution.width / 2, this.resolution.height / 2));\r\n    }\r\n    pageToWorldCoordinates(point) {\r\n        const screen = this.pageToScreenCoordinates(point);\r\n        return this.screenToWorldCoordinates(screen);\r\n    }\r\n    worldToPageCoordinates(point) {\r\n        const screen = this.worldToScreenCoordinates(point);\r\n        return this.screenToPageCoordinates(screen);\r\n    }\r\n    /**\r\n     * Returns a BoundingBox of the top left corner of the screen\r\n     * and the bottom right corner of the screen.\r\n     *\r\n     * World bounds are in world coordinates, useful for culling objects offscreen\r\n     */\r\n    getWorldBounds() {\r\n        const topLeft = this.screenToWorldCoordinates(Vector.Zero);\r\n        const right = topLeft.x + this.drawWidth;\r\n        const bottom = topLeft.y + this.drawHeight;\r\n        return new BoundingBox(topLeft.x, topLeft.y, right, bottom);\r\n    }\r\n    /**\r\n     * The width of the game canvas in pixels (physical width component of the\r\n     * resolution of the canvas element)\r\n     */\r\n    get canvasWidth() {\r\n        return this.canvas.width;\r\n    }\r\n    /**\r\n     * Returns half width of the game canvas in pixels (half physical width component)\r\n     */\r\n    get halfCanvasWidth() {\r\n        return this.canvas.width / 2;\r\n    }\r\n    /**\r\n     * The height of the game canvas in pixels, (physical height component of\r\n     * the resolution of the canvas element)\r\n     */\r\n    get canvasHeight() {\r\n        return this.canvas.height;\r\n    }\r\n    /**\r\n     * Returns half height of the game canvas in pixels (half physical height component)\r\n     */\r\n    get halfCanvasHeight() {\r\n        return this.canvas.height / 2;\r\n    }\r\n    /**\r\n     * Returns the width of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get drawWidth() {\r\n        if (this._camera) {\r\n            return this.resolution.width / this._camera.zoom;\r\n        }\r\n        return this.resolution.width;\r\n    }\r\n    /**\r\n     * Returns half the width of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get halfDrawWidth() {\r\n        return this.drawWidth / 2;\r\n    }\r\n    /**\r\n     * Returns the height of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get drawHeight() {\r\n        if (this._camera) {\r\n            return this.resolution.height / this._camera.zoom;\r\n        }\r\n        return this.resolution.height;\r\n    }\r\n    /**\r\n     * Returns half the height of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get halfDrawHeight() {\r\n        return this.drawHeight / 2;\r\n    }\r\n    /**\r\n     * Returns screen center coordinates including zoom and device pixel ratio.\r\n     */\r\n    get center() {\r\n        return vec(this.halfDrawWidth, this.halfDrawHeight);\r\n    }\r\n    /**\r\n     * Returns the content area in screen space where it is safe to place content\r\n     */\r\n    get contentArea() {\r\n        return this._contentArea;\r\n    }\r\n    _computeFit() {\r\n        document.body.style.margin = '0px';\r\n        document.body.style.overflow = 'hidden';\r\n        const aspect = this.aspectRatio;\r\n        let adjustedWidth = 0;\r\n        let adjustedHeight = 0;\r\n        if (window.innerWidth / aspect < window.innerHeight) {\r\n            adjustedWidth = window.innerWidth;\r\n            adjustedHeight = window.innerWidth / aspect;\r\n        }\r\n        else {\r\n            adjustedWidth = window.innerHeight * aspect;\r\n            adjustedHeight = window.innerHeight;\r\n        }\r\n        this.viewport = {\r\n            width: adjustedWidth,\r\n            height: adjustedHeight\r\n        };\r\n        this._contentArea = BoundingBox.fromDimension(this.resolution.width, this.resolution.height, Vector.Zero);\r\n    }\r\n    _computeFitScreenAndFill() {\r\n        document.body.style.margin = '0px';\r\n        document.body.style.overflow = 'hidden';\r\n        const vw = window.innerWidth;\r\n        const vh = window.innerHeight;\r\n        this._computeFitAndFill(vw, vh);\r\n    }\r\n    _computeFitContainerAndFill() {\r\n        document.body.style.margin = '0px';\r\n        document.body.style.overflow = 'hidden';\r\n        const parent = this.canvas.parentElement;\r\n        const vw = parent.clientWidth;\r\n        const vh = parent.clientHeight;\r\n        this._computeFitAndFill(vw, vh);\r\n    }\r\n    _computeFitAndFill(vw, vh) {\r\n        this.viewport = {\r\n            width: vw,\r\n            height: vh\r\n        };\r\n        // if the current screen aspectRatio is less than the original aspectRatio\r\n        if (vw / vh <= this._contentResolution.width / this._contentResolution.height) {\r\n            // compute new resolution to match the original aspect ratio\r\n            this.resolution = {\r\n                width: vw * this._contentResolution.width / vw,\r\n                height: vw * this._contentResolution.width / vw * vh / vw\r\n            };\r\n            const clip = (this.resolution.height - this._contentResolution.height) / 2;\r\n            this._contentArea = new BoundingBox({\r\n                top: clip,\r\n                left: 0,\r\n                right: this._contentResolution.width,\r\n                bottom: this.resolution.height - clip\r\n            });\r\n        }\r\n        else {\r\n            this.resolution = {\r\n                width: vh * this._contentResolution.height / vh * vw / vh,\r\n                height: vh * this._contentResolution.height / vh\r\n            };\r\n            const clip = (this.resolution.width - this._contentResolution.width) / 2;\r\n            this._contentArea = new BoundingBox({\r\n                top: 0,\r\n                left: clip,\r\n                right: this.resolution.width - clip,\r\n                bottom: this._contentResolution.height\r\n            });\r\n        }\r\n    }\r\n    _computeFitScreenAndZoom() {\r\n        document.body.style.margin = '0px';\r\n        document.body.style.overflow = 'hidden';\r\n        this.canvas.style.position = 'absolute';\r\n        const vw = window.innerWidth;\r\n        const vh = window.innerHeight;\r\n        this._computeFitAndZoom(vw, vh);\r\n    }\r\n    _computeFitContainerAndZoom() {\r\n        document.body.style.margin = '0px';\r\n        document.body.style.overflow = 'hidden';\r\n        this.canvas.style.position = 'absolute';\r\n        const parent = this.canvas.parentElement;\r\n        parent.style.position = 'relative';\r\n        parent.style.overflow = 'hidden';\r\n        const vw = parent.clientWidth;\r\n        const vh = parent.clientHeight;\r\n        this._computeFitAndZoom(vw, vh);\r\n    }\r\n    _computeFitAndZoom(vw, vh) {\r\n        const aspect = this.aspectRatio;\r\n        let adjustedWidth = 0;\r\n        let adjustedHeight = 0;\r\n        if (vw / aspect < vh) {\r\n            adjustedWidth = vw;\r\n            adjustedHeight = vw / aspect;\r\n        }\r\n        else {\r\n            adjustedWidth = vh * aspect;\r\n            adjustedHeight = vh;\r\n        }\r\n        const scaleX = vw / adjustedWidth;\r\n        const scaleY = vh / adjustedHeight;\r\n        const maxScaleFactor = Math.max(scaleX, scaleY);\r\n        const zoomedWidth = adjustedWidth * maxScaleFactor;\r\n        const zoomedHeight = adjustedHeight * maxScaleFactor;\r\n        // Center zoomed dimension if bigger than the screen\r\n        if (zoomedWidth > vw) {\r\n            this.canvas.style.left = -(zoomedWidth - vw) / 2 + 'px';\r\n        }\r\n        else {\r\n            this.canvas.style.left = '';\r\n        }\r\n        if (zoomedHeight > vh) {\r\n            this.canvas.style.top = -(zoomedHeight - vh) / 2 + 'px';\r\n        }\r\n        else {\r\n            this.canvas.style.top = '';\r\n        }\r\n        this.viewport = {\r\n            width: zoomedWidth,\r\n            height: zoomedHeight\r\n        };\r\n        const bounds = BoundingBox.fromDimension(this.viewport.width, this.viewport.height, Vector.Zero);\r\n        // return safe area\r\n        if (this.viewport.width > vw) {\r\n            const clip = (this.viewport.width - vw) / this.viewport.width * this.resolution.width;\r\n            bounds.top = 0;\r\n            bounds.left = clip / 2;\r\n            bounds.right = this.resolution.width - clip / 2;\r\n            bounds.bottom = this.resolution.height;\r\n        }\r\n        if (this.viewport.height > vh) {\r\n            const clip = (this.viewport.height - vh) / this.viewport.height * this.resolution.height;\r\n            bounds.top = clip / 2;\r\n            bounds.left = 0;\r\n            bounds.bottom = this.resolution.height - clip / 2;\r\n            bounds.right = this.resolution.width;\r\n        }\r\n        this._contentArea = bounds;\r\n    }\r\n    _computeFitContainer() {\r\n        const aspect = this.aspectRatio;\r\n        let adjustedWidth = 0;\r\n        let adjustedHeight = 0;\r\n        const parent = this.canvas.parentElement;\r\n        if (parent.clientWidth / aspect < parent.clientHeight) {\r\n            adjustedWidth = parent.clientWidth;\r\n            adjustedHeight = parent.clientWidth / aspect;\r\n        }\r\n        else {\r\n            adjustedWidth = parent.clientHeight * aspect;\r\n            adjustedHeight = parent.clientHeight;\r\n        }\r\n        this.viewport = {\r\n            width: adjustedWidth,\r\n            height: adjustedHeight\r\n        };\r\n        this._contentArea = BoundingBox.fromDimension(this.resolution.width, this.resolution.height, Vector.Zero);\r\n    }\r\n    _applyDisplayMode() {\r\n        this._setResolutionAndViewportByDisplayMode(this.parent);\r\n        // watch resizing\r\n        if (this.parent instanceof Window) {\r\n            this._browser.window.on('resize', this._resizeHandler);\r\n        }\r\n        else {\r\n            this._resizeObserver = new ResizeObserver(() => {\r\n                this._resizeHandler();\r\n            });\r\n            this._resizeObserver.observe(this.parent);\r\n        }\r\n        this.parent.addEventListener('resize', this._resizeHandler);\r\n    }\r\n    /**\r\n     * Sets the resolution and viewport based on the selected display mode.\r\n     */\r\n    _setResolutionAndViewportByDisplayMode(parent) {\r\n        if (this.displayMode === DisplayMode.FillContainer) {\r\n            this.resolution = {\r\n                width: parent.clientWidth,\r\n                height: parent.clientHeight\r\n            };\r\n            this.viewport = this.resolution;\r\n        }\r\n        if (this.displayMode === DisplayMode.FillScreen) {\r\n            document.body.style.margin = '0px';\r\n            document.body.style.overflow = 'hidden';\r\n            this.resolution = {\r\n                width: parent.innerWidth,\r\n                height: parent.innerHeight\r\n            };\r\n            this.viewport = this.resolution;\r\n        }\r\n        if (this.displayMode === DisplayMode.FitScreen) {\r\n            this._computeFit();\r\n        }\r\n        if (this.displayMode === DisplayMode.FitContainer) {\r\n            this._computeFitContainer();\r\n        }\r\n        if (this.displayMode === DisplayMode.FitScreenAndFill) {\r\n            this._computeFitScreenAndFill();\r\n        }\r\n        if (this.displayMode === DisplayMode.FitContainerAndFill) {\r\n            this._computeFitContainerAndFill();\r\n        }\r\n        if (this.displayMode === DisplayMode.FitScreenAndZoom) {\r\n            this._computeFitScreenAndZoom();\r\n        }\r\n        if (this.displayMode === DisplayMode.FitContainerAndZoom) {\r\n            this._computeFitContainerAndZoom();\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Resources/Sound/AudioContext.ts\n/**\r\n * Internal class used to build instances of AudioContext\r\n */\r\n/* istanbul ignore next */\r\nclass AudioContextFactory {\r\n    static create() {\r\n        if (!this._INSTANCE) {\r\n            if (window.AudioContext || window.webkitAudioContext) {\r\n                this._INSTANCE = new AudioContext();\r\n            }\r\n        }\r\n        return this._INSTANCE;\r\n    }\r\n}\r\nAudioContextFactory._INSTANCE = null;\r\n\n;// CONCATENATED MODULE: ./Util/WebAudio.ts\n\r\n\r\n/**\r\n * Patch for detecting legacy web audio in browsers\r\n * @internal\r\n * @param source\r\n */\r\nfunction isLegacyWebAudioSource(source) {\r\n    return !!source.playbackState;\r\n}\r\nclass WebAudio {\r\n    /**\r\n     * Play an empty sound to unlock Safari WebAudio context. Call this function\r\n     * right after a user interaction event.\r\n     * @source https://paulbakaus.com/tutorials/html5/web-audio-on-ios/\r\n     */\r\n    static unlock() {\r\n        const promise = new Promise((resolve, reject) => {\r\n            if (WebAudio._UNLOCKED || !AudioContextFactory.create()) {\r\n                return resolve(true);\r\n            }\r\n            const unlockTimeoutTimer = setTimeout(() => {\r\n                Logger.getInstance().warn('Excalibur was unable to unlock the audio context, audio probably will not play in this browser.');\r\n                resolve(false);\r\n            }, 200);\r\n            const audioContext = AudioContextFactory.create();\r\n            audioContext.resume().then(() => {\r\n                // create empty buffer and play it\r\n                const buffer = audioContext.createBuffer(1, 1, 22050);\r\n                const source = audioContext.createBufferSource();\r\n                let ended = false;\r\n                source.buffer = buffer;\r\n                source.connect(audioContext.destination);\r\n                source.onended = () => (ended = true);\r\n                source.start(0);\r\n                // by checking the play state after some time, we know if we're really unlocked\r\n                setTimeout(() => {\r\n                    if (isLegacyWebAudioSource(source)) {\r\n                        if (source.playbackState === source.PLAYING_STATE || source.playbackState === source.FINISHED_STATE) {\r\n                            WebAudio._UNLOCKED = true;\r\n                        }\r\n                    }\r\n                    else {\r\n                        if (audioContext.currentTime > 0 || ended) {\r\n                            WebAudio._UNLOCKED = true;\r\n                        }\r\n                    }\r\n                }, 0);\r\n                clearTimeout(unlockTimeoutTimer);\r\n                resolve(true);\r\n            }, () => {\r\n                reject();\r\n            });\r\n        });\r\n        return promise;\r\n    }\r\n    static isUnlocked() {\r\n        return this._UNLOCKED;\r\n    }\r\n}\r\nWebAudio._UNLOCKED = false;\r\n\n;// CONCATENATED MODULE: ./Class.ts\n\r\n/**\r\n * Excalibur base class that provides basic functionality such as [[EventDispatcher]]\r\n * and extending abilities for vanilla Javascript projects\r\n */\r\nclass Class {\r\n    constructor() {\r\n        this.eventDispatcher = new EventDispatcher();\r\n    }\r\n    /**\r\n     * Alias for `addEventListener`. You can listen for a variety of\r\n     * events off of the engine; see the events section below for a complete list.\r\n     * @param eventName  Name of the event to listen for\r\n     * @param handler    Event handler for the thrown event\r\n     */\r\n    on(eventName, handler) {\r\n        this.eventDispatcher.on(eventName, handler);\r\n    }\r\n    /**\r\n     * Alias for `removeEventListener`. If only the eventName is specified\r\n     * it will remove all handlers registered for that specific event. If the eventName\r\n     * and the handler instance are specified only that handler will be removed.\r\n     *\r\n     * @param eventName  Name of the event to listen for\r\n     * @param handler    Event handler for the thrown event\r\n     */\r\n    off(eventName, handler) {\r\n        this.eventDispatcher.off(eventName, handler);\r\n    }\r\n    /**\r\n     * Emits a new event\r\n     * @param eventName   Name of the event to emit\r\n     * @param eventObject Data associated with this event\r\n     */\r\n    emit(eventName, eventObject) {\r\n        this.eventDispatcher.emit(eventName, eventObject);\r\n    }\r\n    /**\r\n     * Once listens to an event one time, then unsubscribes from that event\r\n     *\r\n     * @param eventName The name of the event to subscribe to once\r\n     * @param handler   The handler of the event that will be auto unsubscribed\r\n     */\r\n    once(eventName, handler) {\r\n        this.eventDispatcher.once(eventName, handler);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/DrawUtil.ts\n\r\n/* istanbul ignore next */\r\n/**\r\n * Draw a line on canvas context\r\n *\r\n * @param ctx The canvas context\r\n * @param color The color of the line\r\n * @param x1 The start x coordinate\r\n * @param y1 The start y coordinate\r\n * @param x2 The ending x coordinate\r\n * @param y2 The ending y coordinate\r\n * @param thickness The line thickness\r\n * @param cap The [[LineCapStyle]] (butt, round, or square)\r\n */\r\nfunction line(ctx, color = Color.Red, x1, y1, x2, y2, thickness = 1, cap = 'butt') {\r\n    ctx.save();\r\n    ctx.beginPath();\r\n    ctx.lineWidth = thickness;\r\n    ctx.lineCap = cap;\r\n    ctx.strokeStyle = color.toString();\r\n    ctx.moveTo(x1, y1);\r\n    ctx.lineTo(x2, y2);\r\n    ctx.closePath();\r\n    ctx.stroke();\r\n    ctx.restore();\r\n}\r\n/* istanbul ignore next */\r\n/**\r\n * Draw the vector as a point onto the canvas.\r\n */\r\nfunction point(ctx, color = Color.Red, point) {\r\n    ctx.beginPath();\r\n    ctx.strokeStyle = color.toString();\r\n    ctx.arc(point.x, point.y, 5, 0, Math.PI * 2);\r\n    ctx.closePath();\r\n    ctx.stroke();\r\n}\r\n/**\r\n * Draw the vector as a line onto the canvas starting a origin point.\r\n */\r\n/* istanbul ignore next */\r\n/**\r\n *\r\n */\r\nfunction vector(ctx, color, origin, vector, scale = 1.0) {\r\n    const c = color ? color.toString() : 'blue';\r\n    const v = vector.scale(scale);\r\n    ctx.beginPath();\r\n    ctx.strokeStyle = c;\r\n    ctx.moveTo(origin.x, origin.y);\r\n    ctx.lineTo(origin.x + v.x, origin.y + v.y);\r\n    ctx.closePath();\r\n    ctx.stroke();\r\n}\r\n/**\r\n * Draw a round rectangle on a canvas context\r\n *\r\n * @param ctx The canvas context\r\n * @param x The top-left x coordinate\r\n * @param y The top-left y coordinate\r\n * @param width The width of the rectangle\r\n * @param height The height of the rectangle\r\n * @param radius The border radius of the rectangle\r\n * @param stroke The [[Color]] to stroke rectangle with\r\n * @param fill The [[Color]] to fill rectangle with\r\n */\r\nfunction roundRect(ctx, x, y, width, height, radius = 5, stroke = Color.White, fill = null) {\r\n    let br;\r\n    if (typeof radius === 'number') {\r\n        br = { tl: radius, tr: radius, br: radius, bl: radius };\r\n    }\r\n    else {\r\n        const defaultRadius = { tl: 0, tr: 0, br: 0, bl: 0 };\r\n        for (const prop in defaultRadius) {\r\n            if (defaultRadius.hasOwnProperty(prop)) {\r\n                const side = prop;\r\n                br[side] = radius[side] || defaultRadius[side];\r\n            }\r\n        }\r\n    }\r\n    ctx.beginPath();\r\n    ctx.moveTo(x + br.tl, y);\r\n    ctx.lineTo(x + width - br.tr, y);\r\n    ctx.quadraticCurveTo(x + width, y, x + width, y + br.tr);\r\n    ctx.lineTo(x + width, y + height - br.br);\r\n    ctx.quadraticCurveTo(x + width, y + height, x + width - br.br, y + height);\r\n    ctx.lineTo(x + br.bl, y + height);\r\n    ctx.quadraticCurveTo(x, y + height, x, y + height - br.bl);\r\n    ctx.lineTo(x, y + br.tl);\r\n    ctx.quadraticCurveTo(x, y, x + br.tl, y);\r\n    ctx.closePath();\r\n    if (fill) {\r\n        ctx.fillStyle = fill.toString();\r\n        ctx.fill();\r\n    }\r\n    if (stroke) {\r\n        ctx.strokeStyle = stroke.toString();\r\n        ctx.stroke();\r\n    }\r\n}\r\n/**\r\n *\r\n */\r\nfunction circle(ctx, x, y, radius, stroke = Color.White, fill = null) {\r\n    ctx.beginPath();\r\n    ctx.arc(x, y, radius, 0, Math.PI * 2);\r\n    ctx.closePath();\r\n    if (fill) {\r\n        ctx.fillStyle = fill.toString();\r\n        ctx.fill();\r\n    }\r\n    if (stroke) {\r\n        ctx.strokeStyle = stroke.toString();\r\n        ctx.stroke();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Loader.logo.png\n/* harmony default export */ const Loader_logo = (\"data:image/png;base64,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\");\n// EXTERNAL MODULE: ./Loader.css\nvar Loader_0 = __webpack_require__(1388);\n;// CONCATENATED MODULE: ./Graphics/Raster.ts\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * A Raster is a Graphic that needs to be first painted to a HTMLCanvasElement before it can be drawn to the\r\n * [[ExcaliburGraphicsContext]]. This is useful for generating custom images using the 2D canvas api.\r\n *\r\n * Implementors must implement the [[Raster.execute]] method to rasterize their drawing.\r\n */\r\nclass Raster extends Graphic {\r\n    constructor(options) {\r\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k;\r\n        super(options);\r\n        this.filtering = null;\r\n        this.lineCap = 'butt';\r\n        this.quality = 1;\r\n        this._dirty = true;\r\n        this._smoothing = false;\r\n        this._color = watch(Color.Black, () => this.flagDirty());\r\n        this._lineWidth = 1;\r\n        this._lineDash = [];\r\n        this._padding = 0;\r\n        if (options) {\r\n            this.quality = (_a = options.quality) !== null && _a !== void 0 ? _a : this.quality;\r\n            this.color = (_b = options.color) !== null && _b !== void 0 ? _b : Color.Black;\r\n            this.strokeColor = options === null || options === void 0 ? void 0 : options.strokeColor;\r\n            this.smoothing = (_c = options.smoothing) !== null && _c !== void 0 ? _c : this.smoothing;\r\n            this.lineWidth = (_d = options.lineWidth) !== null && _d !== void 0 ? _d : this.lineWidth;\r\n            this.lineDash = (_e = options.lineDash) !== null && _e !== void 0 ? _e : this.lineDash;\r\n            this.lineCap = (_f = options.lineCap) !== null && _f !== void 0 ? _f : this.lineCap;\r\n            this.padding = (_g = options.padding) !== null && _g !== void 0 ? _g : this.padding;\r\n            this.filtering = (_h = options.filtering) !== null && _h !== void 0 ? _h : this.filtering;\r\n        }\r\n        this._bitmap = document.createElement('canvas');\r\n        // get the default canvas width/height as a fallback\r\n        const bitmapWidth = (_j = options === null || options === void 0 ? void 0 : options.width) !== null && _j !== void 0 ? _j : this._bitmap.width;\r\n        const bitmapHeight = (_k = options === null || options === void 0 ? void 0 : options.height) !== null && _k !== void 0 ? _k : this._bitmap.height;\r\n        this.width = bitmapWidth;\r\n        this.height = bitmapHeight;\r\n        const maybeCtx = this._bitmap.getContext('2d');\r\n        if (!maybeCtx) {\r\n            /* istanbul ignore next */\r\n            throw new Error('Browser does not support 2d canvas drawing, cannot create Raster graphic');\r\n        }\r\n        else {\r\n            this._ctx = maybeCtx;\r\n        }\r\n    }\r\n    cloneRasterOptions() {\r\n        return {\r\n            color: this.color ? this.color.clone() : null,\r\n            strokeColor: this.strokeColor ? this.strokeColor.clone() : null,\r\n            smoothing: this.smoothing,\r\n            lineWidth: this.lineWidth,\r\n            lineDash: this.lineDash,\r\n            lineCap: this.lineCap,\r\n            quality: this.quality,\r\n            padding: this.padding\r\n        };\r\n    }\r\n    /**\r\n     * Gets whether the graphic is dirty, this means there are changes that haven't been re-rasterized\r\n     */\r\n    get dirty() {\r\n        return this._dirty;\r\n    }\r\n    /**\r\n     * Flags the graphic as dirty, meaning it must be re-rasterized before draw.\r\n     * This should be called any time the graphics state changes such that it affects the outputted drawing\r\n     */\r\n    flagDirty() {\r\n        this._dirty = true;\r\n    }\r\n    /**\r\n     * Gets or sets the current width of the Raster graphic. Setting the width will cause the raster\r\n     * to be flagged dirty causing a re-raster on the next draw.\r\n     *\r\n     * Any `padding`s or `quality` set will be factored into the width\r\n     */\r\n    get width() {\r\n        return Math.abs(this._getTotalWidth() * this.scale.x);\r\n    }\r\n    set width(value) {\r\n        value /= Math.abs(this.scale.x);\r\n        this._bitmap.width = value;\r\n        this._originalWidth = value;\r\n        this.flagDirty();\r\n    }\r\n    /**\r\n     * Gets or sets the current height of the Raster graphic. Setting the height will cause the raster\r\n     * to be flagged dirty causing a re-raster on the next draw.\r\n     *\r\n     * Any `padding` or `quality` set will be factored into the height\r\n     */\r\n    get height() {\r\n        return Math.abs(this._getTotalHeight() * this.scale.y);\r\n    }\r\n    set height(value) {\r\n        value /= Math.abs(this.scale.y);\r\n        this._bitmap.height = value;\r\n        this._originalHeight = value;\r\n        this.flagDirty();\r\n    }\r\n    _getTotalWidth() {\r\n        var _a;\r\n        return (((_a = this._originalWidth) !== null && _a !== void 0 ? _a : this._bitmap.width) + this.padding * 2) * 1;\r\n    }\r\n    _getTotalHeight() {\r\n        var _a;\r\n        return (((_a = this._originalHeight) !== null && _a !== void 0 ? _a : this._bitmap.height) + this.padding * 2) * 1;\r\n    }\r\n    /**\r\n     * Returns the local bounds of the Raster including the padding\r\n     */\r\n    get localBounds() {\r\n        return BoundingBox.fromDimension(this._getTotalWidth() * this.scale.x, this._getTotalHeight() * this.scale.y, Vector.Zero);\r\n    }\r\n    /**\r\n     * Gets or sets the smoothing (anti-aliasing of the graphic). Setting the height will cause the raster\r\n     * to be flagged dirty causing a re-raster on the next draw.\r\n     */\r\n    get smoothing() {\r\n        return this._smoothing;\r\n    }\r\n    set smoothing(value) {\r\n        this._smoothing = value;\r\n        this.flagDirty();\r\n    }\r\n    /**\r\n     * Gets or sets the fillStyle of the Raster graphic. Setting the fillStyle will cause the raster to be\r\n     * flagged dirty causing a re-raster on the next draw.\r\n     */\r\n    get color() {\r\n        return this._color;\r\n    }\r\n    set color(value) {\r\n        this.flagDirty();\r\n        this._color = watch(value, () => this.flagDirty());\r\n    }\r\n    /**\r\n     * Gets or sets the strokeStyle of the Raster graphic. Setting the strokeStyle will cause the raster to be\r\n     * flagged dirty causing a re-raster on the next draw.\r\n     */\r\n    get strokeColor() {\r\n        return this._strokeColor;\r\n    }\r\n    set strokeColor(value) {\r\n        this.flagDirty();\r\n        this._strokeColor = watch(value, () => this.flagDirty());\r\n    }\r\n    /**\r\n     * Gets or sets the line width of the Raster graphic. Setting the lineWidth will cause the raster to be\r\n     * flagged dirty causing a re-raster on the next draw.\r\n     */\r\n    get lineWidth() {\r\n        return this._lineWidth;\r\n    }\r\n    set lineWidth(value) {\r\n        this._lineWidth = value;\r\n        this.flagDirty();\r\n    }\r\n    get lineDash() {\r\n        return this._lineDash;\r\n    }\r\n    set lineDash(value) {\r\n        this._lineDash = value;\r\n        this.flagDirty();\r\n    }\r\n    get padding() {\r\n        return this._padding;\r\n    }\r\n    set padding(value) {\r\n        this._padding = value;\r\n        this.flagDirty();\r\n    }\r\n    /**\r\n     * Rasterize the graphic to a bitmap making it usable as in excalibur. Rasterize is called automatically if\r\n     * the graphic is [[Raster.dirty]] on the next [[Graphic.draw]] call\r\n     */\r\n    rasterize() {\r\n        this._dirty = false;\r\n        this._ctx.clearRect(0, 0, this._getTotalWidth(), this._getTotalHeight());\r\n        this._ctx.save();\r\n        this._applyRasterProperties(this._ctx);\r\n        this.execute(this._ctx);\r\n        this._ctx.restore();\r\n        // The webgl texture needs to be updated if it exists after a raster cycle\r\n        TextureLoader.load(this._bitmap, this.filtering, true);\r\n    }\r\n    _applyRasterProperties(ctx) {\r\n        var _a, _b, _c;\r\n        this._bitmap.width = this._getTotalWidth() * this.quality;\r\n        this._bitmap.height = this._getTotalHeight() * this.quality;\r\n        ctx.scale(this.quality, this.quality);\r\n        ctx.translate(this.padding, this.padding);\r\n        ctx.imageSmoothingEnabled = this.smoothing;\r\n        ctx.lineWidth = this.lineWidth;\r\n        ctx.setLineDash((_a = this.lineDash) !== null && _a !== void 0 ? _a : ctx.getLineDash());\r\n        ctx.lineCap = this.lineCap;\r\n        ctx.strokeStyle = (_b = this.strokeColor) === null || _b === void 0 ? void 0 : _b.toString();\r\n        ctx.fillStyle = (_c = this.color) === null || _c === void 0 ? void 0 : _c.toString();\r\n    }\r\n    _drawImage(ex, x, y) {\r\n        if (this._dirty) {\r\n            this.rasterize();\r\n        }\r\n        ex.scale(1 / this.quality, 1 / this.quality);\r\n        ex.drawImage(this._bitmap, x, y);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Canvas.ts\n\r\n/**\r\n * A canvas [[Graphic]] to provide an adapter between the 2D Canvas API and the [[ExcaliburGraphicsContext]].\r\n *\r\n * The [[Canvas]] works by re-rastering a draw handler to a HTMLCanvasElement for every draw which is then passed\r\n * to the [[ExcaliburGraphicsContext]] implementation as a rendered image.\r\n *\r\n * **Low performance API**\r\n */\r\nclass Canvas extends Raster {\r\n    constructor(_options) {\r\n        super(_options);\r\n        this._options = _options;\r\n    }\r\n    /**\r\n     * Return the 2D graphics context of this canvas\r\n     */\r\n    get ctx() {\r\n        return this._ctx;\r\n    }\r\n    clone() {\r\n        return new Canvas({\r\n            ...this._options,\r\n            ...this.cloneGraphicOptions(),\r\n            ...this.cloneRasterOptions()\r\n        });\r\n    }\r\n    execute(ctx) {\r\n        var _a, _b;\r\n        if ((_a = this._options) === null || _a === void 0 ? void 0 : _a.draw) {\r\n            (_b = this._options) === null || _b === void 0 ? void 0 : _b.draw(ctx);\r\n        }\r\n        if (!this._options.cache) {\r\n            this.flagDirty();\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Interfaces/AudioImplementation.ts\nclass ExResponse {\r\n}\r\nExResponse.type = {\r\n    any: '',\r\n    blob: 'blob',\r\n    json: 'json',\r\n    text: 'text',\r\n    document: 'document',\r\n    arraybuffer: 'arraybuffer'\r\n};\r\n\n;// CONCATENATED MODULE: ./Util/StateMachine.ts\nclass StateMachine {\r\n    constructor() {\r\n        this.states = new Map();\r\n    }\r\n    get currentState() {\r\n        return this._currentState;\r\n    }\r\n    set currentState(state) {\r\n        this._currentState = state;\r\n    }\r\n    static create(machineDescription, data) {\r\n        const machine = new StateMachine();\r\n        machine.data = data;\r\n        for (const stateName in machineDescription.states) {\r\n            machine.states.set(stateName, {\r\n                name: stateName,\r\n                ...machineDescription.states[stateName]\r\n            });\r\n        }\r\n        // validate transitions are states\r\n        for (const state of machine.states.values()) {\r\n            for (const transitionState of state.transitions) {\r\n                if (transitionState === '*') {\r\n                    continue;\r\n                }\r\n                if (!machine.states.has(transitionState)) {\r\n                    throw Error(`Invalid state machine, state [${state.name}] has a transition to another state that doesn't exist [${transitionState}]`);\r\n                }\r\n            }\r\n        }\r\n        machine.currentState = machine.startState = machine.states.get(machineDescription.start);\r\n        return machine;\r\n    }\r\n    in(state) {\r\n        return this.currentState.name === state;\r\n    }\r\n    go(stateName, eventData) {\r\n        var _a, _b;\r\n        if (this.currentState.transitions.includes(stateName) || this.currentState.transitions.includes('*')) {\r\n            const potentialNewState = this.states.get(stateName);\r\n            if (this.currentState.onExit) {\r\n                const canExit = (_a = this.currentState) === null || _a === void 0 ? void 0 : _a.onExit({ to: potentialNewState.name, data: this.data });\r\n                if (canExit === false) {\r\n                    return false;\r\n                }\r\n            }\r\n            if (potentialNewState === null || potentialNewState === void 0 ? void 0 : potentialNewState.onEnter) {\r\n                const canEnter = potentialNewState === null || potentialNewState === void 0 ? void 0 : potentialNewState.onEnter({ from: this.currentState.name, eventData, data: this.data });\r\n                if (canEnter === false) {\r\n                    return false;\r\n                }\r\n            }\r\n            // console.log(`${this.currentState.name} => ${potentialNewState.name} (${eventData})`);\r\n            this.currentState = potentialNewState;\r\n            if ((_b = this.currentState) === null || _b === void 0 ? void 0 : _b.onState) {\r\n                this.currentState.onState();\r\n            }\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    update(elapsedMs) {\r\n        if (this.currentState.onUpdate) {\r\n            this.currentState.onUpdate(this.data, elapsedMs);\r\n        }\r\n    }\r\n    save(saveKey) {\r\n        localStorage.setItem(saveKey, JSON.stringify({\r\n            currentState: this.currentState.name,\r\n            data: this.data\r\n        }));\r\n    }\r\n    restore(saveKey) {\r\n        const state = JSON.parse(localStorage.getItem(saveKey));\r\n        this.currentState = this.states.get(state.currentState);\r\n        this.data = state.data;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Resources/Sound/WebAudioInstance.ts\n\r\n\r\n\r\n/**\r\n * Internal class representing a Web Audio AudioBufferSourceNode instance\r\n * @see https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API\r\n */\r\nclass WebAudioInstance {\r\n    constructor(_src) {\r\n        this._src = _src;\r\n        this._audioContext = AudioContextFactory.create();\r\n        this._volumeNode = this._audioContext.createGain();\r\n        this._playingPromise = new Promise((resolve) => {\r\n            this._playingResolve = resolve;\r\n        });\r\n        this._stateMachine = StateMachine.create({\r\n            start: 'STOPPED',\r\n            states: {\r\n                PLAYING: {\r\n                    onEnter: ({ data }) => {\r\n                        // Buffer nodes are single use\r\n                        this._createNewBufferSource();\r\n                        this._handleEnd();\r\n                        this._instance.start(0, data.pausedAt * this._playbackRate, this.duration);\r\n                        data.startedAt = (this._audioContext.currentTime - data.pausedAt);\r\n                        data.pausedAt = 0;\r\n                    },\r\n                    onState: () => this._playStarted(),\r\n                    onExit: ({ to }) => {\r\n                        // If you've exited early only resolve if explicitly STOPPED\r\n                        if (to === 'STOPPED') {\r\n                            this._playingResolve(true);\r\n                        }\r\n                        // Whenever you're not playing... you stop!\r\n                        this._instance.onended = null; // disconnect the wired on-end handler\r\n                        this._instance.disconnect();\r\n                        this._instance.stop(0);\r\n                        this._instance = null;\r\n                    },\r\n                    transitions: ['STOPPED', 'PAUSED', 'SEEK']\r\n                },\r\n                SEEK: {\r\n                    onEnter: ({ eventData: position, data }) => {\r\n                        data.pausedAt = (position !== null && position !== void 0 ? position : 0) / this._playbackRate;\r\n                        data.startedAt = 0;\r\n                    },\r\n                    transitions: ['*']\r\n                },\r\n                STOPPED: {\r\n                    onEnter: ({ data }) => {\r\n                        data.pausedAt = 0;\r\n                        data.startedAt = 0;\r\n                        this._playingResolve(true);\r\n                    },\r\n                    transitions: ['PLAYING', 'PAUSED', 'SEEK']\r\n                },\r\n                PAUSED: {\r\n                    onEnter: ({ data }) => {\r\n                        // Playback rate will be a scale factor of how fast/slow the audio is being played\r\n                        // default is 1.0\r\n                        // we need to invert it to get the time scale\r\n                        data.pausedAt = (this._audioContext.currentTime - data.startedAt);\r\n                    },\r\n                    transitions: ['PLAYING', 'STOPPED', 'SEEK']\r\n                }\r\n            }\r\n        }, {\r\n            startedAt: 0,\r\n            pausedAt: 0\r\n        });\r\n        this._volume = 1;\r\n        this._loop = false;\r\n        // eslint-disable-next-line @typescript-eslint/no-empty-function\r\n        this._playStarted = () => { };\r\n        this._playbackRate = 1.0;\r\n        this._createNewBufferSource();\r\n    }\r\n    _createNewBufferSource() {\r\n        this._instance = this._audioContext.createBufferSource();\r\n        this._instance.buffer = this._src;\r\n        this._instance.loop = this.loop;\r\n        this._instance.playbackRate.value = this._playbackRate;\r\n        this._instance.connect(this._volumeNode);\r\n        this._volumeNode.connect(this._audioContext.destination);\r\n    }\r\n    _handleEnd() {\r\n        if (!this.loop) {\r\n            this._instance.onended = () => {\r\n                this._playingResolve(true);\r\n            };\r\n        }\r\n    }\r\n    set loop(value) {\r\n        this._loop = value;\r\n        if (this._instance) {\r\n            this._instance.loop = value;\r\n            if (!this.loop) {\r\n                this._instance.onended = () => {\r\n                    this._playingResolve(true);\r\n                };\r\n            }\r\n        }\r\n    }\r\n    get loop() {\r\n        return this._loop;\r\n    }\r\n    set volume(value) {\r\n        value = clamp(value, 0, 1.0);\r\n        this._volume = value;\r\n        if (this._stateMachine.in('PLAYING') && this._volumeNode.gain.setTargetAtTime) {\r\n            // https://developer.mozilla.org/en-US/docs/Web/API/AudioParam/setTargetAtTime\r\n            // After each .1 seconds timestep, the target value will ~63.2% closer to the target value.\r\n            // This exponential ramp provides a more pleasant transition in gain\r\n            this._volumeNode.gain.setTargetAtTime(value, this._audioContext.currentTime, 0.1);\r\n        }\r\n        else {\r\n            this._volumeNode.gain.value = value;\r\n        }\r\n    }\r\n    get volume() {\r\n        return this._volume;\r\n    }\r\n    /**\r\n     * Returns the set duration to play, otherwise returns the total duration if unset\r\n     */\r\n    get duration() {\r\n        var _a;\r\n        return (_a = this._duration) !== null && _a !== void 0 ? _a : this.getTotalPlaybackDuration();\r\n    }\r\n    /**\r\n     * Set the duration that this audio should play.\r\n     *\r\n     * Note: if you seek to a specific point the duration will start from that point, for example\r\n     *\r\n     * If you have a 10 second clip, seek to 5 seconds, then set the duration to 2, it will play the clip from 5-7 seconds.\r\n     */\r\n    set duration(duration) {\r\n        this._duration = duration;\r\n    }\r\n    isPlaying() {\r\n        return this._stateMachine.in('PLAYING');\r\n    }\r\n    isPaused() {\r\n        return this._stateMachine.in('PAUSED') || this._stateMachine.in('SEEK');\r\n    }\r\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\r\n    play(playStarted = () => { }) {\r\n        this._playStarted = playStarted;\r\n        this._stateMachine.go('PLAYING');\r\n        return this._playingPromise;\r\n    }\r\n    pause() {\r\n        this._stateMachine.go('PAUSED');\r\n    }\r\n    stop() {\r\n        this._stateMachine.go('STOPPED');\r\n    }\r\n    seek(position) {\r\n        this._stateMachine.go('PAUSED');\r\n        this._stateMachine.go('SEEK', position);\r\n    }\r\n    getTotalPlaybackDuration() {\r\n        return this._src.duration;\r\n    }\r\n    getPlaybackPosition() {\r\n        const { pausedAt, startedAt } = this._stateMachine.data;\r\n        if (pausedAt) {\r\n            return pausedAt * this._playbackRate;\r\n        }\r\n        if (startedAt) {\r\n            return (this._audioContext.currentTime - startedAt) * this._playbackRate;\r\n        }\r\n        return 0;\r\n    }\r\n    set playbackRate(playbackRate) {\r\n        this._instance.playbackRate.value = this._playbackRate = playbackRate;\r\n    }\r\n    get playbackRate() {\r\n        return this._instance.playbackRate.value;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Events/MediaEvents.ts\n\r\nclass MediaEvent extends GameEvent {\r\n    constructor(target, _name = 'MediaEvent') {\r\n        super();\r\n        this.target = target;\r\n        this._name = _name;\r\n    }\r\n    /**\r\n     * Media event cannot bubble\r\n     */\r\n    set bubbles(_value) {\r\n        // stubbed\r\n    }\r\n    /**\r\n     * Media event cannot bubble\r\n     */\r\n    get bubbles() {\r\n        return false;\r\n    }\r\n    /**\r\n     * Media event cannot bubble, so they have no path\r\n     */\r\n    get _path() {\r\n        return null;\r\n    }\r\n    /**\r\n     * Media event cannot bubble, so they have no path\r\n     */\r\n    set _path(_val) {\r\n        // stubbed\r\n    }\r\n    /**\r\n     * Prevents event from bubbling\r\n     */\r\n    stopPropagation() {\r\n        /**\r\n         * Stub\r\n         */\r\n    }\r\n    /**\r\n     * Action, that calls when event happens\r\n     */\r\n    action() {\r\n        /**\r\n         * Stub\r\n         */\r\n    }\r\n    /**\r\n     * Propagate event further through event path\r\n     */\r\n    propagate() {\r\n        /**\r\n         * Stub\r\n         */\r\n    }\r\n    layPath(_actor) {\r\n        /**\r\n         * Stub\r\n         */\r\n    }\r\n}\r\nclass NativeSoundEvent extends MediaEvent {\r\n    constructor(target, track) {\r\n        super(target, 'NativeSoundEvent');\r\n        this.track = track;\r\n    }\r\n}\r\nclass NativeSoundProcessedEvent extends MediaEvent {\r\n    constructor(target, _processedData) {\r\n        super(target, 'NativeSoundProcessedEvent');\r\n        this._processedData = _processedData;\r\n        this.data = this._processedData;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Sound.ts\n\r\n/**\r\n * Whether or not the browser can play this file as HTML5 Audio\r\n */\r\nfunction canPlayFile(file) {\r\n    try {\r\n        const a = new Audio();\r\n        const filetype = /.*\\.([A-Za-z0-9]+)$/;\r\n        const type = file.match(filetype)[1];\r\n        if (a.canPlayType('audio/' + type)) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    catch (e) {\r\n        Logger.getInstance().warn('Cannot determine audio support, assuming no support for the Audio Tag', e);\r\n        return false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Resources/Sound/Sound.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * The [[Sound]] object allows games built in Excalibur to load audio\r\n * components, from soundtracks to sound effects. [[Sound]] is an [[Loadable]]\r\n * which means it can be passed to a [[Loader]] to pre-load before a game or level.\r\n */\r\nclass Sound extends Class {\r\n    /**\r\n     * @param paths A list of audio sources (clip.wav, clip.mp3, clip.ogg) for this audio clip. This is done for browser compatibility.\r\n     */\r\n    constructor(...paths) {\r\n        super();\r\n        this.logger = Logger.getInstance();\r\n        this._loop = false;\r\n        this._volume = 1;\r\n        this._isStopped = false;\r\n        // private _isPaused = false;\r\n        this._tracks = [];\r\n        this._wasPlayingOnHidden = false;\r\n        this._playbackRate = 1.0;\r\n        this._audioContext = AudioContextFactory.create();\r\n        this._resource = new Resource('', ExResponse.type.arraybuffer);\r\n        /**\r\n         * Chrome : MP3, WAV, Ogg\r\n         * Firefox : WAV, Ogg,\r\n         * IE : MP3, WAV coming soon\r\n         * Safari MP3, WAV, Ogg\r\n         */\r\n        for (const path of paths) {\r\n            if (canPlayFile(path)) {\r\n                this.path = path;\r\n                break;\r\n            }\r\n        }\r\n        if (!this.path) {\r\n            this.logger.warn('This browser does not support any of the audio files specified:', paths.join(', '));\r\n            this.logger.warn('Attempting to use', paths[0]);\r\n            this.path = paths[0]; // select the first specified\r\n        }\r\n    }\r\n    /**\r\n     * Indicates whether the clip should loop when complete\r\n     * @param value  Set the looping flag\r\n     */\r\n    set loop(value) {\r\n        this._loop = value;\r\n        for (const track of this._tracks) {\r\n            track.loop = this._loop;\r\n        }\r\n        this.logger.debug('Set loop for all instances of sound', this.path, 'to', this._loop);\r\n    }\r\n    get loop() {\r\n        return this._loop;\r\n    }\r\n    set volume(value) {\r\n        this._volume = value;\r\n        for (const track of this._tracks) {\r\n            track.volume = this._volume;\r\n        }\r\n        this.emit('volumechange', new NativeSoundEvent(this));\r\n        this.logger.debug('Set loop for all instances of sound', this.path, 'to', this._volume);\r\n    }\r\n    get volume() {\r\n        return this._volume;\r\n    }\r\n    /**\r\n     * Get the duration that this audio should play. If unset the total natural playback duration will be used.\r\n     */\r\n    get duration() {\r\n        return this._duration;\r\n    }\r\n    /**\r\n     * Set the duration that this audio should play. If unset the total natural playback duration will be used.\r\n     *\r\n     * Note: if you seek to a specific point the duration will start from that point, for example\r\n     *\r\n     * If you have a 10 second clip, seek to 5 seconds, then set the duration to 2, it will play the clip from 5-7 seconds.\r\n     */\r\n    set duration(duration) {\r\n        this._duration = duration;\r\n    }\r\n    /**\r\n     * Return array of Current AudioInstances playing or being paused\r\n     */\r\n    get instances() {\r\n        return this._tracks;\r\n    }\r\n    get path() {\r\n        return this._resource.path;\r\n    }\r\n    set path(val) {\r\n        this._resource.path = val;\r\n    }\r\n    isLoaded() {\r\n        return !!this.data;\r\n    }\r\n    async load() {\r\n        var _a, _b;\r\n        if (this.data) {\r\n            return this.data;\r\n        }\r\n        const arraybuffer = await this._resource.load();\r\n        const audiobuffer = await this.decodeAudio(arraybuffer.slice(0));\r\n        this._duration = (_b = (_a = this._duration) !== null && _a !== void 0 ? _a : audiobuffer === null || audiobuffer === void 0 ? void 0 : audiobuffer.duration) !== null && _b !== void 0 ? _b : undefined;\r\n        this.emit('processed', new NativeSoundProcessedEvent(this, audiobuffer));\r\n        return this.data = audiobuffer;\r\n    }\r\n    async decodeAudio(data) {\r\n        try {\r\n            return await this._audioContext.decodeAudioData(data.slice(0));\r\n        }\r\n        catch (e) {\r\n            this.logger.error('Unable to decode ' +\r\n                ' this browser may not fully support this format, or the file may be corrupt, ' +\r\n                'if this is an mp3 try removing id3 tags and album art from the file.');\r\n            return await Promise.reject();\r\n        }\r\n    }\r\n    wireEngine(engine) {\r\n        if (engine) {\r\n            this._engine = engine;\r\n            this._engine.on('hidden', () => {\r\n                if (engine.pauseAudioWhenHidden && this.isPlaying()) {\r\n                    this._wasPlayingOnHidden = true;\r\n                    this.pause();\r\n                }\r\n            });\r\n            this._engine.on('visible', () => {\r\n                if (engine.pauseAudioWhenHidden && this._wasPlayingOnHidden) {\r\n                    this.play();\r\n                    this._wasPlayingOnHidden = false;\r\n                }\r\n            });\r\n            this._engine.on('start', () => {\r\n                this._isStopped = false;\r\n            });\r\n            this._engine.on('stop', () => {\r\n                this.stop();\r\n                this._isStopped = true;\r\n            });\r\n        }\r\n    }\r\n    /**\r\n     * Returns how many instances of the sound are currently playing\r\n     */\r\n    instanceCount() {\r\n        return this._tracks.length;\r\n    }\r\n    /**\r\n     * Whether or not the sound is playing right now\r\n     */\r\n    isPlaying() {\r\n        return this._tracks.some((t) => t.isPlaying());\r\n    }\r\n    isPaused() {\r\n        return this._tracks.some(t => t.isPaused());\r\n    }\r\n    /**\r\n     * Play the sound, returns a promise that resolves when the sound is done playing\r\n     * An optional volume argument can be passed in to play the sound. Max volume is 1.0\r\n     */\r\n    play(volume) {\r\n        if (!this.isLoaded()) {\r\n            this.logger.warn('Cannot start playing. Resource', this.path, 'is not loaded yet');\r\n            return Promise.resolve(true);\r\n        }\r\n        if (this._isStopped) {\r\n            this.logger.warn('Cannot start playing. Engine is in a stopped state.');\r\n            return Promise.resolve(false);\r\n        }\r\n        this.volume = volume || this.volume;\r\n        if (this.isPaused()) {\r\n            return this._resumePlayback();\r\n        }\r\n        else {\r\n            return this._startPlayback();\r\n        }\r\n    }\r\n    /**\r\n     * Stop the sound, and do not rewind\r\n     */\r\n    pause() {\r\n        if (!this.isPlaying()) {\r\n            return;\r\n        }\r\n        for (const track of this._tracks) {\r\n            track.pause();\r\n        }\r\n        this.emit('pause', new NativeSoundEvent(this));\r\n        this.logger.debug('Paused all instances of sound', this.path);\r\n    }\r\n    /**\r\n     * Stop the sound if it is currently playing and rewind the track. If the sound is not playing, rewinds the track.\r\n     */\r\n    stop() {\r\n        for (const track of this._tracks) {\r\n            track.stop();\r\n        }\r\n        this.emit('stop', new NativeSoundEvent(this));\r\n        this._tracks.length = 0;\r\n        this.logger.debug('Stopped all instances of sound', this.path);\r\n    }\r\n    get playbackRate() {\r\n        return this._playbackRate;\r\n    }\r\n    set playbackRate(playbackRate) {\r\n        this._playbackRate = playbackRate;\r\n        this._tracks.forEach(t => {\r\n            t.playbackRate = this._playbackRate;\r\n        });\r\n    }\r\n    seek(position, trackId = 0) {\r\n        if (this._tracks.length === 0) {\r\n            this._getTrackInstance(this.data);\r\n        }\r\n        this._tracks[trackId].seek(position);\r\n    }\r\n    getTotalPlaybackDuration() {\r\n        return this.data.duration;\r\n    }\r\n    /**\r\n     * Return the current playback time of the playing track in seconds from the start.\r\n     *\r\n     * Optionally specify the track to query if multiple are playing at once.\r\n     * @param trackId\r\n     */\r\n    getPlaybackPosition(trackId = 0) {\r\n        if (this._tracks.length) {\r\n            return this._tracks[trackId].getPlaybackPosition();\r\n        }\r\n        return 0;\r\n    }\r\n    /**\r\n     * Get Id of provided AudioInstance in current trackList\r\n     * @param track [[Audio]] which Id is to be given\r\n     */\r\n    getTrackId(track) {\r\n        return this._tracks.indexOf(track);\r\n    }\r\n    async _resumePlayback() {\r\n        if (this.isPaused) {\r\n            const resumed = [];\r\n            // ensure we resume *current* tracks (if paused)\r\n            for (const track of this._tracks) {\r\n                resumed.push(track.play().then(() => {\r\n                    this.emit('playbackend', new NativeSoundEvent(this, track));\r\n                    this._tracks.splice(this.getTrackId(track), 1);\r\n                    return true;\r\n                }));\r\n            }\r\n            this.emit('resume', new NativeSoundEvent(this));\r\n            this.logger.debug('Resuming paused instances for sound', this.path, this._tracks);\r\n            // resolve when resumed tracks are done\r\n            await Promise.all(resumed);\r\n        }\r\n        return true;\r\n    }\r\n    /**\r\n     * Starts playback, returns a promise that resolves when playback is complete\r\n     */\r\n    async _startPlayback() {\r\n        const track = await this._getTrackInstance(this.data);\r\n        const complete = await track.play(() => {\r\n            this.emit('playbackstart', new NativeSoundEvent(this, track));\r\n            this.logger.debug('Playing new instance for sound', this.path);\r\n        });\r\n        // when done, remove track\r\n        this.emit('playbackend', new NativeSoundEvent(this, track));\r\n        this._tracks.splice(this.getTrackId(track), 1);\r\n        return complete;\r\n    }\r\n    _getTrackInstance(data) {\r\n        const newTrack = new WebAudioInstance(data);\r\n        newTrack.loop = this.loop;\r\n        newTrack.volume = this.volume;\r\n        newTrack.duration = this.duration;\r\n        newTrack.playbackRate = this._playbackRate;\r\n        this._tracks.push(newTrack);\r\n        return newTrack;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Loader.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Pre-loading assets\r\n *\r\n * The loader provides a mechanism to preload multiple resources at\r\n * one time. The loader must be passed to the engine in order to\r\n * trigger the loading progress bar.\r\n *\r\n * The [[Loader]] itself implements [[Loadable]] so you can load loaders.\r\n *\r\n * ## Example: Pre-loading resources for a game\r\n *\r\n * ```js\r\n * // create a loader\r\n * var loader = new ex.Loader();\r\n *\r\n * // create a resource dictionary (best practice is to keep a separate file)\r\n * var resources = {\r\n *   TextureGround: new ex.Texture(\"/images/textures/ground.png\"),\r\n *   SoundDeath: new ex.Sound(\"/sound/death.wav\", \"/sound/death.mp3\")\r\n * };\r\n *\r\n * // loop through dictionary and add to loader\r\n * for (var loadable in resources) {\r\n *   if (resources.hasOwnProperty(loadable)) {\r\n *     loader.addResource(resources[loadable]);\r\n *   }\r\n * }\r\n *\r\n * // start game\r\n * game.start(loader).then(function () {\r\n *   console.log(\"Game started!\");\r\n * });\r\n * ```\r\n *\r\n * ## Customize the Loader\r\n *\r\n * The loader can be customized to show different, text, logo, background color, and button.\r\n *\r\n * ```typescript\r\n * const loader = new ex.Loader([playerTexture]);\r\n *\r\n * // The loaders button text can simply modified using this\r\n * loader.playButtonText = 'Start the best game ever';\r\n *\r\n * // The logo can be changed by inserting a base64 image string here\r\n *\r\n * loader.logo = 'data:image/png;base64,iVBORw...';\r\n * loader.logoWidth = 15;\r\n * loader.logoHeight = 14;\r\n *\r\n * // The background color can be changed like so by supplying a valid CSS color string\r\n *\r\n * loader.backgroundColor = 'red'\r\n * loader.backgroundColor = '#176BAA'\r\n *\r\n * // To build a completely new button\r\n * loader.startButtonFactory = () => {\r\n *     let myButton = document.createElement('button');\r\n *     myButton.textContent = 'The best button';\r\n *     return myButton;\r\n * };\r\n *\r\n * engine.start(loader).then(() => {});\r\n * ```\r\n */\r\nclass Loader extends Class {\r\n    /**\r\n     * @param loadables  Optionally provide the list of resources you want to load at constructor time\r\n     */\r\n    constructor(loadables) {\r\n        super();\r\n        this.canvas = new Canvas({\r\n            filtering: ImageFiltering.Blended,\r\n            smoothing: true,\r\n            cache: true,\r\n            draw: this.draw.bind(this)\r\n        });\r\n        this._resourceList = [];\r\n        this._index = 0;\r\n        this._playButtonShown = false;\r\n        this._resourceCount = 0;\r\n        this._numLoaded = 0;\r\n        this._progressCounts = {};\r\n        this._totalCounts = {};\r\n        // logo drawing stuff\r\n        // base64 string encoding of the excalibur logo (logo-white.png)\r\n        this.logo = Loader_logo;\r\n        this.logoWidth = 468;\r\n        this.logoHeight = 118;\r\n        /**\r\n         * Gets or sets the color of the loading bar, default is [[Color.White]]\r\n         */\r\n        this.loadingBarColor = Color.White;\r\n        /**\r\n         * Gets or sets the background color of the loader as a hex string\r\n         */\r\n        this.backgroundColor = '#176BAA';\r\n        this.suppressPlayButton = false;\r\n        /** Loads the css from Loader.css */\r\n        this._playButtonStyles = Loader_0/* default.toString */.Z.toString();\r\n        /**\r\n         * Get/set play button text\r\n         */\r\n        this.playButtonText = 'Play game';\r\n        /**\r\n         * Return a html button element for excalibur to use as a play button\r\n         */\r\n        this.startButtonFactory = () => {\r\n            let buttonElement = document.getElementById('excalibur-play');\r\n            if (!buttonElement) {\r\n                buttonElement = document.createElement('button');\r\n            }\r\n            buttonElement.id = 'excalibur-play';\r\n            buttonElement.textContent = this.playButtonText;\r\n            buttonElement.style.display = 'none';\r\n            return buttonElement;\r\n        };\r\n        this._loadingFuture = new Future();\r\n        if (loadables) {\r\n            this.addResources(loadables);\r\n        }\r\n    }\r\n    get _image() {\r\n        if (!this._imageElement) {\r\n            this._imageElement = new Image();\r\n            this._imageElement.src = this.logo;\r\n        }\r\n        return this._imageElement;\r\n    }\r\n    get playButtonRootElement() {\r\n        return this._playButtonRootElement;\r\n    }\r\n    get playButtonElement() {\r\n        return this._playButtonElement;\r\n    }\r\n    get _playButton() {\r\n        const existingRoot = document.getElementById('excalibur-play-root');\r\n        if (existingRoot) {\r\n            this._playButtonRootElement = existingRoot;\r\n        }\r\n        if (!this._playButtonRootElement) {\r\n            this._playButtonRootElement = document.createElement('div');\r\n            this._playButtonRootElement.id = 'excalibur-play-root';\r\n            this._playButtonRootElement.style.position = 'absolute';\r\n            document.body.appendChild(this._playButtonRootElement);\r\n        }\r\n        if (!this._styleBlock) {\r\n            this._styleBlock = document.createElement('style');\r\n            this._styleBlock.textContent = this._playButtonStyles;\r\n            document.head.appendChild(this._styleBlock);\r\n        }\r\n        if (!this._playButtonElement) {\r\n            this._playButtonElement = this.startButtonFactory();\r\n            this._playButtonRootElement.appendChild(this._playButtonElement);\r\n        }\r\n        return this._playButtonElement;\r\n    }\r\n    wireEngine(engine) {\r\n        this._engine = engine;\r\n        this.canvas.width = this._engine.canvas.width;\r\n        this.canvas.height = this._engine.canvas.height;\r\n    }\r\n    /**\r\n     * Add a resource to the loader to load\r\n     * @param loadable  Resource to add\r\n     */\r\n    addResource(loadable) {\r\n        const key = this._index++;\r\n        this._resourceList.push(loadable);\r\n        this._progressCounts[key] = 0;\r\n        this._totalCounts[key] = 1;\r\n        this._resourceCount++;\r\n    }\r\n    /**\r\n     * Add a list of resources to the loader to load\r\n     * @param loadables  The list of resources to load\r\n     */\r\n    addResources(loadables) {\r\n        let i = 0;\r\n        const len = loadables.length;\r\n        for (i; i < len; i++) {\r\n            this.addResource(loadables[i]);\r\n        }\r\n    }\r\n    /**\r\n     * Returns true if the loader has completely loaded all resources\r\n     */\r\n    isLoaded() {\r\n        return this._numLoaded === this._resourceCount;\r\n    }\r\n    /**\r\n     * Shows the play button and returns a promise that resolves when clicked\r\n     */\r\n    async showPlayButton() {\r\n        var _a, _b;\r\n        if (this.suppressPlayButton) {\r\n            this.hidePlayButton();\r\n            // Delay is to give the logo a chance to show, otherwise don't delay\r\n            await delay(500, (_a = this._engine) === null || _a === void 0 ? void 0 : _a.clock);\r\n        }\r\n        else {\r\n            const resizeHandler = () => {\r\n                this._positionPlayButton();\r\n            };\r\n            if ((_b = this._engine) === null || _b === void 0 ? void 0 : _b.browser) {\r\n                this._engine.browser.window.on('resize', resizeHandler);\r\n            }\r\n            this._playButtonShown = true;\r\n            this._playButton.style.display = 'block';\r\n            document.body.addEventListener('keyup', (evt) => {\r\n                if (evt.key === 'Enter') {\r\n                    this._playButton.click();\r\n                }\r\n            });\r\n            this._positionPlayButton();\r\n            const playButtonClicked = new Promise((resolve) => {\r\n                const startButtonHandler = (e) => {\r\n                    var _a;\r\n                    // We want to stop propagation to keep bubbling to the engine pointer handlers\r\n                    e.stopPropagation();\r\n                    // Hide Button after click\r\n                    this.hidePlayButton();\r\n                    if ((_a = this._engine) === null || _a === void 0 ? void 0 : _a.browser) {\r\n                        this._engine.browser.window.off('resize', resizeHandler);\r\n                    }\r\n                    resolve();\r\n                };\r\n                this._playButton.addEventListener('click', startButtonHandler);\r\n                this._playButton.addEventListener('touchend', startButtonHandler);\r\n                this._playButton.addEventListener('pointerup', startButtonHandler);\r\n            });\r\n            return await playButtonClicked;\r\n        }\r\n    }\r\n    hidePlayButton() {\r\n        this._playButtonShown = false;\r\n        this._playButton.style.display = 'none';\r\n    }\r\n    /**\r\n     * Clean up generated elements for the loader\r\n     */\r\n    dispose() {\r\n        if (this._playButtonRootElement.parentElement) {\r\n            this._playButtonRootElement.removeChild(this._playButtonElement);\r\n            document.body.removeChild(this._playButtonRootElement);\r\n            document.head.removeChild(this._styleBlock);\r\n            this._playButtonRootElement = null;\r\n            this._playButtonElement = null;\r\n            this._styleBlock = null;\r\n        }\r\n    }\r\n    update(_engine, _delta) {\r\n        // override me\r\n    }\r\n    areResourcesLoaded() {\r\n        return this._loadingFuture.promise;\r\n    }\r\n    /**\r\n     * Begin loading all of the supplied resources, returning a promise\r\n     * that resolves when loading of all is complete AND the user has clicked the \"Play button\"\r\n     */\r\n    async load() {\r\n        var _a, _b;\r\n        await ((_a = this._image) === null || _a === void 0 ? void 0 : _a.decode()); // decode logo if it exists\r\n        this.canvas.flagDirty();\r\n        await Promise.all(this._resourceList.map(async (r) => {\r\n            await r.load().finally(() => {\r\n                // capture progress\r\n                this._numLoaded++;\r\n                this.canvas.flagDirty();\r\n            });\r\n        }));\r\n        // Wire all sound to the engine\r\n        for (const resource of this._resourceList) {\r\n            if (resource instanceof Sound) {\r\n                resource.wireEngine(this._engine);\r\n            }\r\n        }\r\n        this._loadingFuture.resolve();\r\n        // short delay in showing the button for aesthetics\r\n        await delay(200, (_b = this._engine) === null || _b === void 0 ? void 0 : _b.clock);\r\n        this.canvas.flagDirty();\r\n        await this.showPlayButton();\r\n        // Unlock browser AudioContext in after user gesture\r\n        // See: https://github.com/excaliburjs/Excalibur/issues/262\r\n        // See: https://github.com/excaliburjs/Excalibur/issues/1031\r\n        await WebAudio.unlock();\r\n        return (this.data = this._resourceList);\r\n    }\r\n    markResourceComplete() {\r\n        this._numLoaded++;\r\n    }\r\n    /**\r\n     * Returns the progress of the loader as a number between [0, 1] inclusive.\r\n     */\r\n    get progress() {\r\n        return this._resourceCount > 0 ? clamp(this._numLoaded, 0, this._resourceCount) / this._resourceCount : 1;\r\n    }\r\n    _positionPlayButton() {\r\n        if (this._engine) {\r\n            const screenHeight = this._engine.screen.viewport.height;\r\n            const screenWidth = this._engine.screen.viewport.width;\r\n            if (this._playButtonRootElement) {\r\n                const left = this._engine.canvas.offsetLeft;\r\n                const top = this._engine.canvas.offsetTop;\r\n                const buttonWidth = this._playButton.clientWidth;\r\n                const buttonHeight = this._playButton.clientHeight;\r\n                if (this.playButtonPosition) {\r\n                    this._playButtonRootElement.style.left = `${this.playButtonPosition.x}px`;\r\n                    this._playButtonRootElement.style.top = `${this.playButtonPosition.y}px`;\r\n                }\r\n                else {\r\n                    this._playButtonRootElement.style.left = `${left + screenWidth / 2 - buttonWidth / 2}px`;\r\n                    this._playButtonRootElement.style.top = `${top + screenHeight / 2 - buttonHeight / 2 + 100}px`;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Loader draw function. Draws the default Excalibur loading screen.\r\n     * Override `logo`, `logoWidth`, `logoHeight` and `backgroundColor` properties\r\n     * to customize the drawing, or just override entire method.\r\n     */\r\n    draw(ctx) {\r\n        const canvasHeight = this._engine.canvasHeight / this._engine.pixelRatio;\r\n        const canvasWidth = this._engine.canvasWidth / this._engine.pixelRatio;\r\n        this._positionPlayButton();\r\n        ctx.fillStyle = this.backgroundColor;\r\n        ctx.fillRect(0, 0, canvasWidth, canvasHeight);\r\n        let logoY = canvasHeight / 2;\r\n        const width = Math.min(this.logoWidth, canvasWidth * 0.75);\r\n        let logoX = canvasWidth / 2 - width / 2;\r\n        if (this.logoPosition) {\r\n            logoX = this.logoPosition.x;\r\n            logoY = this.logoPosition.y;\r\n        }\r\n        const imageHeight = Math.floor(width * (this.logoHeight / this.logoWidth)); // OG height/width factor\r\n        const oldAntialias = this._engine.getAntialiasing();\r\n        this._engine.setAntialiasing(true);\r\n        if (!this.logoPosition) {\r\n            ctx.drawImage(this._image, 0, 0, this.logoWidth, this.logoHeight, logoX, logoY - imageHeight - 20, width, imageHeight);\r\n        }\r\n        else {\r\n            ctx.drawImage(this._image, 0, 0, this.logoWidth, this.logoHeight, logoX, logoY, width, imageHeight);\r\n        }\r\n        // loading box\r\n        if (!this.suppressPlayButton && this._playButtonShown) {\r\n            this._engine.setAntialiasing(oldAntialias);\r\n            return;\r\n        }\r\n        let loadingX = logoX;\r\n        let loadingY = logoY;\r\n        if (this.loadingBarPosition) {\r\n            loadingX = this.loadingBarPosition.x;\r\n            loadingY = this.loadingBarPosition.y;\r\n        }\r\n        ctx.lineWidth = 2;\r\n        roundRect(ctx, loadingX, loadingY, width, 20, 10, this.loadingBarColor);\r\n        const progress = width * this.progress;\r\n        const margin = 5;\r\n        const progressWidth = progress - margin * 2;\r\n        const height = 20 - margin * 2;\r\n        roundRect(ctx, loadingX + margin, loadingY + margin, progressWidth > 10 ? progressWidth : 10, height, 5, null, this.loadingBarColor);\r\n        this._engine.setAntialiasing(oldAntialias);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Detector.ts\n\r\n/**\r\n * This is the list of features that will be used to log the supported\r\n * features to the console when Detector.logBrowserFeatures() is called.\r\n */\r\nconst REPORTED_FEATURES = {\r\n    webgl: 'WebGL',\r\n    webaudio: 'WebAudio',\r\n    gamepadapi: 'Gamepad API'\r\n};\r\n/**\r\n * Excalibur internal feature detection helper class\r\n */\r\nclass Detector {\r\n    constructor() {\r\n        this._features = null;\r\n        this.failedTests = [];\r\n        // critical browser features required for ex to run\r\n        this._criticalTests = {\r\n            // Test canvas/2d context support\r\n            canvasSupport: function () {\r\n                const elem = document.createElement('canvas');\r\n                return !!(elem.getContext && elem.getContext('2d'));\r\n            },\r\n            // Test array buffer support ex uses for downloading binary data\r\n            arrayBufferSupport: function () {\r\n                const xhr = new XMLHttpRequest();\r\n                xhr.open('GET', '/');\r\n                try {\r\n                    xhr.responseType = 'arraybuffer';\r\n                }\r\n                catch (e) {\r\n                    return false;\r\n                }\r\n                return xhr.responseType === 'arraybuffer';\r\n            },\r\n            // Test data urls ex uses for sprites\r\n            dataUrlSupport: function () {\r\n                const canvas = document.createElement('canvas');\r\n                return canvas.toDataURL('image/png').indexOf('data:image/png') === 0;\r\n            },\r\n            // Test object url support for loading\r\n            objectUrlSupport: function () {\r\n                return 'URL' in window && 'revokeObjectURL' in URL && 'createObjectURL' in URL;\r\n            },\r\n            // RGBA support for colors\r\n            rgbaSupport: function () {\r\n                const style = document.createElement('a').style;\r\n                style.cssText = 'background-color:rgba(150,255,150,.5)';\r\n                return ('' + style.backgroundColor).indexOf('rgba') > -1;\r\n            }\r\n        };\r\n        // warnings excalibur performance will be degraded\r\n        this._warningTest = {\r\n            webAudioSupport: function () {\r\n                return !!(window.AudioContext ||\r\n                    window.webkitAudioContext ||\r\n                    window.mozAudioContext ||\r\n                    window.msAudioContext ||\r\n                    window.oAudioContext);\r\n            },\r\n            webglSupport: function () {\r\n                const elem = document.createElement('canvas');\r\n                return !!(elem.getContext && elem.getContext('webgl'));\r\n            }\r\n        };\r\n        this._features = this._loadBrowserFeatures();\r\n    }\r\n    /**\r\n     * Returns a map of currently supported browser features. This method\r\n     * treats the features as a singleton and will only calculate feature\r\n     * support if it has not previously been done.\r\n     */\r\n    getBrowserFeatures() {\r\n        if (this._features === null) {\r\n            this._features = this._loadBrowserFeatures();\r\n        }\r\n        return this._features;\r\n    }\r\n    /**\r\n     * Report on non-critical browser support for debugging purposes.\r\n     * Use native browser console colors for visibility.\r\n     */\r\n    logBrowserFeatures() {\r\n        let msg = '%cSUPPORTED BROWSER FEATURES\\n==========================%c\\n';\r\n        const args = ['font-weight: bold; color: navy', 'font-weight: normal; color: inherit'];\r\n        const supported = this.getBrowserFeatures();\r\n        for (const feature of Object.keys(REPORTED_FEATURES)) {\r\n            if (supported[feature]) {\r\n                msg += '(%c\\u2713%c)'; // (✓)\r\n                args.push('font-weight: bold; color: green');\r\n                args.push('font-weight: normal; color: inherit');\r\n            }\r\n            else {\r\n                msg += '(%c\\u2717%c)'; // (✗)\r\n                args.push('font-weight: bold; color: red');\r\n                args.push('font-weight: normal; color: inherit');\r\n            }\r\n            msg += ' ' + REPORTED_FEATURES[feature] + '\\n';\r\n        }\r\n        args.unshift(msg);\r\n        // eslint-disable-next-line no-console\r\n        console.log.apply(console, args);\r\n    }\r\n    /**\r\n     * Executes several IIFE's to get a constant reference to supported\r\n     * features within the current execution context.\r\n     */\r\n    _loadBrowserFeatures() {\r\n        return {\r\n            // IIFE to check canvas support\r\n            canvas: (() => {\r\n                return this._criticalTests.canvasSupport();\r\n            })(),\r\n            // IIFE to check arraybuffer support\r\n            arraybuffer: (() => {\r\n                return this._criticalTests.arrayBufferSupport();\r\n            })(),\r\n            // IIFE to check dataurl support\r\n            dataurl: (() => {\r\n                return this._criticalTests.dataUrlSupport();\r\n            })(),\r\n            // IIFE to check objecturl support\r\n            objecturl: (() => {\r\n                return this._criticalTests.objectUrlSupport();\r\n            })(),\r\n            // IIFE to check rgba support\r\n            rgba: (() => {\r\n                return this._criticalTests.rgbaSupport();\r\n            })(),\r\n            // IIFE to check webaudio support\r\n            webaudio: (() => {\r\n                return this._warningTest.webAudioSupport();\r\n            })(),\r\n            // IIFE to check webgl support\r\n            webgl: (() => {\r\n                return this._warningTest.webglSupport();\r\n            })(),\r\n            // IIFE to check gamepadapi support\r\n            gamepadapi: (() => {\r\n                return !!navigator.getGamepads;\r\n            })()\r\n        };\r\n    }\r\n    test() {\r\n        // Critical test will for ex not to run\r\n        let failedCritical = false;\r\n        for (const test in this._criticalTests) {\r\n            if (!this._criticalTests[test].call(this)) {\r\n                this.failedTests.push(test);\r\n                Logger.getInstance().error('Critical browser feature missing, Excalibur requires:', test);\r\n                failedCritical = true;\r\n            }\r\n        }\r\n        if (failedCritical) {\r\n            return false;\r\n        }\r\n        // Warning tests do not for ex to return false to compatibility\r\n        for (const warning in this._warningTest) {\r\n            if (!this._warningTest[warning]()) {\r\n                Logger.getInstance().warn('Warning browser feature missing, Excalibur will have reduced performance:', warning);\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/CollisionType.ts\n/**\r\n * An enum that describes the types of collisions bodies can participate in\r\n */\r\nvar CollisionType;\r\n(function (CollisionType) {\r\n    /**\r\n     * Bodies with the `PreventCollision` setting do not participate in any\r\n     * collisions and do not raise collision events.\r\n     */\r\n    CollisionType[\"PreventCollision\"] = \"PreventCollision\";\r\n    /**\r\n     * Bodies with the `Passive` setting only raise collision events, but are not\r\n     * influenced or moved by other bodies and do not influence or move other bodies.\r\n     * This is useful for use in trigger type behavior.\r\n     */\r\n    CollisionType[\"Passive\"] = \"Passive\";\r\n    /**\r\n     * Bodies with the `Active` setting raise collision events and participate\r\n     * in collisions with other bodies and will be push or moved by bodies sharing\r\n     * the `Active` or `Fixed` setting.\r\n     */\r\n    CollisionType[\"Active\"] = \"Active\";\r\n    /**\r\n     * Bodies with the `Fixed` setting raise collision events and participate in\r\n     * collisions with other bodies. Actors with the `Fixed` setting will not be\r\n     * pushed or moved by other bodies sharing the `Fixed`. Think of Fixed\r\n     * bodies as \"immovable/unstoppable\" objects. If two `Fixed` bodies meet they will\r\n     * not be pushed or moved by each other, they will not interact except to throw\r\n     * collision events.\r\n     */\r\n    CollisionType[\"Fixed\"] = \"Fixed\";\r\n})(CollisionType || (CollisionType = {}));\r\n\n;// CONCATENATED MODULE: ./Util/Decorators.ts\n\r\n\r\nconst maxMessages = 5;\r\nconst obsoleteMessage = {};\r\nconst resetObsoleteCounter = () => {\r\n    for (const message in obsoleteMessage) {\r\n        obsoleteMessage[message] = 0;\r\n    }\r\n};\r\nconst logMessage = (message, options) => {\r\n    const suppressObsoleteMessages = Flags.isEnabled('suppress-obsolete-message');\r\n    if (obsoleteMessage[message] < maxMessages && !suppressObsoleteMessages) {\r\n        Logger.getInstance().warn(message);\r\n        // tslint:disable-next-line: no-console\r\n        if (console.trace && options.showStackTrace) {\r\n            // tslint:disable-next-line: no-console\r\n            console.trace();\r\n        }\r\n    }\r\n    obsoleteMessage[message]++;\r\n};\r\n/**\r\n * Obsolete decorator for marking Excalibur methods obsolete, you can optionally specify a custom message and/or alternate replacement\r\n * method do the deprecated one. Inspired by https://github.com/jayphelps/core-decorators.js\r\n */\r\nfunction obsolete(options) {\r\n    options = {\r\n        message: 'This feature will be removed in future versions of Excalibur.',\r\n        alternateMethod: null,\r\n        showStackTrace: false,\r\n        ...options\r\n    };\r\n    return function (target, property, descriptor) {\r\n        if (descriptor &&\r\n            !(typeof descriptor.value === 'function' || typeof descriptor.get === 'function' || typeof descriptor.set === 'function')) {\r\n            throw new SyntaxError('Only classes/functions/getters/setters can be marked as obsolete');\r\n        }\r\n        const methodSignature = `${target.name || ''}${target.name && property ? '.' : ''}${property ? property : ''}`;\r\n        const message = `${methodSignature} is marked obsolete: ${options.message}` +\r\n            (options.alternateMethod ? ` Use ${options.alternateMethod} instead` : '');\r\n        if (!obsoleteMessage[message]) {\r\n            obsoleteMessage[message] = 0;\r\n        }\r\n        // If descriptor is null it is a class\r\n        const method = descriptor ? { ...descriptor } : target;\r\n        if (!descriptor) {\r\n            // with es2015 classes we need to change our decoration tactic\r\n            class DecoratedClass extends method {\r\n                constructor(...args) {\r\n                    logMessage(message, options);\r\n                    super(...args);\r\n                }\r\n            }\r\n            return DecoratedClass;\r\n        }\r\n        if (descriptor && descriptor.value) {\r\n            method.value = function () {\r\n                logMessage(message, options);\r\n                return descriptor.value.apply(this, arguments);\r\n            };\r\n            return method;\r\n        }\r\n        if (descriptor && descriptor.get) {\r\n            method.get = function () {\r\n                logMessage(message, options);\r\n                return descriptor.get.apply(this, arguments);\r\n            };\r\n        }\r\n        if (descriptor && descriptor.set) {\r\n            method.set = function () {\r\n                logMessage(message, options);\r\n                return descriptor.set.apply(this, arguments);\r\n            };\r\n        }\r\n        return method;\r\n    };\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Physics.ts\nvar __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\n\r\n/**\r\n * Possible collision resolution strategies\r\n *\r\n * The default is [[CollisionResolutionStrategy.Arcade]] which performs simple axis aligned arcade style physics. This is useful for things\r\n * like platformers or top down games.\r\n *\r\n * More advanced rigid body physics are enabled by setting [[CollisionResolutionStrategy.Realistic]] which allows for complicated\r\n * simulated physical interactions.\r\n */\r\nvar CollisionResolutionStrategy;\r\n(function (CollisionResolutionStrategy) {\r\n    CollisionResolutionStrategy[\"Arcade\"] = \"arcade\";\r\n    CollisionResolutionStrategy[\"Realistic\"] = \"realistic\";\r\n})(CollisionResolutionStrategy || (CollisionResolutionStrategy = {}));\r\n/**\r\n * Possible broadphase collision pair identification strategies\r\n *\r\n * The default strategy is [[BroadphaseStrategy.DynamicAABBTree]] which uses a binary tree of axis-aligned bounding boxes to identify\r\n * potential collision pairs which is O(nlog(n)) faster.\r\n */\r\nvar BroadphaseStrategy;\r\n(function (BroadphaseStrategy) {\r\n    BroadphaseStrategy[BroadphaseStrategy[\"DynamicAABBTree\"] = 0] = \"DynamicAABBTree\";\r\n})(BroadphaseStrategy || (BroadphaseStrategy = {}));\r\n/**\r\n * Possible numerical integrators for position and velocity\r\n */\r\nvar Integrator;\r\n(function (Integrator) {\r\n    Integrator[Integrator[\"Euler\"] = 0] = \"Euler\";\r\n})(Integrator || (Integrator = {}));\r\n/**\r\n * The [[Physics]] object is the global configuration object for all Excalibur physics.\r\n */\r\n/* istanbul ignore next */\r\nclass Physics {\r\n    static get gravity() {\r\n        return Physics.acc;\r\n    }\r\n    static set gravity(v) {\r\n        Physics.acc = v;\r\n    }\r\n    /**\r\n     * Configures Excalibur to use \"arcade\" physics. Arcade physics which performs simple axis aligned arcade style physics.\r\n     */\r\n    static useArcadePhysics() {\r\n        Physics.collisionResolutionStrategy = CollisionResolutionStrategy.Arcade;\r\n    }\r\n    /**\r\n     * Configures Excalibur to use rigid body physics. Rigid body physics allows for complicated\r\n     * simulated physical interactions.\r\n     */\r\n    static useRealisticPhysics() {\r\n        Physics.collisionResolutionStrategy = CollisionResolutionStrategy.Realistic;\r\n    }\r\n    static get dynamicTreeVelocityMultiplyer() {\r\n        return Physics.dynamicTreeVelocityMultiplier;\r\n    }\r\n    static set dynamicTreeVelocityMultiplyer(value) {\r\n        Physics.dynamicTreeVelocityMultiplier = value;\r\n    }\r\n}\r\n/**\r\n * Global acceleration that is applied to all vanilla actors that have a [[CollisionType.Active|active]] collision type.\r\n * Global acceleration won't effect [[Label|labels]], [[ScreenElement|ui actors]], or [[Trigger|triggers]] in Excalibur.\r\n *\r\n * This is a great way to globally simulate effects like gravity.\r\n */\r\nPhysics.acc = new Vector(0, 0);\r\n/**\r\n * Globally switches all Excalibur physics behavior on or off.\r\n */\r\nPhysics.enabled = true;\r\n/**\r\n * Gets or sets the broadphase pair identification strategy.\r\n *\r\n * The default strategy is [[BroadphaseStrategy.DynamicAABBTree]] which uses a binary tree of axis-aligned bounding boxes to identify\r\n * potential collision pairs which is O(nlog(n)) faster.\r\n */\r\nPhysics.broadphaseStrategy = BroadphaseStrategy.DynamicAABBTree;\r\n/**\r\n * Gets or sets the global collision resolution strategy (narrowphase).\r\n *\r\n * The default is [[CollisionResolutionStrategy.Arcade]] which performs simple axis aligned arcade style physics.\r\n *\r\n * More advanced rigid body physics are enabled by setting [[CollisionResolutionStrategy.Realistic]] which allows for complicated\r\n * simulated physical interactions.\r\n */\r\nPhysics.collisionResolutionStrategy = CollisionResolutionStrategy.Arcade;\r\n/**\r\n * The default mass to use if none is specified\r\n */\r\nPhysics.defaultMass = 10;\r\n/**\r\n * Gets or sets the position and velocity positional integrator, currently only Euler is supported.\r\n */\r\nPhysics.integrator = Integrator.Euler;\r\n/**\r\n * Factor to add to the RigidBody BoundingBox, bounding box (dimensions += vel * dynamicTreeVelocityMultiplier);\r\n */\r\nPhysics.dynamicTreeVelocityMultiplier = 2;\r\n/**\r\n * Pad RigidBody BoundingBox by a constant amount\r\n */\r\nPhysics.boundsPadding = 5;\r\n/**\r\n * Number of position iterations (overlap) to run in the solver\r\n */\r\nPhysics.positionIterations = 3;\r\n/**\r\n * Number of velocity iteration (response) to run in the solver\r\n */\r\nPhysics.velocityIterations = 8;\r\n/**\r\n * Amount of overlap to tolerate in pixels\r\n */\r\nPhysics.slop = 1;\r\n/**\r\n * Amount of positional overlap correction to apply each position iteration of the solver\r\n * O - meaning no correction, 1 - meaning correct all overlap\r\n */\r\nPhysics.steeringFactor = 0.2;\r\n/**\r\n * Warm start set to true re-uses impulses from previous frames back in the solver\r\n */\r\nPhysics.warmStart = true;\r\n/**\r\n * By default bodies do not sleep\r\n */\r\nPhysics.bodiesCanSleepByDefault = false;\r\n/**\r\n * Surface epsilon is used to help deal with surface penetration\r\n */\r\nPhysics.surfaceEpsilon = 0.1;\r\nPhysics.sleepEpsilon = 0.07;\r\nPhysics.wakeThreshold = Physics.sleepEpsilon * 3;\r\nPhysics.sleepBias = 0.9;\r\n/**\r\n * Enable fast moving body checking, this enables checking for collision pairs via raycast for fast moving objects to prevent\r\n * bodies from tunneling through one another.\r\n */\r\nPhysics.checkForFastBodies = true;\r\n/**\r\n * Disable minimum fast moving body raycast, by default if ex.Physics.checkForFastBodies = true Excalibur will only check if the\r\n * body is moving at least half of its minimum dimension in an update. If ex.Physics.disableMinimumSpeedForFastBody is set to true,\r\n * Excalibur will always perform the fast body raycast regardless of speed.\r\n */\r\nPhysics.disableMinimumSpeedForFastBody = false;\r\n__decorate([\r\n    obsolete({\r\n        message: 'Alias for incorrect spelling used in older versions, will be removed in v0.25.0',\r\n        alternateMethod: 'dynamicTreeVelocityMultiplier'\r\n    })\r\n], Physics, \"dynamicTreeVelocityMultiplyer\", null);\r\n\n;// CONCATENATED MODULE: ./Math/coord-plane.ts\n/**\r\n * Enum representing the coordinate plane for the position 2D vector in the [[TransformComponent]]\r\n */\r\nvar CoordPlane;\r\n(function (CoordPlane) {\r\n    /**\r\n     * The world coordinate plane (default) represents world space, any entities drawn with world\r\n     * space move when the camera moves.\r\n     */\r\n    CoordPlane[\"World\"] = \"world\";\r\n    /**\r\n     * The screen coordinate plane represents screen space, entities drawn in screen space are pinned\r\n     * to screen coordinates ignoring the camera.\r\n     */\r\n    CoordPlane[\"Screen\"] = \"screen\";\r\n})(CoordPlane || (CoordPlane = {}));\r\n\n;// CONCATENATED MODULE: ./Math/vector-view.ts\n\r\nclass VectorView extends Vector {\r\n    constructor(options) {\r\n        super(0, 0);\r\n        this._getX = options.getX;\r\n        this._getY = options.getY;\r\n        this._setX = options.setX;\r\n        this._setY = options.setY;\r\n    }\r\n    get x() {\r\n        return (this._x = this._getX());\r\n    }\r\n    set x(val) {\r\n        this._setX(val);\r\n        this._x = val;\r\n    }\r\n    get y() {\r\n        return (this._y = this._getY());\r\n    }\r\n    set y(val) {\r\n        this._setY(val);\r\n        this._y = val;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/watch-vector.ts\n\r\n/**\r\n * Wraps a vector and watches for changes in the x/y, modifies the original vector.\r\n */\r\nclass WatchVector extends Vector {\r\n    constructor(original, change) {\r\n        super(original.x, original.y);\r\n        this.original = original;\r\n        this.change = change;\r\n    }\r\n    get x() {\r\n        return this._x = this.original.x;\r\n    }\r\n    set x(newX) {\r\n        this.change(newX, this._y);\r\n        this._x = this.original.x = newX;\r\n    }\r\n    get y() {\r\n        return this._y = this.original.y;\r\n    }\r\n    set y(newY) {\r\n        this.change(this._x, newY);\r\n        this._y = this.original.y = newY;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/transform.ts\n\r\n\r\n\r\n\r\n\r\nclass Transform {\r\n    constructor() {\r\n        this._parent = null;\r\n        this._children = [];\r\n        this._pos = vec(0, 0);\r\n        this._rotation = 0;\r\n        this._scale = vec(1, 1);\r\n        this._isDirty = false;\r\n        this._isInverseDirty = false;\r\n        this._matrix = AffineMatrix.identity();\r\n        this._inverse = AffineMatrix.identity();\r\n    }\r\n    get parent() {\r\n        return this._parent;\r\n    }\r\n    set parent(transform) {\r\n        if (this._parent) {\r\n            const index = this._parent._children.indexOf(this);\r\n            if (index > -1) {\r\n                this._parent._children.splice(index, 1);\r\n            }\r\n        }\r\n        this._parent = transform;\r\n        if (this._parent) {\r\n            this._parent._children.push(this);\r\n        }\r\n        this.flagDirty();\r\n    }\r\n    get children() {\r\n        return this._children;\r\n    }\r\n    set pos(v) {\r\n        if (!v.equals(this._pos)) {\r\n            this._pos.x = v.x;\r\n            this._pos.y = v.y;\r\n            this.flagDirty();\r\n        }\r\n    }\r\n    get pos() {\r\n        return new WatchVector(this._pos, (x, y) => {\r\n            if (x !== this._pos.x || y !== this._pos.y) {\r\n                this.flagDirty();\r\n            }\r\n        });\r\n    }\r\n    set globalPos(v) {\r\n        let localPos = v.clone();\r\n        if (this.parent) {\r\n            localPos = this.parent.inverse.multiply(v);\r\n        }\r\n        if (!localPos.equals(this._pos)) {\r\n            this._pos = localPos;\r\n            this.flagDirty();\r\n        }\r\n    }\r\n    get globalPos() {\r\n        return new VectorView({\r\n            getX: () => this.matrix.data[4],\r\n            getY: () => this.matrix.data[5],\r\n            setX: (x) => {\r\n                if (this.parent) {\r\n                    const { x: newX } = this.parent.inverse.multiply(vec(x, this.pos.y));\r\n                    this.pos.x = newX;\r\n                }\r\n                else {\r\n                    this.pos.x = x;\r\n                }\r\n                if (x !== this.matrix.data[4]) {\r\n                    this.flagDirty();\r\n                }\r\n            },\r\n            setY: (y) => {\r\n                if (this.parent) {\r\n                    const { y: newY } = this.parent.inverse.multiply(vec(this.pos.x, y));\r\n                    this.pos.y = newY;\r\n                }\r\n                else {\r\n                    this.pos.y = y;\r\n                }\r\n                if (y !== this.matrix.data[5]) {\r\n                    this.flagDirty();\r\n                }\r\n            }\r\n        });\r\n    }\r\n    set rotation(rotation) {\r\n        const canonRotation = canonicalizeAngle(rotation);\r\n        if (canonRotation !== this._rotation) {\r\n            this.flagDirty();\r\n        }\r\n        this._rotation = canonRotation;\r\n    }\r\n    get rotation() {\r\n        return this._rotation;\r\n    }\r\n    set globalRotation(rotation) {\r\n        let inverseRotation = 0;\r\n        if (this.parent) {\r\n            inverseRotation = this.parent.globalRotation;\r\n        }\r\n        const canonRotation = canonicalizeAngle(rotation + inverseRotation);\r\n        if (canonRotation !== this._rotation) {\r\n            this.flagDirty();\r\n        }\r\n        this._rotation = canonRotation;\r\n    }\r\n    get globalRotation() {\r\n        if (this.parent) {\r\n            return this.matrix.getRotation();\r\n        }\r\n        return this.rotation;\r\n    }\r\n    set scale(v) {\r\n        if (!v.equals(this._scale)) {\r\n            this._scale.x = v.x;\r\n            this._scale.y = v.y;\r\n            this.flagDirty();\r\n        }\r\n    }\r\n    get scale() {\r\n        return new WatchVector(this._scale, (x, y) => {\r\n            if (x !== this._scale.x || y !== this._scale.y) {\r\n                this.flagDirty();\r\n            }\r\n        });\r\n    }\r\n    set globalScale(v) {\r\n        let inverseScale = vec(1, 1);\r\n        if (this.parent) {\r\n            inverseScale = this.parent.globalScale;\r\n        }\r\n        this.scale = v.scale(vec(1 / inverseScale.x, 1 / inverseScale.y));\r\n    }\r\n    get globalScale() {\r\n        return new VectorView({\r\n            getX: () => this.parent ? this.matrix.getScaleX() : this.scale.x,\r\n            getY: () => this.parent ? this.matrix.getScaleY() : this.scale.y,\r\n            setX: (x) => {\r\n                if (this.parent) {\r\n                    const globalScaleX = this.parent.globalScale.x;\r\n                    this.scale.x = x / globalScaleX;\r\n                }\r\n                else {\r\n                    this.scale.x = x;\r\n                }\r\n            },\r\n            setY: (y) => {\r\n                if (this.parent) {\r\n                    const globalScaleY = this.parent.globalScale.y;\r\n                    this.scale.y = y / globalScaleY;\r\n                }\r\n                else {\r\n                    this.scale.y = y;\r\n                }\r\n            }\r\n        });\r\n    }\r\n    get matrix() {\r\n        if (this._isDirty) {\r\n            if (this.parent === null) {\r\n                this._matrix = this._calculateMatrix();\r\n            }\r\n            else {\r\n                this._matrix = this.parent.matrix.multiply(this._calculateMatrix());\r\n            }\r\n            this._isDirty = false;\r\n        }\r\n        return this._matrix;\r\n    }\r\n    get inverse() {\r\n        if (this._isInverseDirty) {\r\n            this._inverse = this.matrix.inverse();\r\n            this._isInverseDirty = false;\r\n        }\r\n        return this._inverse;\r\n    }\r\n    _calculateMatrix() {\r\n        const matrix = AffineMatrix.identity()\r\n            .translate(this.pos.x, this.pos.y)\r\n            .rotate(this.rotation)\r\n            .scale(this.scale.x, this.scale.y);\r\n        return matrix;\r\n    }\r\n    flagDirty() {\r\n        this._isDirty = true;\r\n        this._isInverseDirty = true;\r\n        for (let i = 0; i < this._children.length; i++) {\r\n            this._children[i].flagDirty();\r\n        }\r\n    }\r\n    apply(point) {\r\n        return this.matrix.multiply(point);\r\n    }\r\n    applyInverse(point) {\r\n        return this.inverse.multiply(point);\r\n    }\r\n    setTransform(pos, rotation, scale) {\r\n        this._pos.x = pos.x;\r\n        this._pos.y = pos.y;\r\n        this._rotation = canonicalizeAngle(rotation);\r\n        this._scale.x = scale.x;\r\n        this._scale.y = scale.y;\r\n        this.flagDirty();\r\n    }\r\n    clone(dest) {\r\n        const target = dest !== null && dest !== void 0 ? dest : new Transform();\r\n        this._pos.clone(target._pos);\r\n        target._rotation = this._rotation;\r\n        this._scale.clone(target._scale);\r\n        target.flagDirty();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/Component.ts\n/**\r\n * Type guard to check if a component implements clone\r\n * @param x\r\n */\r\nfunction hasClone(x) {\r\n    return !!(x === null || x === void 0 ? void 0 : x.clone);\r\n}\r\n/**\r\n * Components are containers for state in Excalibur, the are meant to convey capabilities that an Entity possesses\r\n *\r\n * Implementations of Component must have a zero-arg constructor to support dependencies\r\n *\r\n * ```typescript\r\n * class MyComponent extends ex.Component<'my'> {\r\n *   public readonly type = 'my';\r\n *   // zero arg support required if you want to use component dependencies\r\n *   constructor(public optionalPos?: ex.Vector) {}\r\n * }\r\n * ```\r\n */\r\nclass Component {\r\n    constructor() {\r\n        /**\r\n         * Current owning [[Entity]], if any, of this component. Null if not added to any [[Entity]]\r\n         */\r\n        this.owner = null;\r\n    }\r\n    /**\r\n     * Clones any properties on this component, if that property value has a `clone()` method it will be called\r\n     */\r\n    clone() {\r\n        const newComponent = new this.constructor();\r\n        for (const prop in this) {\r\n            if (this.hasOwnProperty(prop)) {\r\n                const val = this[prop];\r\n                if (hasClone(val) && prop !== 'owner' && prop !== 'clone') {\r\n                    newComponent[prop] = val.clone();\r\n                }\r\n                else {\r\n                    newComponent[prop] = val;\r\n                }\r\n            }\r\n        }\r\n        return newComponent;\r\n    }\r\n}\r\n/**\r\n * Tag components are a way of tagging a component with label and a simple value\r\n *\r\n * For example:\r\n *\r\n * ```typescript\r\n * const isOffscreen = new TagComponent('offscreen');\r\n * entity.addComponent(isOffscreen);\r\n * entity.tags.includes\r\n * ```\r\n */\r\nclass TagComponent extends Component {\r\n    constructor(type, value) {\r\n        super();\r\n        this.type = type;\r\n        this.value = value;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Observable.ts\n/**\r\n * Simple Observable implementation\r\n * @template T is the typescript Type that defines the data being observed\r\n */\r\nclass Observable {\r\n    constructor() {\r\n        this.observers = [];\r\n        this.subscriptions = [];\r\n    }\r\n    /**\r\n     * Register an observer to listen to this observable\r\n     * @param observer\r\n     */\r\n    register(observer) {\r\n        this.observers.push(observer);\r\n    }\r\n    /**\r\n     * Register a callback to listen to this observable\r\n     * @param func\r\n     */\r\n    subscribe(func) {\r\n        this.subscriptions.push(func);\r\n    }\r\n    /**\r\n     * Remove an observer from the observable\r\n     * @param observer\r\n     */\r\n    unregister(observer) {\r\n        const i = this.observers.indexOf(observer);\r\n        if (i !== -1) {\r\n            this.observers.splice(i, 1);\r\n        }\r\n    }\r\n    /**\r\n     * Remove a callback that is listening to this observable\r\n     * @param func\r\n     */\r\n    unsubscribe(func) {\r\n        const i = this.subscriptions.indexOf(func);\r\n        if (i !== -1) {\r\n            this.subscriptions.splice(i, 1);\r\n        }\r\n    }\r\n    /**\r\n     * Broadcasts a message to all observers and callbacks\r\n     * @param message\r\n     */\r\n    notifyAll(message) {\r\n        const observersLength = this.observers.length;\r\n        for (let i = 0; i < observersLength; i++) {\r\n            this.observers[i].notify(message);\r\n        }\r\n        const subscriptionsLength = this.subscriptions.length;\r\n        for (let i = 0; i < subscriptionsLength; i++) {\r\n            this.subscriptions[i](message);\r\n        }\r\n    }\r\n    /**\r\n     * Removes all observers and callbacks\r\n     */\r\n    clear() {\r\n        this.observers.length = 0;\r\n        this.subscriptions.length = 0;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/Components/TransformComponent.ts\n\r\n\r\n\r\n\r\nclass TransformComponent extends Component {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.type = 'ex.transform';\r\n        this._transform = new Transform();\r\n        this._addChildTransform = (child) => {\r\n            const childTxComponent = child.get(TransformComponent);\r\n            if (childTxComponent) {\r\n                childTxComponent._transform.parent = this._transform;\r\n            }\r\n        };\r\n        /**\r\n         * Observable that emits when the z index changes on this component\r\n         */\r\n        this.zIndexChanged$ = new Observable();\r\n        this._z = 0;\r\n        /**\r\n         * The [[CoordPlane|coordinate plane|]] for this transform for the entity.\r\n         */\r\n        this.coordPlane = CoordPlane.World;\r\n    }\r\n    get() {\r\n        return this._transform;\r\n    }\r\n    onAdd(owner) {\r\n        for (const child of owner.children) {\r\n            this._addChildTransform(child);\r\n        }\r\n        owner.childrenAdded$.subscribe(child => this._addChildTransform(child));\r\n        owner.childrenRemoved$.subscribe(child => {\r\n            const childTxComponent = child.get(TransformComponent);\r\n            if (childTxComponent) {\r\n                childTxComponent._transform.parent = null;\r\n            }\r\n        });\r\n    }\r\n    onRemove(_previousOwner) {\r\n        this._transform.parent = null;\r\n    }\r\n    /**\r\n     * The z-index ordering of the entity, a higher values are drawn on top of lower values.\r\n     * For example z=99 would be drawn on top of z=0.\r\n     */\r\n    get z() {\r\n        return this._z;\r\n    }\r\n    set z(val) {\r\n        const oldz = this._z;\r\n        this._z = val;\r\n        if (oldz !== val) {\r\n            this.zIndexChanged$.notifyAll(val);\r\n        }\r\n    }\r\n    get pos() {\r\n        return this._transform.pos;\r\n    }\r\n    set pos(v) {\r\n        this._transform.pos = v;\r\n    }\r\n    get globalPos() {\r\n        return this._transform.globalPos;\r\n    }\r\n    set globalPos(v) {\r\n        this._transform.globalPos = v;\r\n    }\r\n    get rotation() {\r\n        return this._transform.rotation;\r\n    }\r\n    set rotation(rotation) {\r\n        this._transform.rotation = rotation;\r\n    }\r\n    get globalRotation() {\r\n        return this._transform.globalRotation;\r\n    }\r\n    set globalRotation(rotation) {\r\n        this._transform.globalRotation = rotation;\r\n    }\r\n    get scale() {\r\n        return this._transform.scale;\r\n    }\r\n    set scale(v) {\r\n        this._transform.scale = v;\r\n    }\r\n    get globalScale() {\r\n        return this._transform.globalScale;\r\n    }\r\n    set globalScale(v) {\r\n        this._transform.globalScale = v;\r\n    }\r\n    applyInverse(v) {\r\n        return this._transform.applyInverse(v);\r\n    }\r\n    apply(v) {\r\n        return this._transform.apply(v);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/Components/MotionComponent.ts\n\r\n\r\nclass MotionComponent extends Component {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.type = 'ex.motion';\r\n        /**\r\n         * The velocity of an entity in pixels per second\r\n         */\r\n        this.vel = Vector.Zero;\r\n        /**\r\n         * The acceleration of entity in pixels per second^2\r\n         */\r\n        this.acc = Vector.Zero;\r\n        /**\r\n         * The scale rate of change in scale units per second\r\n         */\r\n        this.scaleFactor = Vector.Zero;\r\n        /**\r\n         * The angular velocity which is how quickly the entity is rotating in radians per second\r\n         */\r\n        this.angularVelocity = 0;\r\n        /**\r\n         * The amount of torque applied to the entity, angular acceleration is torque * inertia\r\n         */\r\n        this.torque = 0;\r\n        /**\r\n         * Inertia can be thought of as the resistance to motion\r\n         */\r\n        this.inertia = 1;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Group/CollisionGroup.ts\n/**\r\n * CollisionGroups indicate like members that do not collide with each other. Use [[CollisionGroupManager]] to create [[CollisionGroup]]s\r\n *\r\n * For example:\r\n *\r\n * Players have collision group \"player\"\r\n *\r\n * ![Player Collision Group](/assets/images/docs/CollisionGroupsPlayer.png)\r\n *\r\n * Enemies have collision group \"enemy\"\r\n *\r\n * ![Enemy Collision Group](/assets/images/docs/CollisionGroupsEnemy.png)\r\n *\r\n * Blocks have collision group \"ground\"\r\n *\r\n * ![Ground collision group](/assets/images/docs/CollisionGroupsGround.png)\r\n *\r\n * Players don't collide with each other, but enemies and blocks. Likewise, enemies don't collide with each other but collide\r\n * with players and blocks.\r\n *\r\n * This is done with bitmasking, see the following pseudo-code\r\n *\r\n * PlayerGroup = `0b001`\r\n * PlayerGroupMask = `0b110`\r\n *\r\n * EnemyGroup = `0b010`\r\n * EnemyGroupMask = `0b101`\r\n *\r\n * BlockGroup = `0b100`\r\n * BlockGroupMask = `0b011`\r\n *\r\n * Should Players collide? No because the bitwise mask evaluates to 0\r\n * `(player1.group & player2.mask) === 0`\r\n * `(0b001 & 0b110) === 0`\r\n *\r\n * Should Players and Enemies collide? Yes because the bitwise mask is non-zero\r\n * `(player1.group & enemy1.mask) === 1`\r\n * `(0b001 & 0b101) === 1`\r\n *\r\n * Should Players and Blocks collide? Yes because the bitwise mask is non-zero\r\n * `(player1.group & blocks1.mask) === 1`\r\n * `(0b001 & 0b011) === 1`\r\n */\r\nclass CollisionGroup {\r\n    /**\r\n     * STOP!!** It is preferred that [[CollisionGroupManager.create]] is used to create collision groups\r\n     *  unless you know how to construct the proper bitmasks. See https://github.com/excaliburjs/Excalibur/issues/1091 for more info.\r\n     * @param name Name of the collision group\r\n     * @param category 32 bit category for the group, should be a unique power of 2. For example `0b001` or `0b010`\r\n     * @param mask 32 bit mask of category, or `~category` generally. For a category of `0b001`, the mask would be `0b110`\r\n     */\r\n    constructor(name, category, mask) {\r\n        this._name = name;\r\n        this._category = category;\r\n        this._mask = mask;\r\n    }\r\n    /**\r\n     * Get the name of the collision group\r\n     */\r\n    get name() {\r\n        return this._name;\r\n    }\r\n    /**\r\n     * Get the category of the collision group, a 32 bit number which should be a unique power of 2\r\n     */\r\n    get category() {\r\n        return this._category;\r\n    }\r\n    /**\r\n     * Get the mask for this collision group\r\n     */\r\n    get mask() {\r\n        return this._mask;\r\n    }\r\n    /**\r\n     * Evaluates whether 2 collision groups can collide\r\n     * @param other  CollisionGroup\r\n     */\r\n    canCollide(other) {\r\n        return (this.category & other.mask) !== 0 && (other.category & this.mask) !== 0;\r\n    }\r\n    /**\r\n     * Inverts the collision group. For example, if before the group specified \"players\",\r\n     * inverting would specify all groups except players\r\n     * @returns CollisionGroup\r\n     */\r\n    invert() {\r\n        return new CollisionGroup('~(' + this.name + ')', ~this.category, ~this.mask);\r\n    }\r\n    /**\r\n     * Combine collision groups with each other. The new group includes all of the previous groups.\r\n     *\r\n     * @param collisionGroups\r\n     */\r\n    static combine(collisionGroups) {\r\n        const combinedName = collisionGroups.map((c) => c.name).join('+');\r\n        const combinedCategory = collisionGroups.reduce((current, g) => g.category | current, 0b0);\r\n        const combinedMask = ~combinedCategory;\r\n        return new CollisionGroup(combinedName, combinedCategory, combinedMask);\r\n    }\r\n    /**\r\n     * Creates a collision group that collides with the listed groups\r\n     * @param collisionGroups\r\n     */\r\n    static collidesWith(collisionGroups) {\r\n        return CollisionGroup.combine(collisionGroups).invert();\r\n    }\r\n}\r\n/**\r\n * The `All` [[CollisionGroup]] is a special group that collides with all other groups including itself,\r\n * it is the default collision group on colliders.\r\n */\r\nCollisionGroup.All = new CollisionGroup('Collide with all groups', -1, -1);\r\n\n;// CONCATENATED MODULE: ./Collision/Detection/Pair.ts\n\r\n\r\n/**\r\n * Models a potential collision between 2 colliders\r\n */\r\nclass Pair {\r\n    constructor(colliderA, colliderB) {\r\n        this.colliderA = colliderA;\r\n        this.colliderB = colliderB;\r\n        this.id = null;\r\n        this.id = Pair.calculatePairHash(colliderA.id, colliderB.id);\r\n    }\r\n    /**\r\n     * Returns whether a it is allowed for 2 colliders in a Pair to collide\r\n     * @param colliderA\r\n     * @param colliderB\r\n     */\r\n    static canCollide(colliderA, colliderB) {\r\n        var _a, _b;\r\n        const bodyA = (_a = colliderA === null || colliderA === void 0 ? void 0 : colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n        const bodyB = (_b = colliderB === null || colliderB === void 0 ? void 0 : colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n        // Prevent self collision\r\n        if (colliderA.id === colliderB.id) {\r\n            return false;\r\n        }\r\n        // Colliders with the same owner do not collide (composite colliders)\r\n        if (colliderA.owner &&\r\n            colliderB.owner &&\r\n            colliderA.owner.id === colliderB.owner.id) {\r\n            return false;\r\n        }\r\n        // if the pair has a member with zero dimension don't collide\r\n        if (colliderA.localBounds.hasZeroDimensions() || colliderB.localBounds.hasZeroDimensions()) {\r\n            return false;\r\n        }\r\n        // Body's needed for collision in the current state\r\n        // TODO can we collide without a body?\r\n        if (!bodyA || !bodyB) {\r\n            return false;\r\n        }\r\n        // If both are in the same collision group short circuit\r\n        if (!bodyA.group.canCollide(bodyB.group)) {\r\n            return false;\r\n        }\r\n        // if both are fixed short circuit\r\n        if (bodyA.collisionType === CollisionType.Fixed && bodyB.collisionType === CollisionType.Fixed) {\r\n            return false;\r\n        }\r\n        // if the either is prevent collision short circuit\r\n        if (bodyB.collisionType === CollisionType.PreventCollision || bodyA.collisionType === CollisionType.PreventCollision) {\r\n            return false;\r\n        }\r\n        // if either is dead short circuit\r\n        if (!bodyA.active || !bodyB.active) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    /**\r\n     * Returns whether or not it is possible for the pairs to collide\r\n     */\r\n    get canCollide() {\r\n        const colliderA = this.colliderA;\r\n        const colliderB = this.colliderB;\r\n        return Pair.canCollide(colliderA, colliderB);\r\n    }\r\n    /**\r\n     * Runs the collision intersection logic on the members of this pair\r\n     */\r\n    collide() {\r\n        return this.colliderA.collide(this.colliderB);\r\n    }\r\n    /**\r\n     * Check if the collider is part of the pair\r\n     * @param collider\r\n     */\r\n    hasCollider(collider) {\r\n        return collider === this.colliderA || collider === this.colliderB;\r\n    }\r\n    /**\r\n     * Calculates the unique pair hash id for this collision pair (owning id)\r\n     */\r\n    static calculatePairHash(idA, idB) {\r\n        if (idA.value < idB.value) {\r\n            return `#${idA.value}+${idB.value}`;\r\n        }\r\n        else {\r\n            return `#${idB.value}+${idA.value}`;\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/projection.ts\n/**\r\n * A 1 dimensional projection on an axis, used to test overlaps\r\n */\r\nclass Projection {\r\n    constructor(min, max) {\r\n        this.min = min;\r\n        this.max = max;\r\n    }\r\n    overlaps(projection) {\r\n        return this.max > projection.min && projection.max > this.min;\r\n    }\r\n    getOverlap(projection) {\r\n        if (this.overlaps(projection)) {\r\n            if (this.max > projection.max) {\r\n                return projection.max - this.min;\r\n            }\r\n            else {\r\n                return this.max - projection.min;\r\n            }\r\n        }\r\n        return 0;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Detection/DynamicTree.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Dynamic Tree Node used for tracking bounds within the tree\r\n */\r\nclass TreeNode {\r\n    constructor(parent) {\r\n        this.parent = parent;\r\n        this.parent = parent || null;\r\n        this.data = null;\r\n        this.bounds = new BoundingBox();\r\n        this.left = null;\r\n        this.right = null;\r\n        this.height = 0;\r\n    }\r\n    isLeaf() {\r\n        return !this.left && !this.right;\r\n    }\r\n}\r\n/**\r\n * The DynamicTrees provides a spatial partitioning data structure for quickly querying for overlapping bounding boxes for\r\n * all tracked bodies. The worst case performance of this is O(n*log(n)) where n is the number of bodies in the tree.\r\n *\r\n * Internally the bounding boxes are organized as a balanced binary tree of bounding boxes, where the leaf nodes are tracked bodies.\r\n * Every non-leaf node is a bounding box that contains child bounding boxes.\r\n */\r\nclass DynamicTree {\r\n    constructor(worldBounds = new BoundingBox(-Number.MAX_VALUE, -Number.MAX_VALUE, Number.MAX_VALUE, Number.MAX_VALUE)) {\r\n        this.worldBounds = worldBounds;\r\n        this.root = null;\r\n        this.nodes = {};\r\n    }\r\n    /**\r\n     * Inserts a node into the dynamic tree\r\n     */\r\n    _insert(leaf) {\r\n        // If there are no nodes in the tree, make this the root leaf\r\n        if (this.root === null) {\r\n            this.root = leaf;\r\n            this.root.parent = null;\r\n            return;\r\n        }\r\n        // Search the tree for a node that is not a leaf and find the best place to insert\r\n        const leafAABB = leaf.bounds;\r\n        let currentRoot = this.root;\r\n        while (!currentRoot.isLeaf()) {\r\n            const left = currentRoot.left;\r\n            const right = currentRoot.right;\r\n            const area = currentRoot.bounds.getPerimeter();\r\n            const combinedAABB = currentRoot.bounds.combine(leafAABB);\r\n            const combinedArea = combinedAABB.getPerimeter();\r\n            // Calculate cost heuristic for creating a new parent and leaf\r\n            const cost = 2 * combinedArea;\r\n            // Minimum cost of pushing the leaf down the tree\r\n            const inheritanceCost = 2 * (combinedArea - area);\r\n            // Cost of descending\r\n            let leftCost = 0;\r\n            const leftCombined = leafAABB.combine(left.bounds);\r\n            let newArea;\r\n            let oldArea;\r\n            if (left.isLeaf()) {\r\n                leftCost = leftCombined.getPerimeter() + inheritanceCost;\r\n            }\r\n            else {\r\n                oldArea = left.bounds.getPerimeter();\r\n                newArea = leftCombined.getPerimeter();\r\n                leftCost = newArea - oldArea + inheritanceCost;\r\n            }\r\n            let rightCost = 0;\r\n            const rightCombined = leafAABB.combine(right.bounds);\r\n            if (right.isLeaf()) {\r\n                rightCost = rightCombined.getPerimeter() + inheritanceCost;\r\n            }\r\n            else {\r\n                oldArea = right.bounds.getPerimeter();\r\n                newArea = rightCombined.getPerimeter();\r\n                rightCost = newArea - oldArea + inheritanceCost;\r\n            }\r\n            // cost is acceptable\r\n            if (cost < leftCost && cost < rightCost) {\r\n                break;\r\n            }\r\n            // Descend to the depths\r\n            if (leftCost < rightCost) {\r\n                currentRoot = left;\r\n            }\r\n            else {\r\n                currentRoot = right;\r\n            }\r\n        }\r\n        // Create the new parent node and insert into the tree\r\n        const oldParent = currentRoot.parent;\r\n        const newParent = new TreeNode(oldParent);\r\n        newParent.bounds = leafAABB.combine(currentRoot.bounds);\r\n        newParent.height = currentRoot.height + 1;\r\n        if (oldParent !== null) {\r\n            // The sibling node was not the root\r\n            if (oldParent.left === currentRoot) {\r\n                oldParent.left = newParent;\r\n            }\r\n            else {\r\n                oldParent.right = newParent;\r\n            }\r\n            newParent.left = currentRoot;\r\n            newParent.right = leaf;\r\n            currentRoot.parent = newParent;\r\n            leaf.parent = newParent;\r\n        }\r\n        else {\r\n            // The sibling node was the root\r\n            newParent.left = currentRoot;\r\n            newParent.right = leaf;\r\n            currentRoot.parent = newParent;\r\n            leaf.parent = newParent;\r\n            this.root = newParent;\r\n        }\r\n        // Walk up the tree fixing heights and AABBs\r\n        let currentNode = leaf.parent;\r\n        while (currentNode) {\r\n            currentNode = this._balance(currentNode);\r\n            if (!currentNode.left) {\r\n                throw new Error('Parent of current leaf cannot have a null left child' + currentNode);\r\n            }\r\n            if (!currentNode.right) {\r\n                throw new Error('Parent of current leaf cannot have a null right child' + currentNode);\r\n            }\r\n            currentNode.height = 1 + Math.max(currentNode.left.height, currentNode.right.height);\r\n            currentNode.bounds = currentNode.left.bounds.combine(currentNode.right.bounds);\r\n            currentNode = currentNode.parent;\r\n        }\r\n    }\r\n    /**\r\n     * Removes a node from the dynamic tree\r\n     */\r\n    _remove(leaf) {\r\n        if (leaf === this.root) {\r\n            this.root = null;\r\n            return;\r\n        }\r\n        const parent = leaf.parent;\r\n        const grandParent = parent.parent;\r\n        let sibling;\r\n        if (parent.left === leaf) {\r\n            sibling = parent.right;\r\n        }\r\n        else {\r\n            sibling = parent.left;\r\n        }\r\n        if (grandParent) {\r\n            if (grandParent.left === parent) {\r\n                grandParent.left = sibling;\r\n            }\r\n            else {\r\n                grandParent.right = sibling;\r\n            }\r\n            sibling.parent = grandParent;\r\n            let currentNode = grandParent;\r\n            while (currentNode) {\r\n                currentNode = this._balance(currentNode);\r\n                currentNode.bounds = currentNode.left.bounds.combine(currentNode.right.bounds);\r\n                currentNode.height = 1 + Math.max(currentNode.left.height, currentNode.right.height);\r\n                currentNode = currentNode.parent;\r\n            }\r\n        }\r\n        else {\r\n            this.root = sibling;\r\n            sibling.parent = null;\r\n        }\r\n    }\r\n    /**\r\n     * Tracks a body in the dynamic tree\r\n     */\r\n    trackCollider(collider) {\r\n        const node = new TreeNode();\r\n        node.data = collider;\r\n        node.bounds = collider.bounds;\r\n        node.bounds.left -= 2;\r\n        node.bounds.top -= 2;\r\n        node.bounds.right += 2;\r\n        node.bounds.bottom += 2;\r\n        this.nodes[collider.id.value] = node;\r\n        this._insert(node);\r\n    }\r\n    /**\r\n     * Updates the dynamic tree given the current bounds of each body being tracked\r\n     */\r\n    updateCollider(collider) {\r\n        var _a;\r\n        const node = this.nodes[collider.id.value];\r\n        if (!node) {\r\n            return false;\r\n        }\r\n        const b = collider.bounds;\r\n        // if the body is outside the world no longer update it\r\n        if (!this.worldBounds.contains(b)) {\r\n            Logger.getInstance().warn('Collider with id ' + collider.id.value + ' is outside the world bounds and will no longer be tracked for physics');\r\n            this.untrackCollider(collider);\r\n            return false;\r\n        }\r\n        if (node.bounds.contains(b)) {\r\n            return false;\r\n        }\r\n        this._remove(node);\r\n        b.left -= Physics.boundsPadding;\r\n        b.top -= Physics.boundsPadding;\r\n        b.right += Physics.boundsPadding;\r\n        b.bottom += Physics.boundsPadding;\r\n        // THIS IS CAUSING UNECESSARY CHECKS\r\n        if (collider.owner) {\r\n            const body = (_a = collider.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n            if (body) {\r\n                const multdx = ((body.vel.x * 32) / 1000) * Physics.dynamicTreeVelocityMultiplier;\r\n                const multdy = ((body.vel.y * 32) / 1000) * Physics.dynamicTreeVelocityMultiplier;\r\n                if (multdx < 0) {\r\n                    b.left += multdx;\r\n                }\r\n                else {\r\n                    b.right += multdx;\r\n                }\r\n                if (multdy < 0) {\r\n                    b.top += multdy;\r\n                }\r\n                else {\r\n                    b.bottom += multdy;\r\n                }\r\n            }\r\n        }\r\n        node.bounds = b;\r\n        this._insert(node);\r\n        return true;\r\n    }\r\n    /**\r\n     * Untracks a body from the dynamic tree\r\n     */\r\n    untrackCollider(collider) {\r\n        const node = this.nodes[collider.id.value];\r\n        if (!node) {\r\n            return;\r\n        }\r\n        this._remove(node);\r\n        this.nodes[collider.id.value] = null;\r\n        delete this.nodes[collider.id.value];\r\n    }\r\n    /**\r\n     * Balances the tree about a node\r\n     */\r\n    _balance(node) {\r\n        if (node === null) {\r\n            throw new Error('Cannot balance at null node');\r\n        }\r\n        if (node.isLeaf() || node.height < 2) {\r\n            return node;\r\n        }\r\n        const left = node.left;\r\n        const right = node.right;\r\n        const a = node;\r\n        const b = left;\r\n        const c = right;\r\n        const d = left.left;\r\n        const e = left.right;\r\n        const f = right.left;\r\n        const g = right.right;\r\n        const balance = c.height - b.height;\r\n        // Rotate c node up\r\n        if (balance > 1) {\r\n            // Swap the right node with it's parent\r\n            c.left = a;\r\n            c.parent = a.parent;\r\n            a.parent = c;\r\n            // The original node's old parent should point to the right node\r\n            // this is mega confusing\r\n            if (c.parent) {\r\n                if (c.parent.left === a) {\r\n                    c.parent.left = c;\r\n                }\r\n                else {\r\n                    c.parent.right = c;\r\n                }\r\n            }\r\n            else {\r\n                this.root = c;\r\n            }\r\n            // Rotate\r\n            if (f.height > g.height) {\r\n                c.right = f;\r\n                a.right = g;\r\n                g.parent = a;\r\n                a.bounds = b.bounds.combine(g.bounds);\r\n                c.bounds = a.bounds.combine(f.bounds);\r\n                a.height = 1 + Math.max(b.height, g.height);\r\n                c.height = 1 + Math.max(a.height, f.height);\r\n            }\r\n            else {\r\n                c.right = g;\r\n                a.right = f;\r\n                f.parent = a;\r\n                a.bounds = b.bounds.combine(f.bounds);\r\n                c.bounds = a.bounds.combine(g.bounds);\r\n                a.height = 1 + Math.max(b.height, f.height);\r\n                c.height = 1 + Math.max(a.height, g.height);\r\n            }\r\n            return c;\r\n        }\r\n        // Rotate left node up\r\n        if (balance < -1) {\r\n            // swap\r\n            b.left = a;\r\n            b.parent = a.parent;\r\n            a.parent = b;\r\n            // node's old parent should point to b\r\n            if (b.parent) {\r\n                if (b.parent.left === a) {\r\n                    b.parent.left = b;\r\n                }\r\n                else {\r\n                    if (b.parent.right !== a) {\r\n                        throw 'Error rotating Dynamic Tree';\r\n                    }\r\n                    b.parent.right = b;\r\n                }\r\n            }\r\n            else {\r\n                this.root = b;\r\n            }\r\n            // rotate\r\n            if (d.height > e.height) {\r\n                b.right = d;\r\n                a.left = e;\r\n                e.parent = a;\r\n                a.bounds = c.bounds.combine(e.bounds);\r\n                b.bounds = a.bounds.combine(d.bounds);\r\n                a.height = 1 + Math.max(c.height, e.height);\r\n                b.height = 1 + Math.max(a.height, d.height);\r\n            }\r\n            else {\r\n                b.right = e;\r\n                a.left = d;\r\n                d.parent = a;\r\n                a.bounds = c.bounds.combine(d.bounds);\r\n                b.bounds = a.bounds.combine(e.bounds);\r\n                a.height = 1 + Math.max(c.height, d.height);\r\n                b.height = 1 + Math.max(a.height, e.height);\r\n            }\r\n            return b;\r\n        }\r\n        return node;\r\n    }\r\n    /**\r\n     * Returns the internal height of the tree, shorter trees are better. Performance drops as the tree grows\r\n     */\r\n    getHeight() {\r\n        if (this.root === null) {\r\n            return 0;\r\n        }\r\n        return this.root.height;\r\n    }\r\n    /**\r\n     * Queries the Dynamic Axis Aligned Tree for bodies that could be colliding with the provided body.\r\n     *\r\n     * In the query callback, it will be passed a potential collider. Returning true from this callback indicates\r\n     * that you are complete with your query and you do not want to continue. Returning false will continue searching\r\n     * the tree until all possible colliders have been returned.\r\n     */\r\n    query(collider, callback) {\r\n        const bounds = collider.bounds;\r\n        const helper = (currentNode) => {\r\n            if (currentNode && currentNode.bounds.overlaps(bounds)) {\r\n                if (currentNode.isLeaf() && currentNode.data !== collider) {\r\n                    if (callback.call(collider, currentNode.data)) {\r\n                        return true;\r\n                    }\r\n                }\r\n                else {\r\n                    return helper(currentNode.left) || helper(currentNode.right);\r\n                }\r\n            }\r\n            return false;\r\n        };\r\n        helper(this.root);\r\n    }\r\n    /**\r\n     * Queries the Dynamic Axis Aligned Tree for bodies that could be intersecting. By default the raycast query uses an infinitely\r\n     * long ray to test the tree specified by `max`.\r\n     *\r\n     * In the query callback, it will be passed a potential body that intersects with the raycast. Returning true from this\r\n     * callback indicates that your are complete with your query and do not want to continue. Return false will continue searching\r\n     * the tree until all possible bodies that would intersect with the ray have been returned.\r\n     */\r\n    rayCastQuery(ray, max = Infinity, callback) {\r\n        const helper = (currentNode) => {\r\n            if (currentNode && currentNode.bounds.rayCast(ray, max)) {\r\n                if (currentNode.isLeaf()) {\r\n                    if (callback.call(ray, currentNode.data)) {\r\n                        // ray hit a leaf! return the body\r\n                        return true;\r\n                    }\r\n                }\r\n                else {\r\n                    // ray hit but not at a leaf, recurse deeper\r\n                    return helper(currentNode.left) || helper(currentNode.right);\r\n                }\r\n            }\r\n            return false; // ray missed\r\n        };\r\n        helper(this.root);\r\n    }\r\n    getNodes() {\r\n        const helper = (currentNode) => {\r\n            if (currentNode) {\r\n                return [currentNode].concat(helper(currentNode.left), helper(currentNode.right));\r\n            }\r\n            else {\r\n                return [];\r\n            }\r\n        };\r\n        return helper(this.root);\r\n    }\r\n    debug(ex) {\r\n        // draw all the nodes in the Dynamic Tree\r\n        const helper = (currentNode) => {\r\n            if (currentNode) {\r\n                if (currentNode.isLeaf()) {\r\n                    currentNode.bounds.draw(ex, Color.Green);\r\n                }\r\n                else {\r\n                    currentNode.bounds.draw(ex, Color.White);\r\n                }\r\n                if (currentNode.left) {\r\n                    helper(currentNode.left);\r\n                }\r\n                if (currentNode.right) {\r\n                    helper(currentNode.right);\r\n                }\r\n            }\r\n        };\r\n        helper(this.root);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/ray.ts\n/**\r\n * A 2D ray that can be cast into the scene to do collision detection\r\n */\r\nclass Ray {\r\n    /**\r\n     * @param pos The starting position for the ray\r\n     * @param dir The vector indicating the direction of the ray\r\n     */\r\n    constructor(pos, dir) {\r\n        this.pos = pos;\r\n        this.dir = dir.normalize();\r\n    }\r\n    /**\r\n     * Tests a whether this ray intersects with a line segment. Returns a number greater than or equal to 0 on success.\r\n     * This number indicates the mathematical intersection time.\r\n     * @param line  The line to test\r\n     */\r\n    intersect(line) {\r\n        const numerator = line.begin.sub(this.pos);\r\n        // Test is line and ray are parallel and non intersecting\r\n        if (this.dir.cross(line.getSlope()) === 0 && numerator.cross(this.dir) !== 0) {\r\n            return -1;\r\n        }\r\n        // Lines are parallel\r\n        const divisor = this.dir.cross(line.getSlope());\r\n        if (divisor === 0) {\r\n            return -1;\r\n        }\r\n        const t = numerator.cross(line.getSlope()) / divisor;\r\n        if (t >= 0) {\r\n            const u = numerator.cross(this.dir) / divisor / line.getLength();\r\n            if (u >= 0 && u <= 1) {\r\n                return t;\r\n            }\r\n        }\r\n        return -1;\r\n    }\r\n    intersectPoint(line) {\r\n        const time = this.intersect(line);\r\n        if (time < 0) {\r\n            return null;\r\n        }\r\n        return this.getPoint(time);\r\n    }\r\n    /**\r\n     * Returns the point of intersection given the intersection time\r\n     */\r\n    getPoint(time) {\r\n        return this.pos.add(this.dir.scale(time));\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Detection/DynamicTreeCollisionProcessor.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Responsible for performing the collision broadphase (locating potential collisions) and\r\n * the narrowphase (actual collision contacts)\r\n */\r\nclass DynamicTreeCollisionProcessor {\r\n    constructor() {\r\n        this._dynamicCollisionTree = new DynamicTree();\r\n        this._pairs = new Set();\r\n        this._collisionPairCache = [];\r\n        this._colliders = [];\r\n    }\r\n    getColliders() {\r\n        return this._colliders;\r\n    }\r\n    /**\r\n     * Tracks a physics body for collisions\r\n     */\r\n    track(target) {\r\n        if (!target) {\r\n            Logger.getInstance().warn('Cannot track null collider');\r\n            return;\r\n        }\r\n        if (target instanceof CompositeCollider) {\r\n            const colliders = target.getColliders();\r\n            for (const c of colliders) {\r\n                c.owner = target.owner;\r\n                this._colliders.push(c);\r\n                this._dynamicCollisionTree.trackCollider(c);\r\n            }\r\n        }\r\n        else {\r\n            this._colliders.push(target);\r\n            this._dynamicCollisionTree.trackCollider(target);\r\n        }\r\n    }\r\n    /**\r\n     * Untracks a physics body\r\n     */\r\n    untrack(target) {\r\n        if (!target) {\r\n            Logger.getInstance().warn('Cannot untrack a null collider');\r\n            return;\r\n        }\r\n        if (target instanceof CompositeCollider) {\r\n            const colliders = target.getColliders();\r\n            for (const c of colliders) {\r\n                const index = this._colliders.indexOf(c);\r\n                if (index !== -1) {\r\n                    this._colliders.splice(index, 1);\r\n                }\r\n                this._dynamicCollisionTree.untrackCollider(c);\r\n            }\r\n        }\r\n        else {\r\n            const index = this._colliders.indexOf(target);\r\n            if (index !== -1) {\r\n                this._colliders.splice(index, 1);\r\n            }\r\n            this._dynamicCollisionTree.untrackCollider(target);\r\n        }\r\n    }\r\n    _pairExists(colliderA, colliderB) {\r\n        // if the collision pair has been calculated already short circuit\r\n        const hash = Pair.calculatePairHash(colliderA.id, colliderB.id);\r\n        return this._pairs.has(hash);\r\n    }\r\n    /**\r\n     * Detects potential collision pairs in a broadphase approach with the dynamic AABB tree strategy\r\n     */\r\n    broadphase(targets, delta, stats) {\r\n        const seconds = delta / 1000;\r\n        // Retrieve the list of potential colliders, exclude killed, prevented, and self\r\n        const potentialColliders = targets.filter((other) => {\r\n            var _a, _b;\r\n            const body = (_a = other.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n            return ((_b = other.owner) === null || _b === void 0 ? void 0 : _b.active) && body.collisionType !== CollisionType.PreventCollision;\r\n        });\r\n        // clear old list of collision pairs\r\n        this._collisionPairCache = [];\r\n        this._pairs.clear();\r\n        // check for normal collision pairs\r\n        let collider;\r\n        for (let j = 0, l = potentialColliders.length; j < l; j++) {\r\n            collider = potentialColliders[j];\r\n            // Query the collision tree for potential colliders\r\n            this._dynamicCollisionTree.query(collider, (other) => {\r\n                if (!this._pairExists(collider, other) && Pair.canCollide(collider, other)) {\r\n                    const pair = new Pair(collider, other);\r\n                    this._pairs.add(pair.id);\r\n                    this._collisionPairCache.push(pair);\r\n                }\r\n                // Always return false, to query whole tree. Returning true in the query method stops searching\r\n                return false;\r\n            });\r\n        }\r\n        if (stats) {\r\n            stats.physics.pairs = this._collisionPairCache.length;\r\n        }\r\n        // Check dynamic tree for fast moving objects\r\n        // Fast moving objects are those moving at least there smallest bound per frame\r\n        if (Physics.checkForFastBodies) {\r\n            for (const collider of potentialColliders) {\r\n                const body = collider.owner.get(BodyComponent);\r\n                // Skip non-active objects. Does not make sense on other collision types\r\n                if (body.collisionType !== CollisionType.Active) {\r\n                    continue;\r\n                }\r\n                // Maximum travel distance next frame\r\n                const updateDistance = body.vel.size * seconds + // velocity term\r\n                    body.acc.size * 0.5 * seconds * seconds; // acc term\r\n                // Find the minimum dimension\r\n                const minDimension = Math.min(collider.bounds.height, collider.bounds.width);\r\n                if (Physics.disableMinimumSpeedForFastBody || updateDistance > minDimension / 2) {\r\n                    if (stats) {\r\n                        stats.physics.fastBodies++;\r\n                    }\r\n                    // start with the oldPos because the integration for actors has already happened\r\n                    // objects resting on a surface may be slightly penetrating in the current position\r\n                    const updateVec = body.globalPos.sub(body.oldPos);\r\n                    const centerPoint = collider.center;\r\n                    const furthestPoint = collider.getFurthestPoint(body.vel);\r\n                    const origin = furthestPoint.sub(updateVec);\r\n                    const ray = new Ray(origin, body.vel);\r\n                    // back the ray up by -2x surfaceEpsilon to account for fast moving objects starting on the surface\r\n                    ray.pos = ray.pos.add(ray.dir.scale(-2 * Physics.surfaceEpsilon));\r\n                    let minCollider;\r\n                    let minTranslate = new Vector(Infinity, Infinity);\r\n                    this._dynamicCollisionTree.rayCastQuery(ray, updateDistance + Physics.surfaceEpsilon * 2, (other) => {\r\n                        if (!this._pairExists(collider, other) && Pair.canCollide(collider, other)) {\r\n                            const hitPoint = other.rayCast(ray, updateDistance + Physics.surfaceEpsilon * 10);\r\n                            if (hitPoint) {\r\n                                const translate = hitPoint.sub(origin);\r\n                                if (translate.size < minTranslate.size) {\r\n                                    minTranslate = translate;\r\n                                    minCollider = other;\r\n                                }\r\n                            }\r\n                        }\r\n                        return false;\r\n                    });\r\n                    if (minCollider && Vector.isValid(minTranslate)) {\r\n                        const pair = new Pair(collider, minCollider);\r\n                        if (!this._pairs.has(pair.id)) {\r\n                            this._pairs.add(pair.id);\r\n                            this._collisionPairCache.push(pair);\r\n                        }\r\n                        // move the fast moving object to the other body\r\n                        // need to push into the surface by ex.Physics.surfaceEpsilon\r\n                        const shift = centerPoint.sub(furthestPoint);\r\n                        body.globalPos = origin\r\n                            .add(shift)\r\n                            .add(minTranslate)\r\n                            .add(ray.dir.scale(10 * Physics.surfaceEpsilon)); // needed to push the shape slightly into contact\r\n                        collider.update(body.transform.get());\r\n                        if (stats) {\r\n                            stats.physics.fastBodyCollisions++;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        // return cache\r\n        return this._collisionPairCache;\r\n    }\r\n    /**\r\n     * Applies narrow phase on collision pairs to find actual area intersections\r\n     * Adds actual colliding pairs to stats' Frame data\r\n     */\r\n    narrowphase(pairs, stats) {\r\n        let contacts = [];\r\n        for (let i = 0; i < pairs.length; i++) {\r\n            const newContacts = pairs[i].collide();\r\n            contacts = contacts.concat(newContacts);\r\n            if (stats && newContacts.length > 0) {\r\n                for (const c of newContacts) {\r\n                    stats.physics.contacts.set(c.id, c);\r\n                }\r\n            }\r\n        }\r\n        if (stats) {\r\n            stats.physics.collisions += contacts.length;\r\n        }\r\n        return contacts;\r\n    }\r\n    /**\r\n     * Update the dynamic tree positions\r\n     */\r\n    update(targets) {\r\n        let updated = 0;\r\n        const len = targets.length;\r\n        for (let i = 0; i < len; i++) {\r\n            if (this._dynamicCollisionTree.updateCollider(targets[i])) {\r\n                updated++;\r\n            }\r\n        }\r\n        return updated;\r\n    }\r\n    debug(ex) {\r\n        this._dynamicCollisionTree.debug(ex);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/Collider.ts\n\r\n\r\n/**\r\n * A collision collider specifies the geometry that can detect when other collision colliders intersect\r\n * for the purposes of colliding 2 objects in excalibur.\r\n */\r\nclass Collider {\r\n    constructor() {\r\n        this.id = createId('collider', Collider._ID++);\r\n        /**\r\n         * Excalibur uses this to signal to the [[CollisionSystem]] this is part of a composite collider\r\n         * @internal\r\n         * @hidden\r\n         */\r\n        this.__compositeColliderId = null;\r\n        this.events = new EventDispatcher();\r\n    }\r\n    /**\r\n     * Returns a boolean indicating whether this body collided with\r\n     * or was in stationary contact with\r\n     * the body of the other [[Collider]]\r\n     */\r\n    touching(other) {\r\n        const contact = this.collide(other);\r\n        if (contact) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n}\r\nCollider._ID = 0;\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/CompositeCollider.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass CompositeCollider extends Collider {\r\n    constructor(colliders) {\r\n        super();\r\n        this._collisionProcessor = new DynamicTreeCollisionProcessor();\r\n        this._dynamicAABBTree = new DynamicTree();\r\n        this._colliders = [];\r\n        for (const c of colliders) {\r\n            this.addCollider(c);\r\n        }\r\n    }\r\n    clearColliders() {\r\n        this._colliders = [];\r\n    }\r\n    addCollider(collider) {\r\n        this.events.wire(collider.events);\r\n        collider.__compositeColliderId = this.id;\r\n        this._colliders.push(collider);\r\n        this._collisionProcessor.track(collider);\r\n        this._dynamicAABBTree.trackCollider(collider);\r\n    }\r\n    removeCollider(collider) {\r\n        this.events.unwire(collider.events);\r\n        collider.__compositeColliderId = null;\r\n        removeItemFromArray(collider, this._colliders);\r\n        this._collisionProcessor.untrack(collider);\r\n        this._dynamicAABBTree.untrackCollider(collider);\r\n    }\r\n    getColliders() {\r\n        return this._colliders;\r\n    }\r\n    get worldPos() {\r\n        var _a, _b;\r\n        // TODO transform component world pos\r\n        return (_b = (_a = this._transform) === null || _a === void 0 ? void 0 : _a.pos) !== null && _b !== void 0 ? _b : Vector.Zero;\r\n    }\r\n    get center() {\r\n        var _a, _b;\r\n        return (_b = (_a = this._transform) === null || _a === void 0 ? void 0 : _a.pos) !== null && _b !== void 0 ? _b : Vector.Zero;\r\n    }\r\n    get bounds() {\r\n        var _a, _b;\r\n        // TODO cache this\r\n        const colliders = this.getColliders();\r\n        const results = colliders.reduce((acc, collider) => acc.combine(collider.bounds), (_b = (_a = colliders[0]) === null || _a === void 0 ? void 0 : _a.bounds) !== null && _b !== void 0 ? _b : new BoundingBox().translate(this.worldPos));\r\n        return results;\r\n    }\r\n    get localBounds() {\r\n        var _a, _b;\r\n        // TODO cache this\r\n        const colliders = this.getColliders();\r\n        const results = colliders.reduce((acc, collider) => acc.combine(collider.localBounds), (_b = (_a = colliders[0]) === null || _a === void 0 ? void 0 : _a.localBounds) !== null && _b !== void 0 ? _b : new BoundingBox());\r\n        return results;\r\n    }\r\n    get axes() {\r\n        // TODO cache this\r\n        const colliders = this.getColliders();\r\n        let axes = [];\r\n        for (const collider of colliders) {\r\n            axes = axes.concat(collider.axes);\r\n        }\r\n        return axes;\r\n    }\r\n    getFurthestPoint(direction) {\r\n        const colliders = this.getColliders();\r\n        const furthestPoints = [];\r\n        for (const collider of colliders) {\r\n            furthestPoints.push(collider.getFurthestPoint(direction));\r\n        }\r\n        // Pick best point from all colliders\r\n        let bestPoint = furthestPoints[0];\r\n        let maxDistance = -Number.MAX_VALUE;\r\n        for (const point of furthestPoints) {\r\n            const distance = point.dot(direction);\r\n            if (distance > maxDistance) {\r\n                bestPoint = point;\r\n                maxDistance = distance;\r\n            }\r\n        }\r\n        return bestPoint;\r\n    }\r\n    getInertia(mass) {\r\n        const colliders = this.getColliders();\r\n        let totalInertia = 0;\r\n        for (const collider of colliders) {\r\n            totalInertia += collider.getInertia(mass);\r\n        }\r\n        return totalInertia;\r\n    }\r\n    collide(other) {\r\n        let otherColliders = [other];\r\n        if (other instanceof CompositeCollider) {\r\n            otherColliders = other.getColliders();\r\n        }\r\n        const pairs = [];\r\n        for (const c of otherColliders) {\r\n            this._dynamicAABBTree.query(c, (potentialCollider) => {\r\n                pairs.push(new Pair(c, potentialCollider));\r\n                return false;\r\n            });\r\n        }\r\n        let contacts = [];\r\n        for (const p of pairs) {\r\n            contacts = contacts.concat(p.collide());\r\n        }\r\n        return contacts;\r\n    }\r\n    getClosestLineBetween(other) {\r\n        const colliders = this.getColliders();\r\n        const lines = [];\r\n        if (other instanceof CompositeCollider) {\r\n            const otherColliders = other.getColliders();\r\n            for (const colliderA of colliders) {\r\n                for (const colliderB of otherColliders) {\r\n                    const maybeLine = colliderA.getClosestLineBetween(colliderB);\r\n                    if (maybeLine) {\r\n                        lines.push(maybeLine);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            for (const collider of colliders) {\r\n                const maybeLine = other.getClosestLineBetween(collider);\r\n                if (maybeLine) {\r\n                    lines.push(maybeLine);\r\n                }\r\n            }\r\n        }\r\n        if (lines.length) {\r\n            let minLength = lines[0].getLength();\r\n            let minLine = lines[0];\r\n            for (const line of lines) {\r\n                const length = line.getLength();\r\n                if (length < minLength) {\r\n                    minLength = length;\r\n                    minLine = line;\r\n                }\r\n            }\r\n            return minLine;\r\n        }\r\n        return null;\r\n    }\r\n    contains(point) {\r\n        const colliders = this.getColliders();\r\n        for (const collider of colliders) {\r\n            if (collider.contains(point)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    rayCast(ray, max) {\r\n        const colliders = this.getColliders();\r\n        const points = [];\r\n        for (const collider of colliders) {\r\n            const vec = collider.rayCast(ray, max);\r\n            if (vec) {\r\n                points.push(vec);\r\n            }\r\n        }\r\n        if (points.length) {\r\n            let minPoint = points[0];\r\n            let minDistance = minPoint.dot(ray.dir);\r\n            for (const point of points) {\r\n                const distance = ray.dir.dot(point);\r\n                if (distance < minDistance) {\r\n                    minPoint = point;\r\n                    minDistance = distance;\r\n                }\r\n            }\r\n            return minPoint;\r\n        }\r\n        return null;\r\n    }\r\n    project(axis) {\r\n        const colliders = this.getColliders();\r\n        const projs = [];\r\n        for (const collider of colliders) {\r\n            const proj = collider.project(axis);\r\n            if (proj) {\r\n                projs.push(proj);\r\n            }\r\n        }\r\n        // Merge all proj's on the same axis\r\n        if (projs.length) {\r\n            const newProjection = new Projection(projs[0].min, projs[0].max);\r\n            for (const proj of projs) {\r\n                newProjection.min = Math.min(proj.min, newProjection.min);\r\n                newProjection.max = Math.max(proj.max, newProjection.max);\r\n            }\r\n            return newProjection;\r\n        }\r\n        return null;\r\n    }\r\n    update(transform) {\r\n        if (transform) {\r\n            const colliders = this.getColliders();\r\n            for (const collider of colliders) {\r\n                collider.owner = this.owner;\r\n                collider.update(transform);\r\n            }\r\n        }\r\n    }\r\n    debug(ex, color) {\r\n        const colliders = this.getColliders();\r\n        for (const collider of colliders) {\r\n            collider.debug(ex, color);\r\n        }\r\n    }\r\n    clone() {\r\n        return new CompositeCollider(this._colliders.map((c) => c.clone()));\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/line-segment.ts\n\r\n/**\r\n * A 2D line segment\r\n */\r\nclass LineSegment {\r\n    /**\r\n     * @param begin  The starting point of the line segment\r\n     * @param end  The ending point of the line segment\r\n     */\r\n    constructor(begin, end) {\r\n        this.begin = begin;\r\n        this.end = end;\r\n    }\r\n    /**\r\n     * Gets the raw slope (m) of the line. Will return (+/-)Infinity for vertical lines.\r\n     */\r\n    get slope() {\r\n        return (this.end.y - this.begin.y) / (this.end.x - this.begin.x);\r\n    }\r\n    /**\r\n     * Gets the Y-intercept (b) of the line. Will return (+/-)Infinity if there is no intercept.\r\n     */\r\n    get intercept() {\r\n        return this.begin.y - this.slope * this.begin.x;\r\n    }\r\n    /**\r\n     * Gets the normal of the line\r\n     */\r\n    normal() {\r\n        if (this._normal) {\r\n            return this._normal;\r\n        }\r\n        return this._normal = this.end.sub(this.begin).normal();\r\n    }\r\n    dir() {\r\n        if (this._dir) {\r\n            return this._dir;\r\n        }\r\n        return this._dir = this.end.sub(this.begin);\r\n    }\r\n    getPoints() {\r\n        return [this.begin, this.end];\r\n    }\r\n    /**\r\n     * Returns the slope of the line in the form of a vector of length 1\r\n     */\r\n    getSlope() {\r\n        if (this._slope) {\r\n            return this._slope;\r\n        }\r\n        const begin = this.begin;\r\n        const end = this.end;\r\n        const distance = begin.distance(end);\r\n        return this._slope = end.sub(begin).scale(1 / distance);\r\n    }\r\n    /**\r\n     * Returns the edge of the line as vector, the length of the vector is the length of the edge\r\n     */\r\n    getEdge() {\r\n        const begin = this.begin;\r\n        const end = this.end;\r\n        return end.sub(begin);\r\n    }\r\n    /**\r\n     * Returns the length of the line segment in pixels\r\n     */\r\n    getLength() {\r\n        if (this._length) {\r\n            return this._length;\r\n        }\r\n        const begin = this.begin;\r\n        const end = this.end;\r\n        const distance = begin.distance(end);\r\n        return this._length = distance;\r\n    }\r\n    /**\r\n     * Returns the midpoint of the edge\r\n     */\r\n    get midpoint() {\r\n        return this.begin.add(this.end).scale(0.5);\r\n    }\r\n    /**\r\n     * Flips the direction of the line segment\r\n     */\r\n    flip() {\r\n        return new LineSegment(this.end, this.begin);\r\n    }\r\n    /**\r\n     * Tests if a given point is below the line, points in the normal direction above the line are considered above.\r\n     * @param point\r\n     */\r\n    below(point) {\r\n        const above2 = (this.end.x - this.begin.x) * (point.y - this.begin.y) - (this.end.y - this.begin.y) * (point.x - this.begin.x);\r\n        return above2 >= 0;\r\n    }\r\n    /**\r\n     * Returns the clip point\r\n     * @param sideVector Vector that traces the line\r\n     * @param length Length to clip along side\r\n     */\r\n    clip(sideVector, length) {\r\n        let dir = sideVector;\r\n        dir = dir.normalize();\r\n        const near = dir.dot(this.begin) - length;\r\n        const far = dir.dot(this.end) - length;\r\n        const results = [];\r\n        if (near <= 0) {\r\n            results.push(this.begin);\r\n        }\r\n        if (far <= 0) {\r\n            results.push(this.end);\r\n        }\r\n        if (near * far < 0) {\r\n            const clipTime = near / (near - far);\r\n            results.push(this.begin.add(this.end.sub(this.begin).scale(clipTime)));\r\n        }\r\n        if (results.length !== 2) {\r\n            return null;\r\n        }\r\n        return new LineSegment(results[0], results[1]);\r\n    }\r\n    /**\r\n     * Find the perpendicular distance from the line to a point\r\n     * https://en.wikipedia.org/wiki/Distance_from_a_point_to_a_line\r\n     * @param point\r\n     */\r\n    distanceToPoint(point, signed = false) {\r\n        const x0 = point.x;\r\n        const y0 = point.y;\r\n        const l = this.getLength();\r\n        const dy = this.end.y - this.begin.y;\r\n        const dx = this.end.x - this.begin.x;\r\n        const distance = (dy * x0 - dx * y0 + this.end.x * this.begin.y - this.end.y * this.begin.x) / l;\r\n        return signed ? distance : Math.abs(distance);\r\n    }\r\n    /**\r\n     * Find the perpendicular line from the line to a point\r\n     * https://en.wikipedia.org/wiki/Distance_from_a_point_to_a_line\r\n     * (a - p) - ((a - p) * n)n\r\n     * a is a point on the line\r\n     * p is the arbitrary point above the line\r\n     * n is a unit vector in direction of the line\r\n     * @param point\r\n     */\r\n    findVectorToPoint(point) {\r\n        const aMinusP = this.begin.sub(point);\r\n        const n = this.getSlope();\r\n        return aMinusP.sub(n.scale(aMinusP.dot(n)));\r\n    }\r\n    /**\r\n     * Finds a point on the line given only an X or a Y value. Given an X value, the function returns\r\n     * a new point with the calculated Y value and vice-versa.\r\n     *\r\n     * @param x The known X value of the target point\r\n     * @param y The known Y value of the target point\r\n     * @returns A new point with the other calculated axis value\r\n     */\r\n    findPoint(x = null, y = null) {\r\n        const m = this.slope;\r\n        const b = this.intercept;\r\n        if (x !== null) {\r\n            return new Vector(x, m * x + b);\r\n        }\r\n        else if (y !== null) {\r\n            return new Vector((y - b) / m, y);\r\n        }\r\n        else {\r\n            throw new Error('You must provide an X or a Y value');\r\n        }\r\n    }\r\n    /**\r\n     * @see http://stackoverflow.com/a/11908158/109458\r\n     */\r\n    hasPoint() {\r\n        let currPoint;\r\n        let threshold = 0;\r\n        if (typeof arguments[0] === 'number' && typeof arguments[1] === 'number') {\r\n            currPoint = new Vector(arguments[0], arguments[1]);\r\n            threshold = arguments[2] || 0;\r\n        }\r\n        else if (arguments[0] instanceof Vector) {\r\n            currPoint = arguments[0];\r\n            threshold = arguments[1] || 0;\r\n        }\r\n        else {\r\n            throw 'Could not determine the arguments for Vector.hasPoint';\r\n        }\r\n        const dxc = currPoint.x - this.begin.x;\r\n        const dyc = currPoint.y - this.begin.y;\r\n        const dx1 = this.end.x - this.begin.x;\r\n        const dy1 = this.end.y - this.begin.y;\r\n        const cross = dxc * dy1 - dyc * dx1;\r\n        // check whether point lines on the line\r\n        if (Math.abs(cross) > threshold) {\r\n            return false;\r\n        }\r\n        // check whether point lies in-between start and end\r\n        if (Math.abs(dx1) >= Math.abs(dy1)) {\r\n            return dx1 > 0 ? this.begin.x <= currPoint.x && currPoint.x <= this.end.x : this.end.x <= currPoint.x && currPoint.x <= this.begin.x;\r\n        }\r\n        else {\r\n            return dy1 > 0 ? this.begin.y <= currPoint.y && currPoint.y <= this.end.y : this.end.y <= currPoint.y && currPoint.y <= this.begin.y;\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/ClosestLineJumpTable.ts\n\r\n\r\n\r\n/**\r\n * Finds the closes line between 2 line segments, were the magnitude of u, v are the lengths of each segment\r\n * L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\r\n * L2 = Q(t) = q0 + t * v, where t is time and q0 is the start of the line\r\n * @param p0 Point where L1 begins\r\n * @param u Direction and length of L1\r\n * @param q0 Point were L2 begins\r\n * @param v Direction and length of L2\r\n */\r\nfunction ClosestLine(p0, u, q0, v) {\r\n    // Distance between 2 lines http://geomalgorithms.com/a07-_distance.html\r\n    // w(s, t) = P(s) - Q(t)\r\n    // The w(s, t) that has the minimum distance we will say is w(sClosest, tClosest) = wClosest\r\n    //\r\n    // wClosest is the vector that is uniquely perpendicular to the 2 line directions u & v.\r\n    // wClosest = w0 + sClosest * u - tClosest * v, where w0 is p0 - q0\r\n    //\r\n    // The closest point between 2 lines then satisfies this pair of equations\r\n    // 1: u * wClosest = 0\r\n    // 2: v * wClosest = 0\r\n    //\r\n    // Substituting wClosest into the equations we get\r\n    //\r\n    // 1: (u * u) * sClosest - (u * v) tClosest = -u * w0\r\n    // 2: (v * u) * sClosest - (v * v) tClosest = -v * w0\r\n    // simplify w0\r\n    const w0 = p0.sub(q0);\r\n    // simplify (u * u);\r\n    const a = u.dot(u);\r\n    // simplify (u * v);\r\n    const b = u.dot(v);\r\n    // simplify (v * v)\r\n    const c = v.dot(v);\r\n    // simplify (u * w0)\r\n    const d = u.dot(w0);\r\n    // simplify (v * w0)\r\n    const e = v.dot(w0);\r\n    // denominator ac - b^2\r\n    const denom = a * c - b * b;\r\n    let sDenom = denom;\r\n    let tDenom = denom;\r\n    // if denom is 0 they are parallel, use any point from either as the start in this case p0\r\n    if (denom === 0 || denom <= 0.01) {\r\n        const tClosestParallel = d / b;\r\n        return new LineSegment(p0, q0.add(v.scale(tClosestParallel)));\r\n    }\r\n    // Solve for sClosest for infinite line\r\n    let sClosest = b * e - c * d; // / denom;\r\n    // Solve for tClosest for infinite line\r\n    let tClosest = a * e - b * d; // / denom;\r\n    // Solve for segments candidate edges, if sClosest and tClosest are outside their segments\r\n    if (sClosest < 0) {\r\n        sClosest = 0;\r\n        tClosest = e;\r\n        tDenom = c;\r\n    }\r\n    else if (sClosest > sDenom) {\r\n        sClosest = sDenom;\r\n        tClosest = e + b;\r\n        tDenom = c;\r\n    }\r\n    if (tClosest < 0) {\r\n        tClosest = 0;\r\n        if (-d < 0) {\r\n            sClosest = 0;\r\n        }\r\n        else if (-d > a) {\r\n            sClosest = sDenom;\r\n        }\r\n        else {\r\n            sClosest = -d;\r\n            sDenom = a;\r\n        }\r\n    }\r\n    else if (tClosest > tDenom) {\r\n        tClosest = tDenom;\r\n        if (-d + b < 0) {\r\n            sClosest = 0;\r\n        }\r\n        else if (-d + b > a) {\r\n            sClosest = sDenom;\r\n        }\r\n        else {\r\n            sClosest = -d + b;\r\n            sDenom = a;\r\n        }\r\n    }\r\n    sClosest = Math.abs(sClosest) < 0.001 ? 0 : sClosest / sDenom;\r\n    tClosest = Math.abs(tClosest) < 0.001 ? 0 : tClosest / tDenom;\r\n    return new LineSegment(p0.add(u.scale(sClosest)), q0.add(v.scale(tClosest)));\r\n}\r\nconst ClosestLineJumpTable = {\r\n    PolygonPolygonClosestLine(polygonA, polygonB) {\r\n        // Find the 2 closest faces on each polygon\r\n        const otherWorldPos = polygonB.worldPos;\r\n        const otherDirection = otherWorldPos.sub(polygonA.worldPos);\r\n        const thisDirection = otherDirection.negate();\r\n        const rayTowardsOther = new Ray(polygonA.worldPos, otherDirection);\r\n        const rayTowardsThis = new Ray(otherWorldPos, thisDirection);\r\n        const thisPoint = polygonA.rayCast(rayTowardsOther).add(rayTowardsOther.dir.scale(0.1));\r\n        const otherPoint = polygonB.rayCast(rayTowardsThis).add(rayTowardsThis.dir.scale(0.1));\r\n        const thisFace = polygonA.getClosestFace(thisPoint);\r\n        const otherFace = polygonB.getClosestFace(otherPoint);\r\n        // L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\r\n        const p0 = thisFace.face.begin;\r\n        const u = thisFace.face.getEdge();\r\n        // L2 = Q(t) = q0 + t * v, where t is time and q0 is the start of the line\r\n        const q0 = otherFace.face.begin;\r\n        const v = otherFace.face.getEdge();\r\n        return ClosestLine(p0, u, q0, v);\r\n    },\r\n    PolygonEdgeClosestLine(polygon, edge) {\r\n        // Find the 2 closest faces on each polygon\r\n        const otherWorldPos = edge.worldPos;\r\n        const otherDirection = otherWorldPos.sub(polygon.worldPos);\r\n        const rayTowardsOther = new Ray(polygon.worldPos, otherDirection);\r\n        const thisPoint = polygon.rayCast(rayTowardsOther).add(rayTowardsOther.dir.scale(0.1));\r\n        const thisFace = polygon.getClosestFace(thisPoint);\r\n        // L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\r\n        const p0 = thisFace.face.begin;\r\n        const u = thisFace.face.getEdge();\r\n        // L2 = Q(t) = q0 + t * v, where t is time and q0 is the start of the line\r\n        const edgeLine = edge.asLine();\r\n        const edgeStart = edgeLine.begin;\r\n        const edgeVector = edgeLine.getEdge();\r\n        const q0 = edgeStart;\r\n        const v = edgeVector;\r\n        return ClosestLine(p0, u, q0, v);\r\n    },\r\n    PolygonCircleClosestLine(polygon, circle) {\r\n        // https://math.stackexchange.com/questions/1919177/how-to-find-point-on-line-closest-to-sphere\r\n        // Find the 2 closest faces on each polygon\r\n        const otherWorldPos = circle.worldPos;\r\n        const otherDirection = otherWorldPos.sub(polygon.worldPos);\r\n        const rayTowardsOther = new Ray(polygon.worldPos, otherDirection.normalize());\r\n        const thisPoint = polygon.rayCast(rayTowardsOther).add(rayTowardsOther.dir.scale(0.1));\r\n        const thisFace = polygon.getClosestFace(thisPoint);\r\n        // L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\r\n        const p0 = thisFace.face.begin;\r\n        const u = thisFace.face.getEdge();\r\n        // Time of minimum distance\r\n        let t = (u.x * (otherWorldPos.x - p0.x) + u.y * (otherWorldPos.y - p0.y)) / (u.x * u.x + u.y * u.y);\r\n        // If time of minimum is past the edge clamp\r\n        if (t > 1) {\r\n            t = 1;\r\n        }\r\n        else if (t < 0) {\r\n            t = 0;\r\n        }\r\n        // Minimum distance\r\n        const d = Math.sqrt(Math.pow(p0.x + u.x * t - otherWorldPos.x, 2) + Math.pow(p0.y + u.y * t - otherWorldPos.y, 2)) - circle.radius;\r\n        const circlex = ((p0.x + u.x * t - otherWorldPos.x) * circle.radius) / (circle.radius + d);\r\n        const circley = ((p0.y + u.y * t - otherWorldPos.y) * circle.radius) / (circle.radius + d);\r\n        return new LineSegment(u.scale(t).add(p0), new Vector(otherWorldPos.x + circlex, otherWorldPos.y + circley));\r\n    },\r\n    CircleCircleClosestLine(circleA, circleB) {\r\n        // Find the 2 closest faces on each polygon\r\n        const otherWorldPos = circleB.worldPos;\r\n        const otherDirection = otherWorldPos.sub(circleA.worldPos);\r\n        const thisWorldPos = circleA.worldPos;\r\n        const thisDirection = thisWorldPos.sub(circleB.worldPos);\r\n        const rayTowardsOther = new Ray(circleA.worldPos, otherDirection);\r\n        const rayTowardsThis = new Ray(circleB.worldPos, thisDirection);\r\n        const thisPoint = circleA.rayCast(rayTowardsOther);\r\n        const otherPoint = circleB.rayCast(rayTowardsThis);\r\n        return new LineSegment(thisPoint, otherPoint);\r\n    },\r\n    CircleEdgeClosestLine(circle, edge) {\r\n        // https://math.stackexchange.com/questions/1919177/how-to-find-point-on-line-closest-to-sphere\r\n        const circleWorlPos = circle.worldPos;\r\n        // L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\r\n        const edgeLine = edge.asLine();\r\n        const edgeStart = edgeLine.begin;\r\n        const edgeVector = edgeLine.getEdge();\r\n        const p0 = edgeStart;\r\n        const u = edgeVector;\r\n        // Time of minimum distance\r\n        let t = (u.x * (circleWorlPos.x - p0.x) + u.y * (circleWorlPos.y - p0.y)) / (u.x * u.x + u.y * u.y);\r\n        // If time of minimum is past the edge clamp to edge\r\n        if (t > 1) {\r\n            t = 1;\r\n        }\r\n        else if (t < 0) {\r\n            t = 0;\r\n        }\r\n        // Minimum distance\r\n        const d = Math.sqrt(Math.pow(p0.x + u.x * t - circleWorlPos.x, 2) + Math.pow(p0.y + u.y * t - circleWorlPos.y, 2)) - circle.radius;\r\n        const circlex = ((p0.x + u.x * t - circleWorlPos.x) * circle.radius) / (circle.radius + d);\r\n        const circley = ((p0.y + u.y * t - circleWorlPos.y) * circle.radius) / (circle.radius + d);\r\n        return new LineSegment(u.scale(t).add(p0), new Vector(circleWorlPos.x + circlex, circleWorlPos.y + circley));\r\n    },\r\n    EdgeEdgeClosestLine(edgeA, edgeB) {\r\n        // L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\r\n        const edgeLineA = edgeA.asLine();\r\n        const edgeStartA = edgeLineA.begin;\r\n        const edgeVectorA = edgeLineA.getEdge();\r\n        const p0 = edgeStartA;\r\n        const u = edgeVectorA;\r\n        // L2 = Q(t) = q0 + t * v, where t is time and q0 is the start of the line\r\n        const edgeLineB = edgeB.asLine();\r\n        const edgeStartB = edgeLineB.begin;\r\n        const edgeVectorB = edgeLineB.getEdge();\r\n        const q0 = edgeStartB;\r\n        const v = edgeVectorB;\r\n        return ClosestLine(p0, u, q0, v);\r\n    }\r\n};\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/CircleCollider.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * This is a circle collider for the excalibur rigid body physics simulation\r\n */\r\nclass CircleCollider extends Collider {\r\n    constructor(options) {\r\n        super();\r\n        /**\r\n         * Position of the circle relative to the collider, by default (0, 0).\r\n         */\r\n        this.offset = Vector.Zero;\r\n        this._globalMatrix = AffineMatrix.identity();\r\n        this.offset = options.offset || Vector.Zero;\r\n        this.radius = options.radius || 0;\r\n        this._globalMatrix.translate(this.offset.x, this.offset.y);\r\n    }\r\n    get worldPos() {\r\n        return this._globalMatrix.getPosition();\r\n    }\r\n    /**\r\n     * Get the radius of the circle\r\n     */\r\n    get radius() {\r\n        var _a;\r\n        const tx = this._transform;\r\n        const scale = (_a = tx === null || tx === void 0 ? void 0 : tx.globalScale) !== null && _a !== void 0 ? _a : Vector.One;\r\n        // This is a trade off, the alternative is retooling circles to support ellipse collisions\r\n        return this._naturalRadius * Math.min(scale.x, scale.y);\r\n    }\r\n    /**\r\n     * Set the radius of the circle\r\n     */\r\n    set radius(val) {\r\n        var _a;\r\n        const tx = this._transform;\r\n        const scale = (_a = tx === null || tx === void 0 ? void 0 : tx.globalScale) !== null && _a !== void 0 ? _a : Vector.One;\r\n        // This is a trade off, the alternative is retooling circles to support ellipse collisions\r\n        this._naturalRadius = val / Math.min(scale.x, scale.y);\r\n    }\r\n    /**\r\n     * Returns a clone of this shape, not associated with any collider\r\n     */\r\n    clone() {\r\n        return new CircleCollider({\r\n            offset: this.offset.clone(),\r\n            radius: this.radius\r\n        });\r\n    }\r\n    /**\r\n     * Get the center of the collider in world coordinates\r\n     */\r\n    get center() {\r\n        return this._globalMatrix.getPosition();\r\n    }\r\n    /**\r\n     * Tests if a point is contained in this collider\r\n     */\r\n    contains(point) {\r\n        var _a, _b;\r\n        const pos = (_b = (_a = this._transform) === null || _a === void 0 ? void 0 : _a.pos) !== null && _b !== void 0 ? _b : this.offset;\r\n        const distance = pos.distance(point);\r\n        if (distance <= this.radius) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    /**\r\n     * Casts a ray at the Circle collider and returns the nearest point of collision\r\n     * @param ray\r\n     */\r\n    rayCast(ray, max = Infinity) {\r\n        //https://en.wikipedia.org/wiki/Line%E2%80%93sphere_intersection\r\n        const c = this.center;\r\n        const dir = ray.dir;\r\n        const orig = ray.pos;\r\n        const discriminant = Math.sqrt(Math.pow(dir.dot(orig.sub(c)), 2) - Math.pow(orig.sub(c).distance(), 2) + Math.pow(this.radius, 2));\r\n        if (discriminant < 0) {\r\n            // no intersection\r\n            return null;\r\n        }\r\n        else {\r\n            let toi = 0;\r\n            if (discriminant === 0) {\r\n                toi = -dir.dot(orig.sub(c));\r\n                if (toi > 0 && toi < max) {\r\n                    return ray.getPoint(toi);\r\n                }\r\n                return null;\r\n            }\r\n            else {\r\n                const toi1 = -dir.dot(orig.sub(c)) + discriminant;\r\n                const toi2 = -dir.dot(orig.sub(c)) - discriminant;\r\n                const positiveToi = [];\r\n                if (toi1 >= 0) {\r\n                    positiveToi.push(toi1);\r\n                }\r\n                if (toi2 >= 0) {\r\n                    positiveToi.push(toi2);\r\n                }\r\n                const mintoi = Math.min(...positiveToi);\r\n                if (mintoi <= max) {\r\n                    return ray.getPoint(mintoi);\r\n                }\r\n                return null;\r\n            }\r\n        }\r\n    }\r\n    getClosestLineBetween(shape) {\r\n        if (shape instanceof CircleCollider) {\r\n            return ClosestLineJumpTable.CircleCircleClosestLine(this, shape);\r\n        }\r\n        else if (shape instanceof PolygonCollider) {\r\n            return ClosestLineJumpTable.PolygonCircleClosestLine(shape, this).flip();\r\n        }\r\n        else if (shape instanceof EdgeCollider) {\r\n            return ClosestLineJumpTable.CircleEdgeClosestLine(this, shape).flip();\r\n        }\r\n        else {\r\n            throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof shape}`);\r\n        }\r\n    }\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    collide(collider) {\r\n        if (collider instanceof CircleCollider) {\r\n            return CollisionJumpTable.CollideCircleCircle(this, collider);\r\n        }\r\n        else if (collider instanceof PolygonCollider) {\r\n            return CollisionJumpTable.CollideCirclePolygon(this, collider);\r\n        }\r\n        else if (collider instanceof EdgeCollider) {\r\n            return CollisionJumpTable.CollideCircleEdge(this, collider);\r\n        }\r\n        else {\r\n            throw new Error(`Circle could not collide with unknown CollisionShape ${typeof collider}`);\r\n        }\r\n    }\r\n    /**\r\n     * Find the point on the collider furthest in the direction specified\r\n     */\r\n    getFurthestPoint(direction) {\r\n        return this.center.add(direction.normalize().scale(this.radius));\r\n    }\r\n    /**\r\n     * Find the local point on the shape in the direction specified\r\n     * @param direction\r\n     */\r\n    getFurthestLocalPoint(direction) {\r\n        const dir = direction.normalize();\r\n        return dir.scale(this.radius);\r\n    }\r\n    /**\r\n     * Get the axis aligned bounding box for the circle collider in world coordinates\r\n     */\r\n    get bounds() {\r\n        var _a, _b, _c;\r\n        const tx = this._transform;\r\n        const scale = (_a = tx === null || tx === void 0 ? void 0 : tx.globalScale) !== null && _a !== void 0 ? _a : Vector.One;\r\n        const rotation = (_b = tx === null || tx === void 0 ? void 0 : tx.globalRotation) !== null && _b !== void 0 ? _b : 0;\r\n        const pos = ((_c = tx === null || tx === void 0 ? void 0 : tx.globalPos) !== null && _c !== void 0 ? _c : Vector.Zero);\r\n        return new BoundingBox(this.offset.x - this._naturalRadius, this.offset.y - this._naturalRadius, this.offset.x + this._naturalRadius, this.offset.y + this._naturalRadius).rotate(rotation).scale(scale).translate(pos);\r\n    }\r\n    /**\r\n     * Get the axis aligned bounding box for the circle collider in local coordinates\r\n     */\r\n    get localBounds() {\r\n        return new BoundingBox(this.offset.x - this._naturalRadius, this.offset.y - this._naturalRadius, this.offset.x + this._naturalRadius, this.offset.y + this._naturalRadius);\r\n    }\r\n    /**\r\n     * Get axis not implemented on circles, since there are infinite axis in a circle\r\n     */\r\n    get axes() {\r\n        return [];\r\n    }\r\n    /**\r\n     * Returns the moment of inertia of a circle given it's mass\r\n     * https://en.wikipedia.org/wiki/List_of_moments_of_inertia\r\n     */\r\n    getInertia(mass) {\r\n        return (mass * this.radius * this.radius) / 2;\r\n    }\r\n    /* istanbul ignore next */\r\n    update(transform) {\r\n        var _a;\r\n        this._transform = transform;\r\n        const globalMat = (_a = transform.matrix) !== null && _a !== void 0 ? _a : this._globalMatrix;\r\n        globalMat.clone(this._globalMatrix);\r\n        this._globalMatrix.translate(this.offset.x, this.offset.y);\r\n    }\r\n    /**\r\n     * Project the circle along a specified axis\r\n     */\r\n    project(axis) {\r\n        const scalars = [];\r\n        const point = this.center;\r\n        const dotProduct = point.dot(axis);\r\n        scalars.push(dotProduct);\r\n        scalars.push(dotProduct + this.radius);\r\n        scalars.push(dotProduct - this.radius);\r\n        return new Projection(Math.min.apply(Math, scalars), Math.max.apply(Math, scalars));\r\n    }\r\n    debug(ex, color) {\r\n        var _a, _b, _c, _d;\r\n        const tx = this._transform;\r\n        const scale = (_a = tx === null || tx === void 0 ? void 0 : tx.globalScale) !== null && _a !== void 0 ? _a : Vector.One;\r\n        const rotation = (_b = tx === null || tx === void 0 ? void 0 : tx.globalRotation) !== null && _b !== void 0 ? _b : 0;\r\n        const pos = ((_c = tx === null || tx === void 0 ? void 0 : tx.globalPos) !== null && _c !== void 0 ? _c : Vector.Zero);\r\n        ex.save();\r\n        ex.translate(pos.x, pos.y);\r\n        ex.rotate(rotation);\r\n        ex.scale(scale.x, scale.y);\r\n        ex.drawCircle(((_d = this.offset) !== null && _d !== void 0 ? _d : Vector.Zero), this._naturalRadius, Color.Transparent, color, 2);\r\n        ex.restore();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Detection/CollisionContact.ts\n\r\n\r\n\r\n\r\n/**\r\n * Collision contacts are used internally by Excalibur to resolve collision between colliders. This\r\n * Pair prevents collisions from being evaluated more than one time\r\n */\r\nclass CollisionContact {\r\n    constructor(colliderA, colliderB, mtv, normal, tangent, points, localPoints, info) {\r\n        var _a, _b;\r\n        this._canceled = false;\r\n        this.colliderA = colliderA;\r\n        this.colliderB = colliderB;\r\n        this.mtv = mtv;\r\n        this.normal = normal;\r\n        this.tangent = tangent;\r\n        this.points = points;\r\n        this.localPoints = localPoints;\r\n        this.info = info;\r\n        this.id = Pair.calculatePairHash(colliderA.id, colliderB.id);\r\n        if (colliderA.__compositeColliderId || colliderB.__compositeColliderId) {\r\n            // Add on the parent composite pair for start/end contact\r\n            this.id += '|' + Pair.calculatePairHash((_a = colliderA.__compositeColliderId) !== null && _a !== void 0 ? _a : colliderA.id, (_b = colliderB.__compositeColliderId) !== null && _b !== void 0 ? _b : colliderB.id);\r\n        }\r\n    }\r\n    /**\r\n     * Match contact awake state, except if body's are Fixed\r\n     */\r\n    matchAwake() {\r\n        const bodyA = this.colliderA.owner.get(BodyComponent);\r\n        const bodyB = this.colliderB.owner.get(BodyComponent);\r\n        if (bodyA && bodyB) {\r\n            if (bodyA.sleeping !== bodyB.sleeping) {\r\n                if (bodyA.sleeping && bodyA.collisionType !== CollisionType.Fixed && bodyB.sleepMotion >= Physics.wakeThreshold) {\r\n                    bodyA.setSleeping(false);\r\n                }\r\n                if (bodyB.sleeping && bodyB.collisionType !== CollisionType.Fixed && bodyA.sleepMotion >= Physics.wakeThreshold) {\r\n                    bodyB.setSleeping(false);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    isCanceled() {\r\n        return this._canceled;\r\n    }\r\n    cancel() {\r\n        this._canceled = true;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/SeparatingAxis.ts\nclass SeparatingAxis {\r\n    static findPolygonPolygonSeparation(polyA, polyB) {\r\n        let bestSeparation = -Number.MAX_VALUE;\r\n        let bestSide = null;\r\n        let bestAxis = null;\r\n        let bestSideIndex = -1;\r\n        let bestOtherPoint = null;\r\n        const sides = polyA.getSides();\r\n        const localSides = polyA.getLocalSides();\r\n        for (let i = 0; i < sides.length; i++) {\r\n            const side = sides[i];\r\n            const axis = side.normal();\r\n            const vertB = polyB.getFurthestPoint(axis.negate());\r\n            // Separation on side i's axis\r\n            // We are looking for the largest separation between poly A's sides\r\n            const vertSeparation = side.distanceToPoint(vertB, true);\r\n            if (vertSeparation > bestSeparation) {\r\n                bestSeparation = vertSeparation;\r\n                bestSide = side;\r\n                bestAxis = axis;\r\n                bestSideIndex = i;\r\n                bestOtherPoint = vertB;\r\n            }\r\n        }\r\n        return {\r\n            collider: polyA,\r\n            separation: bestAxis ? bestSeparation : 99,\r\n            axis: bestAxis,\r\n            side: bestSide,\r\n            localSide: localSides[bestSideIndex],\r\n            sideId: bestSideIndex,\r\n            point: bestOtherPoint,\r\n            localPoint: bestAxis ? polyB.getFurthestLocalPoint(bestAxis.negate()) : null\r\n        };\r\n    }\r\n    static findCirclePolygonSeparation(circle, polygon) {\r\n        const axes = polygon.axes;\r\n        const pc = polygon.center;\r\n        // Special SAT with circles\r\n        const polyDir = pc.sub(circle.worldPos);\r\n        const closestPointOnPoly = polygon.getFurthestPoint(polyDir.negate());\r\n        axes.push(closestPointOnPoly.sub(circle.worldPos).normalize());\r\n        let minOverlap = Number.MAX_VALUE;\r\n        let minAxis = null;\r\n        let minIndex = -1;\r\n        for (let i = 0; i < axes.length; i++) {\r\n            const proj1 = polygon.project(axes[i]);\r\n            const proj2 = circle.project(axes[i]);\r\n            const overlap = proj1.getOverlap(proj2);\r\n            if (overlap <= 0) {\r\n                return null;\r\n            }\r\n            else {\r\n                if (overlap < minOverlap) {\r\n                    minOverlap = overlap;\r\n                    minAxis = axes[i];\r\n                    minIndex = i;\r\n                }\r\n            }\r\n        }\r\n        if (minIndex < 0) {\r\n            return null;\r\n        }\r\n        return minAxis.normalize().scale(minOverlap);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/CollisionJumpTable.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst CollisionJumpTable = {\r\n    CollideCircleCircle(circleA, circleB) {\r\n        const circleAPos = circleA.worldPos;\r\n        const circleBPos = circleB.worldPos;\r\n        const combinedRadius = circleA.radius + circleB.radius;\r\n        const distance = circleAPos.distance(circleBPos);\r\n        if (distance > combinedRadius) {\r\n            return [];\r\n        }\r\n        // negative means overlap\r\n        const separation = combinedRadius - distance;\r\n        // Normal points from A -> B\r\n        const normal = circleBPos.sub(circleAPos).normalize();\r\n        const tangent = normal.perpendicular();\r\n        const mvt = normal.scale(separation);\r\n        const point = circleA.getFurthestPoint(normal);\r\n        const local = circleA.getFurthestLocalPoint(normal);\r\n        const info = {\r\n            collider: circleA,\r\n            separation,\r\n            axis: normal,\r\n            point: point\r\n        };\r\n        return [new CollisionContact(circleA, circleB, mvt, normal, tangent, [point], [local], info)];\r\n    },\r\n    CollideCirclePolygon(circle, polygon) {\r\n        var _a, _b;\r\n        let minAxis = SeparatingAxis.findCirclePolygonSeparation(circle, polygon);\r\n        if (!minAxis) {\r\n            return [];\r\n        }\r\n        // make sure that the minAxis is pointing away from circle\r\n        const samedir = minAxis.dot(polygon.center.sub(circle.center));\r\n        minAxis = samedir < 0 ? minAxis.negate() : minAxis;\r\n        const point = circle.getFurthestPoint(minAxis);\r\n        const xf = (_b = (_a = circle.owner) === null || _a === void 0 ? void 0 : _a.get(TransformComponent)) !== null && _b !== void 0 ? _b : new TransformComponent();\r\n        const local = xf.applyInverse(point);\r\n        const normal = minAxis.normalize();\r\n        const info = {\r\n            collider: circle,\r\n            separation: -minAxis.size,\r\n            axis: normal,\r\n            point: point,\r\n            localPoint: local,\r\n            side: polygon.findSide(normal.negate()),\r\n            localSide: polygon.findLocalSide(normal.negate())\r\n        };\r\n        return [new CollisionContact(circle, polygon, minAxis, normal, normal.perpendicular(), [point], [local], info)];\r\n    },\r\n    CollideCircleEdge(circle, edge) {\r\n        // TODO not sure this actually abides by local/world collisions\r\n        // Are edge.begin and edge.end local space or world space? I think they should be local\r\n        // center of the circle in world pos\r\n        const cc = circle.center;\r\n        // vector in the direction of the edge\r\n        const edgeWorld = edge.asLine();\r\n        const e = edgeWorld.end.sub(edgeWorld.begin);\r\n        // amount of overlap with the circle's center along the edge direction\r\n        const u = e.dot(edgeWorld.end.sub(cc));\r\n        const v = e.dot(cc.sub(edgeWorld.begin));\r\n        const side = edge.asLine();\r\n        const localSide = edge.asLocalLine();\r\n        // Potential region A collision (circle is on the left side of the edge, before the beginning)\r\n        if (v <= 0) {\r\n            const da = edgeWorld.begin.sub(cc);\r\n            const dda = da.dot(da); // quick and dirty way of calc'n distance in r^2 terms saves some sqrts\r\n            // save some sqrts\r\n            if (dda > circle.radius * circle.radius) {\r\n                return []; // no collision\r\n            }\r\n            const normal = da.normalize();\r\n            const separation = circle.radius - Math.sqrt(dda);\r\n            const info = {\r\n                collider: circle,\r\n                separation: separation,\r\n                axis: normal,\r\n                point: side.begin,\r\n                side: side,\r\n                localSide: localSide\r\n            };\r\n            return [\r\n                new CollisionContact(circle, edge, normal.scale(separation), normal, normal.perpendicular(), [side.begin], [localSide.begin], info)\r\n            ];\r\n        }\r\n        // Potential region B collision (circle is on the right side of the edge, after the end)\r\n        if (u <= 0) {\r\n            const db = edgeWorld.end.sub(cc);\r\n            const ddb = db.dot(db);\r\n            if (ddb > circle.radius * circle.radius) {\r\n                return [];\r\n            }\r\n            const normal = db.normalize();\r\n            const separation = circle.radius - Math.sqrt(ddb);\r\n            const info = {\r\n                collider: circle,\r\n                separation: separation,\r\n                axis: normal,\r\n                point: side.end,\r\n                side: side,\r\n                localSide: localSide\r\n            };\r\n            return [\r\n                new CollisionContact(circle, edge, normal.scale(separation), normal, normal.perpendicular(), [side.end], [localSide.end], info)\r\n            ];\r\n        }\r\n        // Otherwise potential region AB collision (circle is in the middle of the edge between the beginning and end)\r\n        const den = e.dot(e);\r\n        const pointOnEdge = edgeWorld.begin\r\n            .scale(u)\r\n            .add(edgeWorld.end.scale(v))\r\n            .scale(1 / den);\r\n        const d = cc.sub(pointOnEdge);\r\n        const dd = d.dot(d);\r\n        if (dd > circle.radius * circle.radius) {\r\n            return []; // no collision\r\n        }\r\n        let normal = e.perpendicular();\r\n        // flip correct direction\r\n        if (normal.dot(cc.sub(edgeWorld.begin)) < 0) {\r\n            normal.x = -normal.x;\r\n            normal.y = -normal.y;\r\n        }\r\n        normal = normal.normalize();\r\n        const separation = circle.radius - Math.sqrt(dd);\r\n        const mvt = normal.scale(separation);\r\n        const info = {\r\n            collider: circle,\r\n            separation: separation,\r\n            axis: normal,\r\n            point: pointOnEdge,\r\n            side: side,\r\n            localSide: localSide\r\n        };\r\n        return [\r\n            new CollisionContact(circle, edge, mvt, normal.negate(), normal.negate().perpendicular(), [pointOnEdge], [pointOnEdge.sub(edge.worldPos)], info)\r\n        ];\r\n    },\r\n    CollideEdgeEdge() {\r\n        // Edge-edge collision doesn't make sense\r\n        return [];\r\n    },\r\n    CollidePolygonEdge(polygon, edge) {\r\n        var _a;\r\n        const pc = polygon.center;\r\n        const ec = edge.center;\r\n        const dir = ec.sub(pc).normalize();\r\n        // build a temporary polygon from the edge to use SAT\r\n        const linePoly = new PolygonCollider({\r\n            points: [edge.begin, edge.end, edge.end.add(dir.scale(100)), edge.begin.add(dir.scale(100))],\r\n            offset: edge.offset\r\n        });\r\n        linePoly.owner = edge.owner;\r\n        const tx = (_a = edge.owner) === null || _a === void 0 ? void 0 : _a.get(TransformComponent);\r\n        if (tx) {\r\n            linePoly.update(edge.owner.get(TransformComponent).get());\r\n        }\r\n        // Gross hack but poly-poly works well\r\n        const contact = this.CollidePolygonPolygon(polygon, linePoly);\r\n        if (contact.length) {\r\n            // Fudge the contact back to edge\r\n            contact[0].colliderB = edge;\r\n            contact[0].id = Pair.calculatePairHash(polygon.id, edge.id);\r\n        }\r\n        return contact;\r\n    },\r\n    CollidePolygonPolygon(polyA, polyB) {\r\n        var _a, _b, _c, _d;\r\n        // Multi contact from SAT\r\n        // https://gamedev.stackexchange.com/questions/111390/multiple-contacts-for-sat-collision-detection\r\n        // do a SAT test to find a min axis if it exists\r\n        const separationA = SeparatingAxis.findPolygonPolygonSeparation(polyA, polyB);\r\n        // If there is no overlap from boxA's perspective we can end early\r\n        if (separationA.separation > 0) {\r\n            return [];\r\n        }\r\n        const separationB = SeparatingAxis.findPolygonPolygonSeparation(polyB, polyA);\r\n        // If there is no overlap from boxB's perspective exit now\r\n        if (separationB.separation > 0) {\r\n            return [];\r\n        }\r\n        // Separations are both negative, we want to pick the least negative (minimal movement)\r\n        const separation = separationA.separation > separationB.separation ? separationA : separationB;\r\n        // The incident side is the most opposite from the axes of collision on the other collider\r\n        const other = separation.collider === polyA ? polyB : polyA;\r\n        const incident = other.findSide(separation.axis.negate());\r\n        // Clip incident side by the perpendicular lines at each end of the reference side\r\n        // https://en.wikipedia.org/wiki/Sutherland%E2%80%93Hodgman_algorithm\r\n        const reference = separation.side;\r\n        const refDir = reference.dir().normalize();\r\n        // Find our contact points by clipping the incident by the collision side\r\n        const clipRight = incident.clip(refDir.negate(), -refDir.dot(reference.begin));\r\n        let clipLeft = null;\r\n        if (clipRight) {\r\n            clipLeft = clipRight.clip(refDir, refDir.dot(reference.end));\r\n        }\r\n        // If there is no left there is no collision\r\n        if (clipLeft) {\r\n            // We only want clip points below the reference edge, discard the others\r\n            const points = clipLeft.getPoints().filter((p) => {\r\n                return reference.below(p);\r\n            });\r\n            let normal = separation.axis;\r\n            let tangent = normal.perpendicular();\r\n            // Point Contact A -> B\r\n            if (polyB.center.sub(polyA.center).dot(normal) < 0) {\r\n                normal = normal.negate();\r\n                tangent = normal.perpendicular();\r\n            }\r\n            // Points are clipped from incident which is the other collider\r\n            // Store those as locals\r\n            let localPoints = [];\r\n            if (separation.collider === polyA) {\r\n                const xf = (_b = (_a = polyB.owner) === null || _a === void 0 ? void 0 : _a.get(TransformComponent)) !== null && _b !== void 0 ? _b : new TransformComponent();\r\n                localPoints = points.map((p) => xf.applyInverse(p));\r\n            }\r\n            else {\r\n                const xf = (_d = (_c = polyA.owner) === null || _c === void 0 ? void 0 : _c.get(TransformComponent)) !== null && _d !== void 0 ? _d : new TransformComponent();\r\n                localPoints = points.map((p) => xf.applyInverse(p));\r\n            }\r\n            return [new CollisionContact(polyA, polyB, normal.scale(-separation.separation), normal, tangent, points, localPoints, separation)];\r\n        }\r\n        return [];\r\n    },\r\n    FindContactSeparation(contact, localPoint) {\r\n        var _a, _b, _c, _d;\r\n        const shapeA = contact.colliderA;\r\n        const txA = (_b = (_a = contact.colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(TransformComponent)) !== null && _b !== void 0 ? _b : new TransformComponent();\r\n        const shapeB = contact.colliderB;\r\n        const txB = (_d = (_c = contact.colliderB.owner) === null || _c === void 0 ? void 0 : _c.get(TransformComponent)) !== null && _d !== void 0 ? _d : new TransformComponent();\r\n        // both are circles\r\n        if (shapeA instanceof CircleCollider && shapeB instanceof CircleCollider) {\r\n            const combinedRadius = shapeA.radius + shapeB.radius;\r\n            const distance = txA.pos.distance(txB.pos);\r\n            const separation = combinedRadius - distance;\r\n            return -separation;\r\n        }\r\n        // both are polygons\r\n        if (shapeA instanceof PolygonCollider && shapeB instanceof PolygonCollider) {\r\n            if (contact.info.localSide) {\r\n                let side;\r\n                let worldPoint;\r\n                if (contact.info.collider === shapeA) {\r\n                    side = new LineSegment(txA.apply(contact.info.localSide.begin), txA.apply(contact.info.localSide.end));\r\n                    worldPoint = txB.apply(localPoint);\r\n                }\r\n                else {\r\n                    side = new LineSegment(txB.apply(contact.info.localSide.begin), txB.apply(contact.info.localSide.end));\r\n                    worldPoint = txA.apply(localPoint);\r\n                }\r\n                return side.distanceToPoint(worldPoint, true);\r\n            }\r\n        }\r\n        // polygon v circle\r\n        if ((shapeA instanceof PolygonCollider && shapeB instanceof CircleCollider) ||\r\n            (shapeB instanceof PolygonCollider && shapeA instanceof CircleCollider)) {\r\n            const worldPoint = txA.apply(localPoint);\r\n            if (contact.info.side) {\r\n                return contact.info.side.distanceToPoint(worldPoint, true);\r\n            }\r\n        }\r\n        // polygon v edge\r\n        if ((shapeA instanceof EdgeCollider && shapeB instanceof PolygonCollider) ||\r\n            (shapeB instanceof EdgeCollider && shapeA instanceof PolygonCollider)) {\r\n            let worldPoint;\r\n            if (contact.info.collider === shapeA) {\r\n                worldPoint = txB.apply(localPoint);\r\n            }\r\n            else {\r\n                worldPoint = txA.apply(localPoint);\r\n            }\r\n            if (contact.info.side) {\r\n                return contact.info.side.distanceToPoint(worldPoint, true);\r\n            }\r\n        }\r\n        // circle v edge\r\n        if ((shapeA instanceof CircleCollider && shapeB instanceof EdgeCollider) ||\r\n            (shapeB instanceof CircleCollider && shapeA instanceof EdgeCollider)) {\r\n            // Local point is always on the edge which is always shapeB\r\n            const worldPoint = txB.apply(localPoint);\r\n            let circlePoint;\r\n            if (shapeA instanceof CircleCollider) {\r\n                circlePoint = shapeA.getFurthestPoint(contact.normal);\r\n            }\r\n            const dist = worldPoint.distance(circlePoint);\r\n            if (contact.info.side) {\r\n                return dist > 0 ? -dist : 0;\r\n            }\r\n        }\r\n        return 0;\r\n    }\r\n};\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/EdgeCollider.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Edge is a single line collider to create collisions with a single line.\r\n */\r\nclass EdgeCollider extends Collider {\r\n    constructor(options) {\r\n        var _a;\r\n        super();\r\n        this._globalMatrix = AffineMatrix.identity();\r\n        this.begin = options.begin || Vector.Zero;\r\n        this.end = options.end || Vector.Zero;\r\n        this.offset = (_a = options.offset) !== null && _a !== void 0 ? _a : Vector.Zero;\r\n    }\r\n    /**\r\n     * Returns a clone of this Edge, not associated with any collider\r\n     */\r\n    clone() {\r\n        return new EdgeCollider({\r\n            begin: this.begin.clone(),\r\n            end: this.end.clone()\r\n        });\r\n    }\r\n    get worldPos() {\r\n        var _a;\r\n        const tx = this._transform;\r\n        return (_a = tx === null || tx === void 0 ? void 0 : tx.globalPos.add(this.offset)) !== null && _a !== void 0 ? _a : this.offset;\r\n    }\r\n    /**\r\n     * Get the center of the collision area in world coordinates\r\n     */\r\n    get center() {\r\n        const begin = this._getTransformedBegin();\r\n        const end = this._getTransformedEnd();\r\n        const pos = begin.average(end);\r\n        return pos;\r\n    }\r\n    _getTransformedBegin() {\r\n        return this._globalMatrix.multiply(this.begin);\r\n    }\r\n    _getTransformedEnd() {\r\n        return this._globalMatrix.multiply(this.end);\r\n    }\r\n    /**\r\n     * Returns the slope of the line in the form of a vector\r\n     */\r\n    getSlope() {\r\n        const begin = this._getTransformedBegin();\r\n        const end = this._getTransformedEnd();\r\n        const distance = begin.distance(end);\r\n        return end.sub(begin).scale(1 / distance);\r\n    }\r\n    /**\r\n     * Returns the length of the line segment in pixels\r\n     */\r\n    getLength() {\r\n        const begin = this._getTransformedBegin();\r\n        const end = this._getTransformedEnd();\r\n        const distance = begin.distance(end);\r\n        return distance;\r\n    }\r\n    /**\r\n     * Tests if a point is contained in this collision area\r\n     */\r\n    contains() {\r\n        return false;\r\n    }\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    rayCast(ray, max = Infinity) {\r\n        const numerator = this._getTransformedBegin().sub(ray.pos);\r\n        // Test is line and ray are parallel and non intersecting\r\n        if (ray.dir.cross(this.getSlope()) === 0 && numerator.cross(ray.dir) !== 0) {\r\n            return null;\r\n        }\r\n        // Lines are parallel\r\n        const divisor = ray.dir.cross(this.getSlope());\r\n        if (divisor === 0) {\r\n            return null;\r\n        }\r\n        const t = numerator.cross(this.getSlope()) / divisor;\r\n        if (t >= 0 && t <= max) {\r\n            const u = numerator.cross(ray.dir) / divisor / this.getLength();\r\n            if (u >= 0 && u <= 1) {\r\n                return ray.getPoint(t);\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n    /**\r\n     * Returns the closes line between this and another collider, from this -> collider\r\n     * @param shape\r\n     */\r\n    getClosestLineBetween(shape) {\r\n        if (shape instanceof CircleCollider) {\r\n            return ClosestLineJumpTable.CircleEdgeClosestLine(shape, this);\r\n        }\r\n        else if (shape instanceof PolygonCollider) {\r\n            return ClosestLineJumpTable.PolygonEdgeClosestLine(shape, this).flip();\r\n        }\r\n        else if (shape instanceof EdgeCollider) {\r\n            return ClosestLineJumpTable.EdgeEdgeClosestLine(this, shape);\r\n        }\r\n        else {\r\n            throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof shape}`);\r\n        }\r\n    }\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    collide(shape) {\r\n        if (shape instanceof CircleCollider) {\r\n            return CollisionJumpTable.CollideCircleEdge(shape, this);\r\n        }\r\n        else if (shape instanceof PolygonCollider) {\r\n            return CollisionJumpTable.CollidePolygonEdge(shape, this);\r\n        }\r\n        else if (shape instanceof EdgeCollider) {\r\n            return CollisionJumpTable.CollideEdgeEdge();\r\n        }\r\n        else {\r\n            throw new Error(`Edge could not collide with unknown CollisionShape ${typeof shape}`);\r\n        }\r\n    }\r\n    /**\r\n     * Find the point on the collider furthest in the direction specified\r\n     */\r\n    getFurthestPoint(direction) {\r\n        const transformedBegin = this._getTransformedBegin();\r\n        const transformedEnd = this._getTransformedEnd();\r\n        if (direction.dot(transformedBegin) > 0) {\r\n            return transformedBegin;\r\n        }\r\n        else {\r\n            return transformedEnd;\r\n        }\r\n    }\r\n    _boundsFromBeginEnd(begin, end, padding = 10) {\r\n        // A perfectly vertical or horizontal edge would have a bounds 0 width or height\r\n        // this causes problems for the collision system so we give them some padding\r\n        return new BoundingBox(Math.min(begin.x, end.x) - padding, Math.min(begin.y, end.y) - padding, Math.max(begin.x, end.x) + padding, Math.max(begin.y, end.y) + padding);\r\n    }\r\n    /**\r\n     * Get the axis aligned bounding box for the edge collider in world space\r\n     */\r\n    get bounds() {\r\n        const transformedBegin = this._getTransformedBegin();\r\n        const transformedEnd = this._getTransformedEnd();\r\n        return this._boundsFromBeginEnd(transformedBegin, transformedEnd);\r\n    }\r\n    /**\r\n     * Get the axis aligned bounding box for the edge collider in local space\r\n     */\r\n    get localBounds() {\r\n        return this._boundsFromBeginEnd(this.begin, this.end);\r\n    }\r\n    /**\r\n     * Returns this edge represented as a line in world coordinates\r\n     */\r\n    asLine() {\r\n        return new LineSegment(this._getTransformedBegin(), this._getTransformedEnd());\r\n    }\r\n    /**\r\n     * Return this edge as a line in local line coordinates (relative to the position)\r\n     */\r\n    asLocalLine() {\r\n        return new LineSegment(this.begin, this.end);\r\n    }\r\n    /**\r\n     * Get the axis associated with the edge\r\n     */\r\n    get axes() {\r\n        const e = this._getTransformedEnd().sub(this._getTransformedBegin());\r\n        const edgeNormal = e.normal();\r\n        const axes = [];\r\n        axes.push(edgeNormal);\r\n        axes.push(edgeNormal.negate());\r\n        axes.push(edgeNormal.normal());\r\n        axes.push(edgeNormal.normal().negate());\r\n        return axes;\r\n    }\r\n    /**\r\n     * Get the moment of inertia for an edge\r\n     * https://en.wikipedia.org/wiki/List_of_moments_of_inertia\r\n     */\r\n    getInertia(mass) {\r\n        const length = this.end.sub(this.begin).distance() / 2;\r\n        return mass * length * length;\r\n    }\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    update(transform) {\r\n        var _a;\r\n        this._transform = transform;\r\n        const globalMat = (_a = transform.matrix) !== null && _a !== void 0 ? _a : this._globalMatrix;\r\n        globalMat.clone(this._globalMatrix);\r\n        this._globalMatrix.translate(this.offset.x, this.offset.y);\r\n    }\r\n    /**\r\n     * Project the edge along a specified axis\r\n     */\r\n    project(axis) {\r\n        const scalars = [];\r\n        const points = [this._getTransformedBegin(), this._getTransformedEnd()];\r\n        const len = points.length;\r\n        for (let i = 0; i < len; i++) {\r\n            scalars.push(points[i].dot(axis));\r\n        }\r\n        return new Projection(Math.min.apply(Math, scalars), Math.max.apply(Math, scalars));\r\n    }\r\n    debug(ex, color) {\r\n        const begin = this._getTransformedBegin();\r\n        const end = this._getTransformedEnd();\r\n        ex.drawLine(begin, end, color, 2);\r\n        ex.drawCircle(begin, 2, color);\r\n        ex.drawCircle(end, 2, color);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/PolygonCollider.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Polygon collider for detecting collisions\r\n */\r\nclass PolygonCollider extends Collider {\r\n    constructor(options) {\r\n        var _a, _b;\r\n        super();\r\n        this._logger = Logger.getInstance();\r\n        this._transformedPoints = [];\r\n        this._sides = [];\r\n        this._localSides = [];\r\n        this._globalMatrix = AffineMatrix.identity();\r\n        this._transformedPointsDirty = true;\r\n        this._sidesDirty = true;\r\n        this._localSidesDirty = true;\r\n        this._localBoundsDirty = true;\r\n        this.offset = (_a = options.offset) !== null && _a !== void 0 ? _a : Vector.Zero;\r\n        this._globalMatrix.translate(this.offset.x, this.offset.y);\r\n        this.points = (_b = options.points) !== null && _b !== void 0 ? _b : [];\r\n        const counterClockwise = this._isCounterClockwiseWinding(this.points);\r\n        if (!counterClockwise) {\r\n            this.points.reverse();\r\n        }\r\n        if (!this.isConvex()) {\r\n            this._logger.warn('Excalibur only supports convex polygon colliders and will not behave properly.' +\r\n                'Call PolygonCollider.triangulate() to build a new collider composed of smaller convex triangles');\r\n        }\r\n        // calculate initial transformation\r\n        this._calculateTransformation();\r\n    }\r\n    /**\r\n     * Points in the polygon in order around the perimeter in local coordinates. These are relative from the body transform position.\r\n     * Excalibur stores these in counter-clockwise order\r\n     */\r\n    set points(points) {\r\n        this._localBoundsDirty = true;\r\n        this._localSidesDirty = true;\r\n        this._sidesDirty = true;\r\n        this._points = points;\r\n    }\r\n    /**\r\n     * Points in the polygon in order around the perimeter in local coordinates. These are relative from the body transform position.\r\n     * Excalibur stores these in counter-clockwise order\r\n     */\r\n    get points() {\r\n        return this._points;\r\n    }\r\n    _isCounterClockwiseWinding(points) {\r\n        // https://stackoverflow.com/a/1165943\r\n        let sum = 0;\r\n        for (let i = 0; i < points.length; i++) {\r\n            sum += (points[(i + 1) % points.length].x - points[i].x) * (points[(i + 1) % points.length].y + points[i].y);\r\n        }\r\n        return sum < 0;\r\n    }\r\n    /**\r\n     * Returns if the polygon collider is convex, Excalibur does not handle non-convex collision shapes.\r\n     * Call [[Polygon.triangulate]] to generate a [[CompositeCollider]] from this non-convex shape\r\n     */\r\n    isConvex() {\r\n        // From SO: https://stackoverflow.com/a/45372025\r\n        if (this.points.length < 3) {\r\n            return false;\r\n        }\r\n        let oldPoint = this.points[this.points.length - 2];\r\n        let newPoint = this.points[this.points.length - 1];\r\n        let direction = Math.atan2(newPoint.y - oldPoint.y, newPoint.x - oldPoint.x);\r\n        let oldDirection = 0;\r\n        let orientation = 0;\r\n        let angleSum = 0;\r\n        for (const [i, point] of this.points.entries()) {\r\n            oldPoint = newPoint;\r\n            oldDirection = direction;\r\n            newPoint = point;\r\n            direction = Math.atan2(newPoint.y - oldPoint.y, newPoint.x - oldPoint.x);\r\n            if (oldPoint.equals(newPoint)) {\r\n                return false; // repeat point\r\n            }\r\n            let angle = direction - oldDirection;\r\n            if (angle <= -Math.PI) {\r\n                angle += Math.PI * 2;\r\n            }\r\n            else if (angle > Math.PI) {\r\n                angle -= Math.PI * 2;\r\n            }\r\n            if (i === 0) {\r\n                if (angle === 0.0) {\r\n                    return false;\r\n                }\r\n                orientation = angle > 0 ? 1 : -1;\r\n            }\r\n            else {\r\n                if (orientation * angle <= 0) {\r\n                    return false;\r\n                }\r\n            }\r\n            angleSum += angle;\r\n        }\r\n        return Math.abs(Math.round(angleSum / (Math.PI * 2))) === 1;\r\n    }\r\n    /**\r\n     * Tessellates the polygon into a triangle fan as a [[CompositeCollider]] of triangle polygons\r\n     */\r\n    tessellate() {\r\n        const polygons = [];\r\n        for (let i = 1; i < this.points.length - 2; i++) {\r\n            polygons.push([this.points[0], this.points[i + 1], this.points[i + 2]]);\r\n        }\r\n        polygons.push([this.points[0], this.points[1], this.points[2]]);\r\n        return new CompositeCollider(polygons.map(points => Shape.Polygon(points)));\r\n    }\r\n    /**\r\n     * Triangulate the polygon collider using the \"Ear Clipping\" algorithm.\r\n     * Returns a new [[CompositeCollider]] made up of smaller triangles.\r\n     */\r\n    triangulate() {\r\n        // https://www.youtube.com/watch?v=hTJFcHutls8\r\n        if (this.points.length < 3) {\r\n            throw Error('Invalid polygon');\r\n        }\r\n        /**\r\n         * Helper to get a vertex in the list\r\n         */\r\n        function getItem(index, list) {\r\n            if (index >= list.length) {\r\n                return list[index % list.length];\r\n            }\r\n            else if (index < 0) {\r\n                return list[index % list.length + list.length];\r\n            }\r\n            else {\r\n                return list[index];\r\n            }\r\n        }\r\n        /**\r\n         * Quick test for point in triangle\r\n         */\r\n        function isPointInTriangle(point, a, b, c) {\r\n            const ab = b.sub(a);\r\n            const bc = c.sub(b);\r\n            const ca = a.sub(c);\r\n            const ap = point.sub(a);\r\n            const bp = point.sub(b);\r\n            const cp = point.sub(c);\r\n            const cross1 = ab.cross(ap);\r\n            const cross2 = bc.cross(bp);\r\n            const cross3 = ca.cross(cp);\r\n            if (cross1 > 0 || cross2 > 0 || cross3 > 0) {\r\n                return false;\r\n            }\r\n            return true;\r\n        }\r\n        const triangles = [];\r\n        const vertices = [...this.points];\r\n        const indices = range(0, this.points.length - 1);\r\n        // 1. Loop through vertices clockwise\r\n        //    if the vertex is convex (interior angle is < 180) (cross product positive)\r\n        //    if the polygon formed by it's edges doesn't contain the points\r\n        //         it's an ear add it to our list of triangles, and restart\r\n        while (indices.length > 3) {\r\n            for (let i = 0; i < indices.length; i++) {\r\n                const a = indices[i];\r\n                const b = getItem(i - 1, indices);\r\n                const c = getItem(i + 1, indices);\r\n                const va = vertices[a];\r\n                const vb = vertices[b];\r\n                const vc = vertices[c];\r\n                // Check convexity\r\n                const leftArm = vb.sub(va);\r\n                const rightArm = vc.sub(va);\r\n                const isConvex = rightArm.cross(leftArm) > 0; // positive cross means convex\r\n                if (!isConvex) {\r\n                    continue;\r\n                }\r\n                let isEar = true;\r\n                // Check that if any vertices are in the triangle a, b, c\r\n                for (let j = 0; j < indices.length; j++) {\r\n                    const vertIndex = indices[j];\r\n                    // We can skip these\r\n                    if (vertIndex === a || vertIndex === b || vertIndex === c) {\r\n                        continue;\r\n                    }\r\n                    const point = vertices[vertIndex];\r\n                    if (isPointInTriangle(point, vb, va, vc)) {\r\n                        isEar = false;\r\n                        break;\r\n                    }\r\n                }\r\n                // Add ear to polygon list and remove from list\r\n                if (isEar) {\r\n                    triangles.push([vb, va, vc]);\r\n                    indices.splice(i, 1);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        triangles.push([vertices[indices[0]], vertices[indices[1]], vertices[indices[2]]]);\r\n        return new CompositeCollider(triangles.map(points => Shape.Polygon(points)));\r\n    }\r\n    /**\r\n     * Returns a clone of this ConvexPolygon, not associated with any collider\r\n     */\r\n    clone() {\r\n        return new PolygonCollider({\r\n            offset: this.offset.clone(),\r\n            points: this.points.map((p) => p.clone())\r\n        });\r\n    }\r\n    /**\r\n     * Returns the world position of the collider, which is the current body transform plus any defined offset\r\n     */\r\n    get worldPos() {\r\n        if (this._transform) {\r\n            return this._transform.pos.add(this.offset);\r\n        }\r\n        return this.offset;\r\n    }\r\n    /**\r\n     * Get the center of the collider in world coordinates\r\n     */\r\n    get center() {\r\n        return this.bounds.center;\r\n    }\r\n    /**\r\n     * Calculates the underlying transformation from the body relative space to world space\r\n     */\r\n    _calculateTransformation() {\r\n        const points = this.points;\r\n        const len = points.length;\r\n        this._transformedPoints.length = 0; // clear out old transform\r\n        for (let i = 0; i < len; i++) {\r\n            this._transformedPoints[i] = this._globalMatrix.multiply(points[i].clone());\r\n        }\r\n    }\r\n    /**\r\n     * Gets the points that make up the polygon in world space, from actor relative space (if specified)\r\n     */\r\n    getTransformedPoints() {\r\n        if (this._transformedPointsDirty) {\r\n            this._calculateTransformation();\r\n            this._transformedPointsDirty = false;\r\n        }\r\n        return this._transformedPoints;\r\n    }\r\n    /**\r\n     * Gets the sides of the polygon in world space\r\n     */\r\n    getSides() {\r\n        if (this._sidesDirty) {\r\n            const lines = [];\r\n            const points = this.getTransformedPoints();\r\n            const len = points.length;\r\n            for (let i = 0; i < len; i++) {\r\n                // This winding is important\r\n                lines.push(new LineSegment(points[i], points[(i + 1) % len]));\r\n            }\r\n            this._sides = lines;\r\n            this._sidesDirty = false;\r\n        }\r\n        return this._sides;\r\n    }\r\n    /**\r\n     * Returns the local coordinate space sides\r\n     */\r\n    getLocalSides() {\r\n        if (this._localSidesDirty) {\r\n            const lines = [];\r\n            const points = this.points;\r\n            const len = points.length;\r\n            for (let i = 0; i < len; i++) {\r\n                // This winding is important\r\n                lines.push(new LineSegment(points[i], points[(i + 1) % len]));\r\n            }\r\n            this._localSides = lines;\r\n            this._localSidesDirty = false;\r\n        }\r\n        return this._localSides;\r\n    }\r\n    /**\r\n     * Given a direction vector find the world space side that is most in that direction\r\n     * @param direction\r\n     */\r\n    findSide(direction) {\r\n        const sides = this.getSides();\r\n        let bestSide = sides[0];\r\n        let maxDistance = -Number.MAX_VALUE;\r\n        for (let side = 0; side < sides.length; side++) {\r\n            const currentSide = sides[side];\r\n            const sideNormal = currentSide.normal();\r\n            const mostDirection = sideNormal.dot(direction);\r\n            if (mostDirection > maxDistance) {\r\n                bestSide = currentSide;\r\n                maxDistance = mostDirection;\r\n            }\r\n        }\r\n        return bestSide;\r\n    }\r\n    /**\r\n     * Given a direction vector find the local space side that is most in that direction\r\n     * @param direction\r\n     */\r\n    findLocalSide(direction) {\r\n        const sides = this.getLocalSides();\r\n        let bestSide = sides[0];\r\n        let maxDistance = -Number.MAX_VALUE;\r\n        for (let side = 0; side < sides.length; side++) {\r\n            const currentSide = sides[side];\r\n            const sideNormal = currentSide.normal();\r\n            const mostDirection = sideNormal.dot(direction);\r\n            if (mostDirection > maxDistance) {\r\n                bestSide = currentSide;\r\n                maxDistance = mostDirection;\r\n            }\r\n        }\r\n        return bestSide;\r\n    }\r\n    /**\r\n     * Get the axis associated with the convex polygon\r\n     */\r\n    get axes() {\r\n        const axes = [];\r\n        const sides = this.getSides();\r\n        for (let i = 0; i < sides.length; i++) {\r\n            axes.push(sides[i].normal());\r\n        }\r\n        return axes;\r\n    }\r\n    /**\r\n     * Updates the transform for the collision geometry\r\n     *\r\n     * Collision geometry (points/bounds) will not change until this is called.\r\n     * @param transform\r\n     */\r\n    update(transform) {\r\n        var _a;\r\n        this._transform = transform;\r\n        this._transformedPointsDirty = true;\r\n        this._sidesDirty = true;\r\n        // This change means an update must be performed in order for geometry to update\r\n        const globalMat = (_a = transform.matrix) !== null && _a !== void 0 ? _a : this._globalMatrix;\r\n        globalMat.clone(this._globalMatrix);\r\n        this._globalMatrix.translate(this.offset.x, this.offset.y);\r\n    }\r\n    /**\r\n     * Tests if a point is contained in this collider in world space\r\n     */\r\n    contains(point) {\r\n        // Always cast to the right, as long as we cast in a consistent fixed direction we\r\n        // will be fine\r\n        const testRay = new Ray(point, new Vector(1, 0));\r\n        const intersectCount = this.getSides().reduce(function (accum, side) {\r\n            if (testRay.intersect(side) >= 0) {\r\n                return accum + 1;\r\n            }\r\n            return accum;\r\n        }, 0);\r\n        if (intersectCount % 2 === 0) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    getClosestLineBetween(collider) {\r\n        if (collider instanceof CircleCollider) {\r\n            return ClosestLineJumpTable.PolygonCircleClosestLine(this, collider);\r\n        }\r\n        else if (collider instanceof PolygonCollider) {\r\n            return ClosestLineJumpTable.PolygonPolygonClosestLine(this, collider);\r\n        }\r\n        else if (collider instanceof EdgeCollider) {\r\n            return ClosestLineJumpTable.PolygonEdgeClosestLine(this, collider);\r\n        }\r\n        else {\r\n            throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof collider}`);\r\n        }\r\n    }\r\n    /**\r\n     * Returns a collision contact if the 2 colliders collide, otherwise collide will\r\n     * return null.\r\n     * @param collider\r\n     */\r\n    collide(collider) {\r\n        if (collider instanceof CircleCollider) {\r\n            return CollisionJumpTable.CollideCirclePolygon(collider, this);\r\n        }\r\n        else if (collider instanceof PolygonCollider) {\r\n            return CollisionJumpTable.CollidePolygonPolygon(this, collider);\r\n        }\r\n        else if (collider instanceof EdgeCollider) {\r\n            return CollisionJumpTable.CollidePolygonEdge(this, collider);\r\n        }\r\n        else {\r\n            throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof collider}`);\r\n        }\r\n    }\r\n    /**\r\n     * Find the point on the collider furthest in the direction specified\r\n     */\r\n    getFurthestPoint(direction) {\r\n        const pts = this.getTransformedPoints();\r\n        let furthestPoint = null;\r\n        let maxDistance = -Number.MAX_VALUE;\r\n        for (let i = 0; i < pts.length; i++) {\r\n            const distance = direction.dot(pts[i]);\r\n            if (distance > maxDistance) {\r\n                maxDistance = distance;\r\n                furthestPoint = pts[i];\r\n            }\r\n        }\r\n        return furthestPoint;\r\n    }\r\n    /**\r\n     * Find the local point on the collider furthest in the direction specified\r\n     * @param direction\r\n     */\r\n    getFurthestLocalPoint(direction) {\r\n        const pts = this.points;\r\n        let furthestPoint = pts[0];\r\n        let maxDistance = -Number.MAX_VALUE;\r\n        for (let i = 0; i < pts.length; i++) {\r\n            const distance = direction.dot(pts[i]);\r\n            if (distance > maxDistance) {\r\n                maxDistance = distance;\r\n                furthestPoint = pts[i];\r\n            }\r\n        }\r\n        return furthestPoint;\r\n    }\r\n    /**\r\n     * Finds the closes face to the point using perpendicular distance\r\n     * @param point point to test against polygon\r\n     */\r\n    getClosestFace(point) {\r\n        const sides = this.getSides();\r\n        let min = Number.POSITIVE_INFINITY;\r\n        let faceIndex = -1;\r\n        let distance = -1;\r\n        for (let i = 0; i < sides.length; i++) {\r\n            const dist = sides[i].distanceToPoint(point);\r\n            if (dist < min) {\r\n                min = dist;\r\n                faceIndex = i;\r\n                distance = dist;\r\n            }\r\n        }\r\n        if (faceIndex !== -1) {\r\n            return {\r\n                distance: sides[faceIndex].normal().scale(distance),\r\n                face: sides[faceIndex]\r\n            };\r\n        }\r\n        return null;\r\n    }\r\n    /**\r\n     * Get the axis aligned bounding box for the polygon collider in world coordinates\r\n     */\r\n    get bounds() {\r\n        return this.localBounds.transform(this._globalMatrix);\r\n    }\r\n    /**\r\n     * Get the axis aligned bounding box for the polygon collider in local coordinates\r\n     */\r\n    get localBounds() {\r\n        if (this._localBoundsDirty) {\r\n            this._localBounds = BoundingBox.fromPoints(this.points);\r\n            this._localBoundsDirty = false;\r\n        }\r\n        return this._localBounds;\r\n    }\r\n    /**\r\n     * Get the moment of inertia for an arbitrary polygon\r\n     * https://en.wikipedia.org/wiki/List_of_moments_of_inertia\r\n     */\r\n    getInertia(mass) {\r\n        if (this._cachedMass === mass && this._cachedInertia) {\r\n            return this._cachedInertia;\r\n        }\r\n        let numerator = 0;\r\n        let denominator = 0;\r\n        const points = this.points;\r\n        for (let i = 0; i < points.length; i++) {\r\n            const iplusone = (i + 1) % points.length;\r\n            const crossTerm = points[iplusone].cross(points[i]);\r\n            numerator +=\r\n                crossTerm *\r\n                    (points[i].dot(points[i]) + points[i].dot(points[iplusone]) + points[iplusone].dot(points[iplusone]));\r\n            denominator += crossTerm;\r\n        }\r\n        this._cachedMass = mass;\r\n        return this._cachedInertia = (mass / 6) * (numerator / denominator);\r\n    }\r\n    /**\r\n     * Casts a ray into the polygon and returns a vector representing the point of contact (in world space) or null if no collision.\r\n     */\r\n    rayCast(ray, max = Infinity) {\r\n        // find the minimum contact time greater than 0\r\n        // contact times less than 0 are behind the ray and we don't want those\r\n        const sides = this.getSides();\r\n        const len = sides.length;\r\n        let minContactTime = Number.MAX_VALUE;\r\n        let contactIndex = -1;\r\n        for (let i = 0; i < len; i++) {\r\n            const contactTime = ray.intersect(sides[i]);\r\n            if (contactTime >= 0 && contactTime < minContactTime && contactTime <= max) {\r\n                minContactTime = contactTime;\r\n                contactIndex = i;\r\n            }\r\n        }\r\n        // contact was found\r\n        if (contactIndex >= 0) {\r\n            return ray.getPoint(minContactTime);\r\n        }\r\n        // no contact found\r\n        return null;\r\n    }\r\n    /**\r\n     * Project the edges of the polygon along a specified axis\r\n     */\r\n    project(axis) {\r\n        const points = this.getTransformedPoints();\r\n        const len = points.length;\r\n        let min = Number.MAX_VALUE;\r\n        let max = -Number.MAX_VALUE;\r\n        for (let i = 0; i < len; i++) {\r\n            const scalar = points[i].dot(axis);\r\n            min = Math.min(min, scalar);\r\n            max = Math.max(max, scalar);\r\n        }\r\n        return new Projection(min, max);\r\n    }\r\n    debug(ex, color) {\r\n        const firstPoint = this.getTransformedPoints()[0];\r\n        const points = [firstPoint, ...this.getTransformedPoints(), firstPoint];\r\n        for (let i = 0; i < points.length - 1; i++) {\r\n            ex.drawLine(points[i], points[i + 1], color, 2);\r\n            ex.drawCircle(points[i], 2, color);\r\n            ex.drawCircle(points[i + 1], 2, color);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/Shape.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Excalibur helper for defining colliders quickly\r\n */\r\nclass Shape {\r\n    /**\r\n     * Creates a box collider, under the hood defines a [[PolygonCollider]] collider\r\n     * @param width Width of the box\r\n     * @param height Height of the box\r\n     * @param anchor Anchor of the box (default (.5, .5)) which positions the box relative to the center of the collider's position\r\n     * @param offset Optional offset relative to the collider in local coordinates\r\n     */\r\n    static Box(width, height, anchor = Vector.Half, offset = Vector.Zero) {\r\n        return new PolygonCollider({\r\n            points: new BoundingBox(-width * anchor.x, -height * anchor.y, width - width * anchor.x, height - height * anchor.y).getPoints(),\r\n            offset: offset\r\n        });\r\n    }\r\n    /**\r\n     * Creates a new [[PolygonCollider|arbitrary polygon]] collider\r\n     *\r\n     * PolygonColliders are useful for creating convex polygon shapes\r\n     * @param points Points specified in counter clockwise\r\n     * @param offset Optional offset relative to the collider in local coordinates\r\n     */\r\n    static Polygon(points, offset = Vector.Zero) {\r\n        return new PolygonCollider({\r\n            points: points,\r\n            offset: offset\r\n        });\r\n    }\r\n    /**\r\n     * Creates a new [[CircleCollider|circle]] collider\r\n     *\r\n     * Circle colliders are useful for balls, or to make collisions more forgiving on sharp edges\r\n     * @param radius Radius of the circle collider\r\n     * @param offset Optional offset relative to the collider in local coordinates\r\n     */\r\n    static Circle(radius, offset = Vector.Zero) {\r\n        return new CircleCollider({\r\n            radius: radius,\r\n            offset: offset\r\n        });\r\n    }\r\n    /**\r\n     * Creates a new [[EdgeCollider|edge]] collider\r\n     *\r\n     * Edge colliders are useful for  floors, walls, and other barriers\r\n     * @param begin Beginning of the edge in local coordinates to the collider\r\n     * @param end Ending of the edge in local coordinates to the collider\r\n     */\r\n    static Edge(begin, end) {\r\n        return new EdgeCollider({\r\n            begin: begin,\r\n            end: end\r\n        });\r\n    }\r\n    /**\r\n     * Creates a new capsule shaped [[CompositeCollider]] using 2 circles and a box\r\n     *\r\n     * Capsule colliders are useful for platformers with incline or jagged floors to have a smooth\r\n     * player experience.\r\n     *\r\n     * @param width\r\n     * @param height\r\n     * @param offset Optional offset\r\n     */\r\n    static Capsule(width, height, offset = Vector.Zero) {\r\n        const logger = Logger.getInstance();\r\n        if (width === height) {\r\n            logger.warn('A capsule collider with equal width and height is a circle, consider using a ex.Shape.Circle or ex.CircleCollider');\r\n        }\r\n        const vertical = height >= width;\r\n        if (vertical) {\r\n            // height > width, if equal maybe use a circle\r\n            const capsule = new CompositeCollider([\r\n                Shape.Circle(width / 2, vec(0, -height / 2 + width / 2).add(offset)),\r\n                Shape.Box(width, height - width, Vector.Half, offset),\r\n                Shape.Circle(width / 2, vec(0, height / 2 - width / 2).add(offset))\r\n            ]);\r\n            return capsule;\r\n        }\r\n        else {\r\n            // width > height, if equal maybe use a circle\r\n            const capsule = new CompositeCollider([\r\n                Shape.Circle(height / 2, vec(-width / 2 + height / 2, 0).add(offset)),\r\n                Shape.Box(width - height, height, Vector.Half, offset),\r\n                Shape.Circle(height / 2, vec(width / 2 - height / 2, 0).add(offset))\r\n            ]);\r\n            return capsule;\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/ColliderComponent.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass ColliderComponent extends Component {\r\n    constructor(collider) {\r\n        super();\r\n        this.type = 'ex.collider';\r\n        this.events = new EventDispatcher();\r\n        /**\r\n         * Observable that notifies when a collider is added to the body\r\n         */\r\n        this.$colliderAdded = new Observable();\r\n        /**\r\n         * Observable that notifies when a collider is removed from the body\r\n         */\r\n        this.$colliderRemoved = new Observable();\r\n        this.set(collider);\r\n    }\r\n    /**\r\n     * Get the current collider geometry\r\n     */\r\n    get() {\r\n        return this._collider;\r\n    }\r\n    /**\r\n     * Set the collider geometry\r\n     * @param collider\r\n     * @returns the collider you set\r\n     */\r\n    set(collider) {\r\n        this.clear();\r\n        if (collider) {\r\n            this._collider = collider;\r\n            this._collider.owner = this.owner;\r\n            this.events.wire(collider.events);\r\n            this.$colliderAdded.notifyAll(collider);\r\n            this.update();\r\n        }\r\n        return collider;\r\n    }\r\n    /**\r\n     * Remove collider geometry from collider component\r\n     */\r\n    clear() {\r\n        if (this._collider) {\r\n            this.events.unwire(this._collider.events);\r\n            this.$colliderRemoved.notifyAll(this._collider);\r\n            this._collider.owner = null;\r\n            this._collider = null;\r\n        }\r\n    }\r\n    /**\r\n     * Return world space bounds\r\n     */\r\n    get bounds() {\r\n        var _a, _b;\r\n        return (_b = (_a = this._collider) === null || _a === void 0 ? void 0 : _a.bounds) !== null && _b !== void 0 ? _b : new BoundingBox();\r\n    }\r\n    /**\r\n     * Return local space bounds\r\n     */\r\n    get localBounds() {\r\n        var _a, _b;\r\n        return (_b = (_a = this._collider) === null || _a === void 0 ? void 0 : _a.localBounds) !== null && _b !== void 0 ? _b : new BoundingBox();\r\n    }\r\n    /**\r\n     * Update the collider's transformed geometry\r\n     */\r\n    update() {\r\n        var _a;\r\n        const tx = (_a = this.owner) === null || _a === void 0 ? void 0 : _a.get(TransformComponent);\r\n        if (this._collider) {\r\n            this._collider.owner = this.owner;\r\n            if (tx) {\r\n                this._collider.update(tx.get());\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Collide component with another\r\n     * @param other\r\n     */\r\n    collide(other) {\r\n        let colliderA = this._collider;\r\n        let colliderB = other._collider;\r\n        if (!colliderA || !colliderB) {\r\n            return [];\r\n        }\r\n        // If we have a composite lefthand side :(\r\n        // Might bite us, but to avoid updating all the handlers make composite always left side\r\n        let flipped = false;\r\n        if (colliderB instanceof CompositeCollider) {\r\n            colliderA = colliderB;\r\n            colliderB = this._collider;\r\n            flipped = true;\r\n        }\r\n        if (this._collider) {\r\n            const contacts = colliderA.collide(colliderB);\r\n            if (contacts) {\r\n                if (flipped) {\r\n                    contacts.forEach((contact) => {\r\n                        contact.mtv = contact.mtv.negate();\r\n                        contact.normal = contact.normal.negate();\r\n                        contact.tangent = contact.normal.perpendicular();\r\n                        contact.colliderA = this._collider;\r\n                        contact.colliderB = other._collider;\r\n                    });\r\n                }\r\n                return contacts;\r\n            }\r\n            return [];\r\n        }\r\n        return [];\r\n    }\r\n    onAdd(entity) {\r\n        if (this._collider) {\r\n            this.update();\r\n        }\r\n        // Wire up the collider events to the owning entity\r\n        this.events.on('precollision', (evt) => {\r\n            const precollision = evt;\r\n            entity.events.emit('precollision', new PreCollisionEvent(precollision.target.owner, precollision.other.owner, precollision.side, precollision.intersection));\r\n        });\r\n        this.events.on('postcollision', (evt) => {\r\n            const postcollision = evt;\r\n            entity.events.emit('postcollision', new PostCollisionEvent(postcollision.target.owner, postcollision.other.owner, postcollision.side, postcollision.intersection));\r\n        });\r\n        this.events.on('collisionstart', (evt) => {\r\n            const start = evt;\r\n            entity.events.emit('collisionstart', new CollisionStartEvent(start.target.owner, start.other.owner, start.contact));\r\n        });\r\n        this.events.on('collisionend', (evt) => {\r\n            const end = evt;\r\n            entity.events.emit('collisionend', new CollisionEndEvent(end.target.owner, end.other.owner));\r\n        });\r\n    }\r\n    onRemove() {\r\n        this.events.clear();\r\n        this.$colliderRemoved.notifyAll(this._collider);\r\n    }\r\n    /**\r\n     * Sets up a box geometry based on the current bounds of the associated actor of this physics body.\r\n     *\r\n     * If no width/height are specified the body will attempt to use the associated actor's width/height.\r\n     *\r\n     * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.\r\n     */\r\n    useBoxCollider(width, height, anchor = Vector.Half, center = Vector.Zero) {\r\n        const collider = Shape.Box(width, height, anchor, center);\r\n        return (this.set(collider));\r\n    }\r\n    /**\r\n     * Sets up a [[PolygonCollider|polygon]] collision geometry based on a list of of points relative\r\n     *  to the anchor of the associated actor\r\n     * of this physics body.\r\n     *\r\n     * Only [convex polygon](https://en.wikipedia.org/wiki/Convex_polygon) definitions are supported.\r\n     *\r\n     * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.\r\n     */\r\n    usePolygonCollider(points, center = Vector.Zero) {\r\n        const poly = Shape.Polygon(points, center);\r\n        return (this.set(poly));\r\n    }\r\n    /**\r\n     * Sets up a [[Circle|circle collision geometry]] as the only collider with a specified radius in pixels.\r\n     *\r\n     * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.\r\n     */\r\n    useCircleCollider(radius, center = Vector.Zero) {\r\n        const collider = Shape.Circle(radius, center);\r\n        return (this.set(collider));\r\n    }\r\n    /**\r\n     * Sets up an [[Edge|edge collision geometry]] with a start point and an end point relative to the anchor of the associated actor\r\n     * of this physics body.\r\n     *\r\n     * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.\r\n     */\r\n    useEdgeCollider(begin, end) {\r\n        const collider = Shape.Edge(begin, end);\r\n        return (this.set(collider));\r\n    }\r\n    /**\r\n     * Setups up a [[CompositeCollider]] which can define any arbitrary set of excalibur colliders\r\n     * @param colliders\r\n     */\r\n    useCompositeCollider(colliders) {\r\n        return (this.set(new CompositeCollider(colliders)));\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/BodyComponent.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar DegreeOfFreedom;\r\n(function (DegreeOfFreedom) {\r\n    DegreeOfFreedom[\"Rotation\"] = \"rotation\";\r\n    DegreeOfFreedom[\"X\"] = \"x\";\r\n    DegreeOfFreedom[\"Y\"] = \"y\";\r\n})(DegreeOfFreedom || (DegreeOfFreedom = {}));\r\n/**\r\n * Body describes all the physical properties pos, vel, acc, rotation, angular velocity for the purpose of\r\n * of physics simulation.\r\n */\r\nclass BodyComponent extends Component {\r\n    constructor(options) {\r\n        var _a, _b, _c;\r\n        super();\r\n        this.type = 'ex.body';\r\n        this.dependencies = [TransformComponent, MotionComponent];\r\n        this.id = createId('body', BodyComponent._ID++);\r\n        this.events = new EventDispatcher();\r\n        this._oldTransform = new Transform();\r\n        /**\r\n         * Indicates whether the old transform has been captured at least once for interpolation\r\n         * @internal\r\n         */\r\n        this.__oldTransformCaptured = false;\r\n        /**\r\n         * Enable or disabled the fixed update interpolation, by default interpolation is on.\r\n         */\r\n        this.enableFixedUpdateInterpolate = true;\r\n        /**\r\n         * Collision type for the rigidbody physics simulation, by default [[CollisionType.PreventCollision]]\r\n         */\r\n        this.collisionType = CollisionType.PreventCollision;\r\n        /**\r\n         * The collision group for the body's colliders, by default body colliders collide with everything\r\n         */\r\n        this.group = CollisionGroup.All;\r\n        /**\r\n         * The amount of mass the body has\r\n         */\r\n        this._mass = Physics.defaultMass;\r\n        /**\r\n         * Amount of \"motion\" the body has before sleeping. If below [[Physics.sleepEpsilon]] it goes to \"sleep\"\r\n         */\r\n        this.sleepMotion = Physics.sleepEpsilon * 5;\r\n        /**\r\n         * Can this body sleep, by default bodies do not sleep\r\n         */\r\n        this.canSleep = Physics.bodiesCanSleepByDefault;\r\n        this._sleeping = false;\r\n        /**\r\n         * The also known as coefficient of restitution of this actor, represents the amount of energy preserved after collision or the\r\n         * bounciness. If 1, it is 100% bouncy, 0 it completely absorbs.\r\n         */\r\n        this.bounciness = 0.2;\r\n        /**\r\n         * The coefficient of friction on this actor\r\n         */\r\n        this.friction = 0.99;\r\n        /**\r\n         * Should use global gravity [[Physics.gravity]] in it's physics simulation, default is true\r\n         */\r\n        this.useGravity = true;\r\n        /**\r\n         * Degrees of freedom to limit\r\n         *\r\n         * Note: this only limits responses in the realistic solver, if velocity/angularVelocity is set the actor will still respond\r\n         */\r\n        this.limitDegreeOfFreedom = [];\r\n        /**\r\n         * The velocity of the actor last frame (vx, vy) in pixels/second\r\n         */\r\n        this.oldVel = new Vector(0, 0);\r\n        /**\r\n         * Gets/sets the acceleration of the actor from the last frame. This does not include the global acc [[Physics.acc]].\r\n         */\r\n        this.oldAcc = Vector.Zero;\r\n        if (options) {\r\n            this.collisionType = (_a = options.type) !== null && _a !== void 0 ? _a : this.collisionType;\r\n            this.group = (_b = options.group) !== null && _b !== void 0 ? _b : this.group;\r\n            this.useGravity = (_c = options.useGravity) !== null && _c !== void 0 ? _c : this.useGravity;\r\n        }\r\n    }\r\n    get matrix() {\r\n        return this.transform.get().matrix;\r\n    }\r\n    get mass() {\r\n        return this._mass;\r\n    }\r\n    set mass(newMass) {\r\n        this._mass = newMass;\r\n        this._cachedInertia = undefined;\r\n        this._cachedInverseInertia = undefined;\r\n    }\r\n    /**\r\n     * The inverse mass (1/mass) of the body. If [[CollisionType.Fixed]] this is 0, meaning \"infinite\" mass\r\n     */\r\n    get inverseMass() {\r\n        return this.collisionType === CollisionType.Fixed ? 0 : 1 / this.mass;\r\n    }\r\n    /**\r\n     * Whether this body is sleeping or not\r\n     */\r\n    get sleeping() {\r\n        return this._sleeping;\r\n    }\r\n    /**\r\n     * Set the sleep state of the body\r\n     * @param sleeping\r\n     */\r\n    setSleeping(sleeping) {\r\n        this._sleeping = sleeping;\r\n        if (!sleeping) {\r\n            // Give it a kick to keep it from falling asleep immediately\r\n            this.sleepMotion = Physics.sleepEpsilon * 5;\r\n        }\r\n        else {\r\n            this.vel = Vector.Zero;\r\n            this.acc = Vector.Zero;\r\n            this.angularVelocity = 0;\r\n            this.sleepMotion = 0;\r\n        }\r\n    }\r\n    /**\r\n     * Update body's [[BodyComponent.sleepMotion]] for the purpose of sleeping\r\n     */\r\n    updateMotion() {\r\n        if (this._sleeping) {\r\n            this.setSleeping(true);\r\n        }\r\n        const currentMotion = this.vel.size * this.vel.size + Math.abs(this.angularVelocity * this.angularVelocity);\r\n        const bias = Physics.sleepBias;\r\n        this.sleepMotion = bias * this.sleepMotion + (1 - bias) * currentMotion;\r\n        this.sleepMotion = clamp(this.sleepMotion, 0, 10 * Physics.sleepEpsilon);\r\n        if (this.canSleep && this.sleepMotion < Physics.sleepEpsilon) {\r\n            this.setSleeping(true);\r\n        }\r\n    }\r\n    /**\r\n     * Get the moment of inertia from the [[ColliderComponent]]\r\n     */\r\n    get inertia() {\r\n        if (this._cachedInertia) {\r\n            return this._cachedInertia;\r\n        }\r\n        // Inertia is a property of the geometry, so this is a little goofy but seems to be okay?\r\n        const collider = this.owner.get(ColliderComponent);\r\n        if (collider) {\r\n            collider.$colliderAdded.subscribe(() => {\r\n                this._cachedInertia = null;\r\n            });\r\n            collider.$colliderRemoved.subscribe(() => {\r\n                this._cachedInertia = null;\r\n            });\r\n            const maybeCollider = collider.get();\r\n            if (maybeCollider) {\r\n                return this._cachedInertia = maybeCollider.getInertia(this.mass);\r\n            }\r\n        }\r\n        return 0;\r\n    }\r\n    /**\r\n     * Get the inverse moment of inertial from the [[ColliderComponent]]. If [[CollisionType.Fixed]] this is 0, meaning \"infinite\" mass\r\n     */\r\n    get inverseInertia() {\r\n        if (this._cachedInverseInertia) {\r\n            return this._cachedInverseInertia;\r\n        }\r\n        return this._cachedInverseInertia = this.collisionType === CollisionType.Fixed ? 0 : 1 / this.inertia;\r\n    }\r\n    /**\r\n     * Returns if the owner is active\r\n     */\r\n    get active() {\r\n        var _a;\r\n        return !!((_a = this.owner) === null || _a === void 0 ? void 0 : _a.active);\r\n    }\r\n    /**\r\n     * @deprecated Use globalP0s\r\n     */\r\n    get center() {\r\n        return this.globalPos;\r\n    }\r\n    get transform() {\r\n        var _a;\r\n        return (_a = this.owner) === null || _a === void 0 ? void 0 : _a.get(TransformComponent);\r\n    }\r\n    get motion() {\r\n        var _a;\r\n        return (_a = this.owner) === null || _a === void 0 ? void 0 : _a.get(MotionComponent);\r\n    }\r\n    get pos() {\r\n        return this.transform.pos;\r\n    }\r\n    set pos(val) {\r\n        this.transform.pos = val;\r\n    }\r\n    /**\r\n     * The (x, y) position of the actor this will be in the middle of the actor if the\r\n     * [[Actor.anchor]] is set to (0.5, 0.5) which is default.\r\n     * If you want the (x, y) position to be the top left of the actor specify an anchor of (0, 0).\r\n     */\r\n    get globalPos() {\r\n        return this.transform.globalPos;\r\n    }\r\n    set globalPos(val) {\r\n        this.transform.globalPos = val;\r\n    }\r\n    /**\r\n     * The position of the actor last frame (x, y) in pixels\r\n     */\r\n    get oldPos() {\r\n        return this._oldTransform.pos;\r\n    }\r\n    /**\r\n     * The current velocity vector (vx, vy) of the actor in pixels/second\r\n     */\r\n    get vel() {\r\n        return this.motion.vel;\r\n    }\r\n    set vel(val) {\r\n        this.motion.vel = val;\r\n    }\r\n    /**\r\n     * The current acceleration vector (ax, ay) of the actor in pixels/second/second. An acceleration pointing down such as (0, 100) may\r\n     * be useful to simulate a gravitational effect.\r\n     */\r\n    get acc() {\r\n        return this.motion.acc;\r\n    }\r\n    set acc(val) {\r\n        this.motion.acc = val;\r\n    }\r\n    /**\r\n     * The current torque applied to the actor\r\n     */\r\n    get torque() {\r\n        return this.motion.torque;\r\n    }\r\n    set torque(val) {\r\n        this.motion.torque = val;\r\n    }\r\n    /**\r\n     * Gets/sets the rotation of the body from the last frame.\r\n     */\r\n    get oldRotation() {\r\n        return this._oldTransform.rotation;\r\n    }\r\n    /**\r\n     * The rotation of the body in radians\r\n     */\r\n    get rotation() {\r\n        return this.transform.globalRotation;\r\n    }\r\n    set rotation(val) {\r\n        this.transform.globalRotation = val;\r\n    }\r\n    /**\r\n     * The scale vector of the actor\r\n     */\r\n    get scale() {\r\n        return this.transform.globalScale;\r\n    }\r\n    set scale(val) {\r\n        this.transform.globalScale = val;\r\n    }\r\n    /**\r\n     * The scale of the actor last frame\r\n     */\r\n    get oldScale() {\r\n        return this._oldTransform.scale;\r\n    }\r\n    /**\r\n     * The scale rate of change of the actor in scale/second\r\n     */\r\n    get scaleFactor() {\r\n        return this.motion.scaleFactor;\r\n    }\r\n    set scaleFactor(scaleFactor) {\r\n        this.motion.scaleFactor = scaleFactor;\r\n    }\r\n    /**\r\n     * Get the angular velocity in radians/second\r\n     */\r\n    get angularVelocity() {\r\n        return this.motion.angularVelocity;\r\n    }\r\n    /**\r\n     * Set the angular velocity in radians/second\r\n     */\r\n    set angularVelocity(value) {\r\n        this.motion.angularVelocity = value;\r\n    }\r\n    /**\r\n     * Apply a specific impulse to the body\r\n     * @param point\r\n     * @param impulse\r\n     */\r\n    applyImpulse(point, impulse) {\r\n        if (this.collisionType !== CollisionType.Active) {\r\n            return; // only active objects participate in the simulation\r\n        }\r\n        const finalImpulse = impulse.scale(this.inverseMass);\r\n        if (this.limitDegreeOfFreedom.includes(DegreeOfFreedom.X)) {\r\n            finalImpulse.x = 0;\r\n        }\r\n        if (this.limitDegreeOfFreedom.includes(DegreeOfFreedom.Y)) {\r\n            finalImpulse.y = 0;\r\n        }\r\n        this.vel.addEqual(finalImpulse);\r\n        if (!this.limitDegreeOfFreedom.includes(DegreeOfFreedom.Rotation)) {\r\n            const distanceFromCenter = point.sub(this.globalPos);\r\n            this.angularVelocity += this.inverseInertia * distanceFromCenter.cross(impulse);\r\n        }\r\n    }\r\n    /**\r\n     * Apply only linear impulse to the body\r\n     * @param impulse\r\n     */\r\n    applyLinearImpulse(impulse) {\r\n        if (this.collisionType !== CollisionType.Active) {\r\n            return; // only active objects participate in the simulation\r\n        }\r\n        const finalImpulse = impulse.scale(this.inverseMass);\r\n        if (this.limitDegreeOfFreedom.includes(DegreeOfFreedom.X)) {\r\n            finalImpulse.x = 0;\r\n        }\r\n        if (this.limitDegreeOfFreedom.includes(DegreeOfFreedom.Y)) {\r\n            finalImpulse.y = 0;\r\n        }\r\n        this.vel = this.vel.add(finalImpulse);\r\n    }\r\n    /**\r\n     * Apply only angular impulse to the body\r\n     * @param point\r\n     * @param impulse\r\n     */\r\n    applyAngularImpulse(point, impulse) {\r\n        if (this.collisionType !== CollisionType.Active) {\r\n            return; // only active objects participate in the simulation\r\n        }\r\n        if (!this.limitDegreeOfFreedom.includes(DegreeOfFreedom.Rotation)) {\r\n            const distanceFromCenter = point.sub(this.globalPos);\r\n            this.angularVelocity += this.inverseInertia * distanceFromCenter.cross(impulse);\r\n        }\r\n    }\r\n    /**\r\n     * Sets the old versions of pos, vel, acc, and scale.\r\n     */\r\n    captureOldTransform() {\r\n        // Capture old values before integration step updates them\r\n        this.__oldTransformCaptured = true;\r\n        this.transform.get().clone(this._oldTransform);\r\n        this.oldVel.setTo(this.vel.x, this.vel.y);\r\n        this.oldAcc.setTo(this.acc.x, this.acc.y);\r\n    }\r\n}\r\nBodyComponent._ID = 0;\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/Entity.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * AddedComponent message\r\n */\r\nclass AddedComponent {\r\n    constructor(data) {\r\n        this.data = data;\r\n        this.type = 'Component Added';\r\n    }\r\n}\r\n/**\r\n * Type guard to know if message is f an Added Component\r\n */\r\nfunction isAddedComponent(x) {\r\n    return !!x && x.type === 'Component Added';\r\n}\r\n/**\r\n * RemovedComponent message\r\n */\r\nclass RemovedComponent {\r\n    constructor(data) {\r\n        this.data = data;\r\n        this.type = 'Component Removed';\r\n    }\r\n}\r\n/**\r\n * Type guard to know if message is for a Removed Component\r\n */\r\nfunction isRemovedComponent(x) {\r\n    return !!x && x.type === 'Component Removed';\r\n}\r\n/**\r\n * An Entity is the base type of anything that can have behavior in Excalibur, they are part of the built in entity component system\r\n *\r\n * Entities can be strongly typed with the components they contain\r\n *\r\n * ```typescript\r\n * const entity = new Entity<ComponentA | ComponentB>();\r\n * entity.components.a; // Type ComponentA\r\n * entity.components.b; // Type ComponentB\r\n * ```\r\n */\r\nclass Entity extends Class {\r\n    constructor(components, name) {\r\n        super();\r\n        /**\r\n         * The unique identifier for the entity\r\n         */\r\n        this.id = Entity._ID++;\r\n        this._name = 'anonymous';\r\n        /**\r\n         * Whether this entity is active, if set to false it will be reclaimed\r\n         */\r\n        this.active = true;\r\n        /**\r\n         * Bucket to hold on to deferred removals\r\n         */\r\n        this._componentsToRemove = [];\r\n        this._componentTypeToInstance = new Map();\r\n        this._componentStringToInstance = new Map();\r\n        this._tagsMemo = [];\r\n        this._typesMemo = [];\r\n        /**\r\n         * Observable that keeps track of component add or remove changes on the entity\r\n         */\r\n        this.componentAdded$ = new Observable();\r\n        this.componentRemoved$ = new Observable();\r\n        this._parent = null;\r\n        this.childrenAdded$ = new Observable();\r\n        this.childrenRemoved$ = new Observable();\r\n        this._children = [];\r\n        this._isInitialized = false;\r\n        this._setName(name);\r\n        if (components) {\r\n            for (const component of components) {\r\n                this.addComponent(component);\r\n            }\r\n        }\r\n    }\r\n    _setName(name) {\r\n        if (name) {\r\n            this._name = name;\r\n        }\r\n    }\r\n    get name() {\r\n        return this._name;\r\n    }\r\n    get events() {\r\n        return this.eventDispatcher;\r\n    }\r\n    /**\r\n     * Kill the entity, means it will no longer be updated. Kills are deferred to the end of the update.\r\n     */\r\n    kill() {\r\n        this.active = false;\r\n    }\r\n    isKilled() {\r\n        return !this.active;\r\n    }\r\n    /**\r\n     * Specifically get the tags on the entity from [[TagComponent]]\r\n     */\r\n    get tags() {\r\n        return this._tagsMemo;\r\n    }\r\n    /**\r\n     * Check if a tag exists on the entity\r\n     * @param tag name to check for\r\n     */\r\n    hasTag(tag) {\r\n        return this.tags.includes(tag);\r\n    }\r\n    /**\r\n     * Adds a tag to an entity\r\n     * @param tag\r\n     * @returns Entity\r\n     */\r\n    addTag(tag) {\r\n        return this.addComponent(new TagComponent(tag));\r\n    }\r\n    /**\r\n     * Removes a tag on the entity\r\n     *\r\n     * Removals are deferred until the end of update\r\n     * @param tag\r\n     * @param force Remove component immediately, no deferred\r\n     */\r\n    removeTag(tag, force = false) {\r\n        return this.removeComponent(tag, force);\r\n    }\r\n    /**\r\n     * The types of the components on the Entity\r\n     */\r\n    get types() {\r\n        return this._typesMemo;\r\n    }\r\n    _rebuildMemos() {\r\n        this._tagsMemo = Array.from(this._componentStringToInstance.values())\r\n            .filter((c) => c instanceof TagComponent)\r\n            .map((c) => c.type);\r\n        this._typesMemo = Array.from(this._componentStringToInstance.keys());\r\n    }\r\n    getComponents() {\r\n        return Array.from(this._componentStringToInstance.values());\r\n    }\r\n    _notifyAddComponent(component) {\r\n        this._rebuildMemos();\r\n        const added = new AddedComponent({\r\n            component,\r\n            entity: this\r\n        });\r\n        this.componentAdded$.notifyAll(added);\r\n    }\r\n    _notifyRemoveComponent(component) {\r\n        const removed = new RemovedComponent({\r\n            component,\r\n            entity: this\r\n        });\r\n        this.componentRemoved$.notifyAll(removed);\r\n        this._rebuildMemos();\r\n    }\r\n    get parent() {\r\n        return this._parent;\r\n    }\r\n    /**\r\n     * Get the direct children of this entity\r\n     */\r\n    get children() {\r\n        return this._children;\r\n    }\r\n    /**\r\n     * Unparents this entity, if there is a parent. Otherwise it does nothing.\r\n     */\r\n    unparent() {\r\n        if (this._parent) {\r\n            this._parent.removeChild(this);\r\n            this._parent = null;\r\n        }\r\n    }\r\n    /**\r\n     * Adds an entity to be a child of this entity\r\n     * @param entity\r\n     */\r\n    addChild(entity) {\r\n        if (entity.parent === null) {\r\n            if (this.getAncestors().includes(entity)) {\r\n                throw new Error('Cycle detected, cannot add entity');\r\n            }\r\n            this._children.push(entity);\r\n            entity._parent = this;\r\n            this.childrenAdded$.notifyAll(entity);\r\n        }\r\n        else {\r\n            throw new Error('Entity already has a parent, cannot add without unparenting');\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Remove an entity from children if it exists\r\n     * @param entity\r\n     */\r\n    removeChild(entity) {\r\n        if (entity.parent === this) {\r\n            removeItemFromArray(entity, this._children);\r\n            entity._parent = null;\r\n            this.childrenRemoved$.notifyAll(entity);\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Removes all children from this entity\r\n     */\r\n    removeAllChildren() {\r\n        this.children.forEach((c) => {\r\n            this.removeChild(c);\r\n        });\r\n        return this;\r\n    }\r\n    /**\r\n     * Returns a list of parent entities starting with the topmost parent. Includes the current entity.\r\n     */\r\n    getAncestors() {\r\n        const result = [this];\r\n        let current = this.parent;\r\n        while (current) {\r\n            result.push(current);\r\n            current = current.parent;\r\n        }\r\n        return result.reverse();\r\n    }\r\n    /**\r\n     * Returns a list of all the entities that descend from this entity. Includes the current entity.\r\n     */\r\n    getDescendants() {\r\n        let result = [this];\r\n        let queue = [this];\r\n        while (queue.length > 0) {\r\n            const curr = queue.pop();\r\n            queue = queue.concat(curr.children);\r\n            result = result.concat(curr.children);\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Creates a deep copy of the entity and a copy of all its components\r\n     */\r\n    clone() {\r\n        const newEntity = new Entity();\r\n        for (const c of this.types) {\r\n            newEntity.addComponent(this.get(c).clone());\r\n        }\r\n        for (const child of this.children) {\r\n            newEntity.addChild(child.clone());\r\n        }\r\n        return newEntity;\r\n    }\r\n    /**\r\n     * Adds a copy of all the components from another template entity as a \"prefab\"\r\n     * @param templateEntity Entity to use as a template\r\n     * @param force Force component replacement if it already exists on the target entity\r\n     */\r\n    addTemplate(templateEntity, force = false) {\r\n        for (const c of templateEntity.getComponents()) {\r\n            this.addComponent(c.clone(), force);\r\n        }\r\n        for (const child of templateEntity.children) {\r\n            this.addChild(child.clone().addTemplate(child));\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Adds a component to the entity\r\n     * @param component Component or Entity to add copy of components from\r\n     * @param force Optionally overwrite any existing components of the same type\r\n     */\r\n    addComponent(component, force = false) {\r\n        // if component already exists, skip if not forced\r\n        if (this.has(component.type)) {\r\n            if (force) {\r\n                // Remove existing component type if exists when forced\r\n                this.removeComponent(component);\r\n            }\r\n            else {\r\n                // early exit component exits\r\n                return this;\r\n            }\r\n        }\r\n        // TODO circular dependencies will be a problem\r\n        if (component.dependencies && component.dependencies.length) {\r\n            for (const ctor of component.dependencies) {\r\n                this.addComponent(new ctor());\r\n            }\r\n        }\r\n        component.owner = this;\r\n        const constuctorType = component.constructor;\r\n        this._componentTypeToInstance.set(constuctorType, component);\r\n        this._componentStringToInstance.set(component.type, component);\r\n        if (component.onAdd) {\r\n            component.onAdd(this);\r\n        }\r\n        this._notifyAddComponent(component);\r\n        return this;\r\n    }\r\n    /**\r\n     * Removes a component from the entity, by default removals are deferred to the end of entity update to avoid consistency issues\r\n     *\r\n     * Components can be force removed with the `force` flag, the removal is not deferred and happens immediately\r\n     * @param componentOrType\r\n     * @param force\r\n     */\r\n    removeComponent(componentOrType, force = false) {\r\n        if (force) {\r\n            if (typeof componentOrType === 'string') {\r\n                this._removeComponentByType(componentOrType);\r\n            }\r\n            else if (componentOrType instanceof Component) {\r\n                this._removeComponentByType(componentOrType.type);\r\n            }\r\n        }\r\n        else {\r\n            this._componentsToRemove.push(componentOrType);\r\n        }\r\n        return this;\r\n    }\r\n    _removeComponentByType(type) {\r\n        if (this.has(type)) {\r\n            const component = this.get(type);\r\n            component.owner = null;\r\n            if (component.onRemove) {\r\n                component.onRemove(this);\r\n            }\r\n            const ctor = component.constructor;\r\n            this._componentTypeToInstance.delete(ctor);\r\n            this._componentStringToInstance.delete(component.type);\r\n            this._notifyRemoveComponent(component);\r\n        }\r\n    }\r\n    /**\r\n     * @hidden\r\n     * @internal\r\n     */\r\n    processComponentRemoval() {\r\n        for (const componentOrType of this._componentsToRemove) {\r\n            const type = typeof componentOrType === 'string' ? componentOrType : componentOrType.type;\r\n            this._removeComponentByType(type);\r\n        }\r\n        this._componentsToRemove.length = 0;\r\n    }\r\n    has(type) {\r\n        if (typeof type === 'string') {\r\n            return this._componentStringToInstance.has(type);\r\n        }\r\n        else {\r\n            return this._componentTypeToInstance.has(type);\r\n        }\r\n    }\r\n    get(type) {\r\n        if (typeof type === 'string') {\r\n            return this._componentStringToInstance.get(type);\r\n        }\r\n        else {\r\n            return this._componentTypeToInstance.get(type);\r\n        }\r\n    }\r\n    /**\r\n     * Gets whether the actor is Initialized\r\n     */\r\n    get isInitialized() {\r\n        return this._isInitialized;\r\n    }\r\n    /**\r\n     * Initializes this entity, meant to be called by the Scene before first update not by users of Excalibur.\r\n     *\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * @internal\r\n     */\r\n    _initialize(engine) {\r\n        if (!this.isInitialized) {\r\n            this.onInitialize(engine);\r\n            super.emit('initialize', new InitializeEvent(engine, this));\r\n            this._isInitialized = true;\r\n        }\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPreUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _preupdate(engine, delta) {\r\n        this.emit('preupdate', new PreUpdateEvent(engine, delta, this));\r\n        this.onPreUpdate(engine, delta);\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPostUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _postupdate(engine, delta) {\r\n        this.emit('postupdate', new PostUpdateEvent(engine, delta, this));\r\n        this.onPostUpdate(engine, delta);\r\n    }\r\n    /**\r\n     * `onInitialize` is called before the first update of the entity. This method is meant to be\r\n     * overridden.\r\n     *\r\n     * Synonymous with the event handler `.on('initialize', (evt) => {...})`\r\n     */\r\n    onInitialize(_engine) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * Safe to override onPreUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPreUpdate` is called directly before an entity is updated.\r\n     */\r\n    onPreUpdate(_engine, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('postupdate', (evt) =>{...})`\r\n     *\r\n     * `onPostUpdate` is called directly after an entity is updated.\r\n     */\r\n    onPostUpdate(_engine, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     *\r\n     * Entity update lifecycle, called internally\r\n     *\r\n     * @internal\r\n     * @param engine\r\n     * @param delta\r\n     */\r\n    update(engine, delta) {\r\n        this._initialize(engine);\r\n        this._preupdate(engine, delta);\r\n        for (const child of this.children) {\r\n            child.update(engine, delta);\r\n        }\r\n        this._postupdate(engine, delta);\r\n    }\r\n}\r\nEntity._ID = 0;\r\n\n;// CONCATENATED MODULE: ./Graphics/GraphicsComponent.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Type guard for checking if a Graphic HasTick (used for graphics that change over time like animations)\r\n * @param graphic\r\n */\r\nfunction hasGraphicsTick(graphic) {\r\n    return !!graphic.tick;\r\n}\r\nclass GraphicsLayer {\r\n    constructor(_options, _graphics) {\r\n        this._options = _options;\r\n        this._graphics = _graphics;\r\n        this.graphics = [];\r\n    }\r\n    get name() {\r\n        return this._options.name;\r\n    }\r\n    hide(nameOrGraphic) {\r\n        if (!nameOrGraphic) {\r\n            this.graphics.length = 0;\r\n        }\r\n        else {\r\n            let gfx = null;\r\n            if (nameOrGraphic instanceof Graphic) {\r\n                gfx = nameOrGraphic;\r\n            }\r\n            else {\r\n                gfx = this._graphics.getGraphic(nameOrGraphic);\r\n            }\r\n            this.graphics = this.graphics.filter((g) => g.graphic !== gfx);\r\n            this._graphics.recalculateBounds();\r\n        }\r\n    }\r\n    /**\r\n     * Show a graphic by name or instance at an offset, graphics are shown in the order in which `show()` is called.\r\n     *\r\n     * If `show()` is called multiple times for the same graphic it will be shown multiple times.\r\n     * @param nameOrGraphic\r\n     * @param options\r\n     */\r\n    show(nameOrGraphic, options) {\r\n        options = { ...options };\r\n        let gfx;\r\n        if (nameOrGraphic instanceof Graphic) {\r\n            gfx = this._graphics.copyGraphics ? nameOrGraphic.clone() : nameOrGraphic;\r\n        }\r\n        else {\r\n            gfx = this._graphics.getGraphic(nameOrGraphic);\r\n            if (!gfx) {\r\n                Logger.getInstance().error(`No such graphic added to component named ${nameOrGraphic}. These named graphics are available: `, this._graphics.getNames());\r\n            }\r\n        }\r\n        if (gfx) {\r\n            this.graphics.push({ graphic: gfx, options });\r\n            this._graphics.recalculateBounds();\r\n            return gfx;\r\n        }\r\n        else {\r\n            return null;\r\n        }\r\n    }\r\n    /**\r\n     * Use a specific graphic, swap out any current graphics being shown\r\n     * @param nameOrGraphic\r\n     * @param options\r\n     */\r\n    use(nameOrGraphic, options) {\r\n        options = { ...options };\r\n        this.hide();\r\n        return this.show(nameOrGraphic, options);\r\n    }\r\n    /**\r\n     * Current order of the layer, higher numbers are on top, lower numbers are on the bottom.\r\n     *\r\n     * For example a layer with `order = -1` would be under a layer of `order = 1`\r\n     */\r\n    get order() {\r\n        return this._options.order;\r\n    }\r\n    /**\r\n     * Set the order of the layer, higher numbers are on top, lower numbers are on the bottom.\r\n     *\r\n     * For example a layer with `order = -1` would be under a layer of `order = 1`\r\n     */\r\n    set order(order) {\r\n        this._options.order = order;\r\n    }\r\n    /**\r\n     * Get or set the pixel offset from the layer anchor for all graphics in the layer\r\n     */\r\n    get offset() {\r\n        var _a;\r\n        return (_a = this._options.offset) !== null && _a !== void 0 ? _a : Vector.Zero;\r\n    }\r\n    set offset(value) {\r\n        this._options.offset = value;\r\n    }\r\n    get currentKeys() {\r\n        var _a;\r\n        return (_a = this.name) !== null && _a !== void 0 ? _a : 'anonymous';\r\n    }\r\n}\r\nclass GraphicsLayers {\r\n    constructor(_component) {\r\n        this._component = _component;\r\n        this._layers = [];\r\n        this._layerMap = {};\r\n        this.default = new GraphicsLayer({ name: 'default', order: 0 }, _component);\r\n        this._maybeAddLayer(this.default);\r\n    }\r\n    create(options) {\r\n        const layer = new GraphicsLayer(options, this._component);\r\n        return this._maybeAddLayer(layer);\r\n    }\r\n    get(name) {\r\n        if (name) {\r\n            return this._getLayer(name);\r\n        }\r\n        return this._layers;\r\n    }\r\n    currentKeys() {\r\n        const graphicsLayerKeys = [];\r\n        for (const layer of this._layers) {\r\n            graphicsLayerKeys.push(layer.currentKeys);\r\n        }\r\n        return graphicsLayerKeys;\r\n    }\r\n    has(name) {\r\n        return name in this._layerMap;\r\n    }\r\n    _maybeAddLayer(layer) {\r\n        if (this._layerMap[layer.name]) {\r\n            // todo log warning\r\n            return this._layerMap[layer.name];\r\n        }\r\n        this._layerMap[layer.name] = layer;\r\n        this._layers.push(layer);\r\n        this._layers.sort((a, b) => a.order - b.order);\r\n        return layer;\r\n    }\r\n    _getLayer(name) {\r\n        return this._layerMap[name];\r\n    }\r\n}\r\n/**\r\n * Component to manage drawings, using with the position component\r\n */\r\nclass GraphicsComponent extends Component {\r\n    constructor(options) {\r\n        super();\r\n        this.type = 'ex.graphics';\r\n        this._graphics = {};\r\n        /**\r\n         * Sets or gets wether any drawing should be visible in this component\r\n         */\r\n        this.visible = true;\r\n        /**\r\n         * Sets or gets wither all drawings should have an opacity applied\r\n         */\r\n        this.opacity = 1;\r\n        /**\r\n         * Offset to apply to graphics by default\r\n         */\r\n        this.offset = Vector.Zero;\r\n        /**\r\n         * Anchor to apply to graphics by default\r\n         */\r\n        this.anchor = Vector.Half;\r\n        /**\r\n         * If set to true graphics added to the component will be copied. This can affect performance\r\n         */\r\n        this.copyGraphics = false;\r\n        this._localBounds = null;\r\n        // Defaults\r\n        options = {\r\n            visible: this.visible,\r\n            ...options\r\n        };\r\n        const { current, anchor, opacity, visible, graphics, offset, copyGraphics, onPreDraw, onPostDraw } = options;\r\n        this._graphics = graphics || {};\r\n        this.offset = offset !== null && offset !== void 0 ? offset : this.offset;\r\n        this.opacity = opacity !== null && opacity !== void 0 ? opacity : this.opacity;\r\n        this.anchor = anchor !== null && anchor !== void 0 ? anchor : this.anchor;\r\n        this.copyGraphics = copyGraphics !== null && copyGraphics !== void 0 ? copyGraphics : this.copyGraphics;\r\n        this.onPreDraw = onPreDraw !== null && onPreDraw !== void 0 ? onPreDraw : this.onPreDraw;\r\n        this.onPostDraw = onPostDraw !== null && onPostDraw !== void 0 ? onPostDraw : this.onPostDraw;\r\n        this.visible = !!visible;\r\n        this.layers = new GraphicsLayers(this);\r\n        if (current && this._graphics[current]) {\r\n            this.show(this._graphics[current]);\r\n        }\r\n    }\r\n    getGraphic(name) {\r\n        return this._graphics[name];\r\n    }\r\n    /**\r\n     * Get registered graphics names\r\n     */\r\n    getNames() {\r\n        return Object.keys(this._graphics);\r\n    }\r\n    /**\r\n     * Returns the currently displayed graphics and their offsets, empty array if hidden\r\n     */\r\n    get current() {\r\n        return this.layers.default.graphics;\r\n    }\r\n    /**\r\n     * Returns all graphics associated with this component\r\n     */\r\n    get graphics() {\r\n        return this._graphics;\r\n    }\r\n    add(nameOrGraphic, graphic) {\r\n        let name = 'default';\r\n        let graphicToSet = null;\r\n        if (typeof nameOrGraphic === 'string') {\r\n            name = nameOrGraphic;\r\n            graphicToSet = graphic;\r\n        }\r\n        else {\r\n            graphicToSet = nameOrGraphic;\r\n        }\r\n        this._graphics[name] = this.copyGraphics ? graphicToSet.clone() : graphicToSet;\r\n        if (name === 'default') {\r\n            this.show('default');\r\n        }\r\n        return graphicToSet;\r\n    }\r\n    /**\r\n     * Show a graphic by name on the **default** layer, returns the new [[Graphic]]\r\n     */\r\n    show(nameOrGraphic, options) {\r\n        const result = this.layers.default.show(nameOrGraphic, options);\r\n        this.recalculateBounds();\r\n        return result;\r\n    }\r\n    /**\r\n     * Use a graphic only, swap out any graphics on the **default** layer, returns the new [[Graphic]]\r\n     * @param nameOrGraphic\r\n     * @param options\r\n     */\r\n    use(nameOrGraphic, options) {\r\n        const result = this.layers.default.use(nameOrGraphic, options);\r\n        this.recalculateBounds();\r\n        return result;\r\n    }\r\n    hide(nameOrGraphic) {\r\n        this.layers.default.hide(nameOrGraphic);\r\n    }\r\n    set localBounds(bounds) {\r\n        this._localBounds = bounds;\r\n    }\r\n    recalculateBounds() {\r\n        let bb = new BoundingBox();\r\n        for (const layer of this.layers.get()) {\r\n            for (const { graphic, options } of layer.graphics) {\r\n                let anchor = this.anchor;\r\n                let offset = this.offset;\r\n                if (options === null || options === void 0 ? void 0 : options.anchor) {\r\n                    anchor = options.anchor;\r\n                }\r\n                if (options === null || options === void 0 ? void 0 : options.offset) {\r\n                    offset = options.offset;\r\n                }\r\n                const bounds = graphic.localBounds;\r\n                const offsetX = -bounds.width * anchor.x + offset.x;\r\n                const offsetY = -bounds.height * anchor.y + offset.y;\r\n                bb = graphic === null || graphic === void 0 ? void 0 : graphic.localBounds.translate(vec(offsetX + layer.offset.x, offsetY + layer.offset.y)).combine(bb);\r\n            }\r\n        }\r\n        this._localBounds = bb;\r\n    }\r\n    get localBounds() {\r\n        if (!this._localBounds || this._localBounds.hasZeroDimensions()) {\r\n            this.recalculateBounds();\r\n        }\r\n        return this._localBounds;\r\n    }\r\n    /**\r\n     * Update underlying graphics if necesary, called internally\r\n     * @param elapsed\r\n     * @internal\r\n     */\r\n    update(elapsed, idempotencyToken = 0) {\r\n        for (const layer of this.layers.get()) {\r\n            for (const { graphic } of layer.graphics) {\r\n                if (hasGraphicsTick(graphic)) {\r\n                    graphic === null || graphic === void 0 ? void 0 : graphic.tick(elapsed, idempotencyToken);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Rectangle.ts\n\r\n/**\r\n * A Rectangle [[Graphic]] for drawing rectangles to the [[ExcaliburGraphicsContext]]\r\n */\r\nclass Rectangle extends Raster {\r\n    constructor(options) {\r\n        super(options);\r\n        this.width = options.width;\r\n        this.height = options.height;\r\n        this.rasterize();\r\n    }\r\n    clone() {\r\n        return new Rectangle({\r\n            width: this.width,\r\n            height: this.height,\r\n            ...this.cloneGraphicOptions(),\r\n            ...this.cloneRasterOptions()\r\n        });\r\n    }\r\n    execute(ctx) {\r\n        if (this.color) {\r\n            ctx.fillRect(0, 0, this.width, this.height);\r\n        }\r\n        if (this.strokeColor) {\r\n            ctx.strokeRect(0, 0, this.width, this.height);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Circle.ts\n\r\n\r\n/**\r\n * A circle [[Graphic]] for drawing circles to the [[ExcaliburGraphicsContext]]\r\n *\r\n * Circles default to [[ImageFiltering.Blended]]\r\n */\r\nclass Circle extends Raster {\r\n    constructor(options) {\r\n        var _a, _b;\r\n        super(options);\r\n        this._radius = 0;\r\n        this.padding = (_a = options.padding) !== null && _a !== void 0 ? _a : 2; // default 2 padding for circles looks nice\r\n        this.radius = options.radius;\r\n        this.filtering = (_b = options.filtering) !== null && _b !== void 0 ? _b : ImageFiltering.Blended;\r\n        this.rasterize();\r\n    }\r\n    get radius() {\r\n        return this._radius;\r\n    }\r\n    set radius(value) {\r\n        this._radius = value;\r\n        this.width = this._radius * 2;\r\n        this.height = this._radius * 2;\r\n        this.flagDirty();\r\n    }\r\n    clone() {\r\n        return new Circle({\r\n            radius: this.radius,\r\n            ...this.cloneGraphicOptions(),\r\n            ...this.cloneRasterOptions()\r\n        });\r\n    }\r\n    execute(ctx) {\r\n        if (this.radius > 0) {\r\n            ctx.beginPath();\r\n            ctx.arc(this.radius, this.radius, this.radius, 0, Math.PI * 2);\r\n            if (this.color) {\r\n                ctx.fill();\r\n            }\r\n            if (this.strokeColor) {\r\n                ctx.stroke();\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Input/PointerComponent.ts\n\r\n/**\r\n * Add this component to optionally configure how the pointer\r\n * system detects pointer events.\r\n *\r\n * By default the collider shape is used and graphics bounds is not.\r\n *\r\n * If both collider shape and graphics bounds are enabled it will fire events if either or\r\n * are intersecting the pointer.\r\n */\r\nclass PointerComponent extends Component {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.type = 'ex.pointer';\r\n        /**\r\n         * Use any existing Collider component geometry for pointer events. This is useful if you want\r\n         * user pointer events only to trigger on the same collision geometry used in the collider component\r\n         * for collision resolution. Default is `true`.\r\n         */\r\n        this.useColliderShape = true;\r\n        /**\r\n         * Use any existing Graphics component bounds for pointers. This is useful if you want the axis aligned\r\n         * bounds around the graphic to trigger pointer events. Default is `false`.\r\n         */\r\n        this.useGraphicsBounds = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/EasingFunctions.ts\n\r\n/**\r\n * Standard easing functions for motion in Excalibur, defined on a domain of [0, duration] and a range from [+startValue,+endValue]\r\n * Given a time, the function will return a value from positive startValue to positive endValue.\r\n *\r\n * ```js\r\n * function Linear (t) {\r\n *    return t * t;\r\n * }\r\n *\r\n * // accelerating from zero velocity\r\n * function EaseInQuad (t) {\r\n *    return t * t;\r\n * }\r\n *\r\n * // decelerating to zero velocity\r\n * function EaseOutQuad (t) {\r\n *    return t * (2 - t);\r\n * }\r\n *\r\n * // acceleration until halfway, then deceleration\r\n * function EaseInOutQuad (t) {\r\n *    return t < .5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\r\n * }\r\n *\r\n * // accelerating from zero velocity\r\n * function EaseInCubic (t) {\r\n *    return t * t * t;\r\n * }\r\n *\r\n * // decelerating to zero velocity\r\n * function EaseOutCubic (t) {\r\n *    return (--t) * t * t + 1;\r\n * }\r\n *\r\n * // acceleration until halfway, then deceleration\r\n * function EaseInOutCubic (t) {\r\n *    return t < .5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1;\r\n * }\r\n * ```\r\n */\r\nclass EasingFunctions {\r\n    static CreateReversibleEasingFunction(easing) {\r\n        return (time, start, end, duration) => {\r\n            if (end < start) {\r\n                return start - (easing(time, end, start, duration) - end);\r\n            }\r\n            else {\r\n                return easing(time, start, end, duration);\r\n            }\r\n        };\r\n    }\r\n    static CreateVectorEasingFunction(easing) {\r\n        return (time, start, end, duration) => {\r\n            return new Vector(easing(time, start.x, end.x, duration), easing(time, start.y, end.y, duration));\r\n        };\r\n    }\r\n}\r\nEasingFunctions.Linear = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\r\n    endValue = endValue - startValue;\r\n    return (endValue * currentTime) / duration + startValue;\r\n});\r\nEasingFunctions.EaseInQuad = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\r\n    endValue = endValue - startValue;\r\n    currentTime /= duration;\r\n    return endValue * currentTime * currentTime + startValue;\r\n});\r\nEasingFunctions.EaseOutQuad = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\r\n    endValue = endValue - startValue;\r\n    currentTime /= duration;\r\n    return -endValue * currentTime * (currentTime - 2) + startValue;\r\n});\r\nEasingFunctions.EaseInOutQuad = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\r\n    endValue = endValue - startValue;\r\n    currentTime /= duration / 2;\r\n    if (currentTime < 1) {\r\n        return (endValue / 2) * currentTime * currentTime + startValue;\r\n    }\r\n    currentTime--;\r\n    return (-endValue / 2) * (currentTime * (currentTime - 2) - 1) + startValue;\r\n});\r\nEasingFunctions.EaseInCubic = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\r\n    endValue = endValue - startValue;\r\n    currentTime /= duration;\r\n    return endValue * currentTime * currentTime * currentTime + startValue;\r\n});\r\nEasingFunctions.EaseOutCubic = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\r\n    endValue = endValue - startValue;\r\n    currentTime /= duration;\r\n    currentTime--;\r\n    return endValue * (currentTime * currentTime * currentTime + 1) + startValue;\r\n});\r\nEasingFunctions.EaseInOutCubic = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\r\n    endValue = endValue - startValue;\r\n    currentTime /= duration / 2;\r\n    if (currentTime < 1) {\r\n        return (endValue / 2) * currentTime * currentTime * currentTime + startValue;\r\n    }\r\n    currentTime -= 2;\r\n    return (endValue / 2) * (currentTime * currentTime * currentTime + 2) + startValue;\r\n});\r\n\n;// CONCATENATED MODULE: ./Actions/ActionQueue.ts\n/**\r\n * Action Queues represent an ordered sequence of actions\r\n *\r\n * Action queues are part of the [[ActionContext|Action API]] and\r\n * store the list of actions to be executed for an [[Actor]].\r\n *\r\n * Actors implement [[Actor.actions]] which can be manipulated by\r\n * advanced users to adjust the actions currently being executed in the\r\n * queue.\r\n */\r\nclass ActionQueue {\r\n    constructor(entity) {\r\n        this._actions = [];\r\n        this._completedActions = [];\r\n        this._entity = entity;\r\n    }\r\n    /**\r\n     * Add an action to the sequence\r\n     * @param action\r\n     */\r\n    add(action) {\r\n        this._actions.push(action);\r\n    }\r\n    /**\r\n     * Remove an action by reference from the sequence\r\n     * @param action\r\n     */\r\n    remove(action) {\r\n        const index = this._actions.indexOf(action);\r\n        this._actions.splice(index, 1);\r\n    }\r\n    /**\r\n     * Removes all actions from this sequence\r\n     */\r\n    clearActions() {\r\n        this._actions.length = 0;\r\n        this._completedActions.length = 0;\r\n        if (this._currentAction) {\r\n            this._currentAction.stop();\r\n        }\r\n    }\r\n    /**\r\n     *\r\n     * @returns The total list of actions in this sequence complete or not\r\n     */\r\n    getActions() {\r\n        return this._actions.concat(this._completedActions);\r\n    }\r\n    /**\r\n     *\r\n     * @returns `true` if there are more actions to process in the sequence\r\n     */\r\n    hasNext() {\r\n        return this._actions.length > 0;\r\n    }\r\n    /**\r\n     * @returns `true` if the current sequence of actions is done\r\n     */\r\n    isComplete() {\r\n        return this._actions.length === 0;\r\n    }\r\n    /**\r\n     * Resets the sequence of actions, this is used to restart a sequence from the beginning\r\n     */\r\n    reset() {\r\n        this._actions = this.getActions();\r\n        const len = this._actions.length;\r\n        for (let i = 0; i < len; i++) {\r\n            this._actions[i].reset();\r\n        }\r\n        this._completedActions = [];\r\n    }\r\n    /**\r\n     * Update the queue which updates actions and handles completing actions\r\n     * @param elapsedMs\r\n     */\r\n    update(elapsedMs) {\r\n        if (this._actions.length > 0) {\r\n            this._currentAction = this._actions[0];\r\n            this._currentAction.update(elapsedMs);\r\n            if (this._currentAction.isComplete(this._entity)) {\r\n                this._completedActions.push(this._actions.shift());\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/Repeat.ts\n\r\nclass Repeat {\r\n    constructor(entity, repeatBuilder, repeat) {\r\n        this._stopped = false;\r\n        this._repeatBuilder = repeatBuilder;\r\n        this._repeatContext = new ActionContext(entity);\r\n        this._actionQueue = this._repeatContext.getQueue();\r\n        this._repeat = repeat;\r\n        this._originalRepeat = repeat;\r\n        this._repeatBuilder(this._repeatContext);\r\n        this._repeat--; // current execution is the first repeat\r\n    }\r\n    update(delta) {\r\n        if (this._actionQueue.isComplete()) {\r\n            this._actionQueue.clearActions();\r\n            this._repeatBuilder(this._repeatContext);\r\n            this._repeat--;\r\n        }\r\n        this._actionQueue.update(delta);\r\n    }\r\n    isComplete() {\r\n        return this._stopped || (this._repeat <= 0 && this._actionQueue.isComplete());\r\n    }\r\n    stop() {\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._repeat = this._originalRepeat;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/RepeatForever.ts\n\r\n/**\r\n * RepeatForever Action implementation, it is recommended you use the fluent action\r\n * context API.\r\n *\r\n *\r\n */\r\nclass RepeatForever {\r\n    constructor(entity, repeatBuilder) {\r\n        this._stopped = false;\r\n        this._repeatBuilder = repeatBuilder;\r\n        this._repeatContext = new ActionContext(entity);\r\n        this._actionQueue = this._repeatContext.getQueue();\r\n        this._repeatBuilder(this._repeatContext);\r\n    }\r\n    update(delta) {\r\n        if (this._stopped) {\r\n            return;\r\n        }\r\n        if (this._actionQueue.isComplete()) {\r\n            this._actionQueue.clearActions();\r\n            this._repeatBuilder(this._repeatContext);\r\n        }\r\n        this._actionQueue.update(delta);\r\n    }\r\n    isComplete() {\r\n        return this._stopped;\r\n    }\r\n    stop() {\r\n        this._stopped = true;\r\n        this._actionQueue.clearActions();\r\n    }\r\n    reset() {\r\n        return;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/MoveBy.ts\n\r\n\r\n\r\n\r\nclass MoveBy {\r\n    constructor(entity, offsetX, offsetY, speed) {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._entity = entity;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._speed = speed;\r\n        this._offset = new Vector(offsetX, offsetY);\r\n        if (speed <= 0) {\r\n            Logger.getInstance().error('Attempted to moveBy with speed less than or equal to zero : ' + speed);\r\n            throw new Error('Speed must be greater than 0 pixels per second');\r\n        }\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._start = new Vector(this._tx.pos.x, this._tx.pos.y);\r\n            this._end = this._start.add(this._offset);\r\n            this._distance = this._offset.size;\r\n            this._dir = this._end.sub(this._start).normalize();\r\n        }\r\n        if (this.isComplete(this._entity)) {\r\n            this._tx.pos = vec(this._end.x, this._end.y);\r\n            this._motion.vel = vec(0, 0);\r\n        }\r\n        else {\r\n            this._motion.vel = this._dir.scale(this._speed);\r\n        }\r\n    }\r\n    isComplete(entity) {\r\n        const tx = entity.get(TransformComponent);\r\n        return this._stopped || tx.pos.distance(this._start) >= this._distance;\r\n    }\r\n    stop() {\r\n        this._motion.vel = vec(0, 0);\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n        this._stopped = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/MoveTo.ts\n\r\n\r\n\r\nclass MoveTo {\r\n    constructor(entity, destx, desty, speed) {\r\n        this.entity = entity;\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._end = new Vector(destx, desty);\r\n        this._speed = speed;\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._start = new Vector(this._tx.pos.x, this._tx.pos.y);\r\n            this._distance = this._start.distance(this._end);\r\n            this._dir = this._end.sub(this._start).normalize();\r\n        }\r\n        const m = this._dir.scale(this._speed);\r\n        this._motion.vel = vec(m.x, m.y);\r\n        if (this.isComplete(this.entity)) {\r\n            this._tx.pos = vec(this._end.x, this._end.y);\r\n            this._motion.vel = vec(0, 0);\r\n        }\r\n    }\r\n    isComplete(entity) {\r\n        const tx = entity.get(TransformComponent);\r\n        return this._stopped || new Vector(tx.pos.x, tx.pos.y).distance(this._start) >= this._distance;\r\n    }\r\n    stop() {\r\n        this._motion.vel = vec(0, 0);\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n        this._stopped = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/RotationType.ts\n/**\r\n * An enum that describes the strategies that rotation actions can use\r\n */\r\nvar RotationType;\r\n(function (RotationType) {\r\n    /**\r\n     * Rotation via `ShortestPath` will use the smallest angle\r\n     * between the starting and ending points. This strategy is the default behavior.\r\n     */\r\n    RotationType[RotationType[\"ShortestPath\"] = 0] = \"ShortestPath\";\r\n    /**\r\n     * Rotation via `LongestPath` will use the largest angle\r\n     * between the starting and ending points.\r\n     */\r\n    RotationType[RotationType[\"LongestPath\"] = 1] = \"LongestPath\";\r\n    /**\r\n     * Rotation via `Clockwise` will travel in a clockwise direction,\r\n     * regardless of the starting and ending points.\r\n     */\r\n    RotationType[RotationType[\"Clockwise\"] = 2] = \"Clockwise\";\r\n    /**\r\n     * Rotation via `CounterClockwise` will travel in a counterclockwise direction,\r\n     * regardless of the starting and ending points.\r\n     */\r\n    RotationType[RotationType[\"CounterClockwise\"] = 3] = \"CounterClockwise\";\r\n})(RotationType || (RotationType = {}));\r\n\n;// CONCATENATED MODULE: ./Actions/Action/RotateTo.ts\n\r\n\r\n\r\n\r\nclass RotateTo {\r\n    constructor(entity, angleRadians, speed, rotationType) {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._end = angleRadians;\r\n        this._speed = speed;\r\n        this._rotationType = rotationType || RotationType.ShortestPath;\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._start = this._tx.rotation;\r\n            this._currentNonCannonAngle = this._tx.rotation;\r\n            const distance1 = Math.abs(this._end - this._start);\r\n            const distance2 = TwoPI - distance1;\r\n            if (distance1 > distance2) {\r\n                this._shortDistance = distance2;\r\n                this._longDistance = distance1;\r\n            }\r\n            else {\r\n                this._shortDistance = distance1;\r\n                this._longDistance = distance2;\r\n            }\r\n            this._shortestPathIsPositive = (this._start - this._end + TwoPI) % TwoPI >= Math.PI;\r\n            switch (this._rotationType) {\r\n                case RotationType.ShortestPath:\r\n                    this._distance = this._shortDistance;\r\n                    if (this._shortestPathIsPositive) {\r\n                        this._direction = 1;\r\n                    }\r\n                    else {\r\n                        this._direction = -1;\r\n                    }\r\n                    break;\r\n                case RotationType.LongestPath:\r\n                    this._distance = this._longDistance;\r\n                    if (this._shortestPathIsPositive) {\r\n                        this._direction = -1;\r\n                    }\r\n                    else {\r\n                        this._direction = 1;\r\n                    }\r\n                    break;\r\n                case RotationType.Clockwise:\r\n                    this._direction = 1;\r\n                    if (this._shortestPathIsPositive) {\r\n                        this._distance = this._shortDistance;\r\n                    }\r\n                    else {\r\n                        this._distance = this._longDistance;\r\n                    }\r\n                    break;\r\n                case RotationType.CounterClockwise:\r\n                    this._direction = -1;\r\n                    if (!this._shortestPathIsPositive) {\r\n                        this._distance = this._shortDistance;\r\n                    }\r\n                    else {\r\n                        this._distance = this._longDistance;\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n        this._motion.angularVelocity = this._direction * this._speed;\r\n        this._currentNonCannonAngle += this._direction * this._speed * (_delta / 1000);\r\n        if (this.isComplete()) {\r\n            this._tx.rotation = this._end;\r\n            this._motion.angularVelocity = 0;\r\n            this._stopped = true;\r\n        }\r\n    }\r\n    isComplete() {\r\n        const distanceTraveled = Math.abs(this._currentNonCannonAngle - this._start);\r\n        return this._stopped || distanceTraveled >= Math.abs(this._distance);\r\n    }\r\n    stop() {\r\n        this._motion.angularVelocity = 0;\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n        this._stopped = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/RotateBy.ts\n\r\n\r\n\r\n\r\nclass RotateBy {\r\n    constructor(entity, angleRadiansOffset, speed, rotationType) {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._speed = speed;\r\n        this._offset = angleRadiansOffset;\r\n        this._rotationType = rotationType || RotationType.ShortestPath;\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._start = this._tx.rotation;\r\n            this._currentNonCannonAngle = this._tx.rotation;\r\n            this._end = this._start + this._offset;\r\n            const distance1 = Math.abs(this._end - this._start);\r\n            const distance2 = TwoPI - distance1;\r\n            if (distance1 > distance2) {\r\n                this._shortDistance = distance2;\r\n                this._longDistance = distance1;\r\n            }\r\n            else {\r\n                this._shortDistance = distance1;\r\n                this._longDistance = distance2;\r\n            }\r\n            this._shortestPathIsPositive = (this._start - this._end + TwoPI) % TwoPI >= Math.PI;\r\n            switch (this._rotationType) {\r\n                case RotationType.ShortestPath:\r\n                    this._distance = this._shortDistance;\r\n                    if (this._shortestPathIsPositive) {\r\n                        this._direction = 1;\r\n                    }\r\n                    else {\r\n                        this._direction = -1;\r\n                    }\r\n                    break;\r\n                case RotationType.LongestPath:\r\n                    this._distance = this._longDistance;\r\n                    if (this._shortestPathIsPositive) {\r\n                        this._direction = -1;\r\n                    }\r\n                    else {\r\n                        this._direction = 1;\r\n                    }\r\n                    break;\r\n                case RotationType.Clockwise:\r\n                    this._direction = 1;\r\n                    if (this._shortDistance >= 0) {\r\n                        this._distance = this._shortDistance;\r\n                    }\r\n                    else {\r\n                        this._distance = this._longDistance;\r\n                    }\r\n                    break;\r\n                case RotationType.CounterClockwise:\r\n                    this._direction = -1;\r\n                    if (this._shortDistance <= 0) {\r\n                        this._distance = this._shortDistance;\r\n                    }\r\n                    else {\r\n                        this._distance = this._longDistance;\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n        this._motion.angularVelocity = this._direction * this._speed;\r\n        this._currentNonCannonAngle += this._direction * this._speed * (_delta / 1000);\r\n        if (this.isComplete()) {\r\n            this._tx.rotation = this._end;\r\n            this._motion.angularVelocity = 0;\r\n            this._stopped = true;\r\n        }\r\n    }\r\n    isComplete() {\r\n        const distanceTraveled = Math.abs(this._currentNonCannonAngle - this._start);\r\n        return this._stopped || distanceTraveled >= Math.abs(this._distance);\r\n    }\r\n    stop() {\r\n        this._motion.angularVelocity = 0;\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._start = undefined;\r\n        this._currentNonCannonAngle = undefined;\r\n        this._distance = undefined;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/ScaleTo.ts\n\r\n\r\n\r\nclass ScaleTo {\r\n    constructor(entity, scaleX, scaleY, speedX, speedY) {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._endX = scaleX;\r\n        this._endY = scaleY;\r\n        this._speedX = speedX;\r\n        this._speedY = speedY;\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._startX = this._tx.scale.x;\r\n            this._startY = this._tx.scale.y;\r\n            this._distanceX = Math.abs(this._endX - this._startX);\r\n            this._distanceY = Math.abs(this._endY - this._startY);\r\n        }\r\n        if (!(Math.abs(this._tx.scale.x - this._startX) >= this._distanceX)) {\r\n            const directionX = this._endY < this._startY ? -1 : 1;\r\n            this._motion.scaleFactor.x = this._speedX * directionX;\r\n        }\r\n        else {\r\n            this._motion.scaleFactor.x = 0;\r\n        }\r\n        if (!(Math.abs(this._tx.scale.y - this._startY) >= this._distanceY)) {\r\n            const directionY = this._endY < this._startY ? -1 : 1;\r\n            this._motion.scaleFactor.y = this._speedY * directionY;\r\n        }\r\n        else {\r\n            this._motion.scaleFactor.y = 0;\r\n        }\r\n        if (this.isComplete()) {\r\n            this._tx.scale = vec(this._endX, this._endY);\r\n            this._motion.scaleFactor.x = 0;\r\n            this._motion.scaleFactor.y = 0;\r\n        }\r\n    }\r\n    isComplete() {\r\n        return (this._stopped ||\r\n            (Math.abs(this._tx.scale.y - this._startX) >= (this._distanceX - 0.01) &&\r\n                Math.abs(this._tx.scale.y - this._startY) >= (this._distanceY - 0.01)));\r\n    }\r\n    stop() {\r\n        this._motion.scaleFactor.x = 0;\r\n        this._motion.scaleFactor.y = 0;\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n        this._stopped = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/ScaleBy.ts\n\r\n\r\n\r\nclass ScaleBy {\r\n    constructor(entity, scaleOffsetX, scaleOffsetY, speed) {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._offset = new Vector(scaleOffsetX, scaleOffsetY);\r\n        this._speedX = this._speedY = speed;\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._startScale = this._tx.scale.clone();\r\n            this._endScale = this._startScale.add(this._offset);\r\n            this._distanceX = Math.abs(this._endScale.x - this._startScale.x);\r\n            this._distanceY = Math.abs(this._endScale.y - this._startScale.y);\r\n            this._directionX = this._endScale.x < this._startScale.x ? -1 : 1;\r\n            this._directionY = this._endScale.y < this._startScale.y ? -1 : 1;\r\n        }\r\n        this._motion.scaleFactor.x = this._speedX * this._directionX;\r\n        this._motion.scaleFactor.y = this._speedY * this._directionY;\r\n        if (this.isComplete()) {\r\n            this._tx.scale = this._endScale;\r\n            this._motion.scaleFactor.x = 0;\r\n            this._motion.scaleFactor.y = 0;\r\n        }\r\n    }\r\n    isComplete() {\r\n        return (this._stopped ||\r\n            (Math.abs(this._tx.scale.x - this._startScale.x) >= (this._distanceX - 0.01) &&\r\n                Math.abs(this._tx.scale.y - this._startScale.y) >= (this._distanceY - 0.01)));\r\n    }\r\n    stop() {\r\n        this._motion.scaleFactor.x = 0;\r\n        this._motion.scaleFactor.y = 0;\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n        this._stopped = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/CallMethod.ts\nclass CallMethod {\r\n    constructor(method) {\r\n        this._method = null;\r\n        this._hasBeenCalled = false;\r\n        this._method = method;\r\n    }\r\n    update(_delta) {\r\n        this._method();\r\n        this._hasBeenCalled = true;\r\n    }\r\n    isComplete() {\r\n        return this._hasBeenCalled;\r\n    }\r\n    reset() {\r\n        this._hasBeenCalled = false;\r\n    }\r\n    stop() {\r\n        this._hasBeenCalled = true;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/EaseTo.ts\n\r\n\r\n\r\nclass EaseTo {\r\n    constructor(entity, x, y, duration, easingFcn) {\r\n        this.easingFcn = easingFcn;\r\n        this._currentLerpTime = 0;\r\n        this._lerpDuration = 1 * 1000; // 1 second\r\n        this._lerpStart = new Vector(0, 0);\r\n        this._lerpEnd = new Vector(0, 0);\r\n        this._initialized = false;\r\n        this._stopped = false;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._lerpDuration = duration;\r\n        this._lerpEnd = new Vector(x, y);\r\n    }\r\n    _initialize() {\r\n        this._lerpStart = new Vector(this._tx.pos.x, this._tx.pos.y);\r\n        this._currentLerpTime = 0;\r\n    }\r\n    update(delta) {\r\n        if (!this._initialized) {\r\n            this._initialize();\r\n            this._initialized = true;\r\n        }\r\n        // Need to update lerp time first, otherwise the first update will always be zero\r\n        this._currentLerpTime += delta;\r\n        let newX = this._tx.pos.x;\r\n        let newY = this._tx.pos.y;\r\n        if (this._currentLerpTime < this._lerpDuration) {\r\n            if (this._lerpEnd.x < this._lerpStart.x) {\r\n                newX =\r\n                    this._lerpStart.x -\r\n                        (this.easingFcn(this._currentLerpTime, this._lerpEnd.x, this._lerpStart.x, this._lerpDuration) - this._lerpEnd.x);\r\n            }\r\n            else {\r\n                newX = this.easingFcn(this._currentLerpTime, this._lerpStart.x, this._lerpEnd.x, this._lerpDuration);\r\n            }\r\n            if (this._lerpEnd.y < this._lerpStart.y) {\r\n                newY =\r\n                    this._lerpStart.y -\r\n                        (this.easingFcn(this._currentLerpTime, this._lerpEnd.y, this._lerpStart.y, this._lerpDuration) - this._lerpEnd.y);\r\n            }\r\n            else {\r\n                newY = this.easingFcn(this._currentLerpTime, this._lerpStart.y, this._lerpEnd.y, this._lerpDuration);\r\n            }\r\n            // Given the lerp position figure out the velocity in pixels per second\r\n            this._motion.vel = vec((newX - this._tx.pos.x) / (delta / 1000), (newY - this._tx.pos.y) / (delta / 1000));\r\n        }\r\n        else {\r\n            this._tx.pos = vec(this._lerpEnd.x, this._lerpEnd.y);\r\n            this._motion.vel = Vector.Zero;\r\n        }\r\n    }\r\n    isComplete() {\r\n        return this._stopped || this._currentLerpTime >= this._lerpDuration;\r\n    }\r\n    reset() {\r\n        this._initialized = false;\r\n        this._stopped = false;\r\n        this._currentLerpTime = 0;\r\n    }\r\n    stop() {\r\n        this._motion.vel = vec(0, 0);\r\n        this._stopped = true;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/EaseBy.ts\n\r\n\r\n\r\nclass EaseBy {\r\n    constructor(entity, offsetX, offsetY, duration, easingFcn) {\r\n        this.easingFcn = easingFcn;\r\n        this._currentLerpTime = 0;\r\n        this._lerpDuration = 1 * 1000; // 1 second\r\n        this._lerpStart = new Vector(0, 0);\r\n        this._lerpEnd = new Vector(0, 0);\r\n        this._initialized = false;\r\n        this._stopped = false;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._lerpDuration = duration;\r\n        this._offset = new Vector(offsetX, offsetY);\r\n    }\r\n    _initialize() {\r\n        this._lerpStart = new Vector(this._tx.pos.x, this._tx.pos.y);\r\n        this._currentLerpTime = 0;\r\n        this._lerpEnd = this._lerpStart.add(this._offset);\r\n    }\r\n    update(delta) {\r\n        if (!this._initialized) {\r\n            this._initialize();\r\n            this._initialized = true;\r\n        }\r\n        // Need to update lerp time first, otherwise the first update will always be zero\r\n        this._currentLerpTime += delta;\r\n        let newX = this._tx.pos.x;\r\n        let newY = this._tx.pos.y;\r\n        if (this._currentLerpTime < this._lerpDuration) {\r\n            if (this._lerpEnd.x < this._lerpStart.x) {\r\n                newX =\r\n                    this._lerpStart.x -\r\n                        (this.easingFcn(this._currentLerpTime, this._lerpEnd.x, this._lerpStart.x, this._lerpDuration) - this._lerpEnd.x);\r\n            }\r\n            else {\r\n                newX = this.easingFcn(this._currentLerpTime, this._lerpStart.x, this._lerpEnd.x, this._lerpDuration);\r\n            }\r\n            if (this._lerpEnd.y < this._lerpStart.y) {\r\n                newY =\r\n                    this._lerpStart.y -\r\n                        (this.easingFcn(this._currentLerpTime, this._lerpEnd.y, this._lerpStart.y, this._lerpDuration) - this._lerpEnd.y);\r\n            }\r\n            else {\r\n                newY = this.easingFcn(this._currentLerpTime, this._lerpStart.y, this._lerpEnd.y, this._lerpDuration);\r\n            }\r\n            // Given the lerp position figure out the velocity in pixels per second\r\n            this._motion.vel = vec((newX - this._tx.pos.x) / (delta / 1000), (newY - this._tx.pos.y) / (delta / 1000));\r\n        }\r\n        else {\r\n            this._tx.pos = vec(this._lerpEnd.x, this._lerpEnd.y);\r\n            this._motion.vel = Vector.Zero;\r\n        }\r\n    }\r\n    isComplete() {\r\n        return this._stopped || this._currentLerpTime >= this._lerpDuration;\r\n    }\r\n    reset() {\r\n        this._initialized = false;\r\n        this._stopped = false;\r\n        this._currentLerpTime = 0;\r\n    }\r\n    stop() {\r\n        this._motion.vel = vec(0, 0);\r\n        this._stopped = true;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/Blink.ts\n\r\nclass Blink {\r\n    constructor(entity, timeVisible, timeNotVisible, numBlinks = 1) {\r\n        this._timeVisible = 0;\r\n        this._timeNotVisible = 0;\r\n        this._elapsedTime = 0;\r\n        this._totalTime = 0;\r\n        this._stopped = false;\r\n        this._started = false;\r\n        this._graphics = entity.get(GraphicsComponent);\r\n        this._timeVisible = timeVisible;\r\n        this._timeNotVisible = timeNotVisible;\r\n        this._duration = (timeVisible + timeNotVisible) * numBlinks;\r\n    }\r\n    update(delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._elapsedTime = 0;\r\n            this._totalTime = 0;\r\n        }\r\n        if (!this._graphics) {\r\n            return;\r\n        }\r\n        this._elapsedTime += delta;\r\n        this._totalTime += delta;\r\n        if (this._graphics.visible && this._elapsedTime >= this._timeVisible) {\r\n            this._graphics.visible = false;\r\n            this._elapsedTime = 0;\r\n        }\r\n        if (!this._graphics.visible && this._elapsedTime >= this._timeNotVisible) {\r\n            this._graphics.visible = true;\r\n            this._elapsedTime = 0;\r\n        }\r\n        if (this.isComplete()) {\r\n            this._graphics.visible = true;\r\n        }\r\n    }\r\n    isComplete() {\r\n        return this._stopped || this._totalTime >= this._duration;\r\n    }\r\n    stop() {\r\n        if (this._graphics) {\r\n            this._graphics.visible = true;\r\n        }\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._elapsedTime = 0;\r\n        this._totalTime = 0;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/Fade.ts\n\r\n\r\nclass Fade {\r\n    constructor(entity, endOpacity, speed) {\r\n        this._multiplier = 1;\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._graphics = entity.get(GraphicsComponent);\r\n        this._endOpacity = endOpacity;\r\n        this._speed = this._ogspeed = speed;\r\n    }\r\n    update(delta) {\r\n        if (!this._graphics) {\r\n            return;\r\n        }\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._speed = this._ogspeed;\r\n            // determine direction when we start\r\n            if (this._endOpacity < this._graphics.opacity) {\r\n                this._multiplier = -1;\r\n            }\r\n            else {\r\n                this._multiplier = 1;\r\n            }\r\n        }\r\n        if (this._speed > 0) {\r\n            this._graphics.opacity += (this._multiplier *\r\n                (Math.abs(this._graphics.opacity - this._endOpacity) * delta)) / this._speed;\r\n        }\r\n        this._speed -= delta;\r\n        if (this.isComplete()) {\r\n            this._graphics.opacity = this._endOpacity;\r\n        }\r\n        Logger.getInstance().debug('[Action fade] Actor opacity:', this._graphics.opacity);\r\n    }\r\n    isComplete() {\r\n        return this._stopped || Math.abs(this._graphics.opacity - this._endOpacity) < 0.05;\r\n    }\r\n    stop() {\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n        this._stopped = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/Delay.ts\nclass Delay {\r\n    constructor(delay) {\r\n        this._elapsedTime = 0;\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._delay = delay;\r\n    }\r\n    update(delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n        }\r\n        this._elapsedTime += delta;\r\n    }\r\n    isComplete() {\r\n        return this._stopped || this._elapsedTime >= this._delay;\r\n    }\r\n    stop() {\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._elapsedTime = 0;\r\n        this._started = false;\r\n        this._stopped = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/Die.ts\n\r\nclass Die {\r\n    constructor(entity) {\r\n        this._stopped = false;\r\n        this._entity = entity;\r\n    }\r\n    update(_delta) {\r\n        this._entity.get(ActionsComponent).clearActions();\r\n        this._entity.kill();\r\n        this._stopped = true;\r\n    }\r\n    isComplete() {\r\n        return this._stopped;\r\n    }\r\n    stop() {\r\n        return;\r\n    }\r\n    reset() {\r\n        return;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/Follow.ts\n\r\n\r\n\r\nclass Follow {\r\n    constructor(entity, entityToFollow, followDistance) {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._followTx = entityToFollow.get(TransformComponent);\r\n        this._followMotion = entityToFollow.get(MotionComponent);\r\n        this._current = new Vector(this._tx.pos.x, this._tx.pos.y);\r\n        this._end = new Vector(this._followTx.pos.x, this._followTx.pos.y);\r\n        this._maximumDistance = followDistance !== undefined ? followDistance : this._current.distance(this._end);\r\n        this._speed = 0;\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._distanceBetween = this._current.distance(this._end);\r\n            this._dir = this._end.sub(this._current).normalize();\r\n        }\r\n        const actorToFollowSpeed = Math.sqrt(Math.pow(this._followMotion.vel.x, 2) + Math.pow(this._followMotion.vel.y, 2));\r\n        if (actorToFollowSpeed !== 0) {\r\n            this._speed = actorToFollowSpeed;\r\n        }\r\n        this._current = vec(this._tx.pos.x, this._tx.pos.y);\r\n        this._end = vec(this._followTx.pos.x, this._followTx.pos.y);\r\n        this._distanceBetween = this._current.distance(this._end);\r\n        this._dir = this._end.sub(this._current).normalize();\r\n        if (this._distanceBetween >= this._maximumDistance) {\r\n            const m = this._dir.scale(this._speed);\r\n            this._motion.vel = vec(m.x, m.y);\r\n        }\r\n        else {\r\n            this._motion.vel = vec(0, 0);\r\n        }\r\n        if (this.isComplete()) {\r\n            this._tx.pos = vec(this._end.x, this._end.y);\r\n            this._motion.vel = vec(0, 0);\r\n        }\r\n    }\r\n    stop() {\r\n        this._motion.vel = vec(0, 0);\r\n        this._stopped = true;\r\n    }\r\n    isComplete() {\r\n        // the actor following should never stop unless specified to do so\r\n        return this._stopped;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n        this._stopped = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/Meet.ts\n\r\n\r\n\r\nclass Meet {\r\n    constructor(actor, actorToMeet, speed) {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._speedWasSpecified = false;\r\n        this._tx = actor.get(TransformComponent);\r\n        this._motion = actor.get(MotionComponent);\r\n        this._meetTx = actorToMeet.get(TransformComponent);\r\n        this._meetMotion = actorToMeet.get(MotionComponent);\r\n        this._current = new Vector(this._tx.pos.x, this._tx.pos.y);\r\n        this._end = new Vector(this._meetTx.pos.x, this._meetTx.pos.y);\r\n        this._speed = speed || 0;\r\n        if (speed !== undefined) {\r\n            this._speedWasSpecified = true;\r\n        }\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._distanceBetween = this._current.distance(this._end);\r\n            this._dir = this._end.sub(this._current).normalize();\r\n        }\r\n        const actorToMeetSpeed = Math.sqrt(Math.pow(this._meetMotion.vel.x, 2) + Math.pow(this._meetMotion.vel.y, 2));\r\n        if (actorToMeetSpeed !== 0 && !this._speedWasSpecified) {\r\n            this._speed = actorToMeetSpeed;\r\n        }\r\n        this._current = vec(this._tx.pos.x, this._tx.pos.y);\r\n        this._end = vec(this._meetTx.pos.x, this._meetTx.pos.y);\r\n        this._distanceBetween = this._current.distance(this._end);\r\n        this._dir = this._end.sub(this._current).normalize();\r\n        const m = this._dir.scale(this._speed);\r\n        this._motion.vel = vec(m.x, m.y);\r\n        if (this.isComplete()) {\r\n            this._tx.pos = vec(this._end.x, this._end.y);\r\n            this._motion.vel = vec(0, 0);\r\n        }\r\n    }\r\n    isComplete() {\r\n        return this._stopped || this._distanceBetween <= 1;\r\n    }\r\n    stop() {\r\n        this._motion.vel = vec(0, 0);\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._distanceBetween = undefined;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/ActionContext.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * The fluent Action API allows you to perform \"actions\" on\r\n * [[Actor|Actors]] such as following, moving, rotating, and\r\n * more. You can implement your own actions by implementing\r\n * the [[Action]] interface.\r\n */\r\nclass ActionContext {\r\n    constructor(entity) {\r\n        this._entity = entity;\r\n        this._queue = new ActionQueue(entity);\r\n    }\r\n    getQueue() {\r\n        return this._queue;\r\n    }\r\n    update(elapsedMs) {\r\n        this._queue.update(elapsedMs);\r\n    }\r\n    /**\r\n     * Clears all queued actions from the Actor\r\n     */\r\n    clearActions() {\r\n        this._queue.clearActions();\r\n    }\r\n    runAction(action) {\r\n        action.reset();\r\n        this._queue.add(action);\r\n        return this;\r\n    }\r\n    easeTo(...args) {\r\n        var _a, _b;\r\n        let x = 0;\r\n        let y = 0;\r\n        let duration = 0;\r\n        let easingFcn = EasingFunctions.Linear;\r\n        if (args[0] instanceof Vector) {\r\n            x = args[0].x;\r\n            y = args[0].y;\r\n            duration = args[1];\r\n            easingFcn = (_a = args[2]) !== null && _a !== void 0 ? _a : easingFcn;\r\n        }\r\n        else {\r\n            x = args[0];\r\n            y = args[1];\r\n            duration = args[2];\r\n            easingFcn = (_b = args[3]) !== null && _b !== void 0 ? _b : easingFcn;\r\n        }\r\n        this._queue.add(new EaseTo(this._entity, x, y, duration, easingFcn));\r\n        return this;\r\n    }\r\n    easeBy(...args) {\r\n        var _a, _b;\r\n        let offsetX = 0;\r\n        let offsetY = 0;\r\n        let duration = 0;\r\n        let easingFcn = EasingFunctions.Linear;\r\n        if (args[0] instanceof Vector) {\r\n            offsetX = args[0].x;\r\n            offsetY = args[0].y;\r\n            duration = args[1];\r\n            easingFcn = (_a = args[2]) !== null && _a !== void 0 ? _a : easingFcn;\r\n        }\r\n        else {\r\n            offsetX = args[0];\r\n            offsetY = args[1];\r\n            duration = args[2];\r\n            easingFcn = (_b = args[3]) !== null && _b !== void 0 ? _b : easingFcn;\r\n        }\r\n        this._queue.add(new EaseBy(this._entity, offsetX, offsetY, duration, easingFcn));\r\n        return this;\r\n    }\r\n    moveTo(xOrPos, yOrSpeed, speedOrUndefined) {\r\n        let x = 0;\r\n        let y = 0;\r\n        let speed = 0;\r\n        if (xOrPos instanceof Vector) {\r\n            x = xOrPos.x;\r\n            y = xOrPos.y;\r\n            speed = yOrSpeed;\r\n        }\r\n        else {\r\n            x = xOrPos;\r\n            y = yOrSpeed;\r\n            speed = speedOrUndefined;\r\n        }\r\n        this._queue.add(new MoveTo(this._entity, x, y, speed));\r\n        return this;\r\n    }\r\n    moveBy(xOffsetOrVector, yOffsetOrSpeed, speedOrUndefined) {\r\n        let xOffset = 0;\r\n        let yOffset = 0;\r\n        let speed = 0;\r\n        if (xOffsetOrVector instanceof Vector) {\r\n            xOffset = xOffsetOrVector.x;\r\n            yOffset = xOffsetOrVector.y;\r\n            speed = yOffsetOrSpeed;\r\n        }\r\n        else {\r\n            xOffset = xOffsetOrVector;\r\n            yOffset = yOffsetOrSpeed;\r\n            speed = speedOrUndefined;\r\n        }\r\n        this._queue.add(new MoveBy(this._entity, xOffset, yOffset, speed));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will rotate an actor to the specified angle at the speed\r\n     * specified (in radians per second) and return back the actor. This\r\n     * method is part of the actor 'Action' fluent API allowing action chaining.\r\n     * @param angleRadians  The angle to rotate to in radians\r\n     * @param speed         The angular velocity of the rotation specified in radians per second\r\n     * @param rotationType  The [[RotationType]] to use for this rotation\r\n     */\r\n    rotateTo(angleRadians, speed, rotationType) {\r\n        this._queue.add(new RotateTo(this._entity, angleRadians, speed, rotationType));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will rotate an actor by the specified angle offset, from it's current rotation given a certain speed\r\n     * in radians/sec and return back the actor. This method is part\r\n     * of the actor 'Action' fluent API allowing action chaining.\r\n     * @param angleRadiansOffset  The angle to rotate to in radians relative to the current rotation\r\n     * @param speed          The speed in radians/sec the actor should rotate at\r\n     * @param rotationType  The [[RotationType]] to use for this rotation, default is shortest path\r\n     */\r\n    rotateBy(angleRadiansOffset, speed, rotationType) {\r\n        this._queue.add(new RotateBy(this._entity, angleRadiansOffset, speed, rotationType));\r\n        return this;\r\n    }\r\n    scaleTo(sizeXOrVector, sizeYOrSpeed, speedXOrUndefined, speedYOrUndefined) {\r\n        let sizeX = 1;\r\n        let sizeY = 1;\r\n        let speedX = 0;\r\n        let speedY = 0;\r\n        if (sizeXOrVector instanceof Vector && sizeYOrSpeed instanceof Vector) {\r\n            sizeX = sizeXOrVector.x;\r\n            sizeY = sizeXOrVector.y;\r\n            speedX = sizeYOrSpeed.x;\r\n            speedY = sizeYOrSpeed.y;\r\n        }\r\n        if (typeof sizeXOrVector === 'number' && typeof sizeYOrSpeed === 'number') {\r\n            sizeX = sizeXOrVector;\r\n            sizeY = sizeYOrSpeed;\r\n            speedX = speedXOrUndefined;\r\n            speedY = speedYOrUndefined;\r\n        }\r\n        this._queue.add(new ScaleTo(this._entity, sizeX, sizeY, speedX, speedY));\r\n        return this;\r\n    }\r\n    scaleBy(sizeOffsetXOrVector, sizeOffsetYOrSpeed, speed) {\r\n        let sizeOffsetX = 1;\r\n        let sizeOffsetY = 1;\r\n        if (sizeOffsetXOrVector instanceof Vector) {\r\n            sizeOffsetX = sizeOffsetXOrVector.x;\r\n            sizeOffsetY = sizeOffsetXOrVector.y;\r\n            speed = sizeOffsetYOrSpeed;\r\n        }\r\n        if (typeof sizeOffsetXOrVector === 'number' && typeof sizeOffsetYOrSpeed === 'number') {\r\n            sizeOffsetX = sizeOffsetXOrVector;\r\n            sizeOffsetY = sizeOffsetYOrSpeed;\r\n        }\r\n        this._queue.add(new ScaleBy(this._entity, sizeOffsetX, sizeOffsetY, speed));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will cause an actor to blink (become visible and not\r\n     * visible). Optionally, you may specify the number of blinks. Specify the amount of time\r\n     * the actor should be visible per blink, and the amount of time not visible.\r\n     * This method is part of the actor 'Action' fluent API allowing action chaining.\r\n     * @param timeVisible     The amount of time to stay visible per blink in milliseconds\r\n     * @param timeNotVisible  The amount of time to stay not visible per blink in milliseconds\r\n     * @param numBlinks       The number of times to blink\r\n     */\r\n    blink(timeVisible, timeNotVisible, numBlinks = 1) {\r\n        this._queue.add(new Blink(this._entity, timeVisible, timeNotVisible, numBlinks));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will cause an actor's opacity to change from its current value\r\n     * to the provided value by a specified time (in milliseconds). This method is\r\n     * part of the actor 'Action' fluent API allowing action chaining.\r\n     * @param opacity  The ending opacity\r\n     * @param time     The time it should take to fade the actor (in milliseconds)\r\n     */\r\n    fade(opacity, time) {\r\n        this._queue.add(new Fade(this._entity, opacity, time));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will delay the next action from executing for a certain\r\n     * amount of time (in milliseconds). This method is part of the actor\r\n     * 'Action' fluent API allowing action chaining.\r\n     * @param time  The amount of time to delay the next action in the queue from executing in milliseconds\r\n     */\r\n    delay(time) {\r\n        this._queue.add(new Delay(time));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will add an action to the queue that will remove the actor from the\r\n     * scene once it has completed its previous  Any actions on the\r\n     * action queue after this action will not be executed.\r\n     */\r\n    die() {\r\n        this._queue.add(new Die(this._entity));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method allows you to call an arbitrary method as the next action in the\r\n     * action queue. This is useful if you want to execute code in after a specific\r\n     * action, i.e An actor arrives at a destination after traversing a path\r\n     */\r\n    callMethod(method) {\r\n        this._queue.add(new CallMethod(method));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will cause the actor to repeat all of the actions built in\r\n     * the `repeatBuilder` callback. If the number of repeats\r\n     * is not specified it will repeat forever. This method is part of\r\n     * the actor 'Action' fluent API allowing action chaining\r\n     *\r\n     * ```typescript\r\n     * // Move up in a zig-zag by repeated moveBy's\r\n     * actor.actions.repeat(repeatCtx => {\r\n     *  repeatCtx.moveBy(10, 0, 10);\r\n     *  repeatCtx.moveBy(0, 10, 10);\r\n     * }, 5);\r\n     * ```\r\n     *\r\n     * @param repeatBuilder The builder to specify the repeatable list of actions\r\n     * @param times  The number of times to repeat all the previous actions in the action queue. If nothing is specified the actions\r\n     * will repeat forever\r\n     */\r\n    repeat(repeatBuilder, times) {\r\n        if (!times) {\r\n            this.repeatForever(repeatBuilder);\r\n            return this;\r\n        }\r\n        this._queue.add(new Repeat(this._entity, repeatBuilder, times));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will cause the actor to repeat all of the actions built in\r\n     * the `repeatBuilder` callback. If the number of repeats\r\n     * is not specified it will repeat forever. This method is part of\r\n     * the actor 'Action' fluent API allowing action chaining\r\n     *\r\n     * ```typescript\r\n     * // Move up in a zig-zag by repeated moveBy's\r\n     * actor.actions.repeat(repeatCtx => {\r\n     *  repeatCtx.moveBy(10, 0, 10);\r\n     *  repeatCtx.moveBy(0, 10, 10);\r\n     * }, 5);\r\n     * ```\r\n     *\r\n     * @param repeatBuilder The builder to specify the repeatable list of actions\r\n     */\r\n    repeatForever(repeatBuilder) {\r\n        this._queue.add(new RepeatForever(this._entity, repeatBuilder));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will cause the entity to follow another at a specified distance\r\n     * @param entity           The entity to follow\r\n     * @param followDistance  The distance to maintain when following, if not specified the actor will follow at the current distance.\r\n     */\r\n    follow(entity, followDistance) {\r\n        if (followDistance === undefined) {\r\n            this._queue.add(new Follow(this._entity, entity));\r\n        }\r\n        else {\r\n            this._queue.add(new Follow(this._entity, entity, followDistance));\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will cause the entity to move towards another until they\r\n     * collide \"meet\" at a specified speed.\r\n     * @param entity  The entity to meet\r\n     * @param speed  The speed in pixels per second to move, if not specified it will match the speed of the other actor\r\n     */\r\n    meet(entity, speed) {\r\n        if (speed === undefined) {\r\n            this._queue.add(new Meet(this._entity, entity));\r\n        }\r\n        else {\r\n            this._queue.add(new Meet(this._entity, entity, speed));\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Returns a promise that resolves when the current action queue up to now\r\n     * is finished.\r\n     */\r\n    toPromise() {\r\n        const temp = new Promise((resolve) => {\r\n            this._queue.add(new CallMethod(() => {\r\n                resolve();\r\n            }));\r\n        });\r\n        return temp;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/ActionsComponent.ts\n\r\n\r\n\r\n\r\n;\r\nclass ActionsComponent extends Component {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.type = 'ex.actions';\r\n        this.dependencies = [TransformComponent, MotionComponent];\r\n    }\r\n    onAdd(entity) {\r\n        this._ctx = new ActionContext(entity);\r\n    }\r\n    onRemove() {\r\n        this._ctx = null;\r\n    }\r\n    /**\r\n     * Returns the internal action queue\r\n     * @returns action queue\r\n     */\r\n    getQueue() {\r\n        var _a;\r\n        return (_a = this._ctx) === null || _a === void 0 ? void 0 : _a.getQueue();\r\n    }\r\n    runAction(action) {\r\n        var _a;\r\n        return (_a = this._ctx) === null || _a === void 0 ? void 0 : _a.runAction(action);\r\n    }\r\n    /**\r\n     * Updates the internal action context, performing action and moving through the internal queue\r\n     * @param elapsedMs\r\n     */\r\n    update(elapsedMs) {\r\n        var _a;\r\n        return (_a = this._ctx) === null || _a === void 0 ? void 0 : _a.update(elapsedMs);\r\n    }\r\n    /**\r\n     * Clears all queued actions from the Actor\r\n     */\r\n    clearActions() {\r\n        var _a;\r\n        (_a = this._ctx) === null || _a === void 0 ? void 0 : _a.clearActions();\r\n    }\r\n    easeTo(...args) {\r\n        return this._ctx.easeTo.apply(this._ctx, args);\r\n    }\r\n    easeBy(...args) {\r\n        return this._ctx.easeBy.apply(this._ctx, args);\r\n    }\r\n    moveTo(xOrPos, yOrSpeed, speedOrUndefined) {\r\n        return this._ctx.moveTo.apply(this._ctx, [xOrPos, yOrSpeed, speedOrUndefined]);\r\n    }\r\n    moveBy(xOffsetOrVector, yOffsetOrSpeed, speedOrUndefined) {\r\n        return this._ctx.moveBy.apply(this._ctx, [xOffsetOrVector, yOffsetOrSpeed, speedOrUndefined]);\r\n    }\r\n    /**\r\n     * This method will rotate an actor to the specified angle at the speed\r\n     * specified (in radians per second) and return back the actor. This\r\n     * method is part of the actor 'Action' fluent API allowing action chaining.\r\n     * @param angleRadians  The angle to rotate to in radians\r\n     * @param speed         The angular velocity of the rotation specified in radians per second\r\n     * @param rotationType  The [[RotationType]] to use for this rotation\r\n     */\r\n    rotateTo(angleRadians, speed, rotationType) {\r\n        return this._ctx.rotateTo(angleRadians, speed, rotationType);\r\n    }\r\n    /**\r\n     * This method will rotate an actor by the specified angle offset, from it's current rotation given a certain speed\r\n     * in radians/sec and return back the actor. This method is part\r\n     * of the actor 'Action' fluent API allowing action chaining.\r\n     * @param angleRadiansOffset  The angle to rotate to in radians relative to the current rotation\r\n     * @param speed          The speed in radians/sec the actor should rotate at\r\n     * @param rotationType  The [[RotationType]] to use for this rotation, default is shortest path\r\n     */\r\n    rotateBy(angleRadiansOffset, speed, rotationType) {\r\n        return this._ctx.rotateBy(angleRadiansOffset, speed, rotationType);\r\n    }\r\n    scaleTo(sizeXOrVector, sizeYOrSpeed, speedXOrUndefined, speedYOrUndefined) {\r\n        return this._ctx.scaleTo.apply(this._ctx, [sizeXOrVector, sizeYOrSpeed, speedXOrUndefined, speedYOrUndefined]);\r\n    }\r\n    scaleBy(sizeOffsetXOrVector, sizeOffsetYOrSpeed, speed) {\r\n        return this._ctx.scaleBy.apply(this._ctx, [sizeOffsetXOrVector, sizeOffsetYOrSpeed, speed]);\r\n    }\r\n    /**\r\n     * This method will cause an actor to blink (become visible and not\r\n     * visible). Optionally, you may specify the number of blinks. Specify the amount of time\r\n     * the actor should be visible per blink, and the amount of time not visible.\r\n     * This method is part of the actor 'Action' fluent API allowing action chaining.\r\n     * @param timeVisible     The amount of time to stay visible per blink in milliseconds\r\n     * @param timeNotVisible  The amount of time to stay not visible per blink in milliseconds\r\n     * @param numBlinks       The number of times to blink\r\n     */\r\n    blink(timeVisible, timeNotVisible, numBlinks) {\r\n        return this._ctx.blink(timeVisible, timeNotVisible, numBlinks);\r\n    }\r\n    /**\r\n     * This method will cause an actor's opacity to change from its current value\r\n     * to the provided value by a specified time (in milliseconds). This method is\r\n     * part of the actor 'Action' fluent API allowing action chaining.\r\n     * @param opacity  The ending opacity\r\n     * @param time     The time it should take to fade the actor (in milliseconds)\r\n     */\r\n    fade(opacity, time) {\r\n        return this._ctx.fade(opacity, time);\r\n    }\r\n    /**\r\n     * This method will delay the next action from executing for a certain\r\n     * amount of time (in milliseconds). This method is part of the actor\r\n     * 'Action' fluent API allowing action chaining.\r\n     * @param time  The amount of time to delay the next action in the queue from executing in milliseconds\r\n     */\r\n    delay(time) {\r\n        return this._ctx.delay(time);\r\n    }\r\n    /**\r\n     * This method will add an action to the queue that will remove the actor from the\r\n     * scene once it has completed its previous  Any actions on the\r\n     * action queue after this action will not be executed.\r\n     */\r\n    die() {\r\n        return this._ctx.die();\r\n    }\r\n    /**\r\n     * This method allows you to call an arbitrary method as the next action in the\r\n     * action queue. This is useful if you want to execute code in after a specific\r\n     * action, i.e An actor arrives at a destination after traversing a path\r\n     */\r\n    callMethod(method) {\r\n        return this._ctx.callMethod(method);\r\n    }\r\n    /**\r\n     * This method will cause the actor to repeat all of the actions built in\r\n     * the `repeatBuilder` callback. If the number of repeats\r\n     * is not specified it will repeat forever. This method is part of\r\n     * the actor 'Action' fluent API allowing action chaining\r\n     *\r\n     * ```typescript\r\n     * // Move up in a zig-zag by repeated moveBy's\r\n     * actor.actions.repeat(repeatCtx => {\r\n     *  repeatCtx.moveBy(10, 0, 10);\r\n     *  repeatCtx.moveBy(0, 10, 10);\r\n     * }, 5);\r\n     * ```\r\n     *\r\n     * @param repeatBuilder The builder to specify the repeatable list of actions\r\n     * @param times  The number of times to repeat all the previous actions in the action queue. If nothing is specified the actions\r\n     * will repeat forever\r\n     */\r\n    repeat(repeatBuilder, times) {\r\n        return this._ctx.repeat(repeatBuilder, times);\r\n    }\r\n    /**\r\n     * This method will cause the actor to repeat all of the actions built in\r\n     * the `repeatBuilder` callback. If the number of repeats\r\n     * is not specified it will repeat forever. This method is part of\r\n     * the actor 'Action' fluent API allowing action chaining\r\n     *\r\n     * ```typescript\r\n     * // Move up in a zig-zag by repeated moveBy's\r\n     * actor.actions.repeat(repeatCtx => {\r\n     *  repeatCtx.moveBy(10, 0, 10);\r\n     *  repeatCtx.moveBy(0, 10, 10);\r\n     * }, 5);\r\n     * ```\r\n     *\r\n     * @param repeatBuilder The builder to specify the repeatable list of actions\r\n     */\r\n    repeatForever(repeatBuilder) {\r\n        return this._ctx.repeatForever(repeatBuilder);\r\n    }\r\n    /**\r\n     * This method will cause the entity to follow another at a specified distance\r\n     * @param entity           The entity to follow\r\n     * @param followDistance  The distance to maintain when following, if not specified the actor will follow at the current distance.\r\n     */\r\n    follow(entity, followDistance) {\r\n        return this._ctx.follow(entity, followDistance);\r\n    }\r\n    /**\r\n     * This method will cause the entity to move towards another until they\r\n     * collide \"meet\" at a specified speed.\r\n     * @param entity  The entity to meet\r\n     * @param speed  The speed in pixels per second to move, if not specified it will match the speed of the other actor\r\n     */\r\n    meet(entity, speed) {\r\n        return this._ctx.meet(entity, speed);\r\n    }\r\n    /**\r\n     * Returns a promise that resolves when the current action queue up to now\r\n     * is finished.\r\n     */\r\n    toPromise() {\r\n        return this._ctx.toPromise();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/FontCommon.ts\n/**\r\n * Enum representing the different font size units\r\n * https://developer.mozilla.org/en-US/docs/Web/CSS/font-size\r\n */\r\nvar FontUnit;\r\n(function (FontUnit) {\r\n    /**\r\n     * Em is a scalable unit, 1 em is equal to the current font size of the current element, parent elements can effect em values\r\n     */\r\n    FontUnit[\"Em\"] = \"em\";\r\n    /**\r\n     * Rem is similar to the Em, it is a scalable unit. 1 rem is equal to the font size of the root element\r\n     */\r\n    FontUnit[\"Rem\"] = \"rem\";\r\n    /**\r\n     * Pixel is a unit of length in screen pixels\r\n     */\r\n    FontUnit[\"Px\"] = \"px\";\r\n    /**\r\n     * Point is a physical unit length (1/72 of an inch)\r\n     */\r\n    FontUnit[\"Pt\"] = \"pt\";\r\n    /**\r\n     * Percent is a scalable unit similar to Em, the only difference is the Em units scale faster when Text-Size stuff\r\n     */\r\n    FontUnit[\"Percent\"] = \"%\";\r\n})(FontUnit || (FontUnit = {}));\r\n/**\r\n * Enum representing the different horizontal text alignments\r\n */\r\nvar TextAlign;\r\n(function (TextAlign) {\r\n    /**\r\n     * The text is left-aligned.\r\n     */\r\n    TextAlign[\"Left\"] = \"left\";\r\n    /**\r\n     * The text is right-aligned.\r\n     */\r\n    TextAlign[\"Right\"] = \"right\";\r\n    /**\r\n     * The text is centered.\r\n     */\r\n    TextAlign[\"Center\"] = \"center\";\r\n    /**\r\n     * The text is aligned at the normal start of the line (left-aligned for left-to-right locales,\r\n     * right-aligned for right-to-left locales).\r\n     */\r\n    TextAlign[\"Start\"] = \"start\";\r\n    /**\r\n     * The text is aligned at the normal end of the line (right-aligned for left-to-right locales,\r\n     * left-aligned for right-to-left locales).\r\n     */\r\n    TextAlign[\"End\"] = \"end\";\r\n})(TextAlign || (TextAlign = {}));\r\n/**\r\n * Enum representing the different baseline text alignments\r\n */\r\nvar BaseAlign;\r\n(function (BaseAlign) {\r\n    /**\r\n     * The text baseline is the top of the em square.\r\n     */\r\n    BaseAlign[\"Top\"] = \"top\";\r\n    /**\r\n     * The text baseline is the hanging baseline.  Currently unsupported; this will act like\r\n     * alphabetic.\r\n     */\r\n    BaseAlign[\"Hanging\"] = \"hanging\";\r\n    /**\r\n     * The text baseline is the middle of the em square.\r\n     */\r\n    BaseAlign[\"Middle\"] = \"middle\";\r\n    /**\r\n     * The text baseline is the normal alphabetic baseline.\r\n     */\r\n    BaseAlign[\"Alphabetic\"] = \"alphabetic\";\r\n    /**\r\n     * The text baseline is the ideographic baseline; this is the bottom of\r\n     * the body of the characters, if the main body of characters protrudes\r\n     * beneath the alphabetic baseline.  Currently unsupported; this will\r\n     * act like alphabetic.\r\n     */\r\n    BaseAlign[\"Ideographic\"] = \"ideographic\";\r\n    /**\r\n     * The text baseline is the bottom of the bounding box.  This differs\r\n     * from the ideographic baseline in that the ideographic baseline\r\n     * doesn't consider descenders.\r\n     */\r\n    BaseAlign[\"Bottom\"] = \"bottom\";\r\n})(BaseAlign || (BaseAlign = {}));\r\n/**\r\n * Enum representing the different possible font styles\r\n */\r\nvar FontStyle;\r\n(function (FontStyle) {\r\n    FontStyle[\"Normal\"] = \"normal\";\r\n    FontStyle[\"Italic\"] = \"italic\";\r\n    FontStyle[\"Oblique\"] = \"oblique\";\r\n})(FontStyle || (FontStyle = {}));\r\n/**\r\n * Enum representing the text direction, useful for other languages, or writing text in reverse\r\n */\r\nvar Direction;\r\n(function (Direction) {\r\n    Direction[\"LeftToRight\"] = \"ltr\";\r\n    Direction[\"RightToLeft\"] = \"rtl\";\r\n})(Direction || (Direction = {}));\r\n\n;// CONCATENATED MODULE: ./Graphics/Font.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Represents a system or web font in Excalibur\r\n *\r\n * If no options specified, the system sans-serif 10 pixel is used\r\n *\r\n * If loading a custom web font be sure to have the font loaded before you use it https://erikonarheim.com/posts/dont-test-fonts/\r\n */\r\nclass Font extends Graphic {\r\n    constructor(options = {}) {\r\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t, _u;\r\n        super(options); // <- Graphics properties\r\n        /**\r\n         * Set the font filtering mode, by default set to [[ImageFiltering.Blended]] regardless of the engine default smoothing\r\n         *\r\n         * If you have a pixel style font that may be a reason to switch this to [[ImageFiltering.Pixel]]\r\n         */\r\n        this.filtering = ImageFiltering.Blended;\r\n        /**\r\n         * Font quality determines the size of the underlying raster text, higher quality means less jagged edges.\r\n         * If quality is set to 1, then just enough raster bitmap is generated to render the text.\r\n         *\r\n         * You can think of quality as how zoomed in to the text you can get before seeing jagged edges.\r\n         *\r\n         * (Default 2)\r\n         */\r\n        this.quality = 2;\r\n        // Raster properties for fonts\r\n        this.padding = 2;\r\n        this.smoothing = false;\r\n        this.lineWidth = 1;\r\n        this.lineDash = [];\r\n        this.color = Color.Black;\r\n        this.family = 'sans-serif';\r\n        this.style = FontStyle.Normal;\r\n        this.bold = false;\r\n        this.unit = FontUnit.Px;\r\n        this.textAlign = TextAlign.Left;\r\n        this.baseAlign = BaseAlign.Alphabetic;\r\n        this.direction = Direction.LeftToRight;\r\n        this.size = 10;\r\n        this.shadow = null;\r\n        this._textBounds = new BoundingBox();\r\n        this._cachedTextMeasurement = new Map();\r\n        this._bitmapToTextMeasurement = new Map();\r\n        this._textToBitmap = new Map();\r\n        this._bitmapUsage = new Map();\r\n        this._textFragments = [];\r\n        // Raster properties\r\n        this.smoothing = (_a = options === null || options === void 0 ? void 0 : options.smoothing) !== null && _a !== void 0 ? _a : this.smoothing;\r\n        this.padding = (_b = options === null || options === void 0 ? void 0 : options.padding) !== null && _b !== void 0 ? _b : this.padding;\r\n        this.color = (_c = options === null || options === void 0 ? void 0 : options.color) !== null && _c !== void 0 ? _c : this.color;\r\n        this.strokeColor = (_d = options === null || options === void 0 ? void 0 : options.strokeColor) !== null && _d !== void 0 ? _d : this.strokeColor;\r\n        this.lineDash = (_e = options === null || options === void 0 ? void 0 : options.lineDash) !== null && _e !== void 0 ? _e : this.lineDash;\r\n        this.lineWidth = (_f = options === null || options === void 0 ? void 0 : options.lineWidth) !== null && _f !== void 0 ? _f : this.lineWidth;\r\n        this.filtering = (_g = options === null || options === void 0 ? void 0 : options.filtering) !== null && _g !== void 0 ? _g : this.filtering;\r\n        // Font specific properties\r\n        this.family = (_h = options === null || options === void 0 ? void 0 : options.family) !== null && _h !== void 0 ? _h : this.family;\r\n        this.style = (_j = options === null || options === void 0 ? void 0 : options.style) !== null && _j !== void 0 ? _j : this.style;\r\n        this.bold = (_k = options === null || options === void 0 ? void 0 : options.bold) !== null && _k !== void 0 ? _k : this.bold;\r\n        this.size = (_l = options === null || options === void 0 ? void 0 : options.size) !== null && _l !== void 0 ? _l : this.size;\r\n        this.unit = (_m = options === null || options === void 0 ? void 0 : options.unit) !== null && _m !== void 0 ? _m : this.unit;\r\n        this.textAlign = (_o = options === null || options === void 0 ? void 0 : options.textAlign) !== null && _o !== void 0 ? _o : this.textAlign;\r\n        this.baseAlign = (_p = options === null || options === void 0 ? void 0 : options.baseAlign) !== null && _p !== void 0 ? _p : this.baseAlign;\r\n        this.direction = (_q = options === null || options === void 0 ? void 0 : options.direction) !== null && _q !== void 0 ? _q : this.direction;\r\n        this.quality = (_r = options === null || options === void 0 ? void 0 : options.quality) !== null && _r !== void 0 ? _r : this.quality;\r\n        if (options === null || options === void 0 ? void 0 : options.shadow) {\r\n            this.shadow = {};\r\n            this.shadow.blur = (_s = options.shadow.blur) !== null && _s !== void 0 ? _s : this.shadow.blur;\r\n            this.shadow.offset = (_t = options.shadow.offset) !== null && _t !== void 0 ? _t : this.shadow.offset;\r\n            this.shadow.color = (_u = options.shadow.color) !== null && _u !== void 0 ? _u : this.shadow.color;\r\n        }\r\n    }\r\n    clone() {\r\n        return new Font({\r\n            ...this.cloneGraphicOptions(),\r\n            size: this.size,\r\n            unit: this.unit,\r\n            family: this.family,\r\n            style: this.style,\r\n            bold: this.bold,\r\n            textAlign: this.textAlign,\r\n            baseAlign: this.baseAlign,\r\n            direction: this.direction,\r\n            shadow: this.shadow\r\n                ? {\r\n                    blur: this.shadow.blur,\r\n                    offset: this.shadow.offset,\r\n                    color: this.shadow.color\r\n                }\r\n                : null\r\n        });\r\n    }\r\n    get fontString() {\r\n        return `${this.style} ${this.bold ? 'bold' : ''} ${this.size}${this.unit} ${this.family}`;\r\n    }\r\n    get localBounds() {\r\n        return this._textBounds;\r\n    }\r\n    _drawImage(_ex, _x, _y) {\r\n        // TODO weird vestigial drawimage\r\n    }\r\n    _rotate(ex) {\r\n        var _a;\r\n        // TODO this needs to change depending on the bounding box...\r\n        const origin = (_a = this.origin) !== null && _a !== void 0 ? _a : this._textBounds.center;\r\n        ex.translate(origin.x, origin.y);\r\n        ex.rotate(this.rotation);\r\n        ex.translate(-origin.x, -origin.y);\r\n    }\r\n    _flip(ex) {\r\n        if (this.flipHorizontal) {\r\n            ex.translate(this._textBounds.width / this.scale.x, 0);\r\n            ex.scale(-1, 1);\r\n        }\r\n        if (this.flipVertical) {\r\n            ex.translate(0, -this._textBounds.height / 2 / this.scale.y);\r\n            ex.scale(1, -1);\r\n        }\r\n    }\r\n    /**\r\n     * Returns a BoundingBox that is the total size of the text including multiple lines\r\n     *\r\n     * Does not include any padding or adjustment\r\n     * @param text\r\n     * @returns BoundingBox\r\n     */\r\n    measureText(text) {\r\n        let measurementDirty = false;\r\n        let cached = this._cachedTextMeasurement.get(text);\r\n        if (!cached) {\r\n            measurementDirty = true;\r\n        }\r\n        const rasterProps = this._getRasterPropertiesHash();\r\n        if (!cached || rasterProps !== cached.rasterProps) {\r\n            measurementDirty = true;\r\n        }\r\n        if (measurementDirty) {\r\n            const lines = text.split('\\n');\r\n            const maxWidthLine = lines.reduce((a, b) => {\r\n                return a.length > b.length ? a : b;\r\n            });\r\n            const ctx = this._getTextBitmap(text);\r\n            this._applyFont(ctx); // font must be applied to the context to measure it\r\n            const metrics = ctx.measureText(maxWidthLine);\r\n            let textHeight = Math.abs(metrics.actualBoundingBoxAscent) + Math.abs(metrics.actualBoundingBoxDescent);\r\n            // TODO lineheight makes the text bounds wonky\r\n            const lineAdjustedHeight = textHeight * lines.length;\r\n            textHeight = lineAdjustedHeight;\r\n            const bottomBounds = lineAdjustedHeight - Math.abs(metrics.actualBoundingBoxAscent);\r\n            const x = 0;\r\n            const y = 0;\r\n            // this._cachedText = text;\r\n            // this._cachedRasterProps = rasterProps;\r\n            // this._measurementDirty = false;\r\n            const measurement = new BoundingBox({\r\n                left: x - Math.abs(metrics.actualBoundingBoxLeft) - this.padding,\r\n                top: y - Math.abs(metrics.actualBoundingBoxAscent) - this.padding,\r\n                bottom: y + bottomBounds + this.padding,\r\n                right: x + Math.abs(metrics.actualBoundingBoxRight) + this.padding\r\n            });\r\n            cached = {\r\n                text,\r\n                rasterProps,\r\n                measurement\r\n            };\r\n            this._cachedTextMeasurement.set(text, cached);\r\n            this._bitmapToTextMeasurement.set(ctx, cached);\r\n            return cached.measurement;\r\n        }\r\n        else {\r\n            return cached.measurement;\r\n        }\r\n    }\r\n    _setDimension(textBounds, bitmap) {\r\n        // Changing the width and height clears the context properties\r\n        // We double the bitmap width to account for all possible alignment\r\n        // We scale by \"quality\" so we render text without jaggies\r\n        bitmap.canvas.width = (textBounds.width + this.padding * 2) * 2 * this.quality;\r\n        bitmap.canvas.height = (textBounds.height + this.padding * 2) * 2 * this.quality;\r\n    }\r\n    _postDraw(ex) {\r\n        ex.restore();\r\n    }\r\n    /**\r\n     * We need to identify bitmaps with more than just the text content\r\n     *\r\n     * Any properties that can change the rendering of the text\r\n     */\r\n    _getRasterPropertiesHash(color) {\r\n        var _a, _b;\r\n        const hash = '__hashcode__' +\r\n            this.fontString +\r\n            this.showDebug +\r\n            this.textAlign +\r\n            this.baseAlign +\r\n            this.direction +\r\n            JSON.stringify(this.shadow) +\r\n            (this.padding.toString() +\r\n                this.smoothing.toString() +\r\n                this.lineWidth.toString() +\r\n                this.lineDash.toString() +\r\n                ((_a = this.strokeColor) === null || _a === void 0 ? void 0 : _a.toString()) +\r\n                (color ? color.toString() : (_b = this.color) === null || _b === void 0 ? void 0 : _b.toString()).toString());\r\n        return hash;\r\n    }\r\n    _applyRasterProperties(ctx, color) {\r\n        var _a, _b, _c;\r\n        ctx.translate(this.padding, this.padding);\r\n        ctx.imageSmoothingEnabled = this.smoothing;\r\n        ctx.lineWidth = this.lineWidth;\r\n        ctx.setLineDash((_a = this.lineDash) !== null && _a !== void 0 ? _a : ctx.getLineDash());\r\n        ctx.strokeStyle = (_b = this.strokeColor) === null || _b === void 0 ? void 0 : _b.toString();\r\n        ctx.fillStyle = color ? color.toString() : (_c = this.color) === null || _c === void 0 ? void 0 : _c.toString();\r\n    }\r\n    _applyFont(ctx) {\r\n        ctx.translate(this.padding + ctx.canvas.width / 2, this.padding + ctx.canvas.height / 2);\r\n        ctx.scale(this.quality, this.quality);\r\n        ctx.textAlign = this.textAlign;\r\n        ctx.textBaseline = this.baseAlign;\r\n        ctx.font = this.fontString;\r\n        ctx.direction = this.direction;\r\n        if (this.shadow) {\r\n            ctx.shadowColor = this.shadow.color.toString();\r\n            ctx.shadowBlur = this.shadow.blur;\r\n            ctx.shadowOffsetX = this.shadow.offset.x;\r\n            ctx.shadowOffsetY = this.shadow.offset.y;\r\n        }\r\n    }\r\n    _drawText(ctx, text, colorOverride, lineHeight) {\r\n        const lines = text.split('\\n');\r\n        this._applyRasterProperties(ctx, colorOverride);\r\n        this._applyFont(ctx);\r\n        for (let i = 0; i < lines.length; i++) {\r\n            const line = lines[i];\r\n            if (this.color) {\r\n                ctx.fillText(line, 0, i * lineHeight);\r\n            }\r\n            if (this.strokeColor) {\r\n                ctx.strokeText(line, 0, i * lineHeight);\r\n            }\r\n        }\r\n        if (this.showDebug) {\r\n            // Horizontal line\r\n            /* istanbul ignore next */\r\n            line(ctx, Color.Red, -ctx.canvas.width / 2, 0, ctx.canvas.width / 2, 0, 2);\r\n            // Vertical line\r\n            /* istanbul ignore next */\r\n            line(ctx, Color.Red, 0, -ctx.canvas.height / 2, 0, ctx.canvas.height / 2, 2);\r\n        }\r\n    }\r\n    _getTextBitmap(text, color) {\r\n        const textAndHash = text + this._getRasterPropertiesHash(color);\r\n        const bitmap = this._textToBitmap.get(textAndHash);\r\n        if (bitmap) {\r\n            return bitmap;\r\n        }\r\n        const canvas = document.createElement('canvas');\r\n        const ctx = canvas.getContext('2d');\r\n        this._textToBitmap.set(textAndHash, ctx);\r\n        return ctx;\r\n    }\r\n    _splitTextBitmap(bitmap) {\r\n        const textImages = [];\r\n        let currentX = 0;\r\n        let currentY = 0;\r\n        // 4k is the max for mobile devices\r\n        const width = Math.min(4096, bitmap.canvas.width);\r\n        const height = Math.min(4096, bitmap.canvas.height);\r\n        // Splits the original bitmap into 4k max chunks\r\n        while (currentX < bitmap.canvas.width) {\r\n            while (currentY < bitmap.canvas.height) {\r\n                // create new bitmap\r\n                const canvas = document.createElement('canvas');\r\n                canvas.width = width;\r\n                canvas.height = height;\r\n                const ctx = canvas.getContext('2d');\r\n                // draw current slice to new bitmap in < 4k chunks\r\n                ctx.drawImage(bitmap.canvas, currentX, currentY, width, height, 0, 0, width, height);\r\n                textImages.push({ x: currentX, y: currentY, canvas });\r\n                currentY += height;\r\n            }\r\n            currentX += width;\r\n            currentY = 0;\r\n        }\r\n        return textImages;\r\n    }\r\n    render(ex, text, colorOverride, x, y) {\r\n        if (this.showDebug) {\r\n            this.clearCache();\r\n        }\r\n        this.checkAndClearCache();\r\n        // Get bitmap for rastering text, this is cached by raster properties\r\n        const bitmap = this._getTextBitmap(text, colorOverride);\r\n        const isNewBitmap = !this._bitmapUsage.get(bitmap);\r\n        // Bounds of the text\r\n        this._textBounds = this.measureText(text);\r\n        if (isNewBitmap) {\r\n            // Setting dimension is expensive because it invalidates the bitmap\r\n            this._setDimension(this._textBounds, bitmap);\r\n        }\r\n        // Apply affine transformations\r\n        this._preDraw(ex, x, y);\r\n        const lines = text.split('\\n');\r\n        const lineHeight = this._textBounds.height / lines.length;\r\n        if (isNewBitmap) {\r\n            // draws the text to the bitmap\r\n            this._drawText(bitmap, text, colorOverride, lineHeight);\r\n            // clean up any existing fragments\r\n            for (const frag of this._textFragments) {\r\n                TextureLoader[\"delete\"](frag.canvas);\r\n            }\r\n            this._textFragments = this._splitTextBitmap(bitmap);\r\n            for (const frag of this._textFragments) {\r\n                TextureLoader.load(frag.canvas, this.filtering, true);\r\n            }\r\n        }\r\n        // draws the bitmap fragments to excalibur graphics context\r\n        for (const frag of this._textFragments) {\r\n            ex.drawImage(frag.canvas, 0, 0, frag.canvas.width, frag.canvas.height, frag.x / this.quality + x - bitmap.canvas.width / this.quality / 2, frag.y / this.quality + y - bitmap.canvas.height / this.quality / 2, frag.canvas.width / this.quality, frag.canvas.height / this.quality);\r\n        }\r\n        this._postDraw(ex);\r\n        // Cache the bitmap for certain amount of time\r\n        this._bitmapUsage.set(bitmap, performance.now());\r\n    }\r\n    /**\r\n     * Get the internal cache size of the font\r\n     * This is useful when debugging memory usage, these numbers indicate the number of cached in memory text bitmaps\r\n     */\r\n    get cacheSize() {\r\n        return this._bitmapUsage.size;\r\n    }\r\n    /**\r\n     * Force clear all cached text bitmaps\r\n     */\r\n    clearCache() {\r\n        this._bitmapUsage.clear();\r\n    }\r\n    /**\r\n     * Remove any expired cached text bitmaps\r\n     */\r\n    checkAndClearCache() {\r\n        for (const [bitmap, time] of this._bitmapUsage.entries()) {\r\n            // if bitmap hasn't been used in 1 second clear it\r\n            if (time + 1000 < performance.now()) {\r\n                this._bitmapUsage.delete(bitmap);\r\n                // Cleanup measurements\r\n                const measurement = this._bitmapToTextMeasurement.get(bitmap);\r\n                if (measurement) {\r\n                    this._cachedTextMeasurement.delete(measurement.text);\r\n                    this._bitmapToTextMeasurement.delete(bitmap);\r\n                }\r\n                TextureLoader[\"delete\"](bitmap.canvas);\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Text.ts\n\r\n\r\n\r\n/**\r\n * Represent Text graphics in excalibur\r\n *\r\n * Useful for in game labels, ui, or overlays\r\n */\r\nclass Text extends Graphic {\r\n    constructor(options) {\r\n        var _a, _b;\r\n        super(options);\r\n        this._text = '';\r\n        this._textWidth = 0;\r\n        this._textHeight = 0;\r\n        // This order is important font, color, then text\r\n        this.font = (_a = options.font) !== null && _a !== void 0 ? _a : new Font();\r\n        this.color = (_b = options.color) !== null && _b !== void 0 ? _b : this.color;\r\n        this.text = options.text;\r\n    }\r\n    clone() {\r\n        var _a, _b;\r\n        return new Text({\r\n            text: this.text.slice(),\r\n            color: (_b = (_a = this.color) === null || _a === void 0 ? void 0 : _a.clone()) !== null && _b !== void 0 ? _b : Color.Black,\r\n            font: this.font.clone()\r\n        });\r\n    }\r\n    get text() {\r\n        return this._text;\r\n    }\r\n    set text(value) {\r\n        this._text = value;\r\n        const bounds = this.font.measureText(this._text);\r\n        this._textWidth = bounds.width;\r\n        this._textHeight = bounds.height;\r\n    }\r\n    get font() {\r\n        return this._font;\r\n    }\r\n    set font(font) {\r\n        this._font = font;\r\n    }\r\n    get width() {\r\n        if (this._textWidth === 0) {\r\n            this._calculateDimension();\r\n        }\r\n        return this._textWidth * this.scale.x;\r\n    }\r\n    get height() {\r\n        if (this._textHeight === 0) {\r\n            this._calculateDimension();\r\n        }\r\n        return this._textHeight * this.scale.y;\r\n    }\r\n    _calculateDimension() {\r\n        const { width, height } = this.font.measureText(this._text);\r\n        this._textWidth = width;\r\n        this._textHeight = height;\r\n    }\r\n    get localBounds() {\r\n        return this.font.measureText(this._text).scale(this.scale);\r\n    }\r\n    _rotate(_ex) {\r\n        // None this is delegated to font\r\n        // This override erases the default behavior\r\n    }\r\n    _flip(_ex) {\r\n        // None this is delegated to font\r\n        // This override erases the default behavior\r\n    }\r\n    _drawImage(ex, x, y) {\r\n        var _a;\r\n        let color = Color.Black;\r\n        if (this.font instanceof Font) {\r\n            color = (_a = this.color) !== null && _a !== void 0 ? _a : this.font.color;\r\n        }\r\n        if (this.isStale() || this.font.isStale()) {\r\n            this.font.flipHorizontal = this.flipHorizontal;\r\n            this.font.flipVertical = this.flipVertical;\r\n            this.font.rotation = this.rotation;\r\n            this.font.origin = this.origin;\r\n            this.font.opacity = this.opacity;\r\n        }\r\n        this.font.tint = this.tint;\r\n        const { width, height } = this.font.measureText(this._text);\r\n        this._textWidth = width;\r\n        this._textHeight = height;\r\n        this.font.render(ex, this._text, color, x, y);\r\n        if (this.font.showDebug) {\r\n            ex.debug.drawRect(x - width, y - height, width * 2, height * 2);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actor.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Type guard for checking if something is an Actor\r\n * @param x\r\n */\r\nfunction isActor(x) {\r\n    return x instanceof Actor;\r\n}\r\n/**\r\n * The most important primitive in Excalibur is an `Actor`. Anything that\r\n * can move on the screen, collide with another `Actor`, respond to events,\r\n * or interact with the current scene, must be an actor. An `Actor` **must**\r\n * be part of a [[Scene]] for it to be drawn to the screen.\r\n */\r\nclass Actor extends Entity {\r\n    // #endregion\r\n    /**\r\n     *\r\n     * @param config\r\n     */\r\n    constructor(config) {\r\n        super();\r\n        /**\r\n         * The anchor to apply all actor related transformations like rotation,\r\n         * translation, and scaling. By default the anchor is in the center of\r\n         * the actor. By default it is set to the center of the actor (.5, .5)\r\n         *\r\n         * An anchor of (.5, .5) will ensure that drawings are centered.\r\n         *\r\n         * Use `anchor.setTo` to set the anchor to a different point using\r\n         * values between 0 and 1. For example, anchoring to the top-left would be\r\n         * `Actor.anchor.setTo(0, 0)` and top-right would be `Actor.anchor.setTo(0, 1)`.\r\n         */\r\n        this._anchor = watch(Vector.Half, (v) => this._handleAnchorChange(v));\r\n        /**\r\n         * Convenience reference to the global logger\r\n         */\r\n        this.logger = Logger.getInstance();\r\n        /**\r\n         * The scene that the actor is in\r\n         */\r\n        this.scene = null;\r\n        /**\r\n         * Draggable helper\r\n         */\r\n        this._draggable = false;\r\n        this._dragging = false;\r\n        this._pointerDragStartHandler = () => {\r\n            this._dragging = true;\r\n        };\r\n        this._pointerDragEndHandler = () => {\r\n            this._dragging = false;\r\n        };\r\n        this._pointerDragMoveHandler = (pe) => {\r\n            if (this._dragging) {\r\n                this.pos = pe.worldPos;\r\n            }\r\n        };\r\n        this._pointerDragLeaveHandler = (pe) => {\r\n            if (this._dragging) {\r\n                this.pos = pe.worldPos;\r\n            }\r\n        };\r\n        const { name, x, y, pos, coordPlane, scale, width, height, radius, collider, vel, acc, rotation, angularVelocity, z, color, visible, anchor, collisionType, collisionGroup } = {\r\n            ...config\r\n        };\r\n        this._setName(name);\r\n        this.anchor = anchor !== null && anchor !== void 0 ? anchor : Actor.defaults.anchor.clone();\r\n        const tx = new TransformComponent();\r\n        this.addComponent(tx);\r\n        this.pos = pos !== null && pos !== void 0 ? pos : vec(x !== null && x !== void 0 ? x : 0, y !== null && y !== void 0 ? y : 0);\r\n        this.rotation = rotation !== null && rotation !== void 0 ? rotation : 0;\r\n        this.scale = scale !== null && scale !== void 0 ? scale : vec(1, 1);\r\n        this.z = z !== null && z !== void 0 ? z : 0;\r\n        tx.coordPlane = coordPlane !== null && coordPlane !== void 0 ? coordPlane : CoordPlane.World;\r\n        this.addComponent(new PointerComponent);\r\n        this.addComponent(new GraphicsComponent({\r\n            anchor: this.anchor\r\n        }));\r\n        this.addComponent(new MotionComponent());\r\n        this.vel = vel !== null && vel !== void 0 ? vel : Vector.Zero;\r\n        this.acc = acc !== null && acc !== void 0 ? acc : Vector.Zero;\r\n        this.angularVelocity = angularVelocity !== null && angularVelocity !== void 0 ? angularVelocity : 0;\r\n        this.addComponent(new ActionsComponent());\r\n        this.addComponent(new BodyComponent());\r\n        this.body.collisionType = collisionType !== null && collisionType !== void 0 ? collisionType : CollisionType.Passive;\r\n        if (collisionGroup) {\r\n            this.body.group = collisionGroup;\r\n        }\r\n        if (collider) {\r\n            this.addComponent(new ColliderComponent(collider));\r\n        }\r\n        else if (radius) {\r\n            this.addComponent(new ColliderComponent(Shape.Circle(radius)));\r\n        }\r\n        else {\r\n            if (width > 0 && height > 0) {\r\n                this.addComponent(new ColliderComponent(Shape.Box(width, height, this.anchor)));\r\n            }\r\n            else {\r\n                this.addComponent(new ColliderComponent()); // no collider\r\n            }\r\n        }\r\n        this.graphics.visible = visible !== null && visible !== void 0 ? visible : true;\r\n        if (color) {\r\n            this.color = color;\r\n            if (width && height) {\r\n                this.graphics.add(new Rectangle({\r\n                    color: color,\r\n                    width,\r\n                    height\r\n                }));\r\n            }\r\n            else if (radius) {\r\n                this.graphics.add(new Circle({\r\n                    color: color,\r\n                    radius\r\n                }));\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * The physics body the is associated with this actor. The body is the container for all physical properties, like position, velocity,\r\n     * acceleration, mass, inertia, etc.\r\n     */\r\n    get body() {\r\n        return this.get(BodyComponent);\r\n    }\r\n    /**\r\n     * Access the Actor's built in [[TransformComponent]]\r\n     */\r\n    get transform() {\r\n        return this.get(TransformComponent);\r\n    }\r\n    /**\r\n     * Access the Actor's built in [[MotionComponent]]\r\n     */\r\n    get motion() {\r\n        return this.get(MotionComponent);\r\n    }\r\n    /**\r\n     * Access to the Actor's built in [[GraphicsComponent]]\r\n     */\r\n    get graphics() {\r\n        return this.get(GraphicsComponent);\r\n    }\r\n    /**\r\n     * Access to the Actor's built in [[ColliderComponent]]\r\n     */\r\n    get collider() {\r\n        return this.get(ColliderComponent);\r\n    }\r\n    /**\r\n     * Access to the Actor's built in [[PointerComponent]] config\r\n     */\r\n    get pointer() {\r\n        return this.get(PointerComponent);\r\n    }\r\n    /**\r\n     * Useful for quickly scripting actor behavior, like moving to a place, patrolling back and forth, blinking, etc.\r\n     *\r\n     *  Access to the Actor's built in [[ActionsComponent]] which forwards to the\r\n     * [[ActionContext|Action context]] of the actor.\r\n     */\r\n    get actions() {\r\n        return this.get(ActionsComponent);\r\n    }\r\n    /**\r\n     * Gets the position vector of the actor in pixels\r\n     */\r\n    get pos() {\r\n        return this.transform.pos;\r\n    }\r\n    /**\r\n     * Sets the position vector of the actor in pixels\r\n     */\r\n    set pos(thePos) {\r\n        this.transform.pos = thePos.clone();\r\n    }\r\n    /**\r\n     * Gets the position vector of the actor from the last frame\r\n     */\r\n    get oldPos() {\r\n        return this.body.oldPos;\r\n    }\r\n    /**\r\n     * Sets the position vector of the actor in the last frame\r\n     */\r\n    set oldPos(thePos) {\r\n        this.body.oldPos.setTo(thePos.x, thePos.y);\r\n    }\r\n    /**\r\n     * Gets the velocity vector of the actor in pixels/sec\r\n     */\r\n    get vel() {\r\n        return this.motion.vel;\r\n    }\r\n    /**\r\n     * Sets the velocity vector of the actor in pixels/sec\r\n     */\r\n    set vel(theVel) {\r\n        this.motion.vel = theVel.clone();\r\n    }\r\n    /**\r\n     * Gets the velocity vector of the actor from the last frame\r\n     */\r\n    get oldVel() {\r\n        return this.body.oldVel;\r\n    }\r\n    /**\r\n     * Sets the velocity vector of the actor from the last frame\r\n     */\r\n    set oldVel(theVel) {\r\n        this.body.oldVel.setTo(theVel.x, theVel.y);\r\n    }\r\n    /**\r\n     * Gets the acceleration vector of the actor in pixels/second/second. An acceleration pointing down such as (0, 100) may be\r\n     * useful to simulate a gravitational effect.\r\n     */\r\n    get acc() {\r\n        return this.motion.acc;\r\n    }\r\n    /**\r\n     * Sets the acceleration vector of teh actor in pixels/second/second\r\n     */\r\n    set acc(theAcc) {\r\n        this.motion.acc = theAcc.clone();\r\n    }\r\n    /**\r\n     * Sets the acceleration of the actor from the last frame. This does not include the global acc [[Physics.acc]].\r\n     */\r\n    set oldAcc(theAcc) {\r\n        this.body.oldAcc.setTo(theAcc.x, theAcc.y);\r\n    }\r\n    /**\r\n     * Gets the acceleration of the actor from the last frame. This does not include the global acc [[Physics.acc]].\r\n     */\r\n    get oldAcc() {\r\n        return this.body.oldAcc;\r\n    }\r\n    /**\r\n     * Gets the rotation of the actor in radians. 1 radian = 180/PI Degrees.\r\n     */\r\n    get rotation() {\r\n        return this.transform.rotation;\r\n    }\r\n    /**\r\n     * Sets the rotation of the actor in radians. 1 radian = 180/PI Degrees.\r\n     */\r\n    set rotation(theAngle) {\r\n        this.transform.rotation = theAngle;\r\n    }\r\n    /**\r\n     * Gets the rotational velocity of the actor in radians/second\r\n     */\r\n    get angularVelocity() {\r\n        return this.motion.angularVelocity;\r\n    }\r\n    /**\r\n     * Sets the rotational velocity of the actor in radians/sec\r\n     */\r\n    set angularVelocity(angularVelocity) {\r\n        this.motion.angularVelocity = angularVelocity;\r\n    }\r\n    get scale() {\r\n        return this.get(TransformComponent).scale;\r\n    }\r\n    set scale(scale) {\r\n        this.get(TransformComponent).scale = scale;\r\n    }\r\n    get anchor() {\r\n        return this._anchor;\r\n    }\r\n    set anchor(vec) {\r\n        this._anchor = watch(vec, (v) => this._handleAnchorChange(v));\r\n        this._handleAnchorChange(vec);\r\n    }\r\n    _handleAnchorChange(v) {\r\n        if (this.graphics) {\r\n            this.graphics.anchor = v;\r\n        }\r\n    }\r\n    /**\r\n     * Indicates whether the actor is physically in the viewport\r\n     */\r\n    get isOffScreen() {\r\n        return this.hasTag('ex.offscreen');\r\n    }\r\n    get draggable() {\r\n        return this._draggable;\r\n    }\r\n    set draggable(isDraggable) {\r\n        if (isDraggable) {\r\n            if (isDraggable && !this._draggable) {\r\n                this.on('pointerdragstart', this._pointerDragStartHandler);\r\n                this.on('pointerdragend', this._pointerDragEndHandler);\r\n                this.on('pointerdragmove', this._pointerDragMoveHandler);\r\n                this.on('pointerdragleave', this._pointerDragLeaveHandler);\r\n            }\r\n            else if (!isDraggable && this._draggable) {\r\n                this.off('pointerdragstart', this._pointerDragStartHandler);\r\n                this.off('pointerdragend', this._pointerDragEndHandler);\r\n                this.off('pointerdragmove', this._pointerDragMoveHandler);\r\n                this.off('pointerdragleave', this._pointerDragLeaveHandler);\r\n            }\r\n            this._draggable = isDraggable;\r\n        }\r\n    }\r\n    /**\r\n     * Sets the color of the actor's current graphic\r\n     */\r\n    get color() {\r\n        return this._color;\r\n    }\r\n    set color(v) {\r\n        var _a;\r\n        this._color = v.clone();\r\n        const defaultLayer = this.graphics.layers.default;\r\n        const currentGraphic = (_a = defaultLayer.graphics[0]) === null || _a === void 0 ? void 0 : _a.graphic;\r\n        if (currentGraphic instanceof Raster || currentGraphic instanceof Text) {\r\n            currentGraphic.color = this._color;\r\n        }\r\n    }\r\n    /**\r\n     * `onInitialize` is called before the first update of the actor. This method is meant to be\r\n     * overridden. This is where initialization of child actors should take place.\r\n     *\r\n     * Synonymous with the event handler `.on('initialize', (evt) => {...})`\r\n     */\r\n    onInitialize(_engine) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * Initializes this actor and all it's child actors, meant to be called by the Scene before first update not by users of Excalibur.\r\n     *\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * @internal\r\n     */\r\n    _initialize(engine) {\r\n        super._initialize(engine);\r\n        for (const child of this.children) {\r\n            child._initialize(engine);\r\n        }\r\n    }\r\n    on(eventName, handler) {\r\n        super.on(eventName, handler);\r\n    }\r\n    once(eventName, handler) {\r\n        super.once(eventName, handler);\r\n    }\r\n    off(eventName, handler) {\r\n        super.off(eventName, handler);\r\n    }\r\n    // #endregion\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _prekill handler for [[onPreKill]] lifecycle event\r\n     * @internal\r\n     */\r\n    _prekill(_scene) {\r\n        super.emit('prekill', new PreKillEvent(this));\r\n        this.onPreKill(_scene);\r\n    }\r\n    /**\r\n     * Safe to override onPreKill lifecycle event handler. Synonymous with `.on('prekill', (evt) =>{...})`\r\n     *\r\n     * `onPreKill` is called directly before an actor is killed and removed from its current [[Scene]].\r\n     */\r\n    onPreKill(_scene) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _prekill handler for [[onPostKill]] lifecycle event\r\n     * @internal\r\n     */\r\n    _postkill(_scene) {\r\n        super.emit('postkill', new PostKillEvent(this));\r\n        this.onPostKill(_scene);\r\n    }\r\n    /**\r\n     * Safe to override onPostKill lifecycle event handler. Synonymous with `.on('postkill', (evt) => {...})`\r\n     *\r\n     * `onPostKill` is called directly after an actor is killed and remove from its current [[Scene]].\r\n     */\r\n    onPostKill(_scene) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * If the current actor is a member of the scene, this will remove\r\n     * it from the scene graph. It will no longer be drawn or updated.\r\n     */\r\n    kill() {\r\n        if (this.scene) {\r\n            this._prekill(this.scene);\r\n            this.emit('kill', new KillEvent(this));\r\n            super.kill();\r\n            this._postkill(this.scene);\r\n        }\r\n        else {\r\n            this.logger.warn('Cannot kill actor, it was never added to the Scene');\r\n        }\r\n    }\r\n    /**\r\n     * If the current actor is killed, it will now not be killed.\r\n     */\r\n    unkill() {\r\n        this.active = true;\r\n    }\r\n    /**\r\n     * Indicates wether the actor has been killed.\r\n     */\r\n    isKilled() {\r\n        return !this.active;\r\n    }\r\n    /**\r\n     * Gets the z-index of an actor. The z-index determines the relative order an actor is drawn in.\r\n     * Actors with a higher z-index are drawn on top of actors with a lower z-index\r\n     */\r\n    get z() {\r\n        return this.get(TransformComponent).z;\r\n    }\r\n    /**\r\n     * Sets the z-index of an actor and updates it in the drawing list for the scene.\r\n     * The z-index determines the relative order an actor is drawn in.\r\n     * Actors with a higher z-index are drawn on top of actors with a lower z-index\r\n     * @param newZ new z-index to assign\r\n     */\r\n    set z(newZ) {\r\n        this.get(TransformComponent).z = newZ;\r\n    }\r\n    /**\r\n     * Get the center point of an actor (global position)\r\n     */\r\n    get center() {\r\n        const globalPos = this.getGlobalPos();\r\n        return new Vector(globalPos.x + this.width / 2 - this.anchor.x * this.width, globalPos.y + this.height / 2 - this.anchor.y * this.height);\r\n    }\r\n    /**\r\n     * Get the local center point of an actor\r\n     */\r\n    get localCenter() {\r\n        return new Vector(this.pos.x + this.width / 2 - this.anchor.x * this.width, this.pos.y + this.height / 2 - this.anchor.y * this.height);\r\n    }\r\n    get width() {\r\n        return this.collider.localBounds.width * this.getGlobalScale().x;\r\n    }\r\n    get height() {\r\n        return this.collider.localBounds.height * this.getGlobalScale().y;\r\n    }\r\n    /**\r\n     * Gets this actor's rotation taking into account any parent relationships\r\n     *\r\n     * @returns Rotation angle in radians\r\n     */\r\n    getGlobalRotation() {\r\n        return this.get(TransformComponent).globalRotation;\r\n    }\r\n    /**\r\n     * Gets an actor's world position taking into account parent relationships, scaling, rotation, and translation\r\n     *\r\n     * @returns Position in world coordinates\r\n     */\r\n    getGlobalPos() {\r\n        return this.get(TransformComponent).globalPos;\r\n    }\r\n    /**\r\n     * Gets the global scale of the Actor\r\n     */\r\n    getGlobalScale() {\r\n        return this.get(TransformComponent).globalScale;\r\n    }\r\n    // #region Collision\r\n    /**\r\n     * Tests whether the x/y specified are contained in the actor\r\n     * @param x  X coordinate to test (in world coordinates)\r\n     * @param y  Y coordinate to test (in world coordinates)\r\n     * @param recurse checks whether the x/y are contained in any child actors (if they exist).\r\n     */\r\n    contains(x, y, recurse = false) {\r\n        const point = vec(x, y);\r\n        const collider = this.get(ColliderComponent);\r\n        collider.update();\r\n        const geom = collider.get();\r\n        if (!geom) {\r\n            return false;\r\n        }\r\n        const containment = geom.contains(point);\r\n        if (recurse) {\r\n            return (containment ||\r\n                this.children.some((child) => {\r\n                    return child.contains(x, y, true);\r\n                }));\r\n        }\r\n        return containment;\r\n    }\r\n    /**\r\n     * Returns true if the two actor.collider's surfaces are less than or equal to the distance specified from each other\r\n     * @param actor     Actor to test\r\n     * @param distance  Distance in pixels to test\r\n     */\r\n    within(actor, distance) {\r\n        const collider = this.get(ColliderComponent);\r\n        const otherCollider = actor.get(ColliderComponent);\r\n        const me = collider.get();\r\n        const other = otherCollider.get();\r\n        if (me && other) {\r\n            return me.getClosestLineBetween(other).getLength() <= distance;\r\n        }\r\n        return false;\r\n    }\r\n    // #endregion\r\n    // #region Update\r\n    /**\r\n     * Called by the Engine, updates the state of the actor\r\n     * @internal\r\n     * @param engine The reference to the current game engine\r\n     * @param delta  The time elapsed since the last update in milliseconds\r\n     */\r\n    update(engine, delta) {\r\n        this._initialize(engine);\r\n        this._preupdate(engine, delta);\r\n        this._postupdate(engine, delta);\r\n    }\r\n    /**\r\n     * Safe to override onPreUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPreUpdate` is called directly before an actor is updated.\r\n     */\r\n    onPreUpdate(_engine, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('postupdate', (evt) =>{...})`\r\n     *\r\n     * `onPostUpdate` is called directly after an actor is updated.\r\n     */\r\n    onPostUpdate(_engine, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPreUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _preupdate(engine, delta) {\r\n        this.emit('preupdate', new PreUpdateEvent(engine, delta, this));\r\n        this.onPreUpdate(engine, delta);\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPostUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _postupdate(engine, delta) {\r\n        this.emit('postupdate', new PreUpdateEvent(engine, delta, this));\r\n        this.onPostUpdate(engine, delta);\r\n    }\r\n}\r\n// #region Properties\r\n/**\r\n * Set defaults for all Actors\r\n */\r\nActor.defaults = {\r\n    anchor: Vector.Half\r\n};\r\n\n;// CONCATENATED MODULE: ./ScreenElement.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Type guard to detect a screen element\r\n */\r\nfunction isScreenElement(actor) {\r\n    return actor instanceof ScreenElement;\r\n}\r\n/**\r\n * Helper [[Actor]] primitive for drawing UI's, optimized for UI drawing. Does\r\n * not participate in collisions. Drawn on top of all other actors.\r\n */\r\nclass ScreenElement extends Actor {\r\n    constructor(config) {\r\n        super({ ...config });\r\n        this.get(TransformComponent).coordPlane = CoordPlane.Screen;\r\n        this.anchor = vec(0, 0);\r\n        this.body.collisionType = CollisionType.PreventCollision;\r\n        this.collider.useBoxCollider(this.width, this.height, this.anchor);\r\n    }\r\n    _initialize(engine) {\r\n        this._engine = engine;\r\n        super._initialize(engine);\r\n    }\r\n    contains(x, y, useWorld = true) {\r\n        if (useWorld) {\r\n            return super.contains(x, y);\r\n        }\r\n        const coords = this._engine.worldToScreenCoordinates(new Vector(x, y));\r\n        return super.contains(coords.x, coords.y);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Timer.ts\n\r\n\r\n/**\r\n * The Excalibur timer hooks into the internal timer and fires callbacks,\r\n * after a certain interval, optionally repeating.\r\n */\r\nclass Timer {\r\n    constructor(fcn, interval, repeats, numberOfRepeats, randomRange, random) {\r\n        this._logger = Logger.getInstance();\r\n        this.id = 0;\r\n        this._elapsedTime = 0;\r\n        this._totalTimeAlive = 0;\r\n        this._running = false;\r\n        this._numberOfTicks = 0;\r\n        this.interval = 10;\r\n        this.repeats = false;\r\n        this.maxNumberOfRepeats = -1;\r\n        this.randomRange = [0, 0];\r\n        this._baseInterval = 10;\r\n        this._generateRandomInterval = () => {\r\n            return this._baseInterval + this.random.integer(this.randomRange[0], this.randomRange[1]);\r\n        };\r\n        this._complete = false;\r\n        this.scene = null;\r\n        if (typeof fcn !== 'function') {\r\n            const options = fcn;\r\n            fcn = options.fcn;\r\n            interval = options.interval;\r\n            repeats = options.repeats;\r\n            numberOfRepeats = options.numberOfRepeats;\r\n            randomRange = options.randomRange;\r\n            random = options.random;\r\n        }\r\n        if (!!numberOfRepeats && numberOfRepeats >= 0) {\r\n            this.maxNumberOfRepeats = numberOfRepeats;\r\n            if (!repeats) {\r\n                throw new Error('repeats must be set to true if numberOfRepeats is set');\r\n            }\r\n        }\r\n        this.id = Timer._MAX_ID++;\r\n        this._callbacks = [];\r\n        this._baseInterval = this.interval = interval;\r\n        if (!!randomRange) {\r\n            if (randomRange[0] > randomRange[1]) {\r\n                throw new Error('min value must be lower than max value for range');\r\n            }\r\n            //We use the instance of ex.Random to generate the range\r\n            this.random = random !== null && random !== void 0 ? random : new Random();\r\n            this.randomRange = randomRange;\r\n            this.interval = this._generateRandomInterval();\r\n            this.on(() => {\r\n                this.interval = this._generateRandomInterval();\r\n            });\r\n        }\r\n        ;\r\n        this.repeats = repeats || this.repeats;\r\n        if (fcn) {\r\n            this.on(fcn);\r\n        }\r\n    }\r\n    get complete() {\r\n        return this._complete;\r\n    }\r\n    /**\r\n     * Adds a new callback to be fired after the interval is complete\r\n     * @param fcn The callback to be added to the callback list, to be fired after the interval is complete.\r\n     */\r\n    on(fcn) {\r\n        this._callbacks.push(fcn);\r\n    }\r\n    /**\r\n     * Removes a callback from the callback list to be fired after the interval is complete.\r\n     * @param fcn The callback to be removed from the callback list, to be fired after the interval is complete.\r\n     */\r\n    off(fcn) {\r\n        const index = this._callbacks.indexOf(fcn);\r\n        this._callbacks.splice(index, 1);\r\n    }\r\n    /**\r\n     * Updates the timer after a certain number of milliseconds have elapsed. This is used internally by the engine.\r\n     * @param delta  Number of elapsed milliseconds since the last update.\r\n     */\r\n    update(delta) {\r\n        if (this._running) {\r\n            this._totalTimeAlive += delta;\r\n            this._elapsedTime += delta;\r\n            if (this.maxNumberOfRepeats > -1 && this._numberOfTicks >= this.maxNumberOfRepeats) {\r\n                this._complete = true;\r\n                this._running = false;\r\n                this._elapsedTime = 0;\r\n            }\r\n            if (!this.complete && this._elapsedTime >= this.interval) {\r\n                this._callbacks.forEach((c) => {\r\n                    c.call(this);\r\n                });\r\n                this._numberOfTicks++;\r\n                if (this.repeats) {\r\n                    this._elapsedTime = 0;\r\n                }\r\n                else {\r\n                    this._complete = true;\r\n                    this._running = false;\r\n                    this._elapsedTime = 0;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Resets the timer so that it can be reused, and optionally reconfigure the timers interval.\r\n     *\r\n     * Warning** you may need to call `timer.start()` again if the timer had completed\r\n     * @param newInterval If specified, sets a new non-negative interval in milliseconds to refire the callback\r\n     * @param newNumberOfRepeats If specified, sets a new non-negative upper limit to the number of time this timer executes\r\n     */\r\n    reset(newInterval, newNumberOfRepeats) {\r\n        if (!!newInterval && newInterval >= 0) {\r\n            this._baseInterval = this.interval = newInterval;\r\n        }\r\n        if (!!this.maxNumberOfRepeats && this.maxNumberOfRepeats >= 0) {\r\n            this.maxNumberOfRepeats = newNumberOfRepeats;\r\n            if (!this.repeats) {\r\n                throw new Error('repeats must be set to true if numberOfRepeats is set');\r\n            }\r\n        }\r\n        this._complete = false;\r\n        this._elapsedTime = 0;\r\n        this._numberOfTicks = 0;\r\n    }\r\n    get timesRepeated() {\r\n        return this._numberOfTicks;\r\n    }\r\n    getTimeRunning() {\r\n        return this._totalTimeAlive;\r\n    }\r\n    /**\r\n     * @returns milliseconds until the next action callback, if complete will return 0\r\n     */\r\n    get timeToNextAction() {\r\n        if (this.complete) {\r\n            return 0;\r\n        }\r\n        return this.interval - this._elapsedTime;\r\n    }\r\n    /**\r\n     * @returns milliseconds elapsed toward the next action\r\n     */\r\n    get timeElapsedTowardNextAction() {\r\n        return this._elapsedTime;\r\n    }\r\n    get isRunning() {\r\n        return this._running;\r\n    }\r\n    /**\r\n     * Pauses the timer, time will no longer increment towards the next call\r\n     */\r\n    pause() {\r\n        this._running = false;\r\n        return this;\r\n    }\r\n    /**\r\n     * Resumes the timer, time will now increment towards the next call.\r\n     */\r\n    resume() {\r\n        this._running = true;\r\n        return this;\r\n    }\r\n    /**\r\n     * Starts the timer, if the timer was complete it will restart the timer and reset the elapsed time counter\r\n     */\r\n    start() {\r\n        if (!this.scene) {\r\n            this._logger.warn('Cannot start a timer not part of a scene, timer wont start until added');\r\n        }\r\n        this._running = true;\r\n        if (this.complete) {\r\n            this._complete = false;\r\n            this._elapsedTime = 0;\r\n            this._numberOfTicks = 0;\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Stops the timer and resets the elapsed time counter towards the next action invocation\r\n     */\r\n    stop() {\r\n        this._running = false;\r\n        this._elapsedTime = 0;\r\n        this._numberOfTicks = 0;\r\n        return this;\r\n    }\r\n    /**\r\n     * Cancels the timer, preventing any further executions.\r\n     */\r\n    cancel() {\r\n        this.pause();\r\n        if (this.scene) {\r\n            this.scene.cancelTimer(this);\r\n        }\r\n    }\r\n}\r\nTimer._MAX_ID = 0;\r\n\n;// CONCATENATED MODULE: ./Graphics/ParallaxComponent.ts\n\r\n\r\nclass ParallaxComponent extends Component {\r\n    constructor(parallaxFactor) {\r\n        super();\r\n        this.type = 'ex.parallax';\r\n        this.parallaxFactor = vec(1.0, 1.0);\r\n        this.parallaxFactor = parallaxFactor !== null && parallaxFactor !== void 0 ? parallaxFactor : this.parallaxFactor;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/DebugGraphicsComponent.ts\n\r\n/**\r\n * Provide arbitrary drawing for the purposes of debugging your game\r\n *\r\n * Will only show when the Engine is set to debug mode [[Engine.showDebug]] or [[Engine.toggleDebug]]\r\n *\r\n */\r\nclass DebugGraphicsComponent extends Component {\r\n    constructor(draw, useTransform = true) {\r\n        super();\r\n        this.draw = draw;\r\n        this.useTransform = useTransform;\r\n        this.type = 'ex.debuggraphics';\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./TileMap/TileMap.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * The TileMap provides a mechanism for doing flat 2D tiles rendered in a grid.\r\n *\r\n * TileMaps are useful for top down or side scrolling grid oriented games.\r\n */\r\nclass TileMap extends Entity {\r\n    /**\r\n     * @param options\r\n     */\r\n    constructor(options) {\r\n        var _a, _b;\r\n        super(null, options.name);\r\n        this._token = 0;\r\n        this._onScreenXStart = 0;\r\n        this._onScreenXEnd = Number.MAX_VALUE;\r\n        this._onScreenYStart = 0;\r\n        this._onScreenYEnd = Number.MAX_VALUE;\r\n        this.logger = Logger.getInstance();\r\n        this.tiles = [];\r\n        this._rows = [];\r\n        this._cols = [];\r\n        this.renderFromTopOfGraphic = false;\r\n        this._collidersDirty = true;\r\n        this._originalOffsets = new WeakMap();\r\n        this.addComponent(new TransformComponent());\r\n        this.addComponent(new MotionComponent());\r\n        this.addComponent(new BodyComponent({\r\n            type: CollisionType.Fixed\r\n        }));\r\n        this.addComponent(new GraphicsComponent({\r\n            onPostDraw: (ctx, delta) => this.draw(ctx, delta)\r\n        }));\r\n        this.addComponent(new DebugGraphicsComponent((ctx) => this.debug(ctx)));\r\n        this.addComponent(new ColliderComponent());\r\n        this._graphics = this.get(GraphicsComponent);\r\n        this._transform = this.get(TransformComponent);\r\n        this._motion = this.get(MotionComponent);\r\n        this._collider = this.get(ColliderComponent);\r\n        this._composite = this._collider.useCompositeCollider([]);\r\n        this._transform.pos = (_a = options.pos) !== null && _a !== void 0 ? _a : Vector.Zero;\r\n        this._oldPos = this._transform.pos;\r\n        this.renderFromTopOfGraphic = (_b = options.renderFromTopOfGraphic) !== null && _b !== void 0 ? _b : this.renderFromTopOfGraphic;\r\n        this.tileWidth = options.tileWidth;\r\n        this.tileHeight = options.tileHeight;\r\n        this.rows = options.rows;\r\n        this.columns = options.columns;\r\n        this.tiles = new Array(this.rows * this.columns);\r\n        this._rows = new Array(this.rows);\r\n        this._cols = new Array(this.columns);\r\n        let currentCol = [];\r\n        for (let i = 0; i < this.columns; i++) {\r\n            for (let j = 0; j < this.rows; j++) {\r\n                const cd = new Tile({\r\n                    x: i,\r\n                    y: j,\r\n                    map: this\r\n                });\r\n                cd.map = this;\r\n                this.tiles[i + j * this.columns] = cd;\r\n                currentCol.push(cd);\r\n                if (!this._rows[j]) {\r\n                    this._rows[j] = [];\r\n                }\r\n                this._rows[j].push(cd);\r\n            }\r\n            this._cols[i] = currentCol;\r\n            currentCol = [];\r\n        }\r\n        this._graphics.localBounds = new BoundingBox({\r\n            left: 0,\r\n            top: 0,\r\n            right: this.columns * this.tileWidth,\r\n            bottom: this.rows * this.tileHeight\r\n        });\r\n    }\r\n    flagCollidersDirty() {\r\n        this._collidersDirty = true;\r\n    }\r\n    get x() {\r\n        var _a;\r\n        return (_a = this._transform.pos.x) !== null && _a !== void 0 ? _a : 0;\r\n    }\r\n    set x(val) {\r\n        var _a;\r\n        if ((_a = this._transform) === null || _a === void 0 ? void 0 : _a.pos) {\r\n            this.get(TransformComponent).pos = vec(val, this.y);\r\n        }\r\n    }\r\n    get y() {\r\n        var _a, _b;\r\n        return (_b = (_a = this._transform) === null || _a === void 0 ? void 0 : _a.pos.y) !== null && _b !== void 0 ? _b : 0;\r\n    }\r\n    set y(val) {\r\n        var _a;\r\n        if ((_a = this._transform) === null || _a === void 0 ? void 0 : _a.pos) {\r\n            this._transform.pos = vec(this.x, val);\r\n        }\r\n    }\r\n    get z() {\r\n        var _a;\r\n        return (_a = this._transform.z) !== null && _a !== void 0 ? _a : 0;\r\n    }\r\n    set z(val) {\r\n        if (this._transform) {\r\n            this._transform.z = val;\r\n        }\r\n    }\r\n    get rotation() {\r\n        var _a, _b;\r\n        return (_b = (_a = this._transform) === null || _a === void 0 ? void 0 : _a.rotation) !== null && _b !== void 0 ? _b : 0;\r\n    }\r\n    set rotation(val) {\r\n        var _a;\r\n        if ((_a = this._transform) === null || _a === void 0 ? void 0 : _a.rotation) {\r\n            this._transform.rotation = val;\r\n        }\r\n    }\r\n    get scale() {\r\n        var _a, _b;\r\n        return (_b = (_a = this._transform) === null || _a === void 0 ? void 0 : _a.scale) !== null && _b !== void 0 ? _b : Vector.One;\r\n    }\r\n    set scale(val) {\r\n        var _a;\r\n        if ((_a = this._transform) === null || _a === void 0 ? void 0 : _a.scale) {\r\n            this._transform.scale = val;\r\n        }\r\n    }\r\n    get pos() {\r\n        return this._transform.pos;\r\n    }\r\n    set pos(val) {\r\n        this._transform.pos = val;\r\n    }\r\n    get vel() {\r\n        return this._motion.vel;\r\n    }\r\n    set vel(val) {\r\n        this._motion.vel = val;\r\n    }\r\n    on(eventName, handler) {\r\n        super.on(eventName, handler);\r\n    }\r\n    _initialize(engine) {\r\n        super._initialize(engine);\r\n    }\r\n    _getOrSetColliderOriginalOffset(collider) {\r\n        if (!this._originalOffsets.has(collider)) {\r\n            const originalOffset = collider.offset;\r\n            this._originalOffsets.set(collider, originalOffset);\r\n            return originalOffset;\r\n        }\r\n        else {\r\n            return this._originalOffsets.get(collider);\r\n        }\r\n    }\r\n    /**\r\n     * Tiles colliders based on the solid tiles in the tilemap.\r\n     */\r\n    _updateColliders() {\r\n        this._composite.clearColliders();\r\n        const colliders = [];\r\n        this._composite = this._collider.useCompositeCollider([]);\r\n        let current;\r\n        // Bad square tesselation algo\r\n        for (let i = 0; i < this.columns; i++) {\r\n            // Scan column for colliders\r\n            for (let j = 0; j < this.rows; j++) {\r\n                // Columns start with a new collider\r\n                if (j === 0) {\r\n                    current = null;\r\n                }\r\n                const tile = this.tiles[i + j * this.columns];\r\n                // Current tile in column is solid build up current collider\r\n                if (tile.solid) {\r\n                    // Use custom collider otherwise bounding box\r\n                    if (tile.getColliders().length > 0) {\r\n                        for (const collider of tile.getColliders()) {\r\n                            const originalOffset = this._getOrSetColliderOriginalOffset(collider);\r\n                            collider.offset = vec(tile.x * this.tileWidth, tile.y * this.tileHeight).add(originalOffset);\r\n                            collider.owner = this;\r\n                            this._composite.addCollider(collider);\r\n                        }\r\n                        current = null;\r\n                    }\r\n                    else {\r\n                        if (!current) {\r\n                            current = tile.bounds;\r\n                        }\r\n                        else {\r\n                            current = current.combine(tile.bounds);\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    // Not solid skip and cut off the current collider\r\n                    if (current) {\r\n                        colliders.push(current);\r\n                    }\r\n                    current = null;\r\n                }\r\n            }\r\n            // After a column is complete check to see if it can be merged into the last one\r\n            if (current) {\r\n                // if previous is the same combine it\r\n                const prev = colliders[colliders.length - 1];\r\n                if (prev && prev.top === current.top && prev.bottom === current.bottom) {\r\n                    colliders[colliders.length - 1] = prev.combine(current);\r\n                }\r\n                else {\r\n                    // else new collider\r\n                    colliders.push(current);\r\n                }\r\n            }\r\n        }\r\n        for (const c of colliders) {\r\n            const collider = Shape.Box(c.width, c.height, Vector.Zero, vec(c.left - this.pos.x, c.top - this.pos.y));\r\n            collider.owner = this;\r\n            this._composite.addCollider(collider);\r\n        }\r\n        this._collider.update();\r\n    }\r\n    /**\r\n     * Returns the [[Tile]] by index (row major order)\r\n     */\r\n    getTileByIndex(index) {\r\n        return this.tiles[index];\r\n    }\r\n    /**\r\n     * Returns the [[Tile]] by its x and y integer coordinates\r\n     */\r\n    getTile(x, y) {\r\n        if (x < 0 || y < 0 || x >= this.columns || y >= this.rows) {\r\n            return null;\r\n        }\r\n        return this.tiles[x + y * this.columns];\r\n    }\r\n    /**\r\n     * Returns the [[Tile]] by testing a point in world coordinates,\r\n     * returns `null` if no Tile was found.\r\n     */\r\n    getTileByPoint(point) {\r\n        const x = Math.floor((point.x - this.pos.x) / this.tileWidth);\r\n        const y = Math.floor((point.y - this.pos.y) / this.tileHeight);\r\n        const tile = this.getTile(x, y);\r\n        if (x >= 0 && y >= 0 && x < this.columns && y < this.rows && tile) {\r\n            return tile;\r\n        }\r\n        return null;\r\n    }\r\n    getRows() {\r\n        return this._rows;\r\n    }\r\n    getColumns() {\r\n        return this._cols;\r\n    }\r\n    update(engine, delta) {\r\n        this.onPreUpdate(engine, delta);\r\n        this.emit('preupdate', new PreUpdateEvent(engine, delta, this));\r\n        if (!this._oldPos.equals(this.pos)) {\r\n            this.flagCollidersDirty();\r\n            for (let i = 0; i < this.tiles.length; i++) {\r\n                if (this.tiles[i]) {\r\n                    this.tiles[i].flagDirty();\r\n                }\r\n            }\r\n        }\r\n        if (this._collidersDirty) {\r\n            this._collidersDirty = false;\r\n            this._updateColliders();\r\n        }\r\n        this._token++;\r\n        const worldBounds = engine.getWorldBounds();\r\n        const worldCoordsUpperLeft = vec(worldBounds.left, worldBounds.top);\r\n        const worldCoordsLowerRight = vec(worldBounds.right, worldBounds.bottom);\r\n        let pos = this.pos;\r\n        const maybeParallax = this.get(ParallaxComponent);\r\n        let parallaxOffset = Vector.One;\r\n        if (maybeParallax) {\r\n            const oneMinusFactor = Vector.One.sub(maybeParallax.parallaxFactor);\r\n            parallaxOffset = engine.currentScene.camera.pos.scale(oneMinusFactor);\r\n            pos = pos.add(parallaxOffset);\r\n        }\r\n        this._onScreenXStart = Math.max(Math.floor((worldCoordsUpperLeft.x - pos.x) / this.tileWidth) - 2, 0);\r\n        this._onScreenYStart = Math.max(Math.floor((worldCoordsUpperLeft.y - pos.y) / this.tileHeight) - 2, 0);\r\n        this._onScreenXEnd = Math.max(Math.floor((worldCoordsLowerRight.x - pos.x) / this.tileWidth) + 2, 0);\r\n        this._onScreenYEnd = Math.max(Math.floor((worldCoordsLowerRight.y - pos.y) / this.tileHeight) + 2, 0);\r\n        // why are we resetting pos?\r\n        this._transform.pos = vec(this.x, this.y);\r\n        this.onPostUpdate(engine, delta);\r\n        this.emit('postupdate', new PostUpdateEvent(engine, delta, this));\r\n    }\r\n    /**\r\n     * Draws the tile map to the screen. Called by the [[Scene]].\r\n     * @param ctx ExcaliburGraphicsContext\r\n     * @param delta  The number of milliseconds since the last draw\r\n     */\r\n    draw(ctx, delta) {\r\n        this.emit('predraw', new PreDrawEvent(ctx, delta, this)); // TODO fix event\r\n        let x = this._onScreenXStart;\r\n        const xEnd = Math.min(this._onScreenXEnd, this.columns);\r\n        let y = this._onScreenYStart;\r\n        const yEnd = Math.min(this._onScreenYEnd, this.rows);\r\n        let graphics, graphicsIndex, graphicsLen;\r\n        for (x; x < xEnd; x++) {\r\n            for (y; y < yEnd; y++) {\r\n                // get non-negative tile sprites\r\n                graphics = this.getTile(x, y).getGraphics();\r\n                for (graphicsIndex = 0, graphicsLen = graphics.length; graphicsIndex < graphicsLen; graphicsIndex++) {\r\n                    // draw sprite, warning if sprite doesn't exist\r\n                    const graphic = graphics[graphicsIndex];\r\n                    if (graphic) {\r\n                        if (hasGraphicsTick(graphic)) {\r\n                            graphic === null || graphic === void 0 ? void 0 : graphic.tick(delta, this._token);\r\n                        }\r\n                        const offsetY = this.renderFromTopOfGraphic ? 0 : (graphic.height - this.tileHeight);\r\n                        graphic.draw(ctx, x * this.tileWidth, y * this.tileHeight - offsetY);\r\n                    }\r\n                }\r\n            }\r\n            y = this._onScreenYStart;\r\n        }\r\n        this.emit('postdraw', new PostDrawEvent(ctx, delta, this));\r\n    }\r\n    debug(gfx) {\r\n        const width = this.tileWidth * this.columns;\r\n        const height = this.tileHeight * this.rows;\r\n        const pos = Vector.Zero;\r\n        for (let r = 0; r < this.rows + 1; r++) {\r\n            const yOffset = vec(0, r * this.tileHeight);\r\n            gfx.drawLine(pos.add(yOffset), pos.add(vec(width, yOffset.y)), Color.Red, 2);\r\n        }\r\n        for (let c = 0; c < this.columns + 1; c++) {\r\n            const xOffset = vec(c * this.tileWidth, 0);\r\n            gfx.drawLine(pos.add(xOffset), pos.add(vec(xOffset.x, height)), Color.Red, 2);\r\n        }\r\n        const colliders = this._composite.getColliders();\r\n        for (const collider of colliders) {\r\n            const grayish = Color.Gray;\r\n            grayish.a = 0.5;\r\n            const bounds = collider.localBounds;\r\n            const pos = collider.worldPos.sub(this.pos);\r\n            gfx.drawRectangle(pos, bounds.width, bounds.height, grayish);\r\n        }\r\n    }\r\n}\r\n/**\r\n * TileMap Tile\r\n *\r\n * A light-weight object that occupies a space in a collision map. Generally\r\n * created by a [[TileMap]].\r\n *\r\n * Tiles can draw multiple sprites. Note that the order of drawing is the order\r\n * of the sprites in the array so the last one will be drawn on top. You can\r\n * use transparency to create layers this way.\r\n */\r\nclass Tile extends Entity {\r\n    constructor(options) {\r\n        var _a, _b;\r\n        super();\r\n        this._posDirty = false;\r\n        this._solid = false;\r\n        this._graphics = [];\r\n        /**\r\n         * Current list of colliders for this tile\r\n         */\r\n        this._colliders = [];\r\n        /**\r\n         * Arbitrary data storage per tile, useful for any game specific data\r\n         */\r\n        this.data = new Map();\r\n        this.x = options.x;\r\n        this.y = options.y;\r\n        this.map = options.map;\r\n        this.width = options.map.tileWidth;\r\n        this.height = options.map.tileHeight;\r\n        this.solid = (_a = options.solid) !== null && _a !== void 0 ? _a : this.solid;\r\n        this._graphics = (_b = options.graphics) !== null && _b !== void 0 ? _b : [];\r\n        this._recalculate();\r\n    }\r\n    // private _transform: TransformComponent;\r\n    /**\r\n     * Return the world position of the top left corner of the tile\r\n     */\r\n    get pos() {\r\n        if (this._posDirty) {\r\n            this._recalculate();\r\n            this._posDirty = false;\r\n        }\r\n        return this._pos;\r\n    }\r\n    /**\r\n     * Wether this tile should be treated as solid by the tilemap\r\n     */\r\n    get solid() {\r\n        return this._solid;\r\n    }\r\n    /**\r\n     * Wether this tile should be treated as solid by the tilemap\r\n     */\r\n    set solid(val) {\r\n        var _a;\r\n        (_a = this.map) === null || _a === void 0 ? void 0 : _a.flagCollidersDirty();\r\n        this._solid = val;\r\n    }\r\n    /**\r\n     * Current list of graphics for this tile\r\n     */\r\n    getGraphics() {\r\n        return this._graphics;\r\n    }\r\n    /**\r\n     * Add another [[Graphic]] to this TileMap tile\r\n     * @param graphic\r\n     */\r\n    addGraphic(graphic) {\r\n        this._graphics.push(graphic);\r\n    }\r\n    /**\r\n     * Remove an instance of a [[Graphic]] from this tile\r\n     */\r\n    removeGraphic(graphic) {\r\n        removeItemFromArray(graphic, this._graphics);\r\n    }\r\n    /**\r\n     * Clear all graphics from this tile\r\n     */\r\n    clearGraphics() {\r\n        this._graphics.length = 0;\r\n    }\r\n    /**\r\n     * Returns the list of colliders\r\n     */\r\n    getColliders() {\r\n        return this._colliders;\r\n    }\r\n    /**\r\n     * Adds a custom collider to the [[Tile]] to use instead of it's bounds\r\n     *\r\n     * If no collider is set but [[Tile.solid]] is set, the tile bounds are used as a collider.\r\n     *\r\n     * **Note!** the [[Tile.solid]] must be set to true for it to act as a \"fixed\" collider\r\n     * @param collider\r\n     */\r\n    addCollider(collider) {\r\n        this._colliders.push(collider);\r\n        this.map.flagCollidersDirty();\r\n    }\r\n    /**\r\n     * Removes a collider from the [[Tile]]\r\n     * @param collider\r\n     */\r\n    removeCollider(collider) {\r\n        const index = this._colliders.indexOf(collider);\r\n        if (index > -1) {\r\n            this._colliders.splice(index, 1);\r\n        }\r\n        this.map.flagCollidersDirty();\r\n    }\r\n    /**\r\n     * Clears all colliders from the [[Tile]]\r\n     */\r\n    clearColliders() {\r\n        this._colliders.length = 0;\r\n        this.map.flagCollidersDirty();\r\n    }\r\n    flagDirty() {\r\n        return this._posDirty = true;\r\n    }\r\n    _recalculate() {\r\n        this._pos = this.map.pos.add(vec(this.x * this.map.tileWidth, this.y * this.map.tileHeight));\r\n        this._bounds = new BoundingBox(this._pos.x, this._pos.y, this._pos.x + this.width, this._pos.y + this.height);\r\n        this._posDirty = false;\r\n    }\r\n    get bounds() {\r\n        if (this._posDirty) {\r\n            this._recalculate();\r\n        }\r\n        return this._bounds;\r\n    }\r\n    get center() {\r\n        if (this._posDirty) {\r\n            this._recalculate();\r\n        }\r\n        return new Vector(this._pos.x + this.width / 2, this._pos.y + this.height / 2);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Camera.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Container to house convenience strategy methods\r\n * @internal\r\n */\r\nclass StrategyContainer {\r\n    constructor(camera) {\r\n        this.camera = camera;\r\n    }\r\n    /**\r\n     * Creates and adds the [[LockCameraToActorStrategy]] on the current camera.\r\n     * @param actor The actor to lock the camera to\r\n     */\r\n    lockToActor(actor) {\r\n        this.camera.addStrategy(new LockCameraToActorStrategy(actor));\r\n    }\r\n    /**\r\n     * Creates and adds the [[LockCameraToActorAxisStrategy]] on the current camera\r\n     * @param actor The actor to lock the camera to\r\n     * @param axis The axis to follow the actor on\r\n     */\r\n    lockToActorAxis(actor, axis) {\r\n        this.camera.addStrategy(new LockCameraToActorAxisStrategy(actor, axis));\r\n    }\r\n    /**\r\n     * Creates and adds the [[ElasticToActorStrategy]] on the current camera\r\n     * If cameraElasticity < cameraFriction < 1.0, the behavior will be a dampened spring that will slowly end at the target without bouncing\r\n     * If cameraFriction < cameraElasticity < 1.0, the behavior will be an oscillating spring that will over\r\n     * correct and bounce around the target\r\n     *\r\n     * @param actor Target actor to elastically follow\r\n     * @param cameraElasticity [0 - 1.0] The higher the elasticity the more force that will drive the camera towards the target\r\n     * @param cameraFriction [0 - 1.0] The higher the friction the more that the camera will resist motion towards the target\r\n     */\r\n    elasticToActor(actor, cameraElasticity, cameraFriction) {\r\n        this.camera.addStrategy(new ElasticToActorStrategy(actor, cameraElasticity, cameraFriction));\r\n    }\r\n    /**\r\n     * Creates and adds the [[RadiusAroundActorStrategy]] on the current camera\r\n     * @param actor Target actor to follow when it is \"radius\" pixels away\r\n     * @param radius Number of pixels away before the camera will follow\r\n     */\r\n    radiusAroundActor(actor, radius) {\r\n        this.camera.addStrategy(new RadiusAroundActorStrategy(actor, radius));\r\n    }\r\n    /**\r\n     * Creates and adds the [[LimitCameraBoundsStrategy]] on the current camera\r\n     * @param box The bounding box to limit the camera to.\r\n     */\r\n    limitCameraBounds(box) {\r\n        this.camera.addStrategy(new LimitCameraBoundsStrategy(box));\r\n    }\r\n}\r\n/**\r\n * Camera axis enum\r\n */\r\nvar Axis;\r\n(function (Axis) {\r\n    Axis[Axis[\"X\"] = 0] = \"X\";\r\n    Axis[Axis[\"Y\"] = 1] = \"Y\";\r\n})(Axis || (Axis = {}));\r\n/**\r\n * Lock a camera to the exact x/y position of an actor.\r\n */\r\nclass LockCameraToActorStrategy {\r\n    constructor(target) {\r\n        this.target = target;\r\n        this.action = (target, _cam, _eng, _delta) => {\r\n            const center = target.center;\r\n            return center;\r\n        };\r\n    }\r\n}\r\n/**\r\n * Lock a camera to a specific axis around an actor.\r\n */\r\nclass LockCameraToActorAxisStrategy {\r\n    constructor(target, axis) {\r\n        this.target = target;\r\n        this.axis = axis;\r\n        this.action = (target, cam, _eng, _delta) => {\r\n            const center = target.center;\r\n            const currentFocus = cam.getFocus();\r\n            if (this.axis === Axis.X) {\r\n                return new Vector(center.x, currentFocus.y);\r\n            }\r\n            else {\r\n                return new Vector(currentFocus.x, center.y);\r\n            }\r\n        };\r\n    }\r\n}\r\n/**\r\n * Using [Hook's law](https://en.wikipedia.org/wiki/Hooke's_law), elastically move the camera towards the target actor.\r\n */\r\nclass ElasticToActorStrategy {\r\n    /**\r\n     * If cameraElasticity < cameraFriction < 1.0, the behavior will be a dampened spring that will slowly end at the target without bouncing\r\n     * If cameraFriction < cameraElasticity < 1.0, the behavior will be an oscillating spring that will over\r\n     * correct and bounce around the target\r\n     *\r\n     * @param target Target actor to elastically follow\r\n     * @param cameraElasticity [0 - 1.0] The higher the elasticity the more force that will drive the camera towards the target\r\n     * @param cameraFriction [0 - 1.0] The higher the friction the more that the camera will resist motion towards the target\r\n     */\r\n    constructor(target, cameraElasticity, cameraFriction) {\r\n        this.target = target;\r\n        this.cameraElasticity = cameraElasticity;\r\n        this.cameraFriction = cameraFriction;\r\n        this.action = (target, cam, _eng, _delta) => {\r\n            const position = target.center;\r\n            let focus = cam.getFocus();\r\n            let cameraVel = cam.vel.clone();\r\n            // Calculate the stretch vector, using the spring equation\r\n            // F = kX\r\n            // https://en.wikipedia.org/wiki/Hooke's_law\r\n            // Apply to the current camera velocity\r\n            const stretch = position.sub(focus).scale(this.cameraElasticity); // stretch is X\r\n            cameraVel = cameraVel.add(stretch);\r\n            // Calculate the friction (-1 to apply a force in the opposition of motion)\r\n            // Apply to the current camera velocity\r\n            const friction = cameraVel.scale(-1).scale(this.cameraFriction);\r\n            cameraVel = cameraVel.add(friction);\r\n            // Update position by velocity deltas\r\n            focus = focus.add(cameraVel);\r\n            return focus;\r\n        };\r\n    }\r\n}\r\nclass RadiusAroundActorStrategy {\r\n    /**\r\n     *\r\n     * @param target Target actor to follow when it is \"radius\" pixels away\r\n     * @param radius Number of pixels away before the camera will follow\r\n     */\r\n    constructor(target, radius) {\r\n        this.target = target;\r\n        this.radius = radius;\r\n        this.action = (target, cam, _eng, _delta) => {\r\n            const position = target.center;\r\n            const focus = cam.getFocus();\r\n            const direction = position.sub(focus);\r\n            const distance = direction.size;\r\n            if (distance >= this.radius) {\r\n                const offset = distance - this.radius;\r\n                return focus.add(direction.normalize().scale(offset));\r\n            }\r\n            return focus;\r\n        };\r\n    }\r\n}\r\n/**\r\n * Prevent a camera from going beyond the given camera dimensions.\r\n */\r\nclass LimitCameraBoundsStrategy {\r\n    constructor(target) {\r\n        this.target = target;\r\n        /**\r\n         * Useful for limiting the camera to a [[TileMap]]'s dimensions, or a specific area inside the map.\r\n         *\r\n         * Note that this strategy does not perform any movement by itself.\r\n         * It only sets the camera position to within the given bounds when the camera has gone beyond them.\r\n         * Thus, it is a good idea to combine it with other camera strategies and set this strategy as the last one.\r\n         *\r\n         * Make sure that the camera bounds are at least as large as the viewport size.\r\n         *\r\n         * @param target The bounding box to limit the camera to\r\n         */\r\n        this.boundSizeChecked = false; // Check and warn only once\r\n        this.action = (target, cam, _eng, _delta) => {\r\n            const focus = cam.getFocus();\r\n            if (!this.boundSizeChecked) {\r\n                if (target.bottom - target.top < _eng.drawHeight || target.right - target.left < _eng.drawWidth) {\r\n                    Logger.getInstance().warn('Camera bounds should not be smaller than the engine viewport');\r\n                }\r\n                this.boundSizeChecked = true;\r\n            }\r\n            let focusX = focus.x;\r\n            let focusY = focus.y;\r\n            if (focus.x < target.left + _eng.halfDrawWidth) {\r\n                focusX = target.left + _eng.halfDrawWidth;\r\n            }\r\n            else if (focus.x > target.right - _eng.halfDrawWidth) {\r\n                focusX = target.right - _eng.halfDrawWidth;\r\n            }\r\n            if (focus.y < target.top + _eng.halfDrawHeight) {\r\n                focusY = target.top + _eng.halfDrawHeight;\r\n            }\r\n            else if (focus.y > target.bottom - _eng.halfDrawHeight) {\r\n                focusY = target.bottom - _eng.halfDrawHeight;\r\n            }\r\n            return vec(focusX, focusY);\r\n        };\r\n    }\r\n}\r\n/**\r\n * Cameras\r\n *\r\n * [[Camera]] is the base class for all Excalibur cameras. Cameras are used\r\n * to move around your game and set focus. They are used to determine\r\n * what is \"off screen\" and can be used to scale the game.\r\n *\r\n */\r\nclass Camera extends Class {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.transform = AffineMatrix.identity();\r\n        this.inverse = AffineMatrix.identity();\r\n        this._cameraStrategies = [];\r\n        this.strategy = new StrategyContainer(this);\r\n        /**\r\n         * Get or set current zoom of the camera, defaults to 1\r\n         */\r\n        this._z = 1;\r\n        /**\r\n         * Get or set rate of change in zoom, defaults to 0\r\n         */\r\n        this.dz = 0;\r\n        /**\r\n         * Get or set zoom acceleration\r\n         */\r\n        this.az = 0;\r\n        /**\r\n         * Current rotation of the camera\r\n         */\r\n        this.rotation = 0;\r\n        this._angularVelocity = 0;\r\n        /**\r\n         * Get or set the camera's position\r\n         */\r\n        this._posChanged = false;\r\n        this._pos = watchAny(Vector.Zero, () => (this._posChanged = true));\r\n        /**\r\n         * Get or set the camera's velocity\r\n         */\r\n        this.vel = Vector.Zero;\r\n        /**\r\n         * Get or set the camera's acceleration\r\n         */\r\n        this.acc = Vector.Zero;\r\n        this._cameraMoving = false;\r\n        this._currentLerpTime = 0;\r\n        this._lerpDuration = 1000; // 1 second\r\n        this._lerpStart = null;\r\n        this._lerpEnd = null;\r\n        //camera effects\r\n        this._isShaking = false;\r\n        this._shakeMagnitudeX = 0;\r\n        this._shakeMagnitudeY = 0;\r\n        this._shakeDuration = 0;\r\n        this._elapsedShakeTime = 0;\r\n        this._xShake = 0;\r\n        this._yShake = 0;\r\n        this._isZooming = false;\r\n        this._zoomStart = 1;\r\n        this._zoomEnd = 1;\r\n        this._currentZoomTime = 0;\r\n        this._zoomDuration = 0;\r\n        this._zoomEasing = EasingFunctions.EaseInOutCubic;\r\n        this._easing = EasingFunctions.EaseInOutCubic;\r\n        this._halfWidth = 0;\r\n        this._halfHeight = 0;\r\n        this._viewport = null;\r\n        this._isInitialized = false;\r\n    }\r\n    get zoom() {\r\n        return this._z;\r\n    }\r\n    set zoom(val) {\r\n        this._z = val;\r\n        if (this._engine) {\r\n            this._halfWidth = this._engine.halfDrawWidth;\r\n            this._halfHeight = this._engine.halfDrawHeight;\r\n        }\r\n    }\r\n    /**\r\n     * Get or set the camera's angular velocity\r\n     */\r\n    get angularVelocity() {\r\n        return this._angularVelocity;\r\n    }\r\n    set angularVelocity(value) {\r\n        this._angularVelocity = value;\r\n    }\r\n    get pos() {\r\n        return this._pos;\r\n    }\r\n    set pos(vec) {\r\n        this._pos = watchAny(vec, () => (this._posChanged = true));\r\n        this._posChanged = true;\r\n    }\r\n    /**\r\n     * Get the camera's x position\r\n     */\r\n    get x() {\r\n        return this.pos.x;\r\n    }\r\n    /**\r\n     * Set the camera's x position (cannot be set when following an [[Actor]] or when moving)\r\n     */\r\n    set x(value) {\r\n        if (!this._follow && !this._cameraMoving) {\r\n            this.pos = vec(value, this.pos.y);\r\n        }\r\n    }\r\n    /**\r\n     * Get the camera's y position\r\n     */\r\n    get y() {\r\n        return this.pos.y;\r\n    }\r\n    /**\r\n     * Set the camera's y position (cannot be set when following an [[Actor]] or when moving)\r\n     */\r\n    set y(value) {\r\n        if (!this._follow && !this._cameraMoving) {\r\n            this.pos = vec(this.pos.x, value);\r\n        }\r\n    }\r\n    /**\r\n     * Get or set the camera's x velocity\r\n     */\r\n    get dx() {\r\n        return this.vel.x;\r\n    }\r\n    set dx(value) {\r\n        this.vel = vec(value, this.vel.y);\r\n    }\r\n    /**\r\n     * Get or set the camera's y velocity\r\n     */\r\n    get dy() {\r\n        return this.vel.y;\r\n    }\r\n    set dy(value) {\r\n        this.vel = vec(this.vel.x, value);\r\n    }\r\n    /**\r\n     * Get or set the camera's x acceleration\r\n     */\r\n    get ax() {\r\n        return this.acc.x;\r\n    }\r\n    set ax(value) {\r\n        this.acc = vec(value, this.acc.y);\r\n    }\r\n    /**\r\n     * Get or set the camera's y acceleration\r\n     */\r\n    get ay() {\r\n        return this.acc.y;\r\n    }\r\n    set ay(value) {\r\n        this.acc = vec(this.acc.x, value);\r\n    }\r\n    /**\r\n     * Returns the focal point of the camera, a new point giving the x and y position of the camera\r\n     */\r\n    getFocus() {\r\n        return this.pos;\r\n    }\r\n    /**\r\n     * This moves the camera focal point to the specified position using specified easing function. Cannot move when following an Actor.\r\n     *\r\n     * @param pos The target position to move to\r\n     * @param duration The duration in milliseconds the move should last\r\n     * @param [easingFn] An optional easing function ([[ex.EasingFunctions.EaseInOutCubic]] by default)\r\n     * @returns A [[Promise]] that resolves when movement is finished, including if it's interrupted.\r\n     *          The [[Promise]] value is the [[Vector]] of the target position. It will be rejected if a move cannot be made.\r\n     */\r\n    move(pos, duration, easingFn = EasingFunctions.EaseInOutCubic) {\r\n        if (typeof easingFn !== 'function') {\r\n            throw 'Please specify an EasingFunction';\r\n        }\r\n        // cannot move when following an actor\r\n        if (this._follow) {\r\n            return Promise.reject(pos);\r\n        }\r\n        // resolve existing promise, if any\r\n        if (this._lerpPromise && this._lerpResolve) {\r\n            this._lerpResolve(pos);\r\n        }\r\n        this._lerpPromise = new Promise((resolve) => {\r\n            this._lerpResolve = resolve;\r\n        });\r\n        this._lerpStart = this.getFocus().clone();\r\n        this._lerpDuration = duration;\r\n        this._lerpEnd = pos;\r\n        this._currentLerpTime = 0;\r\n        this._cameraMoving = true;\r\n        this._easing = easingFn;\r\n        return this._lerpPromise;\r\n    }\r\n    /**\r\n     * Sets the camera to shake at the specified magnitudes for the specified duration\r\n     * @param magnitudeX  The x magnitude of the shake\r\n     * @param magnitudeY  The y magnitude of the shake\r\n     * @param duration    The duration of the shake in milliseconds\r\n     */\r\n    shake(magnitudeX, magnitudeY, duration) {\r\n        this._isShaking = true;\r\n        this._shakeMagnitudeX = magnitudeX;\r\n        this._shakeMagnitudeY = magnitudeY;\r\n        this._shakeDuration = duration;\r\n    }\r\n    /**\r\n     * Zooms the camera in or out by the specified scale over the specified duration.\r\n     * If no duration is specified, it take effect immediately.\r\n     * @param scale    The scale of the zoom\r\n     * @param duration The duration of the zoom in milliseconds\r\n     */\r\n    zoomOverTime(scale, duration = 0, easingFn = EasingFunctions.EaseInOutCubic) {\r\n        this._zoomPromise = new Promise((resolve) => {\r\n            this._zoomResolve = resolve;\r\n        });\r\n        if (duration) {\r\n            this._isZooming = true;\r\n            this._zoomEasing = easingFn;\r\n            this._currentZoomTime = 0;\r\n            this._zoomDuration = duration;\r\n            this._zoomStart = this.zoom;\r\n            this._zoomEnd = scale;\r\n        }\r\n        else {\r\n            this._isZooming = false;\r\n            this.zoom = scale;\r\n            return Promise.resolve(true);\r\n        }\r\n        return this._zoomPromise;\r\n    }\r\n    /**\r\n     * Gets the bounding box of the viewport of this camera in world coordinates\r\n     */\r\n    get viewport() {\r\n        if (this._viewport) {\r\n            return this._viewport;\r\n        }\r\n        return new BoundingBox(0, 0, 0, 0);\r\n    }\r\n    /**\r\n     * Adds a new camera strategy to this camera\r\n     * @param cameraStrategy Instance of an [[CameraStrategy]]\r\n     */\r\n    addStrategy(cameraStrategy) {\r\n        this._cameraStrategies.push(cameraStrategy);\r\n    }\r\n    /**\r\n     * Removes a camera strategy by reference\r\n     * @param cameraStrategy Instance of an [[CameraStrategy]]\r\n     */\r\n    removeStrategy(cameraStrategy) {\r\n        removeItemFromArray(cameraStrategy, this._cameraStrategies);\r\n    }\r\n    /**\r\n     * Clears all camera strategies from the camera\r\n     */\r\n    clearAllStrategies() {\r\n        this._cameraStrategies.length = 0;\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPreUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _preupdate(engine, delta) {\r\n        this.emit('preupdate', new PreUpdateEvent(engine, delta, this));\r\n        this.onPreUpdate(engine, delta);\r\n    }\r\n    /**\r\n     * Safe to override onPreUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPreUpdate` is called directly before a scene is updated.\r\n     */\r\n    onPreUpdate(_engine, _delta) {\r\n        // Overridable\r\n    }\r\n    /**\r\n     *  It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPostUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _postupdate(engine, delta) {\r\n        this.emit('postupdate', new PostUpdateEvent(engine, delta, this));\r\n        this.onPostUpdate(engine, delta);\r\n    }\r\n    /**\r\n     * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPostUpdate` is called directly after a scene is updated.\r\n     */\r\n    onPostUpdate(_engine, _delta) {\r\n        // Overridable\r\n    }\r\n    get isInitialized() {\r\n        return this._isInitialized;\r\n    }\r\n    _initialize(_engine) {\r\n        if (!this.isInitialized) {\r\n            this._engine = _engine;\r\n            this._screen = _engine.screen;\r\n            const currentRes = this._screen.resolution;\r\n            let center = vec(currentRes.width / 2, currentRes.height / 2);\r\n            if (!this._engine.loadingComplete) {\r\n                // If there was a loading screen, we peek the configured resolution\r\n                const res = this._screen.peekResolution();\r\n                if (res) {\r\n                    center = vec(res.width / 2, res.height / 2);\r\n                }\r\n            }\r\n            this._halfWidth = center.x;\r\n            this._halfHeight = center.y;\r\n            // If the user has not set the camera pos, apply default center screen position\r\n            if (!this._posChanged) {\r\n                this.pos = center;\r\n            }\r\n            // First frame bootstrap\r\n            // Ensure camera tx is correct\r\n            // Run update twice to ensure properties are init'd\r\n            this.updateTransform();\r\n            // Run strategies for first frame\r\n            this.runStrategies(_engine, _engine.clock.elapsed());\r\n            // Setup the first frame viewport\r\n            this.updateViewport();\r\n            // It's important to update the camera after strategies\r\n            // This prevents jitter\r\n            this.updateTransform();\r\n            this.onInitialize(_engine);\r\n            super.emit('initialize', new InitializeEvent(_engine, this));\r\n            this._isInitialized = true;\r\n        }\r\n    }\r\n    /**\r\n     * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPostUpdate` is called directly after a scene is updated.\r\n     */\r\n    onInitialize(_engine) {\r\n        // Overridable\r\n    }\r\n    on(eventName, handler) {\r\n        super.on(eventName, handler);\r\n    }\r\n    off(eventName, handler) {\r\n        super.off(eventName, handler);\r\n    }\r\n    once(eventName, handler) {\r\n        super.once(eventName, handler);\r\n    }\r\n    runStrategies(engine, delta) {\r\n        for (const s of this._cameraStrategies) {\r\n            this.pos = s.action.call(s, s.target, this, engine, delta);\r\n        }\r\n    }\r\n    updateViewport() {\r\n        // recalc viewport\r\n        this._viewport = new BoundingBox(this.x - this._halfWidth, this.y - this._halfHeight, this.x + this._halfWidth, this.y + this._halfHeight);\r\n    }\r\n    update(_engine, delta) {\r\n        this._initialize(_engine);\r\n        this._preupdate(_engine, delta);\r\n        // Update placements based on linear algebra\r\n        this.pos = this.pos.add(this.vel.scale(delta / 1000));\r\n        this.zoom += (this.dz * delta) / 1000;\r\n        this.vel = this.vel.add(this.acc.scale(delta / 1000));\r\n        this.dz += (this.az * delta) / 1000;\r\n        this.rotation += (this.angularVelocity * delta) / 1000;\r\n        if (this._isZooming) {\r\n            if (this._currentZoomTime < this._zoomDuration) {\r\n                const zoomEasing = this._zoomEasing;\r\n                const newZoom = zoomEasing(this._currentZoomTime, this._zoomStart, this._zoomEnd, this._zoomDuration);\r\n                this.zoom = newZoom;\r\n                this._currentZoomTime += delta;\r\n            }\r\n            else {\r\n                this._isZooming = false;\r\n                this.zoom = this._zoomEnd;\r\n                this._currentZoomTime = 0;\r\n                this._zoomResolve(true);\r\n            }\r\n        }\r\n        if (this._cameraMoving) {\r\n            if (this._currentLerpTime < this._lerpDuration) {\r\n                const moveEasing = EasingFunctions.CreateVectorEasingFunction(this._easing);\r\n                const lerpPoint = moveEasing(this._currentLerpTime, this._lerpStart, this._lerpEnd, this._lerpDuration);\r\n                this.pos = lerpPoint;\r\n                this._currentLerpTime += delta;\r\n            }\r\n            else {\r\n                this.pos = this._lerpEnd;\r\n                const end = this._lerpEnd.clone();\r\n                this._lerpStart = null;\r\n                this._lerpEnd = null;\r\n                this._currentLerpTime = 0;\r\n                this._cameraMoving = false;\r\n                // Order matters here, resolve should be last so any chain promises have a clean slate\r\n                this._lerpResolve(end);\r\n            }\r\n        }\r\n        if (this._isDoneShaking()) {\r\n            this._isShaking = false;\r\n            this._elapsedShakeTime = 0;\r\n            this._shakeMagnitudeX = 0;\r\n            this._shakeMagnitudeY = 0;\r\n            this._shakeDuration = 0;\r\n            this._xShake = 0;\r\n            this._yShake = 0;\r\n        }\r\n        else {\r\n            this._elapsedShakeTime += delta;\r\n            this._xShake = ((Math.random() * this._shakeMagnitudeX) | 0) + 1;\r\n            this._yShake = ((Math.random() * this._shakeMagnitudeY) | 0) + 1;\r\n        }\r\n        this.runStrategies(_engine, delta);\r\n        this.updateViewport();\r\n        // It's important to update the camera after strategies\r\n        // This prevents jitter\r\n        this.updateTransform();\r\n        this._postupdate(_engine, delta);\r\n    }\r\n    /**\r\n     * Applies the relevant transformations to the game canvas to \"move\" or apply effects to the Camera\r\n     * @param ctx Canvas context to apply transformations\r\n     */\r\n    draw(ctx) {\r\n        ctx.multiply(this.transform);\r\n    }\r\n    updateTransform() {\r\n        // center the camera\r\n        const newCanvasWidth = this._screen.resolution.width / this.zoom;\r\n        const newCanvasHeight = this._screen.resolution.height / this.zoom;\r\n        const cameraPos = vec(-this.x + newCanvasWidth / 2 + this._xShake, -this.y + newCanvasHeight / 2 + this._yShake);\r\n        // Calculate camera transform\r\n        this.transform.reset();\r\n        this.transform.scale(this.zoom, this.zoom);\r\n        this.transform.translate(cameraPos.x, cameraPos.y);\r\n        this.transform.inverse(this.inverse);\r\n    }\r\n    _isDoneShaking() {\r\n        return !this._isShaking || this._elapsedShakeTime >= this._shakeDuration;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Trigger.ts\n\r\n\r\n\r\n\r\n\r\nconst triggerDefaults = {\r\n    pos: Vector.Zero,\r\n    width: 10,\r\n    height: 10,\r\n    visible: false,\r\n    action: () => {\r\n        return;\r\n    },\r\n    filter: () => true,\r\n    repeat: -1\r\n};\r\n/**\r\n * Triggers are a method of firing arbitrary code on collision. These are useful\r\n * as 'buttons', 'switches', or to trigger effects in a game. By default triggers\r\n * are invisible, and can only be seen when [[Trigger.visible]] is set to `true`.\r\n */\r\nclass Trigger extends Actor {\r\n    /**\r\n     *\r\n     * @param opts Trigger options\r\n     */\r\n    constructor(opts) {\r\n        super({ x: opts.pos.x, y: opts.pos.y, width: opts.width, height: opts.height });\r\n        /**\r\n         * Action to fire when triggered by collision\r\n         */\r\n        this.action = () => {\r\n            return;\r\n        };\r\n        /**\r\n         * Filter to add additional granularity to action dispatch, if a filter is specified the action will only fire when\r\n         * filter return true for the collided actor.\r\n         */\r\n        this.filter = () => true;\r\n        /**\r\n         * Number of times to repeat before killing the trigger,\r\n         */\r\n        this.repeat = -1;\r\n        opts = {\r\n            ...triggerDefaults,\r\n            ...opts\r\n        };\r\n        this.filter = opts.filter || this.filter;\r\n        this.repeat = opts.repeat || this.repeat;\r\n        this.action = opts.action || this.action;\r\n        if (opts.target) {\r\n            this.target = opts.target;\r\n        }\r\n        this.graphics.visible = opts.visible;\r\n        this.body.collisionType = CollisionType.Passive;\r\n        this.eventDispatcher = new EventDispatcher();\r\n        this.events.on('collisionstart', (evt) => {\r\n            if (this.filter(evt.other)) {\r\n                this.emit('enter', new EnterTriggerEvent(this, evt.other));\r\n                this._dispatchAction();\r\n                // remove trigger if its done, -1 repeat forever\r\n                if (this.repeat === 0) {\r\n                    this.kill();\r\n                }\r\n            }\r\n        });\r\n        this.events.on('collisionend', (evt) => {\r\n            if (this.filter(evt.other)) {\r\n                this.emit('exit', new ExitTriggerEvent(this, evt.other));\r\n            }\r\n        });\r\n    }\r\n    set target(target) {\r\n        this._target = target;\r\n        this.filter = (actor) => actor === target;\r\n    }\r\n    get target() {\r\n        return this._target;\r\n    }\r\n    _initialize(engine) {\r\n        super._initialize(engine);\r\n    }\r\n    _dispatchAction() {\r\n        if (this.repeat !== 0) {\r\n            this.action.call(this);\r\n            this.repeat--;\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/System.ts\n/**\r\n * Enum that determines whether to run the system in the update or draw phase\r\n */\r\nvar SystemType;\r\n(function (SystemType) {\r\n    SystemType[\"Update\"] = \"update\";\r\n    SystemType[\"Draw\"] = \"draw\";\r\n})(SystemType || (SystemType = {}));\r\n/**\r\n * An Excalibur [[System]] that updates entities of certain types.\r\n * Systems are scene specific\r\n *\r\n * Excalibur Systems currently require at least 1 Component type to operated\r\n *\r\n * Multiple types are declared as a type union\r\n * For example:\r\n *\r\n * ```typescript\r\n * class MySystem extends System<ComponentA | ComponentB> {\r\n *   public readonly types = ['a', 'b'] as const;\r\n *   public readonly systemType = SystemType.Update;\r\n *   public update(entities: Entity<ComponentA | ComponentB>) {\r\n *      ...\r\n *   }\r\n * }\r\n * ```\r\n */\r\nclass System {\r\n    constructor() {\r\n        /**\r\n         * System can execute in priority order, by default all systems are priority 0. Lower values indicated higher priority.\r\n         * For a system to execute before all other a lower priority value (-1 for example) must be set.\r\n         * For a system to execute after all other a higher priority value (10 for example) must be set.\r\n         */\r\n        this.priority = 0;\r\n    }\r\n    /**\r\n     * Systems observe when entities match their types or no longer match their types, override\r\n     * @param _entityAddedOrRemoved\r\n     */\r\n    notify(_entityAddedOrRemoved) {\r\n        // Override me\r\n    }\r\n}\r\n/**\r\n * An [[Entity]] with [[Component]] types that matches a [[System]] types exists in the current scene.\r\n */\r\nclass AddedEntity {\r\n    constructor(data) {\r\n        this.data = data;\r\n        this.type = 'Entity Added';\r\n    }\r\n}\r\n/**\r\n * Type guard to check for AddedEntity messages\r\n * @param x\r\n */\r\nfunction isAddedSystemEntity(x) {\r\n    return !!x && x.type === 'Entity Added';\r\n}\r\n/**\r\n * An [[Entity]] with [[Component]] types that no longer matches a [[System]] types exists in the current scene.\r\n */\r\nclass RemovedEntity {\r\n    constructor(data) {\r\n        this.data = data;\r\n        this.type = 'Entity Removed';\r\n    }\r\n}\r\n/**\r\n * type guard to check for the RemovedEntity message\r\n */\r\nfunction isRemoveSystemEntity(x) {\r\n    return !!x && x.type === 'Entity Removed';\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/EntityManager.ts\n\r\n\r\n// Add/Remove entities and components\r\nclass EntityManager {\r\n    constructor(_world) {\r\n        this._world = _world;\r\n        this.entities = [];\r\n        this._entityIndex = {};\r\n        this._entitiesToRemove = [];\r\n    }\r\n    /**\r\n     * Runs the entity lifecycle\r\n     * @param _context\r\n     */\r\n    updateEntities(_context, elapsed) {\r\n        for (const entity of this.entities) {\r\n            // TODO is this right?\r\n            entity.update(_context.engine, elapsed);\r\n            if (!entity.active) {\r\n                this.removeEntity(entity);\r\n            }\r\n        }\r\n    }\r\n    findEntitiesForRemoval() {\r\n        for (const entity of this.entities) {\r\n            if (!entity.active) {\r\n                this.removeEntity(entity);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * EntityManager observes changes on entities\r\n     * @param message\r\n     */\r\n    notify(message) {\r\n        if (isAddedComponent(message)) {\r\n            // we don't need the component, it's already on the entity\r\n            this._world.queryManager.addEntity(message.data.entity);\r\n        }\r\n        if (isRemovedComponent(message)) {\r\n            this._world.queryManager.removeComponent(message.data.entity, message.data.component);\r\n        }\r\n    }\r\n    /**\r\n     * Adds an entity to be tracked by the EntityManager\r\n     * @param entity\r\n     */\r\n    addEntity(entity) {\r\n        entity.active = true;\r\n        if (entity && !this._entityIndex[entity.id]) {\r\n            this._entityIndex[entity.id] = entity;\r\n            this.entities.push(entity);\r\n            this._world.queryManager.addEntity(entity);\r\n            entity.componentAdded$.register(this);\r\n            entity.componentRemoved$.register(this);\r\n            // if entity has children\r\n            entity.children.forEach((c) => this.addEntity(c));\r\n            entity.childrenAdded$.register({\r\n                notify: (e) => {\r\n                    this.addEntity(e);\r\n                }\r\n            });\r\n            entity.childrenRemoved$.register({\r\n                notify: (e) => {\r\n                    this.removeEntity(e, false);\r\n                }\r\n            });\r\n        }\r\n    }\r\n    removeEntity(idOrEntity, deferred = true) {\r\n        var _a;\r\n        let id = 0;\r\n        if (idOrEntity instanceof Entity) {\r\n            id = idOrEntity.id;\r\n        }\r\n        else {\r\n            id = idOrEntity;\r\n        }\r\n        const entity = this._entityIndex[id];\r\n        if (entity && entity.active) {\r\n            entity.kill();\r\n        }\r\n        if (entity && deferred) {\r\n            this._entitiesToRemove.push(entity);\r\n            return;\r\n        }\r\n        delete this._entityIndex[id];\r\n        if (entity) {\r\n            removeItemFromArray(entity, this.entities);\r\n            this._world.queryManager.removeEntity(entity);\r\n            entity.componentAdded$.unregister(this);\r\n            entity.componentRemoved$.unregister(this);\r\n            // if entity has children\r\n            entity.children.forEach((c) => this.removeEntity(c, deferred));\r\n            entity.childrenAdded$.clear();\r\n            entity.childrenRemoved$.clear();\r\n            // stats\r\n            if ((_a = this._world.context) === null || _a === void 0 ? void 0 : _a.engine) {\r\n                this._world.context.engine.stats.currFrame.actors.killed++;\r\n            }\r\n        }\r\n    }\r\n    processEntityRemovals() {\r\n        for (const entity of this._entitiesToRemove) {\r\n            if (entity.active) {\r\n                continue;\r\n            }\r\n            this.removeEntity(entity, false);\r\n        }\r\n    }\r\n    processComponentRemovals() {\r\n        for (const entity of this.entities) {\r\n            entity.processComponentRemoval();\r\n        }\r\n    }\r\n    getById(id) {\r\n        return this._entityIndex[id];\r\n    }\r\n    getByName(name) {\r\n        return this.entities.filter(e => e.name === name);\r\n    }\r\n    clear() {\r\n        for (const entity of this.entities) {\r\n            this.removeEntity(entity);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/Util.ts\nconst buildTypeKey = (types) => {\r\n    const key = [...types].sort((a, b) => a.localeCompare(b)).join('+');\r\n    return key;\r\n};\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/Query.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Represents query for entities that match a list of types that is cached and observable\r\n *\r\n * Queries can be strongly typed by supplying a type union in the optional type parameter\r\n * ```typescript\r\n * const queryAB = new ex.Query<ComponentTypeA | ComponentTypeB>(['A', 'B']);\r\n * ```\r\n */\r\nclass Query extends Observable {\r\n    constructor(types) {\r\n        super();\r\n        this._entities = [];\r\n        if (types[0] instanceof Function) {\r\n            this.types = types.map(T => (new T).type);\r\n        }\r\n        else {\r\n            this.types = types;\r\n        }\r\n    }\r\n    get key() {\r\n        if (this._key) {\r\n            return this._key;\r\n        }\r\n        return (this._key = buildTypeKey(this.types));\r\n    }\r\n    /**\r\n     * Returns a list of entities that match the query\r\n     *\r\n     * @param sort Optional sorting function to sort entities returned from the query\r\n     */\r\n    getEntities(sort) {\r\n        if (sort) {\r\n            this._entities.sort(sort);\r\n        }\r\n        return this._entities;\r\n    }\r\n    /**\r\n     * Add an entity to the query, will only be added if the entity matches the query types\r\n     * @param entity\r\n     */\r\n    addEntity(entity) {\r\n        if (!contains(this._entities, entity) && this.matches(entity)) {\r\n            this._entities.push(entity);\r\n            this.notifyAll(new AddedEntity(entity));\r\n        }\r\n    }\r\n    /**\r\n     * If the entity is part of the query it will be removed regardless of types\r\n     * @param entity\r\n     */\r\n    removeEntity(entity) {\r\n        if (removeItemFromArray(entity, this._entities)) {\r\n            this.notifyAll(new RemovedEntity(entity));\r\n        }\r\n    }\r\n    /**\r\n     * Removes all entities and observers from the query\r\n     */\r\n    clear() {\r\n        this._entities.length = 0;\r\n        for (const observer of this.observers) {\r\n            this.unregister(observer);\r\n        }\r\n    }\r\n    matches(typesOrEntity) {\r\n        let types = [];\r\n        if (typesOrEntity instanceof Entity) {\r\n            types = typesOrEntity.types;\r\n        }\r\n        else {\r\n            types = typesOrEntity;\r\n        }\r\n        let matches = true;\r\n        for (const type of this.types) {\r\n            matches = matches && types.indexOf(type) > -1;\r\n            if (!matches) {\r\n                return false;\r\n            }\r\n        }\r\n        return matches;\r\n    }\r\n    contain(type) {\r\n        return this.types.indexOf(type) > -1;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/QueryManager.ts\n\r\n\r\n/**\r\n * The query manager is responsible for updating all queries when entities/components change\r\n */\r\nclass QueryManager {\r\n    constructor(_world) {\r\n        this._world = _world;\r\n        this._queries = {};\r\n    }\r\n    /**\r\n     * Adds a query to the manager and populates with any entities that match\r\n     * @param query\r\n     */\r\n    _addQuery(query) {\r\n        this._queries[buildTypeKey(query.types)] = query;\r\n        for (const entity of this._world.entityManager.entities) {\r\n            query.addEntity(entity);\r\n        }\r\n    }\r\n    /**\r\n     * Removes the query if there are no observers left\r\n     * @param query\r\n     */\r\n    maybeRemoveQuery(query) {\r\n        if (query.observers.length === 0) {\r\n            query.clear();\r\n            delete this._queries[buildTypeKey(query.types)];\r\n        }\r\n    }\r\n    /**\r\n     * Adds the entity to any matching query in the query manage\r\n     * @param entity\r\n     */\r\n    addEntity(entity) {\r\n        for (const queryType in this._queries) {\r\n            if (this._queries[queryType]) {\r\n                this._queries[queryType].addEntity(entity);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Removes an entity from queries if the removed component disqualifies it\r\n     * @param entity\r\n     * @param component\r\n     */\r\n    removeComponent(entity, component) {\r\n        for (const queryType in this._queries) {\r\n            // If the component being removed from an entity is a part of a query,\r\n            // it is now disqualified from that query, remove it\r\n            if (this._queries[queryType].contain(component.type)) {\r\n                this._queries[queryType].removeEntity(entity);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Removes an entity from all queries it is currently a part of\r\n     * @param entity\r\n     */\r\n    removeEntity(entity) {\r\n        for (const queryType in this._queries) {\r\n            this._queries[queryType].removeEntity(entity);\r\n        }\r\n    }\r\n    /**\r\n     * Creates a populated query and returns, if the query already exists that will be returned instead of a new instance\r\n     * @param types\r\n     */\r\n    createQuery(types) {\r\n        const maybeExistingQuery = this.getQuery(types);\r\n        if (maybeExistingQuery) {\r\n            return maybeExistingQuery;\r\n        }\r\n        const query = new Query(types);\r\n        this._addQuery(query);\r\n        return query;\r\n    }\r\n    /**\r\n     * Retrieves an existing query by types if it exists otherwise returns null\r\n     * @param types\r\n     */\r\n    getQuery(types) {\r\n        const key = buildTypeKey(types);\r\n        if (this._queries[key]) {\r\n            return this._queries[key];\r\n        }\r\n        return null;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/SystemManager.ts\n\r\n/**\r\n * The SystemManager is responsible for keeping track of all systems in a scene.\r\n * Systems are scene specific\r\n */\r\nclass SystemManager {\r\n    constructor(_world) {\r\n        this._world = _world;\r\n        /**\r\n         * List of systems, to add a new system call [[SystemManager.addSystem]]\r\n         */\r\n        this.systems = [];\r\n        this.initialized = false;\r\n    }\r\n    /**\r\n     * Get a system registered in the manager by type\r\n     * @param systemType\r\n     */\r\n    get(systemType) {\r\n        return this.systems.find((s) => s instanceof systemType);\r\n    }\r\n    /**\r\n     * Adds a system to the manager, it will now be updated every frame\r\n     * @param system\r\n     */\r\n    addSystem(system) {\r\n        // validate system has types\r\n        if (!system.types || system.types.length === 0) {\r\n            throw new Error(`Attempted to add a System without any types`);\r\n        }\r\n        const query = this._world.queryManager.createQuery(system.types);\r\n        this.systems.push(system);\r\n        this.systems.sort((a, b) => a.priority - b.priority);\r\n        query.register(system);\r\n        if (this.initialized && system.initialize) {\r\n            system.initialize(this._world.context);\r\n        }\r\n    }\r\n    /**\r\n     * Removes a system from the manager, it will no longer be updated\r\n     * @param system\r\n     */\r\n    removeSystem(system) {\r\n        removeItemFromArray(system, this.systems);\r\n        const query = this._world.queryManager.getQuery(system.types);\r\n        if (query) {\r\n            query.unregister(system);\r\n            this._world.queryManager.maybeRemoveQuery(query);\r\n        }\r\n    }\r\n    /**\r\n     * Initialize all systems in the manager\r\n     *\r\n     * Systems added after initialize() will be initialized on add\r\n     */\r\n    initialize() {\r\n        if (!this.initialized) {\r\n            this.initialized = true;\r\n            for (const s of this.systems) {\r\n                if (s.initialize) {\r\n                    s.initialize(this._world.context);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Updates all systems\r\n     * @param type whether this is an update or draw system\r\n     * @param context context reference\r\n     * @param delta time in milliseconds\r\n     */\r\n    updateSystems(type, context, delta) {\r\n        const systems = this.systems.filter((s) => s.systemType === type);\r\n        for (const s of systems) {\r\n            if (s.preupdate) {\r\n                s.preupdate(context, delta);\r\n            }\r\n        }\r\n        for (const s of systems) {\r\n            // Get entities that match the system types, pre-sort\r\n            const entities = this._world.queryManager.getQuery(s.types).getEntities(s.sort);\r\n            // Initialize entities if needed\r\n            if (context instanceof Scene) {\r\n                for (const entity of entities) {\r\n                    entity._initialize(context === null || context === void 0 ? void 0 : context.engine);\r\n                }\r\n            }\r\n            s.update(entities, delta);\r\n        }\r\n        for (const s of systems) {\r\n            if (s.postupdate) {\r\n                s.postupdate(context, delta);\r\n            }\r\n        }\r\n    }\r\n    clear() {\r\n        for (const system of this.systems) {\r\n            this.removeSystem(system);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/World.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * The World is a self-contained entity component system for a particular context.\r\n */\r\nclass World {\r\n    /**\r\n     * The context type is passed to the system updates\r\n     * @param context\r\n     */\r\n    constructor(context) {\r\n        this.context = context;\r\n        this.queryManager = new QueryManager(this);\r\n        this.entityManager = new EntityManager(this);\r\n        this.systemManager = new SystemManager(this);\r\n    }\r\n    /**\r\n     * Update systems by type and time elapsed in milliseconds\r\n     */\r\n    update(type, delta) {\r\n        if (type === SystemType.Update) {\r\n            this.entityManager.updateEntities(this.context, delta);\r\n        }\r\n        this.systemManager.updateSystems(type, this.context, delta);\r\n        this.entityManager.findEntitiesForRemoval();\r\n        this.entityManager.processComponentRemovals();\r\n        this.entityManager.processEntityRemovals();\r\n    }\r\n    add(entityOrSystem) {\r\n        if (entityOrSystem instanceof Entity) {\r\n            this.entityManager.addEntity(entityOrSystem);\r\n        }\r\n        if (entityOrSystem instanceof System) {\r\n            this.systemManager.addSystem(entityOrSystem);\r\n        }\r\n    }\r\n    remove(entityOrSystem, deferred = true) {\r\n        if (entityOrSystem instanceof Entity) {\r\n            this.entityManager.removeEntity(entityOrSystem, deferred);\r\n        }\r\n        if (entityOrSystem instanceof System) {\r\n            this.systemManager.removeSystem(entityOrSystem);\r\n        }\r\n    }\r\n    clearEntities() {\r\n        this.entityManager.clear();\r\n    }\r\n    clearSystems() {\r\n        this.systemManager.clear();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Integrator.ts\n\r\nclass EulerIntegrator {\r\n    static integrate(transform, motion, totalAcc, elapsedMs) {\r\n        const seconds = elapsedMs / 1000;\r\n        // This code looks a little wild, but it's to avoid creating any new Vector instances\r\n        // integration is done in a tight loop so this is key to avoid GC'ing\r\n        motion.vel.addEqual(totalAcc.scale(seconds, EulerIntegrator._ACC));\r\n        transform.pos\r\n            .add(motion.vel.scale(seconds, EulerIntegrator._VEL), EulerIntegrator._POS)\r\n            .addEqual(totalAcc.scale(0.5 * seconds * seconds, EulerIntegrator._VEL_ACC));\r\n        motion.angularVelocity += motion.torque * (1.0 / motion.inertia) * seconds;\r\n        const rotation = transform.rotation + motion.angularVelocity * seconds;\r\n        transform.scale.add(motion.scaleFactor.scale(seconds, this._SCALE_FACTOR), EulerIntegrator._SCALE);\r\n        const tx = transform.get();\r\n        tx.setTransform(EulerIntegrator._POS, rotation, EulerIntegrator._SCALE);\r\n    }\r\n}\r\n// Scratch vectors to avoid allocation\r\nEulerIntegrator._POS = new Vector(0, 0);\r\nEulerIntegrator._SCALE = new Vector(1, 1);\r\nEulerIntegrator._ACC = new Vector(0, 0);\r\nEulerIntegrator._VEL = new Vector(0, 0);\r\nEulerIntegrator._VEL_ACC = new Vector(0, 0);\r\nEulerIntegrator._SCALE_FACTOR = new Vector(0, 0);\r\n\n;// CONCATENATED MODULE: ./Collision/MotionSystem.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass MotionSystem extends System {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.types = ['ex.transform', 'ex.motion'];\r\n        this.systemType = SystemType.Update;\r\n        this.priority = -1;\r\n    }\r\n    update(entities, elapsedMs) {\r\n        let transform;\r\n        let motion;\r\n        for (let i = 0; i < entities.length; i++) {\r\n            transform = entities[i].get(TransformComponent);\r\n            motion = entities[i].get(MotionComponent);\r\n            const optionalBody = entities[i].get(BodyComponent);\r\n            if (optionalBody === null || optionalBody === void 0 ? void 0 : optionalBody.sleeping) {\r\n                continue;\r\n            }\r\n            const totalAcc = motion.acc.clone();\r\n            if ((optionalBody === null || optionalBody === void 0 ? void 0 : optionalBody.collisionType) === CollisionType.Active && (optionalBody === null || optionalBody === void 0 ? void 0 : optionalBody.useGravity)) {\r\n                totalAcc.addEqual(Physics.gravity);\r\n            }\r\n            optionalBody === null || optionalBody === void 0 ? void 0 : optionalBody.captureOldTransform();\r\n            // Update transform and motion based on Euler linear algebra\r\n            EulerIntegrator.integrate(transform, motion, totalAcc, elapsedMs);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Solver/ArcadeSolver.ts\n\r\n\r\n\r\n\r\n/**\r\n * ArcadeSolver is the default in Excalibur. It solves collisions so that there is no overlap between contacts,\r\n * and negates velocity along the collision normal.\r\n *\r\n * This is usually the type of collisions used for 2D games that don't need a more realistic collision simulation.\r\n *\r\n */\r\nclass ArcadeSolver {\r\n    constructor() {\r\n        this.directionMap = new Map();\r\n        this.distanceMap = new Map();\r\n    }\r\n    solve(contacts) {\r\n        // Events and init\r\n        this.preSolve(contacts);\r\n        // Remove any canceled contacts\r\n        contacts = contacts.filter(c => !c.isCanceled());\r\n        // Sort contacts by distance to avoid artifacts with seams\r\n        // It's important to solve in a specific order\r\n        contacts.sort((a, b) => {\r\n            const aDist = this.distanceMap.get(a.id);\r\n            const bDist = this.distanceMap.get(b.id);\r\n            return aDist - bDist;\r\n        });\r\n        for (const contact of contacts) {\r\n            // Solve position first in arcade\r\n            this.solvePosition(contact);\r\n            // Solve velocity second in arcade\r\n            this.solveVelocity(contact);\r\n        }\r\n        // Events and any contact house-keeping the solver needs\r\n        this.postSolve(contacts);\r\n        return contacts;\r\n    }\r\n    preSolve(contacts) {\r\n        for (const contact of contacts) {\r\n            const side = Side.fromDirection(contact.mtv);\r\n            const mtv = contact.mtv.negate();\r\n            const distance = contact.colliderA.worldPos.squareDistance(contact.colliderB.worldPos);\r\n            this.distanceMap.set(contact.id, distance);\r\n            // Publish collision events on both participants\r\n            contact.colliderA.events.emit('precollision', new PreCollisionEvent(contact.colliderA, contact.colliderB, side, mtv));\r\n            contact.colliderB.events.emit('precollision', new PreCollisionEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), mtv.negate()));\r\n        }\r\n    }\r\n    postSolve(contacts) {\r\n        var _a, _b;\r\n        for (const contact of contacts) {\r\n            if (contact.isCanceled()) {\r\n                continue;\r\n            }\r\n            const colliderA = contact.colliderA;\r\n            const colliderB = contact.colliderB;\r\n            const bodyA = (_a = colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n            const bodyB = (_b = colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n            if (bodyA && bodyB) {\r\n                if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\r\n                    continue;\r\n                }\r\n            }\r\n            const side = Side.fromDirection(contact.mtv);\r\n            const mtv = contact.mtv.negate();\r\n            // Publish collision events on both participants\r\n            contact.colliderA.events.emit('postcollision', new PostCollisionEvent(contact.colliderA, contact.colliderB, side, mtv));\r\n            contact.colliderB.events.emit('postcollision', new PostCollisionEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), mtv.negate()));\r\n        }\r\n    }\r\n    solvePosition(contact) {\r\n        var _a, _b;\r\n        const epsilon = .0001;\r\n        // if bounds no longer intersect skip to the next\r\n        // this removes jitter from overlapping/stacked solid tiles or a wall of solid tiles\r\n        if (!contact.colliderA.bounds.overlaps(contact.colliderB.bounds, epsilon)) {\r\n            // Cancel the contact to prevent and solving\r\n            contact.cancel();\r\n            return;\r\n        }\r\n        if (Math.abs(contact.mtv.x) < epsilon && Math.abs(contact.mtv.y) < epsilon) {\r\n            // Cancel near 0 mtv collisions\r\n            contact.cancel();\r\n            return;\r\n        }\r\n        let mtv = contact.mtv;\r\n        const colliderA = contact.colliderA;\r\n        const colliderB = contact.colliderB;\r\n        const bodyA = (_a = colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n        const bodyB = (_b = colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n        if (bodyA && bodyB) {\r\n            if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\r\n                return;\r\n            }\r\n            if (bodyA.collisionType === CollisionType.Active && bodyB.collisionType === CollisionType.Active) {\r\n                // split overlaps if both are Active\r\n                mtv = mtv.scale(0.5);\r\n            }\r\n            // Resolve overlaps\r\n            if (bodyA.collisionType === CollisionType.Active) {\r\n                bodyA.globalPos.x -= mtv.x;\r\n                bodyA.globalPos.y -= mtv.y;\r\n                colliderA.update(bodyA.transform.get());\r\n            }\r\n            if (bodyB.collisionType === CollisionType.Active) {\r\n                bodyB.globalPos.x += mtv.x;\r\n                bodyB.globalPos.y += mtv.y;\r\n                colliderB.update(bodyB.transform.get());\r\n            }\r\n        }\r\n    }\r\n    solveVelocity(contact) {\r\n        var _a, _b;\r\n        if (contact.isCanceled()) {\r\n            return;\r\n        }\r\n        const colliderA = contact.colliderA;\r\n        const colliderB = contact.colliderB;\r\n        const bodyA = (_a = colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n        const bodyB = (_b = colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n        if (bodyA && bodyB) {\r\n            if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\r\n                return;\r\n            }\r\n            const normal = contact.normal;\r\n            const opposite = normal.negate();\r\n            if (bodyA.collisionType === CollisionType.Active) {\r\n                // only adjust velocity if the contact normal is opposite to the current velocity\r\n                // this avoids catching edges on a platform when sliding off\r\n                if (bodyA.vel.normalize().dot(opposite) < 0) {\r\n                    // Cancel out velocity opposite direction of collision normal\r\n                    const velAdj = normal.scale(normal.dot(bodyA.vel.negate()));\r\n                    bodyA.vel = bodyA.vel.add(velAdj);\r\n                }\r\n            }\r\n            if (bodyB.collisionType === CollisionType.Active) {\r\n                // only adjust velocity if the contact normal is opposite to the current velocity\r\n                // this avoids catching edges on a platform\r\n                if (bodyB.vel.normalize().dot(normal) < 0) {\r\n                    const velAdj = opposite.scale(opposite.dot(bodyB.vel.negate()));\r\n                    bodyB.vel = bodyB.vel.add(velAdj);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Solver/ContactConstraintPoint.ts\n\r\n\r\n/**\r\n * Holds information about contact points, meant to be reused over multiple frames of contact\r\n */\r\nclass ContactConstraintPoint {\r\n    constructor(point, local, contact) {\r\n        this.point = point;\r\n        this.local = local;\r\n        this.contact = contact;\r\n        /**\r\n         * Impulse accumulated over time in normal direction\r\n         */\r\n        this.normalImpulse = 0;\r\n        /**\r\n         * Impulse accumulated over time in the tangent direction\r\n         */\r\n        this.tangentImpulse = 0;\r\n        /**\r\n         * Effective mass seen in the normal direction\r\n         */\r\n        this.normalMass = 0;\r\n        /**\r\n         * Effective mass seen in the tangent direction\r\n         */\r\n        this.tangentMass = 0;\r\n        /**\r\n         * Direction from center of mass of bodyA to contact point\r\n         */\r\n        this.aToContact = new Vector(0, 0);\r\n        /**\r\n         * Direction from center of mass of bodyB to contact point\r\n         */\r\n        this.bToContact = new Vector(0, 0);\r\n        /**\r\n         * Original contact velocity combined with bounciness\r\n         */\r\n        this.originalVelocityAndRestitution = 0;\r\n        this.update();\r\n    }\r\n    /**\r\n     * Updates the contact information\r\n     */\r\n    update() {\r\n        var _a, _b;\r\n        const bodyA = (_a = this.contact.colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n        const bodyB = (_b = this.contact.colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n        if (bodyA && bodyB) {\r\n            const normal = this.contact.normal;\r\n            const tangent = this.contact.tangent;\r\n            this.aToContact = this.point.sub(bodyA.globalPos);\r\n            this.bToContact = this.point.sub(bodyB.globalPos);\r\n            const aToContactNormal = this.aToContact.cross(normal);\r\n            const bToContactNormal = this.bToContact.cross(normal);\r\n            this.normalMass =\r\n                bodyA.inverseMass +\r\n                    bodyB.inverseMass +\r\n                    bodyA.inverseInertia * aToContactNormal * aToContactNormal +\r\n                    bodyB.inverseInertia * bToContactNormal * bToContactNormal;\r\n            const aToContactTangent = this.aToContact.cross(tangent);\r\n            const bToContactTangent = this.bToContact.cross(tangent);\r\n            this.tangentMass =\r\n                bodyA.inverseMass +\r\n                    bodyB.inverseMass +\r\n                    bodyA.inverseInertia * aToContactTangent * aToContactTangent +\r\n                    bodyB.inverseInertia * bToContactTangent * bToContactTangent;\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Returns the relative velocity between bodyA and bodyB\r\n     */\r\n    getRelativeVelocity() {\r\n        var _a, _b;\r\n        const bodyA = (_a = this.contact.colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n        const bodyB = (_b = this.contact.colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n        if (bodyA && bodyB) {\r\n            // Relative velocity in linear terms\r\n            // Angular to linear velocity formula -> omega = velocity/radius so omega x radius = velocity\r\n            const velA = bodyA.vel.add(Vector.cross(bodyA.angularVelocity, this.aToContact));\r\n            const velB = bodyB.vel.add(Vector.cross(bodyB.angularVelocity, this.bToContact));\r\n            return velB.sub(velA);\r\n        }\r\n        return Vector.Zero;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Solver/RealisticSolver.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass RealisticSolver {\r\n    constructor() {\r\n        this.lastFrameContacts = new Map();\r\n        // map contact id to contact points\r\n        this.idToContactConstraint = new Map();\r\n    }\r\n    getContactConstraints(id) {\r\n        var _a;\r\n        return (_a = this.idToContactConstraint.get(id)) !== null && _a !== void 0 ? _a : [];\r\n    }\r\n    solve(contacts) {\r\n        // Events and init\r\n        this.preSolve(contacts);\r\n        // Remove any canceled contacts\r\n        contacts = contacts.filter(c => !c.isCanceled());\r\n        // Solve velocity first\r\n        this.solveVelocity(contacts);\r\n        // Solve position last because non-overlap is the most important\r\n        this.solvePosition(contacts);\r\n        // Events and any contact house-keeping the solver needs\r\n        this.postSolve(contacts);\r\n        return contacts;\r\n    }\r\n    preSolve(contacts) {\r\n        var _a, _b, _c;\r\n        for (const contact of contacts) {\r\n            // Publish collision events on both participants\r\n            const side = Side.fromDirection(contact.mtv);\r\n            contact.colliderA.events.emit('precollision', new PreCollisionEvent(contact.colliderA, contact.colliderB, side, contact.mtv));\r\n            contact.colliderA.events.emit('beforecollisionresolve', new CollisionPreSolveEvent(contact.colliderA, contact.colliderB, side, contact.mtv, contact));\r\n            contact.colliderB.events.emit('precollision', new PreCollisionEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), contact.mtv.negate()));\r\n            contact.colliderB.events.emit('beforecollisionresolve', new CollisionPreSolveEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), contact.mtv.negate(), contact));\r\n            // Match awake state for sleeping\r\n            contact.matchAwake();\r\n        }\r\n        // Keep track of contacts that done\r\n        const finishedContactIds = Array.from(this.idToContactConstraint.keys());\r\n        for (const contact of contacts) {\r\n            // Remove all current contacts that are not done\r\n            const index = finishedContactIds.indexOf(contact.id);\r\n            if (index > -1) {\r\n                finishedContactIds.splice(index, 1);\r\n            }\r\n            const contactPoints = (_a = this.idToContactConstraint.get(contact.id)) !== null && _a !== void 0 ? _a : [];\r\n            let pointIndex = 0;\r\n            const bodyA = contact.colliderA.owner.get(BodyComponent);\r\n            const bodyB = contact.colliderB.owner.get(BodyComponent);\r\n            if (bodyA && bodyB) {\r\n                for (const point of contact.points) {\r\n                    const normal = contact.normal;\r\n                    const tangent = contact.tangent;\r\n                    const aToContact = point.sub(bodyA.globalPos);\r\n                    const bToContact = point.sub(bodyB.globalPos);\r\n                    const aToContactNormal = aToContact.cross(normal);\r\n                    const bToContactNormal = bToContact.cross(normal);\r\n                    const normalMass = bodyA.inverseMass +\r\n                        bodyB.inverseMass +\r\n                        bodyA.inverseInertia * aToContactNormal * aToContactNormal +\r\n                        bodyB.inverseInertia * bToContactNormal * bToContactNormal;\r\n                    const aToContactTangent = aToContact.cross(tangent);\r\n                    const bToContactTangent = bToContact.cross(tangent);\r\n                    const tangentMass = bodyA.inverseMass +\r\n                        bodyB.inverseMass +\r\n                        bodyA.inverseInertia * aToContactTangent * aToContactTangent +\r\n                        bodyB.inverseInertia * bToContactTangent * bToContactTangent;\r\n                    // Preserve normal/tangent impulse by re-using the contact point if it's close\r\n                    if (contactPoints[pointIndex] && ((_c = (_b = contactPoints[pointIndex]) === null || _b === void 0 ? void 0 : _b.point) === null || _c === void 0 ? void 0 : _c.squareDistance(point)) < 4) {\r\n                        contactPoints[pointIndex].point = point;\r\n                        contactPoints[pointIndex].local = contact.localPoints[pointIndex];\r\n                    }\r\n                    else {\r\n                        // new contact if it's not close or doesn't exist\r\n                        contactPoints[pointIndex] = new ContactConstraintPoint(point, contact.localPoints[pointIndex], contact);\r\n                    }\r\n                    // Update contact point calculations\r\n                    contactPoints[pointIndex].aToContact = aToContact;\r\n                    contactPoints[pointIndex].bToContact = bToContact;\r\n                    contactPoints[pointIndex].normalMass = 1.0 / normalMass;\r\n                    contactPoints[pointIndex].tangentMass = 1.0 / tangentMass;\r\n                    // Calculate relative velocity before solving to accurately do restitution\r\n                    const restitution = bodyA.bounciness > bodyB.bounciness ? bodyA.bounciness : bodyB.bounciness;\r\n                    const relativeVelocity = contact.normal.dot(contactPoints[pointIndex].getRelativeVelocity());\r\n                    contactPoints[pointIndex].originalVelocityAndRestitution = 0;\r\n                    if (relativeVelocity < -0.1) { // TODO what's a good threshold here?\r\n                        contactPoints[pointIndex].originalVelocityAndRestitution = -restitution * relativeVelocity;\r\n                    }\r\n                    pointIndex++;\r\n                }\r\n            }\r\n            this.idToContactConstraint.set(contact.id, contactPoints);\r\n        }\r\n        // Clean up any contacts that did not occur last frame\r\n        for (const id of finishedContactIds) {\r\n            this.idToContactConstraint.delete(id);\r\n        }\r\n        // Warm contacts with accumulated impulse\r\n        // Useful for tall stacks\r\n        if (Physics.warmStart) {\r\n            this.warmStart(contacts);\r\n        }\r\n        else {\r\n            for (const contact of contacts) {\r\n                const contactPoints = this.getContactConstraints(contact.id);\r\n                for (const point of contactPoints) {\r\n                    point.normalImpulse = 0;\r\n                    point.tangentImpulse = 0;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    postSolve(contacts) {\r\n        for (const contact of contacts) {\r\n            const bodyA = contact.colliderA.owner.get(BodyComponent);\r\n            const bodyB = contact.colliderB.owner.get(BodyComponent);\r\n            if (bodyA && bodyB) {\r\n                // Skip post solve for active+passive collisions\r\n                if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\r\n                    continue;\r\n                }\r\n                // Update motion values for sleeping\r\n                bodyA.updateMotion();\r\n                bodyB.updateMotion();\r\n            }\r\n            // Publish collision events on both participants\r\n            const side = Side.fromDirection(contact.mtv);\r\n            contact.colliderA.events.emit('postcollision', new PostCollisionEvent(contact.colliderA, contact.colliderB, side, contact.mtv));\r\n            contact.colliderA.events.emit('aftercollisionresolve', new CollisionPostSolveEvent(contact.colliderA, contact.colliderB, side, contact.mtv, contact));\r\n            contact.colliderB.events.emit('postcollision', new PostCollisionEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), contact.mtv.negate()));\r\n            contact.colliderB.events.emit('aftercollisionresolve', new CollisionPostSolveEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), contact.mtv.negate(), contact));\r\n        }\r\n        // Store contacts\r\n        this.lastFrameContacts.clear();\r\n        for (const c of contacts) {\r\n            this.lastFrameContacts.set(c.id, c);\r\n        }\r\n    }\r\n    /**\r\n     * Warm up body's based on previous frame contact points\r\n     * @param contacts\r\n     */\r\n    warmStart(contacts) {\r\n        var _a, _b, _c;\r\n        for (const contact of contacts) {\r\n            const bodyA = (_a = contact.colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n            const bodyB = (_b = contact.colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n            if (bodyA && bodyB) {\r\n                const contactPoints = (_c = this.idToContactConstraint.get(contact.id)) !== null && _c !== void 0 ? _c : [];\r\n                for (const point of contactPoints) {\r\n                    if (Physics.warmStart) {\r\n                        const normalImpulse = contact.normal.scale(point.normalImpulse);\r\n                        const tangentImpulse = contact.tangent.scale(point.tangentImpulse);\r\n                        const impulse = normalImpulse.add(tangentImpulse);\r\n                        bodyA.applyImpulse(point.point, impulse.negate());\r\n                        bodyB.applyImpulse(point.point, impulse);\r\n                    }\r\n                    else {\r\n                        point.normalImpulse = 0;\r\n                        point.tangentImpulse = 0;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Iteratively solve the position overlap constraint\r\n     * @param contacts\r\n     */\r\n    solvePosition(contacts) {\r\n        var _a, _b, _c;\r\n        for (let i = 0; i < Physics.positionIterations; i++) {\r\n            for (const contact of contacts) {\r\n                const bodyA = (_a = contact.colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n                const bodyB = (_b = contact.colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n                if (bodyA && bodyB) {\r\n                    // Skip solving active+passive\r\n                    if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\r\n                        continue;\r\n                    }\r\n                    const constraints = (_c = this.idToContactConstraint.get(contact.id)) !== null && _c !== void 0 ? _c : [];\r\n                    for (const point of constraints) {\r\n                        const normal = contact.normal;\r\n                        const separation = CollisionJumpTable.FindContactSeparation(contact, point.local);\r\n                        const steeringConstant = Physics.steeringFactor; //0.2;\r\n                        const maxCorrection = -5;\r\n                        const slop = Physics.slop; //1;\r\n                        // Clamp to avoid over-correction\r\n                        // Remember that we are shooting for 0 overlap in the end\r\n                        const steeringForce = clamp(steeringConstant * (separation + slop), maxCorrection, 0);\r\n                        const impulse = normal.scale(-steeringForce * point.normalMass);\r\n                        // This is a pseudo impulse, meaning we aren't doing a real impulse calculation\r\n                        // We adjust position and rotation instead of doing the velocity\r\n                        if (bodyA.collisionType === CollisionType.Active) {\r\n                            // TODO make applyPseudoImpulse function?\r\n                            const impulseForce = impulse.negate().scale(bodyA.inverseMass);\r\n                            if (bodyA.limitDegreeOfFreedom.includes(DegreeOfFreedom.X)) {\r\n                                impulseForce.x = 0;\r\n                            }\r\n                            if (bodyA.limitDegreeOfFreedom.includes(DegreeOfFreedom.Y)) {\r\n                                impulseForce.y = 0;\r\n                            }\r\n                            bodyA.globalPos = bodyA.globalPos.add(impulseForce);\r\n                            if (!bodyA.limitDegreeOfFreedom.includes(DegreeOfFreedom.Rotation)) {\r\n                                bodyA.rotation -= point.aToContact.cross(impulse) * bodyA.inverseInertia;\r\n                            }\r\n                        }\r\n                        if (bodyB.collisionType === CollisionType.Active) {\r\n                            const impulseForce = impulse.scale(bodyB.inverseMass);\r\n                            if (bodyB.limitDegreeOfFreedom.includes(DegreeOfFreedom.X)) {\r\n                                impulseForce.x = 0;\r\n                            }\r\n                            if (bodyB.limitDegreeOfFreedom.includes(DegreeOfFreedom.Y)) {\r\n                                impulseForce.y = 0;\r\n                            }\r\n                            bodyB.globalPos = bodyB.globalPos.add(impulseForce);\r\n                            if (!bodyB.limitDegreeOfFreedom.includes(DegreeOfFreedom.Rotation)) {\r\n                                bodyB.rotation += point.bToContact.cross(impulse) * bodyB.inverseInertia;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    solveVelocity(contacts) {\r\n        var _a, _b, _c;\r\n        for (let i = 0; i < Physics.velocityIterations; i++) {\r\n            for (const contact of contacts) {\r\n                const bodyA = (_a = contact.colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n                const bodyB = (_b = contact.colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n                if (bodyA && bodyB) {\r\n                    // Skip solving active+passive\r\n                    if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\r\n                        continue;\r\n                    }\r\n                    const friction = Math.min(bodyA.friction, bodyB.friction);\r\n                    const constraints = (_c = this.idToContactConstraint.get(contact.id)) !== null && _c !== void 0 ? _c : [];\r\n                    // Friction constraint\r\n                    for (const point of constraints) {\r\n                        const relativeVelocity = point.getRelativeVelocity();\r\n                        // Negate velocity in tangent direction to simulate friction\r\n                        const tangentVelocity = -relativeVelocity.dot(contact.tangent);\r\n                        let impulseDelta = tangentVelocity * point.tangentMass;\r\n                        // Clamping based in Erin Catto's GDC 2006 talk\r\n                        // Correct clamping https://github.com/erincatto/box2d-lite/blob/master/docs/GDC2006_Catto_Erin_PhysicsTutorial.pdf\r\n                        // Accumulated fiction impulse is always between -uMaxFriction < dT < uMaxFriction\r\n                        // But deltas can vary\r\n                        const maxFriction = friction * point.normalImpulse;\r\n                        const newImpulse = clamp(point.tangentImpulse + impulseDelta, -maxFriction, maxFriction);\r\n                        impulseDelta = newImpulse - point.tangentImpulse;\r\n                        point.tangentImpulse = newImpulse;\r\n                        const impulse = contact.tangent.scale(impulseDelta);\r\n                        bodyA.applyImpulse(point.point, impulse.negate());\r\n                        bodyB.applyImpulse(point.point, impulse);\r\n                    }\r\n                    // Bounce constraint\r\n                    for (const point of constraints) {\r\n                        // Need to recalc relative velocity because the previous step could have changed vel\r\n                        const relativeVelocity = point.getRelativeVelocity();\r\n                        // Compute impulse in normal direction\r\n                        const normalVelocity = relativeVelocity.dot(contact.normal);\r\n                        // Per Erin it is a mistake to apply the restitution inside the iteration\r\n                        // From Erin Catto's Box2D we keep original contact velocity and adjust by small impulses\r\n                        let impulseDelta = -point.normalMass * (normalVelocity - point.originalVelocityAndRestitution);\r\n                        // Clamping based in Erin Catto's GDC 2014 talk\r\n                        // Accumulated impulse stored in the contact is always positive (dV > 0)\r\n                        // But deltas can be negative\r\n                        const newImpulse = Math.max(point.normalImpulse + impulseDelta, 0);\r\n                        impulseDelta = newImpulse - point.normalImpulse;\r\n                        point.normalImpulse = newImpulse;\r\n                        const impulse = contact.normal.scale(impulseDelta);\r\n                        bodyA.applyImpulse(point.point, impulse.negate());\r\n                        bodyB.applyImpulse(point.point, impulse);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/CollisionSystem.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass CollisionSystem extends System {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.types = ['ex.transform', 'ex.motion', 'ex.collider'];\r\n        this.systemType = SystemType.Update;\r\n        this.priority = -1;\r\n        this._realisticSolver = new RealisticSolver();\r\n        this._arcadeSolver = new ArcadeSolver();\r\n        this._processor = new DynamicTreeCollisionProcessor();\r\n        this._lastFrameContacts = new Map();\r\n        this._currentFrameContacts = new Map();\r\n        this._trackCollider = (c) => this._processor.track(c);\r\n        this._untrackCollider = (c) => this._processor.untrack(c);\r\n    }\r\n    notify(message) {\r\n        if (isAddedSystemEntity(message)) {\r\n            const colliderComponent = message.data.get(ColliderComponent);\r\n            colliderComponent.$colliderAdded.subscribe(this._trackCollider);\r\n            colliderComponent.$colliderRemoved.subscribe(this._untrackCollider);\r\n            const collider = colliderComponent.get();\r\n            if (collider) {\r\n                this._processor.track(collider);\r\n            }\r\n        }\r\n        else {\r\n            const colliderComponent = message.data.get(ColliderComponent);\r\n            const collider = colliderComponent.get();\r\n            if (colliderComponent && collider) {\r\n                this._processor.untrack(collider);\r\n            }\r\n        }\r\n    }\r\n    initialize(scene) {\r\n        this._engine = scene.engine;\r\n    }\r\n    update(entities, elapsedMs) {\r\n        var _a, _b, _c, _d;\r\n        if (!Physics.enabled) {\r\n            return;\r\n        }\r\n        // Collect up all the colliders and update them\r\n        let colliders = [];\r\n        for (const entity of entities) {\r\n            const colliderComp = entity.get(ColliderComponent);\r\n            const collider = colliderComp === null || colliderComp === void 0 ? void 0 : colliderComp.get();\r\n            if (colliderComp && ((_a = colliderComp.owner) === null || _a === void 0 ? void 0 : _a.active) && collider) {\r\n                colliderComp.update();\r\n                if (collider instanceof CompositeCollider) {\r\n                    const compositeColliders = collider.getColliders();\r\n                    colliders = colliders.concat(compositeColliders);\r\n                }\r\n                else {\r\n                    colliders.push(collider);\r\n                }\r\n            }\r\n        }\r\n        // Update the spatial partitioning data structures\r\n        // TODO if collider invalid it will break the processor\r\n        // TODO rename \"update\" to something more specific\r\n        this._processor.update(colliders);\r\n        // Run broadphase on all colliders and locates potential collisions\r\n        const pairs = this._processor.broadphase(colliders, elapsedMs);\r\n        this._currentFrameContacts.clear();\r\n        // Given possible pairs find actual contacts\r\n        let contacts = this._processor.narrowphase(pairs, (_d = (_c = (_b = this._engine) === null || _b === void 0 ? void 0 : _b.debug) === null || _c === void 0 ? void 0 : _c.stats) === null || _d === void 0 ? void 0 : _d.currFrame);\r\n        const solver = this.getSolver();\r\n        // Solve, this resolves the position/velocity so entities aren't overlapping\r\n        contacts = solver.solve(contacts);\r\n        // Record contacts for start/end\r\n        for (const contact of contacts) {\r\n            // Process composite ids, things with the same composite id are treated as the same collider for start/end\r\n            const index = contact.id.indexOf('|');\r\n            if (index > 0) {\r\n                const compositeId = contact.id.substring(index + 1);\r\n                this._currentFrameContacts.set(compositeId, contact);\r\n            }\r\n            else {\r\n                this._currentFrameContacts.set(contact.id, contact);\r\n            }\r\n        }\r\n        // Emit contact start/end events\r\n        this.runContactStartEnd();\r\n        // reset the last frame cache\r\n        this._lastFrameContacts.clear();\r\n        // Keep track of collisions contacts that have started or ended\r\n        this._lastFrameContacts = new Map(this._currentFrameContacts);\r\n    }\r\n    getSolver() {\r\n        return Physics.collisionResolutionStrategy === CollisionResolutionStrategy.Realistic ? this._realisticSolver : this._arcadeSolver;\r\n    }\r\n    debug(ex) {\r\n        this._processor.debug(ex);\r\n    }\r\n    runContactStartEnd() {\r\n        // Composite collider collisions may have a duplicate id because we want to treat those as a singular start/end\r\n        for (const [id, c] of this._currentFrameContacts) {\r\n            // find all new contacts\r\n            if (!this._lastFrameContacts.has(id)) {\r\n                const colliderA = c.colliderA;\r\n                const colliderB = c.colliderB;\r\n                colliderA.events.emit('collisionstart', new CollisionStartEvent(colliderA, colliderB, c));\r\n                colliderA.events.emit('contactstart', new ContactStartEvent(colliderA, colliderB, c));\r\n                colliderB.events.emit('collisionstart', new CollisionStartEvent(colliderB, colliderA, c));\r\n                colliderB.events.emit('contactstart', new ContactStartEvent(colliderB, colliderA, c));\r\n            }\r\n        }\r\n        // find all contacts that have ceased\r\n        for (const [id, c] of this._lastFrameContacts) {\r\n            if (!this._currentFrameContacts.has(id)) {\r\n                const colliderA = c.colliderA;\r\n                const colliderB = c.colliderB;\r\n                colliderA.events.emit('collisionend', new CollisionEndEvent(colliderA, colliderB));\r\n                colliderA.events.emit('contactend', new ContactEndEvent(colliderA, colliderB));\r\n                colliderB.events.emit('collisionend', new CollisionEndEvent(colliderB, colliderA));\r\n                colliderB.events.emit('contactend', new ContactEndEvent(colliderB, colliderA));\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Animation.ts\n\r\n\r\n\r\n\r\nvar AnimationDirection;\r\n(function (AnimationDirection) {\r\n    /**\r\n     * Animation is playing forwards\r\n     */\r\n    AnimationDirection[\"Forward\"] = \"forward\";\r\n    /**\r\n     * Animation is play backwards\r\n     */\r\n    AnimationDirection[\"Backward\"] = \"backward\";\r\n})(AnimationDirection || (AnimationDirection = {}));\r\nvar AnimationStrategy;\r\n(function (AnimationStrategy) {\r\n    /**\r\n     * Animation ends without displaying anything\r\n     */\r\n    AnimationStrategy[\"End\"] = \"end\";\r\n    /**\r\n     * Animation loops to the first frame after the last frame\r\n     */\r\n    AnimationStrategy[\"Loop\"] = \"loop\";\r\n    /**\r\n     * Animation plays to the last frame, then backwards to the first frame, then repeats\r\n     */\r\n    AnimationStrategy[\"PingPong\"] = \"pingpong\";\r\n    /**\r\n     * Animation ends stopping on the last frame\r\n     */\r\n    AnimationStrategy[\"Freeze\"] = \"freeze\";\r\n})(AnimationStrategy || (AnimationStrategy = {}));\r\n/**\r\n * Create an Animation given a list of [[Frame|frames]] in [[AnimationOptions]]\r\n *\r\n * To create an Animation from a [[SpriteSheet]], use [[Animation.fromSpriteSheet]]\r\n */\r\nclass Animation extends Graphic {\r\n    constructor(options) {\r\n        var _a, _b;\r\n        super(options);\r\n        this.events = new EventDispatcher(); // TODO replace with new Emitter\r\n        this.frames = [];\r\n        this.strategy = AnimationStrategy.Loop;\r\n        this.frameDuration = 100;\r\n        this.timeScale = 1;\r\n        this._idempotencyToken = -1;\r\n        this._firstTick = true;\r\n        this._currentFrame = 0;\r\n        this._timeLeftInFrame = 0;\r\n        this._direction = 1; // TODO only used in ping-pong\r\n        this._done = false;\r\n        this._playing = true;\r\n        this._reversed = false;\r\n        this.frames = options.frames;\r\n        this.strategy = (_a = options.strategy) !== null && _a !== void 0 ? _a : this.strategy;\r\n        this.frameDuration = options.totalDuration ? options.totalDuration / this.frames.length : (_b = options.frameDuration) !== null && _b !== void 0 ? _b : this.frameDuration;\r\n        if (options.reverse) {\r\n            this.reverse();\r\n        }\r\n        this.goToFrame(0);\r\n    }\r\n    clone() {\r\n        return new Animation({\r\n            frames: this.frames.map((f) => ({ ...f })),\r\n            frameDuration: this.frameDuration,\r\n            reverse: this._reversed,\r\n            strategy: this.strategy,\r\n            ...this.cloneGraphicOptions()\r\n        });\r\n    }\r\n    get width() {\r\n        const maybeFrame = this.currentFrame;\r\n        if (maybeFrame) {\r\n            return Math.abs(maybeFrame.graphic.width * this.scale.x);\r\n        }\r\n        return 0;\r\n    }\r\n    get height() {\r\n        const maybeFrame = this.currentFrame;\r\n        if (maybeFrame) {\r\n            return Math.abs(maybeFrame.graphic.height * this.scale.y);\r\n        }\r\n        return 0;\r\n    }\r\n    /**\r\n     * Create an Animation from a [[SpriteSheet]], a list of indices into the sprite sheet, a duration per frame\r\n     * and optional [[AnimationStrategy]]\r\n     *\r\n     * Example:\r\n     * ```typescript\r\n     * const spriteSheet = SpriteSheet.fromImageSource({...});\r\n     *\r\n     * const anim = Animation.fromSpriteSheet(spriteSheet, range(0, 5), 200, AnimationStrategy.Loop);\r\n     * ```\r\n     *\r\n     * @param spriteSheet\r\n     * @param frameIndices\r\n     * @param durationPerFrameMs\r\n     * @param strategy\r\n     */\r\n    static fromSpriteSheet(spriteSheet, frameIndices, durationPerFrameMs, strategy = AnimationStrategy.Loop) {\r\n        const maxIndex = spriteSheet.sprites.length - 1;\r\n        const invalidIndices = frameIndices.filter((index) => index < 0 || index > maxIndex);\r\n        if (invalidIndices.length) {\r\n            Animation._LOGGER.warn(`Indices into SpriteSheet were provided that don\\'t exist: ${invalidIndices.join(',')} no frame will be shown`);\r\n        }\r\n        return new Animation({\r\n            frames: spriteSheet.sprites\r\n                .filter((_, index) => frameIndices.indexOf(index) > -1)\r\n                .map((f) => ({\r\n                graphic: f,\r\n                duration: durationPerFrameMs\r\n            })),\r\n            strategy: strategy\r\n        });\r\n    }\r\n    /**\r\n     * Returns the current Frame of the animation\r\n     */\r\n    get currentFrame() {\r\n        if (this._currentFrame >= 0 && this._currentFrame < this.frames.length) {\r\n            return this.frames[this._currentFrame];\r\n        }\r\n        return null;\r\n    }\r\n    /**\r\n     * Returns the current frame index of the animation\r\n     */\r\n    get currentFrameIndex() {\r\n        return this._currentFrame;\r\n    }\r\n    /**\r\n     * Returns `true` if the animation is playing\r\n     */\r\n    get isPlaying() {\r\n        return this._playing;\r\n    }\r\n    /**\r\n     * Reverses the play direction of the Animation, this preserves the current frame\r\n     */\r\n    reverse() {\r\n        // Don't mutate with the original frame list, create a copy\r\n        this.frames = this.frames.slice().reverse();\r\n        this._reversed = !this._reversed;\r\n    }\r\n    /**\r\n     * Returns the current play direction of the animation\r\n     */\r\n    get direction() {\r\n        // Keep logically consistent with ping-pong direction\r\n        // If ping-pong is forward = 1 and reversed is true then we are logically reversed\r\n        const reversed = (this._reversed && this._direction === 1) ? true : false;\r\n        return reversed ? AnimationDirection.Backward : AnimationDirection.Forward;\r\n    }\r\n    /**\r\n     * Plays or resumes the animation from the current frame\r\n     */\r\n    play() {\r\n        this._playing = true;\r\n    }\r\n    /**\r\n     * Pauses the animation on the current frame\r\n     */\r\n    pause() {\r\n        this._playing = false;\r\n        this._firstTick = true; // firstTick must be set to emit the proper frame event\r\n    }\r\n    /**\r\n     * Reset the animation back to the beginning, including if the animation were done\r\n     */\r\n    reset() {\r\n        this._done = false;\r\n        this._firstTick = true;\r\n        this._currentFrame = 0;\r\n    }\r\n    /**\r\n     * Returns `true` if the animation can end\r\n     */\r\n    get canFinish() {\r\n        switch (this.strategy) {\r\n            case AnimationStrategy.End:\r\n            case AnimationStrategy.Freeze: {\r\n                return true;\r\n            }\r\n            default: {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Returns `true` if the animation is done, for looping type animations\r\n     * `ex.AnimationStrategy.PingPong` and `ex.AnimationStrategy.Loop` this will always return `false`\r\n     *\r\n     * See the `ex.Animation.canFinish()` method to know if an animation type can end\r\n     */\r\n    get done() {\r\n        return this._done;\r\n    }\r\n    /**\r\n     * Jump the animation immediately to a specific frame if it exists\r\n     * @param frameNumber\r\n     */\r\n    goToFrame(frameNumber) {\r\n        this._currentFrame = frameNumber;\r\n        this._timeLeftInFrame = this.frameDuration;\r\n        const maybeFrame = this.frames[this._currentFrame];\r\n        if (maybeFrame && !this._done) {\r\n            this._timeLeftInFrame = (maybeFrame === null || maybeFrame === void 0 ? void 0 : maybeFrame.duration) || this.frameDuration;\r\n            this.events.emit('frame', maybeFrame);\r\n        }\r\n    }\r\n    _nextFrame() {\r\n        const currentFrame = this._currentFrame;\r\n        if (this._done) {\r\n            return currentFrame;\r\n        }\r\n        let next = -1;\r\n        switch (this.strategy) {\r\n            case AnimationStrategy.Loop: {\r\n                next = (currentFrame + 1) % this.frames.length;\r\n                if (next === 0) {\r\n                    this.events.emit('loop', this);\r\n                }\r\n                break;\r\n            }\r\n            case AnimationStrategy.End: {\r\n                next = currentFrame + 1;\r\n                if (next >= this.frames.length) {\r\n                    this._done = true;\r\n                    this._currentFrame = this.frames.length;\r\n                    this.events.emit('end', this);\r\n                }\r\n                break;\r\n            }\r\n            case AnimationStrategy.Freeze: {\r\n                next = clamp(currentFrame + 1, 0, this.frames.length - 1);\r\n                if (next >= this.frames.length - 1) {\r\n                    this._done = true;\r\n                    this.events.emit('end', this);\r\n                }\r\n                break;\r\n            }\r\n            case AnimationStrategy.PingPong: {\r\n                if (currentFrame + this._direction >= this.frames.length) {\r\n                    this._direction = -1;\r\n                    this.events.emit('loop', this);\r\n                }\r\n                if (currentFrame + this._direction < 0) {\r\n                    this._direction = 1;\r\n                    this.events.emit('loop', this);\r\n                }\r\n                next = currentFrame + (this._direction % this.frames.length);\r\n                break;\r\n            }\r\n        }\r\n        return next;\r\n    }\r\n    /**\r\n     * Called internally by Excalibur to update the state of the animation potential update the current frame\r\n     * @param elapsedMilliseconds Milliseconds elapsed\r\n     * @param idempotencyToken Prevents double ticking in a frame by passing a unique token to the frame\r\n     */\r\n    tick(elapsedMilliseconds, idempotencyToken = 0) {\r\n        if (this._idempotencyToken === idempotencyToken) {\r\n            return;\r\n        }\r\n        this._idempotencyToken = idempotencyToken;\r\n        if (!this._playing) {\r\n            return;\r\n        }\r\n        // if it's the first frame emit frame event\r\n        if (this._firstTick) {\r\n            this._firstTick = false;\r\n            this.events.emit('frame', this.currentFrame);\r\n        }\r\n        this._timeLeftInFrame -= elapsedMilliseconds * this.timeScale;\r\n        if (this._timeLeftInFrame <= 0) {\r\n            this.goToFrame(this._nextFrame());\r\n        }\r\n    }\r\n    _drawImage(ctx, x, y) {\r\n        if (this.currentFrame) {\r\n            this.currentFrame.graphic.draw(ctx, x, y);\r\n        }\r\n    }\r\n}\r\nAnimation._LOGGER = Logger.getInstance();\r\n\n;// CONCATENATED MODULE: ./Graphics/GraphicsGroup.ts\n\r\n\r\n\r\nclass GraphicsGroup extends Graphic {\r\n    constructor(options) {\r\n        super(options);\r\n        this.members = [];\r\n        this.members = options.members;\r\n        this._updateDimensions();\r\n    }\r\n    clone() {\r\n        return new GraphicsGroup({\r\n            members: [...this.members],\r\n            ...this.cloneGraphicOptions()\r\n        });\r\n    }\r\n    _updateDimensions() {\r\n        let bb = new BoundingBox();\r\n        for (const { graphic, pos } of this.members) {\r\n            bb = graphic.localBounds.translate(pos).combine(bb);\r\n        }\r\n        this.width = bb.width;\r\n        this.height = bb.height;\r\n        return bb;\r\n    }\r\n    get localBounds() {\r\n        let bb = new BoundingBox();\r\n        for (const { graphic, pos } of this.members) {\r\n            bb = graphic.localBounds.translate(pos).combine(bb);\r\n        }\r\n        return bb;\r\n    }\r\n    _isAnimationOrGroup(graphic) {\r\n        return graphic instanceof Animation || graphic instanceof GraphicsGroup;\r\n    }\r\n    tick(elapsedMilliseconds, idempotencyToken) {\r\n        for (const member of this.members) {\r\n            const maybeAnimation = member.graphic;\r\n            if (this._isAnimationOrGroup(maybeAnimation)) {\r\n                maybeAnimation.tick(elapsedMilliseconds, idempotencyToken);\r\n            }\r\n        }\r\n    }\r\n    reset() {\r\n        for (const member of this.members) {\r\n            const maybeAnimation = member.graphic;\r\n            if (this._isAnimationOrGroup(maybeAnimation)) {\r\n                maybeAnimation.reset();\r\n            }\r\n        }\r\n    }\r\n    _preDraw(ex, x, y) {\r\n        this._updateDimensions();\r\n        super._preDraw(ex, x, y);\r\n    }\r\n    _drawImage(ex, x, y) {\r\n        for (const member of this.members) {\r\n            ex.save();\r\n            ex.translate(x, y);\r\n            member.graphic.draw(ex, member.pos.x, member.pos.y);\r\n            if (this.showDebug) {\r\n                /* istanbul ignore next */\r\n                ex.debug.drawRect(0, 0, this.width, this.height);\r\n            }\r\n            ex.restore();\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Configurable.ts\n/**\r\n * Configurable helper extends base type and makes all properties available as option bag arguments\r\n * @internal\r\n * @param base\r\n */\r\nfunction Configurable(base) {\r\n    return class extends base {\r\n        assign(props) {\r\n            //set the value of every property that was passed in,\r\n            //if the constructor previously set this value, it will be overridden here\r\n            for (const k in props) {\r\n                // eslint-disable-next-line\r\n                if (typeof this[k] !== 'function') {\r\n                    // eslint-disable-next-line\r\n                    this[k] = props[k];\r\n                }\r\n            }\r\n        }\r\n        constructor(...args) {\r\n            super(...args);\r\n            //get the number of arguments that aren't undefined. TS passes a value to all parameters\r\n            //of whatever ctor is the implementation, so args.length doesn't work here.\r\n            const size = args.filter(function (value) {\r\n                return value !== undefined;\r\n            }).length;\r\n            if (size === 1 && args[0] && typeof args[0] === 'object' && !(args[0] instanceof Array)) {\r\n                this.assign(args[0]);\r\n            }\r\n        }\r\n    };\r\n}\r\n\n;// CONCATENATED MODULE: ./Particles.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * An enum that represents the types of emitter nozzles\r\n */\r\nvar EmitterType;\r\n(function (EmitterType) {\r\n    /**\r\n     * Constant for the circular emitter type\r\n     */\r\n    EmitterType[EmitterType[\"Circle\"] = 0] = \"Circle\";\r\n    /**\r\n     * Constant for the rectangular emitter type\r\n     */\r\n    EmitterType[EmitterType[\"Rectangle\"] = 1] = \"Rectangle\";\r\n})(EmitterType || (EmitterType = {}));\r\n/**\r\n * @hidden\r\n */\r\nclass ParticleImpl extends Entity {\r\n    constructor(emitterOrConfig, life, opacity, beginColor, endColor, position, velocity, acceleration, startSize, endSize) {\r\n        super();\r\n        this.position = new Vector(0, 0);\r\n        this.velocity = new Vector(0, 0);\r\n        this.acceleration = new Vector(0, 0);\r\n        this.particleRotationalVelocity = 0;\r\n        this.currentRotation = 0;\r\n        this.focus = null;\r\n        this.focusAccel = 0;\r\n        this.opacity = 1;\r\n        this.beginColor = Color.White;\r\n        this.endColor = Color.White;\r\n        // Life is counted in ms\r\n        this.life = 300;\r\n        this.fadeFlag = false;\r\n        // Color transitions\r\n        this._rRate = 1;\r\n        this._gRate = 1;\r\n        this._bRate = 1;\r\n        this._aRate = 0;\r\n        this._currentColor = Color.White;\r\n        this.emitter = null;\r\n        this.particleSize = 5;\r\n        this.particleSprite = null;\r\n        this.sizeRate = 0;\r\n        this.elapsedMultiplier = 0;\r\n        this.visible = true;\r\n        this.isOffscreen = false;\r\n        let emitter = emitterOrConfig;\r\n        if (emitter && !(emitterOrConfig instanceof ParticleEmitter)) {\r\n            const config = emitterOrConfig;\r\n            emitter = config.emitter;\r\n            life = config.life;\r\n            opacity = config.opacity;\r\n            endColor = config.endColor;\r\n            beginColor = config.beginColor;\r\n            position = config.position;\r\n            velocity = config.velocity;\r\n            acceleration = config.acceleration;\r\n            startSize = config.startSize;\r\n            endSize = config.endSize;\r\n        }\r\n        this.emitter = emitter;\r\n        this.life = life || this.life;\r\n        this.opacity = opacity || this.opacity;\r\n        this.endColor = endColor || this.endColor.clone();\r\n        this.beginColor = beginColor || this.beginColor.clone();\r\n        this._currentColor = this.beginColor.clone();\r\n        this.position = (position || this.position).add(this.emitter.pos);\r\n        this.velocity = velocity || this.velocity;\r\n        this.acceleration = acceleration || this.acceleration;\r\n        this._rRate = (this.endColor.r - this.beginColor.r) / this.life;\r\n        this._gRate = (this.endColor.g - this.beginColor.g) / this.life;\r\n        this._bRate = (this.endColor.b - this.beginColor.b) / this.life;\r\n        this._aRate = this.opacity / this.life;\r\n        this.startSize = startSize || 0;\r\n        this.endSize = endSize || 0;\r\n        if (this.endSize > 0 && this.startSize > 0) {\r\n            this.sizeRate = (this.endSize - this.startSize) / this.life;\r\n            this.particleSize = this.startSize;\r\n        }\r\n        this.addComponent((this.transform = new TransformComponent()));\r\n        this.addComponent((this.graphics = new GraphicsComponent()));\r\n        this.transform.pos = this.position;\r\n        this.transform.rotation = this.currentRotation;\r\n        this.transform.scale = vec(1, 1); // TODO wut\r\n        if (this.particleSprite) {\r\n            this.graphics.opacity = this.opacity;\r\n            this.graphics.use(this.particleSprite);\r\n        }\r\n        else {\r\n            this.graphics.localBounds = BoundingBox.fromDimension(this.particleSize, this.particleSize, Vector.Half);\r\n            this.graphics.onPostDraw = (ctx) => {\r\n                ctx.save();\r\n                this.graphics.opacity = this.opacity;\r\n                const tmpColor = this._currentColor.clone();\r\n                tmpColor.a = 1;\r\n                ctx.debug.drawPoint(vec(0, 0), { color: tmpColor, size: this.particleSize });\r\n                ctx.restore();\r\n            };\r\n        }\r\n    }\r\n    kill() {\r\n        this.emitter.removeParticle(this);\r\n    }\r\n    update(_engine, delta) {\r\n        this.life = this.life - delta;\r\n        this.elapsedMultiplier = this.elapsedMultiplier + delta;\r\n        if (this.life < 0) {\r\n            this.kill();\r\n        }\r\n        if (this.fadeFlag) {\r\n            this.opacity = clamp(this._aRate * this.life, 0.0001, 1);\r\n        }\r\n        if (this.startSize > 0 && this.endSize > 0) {\r\n            this.particleSize = clamp(this.sizeRate * delta + this.particleSize, Math.min(this.startSize, this.endSize), Math.max(this.startSize, this.endSize));\r\n        }\r\n        this._currentColor.r = clamp(this._currentColor.r + this._rRate * delta, 0, 255);\r\n        this._currentColor.g = clamp(this._currentColor.g + this._gRate * delta, 0, 255);\r\n        this._currentColor.b = clamp(this._currentColor.b + this._bRate * delta, 0, 255);\r\n        this._currentColor.a = clamp(this.opacity, 0.0001, 1);\r\n        if (this.focus) {\r\n            const accel = this.focus\r\n                .sub(this.position)\r\n                .normalize()\r\n                .scale(this.focusAccel)\r\n                .scale(delta / 1000);\r\n            this.velocity = this.velocity.add(accel);\r\n        }\r\n        else {\r\n            this.velocity = this.velocity.add(this.acceleration.scale(delta / 1000));\r\n        }\r\n        this.position = this.position.add(this.velocity.scale(delta / 1000));\r\n        if (this.particleRotationalVelocity) {\r\n            this.currentRotation = (this.currentRotation + (this.particleRotationalVelocity * delta) / 1000) % (2 * Math.PI);\r\n        }\r\n        this.transform.pos = this.position;\r\n        this.transform.rotation = this.currentRotation;\r\n        this.transform.scale = vec(1, 1); // todo wut\r\n        this.graphics.opacity = this.opacity;\r\n    }\r\n}\r\n/**\r\n * Particle is used in a [[ParticleEmitter]]\r\n */\r\nclass Particle extends Configurable(ParticleImpl) {\r\n    constructor(emitterOrConfig, life, opacity, beginColor, endColor, position, velocity, acceleration, startSize, endSize) {\r\n        super(emitterOrConfig, life, opacity, beginColor, endColor, position, velocity, acceleration, startSize, endSize);\r\n    }\r\n}\r\n/**\r\n * Using a particle emitter is a great way to create interesting effects\r\n * in your game, like smoke, fire, water, explosions, etc. `ParticleEmitter`\r\n * extend [[Actor]] allowing you to use all of the features that come with.\r\n */\r\nclass ParticleEmitter extends Actor {\r\n    /**\r\n     * @param config particle emitter options bag\r\n     */\r\n    constructor(config) {\r\n        var _a, _b;\r\n        super({ width: (_a = config.width) !== null && _a !== void 0 ? _a : 0, height: (_b = config.height) !== null && _b !== void 0 ? _b : 0 });\r\n        this._particlesToEmit = 0;\r\n        this.numParticles = 0;\r\n        /**\r\n         * Gets or sets the isEmitting flag\r\n         */\r\n        this.isEmitting = true;\r\n        /**\r\n         * Gets or sets the backing particle collection\r\n         */\r\n        this.particles = [];\r\n        /**\r\n         * Gets or sets the backing deadParticle collection\r\n         */\r\n        this.deadParticles = [];\r\n        /**\r\n         * Gets or sets the minimum particle velocity\r\n         */\r\n        this.minVel = 0;\r\n        /**\r\n         * Gets or sets the maximum particle velocity\r\n         */\r\n        this.maxVel = 0;\r\n        /**\r\n         * Gets or sets the acceleration vector for all particles\r\n         */\r\n        this.acceleration = new Vector(0, 0);\r\n        /**\r\n         * Gets or sets the minimum angle in radians\r\n         */\r\n        this.minAngle = 0;\r\n        /**\r\n         * Gets or sets the maximum angle in radians\r\n         */\r\n        this.maxAngle = 0;\r\n        /**\r\n         * Gets or sets the emission rate for particles (particles/sec)\r\n         */\r\n        this.emitRate = 1; //particles/sec\r\n        /**\r\n         * Gets or sets the life of each particle in milliseconds\r\n         */\r\n        this.particleLife = 2000;\r\n        /**\r\n         * Gets or sets the fade flag which causes particles to gradually fade out over the course of their life.\r\n         */\r\n        this.fadeFlag = false;\r\n        /**\r\n         * Gets or sets the optional focus where all particles should accelerate towards\r\n         */\r\n        this.focus = null;\r\n        /**\r\n         * Gets or sets the acceleration for focusing particles if a focus has been specified\r\n         */\r\n        this.focusAccel = null;\r\n        /**\r\n         * Gets or sets the optional starting size for the particles\r\n         */\r\n        this.startSize = null;\r\n        /**\r\n         * Gets or sets the optional ending size for the particles\r\n         */\r\n        this.endSize = null;\r\n        /**\r\n         * Gets or sets the minimum size of all particles\r\n         */\r\n        this.minSize = 5;\r\n        /**\r\n         * Gets or sets the maximum size of all particles\r\n         */\r\n        this.maxSize = 5;\r\n        /**\r\n         * Gets or sets the beginning color of all particles\r\n         */\r\n        this.beginColor = Color.White;\r\n        /**\r\n         * Gets or sets the ending color of all particles\r\n         */\r\n        this.endColor = Color.White;\r\n        this._sprite = null;\r\n        /**\r\n         * Gets or sets the emitter type for the particle emitter\r\n         */\r\n        this.emitterType = EmitterType.Rectangle;\r\n        /**\r\n         * Gets or sets the emitter radius, only takes effect when the [[emitterType]] is [[EmitterType.Circle]]\r\n         */\r\n        this.radius = 0;\r\n        /**\r\n         * Gets or sets the particle rotational speed velocity\r\n         */\r\n        this.particleRotationalVelocity = 0;\r\n        /**\r\n         * Indicates whether particles should start with a random rotation\r\n         */\r\n        this.randomRotation = false;\r\n        const { x, y, pos, isEmitting, minVel, maxVel, acceleration, minAngle, maxAngle, emitRate, particleLife, opacity, fadeFlag, focus, focusAccel, startSize, endSize, minSize, maxSize, beginColor, endColor, particleSprite, emitterType, radius, particleRotationalVelocity, randomRotation, random } = { ...config };\r\n        this.pos = pos !== null && pos !== void 0 ? pos : vec(x !== null && x !== void 0 ? x : 0, y !== null && y !== void 0 ? y : 0);\r\n        this.isEmitting = isEmitting !== null && isEmitting !== void 0 ? isEmitting : this.isEmitting;\r\n        this.minVel = minVel !== null && minVel !== void 0 ? minVel : this.minVel;\r\n        this.maxVel = maxVel !== null && maxVel !== void 0 ? maxVel : this.maxVel;\r\n        this.acceleration = acceleration !== null && acceleration !== void 0 ? acceleration : this.acceleration;\r\n        this.minAngle = minAngle !== null && minAngle !== void 0 ? minAngle : this.minAngle;\r\n        this.maxAngle = maxAngle !== null && maxAngle !== void 0 ? maxAngle : this.maxAngle;\r\n        this.emitRate = emitRate !== null && emitRate !== void 0 ? emitRate : this.emitRate;\r\n        this.particleLife = particleLife !== null && particleLife !== void 0 ? particleLife : this.particleLife;\r\n        this.opacity = opacity !== null && opacity !== void 0 ? opacity : this.opacity;\r\n        this.fadeFlag = fadeFlag !== null && fadeFlag !== void 0 ? fadeFlag : this.fadeFlag;\r\n        this.focus = focus !== null && focus !== void 0 ? focus : this.focus;\r\n        this.focusAccel = focusAccel !== null && focusAccel !== void 0 ? focusAccel : this.focusAccel;\r\n        this.startSize = startSize !== null && startSize !== void 0 ? startSize : this.startSize;\r\n        this.endSize = endSize !== null && endSize !== void 0 ? endSize : this.endSize;\r\n        this.minSize = minSize !== null && minSize !== void 0 ? minSize : this.minSize;\r\n        this.maxSize = maxSize !== null && maxSize !== void 0 ? maxSize : this.maxSize;\r\n        this.beginColor = beginColor !== null && beginColor !== void 0 ? beginColor : this.beginColor;\r\n        this.endColor = endColor !== null && endColor !== void 0 ? endColor : this.endColor;\r\n        this.particleSprite = particleSprite !== null && particleSprite !== void 0 ? particleSprite : this.particleSprite;\r\n        this.emitterType = emitterType !== null && emitterType !== void 0 ? emitterType : this.emitterType;\r\n        this.radius = radius !== null && radius !== void 0 ? radius : this.radius;\r\n        this.particleRotationalVelocity = particleRotationalVelocity !== null && particleRotationalVelocity !== void 0 ? particleRotationalVelocity : this.particleRotationalVelocity;\r\n        this.randomRotation = randomRotation !== null && randomRotation !== void 0 ? randomRotation : this.randomRotation;\r\n        this.body.collisionType = CollisionType.PreventCollision;\r\n        this.random = random !== null && random !== void 0 ? random : new Random();\r\n    }\r\n    /**\r\n     * Gets the opacity of each particle from 0 to 1.0\r\n     */\r\n    get opacity() {\r\n        return super.graphics.opacity;\r\n    }\r\n    /**\r\n     * Gets the opacity of each particle from 0 to 1.0\r\n     */\r\n    set opacity(opacity) {\r\n        super.graphics.opacity = opacity;\r\n    }\r\n    /**\r\n     * Gets or sets the sprite that a particle should use\r\n     */\r\n    get particleSprite() {\r\n        return this._sprite;\r\n    }\r\n    set particleSprite(val) {\r\n        if (val) {\r\n            this._sprite = val;\r\n        }\r\n    }\r\n    removeParticle(particle) {\r\n        this.deadParticles.push(particle);\r\n    }\r\n    /**\r\n     * Causes the emitter to emit particles\r\n     * @param particleCount  Number of particles to emit right now\r\n     */\r\n    emitParticles(particleCount) {\r\n        var _a;\r\n        for (let i = 0; i < particleCount; i++) {\r\n            const p = this._createParticle();\r\n            this.particles.push(p);\r\n            if ((_a = this === null || this === void 0 ? void 0 : this.scene) === null || _a === void 0 ? void 0 : _a.world) {\r\n                this.scene.world.add(p);\r\n            }\r\n        }\r\n    }\r\n    clearParticles() {\r\n        this.particles.length = 0;\r\n    }\r\n    // Creates a new particle given the constraints of the emitter\r\n    _createParticle() {\r\n        // todo implement emitter constraints;\r\n        let ranX = 0;\r\n        let ranY = 0;\r\n        const angle = randomInRange(this.minAngle, this.maxAngle, this.random);\r\n        const vel = randomInRange(this.minVel, this.maxVel, this.random);\r\n        const size = this.startSize || randomInRange(this.minSize, this.maxSize, this.random);\r\n        const dx = vel * Math.cos(angle);\r\n        const dy = vel * Math.sin(angle);\r\n        if (this.emitterType === EmitterType.Rectangle) {\r\n            ranX = randomInRange(0, this.width, this.random);\r\n            ranY = randomInRange(0, this.height, this.random);\r\n        }\r\n        else if (this.emitterType === EmitterType.Circle) {\r\n            const radius = randomInRange(0, this.radius, this.random);\r\n            ranX = radius * Math.cos(angle);\r\n            ranY = radius * Math.sin(angle);\r\n        }\r\n        const p = new Particle(this, this.particleLife, this.opacity, this.beginColor, this.endColor, new Vector(ranX, ranY), new Vector(dx, dy), this.acceleration, this.startSize, this.endSize);\r\n        p.fadeFlag = this.fadeFlag;\r\n        p.particleSize = size;\r\n        if (this.particleSprite) {\r\n            p.particleSprite = this.particleSprite;\r\n            p.graphics.opacity = this.opacity;\r\n            p.graphics.use(this._sprite);\r\n        }\r\n        p.particleRotationalVelocity = this.particleRotationalVelocity;\r\n        if (this.randomRotation) {\r\n            p.currentRotation = randomInRange(0, Math.PI * 2, this.random);\r\n        }\r\n        if (this.focus) {\r\n            p.focus = this.focus.add(new Vector(this.pos.x, this.pos.y));\r\n            p.focusAccel = this.focusAccel;\r\n        }\r\n        return p;\r\n    }\r\n    update(engine, delta) {\r\n        var _a;\r\n        super.update(engine, delta);\r\n        if (this.isEmitting) {\r\n            this._particlesToEmit += this.emitRate * (delta / 1000);\r\n            if (this._particlesToEmit > 1.0) {\r\n                this.emitParticles(Math.floor(this._particlesToEmit));\r\n                this._particlesToEmit = this._particlesToEmit - Math.floor(this._particlesToEmit);\r\n            }\r\n        }\r\n        // deferred removal\r\n        for (let i = 0; i < this.deadParticles.length; i++) {\r\n            removeItemFromArray(this.deadParticles[i], this.particles);\r\n            if ((_a = this === null || this === void 0 ? void 0 : this.scene) === null || _a === void 0 ? void 0 : _a.world) {\r\n                this.scene.world.remove(this.deadParticles[i], false);\r\n            }\r\n        }\r\n        this.deadParticles.length = 0;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/GraphicsSystem.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass GraphicsSystem extends System {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.types = ['ex.transform', 'ex.graphics'];\r\n        this.systemType = SystemType.Draw;\r\n        this.priority = 0;\r\n        this._token = 0;\r\n        this._sortedTransforms = [];\r\n        this._zHasChanged = false;\r\n        this._zIndexUpdate = () => {\r\n            this._zHasChanged = true;\r\n        };\r\n    }\r\n    get sortedTransforms() {\r\n        return this._sortedTransforms;\r\n    }\r\n    initialize(scene) {\r\n        this._camera = scene.camera;\r\n        this._engine = scene.engine;\r\n    }\r\n    preupdate() {\r\n        // Graphics context could be switched to fallback in a new frame\r\n        this._graphicsContext = this._engine.graphicsContext;\r\n        if (this._zHasChanged) {\r\n            this._sortedTransforms.sort((a, b) => {\r\n                return a.z - b.z;\r\n            });\r\n            this._zHasChanged = false;\r\n        }\r\n    }\r\n    notify(entityAddedOrRemoved) {\r\n        if (isAddedSystemEntity(entityAddedOrRemoved)) {\r\n            const tx = entityAddedOrRemoved.data.get(TransformComponent);\r\n            this._sortedTransforms.push(tx);\r\n            tx.zIndexChanged$.subscribe(this._zIndexUpdate);\r\n            this._zHasChanged = true;\r\n        }\r\n        else {\r\n            const tx = entityAddedOrRemoved.data.get(TransformComponent);\r\n            tx.zIndexChanged$.unsubscribe(this._zIndexUpdate);\r\n            const index = this._sortedTransforms.indexOf(tx);\r\n            if (index > -1) {\r\n                this._sortedTransforms.splice(index, 1);\r\n            }\r\n        }\r\n    }\r\n    update(_entities, delta) {\r\n        this._token++;\r\n        let graphics;\r\n        // This is a performance enhancement, most things are in world space\r\n        // so if we can only do this once saves a ton of transform updates\r\n        this._graphicsContext.save();\r\n        if (this._camera) {\r\n            this._camera.draw(this._graphicsContext);\r\n        }\r\n        for (const transform of this._sortedTransforms) {\r\n            const entity = transform.owner;\r\n            // If the entity is offscreen skip\r\n            if (entity.hasTag('ex.offscreen')) {\r\n                continue;\r\n            }\r\n            graphics = entity.get(GraphicsComponent);\r\n            // Exit if graphics set to not visible\r\n            if (!graphics.visible) {\r\n                continue;\r\n            }\r\n            // This optionally sets our camera based on the entity coord plan (world vs. screen)\r\n            if (transform.coordPlane === CoordPlane.Screen) {\r\n                this._graphicsContext.restore();\r\n            }\r\n            this._graphicsContext.save();\r\n            // Tick any graphics state (but only once) for animations and graphics groups\r\n            graphics.update(delta, this._token);\r\n            // Apply parallax\r\n            const parallax = entity.get(ParallaxComponent);\r\n            if (parallax) {\r\n                // We use the Tiled formula\r\n                // https://doc.mapeditor.org/en/latest/manual/layers/#parallax-scrolling-factor\r\n                // cameraPos * (1 - parallaxFactor)\r\n                const oneMinusFactor = Vector.One.sub(parallax.parallaxFactor);\r\n                const parallaxOffset = this._camera.pos.scale(oneMinusFactor);\r\n                this._graphicsContext.translate(parallaxOffset.x, parallaxOffset.y);\r\n            }\r\n            // Position the entity + estimate lag\r\n            this._applyTransform(entity);\r\n            // Optionally run the onPreDraw graphics lifecycle draw\r\n            if (graphics.onPreDraw) {\r\n                graphics.onPreDraw(this._graphicsContext, delta);\r\n            }\r\n            // TODO remove this hack on the particle redo\r\n            const particleOpacity = (entity instanceof Particle) ? entity.opacity : 1;\r\n            this._graphicsContext.opacity = graphics.opacity * particleOpacity;\r\n            // Draw the graphics component\r\n            this._drawGraphicsComponent(graphics);\r\n            // Optionally run the onPostDraw graphics lifecycle draw\r\n            if (graphics.onPostDraw) {\r\n                graphics.onPostDraw(this._graphicsContext, delta);\r\n            }\r\n            this._graphicsContext.restore();\r\n            // Reset the transform back to the original world space\r\n            if (transform.coordPlane === CoordPlane.Screen) {\r\n                this._graphicsContext.save();\r\n                if (this._camera) {\r\n                    this._camera.draw(this._graphicsContext);\r\n                }\r\n            }\r\n        }\r\n        this._graphicsContext.restore();\r\n    }\r\n    _drawGraphicsComponent(graphicsComponent) {\r\n        var _a, _b;\r\n        if (graphicsComponent.visible) {\r\n            // this should be moved to the graphics system\r\n            for (const layer of graphicsComponent.layers.get()) {\r\n                for (const { graphic, options } of layer.graphics) {\r\n                    let anchor = graphicsComponent.anchor;\r\n                    let offset = graphicsComponent.offset;\r\n                    if (options === null || options === void 0 ? void 0 : options.anchor) {\r\n                        anchor = options.anchor;\r\n                    }\r\n                    if (options === null || options === void 0 ? void 0 : options.offset) {\r\n                        offset = options.offset;\r\n                    }\r\n                    // See https://github.com/excaliburjs/Excalibur/pull/619 for discussion on this formula\r\n                    const offsetX = -graphic.width * anchor.x + offset.x;\r\n                    const offsetY = -graphic.height * anchor.y + offset.y;\r\n                    graphic === null || graphic === void 0 ? void 0 : graphic.draw(this._graphicsContext, offsetX + layer.offset.x, offsetY + layer.offset.y);\r\n                    if (((_a = this._engine) === null || _a === void 0 ? void 0 : _a.isDebug) && this._engine.debug.graphics.showBounds) {\r\n                        const offset = vec(offsetX + layer.offset.x, offsetY + layer.offset.y);\r\n                        if (graphic instanceof GraphicsGroup) {\r\n                            for (const g of graphic.members) {\r\n                                (_b = g.graphic) === null || _b === void 0 ? void 0 : _b.localBounds.translate(offset.add(g.pos)).draw(this._graphicsContext, this._engine.debug.graphics.boundsColor);\r\n                            }\r\n                        }\r\n                        else {\r\n                            /* istanbul ignore next */\r\n                            graphic === null || graphic === void 0 ? void 0 : graphic.localBounds.translate(offset).draw(this._graphicsContext, this._engine.debug.graphics.boundsColor);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * This applies the current entity transform to the graphics context\r\n     * @param entity\r\n     */\r\n    _applyTransform(entity) {\r\n        const ancestors = entity.getAncestors();\r\n        for (const ancestor of ancestors) {\r\n            const transform = ancestor === null || ancestor === void 0 ? void 0 : ancestor.get(TransformComponent);\r\n            const optionalBody = ancestor === null || ancestor === void 0 ? void 0 : ancestor.get(BodyComponent);\r\n            let interpolatedPos = transform.pos;\r\n            let interpolatedScale = transform.scale;\r\n            let interpolatedRotation = transform.rotation;\r\n            if (optionalBody) {\r\n                if (this._engine.fixedUpdateFps &&\r\n                    optionalBody.__oldTransformCaptured &&\r\n                    optionalBody.enableFixedUpdateInterpolate) {\r\n                    // Interpolate graphics if needed\r\n                    const blend = this._engine.currentFrameLagMs / (1000 / this._engine.fixedUpdateFps);\r\n                    interpolatedPos = transform.pos.scale(blend).add(optionalBody.oldPos.scale(1.0 - blend));\r\n                    interpolatedScale = transform.scale.scale(blend).add(optionalBody.oldScale.scale(1.0 - blend));\r\n                    // Rotational lerp https://stackoverflow.com/a/30129248\r\n                    const cosine = (1.0 - blend) * Math.cos(optionalBody.oldRotation) + blend * Math.cos(transform.rotation);\r\n                    const sine = (1.0 - blend) * Math.sin(optionalBody.oldRotation) + blend * Math.sin(transform.rotation);\r\n                    interpolatedRotation = Math.atan2(sine, cosine);\r\n                }\r\n            }\r\n            if (transform) {\r\n                this._graphicsContext.z = transform.z;\r\n                this._graphicsContext.translate(interpolatedPos.x, interpolatedPos.y);\r\n                this._graphicsContext.scale(interpolatedScale.x, interpolatedScale.y);\r\n                this._graphicsContext.rotate(interpolatedRotation);\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Debug/DebugSystem.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass DebugSystem extends System {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.types = ['ex.transform'];\r\n        this.systemType = SystemType.Draw;\r\n        this.priority = 999; // lowest priority\r\n    }\r\n    initialize(scene) {\r\n        this._graphicsContext = scene.engine.graphicsContext;\r\n        this._camera = scene.camera;\r\n        this._engine = scene.engine;\r\n        this._collisionSystem = scene.world.systemManager.get(CollisionSystem);\r\n    }\r\n    update(entities, _delta) {\r\n        var _a;\r\n        if (!this._engine.isDebug) {\r\n            return;\r\n        }\r\n        const filterSettings = this._engine.debug.filter;\r\n        let id;\r\n        let name;\r\n        const entitySettings = this._engine.debug.entity;\r\n        let tx;\r\n        const txSettings = this._engine.debug.transform;\r\n        let motion;\r\n        const motionSettings = this._engine.debug.motion;\r\n        let colliderComp;\r\n        const colliderSettings = this._engine.debug.collider;\r\n        const physicsSettings = this._engine.debug.physics;\r\n        let graphics;\r\n        const graphicsSettings = this._engine.debug.graphics;\r\n        let debugDraw;\r\n        let body;\r\n        const bodySettings = this._engine.debug.body;\r\n        const cameraSettings = this._engine.debug.camera;\r\n        for (const entity of entities) {\r\n            if (entity.hasTag('offscreen')) {\r\n                // skip offscreen entities\r\n                continue;\r\n            }\r\n            if (entity instanceof Particle) {\r\n                // Particles crush the renderer :(\r\n                continue;\r\n            }\r\n            if (filterSettings.useFilter) {\r\n                const allIds = filterSettings.ids.length === 0;\r\n                const idMatch = allIds || filterSettings.ids.includes(entity.id);\r\n                if (!idMatch) {\r\n                    continue;\r\n                }\r\n                const allNames = filterSettings.nameQuery === '';\r\n                const nameMatch = allNames || entity.name.includes(filterSettings.nameQuery);\r\n                if (!nameMatch) {\r\n                    continue;\r\n                }\r\n            }\r\n            let cursor = Vector.Zero;\r\n            const lineHeight = vec(0, 16);\r\n            id = entity.id;\r\n            name = entity.name;\r\n            tx = entity.get(TransformComponent);\r\n            // This optionally sets our camera based on the entity coord plan (world vs. screen)\r\n            this._pushCameraTransform(tx);\r\n            this._graphicsContext.save();\r\n            this._applyTransform(entity);\r\n            if (tx) {\r\n                if (txSettings.showAll || txSettings.showPosition) {\r\n                    this._graphicsContext.debug.drawPoint(Vector.Zero, { size: 4, color: txSettings.positionColor });\r\n                }\r\n                if (txSettings.showAll || txSettings.showPositionLabel) {\r\n                    this._graphicsContext.debug.drawText(`pos${tx.pos.toString(2)}`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (txSettings.showAll || txSettings.showZIndex) {\r\n                    this._graphicsContext.debug.drawText(`z(${tx.z.toFixed(1)})`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (entitySettings.showAll || entitySettings.showId) {\r\n                    this._graphicsContext.debug.drawText(`id(${id}) ${entity.parent ? 'child of id(' + ((_a = entity.parent) === null || _a === void 0 ? void 0 : _a.id) + ')' : ''}`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (entitySettings.showAll || entitySettings.showName) {\r\n                    this._graphicsContext.debug.drawText(`name(${name})`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (txSettings.showAll || txSettings.showRotation) {\r\n                    this._graphicsContext.drawLine(Vector.Zero, Vector.fromAngle(tx.rotation).scale(50).add(Vector.Zero), txSettings.rotationColor, 2);\r\n                    this._graphicsContext.debug.drawText(`rot deg(${toDegrees(tx.rotation).toFixed(2)})`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (txSettings.showAll || txSettings.showScale) {\r\n                    this._graphicsContext.drawLine(Vector.Zero, tx.scale.add(Vector.Zero), txSettings.scaleColor, 2);\r\n                }\r\n            }\r\n            graphics = entity.get(GraphicsComponent);\r\n            if (graphics) {\r\n                if (graphicsSettings.showAll || graphicsSettings.showBounds) {\r\n                    const bounds = graphics.localBounds;\r\n                    bounds.draw(this._graphicsContext, graphicsSettings.boundsColor);\r\n                }\r\n            }\r\n            debugDraw = entity.get(DebugGraphicsComponent);\r\n            if (debugDraw) {\r\n                if (!debugDraw.useTransform) {\r\n                    this._graphicsContext.restore();\r\n                }\r\n                debugDraw.draw(this._graphicsContext);\r\n                if (!debugDraw.useTransform) {\r\n                    this._graphicsContext.save();\r\n                    this._applyTransform(entity);\r\n                }\r\n            }\r\n            body = entity.get(BodyComponent);\r\n            if (body) {\r\n                if (bodySettings.showAll || bodySettings.showCollisionGroup) {\r\n                    this._graphicsContext.debug.drawText(`collision group(${body.group.name})`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (bodySettings.showAll || bodySettings.showCollisionType) {\r\n                    this._graphicsContext.debug.drawText(`collision type(${body.collisionType})`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (bodySettings.showAll || bodySettings.showMass) {\r\n                    this._graphicsContext.debug.drawText(`mass(${body.mass})`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (bodySettings.showAll || bodySettings.showMotion) {\r\n                    this._graphicsContext.debug.drawText(`motion(${body.sleepMotion})`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (bodySettings.showAll || bodySettings.showSleeping) {\r\n                    this._graphicsContext.debug.drawText(`sleeping(${body.canSleep ? body.sleeping : 'cant sleep'})`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n            }\r\n            this._graphicsContext.restore();\r\n            motion = entity.get(MotionComponent);\r\n            if (motion) {\r\n                if (motionSettings.showAll || motionSettings.showVelocity) {\r\n                    this._graphicsContext.debug.drawText(`vel${motion.vel.toString(2)}`, cursor.add(tx.globalPos));\r\n                    this._graphicsContext.drawLine(tx.globalPos, tx.globalPos.add(motion.vel), motionSettings.velocityColor, 2);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (motionSettings.showAll || motionSettings.showAcceleration) {\r\n                    this._graphicsContext.drawLine(tx.globalPos, tx.globalPos.add(motion.acc), motionSettings.accelerationColor, 2);\r\n                }\r\n            }\r\n            // Colliders live in world space already so after the restore()\r\n            colliderComp = entity.get(ColliderComponent);\r\n            if (colliderComp) {\r\n                const collider = colliderComp.get();\r\n                if ((colliderSettings.showAll || colliderSettings.showGeometry) && collider) {\r\n                    collider.debug(this._graphicsContext, colliderSettings.geometryColor);\r\n                }\r\n                if (colliderSettings.showAll || colliderSettings.showBounds) {\r\n                    if (collider instanceof CompositeCollider) {\r\n                        const colliders = collider.getColliders();\r\n                        for (const collider of colliders) {\r\n                            const bounds = collider.bounds;\r\n                            const pos = vec(bounds.left, bounds.top);\r\n                            this._graphicsContext.debug.drawRect(pos.x, pos.y, bounds.width, bounds.height, { color: colliderSettings.boundsColor });\r\n                            if (colliderSettings.showAll || colliderSettings.showOwner) {\r\n                                this._graphicsContext.debug.drawText(`owner id(${collider.owner.id})`, pos);\r\n                            }\r\n                        }\r\n                        colliderComp.bounds.draw(this._graphicsContext, colliderSettings.boundsColor);\r\n                    }\r\n                    else if (collider) {\r\n                        const bounds = colliderComp.bounds;\r\n                        const pos = vec(bounds.left, bounds.top);\r\n                        this._graphicsContext.debug.drawRect(pos.x, pos.y, bounds.width, bounds.height, { color: colliderSettings.boundsColor });\r\n                        if (colliderSettings.showAll || colliderSettings.showOwner) {\r\n                            this._graphicsContext.debug.drawText(`owner id(${colliderComp.owner.id})`, pos);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            this._popCameraTransform(tx);\r\n        }\r\n        this._graphicsContext.save();\r\n        this._camera.draw(this._graphicsContext);\r\n        if (physicsSettings.showAll || physicsSettings.showBroadphaseSpacePartitionDebug) {\r\n            this._collisionSystem.debug(this._graphicsContext);\r\n        }\r\n        if (physicsSettings.showAll || physicsSettings.showCollisionContacts || physicsSettings.showCollisionNormals) {\r\n            for (const [_, contact] of this._engine.debug.stats.currFrame.physics.contacts) {\r\n                if (physicsSettings.showAll || physicsSettings.showCollisionContacts) {\r\n                    for (const point of contact.points) {\r\n                        this._graphicsContext.debug.drawPoint(point, { size: 5, color: physicsSettings.collisionContactColor });\r\n                    }\r\n                }\r\n                if (physicsSettings.showAll || physicsSettings.showCollisionNormals) {\r\n                    for (const point of contact.points) {\r\n                        this._graphicsContext.debug.drawLine(point, contact.normal.scale(30).add(point), {\r\n                            color: physicsSettings.collisionNormalColor\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        this._graphicsContext.restore();\r\n        if (cameraSettings) {\r\n            this._graphicsContext.save();\r\n            this._camera.draw(this._graphicsContext);\r\n            if (cameraSettings.showAll || cameraSettings.showFocus) {\r\n                this._graphicsContext.drawCircle(this._camera.pos, 4, cameraSettings.focusColor);\r\n            }\r\n            if (cameraSettings.showAll || cameraSettings.showZoom) {\r\n                this._graphicsContext.debug.drawText(`zoom(${this._camera.zoom})`, this._camera.pos);\r\n            }\r\n            this._graphicsContext.restore();\r\n        }\r\n        this._graphicsContext.flush();\r\n    }\r\n    /**\r\n     * This applies the current entity transform to the graphics context\r\n     * @param entity\r\n     */\r\n    _applyTransform(entity) {\r\n        const ancestors = entity.getAncestors();\r\n        for (const ancestor of ancestors) {\r\n            const transform = ancestor === null || ancestor === void 0 ? void 0 : ancestor.get(TransformComponent);\r\n            if (transform) {\r\n                this._graphicsContext.translate(transform.pos.x, transform.pos.y);\r\n                this._graphicsContext.scale(transform.scale.x, transform.scale.y);\r\n                this._graphicsContext.rotate(transform.rotation);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Applies the current camera transform if in world coordinates\r\n     * @param transform\r\n     */\r\n    _pushCameraTransform(transform) {\r\n        // Establish camera offset per entity\r\n        if (transform.coordPlane === CoordPlane.World) {\r\n            this._graphicsContext.save();\r\n            if (this._camera) {\r\n                this._camera.draw(this._graphicsContext);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Resets the current camera transform if in world coordinates\r\n     * @param transform\r\n     */\r\n    _popCameraTransform(transform) {\r\n        if (transform.coordPlane === CoordPlane.World) {\r\n            // Apply camera world offset\r\n            this._graphicsContext.restore();\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Input/PointerSystem.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * The PointerSystem is responsible for dispatching pointer events to entities\r\n * that need them.\r\n *\r\n * The PointerSystem can be optionally configured by the [[PointerComponent]], by default Entities use\r\n * the [[Collider]]'s shape for pointer events.\r\n */\r\nclass PointerSystem extends System {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.types = ['ex.transform', 'ex.pointer'];\r\n        this.systemType = SystemType.Update;\r\n        this.priority = -1;\r\n        /**\r\n         * Optionally override component configuration for all entities\r\n         */\r\n        this.overrideUseColliderShape = false;\r\n        /**\r\n         * Optionally override component configuration for all entities\r\n         */\r\n        this.overrideUseGraphicsBounds = false;\r\n        this.lastFrameEntityToPointers = new Map();\r\n        this.currentFrameEntityToPointers = new Map();\r\n        this._sortedTransforms = [];\r\n        this._sortedEntities = [];\r\n        this._zHasChanged = false;\r\n        this._zIndexUpdate = () => {\r\n            this._zHasChanged = true;\r\n        };\r\n    }\r\n    initialize(scene) {\r\n        this._engine = scene.engine;\r\n    }\r\n    preupdate() {\r\n        // event receiver might change per frame\r\n        this._receiver = this._engine.input.pointers;\r\n        if (this._zHasChanged) {\r\n            this._sortedTransforms.sort((a, b) => {\r\n                return b.z - a.z;\r\n            });\r\n            this._sortedEntities = this._sortedTransforms.map(t => t.owner);\r\n            this._zHasChanged = false;\r\n        }\r\n    }\r\n    notify(entityAddedOrRemoved) {\r\n        if (isAddedSystemEntity(entityAddedOrRemoved)) {\r\n            const tx = entityAddedOrRemoved.data.get(TransformComponent);\r\n            this._sortedTransforms.push(tx);\r\n            this._sortedEntities.push(tx.owner);\r\n            tx.zIndexChanged$.subscribe(this._zIndexUpdate);\r\n            this._zHasChanged = true;\r\n        }\r\n        else {\r\n            const tx = entityAddedOrRemoved.data.get(TransformComponent);\r\n            tx.zIndexChanged$.unsubscribe(this._zIndexUpdate);\r\n            const index = this._sortedTransforms.indexOf(tx);\r\n            if (index > -1) {\r\n                this._sortedTransforms.splice(index, 1);\r\n                this._sortedEntities.splice(index, 1);\r\n            }\r\n        }\r\n    }\r\n    entityCurrentlyUnderPointer(entity, pointerId) {\r\n        return this.currentFrameEntityToPointers.has(entity.id) &&\r\n            this.currentFrameEntityToPointers.get(entity.id).includes(pointerId);\r\n    }\r\n    entityWasUnderPointer(entity, pointerId) {\r\n        return this.lastFrameEntityToPointers.has(entity.id) &&\r\n            this.lastFrameEntityToPointers.get(entity.id).includes(pointerId);\r\n    }\r\n    entered(entity, pointerId) {\r\n        return this.entityCurrentlyUnderPointer(entity, pointerId) &&\r\n            !this.lastFrameEntityToPointers.has(entity.id);\r\n    }\r\n    left(entity, pointerId) {\r\n        return !this.currentFrameEntityToPointers.has(entity.id) &&\r\n            this.entityWasUnderPointer(entity, pointerId);\r\n    }\r\n    addPointerToEntity(entity, pointerId) {\r\n        if (!this.currentFrameEntityToPointers.has(entity.id)) {\r\n            this.currentFrameEntityToPointers.set(entity.id, [pointerId]);\r\n            return;\r\n        }\r\n        const pointers = this.currentFrameEntityToPointers.get(entity.id);\r\n        this.currentFrameEntityToPointers.set(entity.id, pointers.concat(pointerId));\r\n    }\r\n    update(_entities) {\r\n        // Locate all the pointer/entity mappings\r\n        this._processPointerToEntity(this._sortedEntities);\r\n        // Dispatch pointer events on entities\r\n        this._dispatchEvents(this._sortedEntities);\r\n        // Clear last frame's events\r\n        this._receiver.update();\r\n        this.lastFrameEntityToPointers.clear();\r\n        this.lastFrameEntityToPointers = new Map(this.currentFrameEntityToPointers);\r\n        this.currentFrameEntityToPointers.clear();\r\n        this._receiver.clear();\r\n    }\r\n    _processPointerToEntity(entities) {\r\n        var _a;\r\n        let transform;\r\n        let collider;\r\n        let graphics;\r\n        let pointer;\r\n        // TODO probably a spatial partition optimization here to quickly query bounds for pointer\r\n        // doesn't seem to cause issues tho for perf\r\n        // Pre-process find entities under pointers\r\n        for (const entity of entities) {\r\n            transform = entity.get(TransformComponent);\r\n            pointer = (_a = entity.get(PointerComponent)) !== null && _a !== void 0 ? _a : new PointerComponent;\r\n            // Check collider contains pointer\r\n            collider = entity.get(ColliderComponent);\r\n            if (collider && (pointer.useColliderShape || this.overrideUseColliderShape)) {\r\n                collider.update();\r\n                const geom = collider.get();\r\n                if (geom) {\r\n                    for (const [pointerId, pos] of this._receiver.currentFramePointerCoords.entries()) {\r\n                        if (geom.contains(transform.coordPlane === CoordPlane.World ? pos.worldPos : pos.screenPos)) {\r\n                            this.addPointerToEntity(entity, pointerId);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            // Check graphics contains pointer\r\n            graphics = entity.get(GraphicsComponent);\r\n            if (graphics && (pointer.useGraphicsBounds || this.overrideUseGraphicsBounds)) {\r\n                const graphicBounds = graphics.localBounds.transform(transform.get().matrix);\r\n                for (const [pointerId, pos] of this._receiver.currentFramePointerCoords.entries()) {\r\n                    if (graphicBounds.contains(transform.coordPlane === CoordPlane.World ? pos.worldPos : pos.screenPos)) {\r\n                        this.addPointerToEntity(entity, pointerId);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    _processDownAndEmit(entity) {\r\n        const lastDownPerPointer = new Map();\r\n        // Loop through down and dispatch to entities\r\n        for (const event of this._receiver.currentFrameDown) {\r\n            if (event.active && entity.active && this.entityCurrentlyUnderPointer(entity, event.pointerId)) {\r\n                entity.events.emit('pointerdown', event);\r\n                if (this._receiver.isDragStart(event.pointerId)) {\r\n                    entity.events.emit('pointerdragstart', event);\r\n                }\r\n            }\r\n            lastDownPerPointer.set(event.pointerId, event);\r\n        }\r\n        return lastDownPerPointer;\r\n    }\r\n    _processUpAndEmit(entity) {\r\n        const lastUpPerPointer = new Map();\r\n        // Loop through up and dispatch to entities\r\n        for (const event of this._receiver.currentFrameUp) {\r\n            if (event.active && entity.active && this.entityCurrentlyUnderPointer(entity, event.pointerId)) {\r\n                entity.events.emit('pointerup', event);\r\n                if (this._receiver.isDragEnd(event.pointerId)) {\r\n                    entity.events.emit('pointerdragend', event);\r\n                }\r\n            }\r\n            lastUpPerPointer.set(event.pointerId, event);\r\n        }\r\n        return lastUpPerPointer;\r\n    }\r\n    _processMoveAndEmit(entity) {\r\n        const lastMovePerPointer = new Map();\r\n        // Loop through move and dispatch to entities\r\n        for (const event of this._receiver.currentFrameMove) {\r\n            if (event.active && entity.active && this.entityCurrentlyUnderPointer(entity, event.pointerId)) {\r\n                // move\r\n                entity.events.emit('pointermove', event);\r\n                if (this._receiver.isDragging(event.pointerId)) {\r\n                    entity.events.emit('pointerdragmove', event);\r\n                }\r\n            }\r\n            lastMovePerPointer.set(event.pointerId, event);\r\n        }\r\n        return lastMovePerPointer;\r\n    }\r\n    _processEnterLeaveAndEmit(entity, lastUpDownMoveEvents) {\r\n        // up, down, and move are considered for enter and leave\r\n        for (const event of lastUpDownMoveEvents) {\r\n            // enter\r\n            if (event.active && entity.active && this.entered(entity, event.pointerId)) {\r\n                entity.events.emit('pointerenter', event);\r\n                if (this._receiver.isDragging(event.pointerId)) {\r\n                    entity.events.emit('pointerdragenter', event);\r\n                }\r\n                break;\r\n            }\r\n            if (event.active && entity.active &&\r\n                // leave can happen on move\r\n                (this.left(entity, event.pointerId) ||\r\n                    // or leave can happen on pointer up\r\n                    (this.entityCurrentlyUnderPointer(entity, event.pointerId) && event.type === 'up'))) {\r\n                entity.events.emit('pointerleave', event);\r\n                if (this._receiver.isDragging(event.pointerId)) {\r\n                    entity.events.emit('pointerdragleave', event);\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    _processCancelAndEmit(entity) {\r\n        // cancel\r\n        for (const event of this._receiver.currentFrameCancel) {\r\n            if (event.active && entity.active && this.entityCurrentlyUnderPointer(entity, event.pointerId)) {\r\n                entity.events.emit('pointercancel', event);\r\n            }\r\n        }\r\n    }\r\n    _processWheelAndEmit(entity) {\r\n        // wheel\r\n        for (const event of this._receiver.currentFrameWheel) {\r\n            // Currently the wheel only fires under the primary pointer '0'\r\n            if (event.active && entity.active && this.entityCurrentlyUnderPointer(entity, 0)) {\r\n                entity.events.emit('pointerwheel', event);\r\n            }\r\n        }\r\n    }\r\n    _dispatchEvents(entities) {\r\n        const lastFrameEntities = new Set(this.lastFrameEntityToPointers.keys());\r\n        const currentFrameEntities = new Set(this.currentFrameEntityToPointers.keys());\r\n        // Filter preserves z order\r\n        const entitiesWithEvents = entities.filter(e => lastFrameEntities.has(e.id) || currentFrameEntities.has(e.id));\r\n        let lastMovePerPointer;\r\n        let lastUpPerPointer;\r\n        let lastDownPerPointer;\r\n        // Dispatch events in entity z order\r\n        for (const entity of entitiesWithEvents) {\r\n            lastDownPerPointer = this._processDownAndEmit(entity);\r\n            lastUpPerPointer = this._processUpAndEmit(entity);\r\n            lastMovePerPointer = this._processMoveAndEmit(entity);\r\n            const lastUpDownMoveEvents = [\r\n                ...lastMovePerPointer.values(),\r\n                ...lastDownPerPointer.values(),\r\n                ...lastUpPerPointer.values()\r\n            ];\r\n            this._processEnterLeaveAndEmit(entity, lastUpDownMoveEvents);\r\n            this._processCancelAndEmit(entity);\r\n            this._processWheelAndEmit(entity);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/ActionsSystem.ts\n\r\n\r\nclass ActionsSystem extends System {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.types = ['ex.actions'];\r\n        this.systemType = SystemType.Update;\r\n        this.priority = -1;\r\n        this._actions = [];\r\n    }\r\n    notify(entityAddedOrRemoved) {\r\n        if (isAddedSystemEntity(entityAddedOrRemoved)) {\r\n            const action = entityAddedOrRemoved.data.get(ActionsComponent);\r\n            this._actions.push(action);\r\n        }\r\n        else {\r\n            const action = entityAddedOrRemoved.data.get(ActionsComponent);\r\n            const index = this._actions.indexOf(action);\r\n            if (index > -1) {\r\n                this._actions.splice(index, 1);\r\n            }\r\n        }\r\n    }\r\n    update(_entities, delta) {\r\n        for (const actions of this._actions) {\r\n            actions.update(delta);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./TileMap/IsometricEntityComponent.ts\n\r\nclass IsometricEntityComponent extends Component {\r\n    /**\r\n     * Specify the isometric map to use to position this entity's z-index\r\n     * @param map\r\n     */\r\n    constructor(map) {\r\n        super();\r\n        this.type = 'ex.isometricentity';\r\n        /**\r\n         * Vertical \"height\" in the isometric world\r\n         */\r\n        this.elevation = 0;\r\n        this.map = map;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./TileMap/IsometricEntitySystem.ts\n\r\n\r\n\r\nclass IsometricEntitySystem extends System {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.types = ['ex.transform', 'ex.isometricentity'];\r\n        this.systemType = SystemType.Update;\r\n        this.priority = 99;\r\n    }\r\n    update(entities, _delta) {\r\n        let transform;\r\n        let iso;\r\n        for (const entity of entities) {\r\n            transform = entity.get(TransformComponent);\r\n            iso = entity.get(IsometricEntityComponent);\r\n            const maxZindexPerElevation = Math.max(iso.map.columns * iso.map.tileWidth, iso.map.rows * iso.map.tileHeight);\r\n            const newZ = maxZindexPerElevation * iso.elevation + transform.pos.y;\r\n            transform.z = newZ;\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/OffscreenSystem.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass OffscreenSystem extends System {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.types = ['ex.transform', 'ex.graphics'];\r\n        this.systemType = SystemType.Draw;\r\n        this.priority = -1;\r\n    }\r\n    initialize(scene) {\r\n        this._camera = scene.camera;\r\n    }\r\n    update(entities) {\r\n        let transform;\r\n        let graphics;\r\n        let maybeParallax;\r\n        for (const entity of entities) {\r\n            graphics = entity.get(GraphicsComponent);\r\n            transform = entity.get(TransformComponent);\r\n            maybeParallax = entity.get(ParallaxComponent);\r\n            let parallaxOffset;\r\n            if (maybeParallax) {\r\n                // We use the Tiled formula\r\n                // https://doc.mapeditor.org/en/latest/manual/layers/#parallax-scrolling-factor\r\n                // cameraPos * (1 - parallaxFactor)\r\n                const oneMinusFactor = Vector.One.sub(maybeParallax.parallaxFactor);\r\n                parallaxOffset = this._camera.pos.scale(oneMinusFactor);\r\n            }\r\n            // Figure out if entities are offscreen\r\n            const entityOffscreen = this._isOffscreen(transform, graphics, parallaxOffset);\r\n            if (entityOffscreen && !entity.hasTag('ex.offscreen')) {\r\n                entity.eventDispatcher.emit('exitviewport', new ExitViewPortEvent(entity));\r\n                entity.addTag('ex.offscreen');\r\n            }\r\n            if (!entityOffscreen && entity.hasTag('ex.offscreen')) {\r\n                entity.eventDispatcher.emit('enterviewport', new EnterViewPortEvent(entity));\r\n                entity.removeTag('ex.offscreen');\r\n            }\r\n        }\r\n    }\r\n    _isOffscreen(transform, graphics, parallaxOffset) {\r\n        if (transform.coordPlane === CoordPlane.World) {\r\n            let bounds = graphics.localBounds;\r\n            if (parallaxOffset) {\r\n                bounds = bounds.translate(parallaxOffset);\r\n            }\r\n            const transformedBounds = bounds.transform(transform.get().matrix);\r\n            const graphicsOffscreen = !this._camera.viewport.overlaps(transformedBounds);\r\n            return graphicsOffscreen;\r\n        }\r\n        else {\r\n            // TODO screen coordinates\r\n            return false;\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Scene.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * [[Actor|Actors]] are composed together into groupings called Scenes in\r\n * Excalibur. The metaphor models the same idea behind real world\r\n * actors in a scene. Only actors in scenes will be updated and drawn.\r\n *\r\n * Typical usages of a scene include: levels, menus, loading screens, etc.\r\n */\r\nclass Scene extends Class {\r\n    constructor() {\r\n        super();\r\n        this._logger = Logger.getInstance();\r\n        /**\r\n         * Gets or sets the current camera for the scene\r\n         */\r\n        this.camera = new Camera();\r\n        /**\r\n         * The ECS world for the scene\r\n         */\r\n        this.world = new World(this);\r\n        this._isInitialized = false;\r\n        this._timers = [];\r\n        this._cancelQueue = [];\r\n        // Initialize systems\r\n        // Update\r\n        this.world.add(new ActionsSystem());\r\n        this.world.add(new MotionSystem());\r\n        this.world.add(new CollisionSystem());\r\n        this.world.add(new PointerSystem());\r\n        this.world.add(new IsometricEntitySystem());\r\n        // Draw\r\n        this.world.add(new OffscreenSystem());\r\n        this.world.add(new GraphicsSystem());\r\n        this.world.add(new DebugSystem());\r\n    }\r\n    /**\r\n     * The actors in the current scene\r\n     */\r\n    get actors() {\r\n        return this.world.entityManager.entities.filter((e) => {\r\n            return e instanceof Actor;\r\n        });\r\n    }\r\n    /**\r\n     * The entities in the current scene\r\n     */\r\n    get entities() {\r\n        return this.world.entityManager.entities;\r\n    }\r\n    /**\r\n     * The triggers in the current scene\r\n     */\r\n    get triggers() {\r\n        return this.world.entityManager.entities.filter((e) => {\r\n            return e instanceof Trigger;\r\n        });\r\n    }\r\n    /**\r\n     * The [[TileMap]]s in the scene, if any\r\n     */\r\n    get tileMaps() {\r\n        return this.world.entityManager.entities.filter((e) => {\r\n            return e instanceof TileMap;\r\n        });\r\n    }\r\n    get timers() {\r\n        return this._timers;\r\n    }\r\n    on(eventName, handler) {\r\n        super.on(eventName, handler);\r\n    }\r\n    once(eventName, handler) {\r\n        super.once(eventName, handler);\r\n    }\r\n    off(eventName, handler) {\r\n        super.off(eventName, handler);\r\n    }\r\n    /**\r\n     * This is called before the first update of the [[Scene]]. Initializes scene members like the camera. This method is meant to be\r\n     * overridden. This is where initialization of child actors should take place.\r\n     */\r\n    onInitialize(_engine) {\r\n        // will be overridden\r\n    }\r\n    /**\r\n     * This is called when the scene is made active and started. It is meant to be overridden,\r\n     * this is where you should setup any DOM UI or event handlers needed for the scene.\r\n     */\r\n    onActivate(_context) {\r\n        // will be overridden\r\n    }\r\n    /**\r\n     * This is called when the scene is made transitioned away from and stopped. It is meant to be overridden,\r\n     * this is where you should cleanup any DOM UI or event handlers needed for the scene.\r\n     */\r\n    onDeactivate(_context) {\r\n        // will be overridden\r\n    }\r\n    /**\r\n     * Safe to override onPreUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPreUpdate` is called directly before a scene is updated.\r\n     */\r\n    onPreUpdate(_engine, _delta) {\r\n        // will be overridden\r\n    }\r\n    /**\r\n     * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPostUpdate` is called directly after a scene is updated.\r\n     */\r\n    onPostUpdate(_engine, _delta) {\r\n        // will be overridden\r\n    }\r\n    /**\r\n     * Safe to override onPreDraw lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPreDraw` is called directly before a scene is drawn.\r\n     *\r\n     */\r\n    onPreDraw(_ctx, _delta) {\r\n        // will be overridden\r\n    }\r\n    /**\r\n     * Safe to override onPostDraw lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPostDraw` is called directly after a scene is drawn.\r\n     *\r\n     */\r\n    onPostDraw(_ctx, _delta) {\r\n        // will be overridden\r\n    }\r\n    /**\r\n     * Initializes actors in the scene\r\n     */\r\n    _initializeChildren() {\r\n        for (const child of this.entities) {\r\n            child._initialize(this.engine);\r\n        }\r\n    }\r\n    /**\r\n     * Gets whether or not the [[Scene]] has been initialized\r\n     */\r\n    get isInitialized() {\r\n        return this._isInitialized;\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Initializes the scene before the first update, meant to be called by engine not by users of\r\n     * Excalibur\r\n     * @internal\r\n     */\r\n    _initialize(engine) {\r\n        if (!this.isInitialized) {\r\n            this.engine = engine;\r\n            // Initialize camera first\r\n            this.camera._initialize(engine);\r\n            this.world.systemManager.initialize();\r\n            // This order is important! we want to be sure any custom init that add actors\r\n            // fire before the actor init\r\n            this.onInitialize.call(this, engine);\r\n            this._initializeChildren();\r\n            this._logger.debug('Scene.onInitialize', this, engine);\r\n            this.eventDispatcher.emit('initialize', new InitializeEvent(engine, this));\r\n            this._isInitialized = true;\r\n        }\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Activates the scene with the base behavior, then calls the overridable `onActivate` implementation.\r\n     * @internal\r\n     */\r\n    _activate(context) {\r\n        this._logger.debug('Scene.onActivate', this);\r\n        this.onActivate(context);\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Deactivates the scene with the base behavior, then calls the overridable `onDeactivate` implementation.\r\n     * @internal\r\n     */\r\n    _deactivate(context) {\r\n        this._logger.debug('Scene.onDeactivate', this);\r\n        this.onDeactivate(context);\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPreUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _preupdate(_engine, delta) {\r\n        this.emit('preupdate', new PreUpdateEvent(_engine, delta, this));\r\n        this.onPreUpdate(_engine, delta);\r\n    }\r\n    /**\r\n     *  It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPostUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _postupdate(_engine, delta) {\r\n        this.emit('postupdate', new PostUpdateEvent(_engine, delta, this));\r\n        this.onPostUpdate(_engine, delta);\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _predraw handler for [[onPreDraw]] lifecycle event\r\n     *\r\n     * @internal\r\n     */\r\n    _predraw(_ctx, _delta) {\r\n        this.emit('predraw', new PreDrawEvent(_ctx, _delta, this));\r\n        this.onPreDraw(_ctx, _delta);\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _postdraw handler for [[onPostDraw]] lifecycle event\r\n     *\r\n     * @internal\r\n     */\r\n    _postdraw(_ctx, _delta) {\r\n        this.emit('postdraw', new PostDrawEvent(_ctx, _delta, this));\r\n        this.onPostDraw(_ctx, _delta);\r\n    }\r\n    /**\r\n     * Updates all the actors and timers in the scene. Called by the [[Engine]].\r\n     * @param engine  Reference to the current Engine\r\n     * @param delta   The number of milliseconds since the last update\r\n     */\r\n    update(engine, delta) {\r\n        this._preupdate(engine, delta);\r\n        // TODO differed entity removal for timers\r\n        let i, len;\r\n        // Remove timers in the cancel queue before updating them\r\n        for (i = 0, len = this._cancelQueue.length; i < len; i++) {\r\n            this.removeTimer(this._cancelQueue[i]);\r\n        }\r\n        this._cancelQueue.length = 0;\r\n        // Cycle through timers updating timers\r\n        for (const timer of this._timers) {\r\n            timer.update(delta);\r\n        }\r\n        this.world.update(SystemType.Update, delta);\r\n        // Camera last keeps renders smooth that are based on entity/actor\r\n        if (this.camera) {\r\n            this.camera.update(engine, delta);\r\n        }\r\n        this._collectActorStats(engine);\r\n        this._postupdate(engine, delta);\r\n    }\r\n    /**\r\n     * Draws all the actors in the Scene. Called by the [[Engine]].\r\n     *\r\n     * @param ctx    The current rendering context\r\n     * @param delta  The number of milliseconds since the last draw\r\n     */\r\n    draw(ctx, delta) {\r\n        var _a;\r\n        this._predraw(ctx, delta);\r\n        this.world.update(SystemType.Draw, delta);\r\n        if ((_a = this.engine) === null || _a === void 0 ? void 0 : _a.isDebug) {\r\n            this.debugDraw(ctx);\r\n        }\r\n        this._postdraw(ctx, delta);\r\n    }\r\n    /**\r\n     * Draws all the actors' debug information in the Scene. Called by the [[Engine]].\r\n     * @param ctx  The current rendering context\r\n     */\r\n    /* istanbul ignore next */\r\n    debugDraw(ctx) {\r\n        this.emit('predebugdraw', new PreDebugDrawEvent(ctx, this));\r\n        // pass\r\n        this.emit('postdebugdraw', new PostDebugDrawEvent(ctx, this));\r\n    }\r\n    /**\r\n     * Checks whether an actor is contained in this scene or not\r\n     */\r\n    contains(actor) {\r\n        return this.actors.indexOf(actor) > -1;\r\n    }\r\n    add(entity) {\r\n        this.emit('entityadded', { target: entity });\r\n        this.world.add(entity);\r\n        entity.scene = this;\r\n        if (entity instanceof Timer) {\r\n            if (!contains(this._timers, entity)) {\r\n                this.addTimer(entity);\r\n            }\r\n            return;\r\n        }\r\n    }\r\n    remove(entity) {\r\n        if (entity instanceof Entity) {\r\n            this.emit('entityremoved', { target: entity });\r\n            this.world.remove(entity);\r\n        }\r\n        if (entity instanceof Timer) {\r\n            this.removeTimer(entity);\r\n        }\r\n    }\r\n    /**\r\n     * Removes all entities and timers from the scene, optionally indicate whether deferred should or shouldn't be used.\r\n     *\r\n     * By default entities use deferred removal\r\n     * @param deferred\r\n     */\r\n    clear(deferred = true) {\r\n        for (const entity of this.entities) {\r\n            this.world.remove(entity, deferred);\r\n        }\r\n        for (const timer of this.timers) {\r\n            this.removeTimer(timer);\r\n        }\r\n    }\r\n    /**\r\n     * Adds a [[Timer]] to the scene\r\n     * @param timer  The timer to add\r\n     */\r\n    addTimer(timer) {\r\n        this._timers.push(timer);\r\n        timer.scene = this;\r\n        return timer;\r\n    }\r\n    /**\r\n     * Removes a [[Timer]] from the scene.\r\n     * @warning Can be dangerous, use [[cancelTimer]] instead\r\n     * @param timer  The timer to remove\r\n     */\r\n    removeTimer(timer) {\r\n        const i = this._timers.indexOf(timer);\r\n        if (i !== -1) {\r\n            this._timers.splice(i, 1);\r\n        }\r\n        return timer;\r\n    }\r\n    /**\r\n     * Cancels a [[Timer]], removing it from the scene nicely\r\n     * @param timer  The timer to cancel\r\n     */\r\n    cancelTimer(timer) {\r\n        this._cancelQueue.push(timer);\r\n        return timer;\r\n    }\r\n    /**\r\n     * Tests whether a [[Timer]] is active in the scene\r\n     */\r\n    isTimerActive(timer) {\r\n        return this._timers.indexOf(timer) > -1 && !timer.complete;\r\n    }\r\n    isCurrentScene() {\r\n        if (this.engine) {\r\n            return this.engine.currentScene === this;\r\n        }\r\n        return false;\r\n    }\r\n    _collectActorStats(engine) {\r\n        const screenElements = this.actors.filter((a) => a instanceof ScreenElement);\r\n        for (const _ui of screenElements) {\r\n            engine.stats.currFrame.actors.ui++;\r\n        }\r\n        for (const actor of this.actors) {\r\n            engine.stats.currFrame.actors.alive++;\r\n            for (const child of actor.children) {\r\n                if (isScreenElement(child)) {\r\n                    // TODO not true\r\n                    engine.stats.currFrame.actors.ui++;\r\n                }\r\n                else {\r\n                    engine.stats.currFrame.actors.alive++;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/PostProcessor/ColorBlindnessMode.ts\nvar ColorBlindnessMode;\r\n(function (ColorBlindnessMode) {\r\n    ColorBlindnessMode[\"Protanope\"] = \"Protanope\";\r\n    ColorBlindnessMode[\"Deuteranope\"] = \"Deuteranope\";\r\n    ColorBlindnessMode[\"Tritanope\"] = \"Tritanope\";\r\n})(ColorBlindnessMode || (ColorBlindnessMode = {}));\r\n\n;// CONCATENATED MODULE: ./Graphics/PostProcessor/color-blind-fragment.glsl\n/* harmony default export */ const color_blind_fragment = (\"#version 300 es\\r\\nprecision mediump float;\\r\\n// our texture\\r\\nuniform sampler2D u_image;\\r\\n// the texCoords passed in from the vertex shader.\\r\\nin vec2 v_texcoord;\\r\\n\\r\\n// color blind type\\r\\nuniform int u_type;\\r\\n\\r\\n// simulation?\\r\\nuniform bool u_simulate;\\r\\n\\r\\nout vec4 fragColor;\\r\\n\\r\\nvoid main() {\\r\\n  vec4 o =  texture(u_image, v_texcoord);\\r\\n  // RGB to LMS matrix conversion\\r\\n  float L = (17.8824 * o.r) + (43.5161 * o.g) + (4.11935 * o.b);\\r\\n  float M = (3.45565 * o.r) + (27.1554 * o.g) + (3.86714 * o.b);\\r\\n  float S = (0.0299566 * o.r) + (0.184309 * o.g) + (1.46709 * o.b);\\r\\n  // Simulate color blindness\\r\\n  float l;\\r\\n  float m;\\r\\n  float s;\\r\\n  //MODE CODE//\\r\\n  if (u_type == 0) {\\r\\n    // Protanope\\r\\n    l = 0.0 * L + 2.02344 * M + -2.52581 * S;\\r\\n    m = 0.0 * L + 1.0 * M + 0.0 * S;\\r\\n    s = 0.0 * L + 0.0 * M + 1.0 * S;;\\r\\n  } else if (u_type == 1) {\\r\\n    // Deuteranope\\r\\n    l = 1.0 * L + 0.0 * M + 0.0 * S;\\r\\n    m = 0.494207 * L + 0.0 * M + 1.24827 * S;\\r\\n    s = 0.0 * L + 0.0 * M + 1.0 * S;\\r\\n  } else if (u_type == 2) {\\r\\n    // Tritanope\\r\\n    l = 1.0 * L + 0.0 * M + 0.0 * S;\\r\\n    m = 0.0 * L + 1.0 * M + 0.0 * S;\\r\\n    s = -0.395913 * L + 0.801109 * M + 0.0 * S;\\r\\n  }\\r\\n\\r\\n  // LMS to RGB matrix conversion\\r\\n  vec4 error; // simulate the colors\\r\\n  error.r = (0.0809444479 * l) + (-0.130504409 * m) + (0.116721066 * s);\\r\\n  error.g = (-0.0102485335 * l) + (0.0540193266 * m) + (-0.113614708 * s);\\r\\n  error.b = (-0.000365296938 * l) + (-0.00412161469 * m) + (0.693511405 * s);\\r\\n  error.a = 1.0;\\r\\n  vec4 diff = o - error;\\r\\n  vec4 correction; // correct the colors\\r\\n  correction.r = 0.0;\\r\\n  correction.g =  (diff.r * 0.7) + (diff.g * 1.0);\\r\\n  correction.b =  (diff.r * 0.7) + (diff.b * 1.0);\\r\\n  correction = o + correction;\\r\\n  correction.a = o.a;\\r\\n  //SIMULATE//\\r\\n\\r\\n  // sim \\r\\n  if (u_simulate) {\\r\\n    fragColor = error.rgba;\\r\\n  } else {\\r\\n    fragColor = correction.rgba;\\r\\n  }\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/PostProcessor/ScreenShader.ts\n\r\n\r\n\r\n/**\r\n * Helper that defines a whole screen renderer, just provide a fragment source!\r\n *\r\n * Currently supports 1 varying\r\n * - vec2 a_texcoord between 0-1 which corresponds to screen position\r\n */\r\nclass ScreenShader {\r\n    constructor(fragmentSource) {\r\n        this._shader = new Shader({\r\n            vertexSource: `#version 300 es\r\n      in vec2 a_position;\r\n      in vec2 a_texcoord;\r\n      out vec2 v_texcoord;\r\n\r\n      void main() {\r\n        gl_Position = vec4(a_position, 0.0, 1.0);\r\n        // Pass the texcoord to the fragment shader.\r\n        v_texcoord = a_texcoord;\r\n      }`,\r\n            fragmentSource: fragmentSource\r\n        });\r\n        this._shader.compile();\r\n        // Setup memory layout\r\n        this._buffer = new VertexBuffer({\r\n            type: 'static',\r\n            // clip space quad + uv since we don't need a camera\r\n            data: new Float32Array([\r\n                -1, -1, 0, 0,\r\n                -1, 1, 0, 1,\r\n                1, -1, 1, 0,\r\n                1, -1, 1, 0,\r\n                -1, 1, 0, 1,\r\n                1, 1, 1, 1\r\n            ])\r\n        });\r\n        this._layout = new VertexLayout({\r\n            shader: this._shader,\r\n            vertexBuffer: this._buffer,\r\n            attributes: [\r\n                ['a_position', 2],\r\n                ['a_texcoord', 2]\r\n            ]\r\n        });\r\n        this._buffer.upload();\r\n    }\r\n    getShader() {\r\n        return this._shader;\r\n    }\r\n    getLayout() {\r\n        return this._layout;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/PostProcessor/ColorBlindnessPostProcessor.ts\n\r\n\r\n\r\nclass ColorBlindnessPostProcessor {\r\n    constructor(_colorBlindnessMode, simulate = false) {\r\n        this._colorBlindnessMode = _colorBlindnessMode;\r\n        this._simulate = false;\r\n        this._simulate = simulate;\r\n    }\r\n    initialize(_gl) {\r\n        this._shader = new ScreenShader(color_blind_fragment);\r\n        this.simulate = this._simulate;\r\n        this.colorBlindnessMode = this._colorBlindnessMode;\r\n    }\r\n    getShader() {\r\n        return this._shader.getShader();\r\n    }\r\n    getLayout() {\r\n        return this._shader.getLayout();\r\n    }\r\n    set colorBlindnessMode(colorBlindMode) {\r\n        this._colorBlindnessMode = colorBlindMode;\r\n        if (this._shader) {\r\n            const shader = this._shader.getShader();\r\n            shader.use();\r\n            if (this._colorBlindnessMode === ColorBlindnessMode.Protanope) {\r\n                shader.setUniformInt('u_type', 0);\r\n            }\r\n            else if (this._colorBlindnessMode === ColorBlindnessMode.Deuteranope) {\r\n                shader.setUniformInt('u_type', 1);\r\n            }\r\n            else if (this._colorBlindnessMode === ColorBlindnessMode.Tritanope) {\r\n                shader.setUniformInt('u_type', 2);\r\n            }\r\n        }\r\n    }\r\n    get colorBlindnessMode() {\r\n        return this._colorBlindnessMode;\r\n    }\r\n    set simulate(value) {\r\n        this._simulate = value;\r\n        if (this._shader) {\r\n            const shader = this._shader.getShader();\r\n            shader.use();\r\n            shader.setUniformBoolean('u_simulate', value);\r\n        }\r\n    }\r\n    get simulate() {\r\n        return this._simulate;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Debug/DebugFlags.ts\n\r\n\r\n\r\nclass ColorBlindFlags {\r\n    constructor(engine) {\r\n        this._engine = engine;\r\n        this._colorBlindPostProcessor = new ColorBlindnessPostProcessor(ColorBlindnessMode.Protanope);\r\n    }\r\n    /**\r\n     * Correct colors for a specified color blindness\r\n     * @param colorBlindness\r\n     */\r\n    correct(colorBlindness) {\r\n        if (this._engine.graphicsContext instanceof ExcaliburGraphicsContextWebGL) {\r\n            this.clear();\r\n            this._colorBlindPostProcessor.colorBlindnessMode = colorBlindness;\r\n            this._colorBlindPostProcessor.simulate = false;\r\n            this._engine.graphicsContext.addPostProcessor(this._colorBlindPostProcessor);\r\n        }\r\n    }\r\n    /**\r\n     * Simulate colors for a specified color blindness\r\n     * @param colorBlindness\r\n     */\r\n    simulate(colorBlindness) {\r\n        if (this._engine.graphicsContext instanceof ExcaliburGraphicsContextWebGL) {\r\n            this.clear();\r\n            this._colorBlindPostProcessor.colorBlindnessMode = colorBlindness;\r\n            this._colorBlindPostProcessor.simulate = true;\r\n            this._engine.graphicsContext.addPostProcessor(this._colorBlindPostProcessor);\r\n        }\r\n    }\r\n    /**\r\n     * Remove color blindness post processor\r\n     */\r\n    clear() {\r\n        this._engine.graphicsContext.removePostProcessor(this._colorBlindPostProcessor);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Debug/Debug.ts\n\r\n\r\n/**\r\n * Debug statistics and flags for Excalibur. If polling these values, it would be\r\n * best to do so on the `postupdate` event for [[Engine]], after all values have been\r\n * updated during a frame.\r\n */\r\nclass Debug {\r\n    constructor(engine) {\r\n        /**\r\n         * Performance statistics\r\n         */\r\n        this.stats = {\r\n            /**\r\n             * Current frame statistics. Engine reuses this instance, use [[FrameStats.clone]] to copy frame stats.\r\n             * Best accessed on [[postframe]] event. See [[FrameStats]]\r\n             */\r\n            currFrame: new FrameStats(),\r\n            /**\r\n             * Previous frame statistics. Engine reuses this instance, use [[FrameStats.clone]] to copy frame stats.\r\n             * Best accessed on [[preframe]] event. Best inspected on engine event `preframe`. See [[FrameStats]]\r\n             */\r\n            prevFrame: new FrameStats()\r\n        };\r\n        /**\r\n         * Filter debug context to named entities or entity ids\r\n         */\r\n        this.filter = {\r\n            /**\r\n             * Toggle filter on or off (default off) must be on for DebugDraw to use filters\r\n             */\r\n            useFilter: false,\r\n            /**\r\n             * Query for entities by name, if the entity name contains `nameQuery` it will be included\r\n             */\r\n            nameQuery: '',\r\n            /**\r\n             * Query for Entity ids, if the id matches it will be included\r\n             */\r\n            ids: []\r\n        };\r\n        /**\r\n         * Entity debug settings\r\n         */\r\n        this.entity = {\r\n            showAll: false,\r\n            showId: true,\r\n            showName: false\r\n        };\r\n        /**\r\n         * Transform component debug settings\r\n         */\r\n        this.transform = {\r\n            showAll: false,\r\n            showPosition: false,\r\n            showPositionLabel: false,\r\n            positionColor: Color.Yellow,\r\n            showZIndex: false,\r\n            showScale: false,\r\n            scaleColor: Color.Green,\r\n            showRotation: false,\r\n            rotationColor: Color.Blue\r\n        };\r\n        /**\r\n         * Graphics component debug settings\r\n         */\r\n        this.graphics = {\r\n            showAll: false,\r\n            showBounds: true,\r\n            boundsColor: Color.Yellow\r\n        };\r\n        /**\r\n         * Collider component debug settings\r\n         */\r\n        this.collider = {\r\n            showAll: false,\r\n            showBounds: true,\r\n            boundsColor: Color.Blue,\r\n            showOwner: false,\r\n            showGeometry: true,\r\n            geometryColor: Color.Green\r\n        };\r\n        /**\r\n         * Physics simulation debug settings\r\n         */\r\n        this.physics = {\r\n            showAll: false,\r\n            showBroadphaseSpacePartitionDebug: false,\r\n            showCollisionNormals: false,\r\n            collisionNormalColor: Color.Cyan,\r\n            showCollisionContacts: true,\r\n            collisionContactColor: Color.Red\r\n        };\r\n        /**\r\n         * Motion component debug settings\r\n         */\r\n        this.motion = {\r\n            showAll: false,\r\n            showVelocity: false,\r\n            velocityColor: Color.Yellow,\r\n            showAcceleration: false,\r\n            accelerationColor: Color.Red\r\n        };\r\n        /**\r\n         * Body component debug settings\r\n         */\r\n        this.body = {\r\n            showAll: false,\r\n            showCollisionGroup: false,\r\n            showCollisionType: false,\r\n            showSleeping: false,\r\n            showMotion: false,\r\n            showMass: false\r\n        };\r\n        /**\r\n         * Camera debug settings\r\n         */\r\n        this.camera = {\r\n            showAll: false,\r\n            showFocus: false,\r\n            focusColor: Color.Red,\r\n            showZoom: false\r\n        };\r\n        this._engine = engine;\r\n        this.colorBlindMode = new ColorBlindFlags(this._engine);\r\n    }\r\n    /**\r\n     * Switch the current excalibur clock with the [[TestClock]] and return\r\n     * it in the same running state.\r\n     *\r\n     * This is useful when you need to debug frame by frame.\r\n     */\r\n    useTestClock() {\r\n        const clock = this._engine.clock;\r\n        const wasRunning = clock.isRunning();\r\n        clock.stop();\r\n        const testClock = clock.toTestClock();\r\n        if (wasRunning) {\r\n            testClock.start();\r\n        }\r\n        this._engine.clock = testClock;\r\n        return testClock;\r\n    }\r\n    /**\r\n     * Switch the current excalibur clock with the [[StandardClock]] and\r\n     * return it in the same running state.\r\n     *\r\n     * This is useful when you need to switch back to normal mode after\r\n     * debugging.\r\n     */\r\n    useStandardClock() {\r\n        const currentClock = this._engine.clock;\r\n        const wasRunning = currentClock.isRunning();\r\n        currentClock.stop();\r\n        const standardClock = currentClock.toStandardClock();\r\n        if (wasRunning) {\r\n            standardClock.start();\r\n        }\r\n        this._engine.clock = standardClock;\r\n        return standardClock;\r\n    }\r\n}\r\n/**\r\n * Implementation of a frame's stats. Meant to have values copied via [[FrameStats.reset]], avoid\r\n * creating instances of this every frame.\r\n */\r\nclass FrameStats {\r\n    constructor() {\r\n        this._id = 0;\r\n        this._delta = 0;\r\n        this._fps = 0;\r\n        this._actorStats = {\r\n            alive: 0,\r\n            killed: 0,\r\n            ui: 0,\r\n            get remaining() {\r\n                return this.alive - this.killed;\r\n            },\r\n            get total() {\r\n                return this.remaining + this.ui;\r\n            }\r\n        };\r\n        this._durationStats = {\r\n            update: 0,\r\n            draw: 0,\r\n            get total() {\r\n                return this.update + this.draw;\r\n            }\r\n        };\r\n        this._physicsStats = new PhysicsStats();\r\n        this._graphicsStats = {\r\n            drawCalls: 0,\r\n            drawnImages: 0\r\n        };\r\n    }\r\n    /**\r\n     * Zero out values or clone other IFrameStat stats. Allows instance reuse.\r\n     *\r\n     * @param [otherStats] Optional stats to clone\r\n     */\r\n    reset(otherStats) {\r\n        if (otherStats) {\r\n            this.id = otherStats.id;\r\n            this.delta = otherStats.delta;\r\n            this.fps = otherStats.fps;\r\n            this.actors.alive = otherStats.actors.alive;\r\n            this.actors.killed = otherStats.actors.killed;\r\n            this.actors.ui = otherStats.actors.ui;\r\n            this.duration.update = otherStats.duration.update;\r\n            this.duration.draw = otherStats.duration.draw;\r\n            this._physicsStats.reset(otherStats.physics);\r\n            this.graphics.drawCalls = otherStats.graphics.drawCalls;\r\n            this.graphics.drawnImages = otherStats.graphics.drawnImages;\r\n        }\r\n        else {\r\n            this.id = this.delta = this.fps = 0;\r\n            this.actors.alive = this.actors.killed = this.actors.ui = 0;\r\n            this.duration.update = this.duration.draw = 0;\r\n            this._physicsStats.reset();\r\n            this.graphics.drawnImages = this.graphics.drawCalls = 0;\r\n        }\r\n    }\r\n    /**\r\n     * Provides a clone of this instance.\r\n     */\r\n    clone() {\r\n        const fs = new FrameStats();\r\n        fs.reset(this);\r\n        return fs;\r\n    }\r\n    /**\r\n     * Gets the frame's id\r\n     */\r\n    get id() {\r\n        return this._id;\r\n    }\r\n    /**\r\n     * Sets the frame's id\r\n     */\r\n    set id(value) {\r\n        this._id = value;\r\n    }\r\n    /**\r\n     * Gets the frame's delta (time since last frame)\r\n     */\r\n    get delta() {\r\n        return this._delta;\r\n    }\r\n    /**\r\n     * Sets the frame's delta (time since last frame). Internal use only.\r\n     * @internal\r\n     */\r\n    set delta(value) {\r\n        this._delta = value;\r\n    }\r\n    /**\r\n     * Gets the frame's frames-per-second (FPS)\r\n     */\r\n    get fps() {\r\n        return this._fps;\r\n    }\r\n    /**\r\n     * Sets the frame's frames-per-second (FPS). Internal use only.\r\n     * @internal\r\n     */\r\n    set fps(value) {\r\n        this._fps = value;\r\n    }\r\n    /**\r\n     * Gets the frame's actor statistics\r\n     */\r\n    get actors() {\r\n        return this._actorStats;\r\n    }\r\n    /**\r\n     * Gets the frame's duration statistics\r\n     */\r\n    get duration() {\r\n        return this._durationStats;\r\n    }\r\n    /**\r\n     * Gets the frame's physics statistics\r\n     */\r\n    get physics() {\r\n        return this._physicsStats;\r\n    }\r\n    /**\r\n     * Gets the frame's graphics statistics\r\n     */\r\n    get graphics() {\r\n        return this._graphicsStats;\r\n    }\r\n}\r\nclass PhysicsStats {\r\n    constructor() {\r\n        this._pairs = 0;\r\n        this._collisions = 0;\r\n        this._contacts = new Map();\r\n        this._fastBodies = 0;\r\n        this._fastBodyCollisions = 0;\r\n        this._broadphase = 0;\r\n        this._narrowphase = 0;\r\n    }\r\n    /**\r\n     * Zero out values or clone other IPhysicsStats stats. Allows instance reuse.\r\n     *\r\n     * @param [otherStats] Optional stats to clone\r\n     */\r\n    reset(otherStats) {\r\n        if (otherStats) {\r\n            this.pairs = otherStats.pairs;\r\n            this.collisions = otherStats.collisions;\r\n            this.contacts = otherStats.contacts;\r\n            this.fastBodies = otherStats.fastBodies;\r\n            this.fastBodyCollisions = otherStats.fastBodyCollisions;\r\n            this.broadphase = otherStats.broadphase;\r\n            this.narrowphase = otherStats.narrowphase;\r\n        }\r\n        else {\r\n            this.pairs = this.collisions = this.fastBodies = 0;\r\n            this.fastBodyCollisions = this.broadphase = this.narrowphase = 0;\r\n            this.contacts.clear();\r\n        }\r\n    }\r\n    /**\r\n     * Provides a clone of this instance.\r\n     */\r\n    clone() {\r\n        const ps = new PhysicsStats();\r\n        ps.reset(this);\r\n        return ps;\r\n    }\r\n    get pairs() {\r\n        return this._pairs;\r\n    }\r\n    set pairs(value) {\r\n        this._pairs = value;\r\n    }\r\n    get collisions() {\r\n        return this._collisions;\r\n    }\r\n    set collisions(value) {\r\n        this._collisions = value;\r\n    }\r\n    get contacts() {\r\n        return this._contacts;\r\n    }\r\n    set contacts(contacts) {\r\n        this._contacts = contacts;\r\n    }\r\n    get fastBodies() {\r\n        return this._fastBodies;\r\n    }\r\n    set fastBodies(value) {\r\n        this._fastBodies = value;\r\n    }\r\n    get fastBodyCollisions() {\r\n        return this._fastBodyCollisions;\r\n    }\r\n    set fastBodyCollisions(value) {\r\n        this._fastBodyCollisions = value;\r\n    }\r\n    get broadphase() {\r\n        return this._broadphase;\r\n    }\r\n    set broadphase(value) {\r\n        this._broadphase = value;\r\n    }\r\n    get narrowphase() {\r\n        return this._narrowphase;\r\n    }\r\n    set narrowphase(value) {\r\n        this._narrowphase = value;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Input/PointerScope.ts\n/**\r\n * Determines the scope of handling mouse/touch events.\r\n */\r\nvar PointerScope;\r\n(function (PointerScope) {\r\n    /**\r\n     * Handle events on the `canvas` element only. Events originating outside the\r\n     * `canvas` will not be handled.\r\n     */\r\n    PointerScope[\"Canvas\"] = \"Canvas\";\r\n    /**\r\n     * Handles events on the entire document. All events will be handled by Excalibur.\r\n     */\r\n    PointerScope[\"Document\"] = \"Document\";\r\n})(PointerScope || (PointerScope = {}));\r\n\n;// CONCATENATED MODULE: ./Input/Keyboard.ts\n\r\n\r\n\r\n/**\r\n * Enum representing physical input key codes\r\n */\r\nvar Keys;\r\n(function (Keys) {\r\n    // NUMPAD\r\n    Keys[\"Num0\"] = \"Numpad0\";\r\n    Keys[\"Num1\"] = \"Numpad1\";\r\n    Keys[\"Num2\"] = \"Numpad2\";\r\n    Keys[\"Num3\"] = \"Numpad3\";\r\n    Keys[\"Num4\"] = \"Numpad4\";\r\n    Keys[\"Num5\"] = \"Numpad5\";\r\n    Keys[\"Num6\"] = \"Numpad6\";\r\n    Keys[\"Num7\"] = \"Numpad7\";\r\n    Keys[\"Num8\"] = \"Numpad8\";\r\n    Keys[\"Num9\"] = \"Numpad9\";\r\n    Keys[\"NumAdd\"] = \"NumpadAdd\";\r\n    Keys[\"NumSubtract\"] = \"NumpadSubtract\";\r\n    Keys[\"NumMultiply\"] = \"NumpadMultiply\";\r\n    Keys[\"NumDivide\"] = \"NumpadDivide\";\r\n    // NumComma = 'NumpadComma', // not x-browser\r\n    Keys[\"NumDecimal\"] = \"NumpadDecimal\";\r\n    Keys[\"Numpad0\"] = \"Numpad0\";\r\n    Keys[\"Numpad1\"] = \"Numpad1\";\r\n    Keys[\"Numpad2\"] = \"Numpad2\";\r\n    Keys[\"Numpad3\"] = \"Numpad3\";\r\n    Keys[\"Numpad4\"] = \"Numpad4\";\r\n    Keys[\"Numpad5\"] = \"Numpad5\";\r\n    Keys[\"Numpad6\"] = \"Numpad6\";\r\n    Keys[\"Numpad7\"] = \"Numpad7\";\r\n    Keys[\"Numpad8\"] = \"Numpad8\";\r\n    Keys[\"Numpad9\"] = \"Numpad9\";\r\n    Keys[\"NumpadAdd\"] = \"NumpadAdd\";\r\n    Keys[\"NumpadSubtract\"] = \"NumpadSubtract\";\r\n    Keys[\"NumpadMultiply\"] = \"NumpadMultiply\";\r\n    Keys[\"NumpadDivide\"] = \"NumpadDivide\";\r\n    // NumpadComma = 'NumpadComma', // not x-browser\r\n    Keys[\"NumpadDecimal\"] = \"NumpadDecimal\";\r\n    // MODIFIERS\r\n    Keys[\"NumLock\"] = \"NumLock\";\r\n    Keys[\"ShiftLeft\"] = \"ShiftLeft\";\r\n    Keys[\"ShiftRight\"] = \"ShiftRight\";\r\n    Keys[\"AltLeft\"] = \"AltLeft\";\r\n    Keys[\"AltRight\"] = \"AltRight\";\r\n    Keys[\"ControlLeft\"] = \"ControlLeft\";\r\n    Keys[\"ControlRight\"] = \"ControlRight\";\r\n    Keys[\"MetaLeft\"] = \"MetaLeft\";\r\n    Keys[\"MetaRight\"] = \"MetaRight\";\r\n    // NUMBERS\r\n    Keys[\"Key0\"] = \"Digit0\";\r\n    Keys[\"Key1\"] = \"Digit1\";\r\n    Keys[\"Key2\"] = \"Digit2\";\r\n    Keys[\"Key3\"] = \"Digit3\";\r\n    Keys[\"Key4\"] = \"Digit4\";\r\n    Keys[\"Key5\"] = \"Digit5\";\r\n    Keys[\"Key6\"] = \"Digit6\";\r\n    Keys[\"Key7\"] = \"Digit7\";\r\n    Keys[\"Key8\"] = \"Digit8\";\r\n    Keys[\"Key9\"] = \"Digit9\";\r\n    Keys[\"Digit0\"] = \"Digit0\";\r\n    Keys[\"Digit1\"] = \"Digit1\";\r\n    Keys[\"Digit2\"] = \"Digit2\";\r\n    Keys[\"Digit3\"] = \"Digit3\";\r\n    Keys[\"Digit4\"] = \"Digit4\";\r\n    Keys[\"Digit5\"] = \"Digit5\";\r\n    Keys[\"Digit6\"] = \"Digit6\";\r\n    Keys[\"Digit7\"] = \"Digit7\";\r\n    Keys[\"Digit8\"] = \"Digit8\";\r\n    Keys[\"Digit9\"] = \"Digit9\";\r\n    // FUNCTION KEYS\r\n    Keys[\"F1\"] = \"F1\";\r\n    Keys[\"F2\"] = \"F2\";\r\n    Keys[\"F3\"] = \"F3\";\r\n    Keys[\"F4\"] = \"F4\";\r\n    Keys[\"F5\"] = \"F5\";\r\n    Keys[\"F6\"] = \"F6\";\r\n    Keys[\"F7\"] = \"F7\";\r\n    Keys[\"F8\"] = \"F8\";\r\n    Keys[\"F9\"] = \"F9\";\r\n    Keys[\"F10\"] = \"F10\";\r\n    Keys[\"F11\"] = \"F11\";\r\n    Keys[\"F12\"] = \"F12\";\r\n    // LETTERS\r\n    Keys[\"A\"] = \"KeyA\";\r\n    Keys[\"B\"] = \"KeyB\";\r\n    Keys[\"C\"] = \"KeyC\";\r\n    Keys[\"D\"] = \"KeyD\";\r\n    Keys[\"E\"] = \"KeyE\";\r\n    Keys[\"F\"] = \"KeyF\";\r\n    Keys[\"G\"] = \"KeyG\";\r\n    Keys[\"H\"] = \"KeyH\";\r\n    Keys[\"I\"] = \"KeyI\";\r\n    Keys[\"J\"] = \"KeyJ\";\r\n    Keys[\"K\"] = \"KeyK\";\r\n    Keys[\"L\"] = \"KeyL\";\r\n    Keys[\"M\"] = \"KeyM\";\r\n    Keys[\"N\"] = \"KeyN\";\r\n    Keys[\"O\"] = \"KeyO\";\r\n    Keys[\"P\"] = \"KeyP\";\r\n    Keys[\"Q\"] = \"KeyQ\";\r\n    Keys[\"R\"] = \"KeyR\";\r\n    Keys[\"S\"] = \"KeyS\";\r\n    Keys[\"T\"] = \"KeyT\";\r\n    Keys[\"U\"] = \"KeyU\";\r\n    Keys[\"V\"] = \"KeyV\";\r\n    Keys[\"W\"] = \"KeyW\";\r\n    Keys[\"X\"] = \"KeyX\";\r\n    Keys[\"Y\"] = \"KeyY\";\r\n    Keys[\"Z\"] = \"KeyZ\";\r\n    Keys[\"KeyA\"] = \"KeyA\";\r\n    Keys[\"KeyB\"] = \"KeyB\";\r\n    Keys[\"KeyC\"] = \"KeyC\";\r\n    Keys[\"KeyD\"] = \"KeyD\";\r\n    Keys[\"KeyE\"] = \"KeyE\";\r\n    Keys[\"KeyF\"] = \"KeyF\";\r\n    Keys[\"KeyG\"] = \"KeyG\";\r\n    Keys[\"KeyH\"] = \"KeyH\";\r\n    Keys[\"KeyI\"] = \"KeyI\";\r\n    Keys[\"KeyJ\"] = \"KeyJ\";\r\n    Keys[\"KeyK\"] = \"KeyK\";\r\n    Keys[\"KeyL\"] = \"KeyL\";\r\n    Keys[\"KeyM\"] = \"KeyM\";\r\n    Keys[\"KeyN\"] = \"KeyN\";\r\n    Keys[\"KeyO\"] = \"KeyO\";\r\n    Keys[\"KeyP\"] = \"KeyP\";\r\n    Keys[\"KeyQ\"] = \"KeyQ\";\r\n    Keys[\"KeyR\"] = \"KeyR\";\r\n    Keys[\"KeyS\"] = \"KeyS\";\r\n    Keys[\"KeyT\"] = \"KeyT\";\r\n    Keys[\"KeyU\"] = \"KeyU\";\r\n    Keys[\"KeyV\"] = \"KeyV\";\r\n    Keys[\"KeyW\"] = \"KeyW\";\r\n    Keys[\"KeyX\"] = \"KeyX\";\r\n    Keys[\"KeyY\"] = \"KeyY\";\r\n    Keys[\"KeyZ\"] = \"KeyZ\";\r\n    // SYMBOLS\r\n    Keys[\"Semicolon\"] = \"Semicolon\";\r\n    Keys[\"Quote\"] = \"Quote\";\r\n    Keys[\"Comma\"] = \"Comma\";\r\n    Keys[\"Minus\"] = \"Minus\";\r\n    Keys[\"Period\"] = \"Period\";\r\n    Keys[\"Slash\"] = \"Slash\";\r\n    Keys[\"Equal\"] = \"Equal\";\r\n    Keys[\"BracketLeft\"] = \"BracketLeft\";\r\n    Keys[\"Backslash\"] = \"Backslash\";\r\n    Keys[\"BracketRight\"] = \"BracketRight\";\r\n    Keys[\"Backquote\"] = \"Backquote\";\r\n    // DIRECTIONS\r\n    Keys[\"Up\"] = \"ArrowUp\";\r\n    Keys[\"Down\"] = \"ArrowDown\";\r\n    Keys[\"Left\"] = \"ArrowLeft\";\r\n    Keys[\"Right\"] = \"ArrowRight\";\r\n    Keys[\"ArrowUp\"] = \"ArrowUp\";\r\n    Keys[\"ArrowDown\"] = \"ArrowDown\";\r\n    Keys[\"ArrowLeft\"] = \"ArrowLeft\";\r\n    Keys[\"ArrowRight\"] = \"ArrowRight\";\r\n    // OTHER\r\n    Keys[\"Space\"] = \"Space\";\r\n    Keys[\"Backspace\"] = \"Backspace\";\r\n    Keys[\"Delete\"] = \"Delete\";\r\n    Keys[\"Esc\"] = \"Escape\";\r\n    Keys[\"Escape\"] = \"Escape\";\r\n    Keys[\"Enter\"] = \"Enter\";\r\n    Keys[\"NumpadEnter\"] = \"NumpadEnter\";\r\n    Keys[\"ContextMenu\"] = \"ContextMenu\";\r\n})(Keys || (Keys = {}));\r\n/**\r\n * Event thrown on a game object for a key event\r\n */\r\nclass KeyEvent extends GameEvent {\r\n    /**\r\n     * @param key  The key responsible for throwing the event\r\n     * @param value The key's typed value the browser detected\r\n     * @param originalEvent The original keyboard event that Excalibur handled\r\n     */\r\n    constructor(key, value, originalEvent) {\r\n        super();\r\n        this.key = key;\r\n        this.value = value;\r\n        this.originalEvent = originalEvent;\r\n    }\r\n}\r\n/**\r\n * Provides keyboard support for Excalibur.\r\n */\r\nclass Keyboard extends Class {\r\n    constructor() {\r\n        super();\r\n        this._keys = [];\r\n        this._keysUp = [];\r\n        this._keysDown = [];\r\n        this._handleKeyDown = (ev) => {\r\n            const code = ev.code;\r\n            if (this._keys.indexOf(code) === -1) {\r\n                this._keys.push(code);\r\n                this._keysDown.push(code);\r\n                const keyEvent = new KeyEvent(code, ev.key, ev);\r\n                this.eventDispatcher.emit('down', keyEvent);\r\n                this.eventDispatcher.emit('press', keyEvent);\r\n            }\r\n        };\r\n        this._handleKeyUp = (ev) => {\r\n            const code = ev.code;\r\n            const key = this._keys.indexOf(code);\r\n            this._keys.splice(key, 1);\r\n            this._keysUp.push(code);\r\n            const keyEvent = new KeyEvent(code, ev.key, ev);\r\n            // alias the old api, we may want to deprecate this in the future\r\n            this.eventDispatcher.emit('up', keyEvent);\r\n            this.eventDispatcher.emit('release', keyEvent);\r\n        };\r\n    }\r\n    on(eventName, handler) {\r\n        super.on(eventName, handler);\r\n    }\r\n    /**\r\n     * Initialize Keyboard event listeners\r\n     */\r\n    init(global) {\r\n        if (!global) {\r\n            try {\r\n                // Try and listen to events on top window frame if within an iframe.\r\n                //\r\n                // See https://github.com/excaliburjs/Excalibur/issues/1294\r\n                //\r\n                // Attempt to add an event listener, which triggers a DOMException on\r\n                // cross-origin iframes\r\n                const noop = () => {\r\n                    return;\r\n                };\r\n                window.top.addEventListener('blur', noop);\r\n                window.top.removeEventListener('blur', noop);\r\n                // this will be the same as window if not embedded within an iframe\r\n                global = window.top;\r\n            }\r\n            catch (_a) {\r\n                // fallback to current frame\r\n                global = window;\r\n                Logger.getInstance().warn('Failed to bind to keyboard events to top frame. ' +\r\n                    'If you are trying to embed Excalibur in a cross-origin iframe, keyboard events will not fire.');\r\n            }\r\n        }\r\n        global.addEventListener('blur', () => {\r\n            this._keys.length = 0; // empties array efficiently\r\n        });\r\n        // key up is on window because canvas cannot have focus\r\n        global.addEventListener('keyup', this._handleKeyUp);\r\n        // key down is on window because canvas cannot have focus\r\n        global.addEventListener('keydown', this._handleKeyDown);\r\n    }\r\n    update() {\r\n        // Reset keysDown and keysUp after update is complete\r\n        this._keysDown.length = 0;\r\n        this._keysUp.length = 0;\r\n        // Emit synthetic \"hold\" event\r\n        for (let i = 0; i < this._keys.length; i++) {\r\n            this.eventDispatcher.emit('hold', new KeyEvent(this._keys[i]));\r\n        }\r\n    }\r\n    /**\r\n     * Gets list of keys being pressed down\r\n     */\r\n    getKeys() {\r\n        return this._keys;\r\n    }\r\n    /**\r\n     * Tests if a certain key was just pressed this frame. This is cleared at the end of the update frame.\r\n     * @param key Test whether a key was just pressed\r\n     */\r\n    wasPressed(key) {\r\n        return this._keysDown.indexOf(key) > -1;\r\n    }\r\n    /**\r\n     * Tests if a certain key is held down. This is persisted between frames.\r\n     * @param key  Test whether a key is held down\r\n     */\r\n    isHeld(key) {\r\n        return this._keys.indexOf(key) > -1;\r\n    }\r\n    /**\r\n     * Tests if a certain key was just released this frame. This is cleared at the end of the update frame.\r\n     * @param key  Test whether a key was just released\r\n     */\r\n    wasReleased(key) {\r\n        return this._keysUp.indexOf(key) > -1;\r\n    }\r\n    /**\r\n     * Trigger a manual key event\r\n     * @param type\r\n     * @param key\r\n     * @param character\r\n     */\r\n    triggerEvent(type, key, character) {\r\n        if (type === 'down') {\r\n            this._handleKeyDown(new KeyboardEvent('keydown', {\r\n                code: key,\r\n                key: character !== null && character !== void 0 ? character : null\r\n            }));\r\n        }\r\n        if (type === 'up') {\r\n            this._handleKeyUp(new KeyboardEvent('keyup', {\r\n                code: key,\r\n                key: character !== null && character !== void 0 ? character : null\r\n            }));\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Input/Gamepad.ts\n\r\n\r\n/**\r\n * Excalibur leverages the HTML5 Gamepad API [where it is supported](http://caniuse.com/#feat=gamepad)\r\n * to provide controller support for your games.\r\n */\r\nclass Gamepads extends Class {\r\n    constructor() {\r\n        super();\r\n        /**\r\n         * Whether or not to poll for Gamepad input (default: `false`)\r\n         */\r\n        this.enabled = false;\r\n        /**\r\n         * Whether or not Gamepad API is supported\r\n         */\r\n        this.supported = !!navigator.getGamepads;\r\n        this._gamePadTimeStamps = [0, 0, 0, 0];\r\n        this._oldPads = [];\r\n        this._pads = [];\r\n        this._initSuccess = false;\r\n        this._navigator = navigator;\r\n        this._minimumConfiguration = null;\r\n    }\r\n    init() {\r\n        if (!this.supported) {\r\n            return;\r\n        }\r\n        if (this._initSuccess) {\r\n            return;\r\n        }\r\n        // In Chrome, this will return 4 undefined items until a button is pressed\r\n        // In FF, this will not return any items until a button is pressed\r\n        this._oldPads = this._clonePads(this._navigator.getGamepads());\r\n        if (this._oldPads.length && this._oldPads[0]) {\r\n            this._initSuccess = true;\r\n        }\r\n    }\r\n    /**\r\n     * Sets the minimum gamepad configuration, for example {axis: 4, buttons: 4} means\r\n     * this game requires at minimum 4 axis inputs and 4 buttons, this is not restrictive\r\n     * all other controllers with more axis or buttons are valid as well. If no minimum\r\n     * configuration is set all pads are valid.\r\n     */\r\n    setMinimumGamepadConfiguration(config) {\r\n        this._enableAndUpdate(); // if config is used, implicitly enable\r\n        this._minimumConfiguration = config;\r\n    }\r\n    /**\r\n     * When implicitly enabled, set the enabled flag and run an update so information is updated\r\n     */\r\n    _enableAndUpdate() {\r\n        if (!this.enabled) {\r\n            this.enabled = true;\r\n            this.update();\r\n        }\r\n    }\r\n    /**\r\n     * Checks a navigator gamepad against the minimum configuration if present.\r\n     */\r\n    _isGamepadValid(pad) {\r\n        if (!this._minimumConfiguration) {\r\n            return true;\r\n        }\r\n        if (!pad) {\r\n            return false;\r\n        }\r\n        const axesLength = pad.axes.filter((value) => {\r\n            return typeof value !== undefined;\r\n        }).length;\r\n        const buttonLength = pad.buttons.filter((value) => {\r\n            return typeof value !== undefined;\r\n        }).length;\r\n        return axesLength >= this._minimumConfiguration.axis && buttonLength >= this._minimumConfiguration.buttons && pad.connected;\r\n    }\r\n    on(eventName, handler) {\r\n        this._enableAndUpdate(); // implicitly enable\r\n        super.on(eventName, handler);\r\n    }\r\n    off(eventName, handler) {\r\n        this._enableAndUpdate(); // implicitly enable\r\n        super.off(eventName, handler);\r\n    }\r\n    /**\r\n     * Updates Gamepad state and publishes Gamepad events\r\n     */\r\n    update() {\r\n        if (!this.enabled || !this.supported) {\r\n            return;\r\n        }\r\n        this.init();\r\n        const gamepads = this._navigator.getGamepads();\r\n        for (let i = 0; i < gamepads.length; i++) {\r\n            if (!gamepads[i]) {\r\n                const gamepad = this.at(i);\r\n                // If was connected, but now isn't emit the disconnect event\r\n                if (gamepad.connected) {\r\n                    this.eventDispatcher.emit('disconnect', new GamepadDisconnectEvent(i, gamepad));\r\n                }\r\n                // Reset connection status\r\n                gamepad.connected = false;\r\n                continue;\r\n            }\r\n            else {\r\n                if (!this.at(i).connected && this._isGamepadValid(gamepads[i])) {\r\n                    this.eventDispatcher.emit('connect', new GamepadConnectEvent(i, this.at(i)));\r\n                }\r\n                // Set connection status\r\n                this.at(i).connected = true;\r\n            }\r\n            // Only supported in Chrome\r\n            if (gamepads[i].timestamp && gamepads[i].timestamp === this._gamePadTimeStamps[i]) {\r\n                continue;\r\n            }\r\n            this._gamePadTimeStamps[i] = gamepads[i].timestamp;\r\n            // Add reference to navigator gamepad\r\n            this.at(i).navigatorGamepad = gamepads[i];\r\n            // Buttons\r\n            let b, bi, a, ai, value;\r\n            for (b in Buttons) {\r\n                bi = Buttons[b];\r\n                if (typeof bi === 'number') {\r\n                    if (gamepads[i].buttons[bi]) {\r\n                        value = gamepads[i].buttons[bi].value;\r\n                        if (value !== this._oldPads[i].getButton(bi)) {\r\n                            if (gamepads[i].buttons[bi].pressed) {\r\n                                this.at(i).updateButton(bi, value);\r\n                                this.at(i).eventDispatcher.emit('button', new GamepadButtonEvent(bi, value, this.at(i)));\r\n                            }\r\n                            else {\r\n                                this.at(i).updateButton(bi, 0);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            // Axes\r\n            for (a in Axes) {\r\n                ai = Axes[a];\r\n                if (typeof ai === 'number') {\r\n                    value = gamepads[i].axes[ai];\r\n                    if (value !== this._oldPads[i].getAxes(ai)) {\r\n                        this.at(i).updateAxes(ai, value);\r\n                        this.at(i).eventDispatcher.emit('axis', new GamepadAxisEvent(ai, value, this.at(i)));\r\n                    }\r\n                }\r\n            }\r\n            this._oldPads[i] = this._clonePad(gamepads[i]);\r\n        }\r\n    }\r\n    /**\r\n     * Safely retrieves a Gamepad at a specific index and creates one if it doesn't yet exist\r\n     */\r\n    at(index) {\r\n        this._enableAndUpdate(); // implicitly enable gamepads when at() is called\r\n        if (index >= this._pads.length) {\r\n            // Ensure there is a pad to retrieve\r\n            for (let i = this._pads.length - 1, max = index; i < max; i++) {\r\n                this._pads.push(new Gamepad());\r\n                this._oldPads.push(new Gamepad());\r\n            }\r\n        }\r\n        return this._pads[index];\r\n    }\r\n    /**\r\n     * Returns a list of all valid gamepads that meet the minimum configuration requirement.\r\n     */\r\n    getValidGamepads() {\r\n        this._enableAndUpdate();\r\n        const result = [];\r\n        for (let i = 0; i < this._pads.length; i++) {\r\n            if (this._isGamepadValid(this.at(i).navigatorGamepad) && this.at(i).connected) {\r\n                result.push(this.at(i));\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Gets the number of connected gamepads\r\n     */\r\n    count() {\r\n        return this._pads.filter((p) => p.connected).length;\r\n    }\r\n    _clonePads(pads) {\r\n        const arr = [];\r\n        for (let i = 0, len = pads.length; i < len; i++) {\r\n            arr.push(this._clonePad(pads[i]));\r\n        }\r\n        return arr;\r\n    }\r\n    /**\r\n     * Fastest way to clone a known object is to do it yourself\r\n     */\r\n    _clonePad(pad) {\r\n        let i, len;\r\n        const clonedPad = new Gamepad();\r\n        if (!pad) {\r\n            return clonedPad;\r\n        }\r\n        for (i = 0, len = pad.buttons.length; i < len; i++) {\r\n            if (pad.buttons[i]) {\r\n                clonedPad.updateButton(i, pad.buttons[i].value);\r\n            }\r\n        }\r\n        for (i = 0, len = pad.axes.length; i < len; i++) {\r\n            clonedPad.updateAxes(i, pad.axes[i]);\r\n        }\r\n        return clonedPad;\r\n    }\r\n}\r\n/**\r\n * The minimum value an axis has to move before considering it a change\r\n */\r\nGamepads.MinAxisMoveThreshold = 0.05;\r\n/**\r\n * Gamepad holds state information for a connected controller. See [[Gamepads]]\r\n * for more information on handling controller input.\r\n */\r\nclass Gamepad extends Class {\r\n    constructor() {\r\n        super();\r\n        this.connected = false;\r\n        this._buttons = new Array(16);\r\n        this._axes = new Array(4);\r\n        for (let i = 0; i < this._buttons.length; i++) {\r\n            this._buttons[i] = 0;\r\n        }\r\n        for (let i = 0; i < this._axes.length; i++) {\r\n            this._axes[i] = 0;\r\n        }\r\n    }\r\n    /**\r\n     * Whether or not the given button is pressed\r\n     * @param button     The button to query\r\n     * @param threshold  The threshold over which the button is considered to be pressed\r\n     */\r\n    isButtonPressed(button, threshold = 1) {\r\n        return this._buttons[button] >= threshold;\r\n    }\r\n    /**\r\n     * Gets the given button value between 0 and 1\r\n     */\r\n    getButton(button) {\r\n        return this._buttons[button];\r\n    }\r\n    /**\r\n     * Gets the given axis value between -1 and 1. Values below\r\n     * [[MinAxisMoveThreshold]] are considered 0.\r\n     */\r\n    getAxes(axes) {\r\n        const value = this._axes[axes];\r\n        if (Math.abs(value) < Gamepads.MinAxisMoveThreshold) {\r\n            return 0;\r\n        }\r\n        else {\r\n            return value;\r\n        }\r\n    }\r\n    updateButton(buttonIndex, value) {\r\n        this._buttons[buttonIndex] = value;\r\n    }\r\n    updateAxes(axesIndex, value) {\r\n        this._axes[axesIndex] = value;\r\n    }\r\n}\r\n/**\r\n * Gamepad Buttons enumeration\r\n */\r\nvar Buttons;\r\n(function (Buttons) {\r\n    /**\r\n     * Face 1 button (e.g. A)\r\n     */\r\n    Buttons[Buttons[\"Face1\"] = 0] = \"Face1\";\r\n    /**\r\n     * Face 2 button (e.g. B)\r\n     */\r\n    Buttons[Buttons[\"Face2\"] = 1] = \"Face2\";\r\n    /**\r\n     * Face 3 button (e.g. X)\r\n     */\r\n    Buttons[Buttons[\"Face3\"] = 2] = \"Face3\";\r\n    /**\r\n     * Face 4 button (e.g. Y)\r\n     */\r\n    Buttons[Buttons[\"Face4\"] = 3] = \"Face4\";\r\n    /**\r\n     * Left bumper button\r\n     */\r\n    Buttons[Buttons[\"LeftBumper\"] = 4] = \"LeftBumper\";\r\n    /**\r\n     * Right bumper button\r\n     */\r\n    Buttons[Buttons[\"RightBumper\"] = 5] = \"RightBumper\";\r\n    /**\r\n     * Left trigger button\r\n     */\r\n    Buttons[Buttons[\"LeftTrigger\"] = 6] = \"LeftTrigger\";\r\n    /**\r\n     * Right trigger button\r\n     */\r\n    Buttons[Buttons[\"RightTrigger\"] = 7] = \"RightTrigger\";\r\n    /**\r\n     * Select button\r\n     */\r\n    Buttons[Buttons[\"Select\"] = 8] = \"Select\";\r\n    /**\r\n     * Start button\r\n     */\r\n    Buttons[Buttons[\"Start\"] = 9] = \"Start\";\r\n    /**\r\n     * Left analog stick press (e.g. L3)\r\n     */\r\n    Buttons[Buttons[\"LeftStick\"] = 10] = \"LeftStick\";\r\n    /**\r\n     * Right analog stick press (e.g. R3)\r\n     */\r\n    Buttons[Buttons[\"RightStick\"] = 11] = \"RightStick\";\r\n    /**\r\n     * D-pad up\r\n     */\r\n    Buttons[Buttons[\"DpadUp\"] = 12] = \"DpadUp\";\r\n    /**\r\n     * D-pad down\r\n     */\r\n    Buttons[Buttons[\"DpadDown\"] = 13] = \"DpadDown\";\r\n    /**\r\n     * D-pad left\r\n     */\r\n    Buttons[Buttons[\"DpadLeft\"] = 14] = \"DpadLeft\";\r\n    /**\r\n     * D-pad right\r\n     */\r\n    Buttons[Buttons[\"DpadRight\"] = 15] = \"DpadRight\";\r\n})(Buttons || (Buttons = {}));\r\n/**\r\n * Gamepad Axes enumeration\r\n */\r\nvar Axes;\r\n(function (Axes) {\r\n    /**\r\n     * Left analogue stick X direction\r\n     */\r\n    Axes[Axes[\"LeftStickX\"] = 0] = \"LeftStickX\";\r\n    /**\r\n     * Left analogue stick Y direction\r\n     */\r\n    Axes[Axes[\"LeftStickY\"] = 1] = \"LeftStickY\";\r\n    /**\r\n     * Right analogue stick X direction\r\n     */\r\n    Axes[Axes[\"RightStickX\"] = 2] = \"RightStickX\";\r\n    /**\r\n     * Right analogue stick Y direction\r\n     */\r\n    Axes[Axes[\"RightStickY\"] = 3] = \"RightStickY\";\r\n})(Axes || (Axes = {}));\r\n\n;// CONCATENATED MODULE: ./Util/Browser.ts\nclass BrowserComponent {\r\n    constructor(nativeComponent) {\r\n        this.nativeComponent = nativeComponent;\r\n        this._paused = false;\r\n        this._nativeHandlers = {};\r\n    }\r\n    on(eventName, handler) {\r\n        if (this._nativeHandlers[eventName]) {\r\n            this.off(eventName, this._nativeHandlers[eventName]);\r\n        }\r\n        this._nativeHandlers[eventName] = this._decorate(handler);\r\n        this.nativeComponent.addEventListener(eventName, this._nativeHandlers[eventName]);\r\n    }\r\n    off(eventName, handler) {\r\n        if (!handler) {\r\n            handler = this._nativeHandlers[eventName];\r\n        }\r\n        this.nativeComponent.removeEventListener(eventName, handler);\r\n        this._nativeHandlers[eventName] = null;\r\n    }\r\n    _decorate(handler) {\r\n        return (evt) => {\r\n            if (!this._paused) {\r\n                handler(evt);\r\n            }\r\n        };\r\n    }\r\n    pause() {\r\n        this._paused = true;\r\n    }\r\n    resume() {\r\n        this._paused = false;\r\n    }\r\n    clear() {\r\n        for (const event in this._nativeHandlers) {\r\n            this.off(event);\r\n        }\r\n    }\r\n}\r\nclass BrowserEvents {\r\n    constructor(_windowGlobal, _documentGlobal) {\r\n        this._windowGlobal = _windowGlobal;\r\n        this._documentGlobal = _documentGlobal;\r\n        this._windowComponent = new BrowserComponent(this._windowGlobal);\r\n        this._documentComponent = new BrowserComponent(this._documentGlobal);\r\n    }\r\n    get window() {\r\n        return this._windowComponent;\r\n    }\r\n    get document() {\r\n        return this._documentComponent;\r\n    }\r\n    pause() {\r\n        this.window.pause();\r\n        this.document.pause();\r\n    }\r\n    resume() {\r\n        this.window.resume();\r\n        this.document.resume();\r\n    }\r\n    clear() {\r\n        this.window.clear();\r\n        this.document.clear();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/global-coordinates.ts\n\r\nclass GlobalCoordinates {\r\n    constructor(worldPos, pagePos, screenPos) {\r\n        this.worldPos = worldPos;\r\n        this.pagePos = pagePos;\r\n        this.screenPos = screenPos;\r\n    }\r\n    static fromPagePosition(xOrPos, yOrEngine, engineOrUndefined) {\r\n        let pageX;\r\n        let pageY;\r\n        let pagePos;\r\n        let engine;\r\n        if (arguments.length === 3) {\r\n            pageX = xOrPos;\r\n            pageY = yOrEngine;\r\n            pagePos = new Vector(pageX, pageY);\r\n            engine = engineOrUndefined;\r\n        }\r\n        else {\r\n            pagePos = xOrPos;\r\n            pageX = pagePos.x;\r\n            pageY = pagePos.y;\r\n            engine = yOrEngine;\r\n        }\r\n        const screenPos = engine.screen.pageToScreenCoordinates(pagePos);\r\n        const worldPos = engine.screen.screenToWorldCoordinates(screenPos);\r\n        return new GlobalCoordinates(worldPos, pagePos, screenPos);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Input/PointerEvent.ts\nclass PointerEvent {\r\n    constructor(type, pointerId, button, pointerType, coordinates, nativeEvent) {\r\n        this.type = type;\r\n        this.pointerId = pointerId;\r\n        this.button = button;\r\n        this.pointerType = pointerType;\r\n        this.coordinates = coordinates;\r\n        this.nativeEvent = nativeEvent;\r\n        this.active = true;\r\n    }\r\n    cancel() {\r\n        this.active = false;\r\n    }\r\n    get pagePos() {\r\n        return this.coordinates.pagePos;\r\n    }\r\n    get screenPos() {\r\n        return this.coordinates.screenPos;\r\n    }\r\n    get worldPos() {\r\n        return this.coordinates.worldPos;\r\n    }\r\n    ;\r\n}\r\n\n;// CONCATENATED MODULE: ./Input/WheelEvent.ts\nclass WheelEvent {\r\n    constructor(x, y, pageX, pageY, screenX, screenY, index, deltaX, deltaY, deltaZ, deltaMode, ev) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.pageX = pageX;\r\n        this.pageY = pageY;\r\n        this.screenX = screenX;\r\n        this.screenY = screenY;\r\n        this.index = index;\r\n        this.deltaX = deltaX;\r\n        this.deltaY = deltaY;\r\n        this.deltaZ = deltaZ;\r\n        this.deltaMode = deltaMode;\r\n        this.ev = ev;\r\n        this.active = true;\r\n    }\r\n    cancel() {\r\n        this.active = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Input/PointerAbstraction.ts\n\r\n\r\nclass PointerAbstraction extends Class {\r\n    constructor() {\r\n        super();\r\n        /**\r\n         * The last position on the document this pointer was at. Can be `null` if pointer was never active.\r\n         */\r\n        this.lastPagePos = Vector.Zero;\r\n        /**\r\n         * The last position on the screen this pointer was at. Can be `null` if pointer was never active.\r\n         */\r\n        this.lastScreenPos = Vector.Zero;\r\n        /**\r\n         * The last position in the game world coordinates this pointer was at. Can be `null` if pointer was never active.\r\n         */\r\n        this.lastWorldPos = Vector.Zero;\r\n        this._onPointerMove = (ev) => {\r\n            this.lastPagePos = new Vector(ev.pagePos.x, ev.pagePos.y);\r\n            this.lastScreenPos = new Vector(ev.screenPos.x, ev.screenPos.y);\r\n            this.lastWorldPos = new Vector(ev.worldPos.x, ev.worldPos.y);\r\n        };\r\n        this._onPointerDown = (ev) => {\r\n            this.lastPagePos = new Vector(ev.pagePos.x, ev.pagePos.y);\r\n            this.lastScreenPos = new Vector(ev.screenPos.x, ev.screenPos.y);\r\n            this.lastWorldPos = new Vector(ev.worldPos.x, ev.worldPos.y);\r\n        };\r\n        this.on('move', this._onPointerMove);\r\n        this.on('down', this._onPointerDown);\r\n    }\r\n    on(event, handler) {\r\n        super.on(event, handler);\r\n    }\r\n    once(event, handler) {\r\n        super.once(event, handler);\r\n    }\r\n    off(event, handler) {\r\n        super.off(event, handler);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Input/WheelDeltaMode.ts\nvar WheelDeltaMode;\r\n(function (WheelDeltaMode) {\r\n    WheelDeltaMode[\"Pixel\"] = \"Pixel\";\r\n    WheelDeltaMode[\"Line\"] = \"Line\";\r\n    WheelDeltaMode[\"Page\"] = \"Page\";\r\n})(WheelDeltaMode || (WheelDeltaMode = {}));\r\n\n;// CONCATENATED MODULE: ./Input/NativePointerButton.ts\n/**\r\n * Native browser button enumeration\r\n */\r\nvar NativePointerButton;\r\n(function (NativePointerButton) {\r\n    NativePointerButton[NativePointerButton[\"NoButton\"] = -1] = \"NoButton\";\r\n    NativePointerButton[NativePointerButton[\"Left\"] = 0] = \"Left\";\r\n    NativePointerButton[NativePointerButton[\"Middle\"] = 1] = \"Middle\";\r\n    NativePointerButton[NativePointerButton[\"Right\"] = 2] = \"Right\";\r\n    NativePointerButton[NativePointerButton[\"Unknown\"] = 3] = \"Unknown\";\r\n})(NativePointerButton || (NativePointerButton = {}));\r\n\n;// CONCATENATED MODULE: ./Input/PointerButton.ts\n/**\r\n * The mouse button being pressed.\r\n */\r\nvar PointerButton;\r\n(function (PointerButton) {\r\n    PointerButton[\"Left\"] = \"Left\";\r\n    PointerButton[\"Middle\"] = \"Middle\";\r\n    PointerButton[\"Right\"] = \"Right\";\r\n    PointerButton[\"Unknown\"] = \"Unknown\";\r\n    PointerButton[\"NoButton\"] = \"NoButton\";\r\n})(PointerButton || (PointerButton = {}));\r\n\n;// CONCATENATED MODULE: ./Input/PointerType.ts\n/**\r\n * The type of pointer for a [[PointerEvent]].\r\n */\r\nvar PointerType;\r\n(function (PointerType) {\r\n    PointerType[\"Touch\"] = \"Touch\";\r\n    PointerType[\"Mouse\"] = \"Mouse\";\r\n    PointerType[\"Pen\"] = \"Pen\";\r\n    PointerType[\"Unknown\"] = \"Unknown\";\r\n})(PointerType || (PointerType = {}));\r\n\n;// CONCATENATED MODULE: ./Input/PointerEventReceiver.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Is this event a native touch event?\r\n */\r\nfunction isTouchEvent(value) {\r\n    // Guard for Safari <= 13.1\r\n    return globalThis.TouchEvent && value instanceof globalThis.TouchEvent;\r\n}\r\n/**\r\n * Is this event a native pointer event\r\n */\r\nfunction isPointerEvent(value) {\r\n    // Guard for Safari <= 13.1\r\n    return globalThis.PointerEvent && value instanceof globalThis.PointerEvent;\r\n}\r\n/**\r\n * The PointerEventProcessor is responsible for collecting all the events from the canvas and transforming them into GlobalCoordinates\r\n */\r\nclass PointerEventReceiver extends Class {\r\n    constructor(target, engine) {\r\n        super();\r\n        this.target = target;\r\n        this.engine = engine;\r\n        this.primary = new PointerAbstraction();\r\n        this._activeNativePointerIdsToNormalized = new Map();\r\n        this.lastFramePointerCoords = new Map();\r\n        this.currentFramePointerCoords = new Map();\r\n        this.currentFramePointerDown = new Map();\r\n        this.lastFramePointerDown = new Map();\r\n        this.currentFrameDown = [];\r\n        this.currentFrameUp = [];\r\n        this.currentFrameMove = [];\r\n        this.currentFrameCancel = [];\r\n        this.currentFrameWheel = [];\r\n        this._pointers = [this.primary];\r\n        this._boundHandle = this._handle.bind(this);\r\n        this._boundWheel = this._handleWheel.bind(this);\r\n    }\r\n    /**\r\n     * Creates a new PointerEventReceiver with a new target and engine while preserving existing pointer event\r\n     * handlers.\r\n     * @param target\r\n     * @param engine\r\n     */\r\n    recreate(target, engine) {\r\n        const eventReceiver = new PointerEventReceiver(target, engine);\r\n        eventReceiver.primary = this.primary;\r\n        eventReceiver._pointers = this._pointers;\r\n        return eventReceiver;\r\n    }\r\n    /**\r\n     * Locates a specific pointer by id, creates it if it doesn't exist\r\n     * @param index\r\n     */\r\n    at(index) {\r\n        if (index >= this._pointers.length) {\r\n            // Ensure there is a pointer to retrieve\r\n            for (let i = this._pointers.length - 1, max = index; i < max; i++) {\r\n                this._pointers.push(new PointerAbstraction());\r\n            }\r\n        }\r\n        return this._pointers[index];\r\n    }\r\n    /**\r\n     * The number of pointers currently being tracked by excalibur\r\n     */\r\n    count() {\r\n        return this._pointers.length;\r\n    }\r\n    /**\r\n     * Is the specified pointer id down this frame\r\n     * @param pointerId\r\n     */\r\n    isDown(pointerId) {\r\n        var _a;\r\n        return (_a = this.currentFramePointerDown.get(pointerId)) !== null && _a !== void 0 ? _a : false;\r\n    }\r\n    /**\r\n     * Was the specified pointer id down last frame\r\n     * @param pointerId\r\n     */\r\n    wasDown(pointerId) {\r\n        var _a;\r\n        return (_a = this.lastFramePointerDown.get(pointerId)) !== null && _a !== void 0 ? _a : false;\r\n    }\r\n    /**\r\n     * Whether the Pointer is currently dragging.\r\n     */\r\n    isDragging(pointerId) {\r\n        return this.isDown(pointerId);\r\n    }\r\n    /**\r\n     * Whether the Pointer just started dragging.\r\n     */\r\n    isDragStart(pointerId) {\r\n        return this.isDown(pointerId) && !this.wasDown(pointerId);\r\n    }\r\n    /**\r\n     * Whether the Pointer just ended dragging.\r\n     */\r\n    isDragEnd(pointerId) {\r\n        return !this.isDown(pointerId) && this.wasDown(pointerId);\r\n    }\r\n    on(event, handler) {\r\n        super.on(event, handler);\r\n    }\r\n    once(event, handler) {\r\n        super.once(event, handler);\r\n    }\r\n    off(event, handler) {\r\n        super.off(event, handler);\r\n    }\r\n    /**\r\n     * Called internally by excalibur\r\n     *\r\n     * Updates the current frame pointer info and emits raw pointer events\r\n     *\r\n     * This does not emit events to entities, see PointerSystem\r\n     */\r\n    update() {\r\n        this.lastFramePointerDown = new Map(this.currentFramePointerDown);\r\n        this.lastFramePointerCoords = new Map(this.currentFramePointerCoords);\r\n        for (const event of this.currentFrameDown) {\r\n            this.emit('down', event);\r\n            const pointer = this.at(event.pointerId);\r\n            pointer.emit('down', event);\r\n            this.primary.emit('pointerdown', event);\r\n        }\r\n        for (const event of this.currentFrameUp) {\r\n            this.emit('up', event);\r\n            const pointer = this.at(event.pointerId);\r\n            pointer.emit('up', event);\r\n        }\r\n        for (const event of this.currentFrameMove) {\r\n            this.emit('move', event);\r\n            const pointer = this.at(event.pointerId);\r\n            pointer.emit('move', event);\r\n        }\r\n        for (const event of this.currentFrameCancel) {\r\n            this.emit('cancel', event);\r\n            const pointer = this.at(event.pointerId);\r\n            pointer.emit('cancel', event);\r\n        }\r\n        for (const event of this.currentFrameWheel) {\r\n            this.emit('wheel', event);\r\n            this.primary.emit('pointerwheel', event);\r\n        }\r\n    }\r\n    /**\r\n     * Clears the current frame event and pointer data\r\n     */\r\n    clear() {\r\n        for (const event of this.currentFrameUp) {\r\n            this.currentFramePointerCoords.delete(event.pointerId);\r\n            const ids = this._activeNativePointerIdsToNormalized.entries();\r\n            for (const [native, normalized] of ids) {\r\n                if (normalized === event.pointerId) {\r\n                    this._activeNativePointerIdsToNormalized.delete(native);\r\n                }\r\n            }\r\n        }\r\n        this.currentFrameDown.length = 0;\r\n        this.currentFrameUp.length = 0;\r\n        this.currentFrameMove.length = 0;\r\n        this.currentFrameCancel.length = 0;\r\n        this.currentFrameWheel.length = 0;\r\n    }\r\n    /**\r\n     * Initializes the pointer event receiver so that it can start listening to native\r\n     * browser events.\r\n     */\r\n    init() {\r\n        // Disabling the touch action avoids browser/platform gestures from firing on the canvas\r\n        // It is important on mobile to have touch action 'none'\r\n        // https://stackoverflow.com/questions/48124372/pointermove-event-not-working-with-touch-why-not\r\n        if (this.target === this.engine.canvas) {\r\n            this.engine.canvas.style.touchAction = 'none';\r\n        }\r\n        else {\r\n            document.body.style.touchAction = 'none';\r\n        }\r\n        // Preferred pointer events\r\n        if (window.PointerEvent) {\r\n            this.target.addEventListener('pointerdown', this._boundHandle);\r\n            this.target.addEventListener('pointerup', this._boundHandle);\r\n            this.target.addEventListener('pointermove', this._boundHandle);\r\n            this.target.addEventListener('pointercancel', this._boundHandle);\r\n        }\r\n        else {\r\n            // Touch Events\r\n            this.target.addEventListener('touchstart', this._boundHandle);\r\n            this.target.addEventListener('touchend', this._boundHandle);\r\n            this.target.addEventListener('touchmove', this._boundHandle);\r\n            this.target.addEventListener('touchcancel', this._boundHandle);\r\n            // Mouse Events\r\n            this.target.addEventListener('mousedown', this._boundHandle);\r\n            this.target.addEventListener('mouseup', this._boundHandle);\r\n            this.target.addEventListener('mousemove', this._boundHandle);\r\n        }\r\n        // MDN MouseWheelEvent\r\n        const wheelOptions = {\r\n            passive: !(this.engine.pageScrollPreventionMode === ScrollPreventionMode.All ||\r\n                this.engine.pageScrollPreventionMode === ScrollPreventionMode.Canvas)\r\n        };\r\n        if ('onwheel' in document.createElement('div')) {\r\n            // Modern Browsers\r\n            this.target.addEventListener('wheel', this._boundWheel, wheelOptions);\r\n        }\r\n        else if (document.onmousewheel !== undefined) {\r\n            // Webkit and IE\r\n            this.target.addEventListener('mousewheel', this._boundWheel, wheelOptions);\r\n        }\r\n        else {\r\n            // Remaining browser and older Firefox\r\n            this.target.addEventListener('MozMousePixelScroll', this._boundWheel, wheelOptions);\r\n        }\r\n    }\r\n    detach() {\r\n        // Preferred pointer events\r\n        if (window.PointerEvent) {\r\n            this.target.removeEventListener('pointerdown', this._boundHandle);\r\n            this.target.removeEventListener('pointerup', this._boundHandle);\r\n            this.target.removeEventListener('pointermove', this._boundHandle);\r\n            this.target.removeEventListener('pointercancel', this._boundHandle);\r\n        }\r\n        else {\r\n            // Touch Events\r\n            this.target.removeEventListener('touchstart', this._boundHandle);\r\n            this.target.removeEventListener('touchend', this._boundHandle);\r\n            this.target.removeEventListener('touchmove', this._boundHandle);\r\n            this.target.removeEventListener('touchcancel', this._boundHandle);\r\n            // Mouse Events\r\n            this.target.removeEventListener('mousedown', this._boundHandle);\r\n            this.target.removeEventListener('mouseup', this._boundHandle);\r\n            this.target.removeEventListener('mousemove', this._boundHandle);\r\n        }\r\n        if ('onwheel' in document.createElement('div')) {\r\n            // Modern Browsers\r\n            this.target.removeEventListener('wheel', this._boundWheel);\r\n        }\r\n        else if (document.onmousewheel !== undefined) {\r\n            // Webkit and IE\r\n            this.target.addEventListener('mousewheel', this._boundWheel);\r\n        }\r\n        else {\r\n            // Remaining browser and older Firefox\r\n            this.target.addEventListener('MozMousePixelScroll', this._boundWheel);\r\n        }\r\n    }\r\n    /**\r\n     * Take native pointer id and map it to index in active pointers\r\n     * @param nativePointerId\r\n     */\r\n    _normalizePointerId(nativePointerId) {\r\n        // Add to the the native pointer set id\r\n        this._activeNativePointerIdsToNormalized.set(nativePointerId, -1);\r\n        // Native pointer ids in ascending order\r\n        const currentPointerIds = Array.from(this._activeNativePointerIdsToNormalized.keys()).sort((a, b) => a - b);\r\n        // The index into sorted ids will be the new id, will always have an id\r\n        const id = currentPointerIds.findIndex(p => p === nativePointerId);\r\n        // Save the mapping so we can reverse it later\r\n        this._activeNativePointerIdsToNormalized.set(nativePointerId, id);\r\n        // ignore pointer because game isn't watching\r\n        return id;\r\n    }\r\n    /**\r\n     * Responsible for handling and parsing pointer events\r\n     */\r\n    _handle(ev) {\r\n        ev.preventDefault();\r\n        const eventCoords = new Map();\r\n        let button;\r\n        let pointerType;\r\n        if (isTouchEvent(ev)) {\r\n            button = PointerButton.Unknown;\r\n            pointerType = PointerType.Touch;\r\n            // https://developer.mozilla.org/en-US/docs/Web/API/TouchEvent\r\n            for (let i = 0; i < ev.changedTouches.length; i++) {\r\n                const touch = ev.changedTouches[i];\r\n                const coordinates = GlobalCoordinates.fromPagePosition(touch.pageX, touch.pageY, this.engine);\r\n                const nativePointerId = i + 1;\r\n                const pointerId = this._normalizePointerId(nativePointerId);\r\n                this.currentFramePointerCoords.set(pointerId, coordinates);\r\n                eventCoords.set(pointerId, coordinates);\r\n            }\r\n        }\r\n        else {\r\n            button = this._nativeButtonToPointerButton(ev.button);\r\n            pointerType = PointerType.Mouse;\r\n            const coordinates = GlobalCoordinates.fromPagePosition(ev.pageX, ev.pageY, this.engine);\r\n            let nativePointerId = 1;\r\n            if (isPointerEvent(ev)) {\r\n                nativePointerId = ev.pointerId;\r\n                pointerType = this._stringToPointerType(ev.pointerType);\r\n            }\r\n            const pointerId = this._normalizePointerId(nativePointerId);\r\n            this.currentFramePointerCoords.set(pointerId, coordinates);\r\n            eventCoords.set(pointerId, coordinates);\r\n        }\r\n        for (const [pointerId, coord] of eventCoords.entries()) {\r\n            switch (ev.type) {\r\n                case 'mousedown':\r\n                case 'pointerdown':\r\n                case 'touchstart':\r\n                    this.currentFrameDown.push(new PointerEvent('down', pointerId, button, pointerType, coord, ev));\r\n                    this.currentFramePointerDown.set(pointerId, true);\r\n                    break;\r\n                case 'mouseup':\r\n                case 'pointerup':\r\n                case 'touchend':\r\n                    this.currentFrameUp.push(new PointerEvent('up', pointerId, button, pointerType, coord, ev));\r\n                    this.currentFramePointerDown.set(pointerId, false);\r\n                    break;\r\n                case 'mousemove':\r\n                case 'pointermove':\r\n                case 'touchmove':\r\n                    this.currentFrameMove.push(new PointerEvent('move', pointerId, button, pointerType, coord, ev));\r\n                    break;\r\n                case 'touchcancel':\r\n                case 'pointercancel':\r\n                    this.currentFrameCancel.push(new PointerEvent('cancel', pointerId, button, pointerType, coord, ev));\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n    _handleWheel(ev) {\r\n        // Should we prevent page scroll because of this event\r\n        if (this.engine.pageScrollPreventionMode === ScrollPreventionMode.All ||\r\n            (this.engine.pageScrollPreventionMode === ScrollPreventionMode.Canvas && ev.target === this.engine.canvas)) {\r\n            ev.preventDefault();\r\n        }\r\n        const screen = this.engine.screen.pageToScreenCoordinates(vec(ev.pageX, ev.pageY));\r\n        const world = this.engine.screen.screenToWorldCoordinates(screen);\r\n        /**\r\n         * A constant used to normalize wheel events across different browsers\r\n         *\r\n         * This normalization factor is pulled from\r\n         * https://developer.mozilla.org/en-US/docs/Web/Events/wheel#Listening_to_this_event_across_browser\r\n         */\r\n        const ScrollWheelNormalizationFactor = -1 / 40;\r\n        const deltaX = ev.deltaX || ev.wheelDeltaX * ScrollWheelNormalizationFactor || 0;\r\n        const deltaY = ev.deltaY || ev.wheelDeltaY * ScrollWheelNormalizationFactor || ev.wheelDelta * ScrollWheelNormalizationFactor || ev.detail || 0;\r\n        const deltaZ = ev.deltaZ || 0;\r\n        let deltaMode = WheelDeltaMode.Pixel;\r\n        if (ev.deltaMode) {\r\n            if (ev.deltaMode === 1) {\r\n                deltaMode = WheelDeltaMode.Line;\r\n            }\r\n            else if (ev.deltaMode === 2) {\r\n                deltaMode = WheelDeltaMode.Page;\r\n            }\r\n        }\r\n        const we = new WheelEvent(world.x, world.y, ev.pageX, ev.pageY, screen.x, screen.y, 0, deltaX, deltaY, deltaZ, deltaMode, ev);\r\n        this.currentFrameWheel.push(we);\r\n    }\r\n    /**\r\n     * Triggers an excalibur pointer event in a world space pos\r\n     *\r\n     * Useful for testing pointers in excalibur\r\n     * @param type\r\n     * @param pos\r\n     */\r\n    triggerEvent(type, pos) {\r\n        const page = this.engine.screen.worldToPageCoordinates(pos);\r\n        // Send an event to the event receiver\r\n        if (window.PointerEvent) {\r\n            this._handle(new window.PointerEvent('pointer' + type, {\r\n                pointerId: 0,\r\n                clientX: page.x,\r\n                clientY: page.y\r\n            }));\r\n        }\r\n        else {\r\n            // Safari hack\r\n            this._handle(new window.MouseEvent('mouse' + type, {\r\n                clientX: page.x,\r\n                clientY: page.y\r\n            }));\r\n        }\r\n        // Force update pointer system\r\n        const pointerSystem = this.engine.currentScene.world.systemManager.get(PointerSystem);\r\n        const transformEntities = this.engine.currentScene.world.queryManager.createQuery(pointerSystem.types);\r\n        pointerSystem.preupdate();\r\n        pointerSystem.update(transformEntities.getEntities());\r\n    }\r\n    _nativeButtonToPointerButton(s) {\r\n        switch (s) {\r\n            case NativePointerButton.NoButton:\r\n                return PointerButton.NoButton;\r\n            case NativePointerButton.Left:\r\n                return PointerButton.Left;\r\n            case NativePointerButton.Middle:\r\n                return PointerButton.Middle;\r\n            case NativePointerButton.Right:\r\n                return PointerButton.Right;\r\n            case NativePointerButton.Unknown:\r\n                return PointerButton.Unknown;\r\n            default:\r\n                return fail(s);\r\n        }\r\n    }\r\n    _stringToPointerType(s) {\r\n        switch (s) {\r\n            case 'touch':\r\n                return PointerType.Touch;\r\n            case 'mouse':\r\n                return PointerType.Mouse;\r\n            case 'pen':\r\n                return PointerType.Pen;\r\n            default:\r\n                return PointerType.Unknown;\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Fps.ts\nclass FpsSampler {\r\n    constructor(options) {\r\n        var _a;\r\n        this._samplePeriod = 100;\r\n        this._currentFrameTime = 0;\r\n        this._frames = 0;\r\n        this._previousSampleTime = 0;\r\n        this._beginFrameTime = 0;\r\n        this._fps = options.initialFps;\r\n        this._samplePeriod = (_a = options.samplePeriod) !== null && _a !== void 0 ? _a : this._samplePeriod;\r\n        this._currentFrameTime = 1000 / options.initialFps;\r\n        this._nowFn = options.nowFn;\r\n        this._previousSampleTime = this._nowFn();\r\n    }\r\n    /**\r\n     * Start of code block to sample FPS for\r\n     */\r\n    start() {\r\n        this._beginFrameTime = this._nowFn();\r\n    }\r\n    /**\r\n     * End of code block to sample FPS for\r\n     */\r\n    end() {\r\n        this._frames++;\r\n        const time = this._nowFn();\r\n        this._currentFrameTime = time - this._beginFrameTime;\r\n        if (time >= this._previousSampleTime + this._samplePeriod) {\r\n            this._fps = (this._frames * 1000) / (time - this._previousSampleTime);\r\n            this._previousSampleTime = time;\r\n            this._frames = 0;\r\n        }\r\n    }\r\n    /**\r\n     * Return the currently sampled fps over the last sample period, by default every 100ms\r\n     */\r\n    get fps() {\r\n        return this._fps;\r\n    }\r\n    /**\r\n     * Return the instantaneous fps, this can be less useful because it will fluctuate given the current frames time\r\n     */\r\n    get instant() {\r\n        return 1000 / this._currentFrameTime;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Clock.ts\n\r\n\r\n/**\r\n * Abstract Clock is the base type of all Clocks\r\n *\r\n * It has a few opinions\r\n * 1. It manages the calculation of what \"elapsed\" time means and thus maximum fps\r\n * 2. The default timing api is implemented in now()\r\n *\r\n * To implement your own clock, extend Clock and override start/stop to start and stop the clock, then call update() with whatever\r\n * method is unique to your clock implementation.\r\n */\r\nclass Clock {\r\n    constructor(options) {\r\n        var _a, _b, _c;\r\n        this._onFatalException = () => { };\r\n        this._maxFps = Infinity;\r\n        this._lastTime = 0;\r\n        this._elapsed = 1;\r\n        this._scheduledCbs = [];\r\n        this._totalElapsed = 0;\r\n        this._options = options;\r\n        this.tick = options.tick;\r\n        this._lastTime = (_a = this.now()) !== null && _a !== void 0 ? _a : 0;\r\n        this._maxFps = (_b = options.maxFps) !== null && _b !== void 0 ? _b : this._maxFps;\r\n        this._onFatalException = (_c = options.onFatalException) !== null && _c !== void 0 ? _c : this._onFatalException;\r\n        this.fpsSampler = new FpsSampler({\r\n            initialFps: 60,\r\n            nowFn: () => this.now()\r\n        });\r\n    }\r\n    /**\r\n     * Get the elapsed time for the last completed frame\r\n     */\r\n    elapsed() {\r\n        return this._elapsed;\r\n    }\r\n    /**\r\n     * Get the current time in milliseconds\r\n     */\r\n    now() {\r\n        return performance.now();\r\n    }\r\n    toTestClock() {\r\n        const testClock = new TestClock({\r\n            ...this._options,\r\n            defaultUpdateMs: 16.6\r\n        });\r\n        return testClock;\r\n    }\r\n    toStandardClock() {\r\n        const clock = new StandardClock({\r\n            ...this._options\r\n        });\r\n        return clock;\r\n    }\r\n    setFatalExceptionHandler(handler) {\r\n        this._onFatalException = handler;\r\n    }\r\n    /**\r\n     * Schedule a callback to fire given a timeout in milliseconds using the excalibur [[Clock]]\r\n     *\r\n     * This is useful to use over the built in browser `setTimeout` because callbacks will be tied to the\r\n     * excalibur update clock, instead of browser time, this means that callbacks wont fire if the game is\r\n     * stopped or paused.\r\n     *\r\n     * @param cb callback to fire\r\n     * @param timeoutMs Optionally specify a timeout in milliseconds from now, default is 0ms which means the next possible tick\r\n     */\r\n    schedule(cb, timeoutMs = 0) {\r\n        // Scheduled based on internal elapsed time\r\n        const scheduledTime = this._totalElapsed + timeoutMs;\r\n        this._scheduledCbs.push([cb, scheduledTime]);\r\n    }\r\n    _runScheduledCbs() {\r\n        // walk backwards to delete items as we loop\r\n        for (let i = this._scheduledCbs.length - 1; i > -1; i--) {\r\n            if (this._scheduledCbs[i][1] <= this._totalElapsed) {\r\n                this._scheduledCbs[i][0]();\r\n                this._scheduledCbs.splice(i, 1);\r\n            }\r\n        }\r\n    }\r\n    update(overrideUpdateMs) {\r\n        try {\r\n            this.fpsSampler.start();\r\n            // Get the time to calculate time-elapsed\r\n            const now = this.now();\r\n            let elapsed = now - this._lastTime || 1; // first frame\r\n            // Constrain fps\r\n            const fpsInterval = (1000 / this._maxFps);\r\n            // only run frame if enough time has elapsed\r\n            if (elapsed >= fpsInterval) {\r\n                let leftover = 0;\r\n                if (fpsInterval !== 0) {\r\n                    leftover = (elapsed % fpsInterval);\r\n                    elapsed = elapsed - leftover; // shift elapsed to be \"in phase\" with the current loop fps\r\n                }\r\n                // Resolves issue #138 if the game has been paused, or blurred for\r\n                // more than a 200 milliseconds, reset elapsed time to 1. This improves reliability\r\n                // and provides more expected behavior when the engine comes back\r\n                // into focus\r\n                if (elapsed > 200) {\r\n                    elapsed = 1;\r\n                }\r\n                // tick the mainloop and run scheduled callbacks\r\n                this._elapsed = overrideUpdateMs || elapsed;\r\n                this._totalElapsed += this._elapsed;\r\n                this._runScheduledCbs();\r\n                this.tick(overrideUpdateMs || elapsed);\r\n                if (fpsInterval !== 0) {\r\n                    this._lastTime = now - leftover;\r\n                }\r\n                else {\r\n                    this._lastTime = now;\r\n                }\r\n                this.fpsSampler.end();\r\n            }\r\n        }\r\n        catch (e) {\r\n            this._onFatalException(e);\r\n            this.stop();\r\n        }\r\n    }\r\n}\r\n/**\r\n * The [[StandardClock]] implements the requestAnimationFrame browser api to run the tick()\r\n */\r\nclass StandardClock extends Clock {\r\n    constructor(options) {\r\n        super(options);\r\n        this._running = false;\r\n    }\r\n    isRunning() {\r\n        return this._running;\r\n    }\r\n    start() {\r\n        if (this._running) {\r\n            return;\r\n        }\r\n        this._running = true;\r\n        const mainloop = () => {\r\n            // stop the loop\r\n            if (!this._running) {\r\n                return;\r\n            }\r\n            try {\r\n                // request next loop\r\n                this._requestId = window.requestAnimationFrame(mainloop);\r\n                this.update();\r\n            }\r\n            catch (e) {\r\n                window.cancelAnimationFrame(this._requestId);\r\n                throw e;\r\n            }\r\n        };\r\n        // begin the first frame\r\n        mainloop();\r\n    }\r\n    stop() {\r\n        this._running = false;\r\n    }\r\n}\r\n/**\r\n * The TestClock is meant for debugging interactions in excalibur that require precise timing to replicate or test\r\n */\r\nclass TestClock extends Clock {\r\n    constructor(options) {\r\n        super({\r\n            ...options\r\n        });\r\n        this._logger = Logger.getInstance();\r\n        this._running = false;\r\n        this._currentTime = 0;\r\n        this._updateMs = options.defaultUpdateMs;\r\n    }\r\n    /**\r\n     * Get the current time in milliseconds\r\n     */\r\n    now() {\r\n        var _a;\r\n        return (_a = this._currentTime) !== null && _a !== void 0 ? _a : 0;\r\n    }\r\n    isRunning() {\r\n        return this._running;\r\n    }\r\n    start() {\r\n        this._running = true;\r\n    }\r\n    stop() {\r\n        this._running = false;\r\n    }\r\n    /**\r\n     * Manually step the clock forward 1 tick, optionally specify an elapsed time in milliseconds\r\n     * @param overrideUpdateMs\r\n     */\r\n    step(overrideUpdateMs) {\r\n        const time = overrideUpdateMs !== null && overrideUpdateMs !== void 0 ? overrideUpdateMs : this._updateMs;\r\n        if (this._running) {\r\n            // to be comparable to RAF this needs to be a full blown Task\r\n            // For example, images cannot decode synchronously in a single step\r\n            this.update(time);\r\n            this._currentTime += time;\r\n        }\r\n        else {\r\n            this._logger.warn('The clock is not running, no step will be performed');\r\n        }\r\n    }\r\n    /**\r\n     * Run a number of steps that tick the clock, optionally specify an elapsed time in milliseconds\r\n     * @param numberOfSteps\r\n     * @param overrideUpdateMs\r\n     */\r\n    run(numberOfSteps, overrideUpdateMs) {\r\n        for (let i = 0; i < numberOfSteps; i++) {\r\n            this.step(overrideUpdateMs !== null && overrideUpdateMs !== void 0 ? overrideUpdateMs : this._updateMs);\r\n        }\r\n    }\r\n}\r\n\n// EXTERNAL MODULE: ./Util/Toaster.css\nvar Util_Toaster = __webpack_require__(7379);\n;// CONCATENATED MODULE: ./Util/Toaster.ts\n\r\n/**\r\n * The Toaster is only meant to be called from inside Excalibur to display messages to players\r\n */\r\nclass Toaster {\r\n    constructor() {\r\n        this._toasterCss = Util_Toaster/* default.toString */.Z.toString();\r\n        this._isInitialized = false;\r\n    }\r\n    _initialize() {\r\n        if (!this._isInitialized) {\r\n            this._container = document.createElement('div');\r\n            this._container.id = 'ex-toast-container';\r\n            document.body.appendChild(this._container);\r\n            this._isInitialized = true;\r\n            this._styleBlock = document.createElement('style');\r\n            this._styleBlock.textContent = this._toasterCss;\r\n            document.head.appendChild(this._styleBlock);\r\n        }\r\n    }\r\n    dispose() {\r\n        this._container.parentElement.removeChild(this._container);\r\n        this._styleBlock.parentElement.removeChild(this._styleBlock);\r\n        this._isInitialized = false;\r\n    }\r\n    _createFragment(message) {\r\n        const toastMessage = document.createElement('span');\r\n        toastMessage.innerText = message;\r\n        return toastMessage;\r\n    }\r\n    /**\r\n     * Display a toast message to a player\r\n     * @param message Text of the message, messages may have a single \"[LINK]\" to influence placement\r\n     * @param linkTarget Optionally specify a link location\r\n     * @param linkName Optionally specify a name for that link location\r\n     */\r\n    toast(message, linkTarget, linkName) {\r\n        this._initialize();\r\n        const toast = document.createElement('div');\r\n        toast.className = 'ex-toast-message';\r\n        const messageFragments = message.split('[LINK]').map(message => this._createFragment(message));\r\n        if (linkTarget) {\r\n            const link = document.createElement('a');\r\n            link.href = linkTarget;\r\n            if (linkName) {\r\n                link.innerText = linkName;\r\n            }\r\n            else {\r\n                link.innerText = linkTarget;\r\n            }\r\n            messageFragments.splice(1, 0, link);\r\n        }\r\n        // Assembly message\r\n        const finalMessage = document.createElement('div');\r\n        messageFragments.forEach(message => {\r\n            finalMessage.appendChild(message);\r\n        });\r\n        toast.appendChild(finalMessage);\r\n        // Dismiss button\r\n        const dismissBtn = document.createElement('button');\r\n        dismissBtn.innerText = 'x';\r\n        dismissBtn.addEventListener('click', () => {\r\n            this._container.removeChild(toast);\r\n        });\r\n        toast.appendChild(dismissBtn);\r\n        // Escape to dismiss\r\n        const keydownHandler = (evt) => {\r\n            if (evt.key === 'Escape') {\r\n                try {\r\n                    this._container.removeChild(toast);\r\n                }\r\n                catch (_a) {\r\n                    // pass\r\n                }\r\n            }\r\n            document.removeEventListener('keydown', keydownHandler);\r\n        };\r\n        document.addEventListener('keydown', keydownHandler);\r\n        // Insert into container\r\n        const first = this._container.firstChild;\r\n        this._container.insertBefore(toast, first);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Engine.ts\n\r\n\r\n\r\npolyfill();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Enum representing the different mousewheel event bubble prevention\r\n */\r\nvar ScrollPreventionMode;\r\n(function (ScrollPreventionMode) {\r\n    /**\r\n     * Do not prevent any page scrolling\r\n     */\r\n    ScrollPreventionMode[ScrollPreventionMode[\"None\"] = 0] = \"None\";\r\n    /**\r\n     * Prevent page scroll if mouse is over the game canvas\r\n     */\r\n    ScrollPreventionMode[ScrollPreventionMode[\"Canvas\"] = 1] = \"Canvas\";\r\n    /**\r\n     * Prevent all page scrolling via mouse wheel\r\n     */\r\n    ScrollPreventionMode[ScrollPreventionMode[\"All\"] = 2] = \"All\";\r\n})(ScrollPreventionMode || (ScrollPreventionMode = {}));\r\n/**\r\n * The Excalibur Engine\r\n *\r\n * The [[Engine]] is the main driver for a game. It is responsible for\r\n * starting/stopping the game, maintaining state, transmitting events,\r\n * loading resources, and managing the scene.\r\n */\r\nclass Engine extends Class {\r\n    /**\r\n     * Creates a new game using the given [[EngineOptions]]. By default, if no options are provided,\r\n     * the game will be rendered full screen (taking up all available browser window space).\r\n     * You can customize the game rendering through [[EngineOptions]].\r\n     *\r\n     * Example:\r\n     *\r\n     * ```js\r\n     * var game = new ex.Engine({\r\n     *   width: 0, // the width of the canvas\r\n     *   height: 0, // the height of the canvas\r\n     *   enableCanvasTransparency: true, // the transparencySection of the canvas\r\n     *   canvasElementId: '', // the DOM canvas element ID, if you are providing your own\r\n     *   displayMode: ex.DisplayMode.FullScreen, // the display mode\r\n     *   pointerScope: ex.Input.PointerScope.Document, // the scope of capturing pointer (mouse/touch) events\r\n     *   backgroundColor: ex.Color.fromHex('#2185d0') // background color of the engine\r\n     * });\r\n     *\r\n     * // call game.start, which is a Promise\r\n     * game.start().then(function () {\r\n     *   // ready, set, go!\r\n     * });\r\n     * ```\r\n     */\r\n    constructor(options) {\r\n        var _a, _b, _c, _d, _e, _f;\r\n        super();\r\n        /**\r\n         * Optionally set the maximum fps if not set Excalibur will go as fast as the device allows.\r\n         *\r\n         * You may want to constrain max fps if your game cannot maintain fps consistently, it can look and feel better to have a 30fps game than\r\n         * one that bounces between 30fps and 60fps\r\n         */\r\n        this.maxFps = Number.POSITIVE_INFINITY;\r\n        /**\r\n         * Contains all the scenes currently registered with Excalibur\r\n         */\r\n        this.scenes = {};\r\n        this._suppressPlayButton = false;\r\n        /**\r\n         * Indicates whether audio should be paused when the game is no longer visible.\r\n         */\r\n        this.pauseAudioWhenHidden = true;\r\n        /**\r\n         * Indicates whether the engine should draw with debug information\r\n         */\r\n        this._isDebug = false;\r\n        /**\r\n         * Sets the Transparency for the engine.\r\n         */\r\n        this.enableCanvasTransparency = true;\r\n        /**\r\n         * The action to take when a fatal exception is thrown\r\n         */\r\n        this.onFatalException = (e) => {\r\n            Logger.getInstance().fatal(e);\r\n        };\r\n        this._toaster = new Toaster();\r\n        this._timescale = 1.0;\r\n        this._isInitialized = false;\r\n        this._deferredGoTo = null;\r\n        this._originalOptions = {};\r\n        this._performanceThresholdTriggered = false;\r\n        this._fpsSamples = [];\r\n        this._loadingComplete = false;\r\n        this._isReady = false;\r\n        this._isReadyPromise = new Promise(resolve => {\r\n            this._isReadyResolve = resolve;\r\n        });\r\n        /**\r\n         * Returns the current frames elapsed milliseconds\r\n         */\r\n        this.currentFrameElapsedMs = 0;\r\n        /**\r\n         * Returns the current frame lag when in fixed update mode\r\n         */\r\n        this.currentFrameLagMs = 0;\r\n        this._lagMs = 0;\r\n        this._screenShotRequests = [];\r\n        options = { ...Engine._DEFAULT_ENGINE_OPTIONS, ...options };\r\n        this._originalOptions = options;\r\n        Flags.freeze();\r\n        // Initialize browser events facade\r\n        this.browser = new BrowserEvents(window, document);\r\n        // Check compatibility\r\n        const detector = new Detector();\r\n        if (!options.suppressMinimumBrowserFeatureDetection && !(this._compatible = detector.test())) {\r\n            const message = document.createElement('div');\r\n            message.innerText = 'Sorry, your browser does not support all the features needed for Excalibur';\r\n            document.body.appendChild(message);\r\n            detector.failedTests.forEach(function (test) {\r\n                const testMessage = document.createElement('div');\r\n                testMessage.innerText = 'Browser feature missing ' + test;\r\n                document.body.appendChild(testMessage);\r\n            });\r\n            if (options.canvasElementId) {\r\n                const canvas = document.getElementById(options.canvasElementId);\r\n                if (canvas) {\r\n                    canvas.parentElement.removeChild(canvas);\r\n                }\r\n            }\r\n            return;\r\n        }\r\n        else {\r\n            this._compatible = true;\r\n        }\r\n        // Use native console API for color fun\r\n        // eslint-disable-next-line no-console\r\n        if (console.log && !options.suppressConsoleBootMessage) {\r\n            // eslint-disable-next-line no-console\r\n            console.log(`%cPowered by Excalibur.js (v${EX_VERSION})`, 'background: #176BAA; color: white; border-radius: 5px; padding: 15px; font-size: 1.5em; line-height: 80px;');\r\n            // eslint-disable-next-line no-console\r\n            console.log('\\n\\\r\n      /| ________________\\n\\\r\nO|===|* >________________>\\n\\\r\n      \\\\|');\r\n            // eslint-disable-next-line no-console\r\n            console.log('Visit', 'http://excaliburjs.com', 'for more information');\r\n        }\r\n        // Suppress play button\r\n        if (options.suppressPlayButton) {\r\n            this._suppressPlayButton = true;\r\n        }\r\n        this._logger = Logger.getInstance();\r\n        // If debug is enabled, let's log browser features to the console.\r\n        if (this._logger.defaultLevel === LogLevel.Debug) {\r\n            detector.logBrowserFeatures();\r\n        }\r\n        this._logger.debug('Building engine...');\r\n        this.canvasElementId = options.canvasElementId;\r\n        if (options.canvasElementId) {\r\n            this._logger.debug('Using Canvas element specified: ' + options.canvasElementId);\r\n            this.canvas = document.getElementById(options.canvasElementId);\r\n        }\r\n        else if (options.canvasElement) {\r\n            this._logger.debug('Using Canvas element specified:', options.canvasElement);\r\n            this.canvas = options.canvasElement;\r\n        }\r\n        else {\r\n            this._logger.debug('Using generated canvas element');\r\n            this.canvas = document.createElement('canvas');\r\n        }\r\n        let displayMode = (_a = options.displayMode) !== null && _a !== void 0 ? _a : DisplayMode.Fixed;\r\n        if ((options.width && options.height) || options.viewport) {\r\n            if (options.displayMode === undefined) {\r\n                displayMode = DisplayMode.Fixed;\r\n            }\r\n            this._logger.debug('Engine viewport is size ' + options.width + ' x ' + options.height);\r\n        }\r\n        else if (!options.displayMode) {\r\n            this._logger.debug('Engine viewport is fit');\r\n            displayMode = DisplayMode.FitScreen;\r\n        }\r\n        this._originalDisplayMode = displayMode;\r\n        // Canvas 2D fallback can be flagged on\r\n        let useCanvasGraphicsContext = Flags.isEnabled('use-canvas-context');\r\n        if (!useCanvasGraphicsContext) {\r\n            // Attempt webgl first\r\n            try {\r\n                this.graphicsContext = new ExcaliburGraphicsContextWebGL({\r\n                    canvasElement: this.canvas,\r\n                    enableTransparency: this.enableCanvasTransparency,\r\n                    smoothing: options.antialiasing,\r\n                    backgroundColor: options.backgroundColor,\r\n                    snapToPixel: options.snapToPixel,\r\n                    useDrawSorting: options.useDrawSorting\r\n                });\r\n            }\r\n            catch (e) {\r\n                this._logger.warn(`Excalibur could not load webgl for some reason (${e.message}) and loaded a Canvas 2D fallback. ` +\r\n                    `Some features of Excalibur will not work in this mode. \\n\\n` +\r\n                    'Read more about this issue at https://excaliburjs.com/docs/webgl');\r\n                // fallback to canvas in case of failure\r\n                useCanvasGraphicsContext = true;\r\n            }\r\n        }\r\n        if (useCanvasGraphicsContext) {\r\n            this.graphicsContext = new ExcaliburGraphicsContext2DCanvas({\r\n                canvasElement: this.canvas,\r\n                enableTransparency: this.enableCanvasTransparency,\r\n                smoothing: options.antialiasing,\r\n                backgroundColor: options.backgroundColor,\r\n                snapToPixel: options.snapToPixel,\r\n                useDrawSorting: options.useDrawSorting\r\n            });\r\n        }\r\n        this.screen = new Screen({\r\n            canvas: this.canvas,\r\n            context: this.graphicsContext,\r\n            antialiasing: (_b = options.antialiasing) !== null && _b !== void 0 ? _b : true,\r\n            browser: this.browser,\r\n            viewport: (_c = options.viewport) !== null && _c !== void 0 ? _c : (options.width && options.height ? { width: options.width, height: options.height } : Resolution.SVGA),\r\n            resolution: options.resolution,\r\n            displayMode,\r\n            pixelRatio: options.suppressHiDPIScaling ? 1 : ((_d = options.pixelRatio) !== null && _d !== void 0 ? _d : null)\r\n        });\r\n        // Set default filtering based on antialiasing\r\n        TextureLoader.filtering = options.antialiasing ? ImageFiltering.Blended : ImageFiltering.Pixel;\r\n        if (options.backgroundColor) {\r\n            this.backgroundColor = options.backgroundColor.clone();\r\n        }\r\n        this.maxFps = (_e = options.maxFps) !== null && _e !== void 0 ? _e : this.maxFps;\r\n        this.fixedUpdateFps = (_f = options.fixedUpdateFps) !== null && _f !== void 0 ? _f : this.fixedUpdateFps;\r\n        this.clock = new StandardClock({\r\n            maxFps: this.maxFps,\r\n            tick: this._mainloop.bind(this),\r\n            onFatalException: (e) => this.onFatalException(e)\r\n        });\r\n        this.enableCanvasTransparency = options.enableCanvasTransparency;\r\n        this._loader = new Loader();\r\n        this._loader.wireEngine(this);\r\n        this.debug = new Debug(this);\r\n        this._initialize(options);\r\n        this.rootScene = this.currentScene = new Scene();\r\n        this.addScene('root', this.rootScene);\r\n        window.___EXCALIBUR_DEVTOOL = this;\r\n    }\r\n    /**\r\n     * The width of the game canvas in pixels (physical width component of the\r\n     * resolution of the canvas element)\r\n     */\r\n    get canvasWidth() {\r\n        return this.screen.canvasWidth;\r\n    }\r\n    /**\r\n     * Returns half width of the game canvas in pixels (half physical width component)\r\n     */\r\n    get halfCanvasWidth() {\r\n        return this.screen.halfCanvasWidth;\r\n    }\r\n    /**\r\n     * The height of the game canvas in pixels, (physical height component of\r\n     * the resolution of the canvas element)\r\n     */\r\n    get canvasHeight() {\r\n        return this.screen.canvasHeight;\r\n    }\r\n    /**\r\n     * Returns half height of the game canvas in pixels (half physical height component)\r\n     */\r\n    get halfCanvasHeight() {\r\n        return this.screen.halfCanvasHeight;\r\n    }\r\n    /**\r\n     * Returns the width of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get drawWidth() {\r\n        return this.screen.drawWidth;\r\n    }\r\n    /**\r\n     * Returns half the width of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get halfDrawWidth() {\r\n        return this.screen.halfDrawWidth;\r\n    }\r\n    /**\r\n     * Returns the height of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get drawHeight() {\r\n        return this.screen.drawHeight;\r\n    }\r\n    /**\r\n     * Returns half the height of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get halfDrawHeight() {\r\n        return this.screen.halfDrawHeight;\r\n    }\r\n    /**\r\n     * Returns whether excalibur detects the current screen to be HiDPI\r\n     */\r\n    get isHiDpi() {\r\n        return this.screen.isHiDpi;\r\n    }\r\n    /**\r\n     * Access [[stats]] that holds frame statistics.\r\n     */\r\n    get stats() {\r\n        return this.debug.stats;\r\n    }\r\n    /**\r\n     * Indicates whether the engine is set to fullscreen or not\r\n     */\r\n    get isFullscreen() {\r\n        return this.screen.isFullScreen;\r\n    }\r\n    /**\r\n     * Indicates the current [[DisplayMode]] of the engine.\r\n     */\r\n    get displayMode() {\r\n        return this.screen.displayMode;\r\n    }\r\n    /**\r\n     * Returns the calculated pixel ration for use in rendering\r\n     */\r\n    get pixelRatio() {\r\n        return this.screen.pixelRatio;\r\n    }\r\n    get isDebug() {\r\n        return this._isDebug;\r\n    }\r\n    /**\r\n     * Hints the graphics context to truncate fractional world space coordinates\r\n     */\r\n    get snapToPixel() {\r\n        return this.graphicsContext.snapToPixel;\r\n    }\r\n    ;\r\n    set snapToPixel(shouldSnapToPixel) {\r\n        this.graphicsContext.snapToPixel = shouldSnapToPixel;\r\n    }\r\n    ;\r\n    on(eventName, handler) {\r\n        super.on(eventName, handler);\r\n    }\r\n    once(eventName, handler) {\r\n        super.once(eventName, handler);\r\n    }\r\n    off(eventName, handler) {\r\n        super.off(eventName, handler);\r\n    }\r\n    _monitorPerformanceThresholdAndTriggerFallback() {\r\n        const { allow } = this._originalOptions.configurePerformanceCanvas2DFallback;\r\n        let { threshold, showPlayerMessage } = this._originalOptions.configurePerformanceCanvas2DFallback;\r\n        if (threshold === undefined) {\r\n            threshold = Engine._DEFAULT_ENGINE_OPTIONS.configurePerformanceCanvas2DFallback.threshold;\r\n        }\r\n        if (showPlayerMessage === undefined) {\r\n            showPlayerMessage = Engine._DEFAULT_ENGINE_OPTIONS.configurePerformanceCanvas2DFallback.showPlayerMessage;\r\n        }\r\n        if (!Flags.isEnabled('use-canvas-context') && allow && this.ready && !this._performanceThresholdTriggered) {\r\n            // Calculate Average fps for last X number of frames after start\r\n            if (this._fpsSamples.length === threshold.numberOfFrames) {\r\n                this._fpsSamples.splice(0, 1);\r\n            }\r\n            this._fpsSamples.push(this.clock.fpsSampler.fps);\r\n            let total = 0;\r\n            for (let i = 0; i < this._fpsSamples.length; i++) {\r\n                total += this._fpsSamples[i];\r\n            }\r\n            const average = total / this._fpsSamples.length;\r\n            if (this._fpsSamples.length === threshold.numberOfFrames) {\r\n                if (average <= threshold.fps) {\r\n                    this._performanceThresholdTriggered = true;\r\n                    this._logger.warn(`Switching to browser 2D Canvas fallback due to performance. Some features of Excalibur will not work in this mode.\\n` +\r\n                        'this might mean your browser doesn\\'t have webgl enabled or hardware acceleration is unavailable.\\n\\n' +\r\n                        'If in Chrome:\\n' +\r\n                        '  * Visit Settings > Advanced > System, and ensure \"Use Hardware Acceleration\" is checked.\\n' +\r\n                        '  * Visit chrome://flags/#ignore-gpu-blocklist and ensure \"Override software rendering list\" is \"enabled\"\\n' +\r\n                        'If in Firefox, visit about:config\\n' +\r\n                        '  * Ensure webgl.disabled = false\\n' +\r\n                        '  * Ensure webgl.force-enabled = true\\n' +\r\n                        '  * Ensure layers.acceleration.force-enabled = true\\n\\n' +\r\n                        'Read more about this issue at https://excaliburjs.com/docs/performance');\r\n                    if (showPlayerMessage) {\r\n                        this._toaster.toast('Excalibur is encountering performance issues. ' +\r\n                            'It\\'s possible that your browser doesn\\'t have hardware acceleration enabled. ' +\r\n                            'Visit [LINK] for more information and potential solutions.', 'https://excaliburjs.com/docs/performance');\r\n                    }\r\n                    this.useCanvas2DFallback();\r\n                    this.emit('fallbackgraphicscontext', this.graphicsContext);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Switches the engine's graphics context to the 2D Canvas.\r\n     * @warning Some features of Excalibur will not work in this mode.\r\n     */\r\n    useCanvas2DFallback() {\r\n        var _a, _b, _c;\r\n        // Swap out the canvas\r\n        const newCanvas = this.canvas.cloneNode(false);\r\n        this.canvas.parentNode.replaceChild(newCanvas, this.canvas);\r\n        this.canvas = newCanvas;\r\n        const options = this._originalOptions;\r\n        const displayMode = this._originalDisplayMode;\r\n        // New graphics context\r\n        this.graphicsContext = new ExcaliburGraphicsContext2DCanvas({\r\n            canvasElement: this.canvas,\r\n            enableTransparency: this.enableCanvasTransparency,\r\n            smoothing: options.antialiasing,\r\n            backgroundColor: options.backgroundColor,\r\n            snapToPixel: options.snapToPixel,\r\n            useDrawSorting: options.useDrawSorting\r\n        });\r\n        // Reset screen\r\n        if (this.screen) {\r\n            this.screen.dispose();\r\n        }\r\n        this.screen = new Screen({\r\n            canvas: this.canvas,\r\n            context: this.graphicsContext,\r\n            antialiasing: (_a = options.antialiasing) !== null && _a !== void 0 ? _a : true,\r\n            browser: this.browser,\r\n            viewport: (_b = options.viewport) !== null && _b !== void 0 ? _b : (options.width && options.height ? { width: options.width, height: options.height } : Resolution.SVGA),\r\n            resolution: options.resolution,\r\n            displayMode,\r\n            pixelRatio: options.suppressHiDPIScaling ? 1 : ((_c = options.pixelRatio) !== null && _c !== void 0 ? _c : null)\r\n        });\r\n        this.screen.setCurrentCamera(this.currentScene.camera);\r\n        // Reset pointers\r\n        this.input.pointers.detach();\r\n        const pointerTarget = options && options.pointerScope === PointerScope.Document ? document : this.canvas;\r\n        this.input.pointers = this.input.pointers.recreate(pointerTarget, this);\r\n        this.input.pointers.init();\r\n    }\r\n    /**\r\n     * Returns a BoundingBox of the top left corner of the screen\r\n     * and the bottom right corner of the screen.\r\n     */\r\n    getWorldBounds() {\r\n        return this.screen.getWorldBounds();\r\n    }\r\n    /**\r\n     * Gets the current engine timescale factor (default is 1.0 which is 1:1 time)\r\n     */\r\n    get timescale() {\r\n        return this._timescale;\r\n    }\r\n    /**\r\n     * Sets the current engine timescale factor. Useful for creating slow-motion effects or fast-forward effects\r\n     * when using time-based movement.\r\n     */\r\n    set timescale(value) {\r\n        if (value <= 0) {\r\n            Logger.getInstance().error('Cannot set engine.timescale to a value of 0 or less than 0.');\r\n            return;\r\n        }\r\n        this._timescale = value;\r\n    }\r\n    /**\r\n     * Adds a [[Timer]] to the [[currentScene]].\r\n     * @param timer  The timer to add to the [[currentScene]].\r\n     */\r\n    addTimer(timer) {\r\n        return this.currentScene.addTimer(timer);\r\n    }\r\n    /**\r\n     * Removes a [[Timer]] from the [[currentScene]].\r\n     * @param timer  The timer to remove to the [[currentScene]].\r\n     */\r\n    removeTimer(timer) {\r\n        return this.currentScene.removeTimer(timer);\r\n    }\r\n    /**\r\n     * Adds a [[Scene]] to the engine, think of scenes in Excalibur as you\r\n     * would levels or menus.\r\n     *\r\n     * @param key  The name of the scene, must be unique\r\n     * @param scene The scene to add to the engine\r\n     */\r\n    addScene(key, scene) {\r\n        if (this.scenes[key]) {\r\n            this._logger.warn('Scene', key, 'already exists overwriting');\r\n        }\r\n        this.scenes[key] = scene;\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    removeScene(entity) {\r\n        if (entity instanceof Scene) {\r\n            // remove scene\r\n            for (const key in this.scenes) {\r\n                if (this.scenes.hasOwnProperty(key)) {\r\n                    if (this.scenes[key] === entity) {\r\n                        delete this.scenes[key];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (typeof entity === 'string') {\r\n            // remove scene\r\n            delete this.scenes[entity];\r\n        }\r\n    }\r\n    add(entity) {\r\n        if (arguments.length === 2) {\r\n            this.addScene(arguments[0], arguments[1]);\r\n            return;\r\n        }\r\n        if (this._deferredGoTo && this.scenes[this._deferredGoTo]) {\r\n            this.scenes[this._deferredGoTo].add(entity);\r\n        }\r\n        else {\r\n            this.currentScene.add(entity);\r\n        }\r\n    }\r\n    remove(entity) {\r\n        if (entity instanceof Entity) {\r\n            this.currentScene.remove(entity);\r\n        }\r\n        if (entity instanceof Scene) {\r\n            this.removeScene(entity);\r\n        }\r\n        if (typeof entity === 'string') {\r\n            this.removeScene(entity);\r\n        }\r\n    }\r\n    /**\r\n     * Changes the currently updating and drawing scene to a different,\r\n     * named scene. Calls the [[Scene]] lifecycle events.\r\n     * @param key  The key of the scene to transition to.\r\n     * @param data Optional data to send to the scene's onActivate method\r\n     */\r\n    goToScene(key, data) {\r\n        // if not yet initialized defer goToScene\r\n        if (!this.isInitialized) {\r\n            this._deferredGoTo = key;\r\n            return;\r\n        }\r\n        if (this.scenes[key]) {\r\n            const previousScene = this.currentScene;\r\n            const nextScene = this.scenes[key];\r\n            this._logger.debug('Going to scene:', key);\r\n            // only deactivate when initialized\r\n            if (this.currentScene.isInitialized) {\r\n                const context = { engine: this, previousScene, nextScene };\r\n                this.currentScene._deactivate.apply(this.currentScene, [context, nextScene]);\r\n                this.currentScene.eventDispatcher.emit('deactivate', new DeactivateEvent(context, this.currentScene));\r\n            }\r\n            // set current scene to new one\r\n            this.currentScene = nextScene;\r\n            this.screen.setCurrentCamera(nextScene.camera);\r\n            // initialize the current scene if has not been already\r\n            this.currentScene._initialize(this);\r\n            const context = { engine: this, previousScene, nextScene, data };\r\n            this.currentScene._activate.apply(this.currentScene, [context, nextScene]);\r\n            this.currentScene.eventDispatcher.emit('activate', new ActivateEvent(context, this.currentScene));\r\n        }\r\n        else {\r\n            this._logger.error('Scene', key, 'does not exist!');\r\n        }\r\n    }\r\n    /**\r\n     * Transforms the current x, y from screen coordinates to world coordinates\r\n     * @param point  Screen coordinate to convert\r\n     */\r\n    screenToWorldCoordinates(point) {\r\n        return this.screen.screenToWorldCoordinates(point);\r\n    }\r\n    /**\r\n     * Transforms a world coordinate, to a screen coordinate\r\n     * @param point  World coordinate to convert\r\n     */\r\n    worldToScreenCoordinates(point) {\r\n        return this.screen.worldToScreenCoordinates(point);\r\n    }\r\n    /**\r\n     * Initializes the internal canvas, rendering context, display mode, and native event listeners\r\n     */\r\n    _initialize(options) {\r\n        this.pageScrollPreventionMode = options.scrollPreventionMode;\r\n        // initialize inputs\r\n        const pointerTarget = options && options.pointerScope === PointerScope.Document ? document : this.canvas;\r\n        this.input = {\r\n            keyboard: new Keyboard(),\r\n            pointers: new PointerEventReceiver(pointerTarget, this),\r\n            gamepads: new Gamepads()\r\n        };\r\n        this.input.keyboard.init();\r\n        this.input.pointers.init();\r\n        this.input.gamepads.init();\r\n        // Issue #385 make use of the visibility api\r\n        // https://developer.mozilla.org/en-US/docs/Web/Guide/User_experience/Using_the_Page_Visibility_API\r\n        let hidden, visibilityChange;\r\n        if (typeof document.hidden !== 'undefined') {\r\n            // Opera 12.10 and Firefox 18 and later support\r\n            hidden = 'hidden';\r\n            visibilityChange = 'visibilitychange';\r\n        }\r\n        else if ('msHidden' in document) {\r\n            hidden = 'msHidden';\r\n            visibilityChange = 'msvisibilitychange';\r\n        }\r\n        else if ('webkitHidden' in document) {\r\n            hidden = 'webkitHidden';\r\n            visibilityChange = 'webkitvisibilitychange';\r\n        }\r\n        this.browser.document.on(visibilityChange, () => {\r\n            if (document[hidden]) {\r\n                this.eventDispatcher.emit('hidden', new HiddenEvent(this));\r\n                this._logger.debug('Window hidden');\r\n            }\r\n            else {\r\n                this.eventDispatcher.emit('visible', new VisibleEvent(this));\r\n                this._logger.debug('Window visible');\r\n            }\r\n        });\r\n        if (!this.canvasElementId && !options.canvasElement) {\r\n            document.body.appendChild(this.canvas);\r\n        }\r\n    }\r\n    onInitialize(_engine) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * If supported by the browser, this will set the antialiasing flag on the\r\n     * canvas. Set this to `false` if you want a 'jagged' pixel art look to your\r\n     * image resources.\r\n     * @param isSmooth  Set smoothing to true or false\r\n     */\r\n    setAntialiasing(isSmooth) {\r\n        this.screen.antialiasing = isSmooth;\r\n    }\r\n    /**\r\n     * Return the current smoothing status of the canvas\r\n     */\r\n    getAntialiasing() {\r\n        return this.screen.antialiasing;\r\n    }\r\n    /**\r\n     * Gets whether the actor is Initialized\r\n     */\r\n    get isInitialized() {\r\n        return this._isInitialized;\r\n    }\r\n    _overrideInitialize(engine) {\r\n        if (!this.isInitialized) {\r\n            this.onInitialize(engine);\r\n            super.emit('initialize', new InitializeEvent(engine, this));\r\n            this._isInitialized = true;\r\n            if (this._deferredGoTo) {\r\n                const deferredScene = this._deferredGoTo;\r\n                this._deferredGoTo = null;\r\n                this.goToScene(deferredScene);\r\n            }\r\n            else {\r\n                this.goToScene('root');\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Updates the entire state of the game\r\n     * @param delta  Number of milliseconds elapsed since the last update.\r\n     */\r\n    _update(delta) {\r\n        if (!this.ready) {\r\n            // suspend updates until loading is finished\r\n            this._loader.update(this, delta);\r\n            // Update input listeners\r\n            this.input.keyboard.update();\r\n            this.input.gamepads.update();\r\n            return;\r\n        }\r\n        // Publish preupdate events\r\n        this._preupdate(delta);\r\n        // process engine level events\r\n        this.currentScene.update(this, delta);\r\n        // Publish update event\r\n        this._postupdate(delta);\r\n        // Update input listeners\r\n        this.input.keyboard.update();\r\n        this.input.gamepads.update();\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    _preupdate(delta) {\r\n        this.emit('preupdate', new PreUpdateEvent(this, delta, this));\r\n        this.onPreUpdate(this, delta);\r\n    }\r\n    onPreUpdate(_engine, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    _postupdate(delta) {\r\n        this.emit('postupdate', new PostUpdateEvent(this, delta, this));\r\n        this.onPostUpdate(this, delta);\r\n    }\r\n    onPostUpdate(_engine, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * Draws the entire game\r\n     * @param delta  Number of milliseconds elapsed since the last draw.\r\n     */\r\n    _draw(delta) {\r\n        this.graphicsContext.beginDrawLifecycle();\r\n        this.graphicsContext.clear();\r\n        this._predraw(this.graphicsContext, delta);\r\n        // Drawing nothing else while loading\r\n        if (!this._isReady) {\r\n            this._loader.canvas.draw(this.graphicsContext, 0, 0);\r\n            this.graphicsContext.flush();\r\n            return;\r\n        }\r\n        this.graphicsContext.backgroundColor = this.backgroundColor;\r\n        this.currentScene.draw(this.graphicsContext, delta);\r\n        this._postdraw(this.graphicsContext, delta);\r\n        // Flush any pending drawings\r\n        this.graphicsContext.flush();\r\n        this.graphicsContext.endDrawLifecycle();\r\n        this._checkForScreenShots();\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    _predraw(_ctx, delta) {\r\n        this.emit('predraw', new PreDrawEvent(_ctx, delta, this));\r\n        this.onPreDraw(_ctx, delta);\r\n    }\r\n    onPreDraw(_ctx, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    _postdraw(_ctx, delta) {\r\n        this.emit('postdraw', new PostDrawEvent(_ctx, delta, this));\r\n        this.onPostDraw(_ctx, delta);\r\n    }\r\n    onPostDraw(_ctx, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * Enable or disable Excalibur debugging functionality.\r\n     * @param toggle a value that debug drawing will be changed to\r\n     */\r\n    showDebug(toggle) {\r\n        this._isDebug = toggle;\r\n    }\r\n    /**\r\n     * Toggle Excalibur debugging functionality.\r\n     */\r\n    toggleDebug() {\r\n        this._isDebug = !this._isDebug;\r\n        return this._isDebug;\r\n    }\r\n    /**\r\n     * Returns true when loading is totally complete and the player has clicked start\r\n     */\r\n    get loadingComplete() {\r\n        return this._loadingComplete;\r\n    }\r\n    get ready() {\r\n        return this._isReady;\r\n    }\r\n    isReady() {\r\n        return this._isReadyPromise;\r\n    }\r\n    /**\r\n     * Starts the internal game loop for Excalibur after loading\r\n     * any provided assets.\r\n     * @param loader  Optional [[Loader]] to use to load resources. The default loader is [[Loader]], override to provide your own\r\n     * custom loader.\r\n     *\r\n     * Note: start() only resolves AFTER the user has clicked the play button\r\n     */\r\n    async start(loader) {\r\n        if (!this._compatible) {\r\n            throw new Error('Excalibur is incompatible with your browser');\r\n        }\r\n        // Wire loader if we have it\r\n        if (loader) {\r\n            // Push the current user entered resolution/viewport\r\n            this.screen.pushResolutionAndViewport();\r\n            // Configure resolution for loader, it expects resolution === viewport\r\n            this.screen.resolution = this.screen.viewport;\r\n            this.screen.applyResolutionAndViewport();\r\n            this._loader = loader;\r\n            this._loader.suppressPlayButton = this._suppressPlayButton || this._loader.suppressPlayButton;\r\n            this._loader.wireEngine(this);\r\n        }\r\n        // Start the excalibur clock which drives the mainloop\r\n        // has started is a slight misnomer, it's really mainloop started\r\n        this._logger.debug('Starting game clock...');\r\n        this.browser.resume();\r\n        this.clock.start();\r\n        this._logger.debug('Game clock started');\r\n        if (loader) {\r\n            await this.load(this._loader);\r\n            this._loadingComplete = true;\r\n            // reset back to previous user resolution/viewport\r\n            this.screen.popResolutionAndViewport();\r\n            this.screen.applyResolutionAndViewport();\r\n        }\r\n        this._loadingComplete = true;\r\n        // Initialize before ready\r\n        this._overrideInitialize(this);\r\n        this._isReady = true;\r\n        this._isReadyResolve();\r\n        this.emit('start', new GameStartEvent(this));\r\n        return this._isReadyPromise;\r\n    }\r\n    _mainloop(elapsed) {\r\n        this.emit('preframe', new PreFrameEvent(this, this.stats.prevFrame));\r\n        const delta = elapsed * this.timescale;\r\n        this.currentFrameElapsedMs = delta;\r\n        // reset frame stats (reuse existing instances)\r\n        const frameId = this.stats.prevFrame.id + 1;\r\n        this.stats.currFrame.reset();\r\n        this.stats.currFrame.id = frameId;\r\n        this.stats.currFrame.delta = delta;\r\n        this.stats.currFrame.fps = this.clock.fpsSampler.fps;\r\n        GraphicsDiagnostics.clear();\r\n        const beforeUpdate = this.clock.now();\r\n        const fixedTimestepMs = 1000 / this.fixedUpdateFps;\r\n        if (this.fixedUpdateFps) {\r\n            this._lagMs += delta;\r\n            while (this._lagMs >= fixedTimestepMs) {\r\n                this._update(fixedTimestepMs);\r\n                this._lagMs -= fixedTimestepMs;\r\n            }\r\n        }\r\n        else {\r\n            this._update(delta);\r\n        }\r\n        const afterUpdate = this.clock.now();\r\n        this.currentFrameLagMs = this._lagMs;\r\n        this._draw(delta);\r\n        const afterDraw = this.clock.now();\r\n        this.stats.currFrame.duration.update = afterUpdate - beforeUpdate;\r\n        this.stats.currFrame.duration.draw = afterDraw - afterUpdate;\r\n        this.stats.currFrame.graphics.drawnImages = GraphicsDiagnostics.DrawnImagesCount;\r\n        this.stats.currFrame.graphics.drawCalls = GraphicsDiagnostics.DrawCallCount;\r\n        this.emit('postframe', new PostFrameEvent(this, this.stats.currFrame));\r\n        this.stats.prevFrame.reset(this.stats.currFrame);\r\n        this._monitorPerformanceThresholdAndTriggerFallback();\r\n    }\r\n    /**\r\n     * Stops Excalibur's main loop, useful for pausing the game.\r\n     */\r\n    stop() {\r\n        if (this.clock.isRunning()) {\r\n            this.emit('stop', new GameStopEvent(this));\r\n            this.browser.pause();\r\n            this.clock.stop();\r\n            this._logger.debug('Game stopped');\r\n        }\r\n    }\r\n    /**\r\n     * Returns the Engine's running status, Useful for checking whether engine is running or paused.\r\n     */\r\n    isRunning() {\r\n        return this.clock.isRunning();\r\n    }\r\n    /**\r\n     * Takes a screen shot of the current viewport and returns it as an\r\n     * HTML Image Element.\r\n     * @param preserveHiDPIResolution in the case of HiDPI return the full scaled backing image, by default false\r\n     */\r\n    screenshot(preserveHiDPIResolution = false) {\r\n        const screenShotPromise = new Promise((resolve) => {\r\n            this._screenShotRequests.push({ preserveHiDPIResolution, resolve });\r\n        });\r\n        return screenShotPromise;\r\n    }\r\n    _checkForScreenShots() {\r\n        // We must grab the draw buffer before we yield to the browser\r\n        // the draw buffer is cleared after compositing\r\n        // the reason for the asynchrony is setting `preserveDrawingBuffer: true`\r\n        // forces the browser to copy buffers which can have a mass perf impact on mobile\r\n        for (const request of this._screenShotRequests) {\r\n            const finalWidth = request.preserveHiDPIResolution ? this.canvas.width : this.screen.resolution.width;\r\n            const finalHeight = request.preserveHiDPIResolution ? this.canvas.height : this.screen.resolution.height;\r\n            const screenshot = document.createElement('canvas');\r\n            screenshot.width = finalWidth;\r\n            screenshot.height = finalHeight;\r\n            const ctx = screenshot.getContext('2d');\r\n            ctx.drawImage(this.canvas, 0, 0, finalWidth, finalHeight);\r\n            const result = new Image();\r\n            const raw = screenshot.toDataURL('image/png');\r\n            result.src = raw;\r\n            request.resolve(result);\r\n        }\r\n        // Reset state\r\n        this._screenShotRequests.length = 0;\r\n    }\r\n    /**\r\n     * Another option available to you to load resources into the game.\r\n     * Immediately after calling this the game will pause and the loading screen\r\n     * will appear.\r\n     * @param loader  Some [[Loadable]] such as a [[Loader]] collection, [[Sound]], or [[Texture]].\r\n     */\r\n    async load(loader) {\r\n        try {\r\n            await loader.load();\r\n        }\r\n        catch (e) {\r\n            this._logger.error('Error loading resources, things may not behave properly', e);\r\n            await Promise.resolve();\r\n        }\r\n    }\r\n}\r\n/**\r\n * Default [[EngineOptions]]\r\n */\r\nEngine._DEFAULT_ENGINE_OPTIONS = {\r\n    width: 0,\r\n    height: 0,\r\n    enableCanvasTransparency: true,\r\n    useDrawSorting: true,\r\n    configurePerformanceCanvas2DFallback: {\r\n        allow: true,\r\n        showPlayerMessage: false,\r\n        threshold: { fps: 20, numberOfFrames: 100 }\r\n    },\r\n    canvasElementId: '',\r\n    canvasElement: undefined,\r\n    snapToPixel: false,\r\n    pointerScope: PointerScope.Canvas,\r\n    suppressConsoleBootMessage: null,\r\n    suppressMinimumBrowserFeatureDetection: null,\r\n    suppressHiDPIScaling: null,\r\n    suppressPlayButton: null,\r\n    scrollPreventionMode: ScrollPreventionMode.Canvas,\r\n    backgroundColor: Color.fromHex('#2185d0') // Excalibur blue\r\n};\r\n\n;// CONCATENATED MODULE: ./Math/Index.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Debug/index.ts\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Label.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Labels are the way to draw small amounts of text to the screen. They are\r\n * actors and inherit all of the benefits and capabilities.\r\n */\r\nclass Label extends Actor {\r\n    /**\r\n     * Build a new label\r\n     * @param options\r\n     */\r\n    constructor(options) {\r\n        super(options);\r\n        this._font = new Font();\r\n        this._text = new Text({ text: '', font: this._font });\r\n        const { text, pos, x, y, spriteFont, font, color } = options;\r\n        this.pos = pos !== null && pos !== void 0 ? pos : (x && y ? vec(x, y) : this.pos);\r\n        this.text = text !== null && text !== void 0 ? text : this.text;\r\n        this.font = font !== null && font !== void 0 ? font : this.font;\r\n        this.spriteFont = spriteFont !== null && spriteFont !== void 0 ? spriteFont : this.spriteFont;\r\n        this._text.color = color !== null && color !== void 0 ? color : this.color;\r\n        const gfx = this.get(GraphicsComponent);\r\n        gfx.anchor = Vector.Zero;\r\n        gfx.use(this._text);\r\n    }\r\n    get font() {\r\n        return this._font;\r\n    }\r\n    set font(newFont) {\r\n        this._font = newFont;\r\n        this._text.font = newFont;\r\n    }\r\n    /**\r\n     * The text to draw.\r\n     */\r\n    get text() {\r\n        return this._text.text;\r\n    }\r\n    set text(text) {\r\n        this._text.text = text;\r\n    }\r\n    get color() {\r\n        return this._text.color;\r\n    }\r\n    set color(color) {\r\n        if (this._text) {\r\n            this._text.color = color;\r\n        }\r\n    }\r\n    get opacity() {\r\n        return this._text.opacity;\r\n    }\r\n    set opacity(opacity) {\r\n        this._text.opacity = opacity;\r\n    }\r\n    /**\r\n     * The [[SpriteFont]] to use, if any. Overrides [[Font|font]] if present.\r\n     */\r\n    get spriteFont() {\r\n        return this._spriteFont;\r\n    }\r\n    set spriteFont(sf) {\r\n        if (sf) {\r\n            this._spriteFont = sf;\r\n            this._text.font = this._spriteFont;\r\n        }\r\n    }\r\n    _initialize(engine) {\r\n        super._initialize(engine);\r\n    }\r\n    /**\r\n     * Returns the width of the text in the label (in pixels);\r\n     */\r\n    getTextWidth() {\r\n        return this._text.width;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./TileMap/IsometricMap.ts\n\r\n\r\n\r\n\r\n\r\nclass IsometricTile extends Entity {\r\n    /**\r\n     * Construct a new IsometricTile\r\n     * @param x tile coordinate in x (not world position)\r\n     * @param y tile coordinate in y (not world position)\r\n     * @param graphicsOffset offset that tile should be shifted by (default (0, 0))\r\n     * @param map reference to owning IsometricMap\r\n     */\r\n    constructor(x, y, graphicsOffset, map) {\r\n        super([\r\n            new TransformComponent(),\r\n            new GraphicsComponent({\r\n                offset: graphicsOffset !== null && graphicsOffset !== void 0 ? graphicsOffset : Vector.Zero,\r\n                onPostDraw: (gfx, elapsed) => this.draw(gfx, elapsed)\r\n            }),\r\n            new IsometricEntityComponent(map)\r\n        ]);\r\n        /**\r\n         * Indicates whether this tile is solid\r\n         */\r\n        this.solid = false;\r\n        this._tileBounds = new BoundingBox();\r\n        this._graphics = [];\r\n        /**\r\n         * Tile colliders\r\n         */\r\n        this._colliders = [];\r\n        this.x = x;\r\n        this.y = y;\r\n        this.map = map;\r\n        this._transform = this.get(TransformComponent);\r\n        this._isometricEntityComponent = this.get(IsometricEntityComponent);\r\n        const halfTileWidth = this.map.tileWidth / 2;\r\n        const halfTileHeight = this.map.tileHeight / 2;\r\n        // See https://clintbellanger.net/articles/isometric_math/ for formula\r\n        // The x position shifts left with every y step\r\n        const xPos = (this.x - this.y) * halfTileWidth;\r\n        // The y position needs to go down with every x step\r\n        const yPos = (this.x + this.y) * halfTileHeight;\r\n        this._transform.pos = vec(xPos, yPos);\r\n        this._isometricEntityComponent.elevation = 0;\r\n        this._gfx = this.get(GraphicsComponent);\r\n        this._gfx.visible = false; // start not visible\r\n        const totalWidth = this.map.tileWidth;\r\n        const totalHeight = this.map.tileHeight;\r\n        // initial guess at gfx bounds based on the tile\r\n        const offset = vec(0, (this.map.renderFromTopOfGraphic ? totalHeight : 0));\r\n        this._gfx.localBounds = this._tileBounds = new BoundingBox({\r\n            left: -totalWidth / 2,\r\n            top: -totalHeight,\r\n            right: totalWidth / 2,\r\n            bottom: totalHeight\r\n        }).translate(offset);\r\n    }\r\n    getGraphics() {\r\n        return this._graphics;\r\n    }\r\n    /**\r\n     * Tile graphics\r\n     */\r\n    addGraphic(graphic) {\r\n        this._graphics.push(graphic);\r\n        this._gfx.visible = true;\r\n        this._gfx.localBounds = this._recalculateBounds();\r\n    }\r\n    _recalculateBounds() {\r\n        let bounds = this._tileBounds.clone();\r\n        for (const graphic of this._graphics) {\r\n            const offset = vec(this.map.graphicsOffset.x - this.map.tileWidth / 2, this.map.graphicsOffset.y - (this.map.renderFromTopOfGraphic ? 0 : (graphic.height - this.map.tileHeight)));\r\n            bounds = bounds.combine(graphic.localBounds.translate(offset));\r\n        }\r\n        return bounds;\r\n    }\r\n    removeGraphic(graphic) {\r\n        const index = this._graphics.indexOf(graphic);\r\n        if (index > -1) {\r\n            this._graphics.splice(index, 1);\r\n        }\r\n        this._gfx.localBounds = this._recalculateBounds();\r\n    }\r\n    clearGraphics() {\r\n        this._graphics.length = 0;\r\n        this._gfx.visible = false;\r\n        this._gfx.localBounds = this._recalculateBounds();\r\n    }\r\n    getColliders() {\r\n        return this._colliders;\r\n    }\r\n    /**\r\n     * Adds a collider to the IsometricTile\r\n     *\r\n     * **Note!** the [[Tile.solid]] must be set to true for it to act as a \"fixed\" collider\r\n     * @param collider\r\n     */\r\n    addCollider(collider) {\r\n        this._colliders.push(collider);\r\n        this.map.flagCollidersDirty();\r\n    }\r\n    /**\r\n     * Removes a collider from the IsometricTile\r\n     * @param collider\r\n     */\r\n    removeCollider(collider) {\r\n        const index = this._colliders.indexOf(collider);\r\n        if (index > -1) {\r\n            this._colliders.splice(index, 1);\r\n        }\r\n        this.map.flagCollidersDirty();\r\n    }\r\n    /**\r\n     * Clears all colliders from the IsometricTile\r\n     */\r\n    clearColliders() {\r\n        this._colliders.length = 0;\r\n        this.map.flagCollidersDirty();\r\n    }\r\n    /**\r\n     * Returns the top left corner of the [[IsometricTile]] in world space\r\n     */\r\n    get pos() {\r\n        return this.map.tileToWorld(vec(this.x, this.y));\r\n    }\r\n    /**\r\n     * Returns the center of the [[IsometricTile]]\r\n     */\r\n    get center() {\r\n        return this.pos.add(vec(0, this.map.tileHeight / 2));\r\n    }\r\n    draw(gfx, _elapsed) {\r\n        const halfTileWidth = this.map.tileWidth / 2;\r\n        gfx.save();\r\n        // shift left origin to corner of map, not the left corner of the first sprite\r\n        gfx.translate(-halfTileWidth, 0);\r\n        for (const graphic of this._graphics) {\r\n            graphic.draw(gfx, this.map.graphicsOffset.x, this.map.graphicsOffset.y - (this.map.renderFromTopOfGraphic ? 0 : (graphic.height - this.map.tileHeight)));\r\n        }\r\n        gfx.restore();\r\n    }\r\n}\r\n/**\r\n * The IsometricMap is a special tile map that provides isometric rendering support to Excalibur\r\n *\r\n * The tileWidth and tileHeight should be the height and width in pixels of the parallelogram of the base of the tile art asset.\r\n * The tileWidth and tileHeight is not necessarily the same as your graphic pixel width and height.\r\n *\r\n * Please refer to the docs https://excaliburjs.com for more details calculating what your tile width and height should be given\r\n * your art assets.\r\n */\r\nclass IsometricMap extends Entity {\r\n    constructor(options) {\r\n        super([\r\n            new TransformComponent(),\r\n            new BodyComponent({\r\n                type: CollisionType.Fixed\r\n            }),\r\n            new ColliderComponent(),\r\n            new DebugGraphicsComponent((ctx) => this.debug(ctx), false)\r\n        ], options.name);\r\n        /**\r\n         * Render the tile graphic from the top instead of the bottom\r\n         *\r\n         * default is `false` meaning rendering from the bottom\r\n         */\r\n        this.renderFromTopOfGraphic = false;\r\n        this.graphicsOffset = vec(0, 0);\r\n        this._collidersDirty = false;\r\n        this._originalOffsets = new WeakMap();\r\n        const { pos, tileWidth, tileHeight, columns: width, rows: height, renderFromTopOfGraphic, graphicsOffset } = options;\r\n        this.transform = this.get(TransformComponent);\r\n        if (pos) {\r\n            this.transform.pos = pos;\r\n        }\r\n        this.collider = this.get(ColliderComponent);\r\n        if (this.collider) {\r\n            this.collider.set(this._composite = new CompositeCollider([]));\r\n        }\r\n        this.renderFromTopOfGraphic = renderFromTopOfGraphic !== null && renderFromTopOfGraphic !== void 0 ? renderFromTopOfGraphic : this.renderFromTopOfGraphic;\r\n        this.graphicsOffset = graphicsOffset !== null && graphicsOffset !== void 0 ? graphicsOffset : this.graphicsOffset;\r\n        this.tileWidth = tileWidth;\r\n        this.tileHeight = tileHeight;\r\n        this.columns = width;\r\n        this.rows = height;\r\n        this.tiles = new Array(width * height);\r\n        // build up tile representation\r\n        for (let y = 0; y < height; y++) {\r\n            for (let x = 0; x < width; x++) {\r\n                const tile = new IsometricTile(x, y, this.graphicsOffset, this);\r\n                this.tiles[x + y * width] = tile;\r\n                this.addChild(tile);\r\n                // TODO row/columns helpers\r\n            }\r\n        }\r\n    }\r\n    update() {\r\n        if (this._collidersDirty) {\r\n            this.updateColliders();\r\n            this._collidersDirty = false;\r\n        }\r\n    }\r\n    flagCollidersDirty() {\r\n        this._collidersDirty = true;\r\n    }\r\n    _getOrSetColliderOriginalOffset(collider) {\r\n        if (!this._originalOffsets.has(collider)) {\r\n            const originalOffset = collider.offset;\r\n            this._originalOffsets.set(collider, originalOffset);\r\n            return originalOffset;\r\n        }\r\n        else {\r\n            return this._originalOffsets.get(collider);\r\n        }\r\n    }\r\n    updateColliders() {\r\n        this._composite.clearColliders();\r\n        const pos = this.get(TransformComponent).pos;\r\n        for (const tile of this.tiles) {\r\n            if (tile.solid) {\r\n                for (const collider of tile.getColliders()) {\r\n                    const originalOffset = this._getOrSetColliderOriginalOffset(collider);\r\n                    collider.offset = this.tileToWorld(vec(tile.x, tile.y))\r\n                        .sub(pos)\r\n                        .add(originalOffset)\r\n                        .sub(vec(this.tileWidth / 2, this.tileHeight)); // We need to unshift height based on drawing\r\n                    collider.owner = this;\r\n                    this._composite.addCollider(collider);\r\n                }\r\n            }\r\n        }\r\n        this.collider.update();\r\n    }\r\n    /**\r\n     * Convert world space coordinates to the tile x, y coordinate\r\n     * @param worldCoordinate\r\n     */\r\n    worldToTile(worldCoordinate) {\r\n        worldCoordinate = worldCoordinate.sub(this.transform.globalPos);\r\n        const halfTileWidth = this.tileWidth / 2;\r\n        const halfTileHeight = this.tileHeight / 2;\r\n        // See https://clintbellanger.net/articles/isometric_math/ for formula\r\n        return vec(~~((worldCoordinate.x / halfTileWidth + (worldCoordinate.y / halfTileHeight)) / 2), ~~((worldCoordinate.y / halfTileHeight - (worldCoordinate.x / halfTileWidth)) / 2));\r\n    }\r\n    /**\r\n     * Given a tile coordinate, return the top left corner in world space\r\n     * @param tileCoordinate\r\n     */\r\n    tileToWorld(tileCoordinate) {\r\n        const halfTileWidth = this.tileWidth / 2;\r\n        const halfTileHeight = this.tileHeight / 2;\r\n        // The x position shifts left with every y step\r\n        const xPos = (tileCoordinate.x - tileCoordinate.y) * halfTileWidth;\r\n        // The y position needs to go down with every x step\r\n        const yPos = (tileCoordinate.x + tileCoordinate.y) * halfTileHeight;\r\n        return vec(xPos, yPos).add(this.transform.pos);\r\n    }\r\n    /**\r\n     * Returns the [[IsometricTile]] by its x and y coordinates\r\n     */\r\n    getTile(x, y) {\r\n        if (x < 0 || y < 0 || x >= this.columns || y >= this.rows) {\r\n            return null;\r\n        }\r\n        return this.tiles[x + y * this.columns];\r\n    }\r\n    /**\r\n     * Returns the [[IsometricTile]] by testing a point in world coordinates,\r\n     * returns `null` if no Tile was found.\r\n     */\r\n    getTileByPoint(point) {\r\n        const tileCoord = this.worldToTile(point);\r\n        const tile = this.getTile(tileCoord.x, tileCoord.y);\r\n        return tile;\r\n    }\r\n    _getMaxZIndex() {\r\n        let maxZ = Number.NEGATIVE_INFINITY;\r\n        for (const tile of this.tiles) {\r\n            const currentZ = tile.get(TransformComponent).z;\r\n            if (currentZ > maxZ) {\r\n                maxZ = currentZ;\r\n            }\r\n        }\r\n        return maxZ;\r\n    }\r\n    /**\r\n     * Debug draw for IsometricMap, called internally by excalibur when debug mode is toggled on\r\n     * @param gfx\r\n     */\r\n    debug(gfx) {\r\n        gfx.save();\r\n        gfx.z = this._getMaxZIndex() + 0.5;\r\n        for (let y = 0; y < this.rows + 1; y++) {\r\n            const left = this.tileToWorld(vec(0, y));\r\n            const right = this.tileToWorld(vec(this.columns, y));\r\n            gfx.drawLine(left, right, Color.Red, 2);\r\n        }\r\n        for (let x = 0; x < this.columns + 1; x++) {\r\n            const top = this.tileToWorld(vec(x, 0));\r\n            const bottom = this.tileToWorld(vec(x, this.rows));\r\n            gfx.drawLine(top, bottom, Color.Red, 2);\r\n        }\r\n        for (const tile of this.tiles) {\r\n            gfx.drawCircle(this.tileToWorld(vec(tile.x, tile.y)), 3, Color.Yellow);\r\n        }\r\n        gfx.restore();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./TileMap/index.ts\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Actions/Action/ActionSequence.ts\n\r\n/**\r\n * Action that can represent a sequence of actions, this can be useful in conjunction with\r\n * [[ParallelActions]] to run multiple sequences in parallel.\r\n */\r\nclass ActionSequence {\r\n    constructor(entity, actionBuilder) {\r\n        this._stopped = false;\r\n        this._sequenceBuilder = actionBuilder;\r\n        this._sequenceContext = new ActionContext(entity);\r\n        this._actionQueue = this._sequenceContext.getQueue();\r\n        this._sequenceBuilder(this._sequenceContext);\r\n    }\r\n    update(delta) {\r\n        this._actionQueue.update(delta);\r\n    }\r\n    isComplete() {\r\n        return this._stopped || this._actionQueue.isComplete();\r\n    }\r\n    stop() {\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._stopped = false;\r\n        this._actionQueue.reset();\r\n    }\r\n    clone(entity) {\r\n        return new ActionSequence(entity, this._sequenceBuilder);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/ParallelActions.ts\n/**\r\n * Action that can run multiple [[Action]]s or [[ActionSequence]]s at the same time\r\n */\r\nclass ParallelActions {\r\n    constructor(parallelActions) {\r\n        this._actions = parallelActions;\r\n    }\r\n    update(delta) {\r\n        for (let i = 0; i < this._actions.length; i++) {\r\n            this._actions[i].update(delta);\r\n        }\r\n    }\r\n    isComplete(entity) {\r\n        return this._actions.every(a => a.isComplete(entity));\r\n    }\r\n    reset() {\r\n        this._actions.forEach(a => a.reset());\r\n    }\r\n    stop() {\r\n        this._actions.forEach(a => a.stop());\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Index.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Collision/Group/CollisionGroupManager.ts\n\r\n/**\r\n * Static class for managing collision groups in excalibur, there is a maximum of 32 collision groups possible in excalibur\r\n */\r\nclass CollisionGroupManager {\r\n    /**\r\n     * Create a new named collision group up to a max of 32.\r\n     * @param name Name for the collision group\r\n     * @param mask Optionally provide your own 32-bit mask, if none is provide the manager will generate one\r\n     */\r\n    static create(name, mask) {\r\n        if (this._CURRENT_GROUP > this._MAX_GROUPS) {\r\n            throw new Error(`Cannot have more than ${this._MAX_GROUPS} collision groups`);\r\n        }\r\n        if (this._GROUPS.get(name)) {\r\n            throw new Error(`Collision group ${name} already exists`);\r\n        }\r\n        const group = new CollisionGroup(name, this._CURRENT_BIT, mask !== undefined ? mask : ~this._CURRENT_BIT);\r\n        this._CURRENT_BIT = (this._CURRENT_BIT << 1) | 0;\r\n        this._CURRENT_GROUP++;\r\n        this._GROUPS.set(name, group);\r\n        return group;\r\n    }\r\n    /**\r\n     * Get all collision groups currently tracked by excalibur\r\n     */\r\n    static get groups() {\r\n        return Array.from(this._GROUPS.values());\r\n    }\r\n    /**\r\n     * Get a collision group by it's name\r\n     * @param name\r\n     */\r\n    static groupByName(name) {\r\n        return this._GROUPS.get(name);\r\n    }\r\n    /**\r\n     * Resets the managers internal group management state\r\n     */\r\n    static reset() {\r\n        this._GROUPS = new Map();\r\n        this._CURRENT_BIT = this._STARTING_BIT;\r\n        this._CURRENT_GROUP = 1;\r\n    }\r\n}\r\n// using bitmasking the maximum number of groups is 32, because that is the highest 32bit integer that JS can present.\r\nCollisionGroupManager._STARTING_BIT = 0b1 | 0;\r\nCollisionGroupManager._MAX_GROUPS = 32;\r\nCollisionGroupManager._CURRENT_GROUP = 1;\r\nCollisionGroupManager._CURRENT_BIT = CollisionGroupManager._STARTING_BIT;\r\nCollisionGroupManager._GROUPS = new Map();\r\n\n;// CONCATENATED MODULE: ./Collision/Index.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Interfaces/LifecycleEvents.ts\n/**\r\n * Type guard checking for internal initialize method\r\n * @internal\r\n * @param a\r\n */\r\nfunction has_initialize(a) {\r\n    return !!a._initialize;\r\n}\r\n/**\r\n *\r\n */\r\nfunction hasOnInitialize(a) {\r\n    return !!a.onInitialize;\r\n}\r\n/**\r\n *\r\n */\r\nfunction has_preupdate(a) {\r\n    return !!a._preupdate;\r\n}\r\n/**\r\n *\r\n */\r\nfunction hasOnPreUpdate(a) {\r\n    return !!a.onPreUpdate;\r\n}\r\n/**\r\n *\r\n */\r\nfunction has_postupdate(a) {\r\n    return !!a.onPostUpdate;\r\n}\r\n/**\r\n *\r\n */\r\nfunction hasOnPostUpdate(a) {\r\n    return !!a.onPostUpdate;\r\n}\r\n/**\r\n *\r\n */\r\nfunction hasPreDraw(a) {\r\n    return !!a.onPreDraw;\r\n}\r\n/**\r\n *\r\n */\r\nfunction hasPostDraw(a) {\r\n    return !!a.onPostDraw;\r\n}\r\n\n;// CONCATENATED MODULE: ./Interfaces/Index.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Resources/Sound/Index.ts\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Resources/Gif.ts\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * The [[Texture]] object allows games built in Excalibur to load image resources.\r\n * [[Texture]] is an [[Loadable]] which means it can be passed to a [[Loader]]\r\n * to pre-load before starting a level or game.\r\n */\r\nclass Gif {\r\n    /**\r\n     * @param path       Path to the image resource\r\n     * @param color      Optionally set the color to treat as transparent the gif, by default [[Color.Magenta]]\r\n     * @param bustCache  Optionally load texture with cache busting\r\n     */\r\n    constructor(path, color = Color.Magenta, bustCache = true) {\r\n        this.path = path;\r\n        this.color = color;\r\n        this.bustCache = bustCache;\r\n        this._stream = null;\r\n        this._gif = null;\r\n        this._textures = [];\r\n        this._animation = null;\r\n        this._transparentColor = null;\r\n        this._resource = new Resource(path, 'arraybuffer', bustCache);\r\n        this._transparentColor = color;\r\n    }\r\n    /**\r\n     * Begins loading the texture and returns a promise to be resolved on completion\r\n     */\r\n    async load() {\r\n        const arraybuffer = await this._resource.load();\r\n        this._stream = new Stream(arraybuffer);\r\n        this._gif = new ParseGif(this._stream, this._transparentColor);\r\n        const images = this._gif.images.map(i => new ImageSource(i.src, false));\r\n        // Load all textures\r\n        await Promise.all(images.map(t => t.load()));\r\n        return this.data = this._textures = images;\r\n    }\r\n    isLoaded() {\r\n        return !!this.data;\r\n    }\r\n    /**\r\n     * Return a frame of the gif as a sprite by id\r\n     * @param id\r\n     */\r\n    toSprite(id = 0) {\r\n        const sprite = this._textures[id].toSprite();\r\n        return sprite;\r\n    }\r\n    /**\r\n     * Return the gif as a spritesheet\r\n     */\r\n    toSpriteSheet() {\r\n        const sprites = this._textures.map((image) => {\r\n            return image.toSprite();\r\n        });\r\n        return new SpriteSheet({ sprites });\r\n    }\r\n    /**\r\n     * Transform the GIF into an animation with duration per frame\r\n     */\r\n    toAnimation(durationPerFrameMs) {\r\n        const spriteSheet = this.toSpriteSheet();\r\n        const length = spriteSheet.sprites.length;\r\n        this._animation = Animation.fromSpriteSheet(spriteSheet, range(0, length), durationPerFrameMs);\r\n        return this._animation;\r\n    }\r\n    get readCheckBytes() {\r\n        return this._gif.checkBytes;\r\n    }\r\n}\r\nconst bitsToNum = (ba) => {\r\n    return ba.reduce(function (s, n) {\r\n        return s * 2 + n;\r\n    }, 0);\r\n};\r\nconst byteToBitArr = (bite) => {\r\n    const a = [];\r\n    for (let i = 7; i >= 0; i--) {\r\n        a.push(!!(bite & (1 << i)));\r\n    }\r\n    return a;\r\n};\r\nclass Stream {\r\n    constructor(dataArray) {\r\n        this.data = null;\r\n        this.len = 0;\r\n        this.position = 0;\r\n        this.readByte = () => {\r\n            if (this.position >= this.data.byteLength) {\r\n                throw new Error('Attempted to read past end of stream.');\r\n            }\r\n            return this.data[this.position++];\r\n        };\r\n        this.readBytes = (n) => {\r\n            const bytes = [];\r\n            for (let i = 0; i < n; i++) {\r\n                bytes.push(this.readByte());\r\n            }\r\n            return bytes;\r\n        };\r\n        this.read = (n) => {\r\n            let s = '';\r\n            for (let i = 0; i < n; i++) {\r\n                s += String.fromCharCode(this.readByte());\r\n            }\r\n            return s;\r\n        };\r\n        this.readUnsigned = () => {\r\n            // Little-endian.\r\n            const a = this.readBytes(2);\r\n            return (a[1] << 8) + a[0];\r\n        };\r\n        this.data = new Uint8Array(dataArray);\r\n        this.len = this.data.byteLength;\r\n        if (this.len === 0) {\r\n            throw new Error('No data loaded from file');\r\n        }\r\n    }\r\n}\r\nconst lzwDecode = function (minCodeSize, data) {\r\n    // TODO: Now that the GIF parser is a bit different, maybe this should get an array of bytes instead of a String?\r\n    let pos = 0; // Maybe this streaming thing should be merged with the Stream?\r\n    const readCode = function (size) {\r\n        let code = 0;\r\n        for (let i = 0; i < size; i++) {\r\n            if (data.charCodeAt(pos >> 3) & (1 << (pos & 7))) {\r\n                code |= 1 << i;\r\n            }\r\n            pos++;\r\n        }\r\n        return code;\r\n    };\r\n    const output = [];\r\n    const clearCode = 1 << minCodeSize;\r\n    const eoiCode = clearCode + 1;\r\n    let codeSize = minCodeSize + 1;\r\n    let dict = [];\r\n    const clear = function () {\r\n        dict = [];\r\n        codeSize = minCodeSize + 1;\r\n        for (let i = 0; i < clearCode; i++) {\r\n            dict[i] = [i];\r\n        }\r\n        dict[clearCode] = [];\r\n        dict[eoiCode] = null;\r\n    };\r\n    let code;\r\n    let last;\r\n    while (true) {\r\n        last = code;\r\n        code = readCode(codeSize);\r\n        if (code === clearCode) {\r\n            clear();\r\n            continue;\r\n        }\r\n        if (code === eoiCode) {\r\n            break;\r\n        }\r\n        if (code < dict.length) {\r\n            if (last !== clearCode) {\r\n                dict.push(dict[last].concat(dict[code][0]));\r\n            }\r\n        }\r\n        else {\r\n            if (code !== dict.length) {\r\n                throw new Error('Invalid LZW code.');\r\n            }\r\n            dict.push(dict[last].concat(dict[last][0]));\r\n        }\r\n        output.push.apply(output, dict[code]);\r\n        if (dict.length === 1 << codeSize && codeSize < 12) {\r\n            // If we're at the last code and codeSize is 12, the next code will be a clearCode, and it'll be 12 bits long.\r\n            codeSize++;\r\n        }\r\n    }\r\n    // I don't know if this is technically an error, but some GIFs do it.\r\n    //if (Math.ceil(pos / 8) !== data.length) throw new Error('Extraneous LZW bytes.');\r\n    return output;\r\n};\r\n// The actual parsing; returns an object with properties.\r\nclass ParseGif {\r\n    constructor(stream, color = Color.Magenta) {\r\n        this._st = null;\r\n        this._handler = {};\r\n        this._transparentColor = null;\r\n        this.frames = [];\r\n        this.images = [];\r\n        this.globalColorTable = [];\r\n        this.checkBytes = [];\r\n        // LZW (GIF-specific)\r\n        this.parseColorTable = (entries) => {\r\n            // Each entry is 3 bytes, for RGB.\r\n            const ct = [];\r\n            for (let i = 0; i < entries; i++) {\r\n                const rgb = this._st.readBytes(3);\r\n                const rgba = '#' +\r\n                    rgb\r\n                        .map((x) => {\r\n                        const hex = x.toString(16);\r\n                        return hex.length === 1 ? '0' + hex : hex;\r\n                    })\r\n                        .join('');\r\n                ct.push(rgba);\r\n            }\r\n            return ct;\r\n        };\r\n        this.readSubBlocks = () => {\r\n            let size, data;\r\n            data = '';\r\n            do {\r\n                size = this._st.readByte();\r\n                data += this._st.read(size);\r\n            } while (size !== 0);\r\n            return data;\r\n        };\r\n        this.parseHeader = () => {\r\n            const hdr = {\r\n                sig: null,\r\n                ver: null,\r\n                width: null,\r\n                height: null,\r\n                colorRes: null,\r\n                globalColorTableSize: null,\r\n                gctFlag: null,\r\n                sorted: null,\r\n                globalColorTable: [],\r\n                bgColor: null,\r\n                pixelAspectRatio: null // if not 0, aspectRatio = (pixelAspectRatio + 15) / 64\r\n            };\r\n            hdr.sig = this._st.read(3);\r\n            hdr.ver = this._st.read(3);\r\n            if (hdr.sig !== 'GIF') {\r\n                throw new Error('Not a GIF file.'); // XXX: This should probably be handled more nicely.\r\n            }\r\n            hdr.width = this._st.readUnsigned();\r\n            hdr.height = this._st.readUnsigned();\r\n            const bits = byteToBitArr(this._st.readByte());\r\n            hdr.gctFlag = bits.shift();\r\n            hdr.colorRes = bitsToNum(bits.splice(0, 3));\r\n            hdr.sorted = bits.shift();\r\n            hdr.globalColorTableSize = bitsToNum(bits.splice(0, 3));\r\n            hdr.bgColor = this._st.readByte();\r\n            hdr.pixelAspectRatio = this._st.readByte(); // if not 0, aspectRatio = (pixelAspectRatio + 15) / 64\r\n            if (hdr.gctFlag) {\r\n                hdr.globalColorTable = this.parseColorTable(1 << (hdr.globalColorTableSize + 1));\r\n                this.globalColorTable = hdr.globalColorTable;\r\n            }\r\n            if (this._handler.hdr && this._handler.hdr(hdr)) {\r\n                this.checkBytes.push(this._handler.hdr);\r\n            }\r\n        };\r\n        this.parseExt = (block) => {\r\n            const parseGCExt = (block) => {\r\n                this.checkBytes.push(this._st.readByte()); // Always 4\r\n                const bits = byteToBitArr(this._st.readByte());\r\n                block.reserved = bits.splice(0, 3); // Reserved; should be 000.\r\n                block.disposalMethod = bitsToNum(bits.splice(0, 3));\r\n                block.userInput = bits.shift();\r\n                block.transparencyGiven = bits.shift();\r\n                block.delayTime = this._st.readUnsigned();\r\n                block.transparencyIndex = this._st.readByte();\r\n                block.terminator = this._st.readByte();\r\n                if (this._handler.gce && this._handler.gce(block)) {\r\n                    this.checkBytes.push(this._handler.gce);\r\n                }\r\n            };\r\n            const parseComExt = (block) => {\r\n                block.comment = this.readSubBlocks();\r\n                if (this._handler.com && this._handler.com(block)) {\r\n                    this.checkBytes.push(this._handler.com);\r\n                }\r\n            };\r\n            const parsePTExt = (block) => {\r\n                this.checkBytes.push(this._st.readByte()); // Always 12\r\n                block.ptHeader = this._st.readBytes(12);\r\n                block.ptData = this.readSubBlocks();\r\n                if (this._handler.pte && this._handler.pte(block)) {\r\n                    this.checkBytes.push(this._handler.pte);\r\n                }\r\n            };\r\n            const parseAppExt = (block) => {\r\n                const parseNetscapeExt = (block) => {\r\n                    this.checkBytes.push(this._st.readByte()); // Always 3\r\n                    block.unknown = this._st.readByte(); // Q: Always 1? What is this?\r\n                    block.iterations = this._st.readUnsigned();\r\n                    block.terminator = this._st.readByte();\r\n                    if (this._handler.app && this._handler.app.NETSCAPE && this._handler.app.NETSCAPE(block)) {\r\n                        this.checkBytes.push(this._handler.app);\r\n                    }\r\n                };\r\n                const parseUnknownAppExt = (block) => {\r\n                    block.appData = this.readSubBlocks();\r\n                    // FIXME: This won't work if a handler wants to match on any identifier.\r\n                    if (this._handler.app && this._handler.app[block.identifier] && this._handler.app[block.identifier](block)) {\r\n                        this.checkBytes.push(this._handler.app[block.identifier]);\r\n                    }\r\n                };\r\n                this.checkBytes.push(this._st.readByte()); // Always 11\r\n                block.identifier = this._st.read(8);\r\n                block.authCode = this._st.read(3);\r\n                switch (block.identifier) {\r\n                    case 'NETSCAPE':\r\n                        parseNetscapeExt(block);\r\n                        break;\r\n                    default:\r\n                        parseUnknownAppExt(block);\r\n                        break;\r\n                }\r\n            };\r\n            const parseUnknownExt = (block) => {\r\n                block.data = this.readSubBlocks();\r\n                if (this._handler.unknown && this._handler.unknown(block)) {\r\n                    this.checkBytes.push(this._handler.unknown);\r\n                }\r\n            };\r\n            block.label = this._st.readByte();\r\n            switch (block.label) {\r\n                case 0xf9:\r\n                    block.extType = 'gce';\r\n                    parseGCExt(block);\r\n                    break;\r\n                case 0xfe:\r\n                    block.extType = 'com';\r\n                    parseComExt(block);\r\n                    break;\r\n                case 0x01:\r\n                    block.extType = 'pte';\r\n                    parsePTExt(block);\r\n                    break;\r\n                case 0xff:\r\n                    block.extType = 'app';\r\n                    parseAppExt(block);\r\n                    break;\r\n                default:\r\n                    block.extType = 'unknown';\r\n                    parseUnknownExt(block);\r\n                    break;\r\n            }\r\n        };\r\n        this.parseImg = (img) => {\r\n            const deinterlace = (pixels, width) => {\r\n                // Of course this defeats the purpose of interlacing. And it's *probably*\r\n                // the least efficient way it's ever been implemented. But nevertheless...\r\n                const newPixels = new Array(pixels.length);\r\n                const rows = pixels.length / width;\r\n                const cpRow = (toRow, fromRow) => {\r\n                    const fromPixels = pixels.slice(fromRow * width, (fromRow + 1) * width);\r\n                    newPixels.splice.apply(newPixels, [toRow * width, width].concat(fromPixels));\r\n                };\r\n                const offsets = [0, 4, 2, 1];\r\n                const steps = [8, 8, 4, 2];\r\n                let fromRow = 0;\r\n                for (let pass = 0; pass < 4; pass++) {\r\n                    for (let toRow = offsets[pass]; toRow < rows; toRow += steps[pass]) {\r\n                        cpRow(toRow, fromRow);\r\n                        fromRow++;\r\n                    }\r\n                }\r\n                return newPixels;\r\n            };\r\n            img.leftPos = this._st.readUnsigned();\r\n            img.topPos = this._st.readUnsigned();\r\n            img.width = this._st.readUnsigned();\r\n            img.height = this._st.readUnsigned();\r\n            const bits = byteToBitArr(this._st.readByte());\r\n            img.lctFlag = bits.shift();\r\n            img.interlaced = bits.shift();\r\n            img.sorted = bits.shift();\r\n            img.reserved = bits.splice(0, 2);\r\n            img.lctSize = bitsToNum(bits.splice(0, 3));\r\n            if (img.lctFlag) {\r\n                img.lct = this.parseColorTable(1 << (img.lctSize + 1));\r\n            }\r\n            img.lzwMinCodeSize = this._st.readByte();\r\n            const lzwData = this.readSubBlocks();\r\n            img.pixels = lzwDecode(img.lzwMinCodeSize, lzwData);\r\n            if (img.interlaced) {\r\n                // Move\r\n                img.pixels = deinterlace(img.pixels, img.width);\r\n            }\r\n            this.frames.push(img);\r\n            this.arrayToImage(img);\r\n            if (this._handler.img && this._handler.img(img)) {\r\n                this.checkBytes.push(this._handler);\r\n            }\r\n        };\r\n        this.parseBlock = () => {\r\n            const block = {\r\n                sentinel: this._st.readByte(),\r\n                type: ''\r\n            };\r\n            const blockChar = String.fromCharCode(block.sentinel);\r\n            switch (blockChar) {\r\n                case '!':\r\n                    block.type = 'ext';\r\n                    this.parseExt(block);\r\n                    break;\r\n                case ',':\r\n                    block.type = 'img';\r\n                    this.parseImg(block);\r\n                    break;\r\n                case ';':\r\n                    block.type = 'eof';\r\n                    if (this._handler.eof && this._handler.eof(block)) {\r\n                        this.checkBytes.push(this._handler.eof);\r\n                    }\r\n                    break;\r\n                default:\r\n                    throw new Error('Unknown block: 0x' + block.sentinel.toString(16));\r\n            }\r\n            if (block.type !== 'eof') {\r\n                this.parseBlock();\r\n            }\r\n        };\r\n        this.arrayToImage = (frame) => {\r\n            let count = 0;\r\n            const c = document.createElement('canvas');\r\n            c.id = count.toString();\r\n            c.width = frame.width;\r\n            c.height = frame.height;\r\n            count++;\r\n            const context = c.getContext('2d');\r\n            const pixSize = 1;\r\n            let y = 0;\r\n            let x = 0;\r\n            for (let i = 0; i < frame.pixels.length; i++) {\r\n                if (x % frame.width === 0) {\r\n                    y++;\r\n                    x = 0;\r\n                }\r\n                if (this.globalColorTable[frame.pixels[i]] === this._transparentColor.toHex()) {\r\n                    context.fillStyle = `rgba(0, 0, 0, 0)`;\r\n                }\r\n                else {\r\n                    context.fillStyle = this.globalColorTable[frame.pixels[i]];\r\n                }\r\n                context.fillRect(x, y, pixSize, pixSize);\r\n                x++;\r\n            }\r\n            const img = new Image();\r\n            img.src = c.toDataURL();\r\n            this.images.push(img);\r\n        };\r\n        this._st = stream;\r\n        this._handler = {};\r\n        this._transparentColor = color;\r\n        this.parseHeader();\r\n        this.parseBlock();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Resources/Index.ts\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/index.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Graphics/Line.ts\n\r\n\r\n\r\nclass Line extends Graphic {\r\n    constructor(options) {\r\n        super();\r\n        this.color = Color.Black;\r\n        this.thickness = 1;\r\n        const { start, end, color, thickness } = options;\r\n        this.start = start;\r\n        this.end = end;\r\n        this.color = color !== null && color !== void 0 ? color : this.color;\r\n        this.thickness = thickness !== null && thickness !== void 0 ? thickness : this.thickness;\r\n        const { width, height } = BoundingBox.fromPoints([start, end]);\r\n        this.width = width;\r\n        this.height = height;\r\n    }\r\n    _drawImage(ctx, _x, _y) {\r\n        ctx.drawLine(this.start, this.end, this.color, this.thickness);\r\n    }\r\n    clone() {\r\n        return new Line({\r\n            start: this.start,\r\n            end: this.end,\r\n            color: this.color,\r\n            thickness: this.thickness\r\n        });\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Polygon.ts\n\r\n\r\n\r\n/**\r\n * A polygon [[Graphic]] for drawing arbitrary polygons to the [[ExcaliburGraphicsContext]]\r\n *\r\n * Polygons default to [[ImageFiltering.Blended]]\r\n */\r\nclass Polygon extends Raster {\r\n    constructor(options) {\r\n        super(options);\r\n        this.points = options.points;\r\n        this.filtering = ImageFiltering.Blended;\r\n        this.rasterize();\r\n    }\r\n    get points() {\r\n        return this._points;\r\n    }\r\n    set points(points) {\r\n        this._points = points;\r\n        const min = this.minPoint;\r\n        this.width = this._points.reduce((max, p) => Math.max(p.x, max), 0) - min.x;\r\n        this.height = this._points.reduce((max, p) => Math.max(p.y, max), 0) - min.y;\r\n        this.flagDirty();\r\n    }\r\n    get minPoint() {\r\n        const minX = this._points.reduce((min, p) => Math.min(p.x, min), Infinity);\r\n        const minY = this._points.reduce((min, p) => Math.min(p.y, min), Infinity);\r\n        return vec(minX, minY);\r\n    }\r\n    clone() {\r\n        return new Polygon({\r\n            points: this.points.map((p) => p.clone()),\r\n            ...this.cloneGraphicOptions(),\r\n            ...this.cloneRasterOptions()\r\n        });\r\n    }\r\n    execute(ctx) {\r\n        if (this.points && this.points.length) {\r\n            ctx.beginPath();\r\n            // Iterate through the supplied points and construct a 'polygon'\r\n            const min = this.minPoint.negate();\r\n            const firstPoint = this.points[0].add(min);\r\n            ctx.moveTo(firstPoint.x, firstPoint.y);\r\n            this.points.forEach((point) => {\r\n                ctx.lineTo(point.x + min.x, point.y + min.y);\r\n            });\r\n            ctx.lineTo(firstPoint.x, firstPoint.y);\r\n            ctx.closePath();\r\n            if (this.color) {\r\n                ctx.fill();\r\n            }\r\n            if (this.strokeColor) {\r\n                ctx.stroke();\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/index.ts\n// Graphics\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// Graphics ECS\r\n\r\n\r\n\r\n\r\n\r\n// Raster graphics\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// Post Processor\r\n\r\n\r\n\r\n\r\n\r\n\r\n// Rendering\r\n\r\n\r\n\r\n\r\n\r\n// Util\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Input/Index.ts\n/**\r\n * @module\r\n * Provides support for mice, keyboards, and controllers.\r\n */\r\n/**\r\n * @typedoc\r\n */\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Util/Index.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Util/Semaphore.ts\n\r\nclass AsyncWaitQueue {\r\n    constructor() {\r\n        // Code from StephenCleary https://gist.github.com/StephenCleary/ba50b2da419c03b9cba1d20cb4654d5e\r\n        this._queue = [];\r\n    }\r\n    get length() {\r\n        return this._queue.length;\r\n    }\r\n    enqueue() {\r\n        const future = new Future();\r\n        this._queue.push(future);\r\n        return future.promise;\r\n    }\r\n    dequeue(value) {\r\n        const future = this._queue.shift();\r\n        future.resolve(value);\r\n    }\r\n}\r\n/**\r\n * Semaphore allows you to limit the amount of async calls happening between `enter()` and `exit()`\r\n *\r\n * This can be useful when limiting the number of http calls, browser api calls, etc either for performance or to work\r\n * around browser limitations like max Image.decode() calls in chromium being 256.\r\n */\r\nclass Semaphore {\r\n    constructor(_count) {\r\n        this._count = _count;\r\n        this._waitQueue = new AsyncWaitQueue();\r\n    }\r\n    get count() {\r\n        return this._count;\r\n    }\r\n    get waiting() {\r\n        return this._waitQueue.length;\r\n    }\r\n    async enter() {\r\n        if (this._count !== 0) {\r\n            this._count--;\r\n            return Promise.resolve();\r\n        }\r\n        return this._waitQueue.enqueue();\r\n    }\r\n    exit(count = 1) {\r\n        if (count === 0) {\r\n            return;\r\n        }\r\n        while (count !== 0 && this._waitQueue.length !== 0) {\r\n            this._waitQueue.dequeue(null);\r\n            count--;\r\n        }\r\n        this._count += count;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./index.ts\n/**\r\n * The current Excalibur version string\r\n * @description `process.env.__EX_VERSION` gets replaced by Webpack on build\r\n */\r\nconst EX_VERSION = \"0.27.0\";\r\n\r\npolyfill();\r\n// This file is used as the bundle entry point and exports everything\r\n// that will be exposed as the `ex` global variable.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// ex.Events namespace\r\n\r\n\r\n// ex.Input namespace\r\n\r\n\r\n\r\n\r\n// ex.Util namespaces\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// ex.Deprecated\r\n// import * as deprecated from './Deprecated';\r\n// export { deprecated as Deprecated };\r\n// export * from './Deprecated';\r\n\n})();\n\nvar __webpack_exports__ActionContext = __webpack_exports__.fWn;\nvar __webpack_exports__ActionQueue = __webpack_exports__.Ia8;\nvar __webpack_exports__ActionSequence = __webpack_exports__.rqv;\nvar __webpack_exports__ActionsComponent = __webpack_exports__.hLI;\nvar __webpack_exports__ActionsSystem = __webpack_exports__.yyv;\nvar __webpack_exports__ActivateEvent = __webpack_exports__.tX5;\nvar __webpack_exports__Actor = __webpack_exports__.vtX;\nvar __webpack_exports__AddedComponent = __webpack_exports__.r7K;\nvar __webpack_exports__AddedEntity = __webpack_exports__.lCh;\nvar __webpack_exports__AffineMatrix = __webpack_exports__.cE4;\nvar __webpack_exports__Animation = __webpack_exports__.fwF;\nvar __webpack_exports__AnimationDirection = __webpack_exports__.sce;\nvar __webpack_exports__AnimationStrategy = __webpack_exports__._c7;\nvar __webpack_exports__ArcadeSolver = __webpack_exports__.KUs;\nvar __webpack_exports__AudioContextFactory = __webpack_exports__.Ajp;\nvar __webpack_exports__Axis = __webpack_exports__.RDh;\nvar __webpack_exports__BaseAlign = __webpack_exports__._H9;\nvar __webpack_exports__Blink = __webpack_exports__.mxs;\nvar __webpack_exports__BodyComponent = __webpack_exports__.OmD;\nvar __webpack_exports__BoundingBox = __webpack_exports__.kBf;\nvar __webpack_exports__BroadphaseStrategy = __webpack_exports__.C4F;\nvar __webpack_exports__BrowserComponent = __webpack_exports__.NQt;\nvar __webpack_exports__BrowserEvents = __webpack_exports__.JjN;\nvar __webpack_exports__Camera = __webpack_exports__.V1s;\nvar __webpack_exports__Canvas = __webpack_exports__.Xz7;\nvar __webpack_exports__Circle = __webpack_exports__.Cdc;\nvar __webpack_exports__CircleCollider = __webpack_exports__.FKn;\nvar __webpack_exports__Class = __webpack_exports__.wTW;\nvar __webpack_exports__Clock = __webpack_exports__.SUY;\nvar __webpack_exports__ClosestLine = __webpack_exports__.ab2;\nvar __webpack_exports__ClosestLineJumpTable = __webpack_exports__.GfZ;\nvar __webpack_exports__Collider = __webpack_exports__.YMS;\nvar __webpack_exports__ColliderComponent = __webpack_exports__.oyv;\nvar __webpack_exports__CollisionContact = __webpack_exports__.aUb;\nvar __webpack_exports__CollisionEndEvent = __webpack_exports__.SdD;\nvar __webpack_exports__CollisionGroup = __webpack_exports__.JUv;\nvar __webpack_exports__CollisionGroupManager = __webpack_exports__.jEj;\nvar __webpack_exports__CollisionJumpTable = __webpack_exports__.TFq;\nvar __webpack_exports__CollisionPostSolveEvent = __webpack_exports__.HDU;\nvar __webpack_exports__CollisionPreSolveEvent = __webpack_exports__.R_y;\nvar __webpack_exports__CollisionResolutionStrategy = __webpack_exports__.ydN;\nvar __webpack_exports__CollisionStartEvent = __webpack_exports__.t50;\nvar __webpack_exports__CollisionSystem = __webpack_exports__.s$$;\nvar __webpack_exports__CollisionType = __webpack_exports__.v2G;\nvar __webpack_exports__Color = __webpack_exports__.Ilk;\nvar __webpack_exports__ColorBlindFlags = __webpack_exports__.s9i;\nvar __webpack_exports__ColorBlindnessMode = __webpack_exports__.dxL;\nvar __webpack_exports__ColorBlindnessPostProcessor = __webpack_exports__.LLX;\nvar __webpack_exports__Component = __webpack_exports__.wA2;\nvar __webpack_exports__CompositeCollider = __webpack_exports__.R_p;\nvar __webpack_exports__Configurable = __webpack_exports__.IQ$;\nvar __webpack_exports__ConsoleAppender = __webpack_exports__.I5F;\nvar __webpack_exports__ContactConstraintPoint = __webpack_exports__.X8$;\nvar __webpack_exports__ContactEndEvent = __webpack_exports__.FR6;\nvar __webpack_exports__ContactStartEvent = __webpack_exports__.U8o;\nvar __webpack_exports__CoordPlane = __webpack_exports__.kbG;\nvar __webpack_exports__DeactivateEvent = __webpack_exports__.iS_;\nvar __webpack_exports__Debug = __webpack_exports__.cGG;\nvar __webpack_exports__DebugGraphicsComponent = __webpack_exports__.RPN;\nvar __webpack_exports__DebugSystem = __webpack_exports__.skb;\nvar __webpack_exports__DebugText = __webpack_exports__.SLU;\nvar __webpack_exports__DegreeOfFreedom = __webpack_exports__.RdJ;\nvar __webpack_exports__Delay = __webpack_exports__.cNu;\nvar __webpack_exports__Detector = __webpack_exports__.gU7;\nvar __webpack_exports__Die = __webpack_exports__.LSk;\nvar __webpack_exports__Direction = __webpack_exports__.Nmp;\nvar __webpack_exports__DisplayMode = __webpack_exports__.d1Y;\nvar __webpack_exports__DynamicTree = __webpack_exports__.xrL;\nvar __webpack_exports__DynamicTreeCollisionProcessor = __webpack_exports__.sRW;\nvar __webpack_exports__EX_VERSION = __webpack_exports__.cmV;\nvar __webpack_exports__EaseBy = __webpack_exports__.qWz;\nvar __webpack_exports__EaseTo = __webpack_exports__.N0Q;\nvar __webpack_exports__EasingFunctions = __webpack_exports__.q8b;\nvar __webpack_exports__EdgeCollider = __webpack_exports__.ynB;\nvar __webpack_exports__ElasticToActorStrategy = __webpack_exports__.jT9;\nvar __webpack_exports__EmitterType = __webpack_exports__.wAz;\nvar __webpack_exports__Engine = __webpack_exports__.D4V;\nvar __webpack_exports__EnterTriggerEvent = __webpack_exports__.N6H;\nvar __webpack_exports__EnterViewPortEvent = __webpack_exports__.W1A;\nvar __webpack_exports__Entity = __webpack_exports__.JHW;\nvar __webpack_exports__EntityManager = __webpack_exports__.v2K;\nvar __webpack_exports__EventDispatcher = __webpack_exports__.pBf;\nvar __webpack_exports__EventTypes = __webpack_exports__.GMl;\nvar __webpack_exports__Events = __webpack_exports__.zW2;\nvar __webpack_exports__ExResponse = __webpack_exports__.B0K;\nvar __webpack_exports__ExcaliburGraphicsContext2DCanvas = __webpack_exports__.Nv7;\nvar __webpack_exports__ExcaliburGraphicsContextWebGL = __webpack_exports__.C_p;\nvar __webpack_exports__ExcaliburWebGLContextAccessor = __webpack_exports__.iqw;\nvar __webpack_exports__ExitTriggerEvent = __webpack_exports__.MUA;\nvar __webpack_exports__ExitViewPortEvent = __webpack_exports__.xqU;\nvar __webpack_exports__Fade = __webpack_exports__.pTp;\nvar __webpack_exports__Flags = __webpack_exports__.vUK;\nvar __webpack_exports__Follow = __webpack_exports__.j9l;\nvar __webpack_exports__Font = __webpack_exports__.Zxw;\nvar __webpack_exports__FontStyle = __webpack_exports__.Hdx;\nvar __webpack_exports__FontUnit = __webpack_exports__.Z$d;\nvar __webpack_exports__FpsSampler = __webpack_exports__.iqV;\nvar __webpack_exports__FrameStats = __webpack_exports__.o$7;\nvar __webpack_exports__Future = __webpack_exports__.olM;\nvar __webpack_exports__GameEvent = __webpack_exports__.Zm$;\nvar __webpack_exports__GameStartEvent = __webpack_exports__.$QH;\nvar __webpack_exports__GameStopEvent = __webpack_exports__.i78;\nvar __webpack_exports__GamepadAxisEvent = __webpack_exports__.h6u;\nvar __webpack_exports__GamepadButtonEvent = __webpack_exports__.hts;\nvar __webpack_exports__GamepadConnectEvent = __webpack_exports__.j88;\nvar __webpack_exports__GamepadDisconnectEvent = __webpack_exports__.VME;\nvar __webpack_exports__Gif = __webpack_exports__.nt;\nvar __webpack_exports__GlobalCoordinates = __webpack_exports__.Ukr;\nvar __webpack_exports__Graphic = __webpack_exports__.zsu;\nvar __webpack_exports__GraphicsComponent = __webpack_exports__.oA6;\nvar __webpack_exports__GraphicsGroup = __webpack_exports__.TVh;\nvar __webpack_exports__GraphicsLayer = __webpack_exports__.TwZ;\nvar __webpack_exports__GraphicsLayers = __webpack_exports__.GTT;\nvar __webpack_exports__GraphicsSystem = __webpack_exports__.xxj;\nvar __webpack_exports__HiddenEvent = __webpack_exports__.XdK;\nvar __webpack_exports__ImageFiltering = __webpack_exports__.Jmb;\nvar __webpack_exports__ImageSource = __webpack_exports__.cXo;\nvar __webpack_exports__InitializeEvent = __webpack_exports__.Dm5;\nvar __webpack_exports__Input = __webpack_exports__.IIB;\nvar __webpack_exports__Integrator = __webpack_exports__.zI0;\nvar __webpack_exports__IsometricEntityComponent = __webpack_exports__.LYD;\nvar __webpack_exports__IsometricEntitySystem = __webpack_exports__.cEG;\nvar __webpack_exports__IsometricMap = __webpack_exports__.SEl;\nvar __webpack_exports__IsometricTile = __webpack_exports__.t9V;\nvar __webpack_exports__KillEvent = __webpack_exports__.SKZ;\nvar __webpack_exports__Label = __webpack_exports__.__J;\nvar __webpack_exports__LimitCameraBoundsStrategy = __webpack_exports__.RI$;\nvar __webpack_exports__Line = __webpack_exports__.x12;\nvar __webpack_exports__LineSegment = __webpack_exports__.ccz;\nvar __webpack_exports__Loader = __webpack_exports__.aNw;\nvar __webpack_exports__LockCameraToActorAxisStrategy = __webpack_exports__.xwn;\nvar __webpack_exports__LockCameraToActorStrategy = __webpack_exports__.dNK;\nvar __webpack_exports__LogLevel = __webpack_exports__.ini;\nvar __webpack_exports__Logger = __webpack_exports__.YdH;\nvar __webpack_exports__Matrix = __webpack_exports__.y3G;\nvar __webpack_exports__MatrixLocations = __webpack_exports__.l57;\nvar __webpack_exports__MediaEvent = __webpack_exports__.xn0;\nvar __webpack_exports__Meet = __webpack_exports__.t2V;\nvar __webpack_exports__MotionComponent = __webpack_exports__.uxB;\nvar __webpack_exports__MotionSystem = __webpack_exports__.cpd;\nvar __webpack_exports__MoveBy = __webpack_exports__.fiy;\nvar __webpack_exports__MoveTo = __webpack_exports__.$XZ;\nvar __webpack_exports__NativeSoundEvent = __webpack_exports__.uqK;\nvar __webpack_exports__NativeSoundProcessedEvent = __webpack_exports__.STE;\nvar __webpack_exports__Observable = __webpack_exports__.y$z;\nvar __webpack_exports__OffscreenSystem = __webpack_exports__.mAD;\nvar __webpack_exports__Pair = __webpack_exports__.sOq;\nvar __webpack_exports__ParallaxComponent = __webpack_exports__.hUw;\nvar __webpack_exports__ParallelActions = __webpack_exports__._0G;\nvar __webpack_exports__ParseGif = __webpack_exports__.Sqs;\nvar __webpack_exports__Particle = __webpack_exports__.hpZ;\nvar __webpack_exports__ParticleEmitter = __webpack_exports__.Vol;\nvar __webpack_exports__Physics = __webpack_exports__.wIZ;\nvar __webpack_exports__PhysicsStats = __webpack_exports__.cBi;\nvar __webpack_exports__PointerComponent = __webpack_exports__.RFv;\nvar __webpack_exports__PointerSystem = __webpack_exports__.kfC;\nvar __webpack_exports__Polygon = __webpack_exports__.mgq;\nvar __webpack_exports__PolygonCollider = __webpack_exports__.YVA;\nvar __webpack_exports__Pool = __webpack_exports__.Kgp;\nvar __webpack_exports__PostCollisionEvent = __webpack_exports__.HH$;\nvar __webpack_exports__PostDebugDrawEvent = __webpack_exports__.M_d;\nvar __webpack_exports__PostDrawEvent = __webpack_exports__.rgh;\nvar __webpack_exports__PostFrameEvent = __webpack_exports__.Ra6;\nvar __webpack_exports__PostKillEvent = __webpack_exports__.KhR;\nvar __webpack_exports__PostUpdateEvent = __webpack_exports__.BS5;\nvar __webpack_exports__PreCollisionEvent = __webpack_exports__.xhz;\nvar __webpack_exports__PreDebugDrawEvent = __webpack_exports__.xOq;\nvar __webpack_exports__PreDrawEvent = __webpack_exports__.a9j;\nvar __webpack_exports__PreFrameEvent = __webpack_exports__.bHk;\nvar __webpack_exports__PreKillEvent = __webpack_exports__.CgK;\nvar __webpack_exports__PreUpdateEvent = __webpack_exports__.cuY;\nvar __webpack_exports__Projection = __webpack_exports__.kvE;\nvar __webpack_exports__QuadIndexBuffer = __webpack_exports__.SBu;\nvar __webpack_exports__Query = __webpack_exports__.AE_;\nvar __webpack_exports__QueryManager = __webpack_exports__.ctO;\nvar __webpack_exports__RadiusAroundActorStrategy = __webpack_exports__.OLH;\nvar __webpack_exports__Random = __webpack_exports__.kky;\nvar __webpack_exports__Raster = __webpack_exports__.nSF;\nvar __webpack_exports__Ray = __webpack_exports__.zHn;\nvar __webpack_exports__RealisticSolver = __webpack_exports__.zwx;\nvar __webpack_exports__Rectangle = __webpack_exports__.AeJ;\nvar __webpack_exports__RemovedComponent = __webpack_exports__.hLz;\nvar __webpack_exports__RemovedEntity = __webpack_exports__.D9g;\nvar __webpack_exports__Repeat = __webpack_exports__.wA;\nvar __webpack_exports__RepeatForever = __webpack_exports__.jhr;\nvar __webpack_exports__Resolution = __webpack_exports__.GVs;\nvar __webpack_exports__Resource = __webpack_exports__._zO;\nvar __webpack_exports__RotateBy = __webpack_exports__.w6$;\nvar __webpack_exports__RotateTo = __webpack_exports__.mhV;\nvar __webpack_exports__RotationType = __webpack_exports__.MOD;\nvar __webpack_exports__ScaleBy = __webpack_exports__.kwd;\nvar __webpack_exports__ScaleTo = __webpack_exports__.Lmr;\nvar __webpack_exports__Scene = __webpack_exports__.xsS;\nvar __webpack_exports__Screen = __webpack_exports__.lLr;\nvar __webpack_exports__ScreenAppender = __webpack_exports__.Z$r;\nvar __webpack_exports__ScreenElement = __webpack_exports__.IXb;\nvar __webpack_exports__ScreenShader = __webpack_exports__.SGH;\nvar __webpack_exports__ScrollPreventionMode = __webpack_exports__.SMj;\nvar __webpack_exports__Semaphore = __webpack_exports__.L34;\nvar __webpack_exports__Shader = __webpack_exports__.exe;\nvar __webpack_exports__Shape = __webpack_exports__.bnF;\nvar __webpack_exports__Side = __webpack_exports__.MFA;\nvar __webpack_exports__Sound = __webpack_exports__.$uU;\nvar __webpack_exports__Sprite = __webpack_exports__.jyi;\nvar __webpack_exports__SpriteFont = __webpack_exports__.E03;\nvar __webpack_exports__SpriteSheet = __webpack_exports__.V6q;\nvar __webpack_exports__StandardClock = __webpack_exports__.rg2;\nvar __webpack_exports__StateMachine = __webpack_exports__.DVW;\nvar __webpack_exports__StrategyContainer = __webpack_exports__.nVo;\nvar __webpack_exports__Stream = __webpack_exports__.F6N;\nvar __webpack_exports__System = __webpack_exports__.xP7;\nvar __webpack_exports__SystemManager = __webpack_exports__.Odq;\nvar __webpack_exports__SystemType = __webpack_exports__.Zif;\nvar __webpack_exports__TagComponent = __webpack_exports__.ZGJ;\nvar __webpack_exports__TestClock = __webpack_exports__.MJk;\nvar __webpack_exports__Text = __webpack_exports__.xvT;\nvar __webpack_exports__TextAlign = __webpack_exports__.PHM;\nvar __webpack_exports__TextureLoader = __webpack_exports__.dpR;\nvar __webpack_exports__Tile = __webpack_exports__.n9L;\nvar __webpack_exports__TileMap = __webpack_exports__.KwO;\nvar __webpack_exports__Timer = __webpack_exports__.B7y;\nvar __webpack_exports__Toaster = __webpack_exports__.x7r;\nvar __webpack_exports__Transform = __webpack_exports__.wx7;\nvar __webpack_exports__TransformComponent = __webpack_exports__.Uvn;\nvar __webpack_exports__TreeNode = __webpack_exports__.OFT;\nvar __webpack_exports__Trigger = __webpack_exports__.xzN;\nvar __webpack_exports__TwoPI = __webpack_exports__.M5Z;\nvar __webpack_exports__Util = __webpack_exports__.ZrN;\nvar __webpack_exports__Vector = __webpack_exports__.OWs;\nvar __webpack_exports__VectorView = __webpack_exports__.dF9;\nvar __webpack_exports__VertexBuffer = __webpack_exports__.oZy;\nvar __webpack_exports__VertexLayout = __webpack_exports__.rD2;\nvar __webpack_exports__VisibleEvent = __webpack_exports__.VHo;\nvar __webpack_exports__WebAudio = __webpack_exports__.ohE;\nvar __webpack_exports__WebAudioInstance = __webpack_exports__.R$E;\nvar __webpack_exports__World = __webpack_exports__.q3I;\nvar __webpack_exports__canonicalizeAngle = __webpack_exports__.Pab;\nvar __webpack_exports__clamp = __webpack_exports__.uZ5;\nvar __webpack_exports__createId = __webpack_exports__.McK;\nvar __webpack_exports__frac = __webpack_exports__.F9c;\nvar __webpack_exports__hasGraphicsTick = __webpack_exports__.k0b;\nvar __webpack_exports__hasOnInitialize = __webpack_exports__.hnT;\nvar __webpack_exports__hasOnPostUpdate = __webpack_exports__.RSJ;\nvar __webpack_exports__hasOnPreUpdate = __webpack_exports__.Mku;\nvar __webpack_exports__hasPostDraw = __webpack_exports__.h90;\nvar __webpack_exports__hasPreDraw = __webpack_exports__.rms;\nvar __webpack_exports__has_initialize = __webpack_exports__.ErP;\nvar __webpack_exports__has_postupdate = __webpack_exports__.aVg;\nvar __webpack_exports__has_preupdate = __webpack_exports__.lPc;\nvar __webpack_exports__isAddedComponent = __webpack_exports__.Z8E;\nvar __webpack_exports__isAddedSystemEntity = __webpack_exports__._N2;\nvar __webpack_exports__isRemoveSystemEntity = __webpack_exports__.yFn;\nvar __webpack_exports__isRemovedComponent = __webpack_exports__.lNv;\nvar __webpack_exports__isScreenElement = __webpack_exports__.cu9;\nvar __webpack_exports__maxMessages = __webpack_exports__.MZQ;\nvar __webpack_exports__obsolete = __webpack_exports__.FUM;\nvar __webpack_exports__pixelSnapEpsilon = __webpack_exports__.BxR;\nvar __webpack_exports__randomInRange = __webpack_exports__.vdf;\nvar __webpack_exports__randomIntInRange = __webpack_exports__.iaL;\nvar __webpack_exports__range = __webpack_exports__.w6H;\nvar __webpack_exports__resetObsoleteCounter = __webpack_exports__.Q4c;\nvar __webpack_exports__sign = __webpack_exports__.Xxe;\nvar __webpack_exports__toDegrees = __webpack_exports__.Uxb;\nvar __webpack_exports__toRadians = __webpack_exports__.Yr5;\nvar __webpack_exports__vec = __webpack_exports__.Bhw;\nvar __webpack_exports__webgl = __webpack_exports__.yOA;\nexport { __webpack_exports__ActionContext as ActionContext, __webpack_exports__ActionQueue as ActionQueue, __webpack_exports__ActionSequence as ActionSequence, __webpack_exports__ActionsComponent as ActionsComponent, __webpack_exports__ActionsSystem as ActionsSystem, __webpack_exports__ActivateEvent as ActivateEvent, __webpack_exports__Actor as Actor, __webpack_exports__AddedComponent as AddedComponent, __webpack_exports__AddedEntity as AddedEntity, __webpack_exports__AffineMatrix as AffineMatrix, __webpack_exports__Animation as Animation, __webpack_exports__AnimationDirection as AnimationDirection, __webpack_exports__AnimationStrategy as AnimationStrategy, __webpack_exports__ArcadeSolver as ArcadeSolver, __webpack_exports__AudioContextFactory as AudioContextFactory, __webpack_exports__Axis as Axis, __webpack_exports__BaseAlign as BaseAlign, __webpack_exports__Blink as Blink, __webpack_exports__BodyComponent as BodyComponent, __webpack_exports__BoundingBox as BoundingBox, __webpack_exports__BroadphaseStrategy as BroadphaseStrategy, __webpack_exports__BrowserComponent as BrowserComponent, __webpack_exports__BrowserEvents as BrowserEvents, __webpack_exports__Camera as Camera, __webpack_exports__Canvas as Canvas, __webpack_exports__Circle as Circle, __webpack_exports__CircleCollider as CircleCollider, __webpack_exports__Class as Class, __webpack_exports__Clock as Clock, __webpack_exports__ClosestLine as ClosestLine, __webpack_exports__ClosestLineJumpTable as ClosestLineJumpTable, __webpack_exports__Collider as Collider, __webpack_exports__ColliderComponent as ColliderComponent, __webpack_exports__CollisionContact as CollisionContact, __webpack_exports__CollisionEndEvent as CollisionEndEvent, __webpack_exports__CollisionGroup as CollisionGroup, __webpack_exports__CollisionGroupManager as CollisionGroupManager, __webpack_exports__CollisionJumpTable as CollisionJumpTable, __webpack_exports__CollisionPostSolveEvent as CollisionPostSolveEvent, __webpack_exports__CollisionPreSolveEvent as CollisionPreSolveEvent, __webpack_exports__CollisionResolutionStrategy as CollisionResolutionStrategy, __webpack_exports__CollisionStartEvent as CollisionStartEvent, __webpack_exports__CollisionSystem as CollisionSystem, __webpack_exports__CollisionType as CollisionType, __webpack_exports__Color as Color, __webpack_exports__ColorBlindFlags as ColorBlindFlags, __webpack_exports__ColorBlindnessMode as ColorBlindnessMode, __webpack_exports__ColorBlindnessPostProcessor as ColorBlindnessPostProcessor, __webpack_exports__Component as Component, __webpack_exports__CompositeCollider as CompositeCollider, __webpack_exports__Configurable as Configurable, __webpack_exports__ConsoleAppender as ConsoleAppender, __webpack_exports__ContactConstraintPoint as ContactConstraintPoint, __webpack_exports__ContactEndEvent as ContactEndEvent, __webpack_exports__ContactStartEvent as ContactStartEvent, __webpack_exports__CoordPlane as CoordPlane, __webpack_exports__DeactivateEvent as DeactivateEvent, __webpack_exports__Debug as Debug, __webpack_exports__DebugGraphicsComponent as DebugGraphicsComponent, __webpack_exports__DebugSystem as DebugSystem, __webpack_exports__DebugText as DebugText, __webpack_exports__DegreeOfFreedom as DegreeOfFreedom, __webpack_exports__Delay as Delay, __webpack_exports__Detector as Detector, __webpack_exports__Die as Die, __webpack_exports__Direction as Direction, __webpack_exports__DisplayMode as DisplayMode, __webpack_exports__DynamicTree as DynamicTree, __webpack_exports__DynamicTreeCollisionProcessor as DynamicTreeCollisionProcessor, __webpack_exports__EX_VERSION as EX_VERSION, __webpack_exports__EaseBy as EaseBy, __webpack_exports__EaseTo as EaseTo, __webpack_exports__EasingFunctions as EasingFunctions, __webpack_exports__EdgeCollider as EdgeCollider, __webpack_exports__ElasticToActorStrategy as ElasticToActorStrategy, __webpack_exports__EmitterType as EmitterType, __webpack_exports__Engine as Engine, __webpack_exports__EnterTriggerEvent as EnterTriggerEvent, __webpack_exports__EnterViewPortEvent as EnterViewPortEvent, __webpack_exports__Entity as Entity, __webpack_exports__EntityManager as EntityManager, __webpack_exports__EventDispatcher as EventDispatcher, __webpack_exports__EventTypes as EventTypes, __webpack_exports__Events as Events, __webpack_exports__ExResponse as ExResponse, __webpack_exports__ExcaliburGraphicsContext2DCanvas as ExcaliburGraphicsContext2DCanvas, __webpack_exports__ExcaliburGraphicsContextWebGL as ExcaliburGraphicsContextWebGL, __webpack_exports__ExcaliburWebGLContextAccessor as ExcaliburWebGLContextAccessor, __webpack_exports__ExitTriggerEvent as ExitTriggerEvent, __webpack_exports__ExitViewPortEvent as ExitViewPortEvent, __webpack_exports__Fade as Fade, __webpack_exports__Flags as Flags, __webpack_exports__Follow as Follow, __webpack_exports__Font as Font, __webpack_exports__FontStyle as FontStyle, __webpack_exports__FontUnit as FontUnit, __webpack_exports__FpsSampler as FpsSampler, __webpack_exports__FrameStats as FrameStats, __webpack_exports__Future as Future, __webpack_exports__GameEvent as GameEvent, __webpack_exports__GameStartEvent as GameStartEvent, __webpack_exports__GameStopEvent as GameStopEvent, __webpack_exports__GamepadAxisEvent as GamepadAxisEvent, __webpack_exports__GamepadButtonEvent as GamepadButtonEvent, __webpack_exports__GamepadConnectEvent as GamepadConnectEvent, __webpack_exports__GamepadDisconnectEvent as GamepadDisconnectEvent, __webpack_exports__Gif as Gif, __webpack_exports__GlobalCoordinates as GlobalCoordinates, __webpack_exports__Graphic as Graphic, __webpack_exports__GraphicsComponent as GraphicsComponent, __webpack_exports__GraphicsGroup as GraphicsGroup, __webpack_exports__GraphicsLayer as GraphicsLayer, __webpack_exports__GraphicsLayers as GraphicsLayers, __webpack_exports__GraphicsSystem as GraphicsSystem, __webpack_exports__HiddenEvent as HiddenEvent, __webpack_exports__ImageFiltering as ImageFiltering, __webpack_exports__ImageSource as ImageSource, __webpack_exports__InitializeEvent as InitializeEvent, __webpack_exports__Input as Input, __webpack_exports__Integrator as Integrator, __webpack_exports__IsometricEntityComponent as IsometricEntityComponent, __webpack_exports__IsometricEntitySystem as IsometricEntitySystem, __webpack_exports__IsometricMap as IsometricMap, __webpack_exports__IsometricTile as IsometricTile, __webpack_exports__KillEvent as KillEvent, __webpack_exports__Label as Label, __webpack_exports__LimitCameraBoundsStrategy as LimitCameraBoundsStrategy, __webpack_exports__Line as Line, __webpack_exports__LineSegment as LineSegment, __webpack_exports__Loader as Loader, __webpack_exports__LockCameraToActorAxisStrategy as LockCameraToActorAxisStrategy, __webpack_exports__LockCameraToActorStrategy as LockCameraToActorStrategy, __webpack_exports__LogLevel as LogLevel, __webpack_exports__Logger as Logger, __webpack_exports__Matrix as Matrix, __webpack_exports__MatrixLocations as MatrixLocations, __webpack_exports__MediaEvent as MediaEvent, __webpack_exports__Meet as Meet, __webpack_exports__MotionComponent as MotionComponent, __webpack_exports__MotionSystem as MotionSystem, __webpack_exports__MoveBy as MoveBy, __webpack_exports__MoveTo as MoveTo, __webpack_exports__NativeSoundEvent as NativeSoundEvent, __webpack_exports__NativeSoundProcessedEvent as NativeSoundProcessedEvent, __webpack_exports__Observable as Observable, __webpack_exports__OffscreenSystem as OffscreenSystem, __webpack_exports__Pair as Pair, __webpack_exports__ParallaxComponent as ParallaxComponent, __webpack_exports__ParallelActions as ParallelActions, __webpack_exports__ParseGif as ParseGif, __webpack_exports__Particle as Particle, __webpack_exports__ParticleEmitter as ParticleEmitter, __webpack_exports__Physics as Physics, __webpack_exports__PhysicsStats as PhysicsStats, __webpack_exports__PointerComponent as PointerComponent, __webpack_exports__PointerSystem as PointerSystem, __webpack_exports__Polygon as Polygon, __webpack_exports__PolygonCollider as PolygonCollider, __webpack_exports__Pool as Pool, __webpack_exports__PostCollisionEvent as PostCollisionEvent, __webpack_exports__PostDebugDrawEvent as PostDebugDrawEvent, __webpack_exports__PostDrawEvent as PostDrawEvent, __webpack_exports__PostFrameEvent as PostFrameEvent, __webpack_exports__PostKillEvent as PostKillEvent, __webpack_exports__PostUpdateEvent as PostUpdateEvent, __webpack_exports__PreCollisionEvent as PreCollisionEvent, __webpack_exports__PreDebugDrawEvent as PreDebugDrawEvent, __webpack_exports__PreDrawEvent as PreDrawEvent, __webpack_exports__PreFrameEvent as PreFrameEvent, __webpack_exports__PreKillEvent as PreKillEvent, __webpack_exports__PreUpdateEvent as PreUpdateEvent, __webpack_exports__Projection as Projection, __webpack_exports__QuadIndexBuffer as QuadIndexBuffer, __webpack_exports__Query as Query, __webpack_exports__QueryManager as QueryManager, __webpack_exports__RadiusAroundActorStrategy as RadiusAroundActorStrategy, __webpack_exports__Random as Random, __webpack_exports__Raster as Raster, __webpack_exports__Ray as Ray, __webpack_exports__RealisticSolver as RealisticSolver, __webpack_exports__Rectangle as Rectangle, __webpack_exports__RemovedComponent as RemovedComponent, __webpack_exports__RemovedEntity as RemovedEntity, __webpack_exports__Repeat as Repeat, __webpack_exports__RepeatForever as RepeatForever, __webpack_exports__Resolution as Resolution, __webpack_exports__Resource as Resource, __webpack_exports__RotateBy as RotateBy, __webpack_exports__RotateTo as RotateTo, __webpack_exports__RotationType as RotationType, __webpack_exports__ScaleBy as ScaleBy, __webpack_exports__ScaleTo as ScaleTo, __webpack_exports__Scene as Scene, __webpack_exports__Screen as Screen, __webpack_exports__ScreenAppender as ScreenAppender, __webpack_exports__ScreenElement as ScreenElement, __webpack_exports__ScreenShader as ScreenShader, __webpack_exports__ScrollPreventionMode as ScrollPreventionMode, __webpack_exports__Semaphore as Semaphore, __webpack_exports__Shader as Shader, __webpack_exports__Shape as Shape, __webpack_exports__Side as Side, __webpack_exports__Sound as Sound, __webpack_exports__Sprite as Sprite, __webpack_exports__SpriteFont as SpriteFont, __webpack_exports__SpriteSheet as SpriteSheet, __webpack_exports__StandardClock as StandardClock, __webpack_exports__StateMachine as StateMachine, __webpack_exports__StrategyContainer as StrategyContainer, __webpack_exports__Stream as Stream, __webpack_exports__System as System, __webpack_exports__SystemManager as SystemManager, __webpack_exports__SystemType as SystemType, __webpack_exports__TagComponent as TagComponent, __webpack_exports__TestClock as TestClock, __webpack_exports__Text as Text, __webpack_exports__TextAlign as TextAlign, __webpack_exports__TextureLoader as TextureLoader, __webpack_exports__Tile as Tile, __webpack_exports__TileMap as TileMap, __webpack_exports__Timer as Timer, __webpack_exports__Toaster as Toaster, __webpack_exports__Transform as Transform, __webpack_exports__TransformComponent as TransformComponent, __webpack_exports__TreeNode as TreeNode, __webpack_exports__Trigger as Trigger, __webpack_exports__TwoPI as TwoPI, __webpack_exports__Util as Util, __webpack_exports__Vector as Vector, __webpack_exports__VectorView as VectorView, __webpack_exports__VertexBuffer as VertexBuffer, __webpack_exports__VertexLayout as VertexLayout, __webpack_exports__VisibleEvent as VisibleEvent, __webpack_exports__WebAudio as WebAudio, __webpack_exports__WebAudioInstance as WebAudioInstance, __webpack_exports__World as World, __webpack_exports__canonicalizeAngle as canonicalizeAngle, __webpack_exports__clamp as clamp, __webpack_exports__createId as createId, __webpack_exports__frac as frac, __webpack_exports__hasGraphicsTick as hasGraphicsTick, __webpack_exports__hasOnInitialize as hasOnInitialize, __webpack_exports__hasOnPostUpdate as hasOnPostUpdate, __webpack_exports__hasOnPreUpdate as hasOnPreUpdate, __webpack_exports__hasPostDraw as hasPostDraw, __webpack_exports__hasPreDraw as hasPreDraw, __webpack_exports__has_initialize as has_initialize, __webpack_exports__has_postupdate as has_postupdate, __webpack_exports__has_preupdate as has_preupdate, __webpack_exports__isAddedComponent as isAddedComponent, __webpack_exports__isAddedSystemEntity as isAddedSystemEntity, __webpack_exports__isRemoveSystemEntity as isRemoveSystemEntity, __webpack_exports__isRemovedComponent as isRemovedComponent, __webpack_exports__isScreenElement as isScreenElement, __webpack_exports__maxMessages as maxMessages, __webpack_exports__obsolete as obsolete, __webpack_exports__pixelSnapEpsilon as pixelSnapEpsilon, __webpack_exports__randomInRange as randomInRange, __webpack_exports__randomIntInRange as randomIntInRange, __webpack_exports__range as range, __webpack_exports__resetObsoleteCounter as resetObsoleteCounter, __webpack_exports__sign as sign, __webpack_exports__toDegrees as toDegrees, __webpack_exports__toRadians as toRadians, __webpack_exports__vec as vec, __webpack_exports__webgl as webgl };\n\n//# sourceMappingURL=excalibur.js.map","module.exports = __webpack_public_path__ + \"cf46998813a16deda5b1df84e8ba4a58.png\";","module.exports = __webpack_public_path__ + \"5f7dc58022982b36f3e7f336df2e1fe3.png\";","module.exports = __webpack_public_path__ + \"bd99eb41ea5cc3d44e26b5d2809fce41.png\";","module.exports = __webpack_public_path__ + \"9b8606ea9f0f4b78b4cd7ce817564074.png\";","module.exports = __webpack_public_path__ + \"81bc95ba9d9e1dca2626111d8282fc01.wav\";","module.exports = __webpack_public_path__ + \"d292f5f80075fd4216d6da8d459f64c5.wav\";","module.exports = __webpack_public_path__ + \"8934b41ac754a9dbdf0fdfffa1807d52.wav\";","module.exports = __webpack_public_path__ + \"61977b58651acbc9a3245a94f185238b.png\";","import * as ex from 'excalibur';\nimport { baddieSpriteSheet, Resources } from \"./resources\";\nimport { Bot } from './bot';\n\nexport class Baddie extends ex.Actor {\n    constructor(x: number, y: number, public dir: number) {\n        super({\n            name: 'Baddie',\n            pos: new ex.Vector(x, y),\n            collisionGroup: ex.CollisionGroupManager.groupByName(\"enemy\"),\n            collisionType: ex.CollisionType.Active,\n            collider: ex.Shape.Box(32, 50, ex.Vector.Half, ex.vec(0, -1)) \n        });\n    }\n\n    // OnInitialize is called before the 1st actor update\n    onInitialize(engine: ex.Engine) {\n        // Initialize actor\n\n        // Setup visuals\n        const left = ex.Animation.fromSpriteSheet(baddieSpriteSheet, [2, 3, 4, 5], 100);\n        left.scale = new ex.Vector(2, 2);\n        const right = ex.Animation.fromSpriteSheet(baddieSpriteSheet, [2, 3, 4, 5], 100);\n        right.scale = new ex.Vector(2, 2);\n        right.flipHorizontal = true;\n\n        // Register animation\n        this.graphics.add(\"left\", left)\n        this.graphics.add(\"right\", right);\n        this.graphics.use(\"left\");\n\n        if ((window as any).__TESTING) {\n            left.pause();\n        }\n\n        // Setup patroling behavior\n\n        // For the test harness to be predicable\n        if (!(window as any).__TESTING) {\n            this.actions.delay(1000)\n                        .repeatForever(ctx => ctx\n                            .moveBy(400 * this.dir, 0, 100)\n                            .moveBy(-400 * this.dir, 0, 100));\n        }\n\n        // Handle being stomped by the player\n        this.on('postcollision', (evt) => this.onPostCollision(evt));\n    }\n\n    onPostCollision(evt: ex.PostCollisionEvent) {\n        if (evt.other instanceof Bot && evt.side === ex.Side.Top) {\n            Resources.gotEm.play(.1);\n            // Clear patrolling\n            this.actions.clearActions();\n            // Remove ability to collide\n            this.body.collisionType = ex.CollisionType.PreventCollision;\n\n            // Launch into air with rotation\n            this.vel = new ex.Vector(0, -300);\n            this.acc = ex.Physics.acc;\n            this.angularVelocity = 2;\n        }\n    }\n\n    // Change animation based on velocity \n    onPostUpdate() {\n        if (this.vel.x < 0) {\n            this.graphics.use(\"left\");\n        } else if (this.vel.x > 0) {\n            this.graphics.use(\"right\");\n        }\n    }\n    \n}","import * as ex from 'excalibur';\nimport { botSpriteSheet, Resources } from './resources';\nimport { Baddie } from './baddie';\n\nexport class Bot extends ex.Actor {\n    public onGround = true;\n    public jumped = false;\n    public hurt = false;\n    public hurtTime: number = 0;\n    constructor(x: number, y: number) {\n        super({\n            name: 'Bot',\n            pos: new ex.Vector(x, y),\n            collisionType: ex.CollisionType.Active,\n            collisionGroup: ex.CollisionGroupManager.groupByName(\"player\"),\n            collider: ex.Shape.Box(32, 50, ex.Vector.Half, ex.vec(0, 3))\n        });\n    }\n\n    // OnInitialize is called before the 1st actor update\n    onInitialize(engine: ex.Engine) {\n        // Initialize actor\n\n        // Setup visuals\n        const hurtleft = ex.Animation.fromSpriteSheet(botSpriteSheet, [0, 1, 0, 1, 0, 1], 150);\n        hurtleft.scale = new ex.Vector(2, 2);\n\n        const hurtright = ex.Animation.fromSpriteSheet(botSpriteSheet, [0, 1, 0, 1, 0, 1], 150);\n        hurtright.scale = new ex.Vector(2, 2);\n        hurtright.flipHorizontal = true;\n\n        const idle = ex.Animation.fromSpriteSheet(botSpriteSheet, [2, 3], 800);\n        idle.scale = new ex.Vector(2, 2);\n\n        const left = ex.Animation.fromSpriteSheet(botSpriteSheet, [3, 4, 5, 6, 7], 100);\n        left.scale = new ex.Vector(2, 2);\n\n        const right = ex.Animation.fromSpriteSheet(botSpriteSheet, [3, 4, 5, 6, 7], 100);\n        right.scale = new ex.Vector(2, 2);\n        right.flipHorizontal = true;;\n\n        // Register animations with actor\n        this.graphics.add(\"hurtleft\", hurtleft);\n        this.graphics.add(\"hurtright\", hurtright);\n        this.graphics.add(\"idle\", idle);\n        this.graphics.add(\"left\", left);\n        this.graphics.add(\"right\", right);\n\n        // onPostCollision is an event, not a lifecycle meaning it can be subscribed to by other things\n        this.on('postcollision', (evt) => this.onPostCollision(evt));\n    }\n\n    onPostCollision(evt: ex.PostCollisionEvent) {\n        // Bot has collided with it's Top of another collider\n        console.log(evt.other.name);\n        if (evt.side === ex.Side.Bottom) {\n            this.onGround = true;\n        }\n\n        // Bot has collided on the side, display hurt animation\n        if ((evt.side === ex.Side.Left ||\n             evt.side === ex.Side.Right) &&\n            evt.other instanceof Baddie) {\n            if (this.vel.x < 0 && !this.hurt) {\n                this.graphics.use(\"hurtleft\");\n            } \n            if (this.vel.x >= 0 && !this.hurt) {\n                this.graphics.use(\"hurtright\");\n            }\n            this.hurt = true;\n            this.hurtTime = 1000;\n            Resources.hit.play(.1);\n        }\n    }\n\n    // After main update, once per frame execute this code\n    onPreUpdate(engine: ex.Engine, delta: number) {\n        // If hurt, count down\n        if (this.hurtTime >= 0 && this.hurt) {\n            this.hurtTime -= delta;\n            if (this.hurtTime < 0) {\n                this.hurt = false;\n            }\n        }\n\n        // Reset x velocity\n        this.vel.x = 0;\n\n        // Player input\n        if(engine.input.keyboard.isHeld(ex.Input.Keys.Left)) {\n            this.vel.x = -150;\n        }\n\n        if(engine.input.keyboard.isHeld(ex.Input.Keys.Right)) {\n            this.vel.x = 150;\n        }\n\n        if(engine.input.keyboard.isHeld(ex.Input.Keys.Up) && this.onGround) {\n            this.vel.y = -400;\n            this.onGround = false;\n            Resources.jump.play(.1);\n        }\n\n        // Change animation based on velocity\n        if (this.vel.x < 0 && !this.hurt) {\n            this.graphics.use(\"left\");\n        } \n        if (this.vel.x > 0 && !this.hurt) {\n            this.graphics.use(\"right\");\n        }\n        if (this.vel.x === 0 && !this.hurt){\n            this.graphics.use(\"idle\")\n        }\n    }\n}","import * as ex from 'excalibur';\nimport { ExcaliburGraphicsContext } from 'excalibur';\nimport { blockSprite } from './resources';\n\nexport class Floor extends ex.Actor {\n    constructor(x: number, y: number, public cols: number, public rows: number) {\n        super({\n            name: 'Floor',\n            pos: new ex.Vector(x, y),\n            scale: new ex.Vector(2, 2),\n            anchor: ex.Vector.Zero,\n            collider: ex.Shape.Box(20 * cols, 15 * rows, ex.Vector.Zero),\n            collisionType: ex.CollisionType.Fixed,\n            collisionGroup: ex.CollisionGroupManager.groupByName(\"floor\"),\n        });\n\n        for (let i = 0; i < this.cols; i++) {\n            for (let j = 0; j < this.rows; j++) {\n                this.graphics.show(blockSprite, { \n                    anchor: ex.Vector.Zero,\n                    offset: ex.vec(i * blockSprite.width, j * blockSprite.height)\n                })\n            }\n        }\n    }\n}\n","import * as ex from 'excalibur';\nimport { Baddie } from './baddie';\nimport { Bot } from './bot';\nimport { Floor } from './floor';\nimport { NPC } from './npc';\n\nexport class Level extends ex.Scene {\n    constructor() {\n        super();\n    }\n\n    onInitialize(engine: ex.Engine) {\n\n        // Create collision groups for the game\n        ex.CollisionGroupManager.create(\"player\");\n        ex.CollisionGroupManager.create(\"enemy\");\n        ex.CollisionGroupManager.create(\"floor\");\n\n        // Compose actors in scene\n        const actor = new Bot(engine.halfDrawWidth + 100, engine.halfDrawHeight - 100);\n\n        const baddie = new Baddie(engine.halfDrawWidth - 200, 300 - 30, 1);\n        const baddie2 = new Baddie(engine.halfDrawWidth + 200, 300 - 30, -1);\n\n        const npc = new NPC(400, 170);\n        \n        const floor = new Floor(0, 300, 15, 1);\n        const otherFloor = new Floor(engine.halfDrawWidth + 50, 200, 5, 1);\n\n        engine.add(actor);\n        engine.add(npc);\n        engine.add(baddie);\n        engine.add(baddie2);\n        engine.add(floor);\n        engine.add(otherFloor);\n\n        // For the test harness to be predicable\n        if (!(window as any).__TESTING) {\n            // Create camera strategy\n            this.camera.clearAllStrategies();\n            this.camera.strategy.elasticToActor(actor, 0.05, 0.1);\n        }\n    }\n}","import * as ex from 'excalibur';\nimport { loader } from './resources';\nimport { Level } from './level';\n\nconst engine = new ex.Engine({\n    backgroundColor: ex.Color.fromHex('#5fcde4'),\n    width: 600,\n    height: 400,\n    fixedUpdateFps: 60,\n    // Turn off anti-aliasing for pixel art graphics\n    antialiasing: false\n});\n\n// Set global gravity, 800 pixels/sec^2\nex.Physics.acc = new ex.Vector(0, 800);\n\n// Setup first level as a custom scene\nconst level = new Level();\nengine.add('level', level);\nengine.goToScene('level');\n\n// Game events to handle\nengine.on('hidden', () => {\n    console.log('pause');\n    engine.stop();\n});\nengine.on('visible', () => {\n    console.log('start');\n    engine.start();\n});\n\n// Start the engine\nengine.start(loader).then(() => {\n    console.log('game start');\n});\n\n// For test hook\n(window as any).engine = engine;\n(window as any).level = level;","import * as ex from 'excalibur';\nimport { botRedSpriteSheet, Resources, npcSprite } from './resources';\n\nexport class NPC extends ex.Actor {\n    public onGround = true;\n    public hurt = false;\n    public hurtTime: number = 0;\n    constructor(x: number, y: number) {\n        super({\n            pos: new ex.Vector(x, y),\n            collisionType: ex.CollisionType.Active,\n            collisionGroup: ex.CollisionGroupManager.groupByName(\"player\"),\n            collider: ex.Shape.Box(32, 50, ex.Vector.Half, ex.vec(0, 3))\n        });\n    }\n\n    // OnInitialize is called before the 1st actor update\n    onInitialize(engine: ex.Engine) {\n        // Initialize actor\n\n        // Set the z-index to be behind everything\n        this.z = -1;\n\n        // Setup visuals\n        const hurtleft = ex.Animation.fromSpriteSheet(botRedSpriteSheet, [0, 1, 0, 1, 0, 1], 150);\n        hurtleft.scale = new ex.Vector(2, 2);\n\n        const hurtright = ex.Animation.fromSpriteSheet(botRedSpriteSheet, [0, 1, 0, 1, 0, 1], 150);\n        hurtright.scale = new ex.Vector(2, 2);\n        hurtright.flipHorizontal = true;\n\n        const idle = ex.Animation.fromSpriteSheet(botRedSpriteSheet, [2, 3], 800);\n        idle.scale = new ex.Vector(2, 2);\n\n        const left = ex.Animation.fromSpriteSheet(botRedSpriteSheet, [3, 4, 5, 6, 7], 100);\n        left.scale = new ex.Vector(2, 2);\n\n        const right = ex.Animation.fromSpriteSheet(botRedSpriteSheet, [3, 4, 5, 6, 7], 100);\n        right.scale = new ex.Vector(2, 2);\n        right.flipHorizontal = true;\n\n        // Register drawings\n        this.graphics.add(\"hurtleft\", hurtleft);\n        this.graphics.add(\"hurtright\", hurtright);\n        this.graphics.add(\"idle\", idle);\n        this.graphics.add(\"left\", left);\n        this.graphics.add(\"right\", right);\n\n        // Setup patroling behavior\n\n        // For the test harness to be predicable\n        if (!(window as any).__TESTING) {\n            this.actions.delay(1000)\n                        .repeatForever(ctx => ctx\n                            .moveBy(100, 0, 20)\n                            .moveBy(-100, 0, 20));\n        }\n\n\n        // Custom draw after local tranform, draws word bubble\n        this.graphics.onPostDraw = (ctx) => {\n            npcSprite.draw(ctx, -10, -100);\n        }\n\n    }\n\n    onPostUpdate(engine: ex.Engine, delta: number) {\n        if (this.vel.x < 0) {\n            this.graphics.use(\"left\");\n        }\n        if (this.vel.x > 0) {\n            this.graphics.use(\"right\");\n        }\n        if (this.vel.x === 0) {\n            this.graphics.use(\"idle\")\n        }\n    }\n}","import * as ex from 'excalibur';\n\nconst botFile = require('../res/excalibot.png');\nconst botRedFile = require('../res/excalibot-red.png');\nconst baddieFile = require('../res/baddie.png');\nconst blockFile = require('../res/block.png');\nconst npcFile = require('../res/npc.png');\nconst jumpSound = require('../res/jump.wav');\nconst hitSound = require('../res/hurt.wav');\nconst gotEmSound = require('../res/gottem.wav');\n\nconst Resources = {\n    bot: new ex.ImageSource(botFile),\n    botRed: new ex.ImageSource(botRedFile),\n    baddie: new ex.ImageSource(baddieFile),\n    block: new ex.ImageSource(blockFile),\n    npc: new ex.ImageSource(npcFile),\n    jump: new ex.Sound(jumpSound),\n    hit: new ex.Sound(hitSound),\n    gotEm: new ex.Sound(gotEmSound)\n}\n\nconst loader = new ex.Loader();\n\nconst botSpriteSheet = ex.SpriteSheet.fromImageSource({\n    image:Resources.bot, \n    grid: { \n        columns: 8,\n        rows: 1, \n        spriteWidth: 32,\n        spriteHeight: 32\n    }\n});\nconst botRedSpriteSheet = ex.SpriteSheet.fromImageSource({\n    image: Resources.botRed,\n    grid: {\n        columns: 8, \n        rows: 1,\n        spriteWidth: 32,\n        spriteHeight: 32\n    }\n});\nconst baddieSpriteSheet = ex.SpriteSheet.fromImageSource({\n    image: Resources.baddie,\n    grid: {\n        columns: 6, \n        rows: 1,\n        spriteWidth: 32,\n        spriteHeight: 32\n    }\n});\nconst blockSprite = Resources.block.toSprite();\nconst npcSprite = Resources.npc.toSprite();\n\nfor (const res in Resources) {\n    loader.addResource((Resources as any)[res]);\n}\n\nexport { Resources, loader, botSpriteSheet, botRedSpriteSheet, baddieSpriteSheet, blockSprite, npcSprite }","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) scriptUrl = scripts[scripts.length - 1].src\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(519);\n"],"names":["__webpack_modules__","module","__unused_webpack_exports","entryUnbind","exports","path","Object","keys","isCallable","tryToString","$TypeError","TypeError","argument","isObject","$String","String","toIndexedObject","toAbsoluteIndex","lengthOfArrayLike","createMethod","IS_INCLUDES","$this","el","fromIndex","value","O","length","index","includes","indexOf","fails","METHOD_NAME","method","call","createProperty","$Array","Array","max","Math","start","end","k","fin","undefined","result","n","arraySlice","floor","mergeSort","array","comparefn","middle","insertionSort","merge","element","j","i","left","right","llength","rlength","lindex","rindex","uncurryThis","toString","stringSlice","slice","it","TO_STRING_TAG_SUPPORT","classofRaw","TO_STRING_TAG","wellKnownSymbol","$Object","CORRECT_ARGUMENTS","arguments","tag","key","error","tryGet","callee","hasOwn","ownKeys","getOwnPropertyDescriptorModule","definePropertyModule","target","source","exceptions","defineProperty","f","getOwnPropertyDescriptor","DESCRIPTORS","createPropertyDescriptor","object","bitmap","enumerable","configurable","writable","toPropertyKey","propertyKey","makeBuiltIn","defineGlobalProperty","options","simple","name","global","unsafe","nonConfigurable","nonWritable","P","get","document","EXISTS","createElement","firefox","match","UA","test","getBuiltIn","version","userAgent","process","Deno","versions","v8","split","webkit","CONSTRUCTOR","METHOD","prototype","createNonEnumerableProperty","defineBuiltIn","copyConstructorProperties","isForced","targetProperty","sourceProperty","descriptor","TARGET","GLOBAL","STATIC","stat","dontCallGetSet","forced","sham","exec","bind","hasOwnProperty","NATIVE_BIND","Function","apply","FunctionPrototype","getDescriptor","PROPER","CONFIGURABLE","fn","aFunction","namespace","aCallable","V","func","check","globalThis","window","self","g","this","toObject","a","classof","propertyIsEnumerable","store","functionToString","inspectSource","set","has","NATIVE_WEAK_MAP","shared","sharedKey","hiddenKeys","OBJECT_ALREADY_INITIALIZED","WeakMap","state","wmget","wmhas","wmset","metadata","facade","STATE","enforce","getterFor","TYPE","type","replacement","feature","detection","data","normalize","POLYFILL","NATIVE","string","replace","toLowerCase","isPrototypeOf","USE_SYMBOL_AS_UID","$Symbol","toLength","obj","CONFIGURABLE_FUNCTION_NAME","InternalStateModule","enforceInternalState","getInternalState","CONFIGURABLE_LENGTH","TEMPLATE","getter","setter","arity","constructor","join","ceil","trunc","x","V8_VERSION","getOwnPropertySymbols","symbol","Symbol","__unused_webpack_module","IE8_DOM_DEFINE","V8_PROTOTYPE_DEFINE_BUG","anObject","$defineProperty","$getOwnPropertyDescriptor","Attributes","current","propertyIsEnumerableModule","internalObjectKeys","concat","getOwnPropertyNames","push","names","enumBugKeys","$propertyIsEnumerable","NASHORN_BUG","input","pref","val","valueOf","getOwnPropertyNamesModule","getOwnPropertySymbolsModule","uid","SHARED","IS_PURE","mode","copyright","license","toIntegerOrInfinity","min","integer","IndexedObject","requireObjectCoercible","number","isSymbol","getMethod","ordinaryToPrimitive","TO_PRIMITIVE","exoticToPrim","toPrimitive","id","postfix","random","NATIVE_SYMBOL","iterator","WellKnownSymbolsStore","symbolFor","createWellKnownSymbol","withoutSetter","description","$","deletePropertyOrThrow","internalSort","arrayMethodIsStrict","FF","IE_OR_EDGE","V8","WEBKIT","un$Sort","sort","FAILS_ON_UNDEFINED","FAILS_ON_NULL","STRICT_METHOD","STABLE_SORT","code","chr","fromCharCode","v","b","charAt","proto","itemsLength","items","arrayLength","y","getSortCompare","nativeKeys","__webpack_exports__","d","_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__","_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default","_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__","___CSS_LOADER_EXPORT___","_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default","__WEBPACK_DEFAULT_EXPORT__","cssWithMappingToString","list","map","item","content","needLayer","modules","media","dedupe","supports","layer","alreadyImportedModules","_k","cssMapping","btoa","base64","unescape","encodeURIComponent","JSON","stringify","sourceMapping","sourceURLs","sources","sourceRoot","__webpack_module_cache__","moduleId","cachedModule","__esModule","definition","o","e","prop","r","toStringTag","Events_namespaceObject","webgl_util_namespaceObject","DrawUtil_namespaceObject","Input_Index_namespaceObject","Util_Index_namespaceObject","polyfill","audioContext","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","callback","setInterval","cancelAnimationFrame","webkitCancelAnimationFrame","mozCancelAnimationFrame","AudioContext","webkitAudioContext","replaceMe","decodeAudioData","arrayBuffer","Promise","resolve","reject","mozAudioContext","msAudioContext","oAudioContext","devicePixelRatio","Flags","static","enable","_FROZEN","_FLAGS","flagName","Error","createId","BITMASK32","Random","seed","_lowerMask","_upperMask","_w","_n","_m","_a","_u","_s","_b","_t","_c","_l","_f","_mt","Date","now","s","_index","_twist","mag01","nextInt","next","floating","bool","likelihood","pickOne","pickSet","numPicks","allowDuplicates","_pickSetWithDuplicates","_pickSetWithoutDuplicates","currentPick","tempArray","splice","shuffle","swap","randomIndex","range","d4","d6","d8","d10","d12","d20","TwoPI","PI","frac","sign","clamp","canonicalizeAngle","angle","tmpAngle","toDegrees","radians","toRadians","degrees","from","to","_x","randomInRange","randomIntInRange","round","Vector","_y","Zero","One","Half","Up","Down","Left","Right","cos","sin","vec","isNaN","Infinity","vec1","vec2","sqrt","pow","setTo","equals","vector","tolerance","abs","distance","deltaX","deltaY","squareDistance","clampMagnitude","magnitude","newSize","size","newLength","scale","average","add","sizeOrScale","dest","sub","addEqual","subEqual","scaleEqual","dot","cross","num","perpendicular","normal","negate","toAngle","atan2","rotate","anchor","sinAngle","cosAngle","clone","fixed","toFixed","LogLevel","Side","MatrixLocations","EventTypes","ImageFiltering","Logger","_appenders","defaultLevel","Info","_INSTANCE","addAppender","ConsoleAppender","appender","clearAppenders","_log","level","args","len","log","debug","Debug","info","warn","Warn","fatal","Fatal","console","consoleArgs","unshift","ScreenAppender","width","height","_messages","_canvas","innerWidth","innerHeight","style","position","_ctx","getContext","body","appendChild","message","clearRect","pos","opacity","fillStyle","fillText","Color","parseInt","parseFloat","hex","h","l","HSLColor","toRGBA","lighten","factor","temp","fromRGBA","darken","saturate","desaturate","multiply","color","newR","newG","newB","newA","screen","color1","invert","color2","equal","format","toHSLA","toHex","_componentToHex","c","Black","fromHex","White","Gray","LightGray","DarkGray","Yellow","Orange","Red","Vermilion","Rose","Magenta","Violet","Blue","Azure","Cyan","Viridian","Green","Chartreuse","Transparent","ExcaliburBlue","p","q","t","hue2rgb","getOpposite","side","Top","Bottom","None","fromDirection","direction","directions","directionEnum","Number","MAX_VALUE","maxIndex","BoundingBox","leftOrOptions","top","bottom","intersection","points","minX","minY","maxX","maxY","hasZeroDimensions","center","translate","point","getPoints","fromPoints","shifted","transform","matrix","xa1","xa2","xb1","xb2","ya1","ya2","yb1","yb2","matrixPos","getPosition","getPerimeter","results","rayCast","ray","farClipDistance","tmin","tmax","xinv","dir","yinv","tx1","tx2","ty1","ty2","rayCastTime","contains","combine","other","dimensions","overlaps","epsilon","totalBoundingBox","intersect","overlapX","overlapY","intersectWithSide","bb","getSideFromIntersection","draw","ex","drawRect","Future","_isCompleted","promise","_resolver","_rejecter","isCompleted","oLeft","oTop","calcOffsetLeft","parent","offsetLeft","offsetParent","calcOffsetTop","offsetTop","addItemToArray","removeItemFromArray","fail","delay","milliseconds","clock","future","schedule","setTimeout","Matrix","Float32Array","_scaleX","_scaleSignX","_scaleY","_scaleSignY","near","far","mat","toDOMMatrix","DOMMatrix","reset","identity","sx","sy","angleRadians","vectorOrMatrix","resultX","resultY","a11","a21","a31","a41","a12","a22","a32","a42","a13","a23","a33","a43","a14","a24","a34","a44","b11","b21","b31","b41","b12","b22","b32","b42","b13","b23","b33","b43","b14","b24","b34","b44","getScale","setPosition","sine","cosine","setRotation","currentScale","getRotation","getScaleY","getScaleX","xscale","yscale","setScaleX","setScaleY","setScale","getBasisDeterminant","getAffineInverse","inverseDet","m","tx","ty","isIdentity","AffineMatrix","Float64Array","_scale","determinant","inverse","to4x4","TransformStack","_transforms","_currentTransform","save","restore","pop","StateStack","_states","_currentState","_getDefaultState","z","tint","_cloneState","GameEvent","_bubbles","bubbles","stopPropagation","KillEvent","super","PreKillEvent","PostKillEvent","GameStartEvent","GameStopEvent","PreDrawEvent","ctx","delta","PostDrawEvent","PreDebugDrawEvent","PostDebugDrawEvent","PreUpdateEvent","engine","PostUpdateEvent","PreFrameEvent","prevStats","PostFrameEvent","stats","GamepadConnectEvent","gamepad","GamepadDisconnectEvent","GamepadButtonEvent","button","GamepadAxisEvent","axis","VisibleEvent","HiddenEvent","PreCollisionEvent","actor","PostCollisionEvent","ContactStartEvent","contact","ContactEndEvent","CollisionPreSolveEvent","CollisionPostSolveEvent","CollisionStartEvent","CollisionEndEvent","InitializeEvent","ActivateEvent","context","DeactivateEvent","ExitViewPortEvent","EnterViewPortEvent","EnterTriggerEvent","ExitTriggerEvent","EventDispatcher","_handlers","_wiredEventDispatchers","_deferedHandlerRemovals","clear","_processDeferredHandlerRemovals","eventHandler","_removeHandler","handler","emit","eventName","event","on","off","eventHandlers","once","metaHandler","ev","wire","eventDispatcher","unwire","Resource","responseType","bustCache","logger","getInstance","events","isLoaded","_cacheBust","uri","load","request","XMLHttpRequest","open","addEventListener","status","response","statusText","send","watch","change","__isProxy","Proxy","watchAny","Graphic","_d","_e","_ID","_transformStale","showDebug","_flipHorizontal","_flipVertical","_rotation","_origin","_width","_height","origin","flipHorizontal","flipVertical","rotation","isStale","cloneGraphicOptions","localBounds","fromDimension","_preDraw","_drawImage","_postDraw","_rotate","_flip","scaleDirX","scaleDirY","Sprite","_logger","_dirty","_logNotLoadedWarning","image","sourceView","destSize","_updateSpriteDimensions","ready","then","newWidth","newHeight","nativeWidth","nativeHeight","drawImage","TextureLoader","_GL","_MAX_TEXTURE_SIZE","getParameter","MAX_TEXTURE_SIZE","_TEXTURE_MAP","filtering","forceUpdate","gl","tex","bindTexture","TEXTURE_2D","texImage2D","RGBA","UNSIGNED_BYTE","createTexture","checkImageSizeSupportedAndLog","pixelStorei","UNPACK_PREMULTIPLY_ALPHA_WEBGL","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","filterMode","TEXTURE_MIN_FILTER","Pixel","NEAREST","LINEAR","TEXTURE_MAG_FILTER","deleteTexture","originalSrc","dataset","_LOGGER","Blended","Map","ImageSource","Image","_readyFuture","_resource","_filtering","endsWith","naturalWidth","naturalHeight","_src","src","async","url","blob","URL","createObjectURL","loadedFuture","onload","setAttribute","toSprite","unload","SpriteSheet","sprites","rows","columns","getSprite","spriteIndex","sourceViews","spacing","grid","cols","spriteWidth","spriteHeight","originOffset","margin","offsetDefaults","marginDefaults","SpriteFont","_text","alphabet","shadow","caseInsensitive","_alreadyWarnedAlphabet","_alreadyWarnedSpriteSheet","spriteSheet","_getCharacterSprites","text","textToRender","toLocaleLowerCase","letterIndex","letter","letterSprite","measureText","lines","maxWidthLine","reduce","sprite","xCursor","yCursor","line","render","_color","bounds","offset","DebugText","fontSheet","_imageSource","_spriteSheet","fromImageSource","_spriteFont","write","RenderSource","_gl","_texture","use","activeTexture","TEXTURE0","disable","RenderTarget","_setupFramebuffer","setResolution","_frameTexture","frameBuffer","_frameBuffer","frameTexture","attachmentPoint","COLOR_ATTACHMENT0","createFramebuffer","bindFramebuffer","FRAMEBUFFER","framebufferTexture2D","toRenderSource","viewport","ExcaliburWebGLContextAccessor","getGlTypeSizeBytes","FLOAT","SHORT","UNSIGNED_SHORT","BYTE","getAttributeComponentSize","LOW_FLOAT","HIGH_FLOAT","FLOAT_VEC2","FLOAT_VEC3","FLOAT_VEC4","getAttributePointerType","Shader","uniforms","attributes","_compiled","vertexSource","fragmentSource","compiled","useProgram","program","_ACTIVE_SHADER_INSTANCE","isCurrentlyBound","compile","vertexShader","_compileShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","_createProgram","getAttributes","attribute","getUniforms","uniform","uniformCount","getProgramParameter","ACTIVE_UNIFORMS","getActiveUniform","uniformLocation","getUniformLocation","glType","location","attributeCount","ACTIVE_ATTRIBUTES","getActiveAttrib","attributeLocation","getAttribLocation","normalized","setTexture","slotNumber","texture","setUniformInt","setUniform","setUniformIntArray","setUniformBoolean","setUniformFloat","setUniformFloatArray","setUniformFloatVector","setUniformMatrix","uniformType","createProgram","attachShader","linkProgram","LINK_STATUS","getProgramInfoLog","typeName","shader","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","errorInfo","getShaderInfoLog","_processSourceForError","errorLineStart","search","errorLineEnd","_","error2","VertexBuffer","buffer","createBuffer","bufferData","bindBuffer","ARRAY_BUFFER","STATIC_DRAW","DYNAMIC_DRAW","upload","count","bufferSubData","VertexLayout","_layout","_attributes","_vertexTotalSizeBytes","vertexBuffer","_vertexBuffer","_shader","initialize","totalVertexSizeBytes","shaderAttributes","attrib","componentsPerVertex","vertAttribute","typeSize","uploadBuffer","vert","vertexAttribPointer","enableVertexAttribArray","GraphicsDiagnostics","DrawCallCount","DrawnImagesCount","LineRenderer","priority","_maxLines","_vertexIndex","_lineCount","_context","ortho","_isFull","flush","getTransform","finalStart","finalEnd","hasPendingDraws","drawArrays","LINES","PointRenderer","_maxPoints","_pointCount","_buffer","snapToPixel","finalPoint","pixelSnapEpsilon","POINTS","ScreenPassPainter","renderWithPostProcessor","postprocessor","getShader","getLayout","TRIANGLES","renderToScreen","QuadIndexBuffer","numberOfQuads","useUint16","ELEMENT_ARRAY_BUFFER","totalVertices","maxUint16","maxUint16Index","bufferGlType","Uint16Array","Uint32Array","currentQuad","ImageRenderer","_maxImages","_maxTextures","_imageCount","_textures","MAX_TEXTURE_IMAGE_UNITS","transformedFrag","_transformFragmentSource","_quads","maxTextures","newSource","texturePickerBuilder","_addImageAsTexture","_bindTextures","_getTextureIdForImage","swidth","sheight","dx","dy","dwidth","dheight","view","sw","sh","topLeft","topRight","bottomLeft","bottomRight","textureId","imageWidth","imageHeight","uvx0","uvy0","uvx1","uvy1","drawElements","RectangleRenderer","_maxRectangles","_rectangleCount","drawLine","drawRectangle","thickness","halfThick","startTop","startBottom","endTop","endBottom","stroke","strokeThickness","CircleRenderer","_maxCircles","_circleCount","radius","Pool","builder","recycler","maxObjects","totalAllocations","objects","disableWarnings","preallocate","using","done","borrow","poolIndex","DrawCall","ExcaliburGraphicsContextWebGLDebug","_webglCtx","_debugText","rectOptions","lineOptions","drawPoint","pointOptions","drawText","ExcaliburGraphicsContextWebGL","_renderers","_isDrawLifecycle","useDrawSorting","_drawCallPool","instance","renderer","_drawCalls","_postProcessTargets","_postprocessors","_transform","_state","smoothing","backgroundColor","_alreadyWarnedDrawLifecycle","canvasElement","enableTransparency","__gl","antialias","premultipliedAlpha","alpha","depth","powerPreference","register","_init","canvas","_ortho","checkIfResolutionSupported","dim","supported","clearColor","COLOR_BUFFER_BIT","BLEND","blendEquation","FUNC_ADD","blendFunc","ONE","ONE_MINUS_SRC_ALPHA","blendEquationSeparate","blendFuncSeparate","_screenRenderer","_renderTarget","rendererName","_isCurrentRenderer","_currentRenderer","beginDrawLifecycle","endDrawLifecycle","drawCall","resetTransform","updateViewport","resolution","trace","drawCircle","addPostProcessor","removePostProcessor","clearPostProcessors","originalSort","firstIndex","findIndex","dc","zIndex","originalSortOrder","oldTransform","oldState","currentRendererName","currentRenderer","values","ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon","ExcaliburGraphicsContext2DCanvasDebug","_ex","__ctx","strokeStyle","strokeRect","beginPath","moveTo","lineTo","lineWidth","closePath","arc","fill","ExcaliburGraphicsContext2DCanvas","imageSmoothingEnabled","_resolution","globalAlpha","filter","fillRect","setTransform","_postprocessor","DisplayMode","Resolution","SVGA","Standard","Atari2600","GameBoy","GameBoyAdvance","NintendoDS","NES","SNES","Screen","_antialiasing","_resolutionStack","_viewportStack","_pixelRatioOverride","_isFullScreen","_isDisposed","_fullscreenChangeHandler","_pixelRatioChangeHandler","_listenForPixelRatio","_devicePixelRatio","_calculateDevicePixelRatio","applyResolutionAndViewport","_resizeHandler","_setResolutionAndViewportByDisplayMode","_alreadyWarned","_contentArea","_contentResolution","_displayMode","displayMode","Fixed","graphicsContext","antialiasing","_browser","browser","pixelRatio","_applyDisplayMode","_mediaQueryList","removeListener","nativeComponent","matchMedia","addListener","dispose","_resizeObserver","disconnect","removeEventListener","isHiDpi","FillContainer","FitContainer","FitContainerAndFill","FitContainerAndZoom","parentElement","_viewport","aspectRatio","scaledWidth","scaledHeight","setCurrentCamera","camera","_camera","pushResolutionAndViewport","peekViewport","peekResolution","popResolutionAndViewport","imageRendering","isSmooth","isFullScreen","goFullScreen","elementId","maybeElement","getElementById","requestFullscreen","exitFullScreen","exitFullscreen","pageToScreenCoordinates","newX","newY","screenHeight","screenWidth","screenToPageCoordinates","screenMarginY","screenMarginX","screenToWorldCoordinates","worldToScreenCoordinates","pageToWorldCoordinates","worldToPageCoordinates","getWorldBounds","drawWidth","drawHeight","canvasWidth","halfCanvasWidth","canvasHeight","halfCanvasHeight","zoom","halfDrawWidth","halfDrawHeight","contentArea","_computeFit","overflow","aspect","adjustedWidth","adjustedHeight","_computeFitScreenAndFill","vw","vh","_computeFitAndFill","_computeFitContainerAndFill","clientWidth","clientHeight","clip","_computeFitScreenAndZoom","_computeFitAndZoom","_computeFitContainerAndZoom","scaleX","scaleY","maxScaleFactor","zoomedWidth","zoomedHeight","_computeFitContainer","Window","ResizeObserver","observe","FillScreen","FitScreen","FitScreenAndFill","FitScreenAndZoom","AudioContextFactory","WebAudio","_UNLOCKED","create","unlockTimeoutTimer","resume","createBufferSource","ended","connect","destination","onended","playbackState","isLegacyWebAudioSource","currentTime","PLAYING_STATE","FINISHED_STATE","clearTimeout","Class","eventObject","x1","y1","x2","y2","cap","lineCap","roundRect","br","tl","tr","bl","defaultRadius","quadraticCurveTo","circle","Loader_0","Raster","_g","_h","_j","quality","_smoothing","flagDirty","_lineWidth","_lineDash","_padding","strokeColor","lineDash","padding","_bitmap","bitmapWidth","bitmapHeight","maybeCtx","cloneRasterOptions","dirty","_getTotalWidth","_originalWidth","_getTotalHeight","_originalHeight","_strokeColor","rasterize","_applyRasterProperties","execute","setLineDash","getLineDash","Canvas","_options","cache","ExResponse","any","json","arraybuffer","StateMachine","states","currentState","machineDescription","machine","stateName","transitionState","transitions","startState","in","go","eventData","potentialNewState","onExit","onEnter","onState","update","elapsedMs","onUpdate","saveKey","localStorage","setItem","parse","getItem","WebAudioInstance","_audioContext","_volumeNode","createGain","_playingPromise","_playingResolve","_stateMachine","PLAYING","_createNewBufferSource","_handleEnd","_instance","pausedAt","_playbackRate","duration","startedAt","_playStarted","stop","SEEK","STOPPED","PAUSED","_volume","_loop","loop","playbackRate","volume","gain","setTargetAtTime","_duration","getTotalPlaybackDuration","isPlaying","isPaused","play","playStarted","pause","seek","getPlaybackPosition","MediaEvent","_name","_value","_path","_val","action","propagate","layPath","_actor","NativeSoundEvent","track","NativeSoundProcessedEvent","_processedData","canPlayFile","file","Audio","filetype","canPlayType","Sound","paths","_isStopped","_tracks","_wasPlayingOnHidden","instances","audiobuffer","decodeAudio","wireEngine","_engine","pauseAudioWhenHidden","instanceCount","some","_resumePlayback","_startPlayback","forEach","trackId","_getTrackInstance","getTrackId","resumed","all","complete","newTrack","Loader","loadables","_resourceList","_playButtonShown","_resourceCount","_numLoaded","_progressCounts","_totalCounts","logo","logoWidth","logoHeight","loadingBarColor","suppressPlayButton","_playButtonStyles","Z","playButtonText","startButtonFactory","buttonElement","textContent","display","_loadingFuture","addResources","_image","_imageElement","playButtonRootElement","_playButtonRootElement","playButtonElement","_playButtonElement","_playButton","existingRoot","_styleBlock","head","addResource","loadable","resizeHandler","_positionPlayButton","evt","click","playButtonClicked","startButtonHandler","hidePlayButton","removeChild","_delta","areResourcesLoaded","decode","finally","resource","showPlayButton","unlock","markResourceComplete","progress","buttonWidth","buttonHeight","playButtonPosition","logoY","logoX","logoPosition","oldAntialias","getAntialiasing","setAntialiasing","loadingX","loadingY","loadingBarPosition","progressWidth","REPORTED_FEATURES","webgl","webaudio","gamepadapi","Detector","_features","failedTests","_criticalTests","canvasSupport","elem","arrayBufferSupport","xhr","dataUrlSupport","toDataURL","objectUrlSupport","rgbaSupport","cssText","_warningTest","webAudioSupport","webglSupport","_loadBrowserFeatures","getBrowserFeatures","logBrowserFeatures","msg","dataurl","objecturl","rgba","navigator","getGamepads","failedCritical","warning","CollisionType","maxMessages","obsoleteMessage","resetObsoleteCounter","logMessage","suppressObsoleteMessages","isEnabled","showStackTrace","obsolete","alternateMethod","property","SyntaxError","DecoratedClass","CollisionResolutionStrategy","BroadphaseStrategy","Integrator","CoordPlane","Physics","gravity","acc","collisionResolutionStrategy","Arcade","Realistic","dynamicTreeVelocityMultiplyer","dynamicTreeVelocityMultiplier","enabled","broadphaseStrategy","DynamicAABBTree","defaultMass","integrator","Euler","boundsPadding","positionIterations","velocityIterations","slop","steeringFactor","warmStart","bodiesCanSleepByDefault","surfaceEpsilon","sleepEpsilon","wakeThreshold","sleepBias","checkForFastBodies","disableMinimumSpeedForFastBody","decorators","desc","Reflect","decorate","__decorate","VectorView","_getX","getX","_getY","getY","_setX","setX","_setY","setY","WatchVector","original","Transform","_parent","_children","_pos","_isDirty","_isInverseDirty","_matrix","_inverse","children","globalPos","localPos","canonRotation","globalRotation","inverseRotation","globalScale","inverseScale","globalScaleX","globalScaleY","_calculateMatrix","applyInverse","Component","owner","newComponent","TagComponent","Observable","observers","subscriptions","observer","subscribe","unregister","unsubscribe","notifyAll","observersLength","notify","subscriptionsLength","TransformComponent","_addChildTransform","child","childTxComponent","zIndexChanged$","_z","coordPlane","World","onAdd","childrenAdded$","childrenRemoved$","onRemove","_previousOwner","oldz","MotionComponent","vel","scaleFactor","angularVelocity","torque","inertia","CollisionGroup","category","mask","_category","_mask","canCollide","collisionGroups","combinedName","combinedCategory","All","Pair","colliderA","colliderB","calculatePairHash","bodyA","BodyComponent","bodyB","group","collisionType","PreventCollision","active","collide","hasCollider","collider","idA","idB","Projection","projection","getOverlap","TreeNode","isLeaf","DynamicTree","worldBounds","root","nodes","_insert","leaf","leafAABB","currentRoot","area","combinedArea","cost","inheritanceCost","leftCost","leftCombined","newArea","oldArea","rightCost","rightCombined","oldParent","newParent","currentNode","_balance","_remove","grandParent","sibling","trackCollider","node","updateCollider","untrackCollider","multdx","multdy","balance","getHeight","query","helper","rayCastQuery","getNodes","Ray","numerator","begin","getSlope","divisor","u","getLength","intersectPoint","time","getPoint","DynamicTreeCollisionProcessor","_dynamicCollisionTree","_pairs","Set","_collisionPairCache","_colliders","getColliders","CompositeCollider","colliders","untrack","_pairExists","hash","broadphase","targets","seconds","potentialColliders","pair","physics","pairs","Active","updateDistance","minDimension","fastBodies","updateVec","oldPos","centerPoint","furthestPoint","getFurthestPoint","minCollider","minTranslate","hitPoint","isValid","shift","fastBodyCollisions","narrowphase","contacts","newContacts","collisions","updated","Collider","__compositeColliderId","touching","_collisionProcessor","_dynamicAABBTree","addCollider","clearColliders","removeCollider","worldPos","axes","furthestPoints","bestPoint","maxDistance","getInertia","mass","totalInertia","otherColliders","potentialCollider","getClosestLineBetween","maybeLine","minLength","minLine","minPoint","minDistance","project","projs","proj","newProjection","LineSegment","slope","intercept","_normal","_dir","_slope","getEdge","_length","midpoint","flip","below","sideVector","clipTime","distanceToPoint","signed","x0","y0","findVectorToPoint","aMinusP","findPoint","hasPoint","currPoint","threshold","dxc","dyc","dx1","dy1","ClosestLine","p0","q0","w0","denom","sDenom","tDenom","tClosestParallel","sClosest","tClosest","ClosestLineJumpTable","PolygonPolygonClosestLine","polygonA","polygonB","otherWorldPos","otherDirection","thisDirection","rayTowardsOther","rayTowardsThis","thisPoint","otherPoint","thisFace","getClosestFace","otherFace","face","PolygonEdgeClosestLine","polygon","edge","edgeLine","asLine","PolygonCircleClosestLine","circlex","circley","CircleCircleClosestLine","circleA","circleB","CircleEdgeClosestLine","circleWorlPos","EdgeEdgeClosestLine","edgeA","edgeB","edgeLineA","edgeLineB","CircleCollider","_globalMatrix","_naturalRadius","orig","discriminant","toi","toi1","toi2","positiveToi","mintoi","shape","PolygonCollider","EdgeCollider","CollisionJumpTable","CollideCircleCircle","CollideCirclePolygon","CollideCircleEdge","getFurthestLocalPoint","scalars","dotProduct","CollisionContact","mtv","tangent","localPoints","_canceled","matchAwake","sleeping","sleepMotion","setSleeping","isCanceled","cancel","SeparatingAxis","polyA","polyB","bestSeparation","bestSide","bestAxis","bestSideIndex","bestOtherPoint","sides","getSides","localSides","getLocalSides","vertB","vertSeparation","separation","localSide","sideId","localPoint","polyDir","closestPointOnPoly","minOverlap","minAxis","minIndex","proj1","proj2","overlap","circleAPos","circleBPos","combinedRadius","mvt","local","findCirclePolygonSeparation","samedir","findSide","findLocalSide","cc","edgeWorld","asLocalLine","da","dda","db","ddb","den","pointOnEdge","dd","CollideEdgeEdge","CollidePolygonEdge","pc","linePoly","CollidePolygonPolygon","separationA","findPolygonPolygonSeparation","separationB","incident","reference","refDir","clipRight","clipLeft","xf","FindContactSeparation","shapeA","txA","shapeB","txB","worldPoint","circlePoint","dist","_getTransformedBegin","_getTransformedEnd","transformedBegin","transformedEnd","_boundsFromBeginEnd","edgeNormal","_transformedPoints","_sides","_localSides","_transformedPointsDirty","_sidesDirty","_localSidesDirty","_localBoundsDirty","_isCounterClockwiseWinding","reverse","isConvex","_calculateTransformation","_points","sum","oldPoint","newPoint","oldDirection","orientation","angleSum","entries","tessellate","polygons","Shape","Polygon","triangulate","isPointInTriangle","ab","bc","ca","ap","bp","cp","cross1","cross2","cross3","triangles","vertices","indices","va","vb","vc","leftArm","isEar","vertIndex","getTransformedPoints","currentSide","mostDirection","testRay","accum","pts","POSITIVE_INFINITY","faceIndex","_localBounds","_cachedMass","_cachedInertia","denominator","iplusone","crossTerm","minContactTime","contactIndex","contactTime","scalar","firstPoint","Circle","Box","ColliderComponent","$colliderAdded","$colliderRemoved","_collider","flipped","entity","precollision","postcollision","useBoxCollider","usePolygonCollider","poly","useCircleCollider","useEdgeCollider","Edge","useCompositeCollider","DegreeOfFreedom","RotationType","FontUnit","TextAlign","BaseAlign","FontStyle","Direction","Axis","dependencies","_oldTransform","__oldTransformCaptured","enableFixedUpdateInterpolate","_mass","canSleep","_sleeping","bounciness","friction","useGravity","limitDegreeOfFreedom","oldVel","oldAcc","newMass","_cachedInverseInertia","inverseMass","updateMotion","currentMotion","bias","maybeCollider","inverseInertia","motion","oldRotation","oldScale","applyImpulse","impulse","finalImpulse","X","Y","Rotation","distanceFromCenter","applyLinearImpulse","applyAngularImpulse","captureOldTransform","AddedComponent","isAddedComponent","RemovedComponent","isRemovedComponent","Entity","components","_componentsToRemove","_componentTypeToInstance","_componentStringToInstance","_tagsMemo","_typesMemo","componentAdded$","componentRemoved$","_isInitialized","_setName","component","addComponent","kill","isKilled","tags","hasTag","addTag","removeTag","force","removeComponent","types","_rebuildMemos","getComponents","_notifyAddComponent","added","_notifyRemoveComponent","removed","unparent","addChild","getAncestors","removeAllChildren","getDescendants","queue","curr","newEntity","addTemplate","templateEntity","ctor","constuctorType","componentOrType","_removeComponentByType","delete","processComponentRemoval","isInitialized","_initialize","onInitialize","_preupdate","onPreUpdate","_postupdate","onPostUpdate","hasGraphicsTick","graphic","tick","GraphicsLayer","_graphics","graphics","hide","nameOrGraphic","gfx","getGraphic","recalculateBounds","show","copyGraphics","getNames","order","currentKeys","GraphicsLayers","_component","_layers","_layerMap","default","_maybeAddLayer","_getLayer","graphicsLayerKeys","GraphicsComponent","visible","onPreDraw","onPostDraw","layers","graphicToSet","offsetX","offsetY","elapsed","idempotencyToken","Rectangle","_radius","PointerComponent","useColliderShape","useGraphicsBounds","EasingFunctions","easing","Linear","CreateReversibleEasingFunction","startValue","endValue","EaseInQuad","EaseOutQuad","EaseInOutQuad","EaseInCubic","EaseOutCubic","EaseInOutCubic","ActionQueue","_actions","_completedActions","_entity","remove","clearActions","_currentAction","getActions","hasNext","isComplete","Repeat","repeatBuilder","repeat","_stopped","_repeatBuilder","_repeatContext","ActionContext","_actionQueue","getQueue","_repeat","_originalRepeat","RepeatForever","MoveBy","speed","_started","_tx","_motion","_speed","_offset","_start","_end","_distance","MoveTo","destx","desty","RotateTo","rotationType","_rotationType","ShortestPath","_currentNonCannonAngle","distance1","distance2","_shortDistance","_longDistance","_shortestPathIsPositive","_direction","LongestPath","Clockwise","CounterClockwise","distanceTraveled","RotateBy","angleRadiansOffset","ScaleTo","speedX","speedY","_endX","_endY","_speedX","_speedY","_startX","_startY","_distanceX","_distanceY","directionX","directionY","ScaleBy","scaleOffsetX","scaleOffsetY","_startScale","_endScale","_directionX","_directionY","CallMethod","_method","_hasBeenCalled","EaseTo","easingFcn","_currentLerpTime","_lerpDuration","_lerpStart","_lerpEnd","_initialized","EaseBy","Blink","timeVisible","timeNotVisible","numBlinks","_timeVisible","_timeNotVisible","_elapsedTime","_totalTime","Fade","endOpacity","_multiplier","_endOpacity","_ogspeed","Delay","_delay","Die","ActionsComponent","Follow","entityToFollow","followDistance","_followTx","_followMotion","_current","_maximumDistance","_distanceBetween","actorToFollowSpeed","Meet","actorToMeet","_speedWasSpecified","_meetTx","_meetMotion","actorToMeetSpeed","_queue","runAction","easeTo","easeBy","xOrPos","yOrSpeed","speedOrUndefined","moveBy","xOffsetOrVector","yOffsetOrSpeed","xOffset","yOffset","rotateTo","rotateBy","scaleTo","sizeXOrVector","sizeYOrSpeed","speedXOrUndefined","speedYOrUndefined","sizeX","sizeY","scaleBy","sizeOffsetXOrVector","sizeOffsetYOrSpeed","sizeOffsetX","sizeOffsetY","blink","fade","die","callMethod","times","repeatForever","follow","meet","toPromise","Font","_o","_p","_q","_r","family","Normal","bold","unit","Px","textAlign","baseAlign","Alphabetic","LeftToRight","_textBounds","_cachedTextMeasurement","_bitmapToTextMeasurement","_textToBitmap","_bitmapUsage","_textFragments","blur","fontString","measurementDirty","cached","rasterProps","_getRasterPropertiesHash","_getTextBitmap","_applyFont","metrics","textHeight","actualBoundingBoxAscent","actualBoundingBoxDescent","lineAdjustedHeight","bottomBounds","measurement","actualBoundingBoxLeft","actualBoundingBoxRight","_setDimension","textBounds","textBaseline","font","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","_drawText","colorOverride","lineHeight","strokeText","textAndHash","_splitTextBitmap","textImages","currentX","currentY","clearCache","checkAndClearCache","isNewBitmap","frag","performance","cacheSize","Text","_textWidth","_textHeight","_font","_calculateDimension","Actor","config","_anchor","_handleAnchorChange","scene","_draggable","_dragging","_pointerDragStartHandler","_pointerDragEndHandler","_pointerDragMoveHandler","pe","_pointerDragLeaveHandler","collisionGroup","defaults","Passive","pointer","actions","thePos","theVel","theAcc","theAngle","isOffScreen","draggable","isDraggable","currentGraphic","_prekill","_scene","onPreKill","_postkill","onPostKill","unkill","newZ","getGlobalPos","localCenter","getGlobalScale","getGlobalRotation","recurse","geom","containment","within","otherCollider","me","isScreenElement","ScreenElement","useWorld","coords","Timer","fcn","interval","repeats","numberOfRepeats","randomRange","_totalTimeAlive","_running","_numberOfTicks","maxNumberOfRepeats","_baseInterval","_generateRandomInterval","_complete","_MAX_ID","_callbacks","newInterval","newNumberOfRepeats","timesRepeated","getTimeRunning","timeToNextAction","timeElapsedTowardNextAction","isRunning","cancelTimer","ParallaxComponent","parallaxFactor","DebugGraphicsComponent","useTransform","TileMap","_token","_onScreenXStart","_onScreenXEnd","_onScreenYStart","_onScreenYEnd","tiles","_rows","_cols","renderFromTopOfGraphic","_collidersDirty","_originalOffsets","_composite","_oldPos","tileWidth","tileHeight","currentCol","cd","Tile","flagCollidersDirty","_getOrSetColliderOriginalOffset","originalOffset","_updateColliders","tile","solid","prev","getTileByIndex","getTile","getTileByPoint","getRows","getColumns","worldCoordsUpperLeft","worldCoordsLowerRight","maybeParallax","parallaxOffset","oneMinusFactor","currentScene","xEnd","yEnd","graphicsIndex","graphicsLen","getGraphics","grayish","_posDirty","_solid","_recalculate","addGraphic","removeGraphic","clearGraphics","_bounds","StrategyContainer","lockToActor","addStrategy","LockCameraToActorStrategy","lockToActorAxis","LockCameraToActorAxisStrategy","elasticToActor","cameraElasticity","cameraFriction","ElasticToActorStrategy","radiusAroundActor","RadiusAroundActorStrategy","limitCameraBounds","box","LimitCameraBoundsStrategy","_cam","_eng","cam","currentFocus","getFocus","focus","cameraVel","stretch","boundSizeChecked","focusX","focusY","Camera","_cameraStrategies","strategy","dz","az","_angularVelocity","_posChanged","_cameraMoving","_isShaking","_shakeMagnitudeX","_shakeMagnitudeY","_shakeDuration","_elapsedShakeTime","_xShake","_yShake","_isZooming","_zoomStart","_zoomEnd","_currentZoomTime","_zoomDuration","_zoomEasing","_easing","_halfWidth","_halfHeight","_follow","ax","ay","move","easingFn","_lerpPromise","_lerpResolve","shake","magnitudeX","magnitudeY","zoomOverTime","_zoomPromise","_zoomResolve","cameraStrategy","removeStrategy","clearAllStrategies","_screen","currentRes","loadingComplete","res","updateTransform","runStrategies","newZoom","zoomEasing","lerpPoint","CreateVectorEasingFunction","moveEasing","_isDoneShaking","newCanvasWidth","newCanvasHeight","cameraPos","triggerDefaults","Trigger","opts","_dispatchAction","_target","SystemType","System","_entityAddedOrRemoved","AddedEntity","isAddedSystemEntity","RemovedEntity","isRemoveSystemEntity","EntityManager","_world","entities","_entityIndex","_entitiesToRemove","updateEntities","removeEntity","findEntitiesForRemoval","queryManager","addEntity","idOrEntity","deferred","currFrame","actors","killed","processEntityRemovals","processComponentRemovals","getById","getByName","buildTypeKey","localeCompare","Query","_entities","T","_key","getEntities","matches","typesOrEntity","contain","QueryManager","_queries","_addQuery","entityManager","maybeRemoveQuery","queryType","createQuery","maybeExistingQuery","getQuery","SystemManager","systems","initialized","systemType","find","addSystem","system","removeSystem","updateSystems","preupdate","Scene","postupdate","systemManager","Update","entityOrSystem","clearEntities","clearSystems","EulerIntegrator","totalAcc","_ACC","_VEL","_POS","_VEL_ACC","_SCALE_FACTOR","_SCALE","MotionSystem","optionalBody","integrate","ArcadeSolver","directionMap","distanceMap","solve","preSolve","solvePosition","solveVelocity","postSolve","opposite","velAdj","ContactConstraintPoint","normalImpulse","tangentImpulse","normalMass","tangentMass","aToContact","bToContact","originalVelocityAndRestitution","aToContactNormal","bToContactNormal","aToContactTangent","bToContactTangent","getRelativeVelocity","velA","RealisticSolver","lastFrameContacts","idToContactConstraint","getContactConstraints","finishedContactIds","contactPoints","pointIndex","restitution","relativeVelocity","constraints","maxCorrection","steeringForce","impulseForce","impulseDelta","maxFriction","newImpulse","normalVelocity","CollisionSystem","_realisticSolver","_arcadeSolver","_processor","_lastFrameContacts","_currentFrameContacts","_trackCollider","_untrackCollider","colliderComponent","colliderComp","compositeColliders","getSolver","compositeId","substring","runContactStartEnd","AnimationDirection","AnimationStrategy","EmitterType","ColorBlindnessMode","PointerScope","Keys","Buttons","Axes","WheelDeltaMode","NativePointerButton","PointerButton","PointerType","Animation","frames","Loop","frameDuration","timeScale","_idempotencyToken","_firstTick","_currentFrame","_timeLeftInFrame","_done","_playing","_reversed","totalDuration","goToFrame","maybeFrame","currentFrame","frameIndices","durationPerFrameMs","invalidIndices","currentFrameIndex","Backward","Forward","canFinish","End","Freeze","frameNumber","_nextFrame","PingPong","elapsedMilliseconds","GraphicsGroup","members","_updateDimensions","_isAnimationOrGroup","member","maybeAnimation","Configurable","base","assign","props","ParticleImpl","emitterOrConfig","life","beginColor","endColor","velocity","acceleration","startSize","endSize","particleRotationalVelocity","currentRotation","focusAccel","fadeFlag","_rRate","_gRate","_bRate","_aRate","_currentColor","emitter","particleSize","particleSprite","sizeRate","elapsedMultiplier","isOffscreen","ParticleEmitter","tmpColor","removeParticle","accel","Particle","_particlesToEmit","numParticles","isEmitting","particles","deadParticles","minVel","maxVel","minAngle","maxAngle","emitRate","particleLife","minSize","maxSize","_sprite","emitterType","randomRotation","particle","emitParticles","particleCount","_createParticle","world","clearParticles","ranX","ranY","GraphicsSystem","Draw","_sortedTransforms","_zHasChanged","_zIndexUpdate","sortedTransforms","_graphicsContext","entityAddedOrRemoved","parallax","_applyTransform","particleOpacity","_drawGraphicsComponent","graphicsComponent","isDebug","showBounds","boundsColor","ancestors","ancestor","interpolatedPos","interpolatedScale","interpolatedRotation","fixedUpdateFps","blend","currentFrameLagMs","DebugSystem","_collisionSystem","filterSettings","entitySettings","txSettings","motionSettings","colliderSettings","physicsSettings","graphicsSettings","debugDraw","bodySettings","cameraSettings","useFilter","ids","nameQuery","cursor","_pushCameraTransform","showAll","showPosition","positionColor","showPositionLabel","showZIndex","showId","showName","showRotation","fromAngle","rotationColor","showScale","scaleColor","showCollisionGroup","showCollisionType","showMass","showMotion","showSleeping","showVelocity","velocityColor","showAcceleration","accelerationColor","showGeometry","geometryColor","showOwner","_popCameraTransform","showBroadphaseSpacePartitionDebug","showCollisionContacts","showCollisionNormals","collisionContactColor","collisionNormalColor","showFocus","focusColor","showZoom","PointerSystem","overrideUseColliderShape","overrideUseGraphicsBounds","lastFrameEntityToPointers","currentFrameEntityToPointers","_sortedEntities","_receiver","pointers","entityCurrentlyUnderPointer","pointerId","entityWasUnderPointer","entered","addPointerToEntity","_processPointerToEntity","_dispatchEvents","currentFramePointerCoords","screenPos","graphicBounds","_processDownAndEmit","lastDownPerPointer","currentFrameDown","isDragStart","_processUpAndEmit","lastUpPerPointer","currentFrameUp","isDragEnd","_processMoveAndEmit","lastMovePerPointer","currentFrameMove","isDragging","_processEnterLeaveAndEmit","lastUpDownMoveEvents","_processCancelAndEmit","currentFrameCancel","_processWheelAndEmit","currentFrameWheel","lastFrameEntities","currentFrameEntities","entitiesWithEvents","ActionsSystem","IsometricEntityComponent","elevation","IsometricEntitySystem","iso","OffscreenSystem","entityOffscreen","_isOffscreen","transformedBounds","_timers","_cancelQueue","triggers","tileMaps","timers","onActivate","onDeactivate","_initializeChildren","_activate","_deactivate","_predraw","_postdraw","removeTimer","timer","_collectActorStats","addTimer","isTimerActive","isCurrentScene","screenElements","_ui","ui","alive","ScreenShader","ColorBlindnessPostProcessor","_colorBlindnessMode","simulate","_simulate","colorBlindnessMode","colorBlindMode","Protanope","Deuteranope","Tritanope","ColorBlindFlags","_colorBlindPostProcessor","correct","colorBlindness","FrameStats","prevFrame","useTestClock","wasRunning","testClock","toTestClock","useStandardClock","currentClock","standardClock","toStandardClock","_id","_fps","_actorStats","remaining","total","_durationStats","_physicsStats","PhysicsStats","_graphicsStats","drawCalls","drawnImages","otherStats","fps","fs","_collisions","_contacts","_fastBodies","_fastBodyCollisions","_broadphase","_narrowphase","ps","KeyEvent","originalEvent","Keyboard","_keys","_keysUp","_keysDown","_handleKeyDown","keyEvent","_handleKeyUp","init","noop","getKeys","wasPressed","isHeld","wasReleased","triggerEvent","character","KeyboardEvent","Gamepads","_gamePadTimeStamps","_oldPads","_pads","_initSuccess","_navigator","_minimumConfiguration","_clonePads","setMinimumGamepadConfiguration","_enableAndUpdate","_isGamepadValid","pad","axesLength","buttonLength","buttons","connected","gamepads","at","timestamp","bi","ai","navigatorGamepad","getButton","pressed","updateButton","getAxes","updateAxes","_clonePad","Gamepad","getValidGamepads","pads","arr","clonedPad","MinAxisMoveThreshold","_buttons","_axes","isButtonPressed","buttonIndex","axesIndex","BrowserComponent","_paused","_nativeHandlers","_decorate","BrowserEvents","_windowGlobal","_documentGlobal","_windowComponent","_documentComponent","GlobalCoordinates","pagePos","yOrEngine","engineOrUndefined","pageX","pageY","PointerEvent","pointerType","coordinates","nativeEvent","WheelEvent","screenX","screenY","deltaZ","deltaMode","PointerAbstraction","lastPagePos","lastScreenPos","lastWorldPos","_onPointerMove","_onPointerDown","PointerEventReceiver","primary","_activeNativePointerIdsToNormalized","lastFramePointerCoords","currentFramePointerDown","lastFramePointerDown","_pointers","_boundHandle","_handle","_boundWheel","_handleWheel","recreate","eventReceiver","isDown","wasDown","native","touchAction","wheelOptions","passive","pageScrollPreventionMode","ScrollPreventionMode","onmousewheel","detach","_normalizePointerId","nativePointerId","preventDefault","eventCoords","TouchEvent","Unknown","Touch","changedTouches","touch","fromPagePosition","_nativeButtonToPointerButton","Mouse","isPointerEvent","_stringToPointerType","coord","ScrollWheelNormalizationFactor","wheelDeltaX","wheelDeltaY","wheelDelta","detail","Line","Page","we","page","clientX","clientY","MouseEvent","pointerSystem","transformEntities","NoButton","Middle","Pen","FpsSampler","_samplePeriod","_currentFrameTime","_frames","_previousSampleTime","_beginFrameTime","initialFps","samplePeriod","_nowFn","nowFn","instant","Clock","_onFatalException","_maxFps","_lastTime","_elapsed","_scheduledCbs","_totalElapsed","maxFps","onFatalException","fpsSampler","TestClock","defaultUpdateMs","StandardClock","setFatalExceptionHandler","cb","timeoutMs","scheduledTime","_runScheduledCbs","overrideUpdateMs","fpsInterval","leftover","mainloop","_requestId","_currentTime","_updateMs","step","run","numberOfSteps","Util_Toaster","Toaster","_toasterCss","_container","_createFragment","toastMessage","innerText","toast","linkTarget","linkName","className","messageFragments","link","href","finalMessage","dismissBtn","keydownHandler","first","firstChild","insertBefore","Engine","scenes","_suppressPlayButton","_isDebug","enableCanvasTransparency","_toaster","_timescale","_deferredGoTo","_originalOptions","_performanceThresholdTriggered","_fpsSamples","_loadingComplete","_isReady","_isReadyPromise","_isReadyResolve","currentFrameElapsedMs","_lagMs","_screenShotRequests","_DEFAULT_ENGINE_OPTIONS","freeze","detector","suppressMinimumBrowserFeatureDetection","_compatible","testMessage","canvasElementId","suppressConsoleBootMessage","EX_VERSION","_originalDisplayMode","useCanvasGraphicsContext","suppressHiDPIScaling","_mainloop","_loader","rootScene","addScene","___EXCALIBUR_DEVTOOL","isFullscreen","shouldSnapToPixel","_monitorPerformanceThresholdAndTriggerFallback","allow","configurePerformanceCanvas2DFallback","showPlayerMessage","numberOfFrames","useCanvas2DFallback","newCanvas","cloneNode","parentNode","replaceChild","pointerTarget","pointerScope","Document","timescale","removeScene","goToScene","previousScene","nextScene","scrollPreventionMode","hidden","visibilityChange","keyboard","_overrideInitialize","deferredScene","_update","_draw","_checkForScreenShots","toggle","toggleDebug","isReady","loader","frameId","beforeUpdate","fixedTimestepMs","afterUpdate","afterDraw","screenshot","preserveHiDPIResolution","finalWidth","finalHeight","raw","Label","spriteFont","newFont","sf","getTextWidth","IsometricTile","graphicsOffset","_tileBounds","_isometricEntityComponent","halfTileWidth","halfTileHeight","xPos","yPos","_gfx","totalWidth","totalHeight","_recalculateBounds","tileToWorld","IsometricMap","updateColliders","worldToTile","worldCoordinate","tileCoordinate","tileCoord","_getMaxZIndex","maxZ","NEGATIVE_INFINITY","currentZ","ActionSequence","actionBuilder","_sequenceBuilder","_sequenceContext","ParallelActions","parallelActions","every","CollisionGroupManager","_CURRENT_GROUP","_MAX_GROUPS","_GROUPS","_CURRENT_BIT","groups","_STARTING_BIT","has_initialize","hasOnInitialize","has_preupdate","hasOnPreUpdate","has_postupdate","hasOnPostUpdate","hasPreDraw","hasPostDraw","Gif","_stream","_gif","_animation","_transparentColor","Stream","ParseGif","images","toSpriteSheet","toAnimation","fromSpriteSheet","readCheckBytes","checkBytes","bitsToNum","ba","byteToBitArr","bite","dataArray","readByte","byteLength","readBytes","bytes","read","readUnsigned","Uint8Array","stream","_st","_handler","globalColorTable","parseColorTable","ct","readSubBlocks","parseHeader","hdr","sig","ver","colorRes","globalColorTableSize","gctFlag","sorted","bgColor","pixelAspectRatio","bits","parseExt","block","parseGCExt","reserved","disposalMethod","userInput","transparencyGiven","delayTime","transparencyIndex","terminator","gce","parseComExt","comment","com","parsePTExt","ptHeader","ptData","pte","parseAppExt","identifier","authCode","unknown","iterations","app","NETSCAPE","parseNetscapeExt","appData","parseUnknownAppExt","parseUnknownExt","label","extType","parseImg","img","leftPos","topPos","lctFlag","interlaced","lctSize","lct","lzwMinCodeSize","lzwData","pixels","minCodeSize","readCode","charCodeAt","output","clearCode","eoiCode","codeSize","dict","last","lzwDecode","newPixels","cpRow","toRow","fromRow","fromPixels","offsets","steps","pass","deinterlace","arrayToImage","parseBlock","sentinel","eof","frame","AsyncWaitQueue","enqueue","dequeue","Semaphore","_count","_waitQueue","waiting","exit","__webpack_exports__ActionContext","fWn","__webpack_exports__ActionQueue","Ia8","__webpack_exports__ActionSequence","rqv","__webpack_exports__ActionsComponent","hLI","__webpack_exports__ActionsSystem","yyv","__webpack_exports__ActivateEvent","tX5","__webpack_exports__Actor","vtX","__webpack_exports__AddedComponent","r7K","__webpack_exports__AddedEntity","lCh","__webpack_exports__AffineMatrix","cE4","__webpack_exports__Animation","fwF","__webpack_exports__AnimationDirection","sce","__webpack_exports__AnimationStrategy","_c7","__webpack_exports__ArcadeSolver","KUs","__webpack_exports__AudioContextFactory","Ajp","__webpack_exports__Axis","RDh","__webpack_exports__BaseAlign","_H9","__webpack_exports__Blink","mxs","__webpack_exports__BodyComponent","OmD","__webpack_exports__BoundingBox","kBf","__webpack_exports__BroadphaseStrategy","C4F","__webpack_exports__BrowserComponent","NQt","__webpack_exports__BrowserEvents","JjN","__webpack_exports__Camera","V1s","__webpack_exports__Canvas","Xz7","__webpack_exports__Circle","Cdc","__webpack_exports__CircleCollider","FKn","__webpack_exports__Class","wTW","__webpack_exports__Clock","SUY","__webpack_exports__ClosestLine","ab2","__webpack_exports__ClosestLineJumpTable","GfZ","__webpack_exports__Collider","YMS","__webpack_exports__ColliderComponent","oyv","__webpack_exports__CollisionContact","aUb","__webpack_exports__CollisionEndEvent","SdD","__webpack_exports__CollisionGroup","JUv","__webpack_exports__CollisionGroupManager","jEj","__webpack_exports__CollisionJumpTable","TFq","__webpack_exports__CollisionPostSolveEvent","HDU","__webpack_exports__CollisionPreSolveEvent","R_y","__webpack_exports__CollisionResolutionStrategy","ydN","__webpack_exports__CollisionStartEvent","t50","__webpack_exports__CollisionSystem","s$$","__webpack_exports__CollisionType","v2G","__webpack_exports__Color","Ilk","__webpack_exports__ColorBlindFlags","s9i","__webpack_exports__ColorBlindnessMode","dxL","__webpack_exports__ColorBlindnessPostProcessor","LLX","__webpack_exports__Component","wA2","__webpack_exports__CompositeCollider","R_p","__webpack_exports__Configurable","IQ$","__webpack_exports__ConsoleAppender","I5F","__webpack_exports__ContactConstraintPoint","X8$","__webpack_exports__ContactEndEvent","FR6","__webpack_exports__ContactStartEvent","U8o","__webpack_exports__CoordPlane","kbG","__webpack_exports__DeactivateEvent","iS_","__webpack_exports__Debug","cGG","__webpack_exports__DebugGraphicsComponent","RPN","__webpack_exports__DebugSystem","skb","__webpack_exports__DebugText","SLU","__webpack_exports__DegreeOfFreedom","RdJ","__webpack_exports__Delay","cNu","__webpack_exports__Detector","gU7","__webpack_exports__Die","LSk","__webpack_exports__Direction","Nmp","__webpack_exports__DisplayMode","d1Y","__webpack_exports__DynamicTree","xrL","__webpack_exports__DynamicTreeCollisionProcessor","sRW","__webpack_exports__EX_VERSION","cmV","__webpack_exports__EaseBy","qWz","__webpack_exports__EaseTo","N0Q","__webpack_exports__EasingFunctions","q8b","__webpack_exports__EdgeCollider","ynB","__webpack_exports__ElasticToActorStrategy","jT9","__webpack_exports__EmitterType","wAz","__webpack_exports__Engine","D4V","__webpack_exports__EnterTriggerEvent","N6H","__webpack_exports__EnterViewPortEvent","W1A","__webpack_exports__Entity","JHW","__webpack_exports__EntityManager","v2K","__webpack_exports__EventDispatcher","pBf","__webpack_exports__EventTypes","GMl","__webpack_exports__Events","zW2","__webpack_exports__ExResponse","B0K","__webpack_exports__ExcaliburGraphicsContext2DCanvas","Nv7","__webpack_exports__ExcaliburGraphicsContextWebGL","C_p","__webpack_exports__ExcaliburWebGLContextAccessor","iqw","__webpack_exports__ExitTriggerEvent","MUA","__webpack_exports__ExitViewPortEvent","xqU","__webpack_exports__Fade","pTp","__webpack_exports__Flags","vUK","__webpack_exports__Follow","j9l","__webpack_exports__Font","Zxw","__webpack_exports__FontStyle","Hdx","__webpack_exports__FontUnit","Z$d","__webpack_exports__FpsSampler","iqV","__webpack_exports__FrameStats","o$7","__webpack_exports__Future","olM","__webpack_exports__GameEvent","Zm$","__webpack_exports__GameStartEvent","$QH","__webpack_exports__GameStopEvent","i78","__webpack_exports__GamepadAxisEvent","h6u","__webpack_exports__GamepadButtonEvent","hts","__webpack_exports__GamepadConnectEvent","j88","__webpack_exports__GamepadDisconnectEvent","VME","__webpack_exports__Gif","nt","__webpack_exports__GlobalCoordinates","Ukr","__webpack_exports__Graphic","zsu","__webpack_exports__GraphicsComponent","oA6","__webpack_exports__GraphicsGroup","TVh","__webpack_exports__GraphicsLayer","TwZ","__webpack_exports__GraphicsLayers","GTT","__webpack_exports__GraphicsSystem","xxj","__webpack_exports__HiddenEvent","XdK","__webpack_exports__ImageFiltering","Jmb","__webpack_exports__ImageSource","cXo","__webpack_exports__InitializeEvent","Dm5","__webpack_exports__Input","IIB","__webpack_exports__Integrator","zI0","__webpack_exports__IsometricEntityComponent","LYD","__webpack_exports__IsometricEntitySystem","cEG","__webpack_exports__IsometricMap","SEl","__webpack_exports__IsometricTile","t9V","__webpack_exports__KillEvent","SKZ","__webpack_exports__Label","__J","__webpack_exports__LimitCameraBoundsStrategy","RI$","__webpack_exports__Line","x12","__webpack_exports__LineSegment","ccz","__webpack_exports__Loader","aNw","__webpack_exports__LockCameraToActorAxisStrategy","xwn","__webpack_exports__LockCameraToActorStrategy","dNK","__webpack_exports__LogLevel","ini","__webpack_exports__Logger","YdH","__webpack_exports__Matrix","y3G","__webpack_exports__MatrixLocations","l57","__webpack_exports__MediaEvent","xn0","__webpack_exports__Meet","t2V","__webpack_exports__MotionComponent","uxB","__webpack_exports__MotionSystem","cpd","__webpack_exports__MoveBy","fiy","__webpack_exports__MoveTo","$XZ","__webpack_exports__NativeSoundEvent","uqK","__webpack_exports__NativeSoundProcessedEvent","STE","__webpack_exports__Observable","y$z","__webpack_exports__OffscreenSystem","mAD","__webpack_exports__Pair","sOq","__webpack_exports__ParallaxComponent","hUw","__webpack_exports__ParallelActions","_0G","__webpack_exports__ParseGif","Sqs","__webpack_exports__Particle","hpZ","__webpack_exports__ParticleEmitter","Vol","__webpack_exports__Physics","wIZ","__webpack_exports__PhysicsStats","cBi","__webpack_exports__PointerComponent","RFv","__webpack_exports__PointerSystem","kfC","__webpack_exports__Polygon","mgq","__webpack_exports__PolygonCollider","YVA","__webpack_exports__Pool","Kgp","__webpack_exports__PostCollisionEvent","HH$","__webpack_exports__PostDebugDrawEvent","M_d","__webpack_exports__PostDrawEvent","rgh","__webpack_exports__PostFrameEvent","Ra6","__webpack_exports__PostKillEvent","KhR","__webpack_exports__PostUpdateEvent","BS5","__webpack_exports__PreCollisionEvent","xhz","__webpack_exports__PreDebugDrawEvent","xOq","__webpack_exports__PreDrawEvent","a9j","__webpack_exports__PreFrameEvent","bHk","__webpack_exports__PreKillEvent","CgK","__webpack_exports__PreUpdateEvent","cuY","__webpack_exports__Projection","kvE","__webpack_exports__QuadIndexBuffer","SBu","__webpack_exports__Query","AE_","__webpack_exports__QueryManager","ctO","__webpack_exports__RadiusAroundActorStrategy","OLH","__webpack_exports__Random","kky","__webpack_exports__Raster","nSF","__webpack_exports__Ray","zHn","__webpack_exports__RealisticSolver","zwx","__webpack_exports__Rectangle","AeJ","__webpack_exports__RemovedComponent","hLz","__webpack_exports__RemovedEntity","D9g","__webpack_exports__Repeat","wA","__webpack_exports__RepeatForever","jhr","__webpack_exports__Resolution","GVs","__webpack_exports__Resource","_zO","__webpack_exports__RotateBy","w6$","__webpack_exports__RotateTo","mhV","__webpack_exports__RotationType","MOD","__webpack_exports__ScaleBy","kwd","__webpack_exports__ScaleTo","Lmr","__webpack_exports__Scene","xsS","__webpack_exports__Screen","lLr","__webpack_exports__ScreenAppender","Z$r","__webpack_exports__ScreenElement","IXb","__webpack_exports__ScreenShader","SGH","__webpack_exports__ScrollPreventionMode","SMj","__webpack_exports__Semaphore","L34","__webpack_exports__Shader","exe","__webpack_exports__Shape","bnF","__webpack_exports__Side","MFA","__webpack_exports__Sound","$uU","__webpack_exports__Sprite","jyi","__webpack_exports__SpriteFont","E03","__webpack_exports__SpriteSheet","V6q","__webpack_exports__StandardClock","rg2","__webpack_exports__StateMachine","DVW","__webpack_exports__StrategyContainer","nVo","__webpack_exports__Stream","F6N","__webpack_exports__System","xP7","__webpack_exports__SystemManager","Odq","__webpack_exports__SystemType","Zif","__webpack_exports__TagComponent","ZGJ","__webpack_exports__TestClock","MJk","__webpack_exports__Text","xvT","__webpack_exports__TextAlign","PHM","__webpack_exports__TextureLoader","dpR","__webpack_exports__Tile","n9L","__webpack_exports__TileMap","KwO","__webpack_exports__Timer","B7y","__webpack_exports__Toaster","x7r","__webpack_exports__Transform","wx7","__webpack_exports__TransformComponent","Uvn","__webpack_exports__TreeNode","OFT","__webpack_exports__Trigger","xzN","__webpack_exports__TwoPI","M5Z","__webpack_exports__Util","ZrN","__webpack_exports__Vector","OWs","__webpack_exports__VectorView","dF9","__webpack_exports__VertexBuffer","oZy","__webpack_exports__VertexLayout","rD2","__webpack_exports__VisibleEvent","VHo","__webpack_exports__WebAudio","ohE","__webpack_exports__WebAudioInstance","R$E","__webpack_exports__World","q3I","__webpack_exports__canonicalizeAngle","Pab","__webpack_exports__clamp","uZ5","__webpack_exports__createId","McK","__webpack_exports__frac","F9c","__webpack_exports__hasGraphicsTick","k0b","__webpack_exports__hasOnInitialize","hnT","__webpack_exports__hasOnPostUpdate","RSJ","__webpack_exports__hasOnPreUpdate","Mku","__webpack_exports__hasPostDraw","h90","__webpack_exports__hasPreDraw","rms","__webpack_exports__has_initialize","ErP","__webpack_exports__has_postupdate","aVg","__webpack_exports__has_preupdate","lPc","__webpack_exports__isAddedComponent","Z8E","__webpack_exports__isAddedSystemEntity","_N2","__webpack_exports__isRemoveSystemEntity","yFn","__webpack_exports__isRemovedComponent","lNv","__webpack_exports__isScreenElement","cu9","__webpack_exports__maxMessages","MZQ","__webpack_exports__obsolete","FUM","__webpack_exports__pixelSnapEpsilon","BxR","__webpack_exports__randomInRange","vdf","__webpack_exports__randomIntInRange","iaL","__webpack_exports__range","w6H","__webpack_exports__resetObsoleteCounter","Q4c","__webpack_exports__sign","Xxe","__webpack_exports__toDegrees","Uxb","__webpack_exports__toRadians","Yr5","__webpack_exports__vec","Bhw","__webpack_exports__webgl","yOA","Baddie","groupByName","baddieSpriteSheet","__TESTING","onPostCollision","Bot","Resources","gotEm","onGround","jumped","hurt","hurtTime","hurtleft","botSpriteSheet","hurtright","idle","hit","Input","jump","Floor","blockSprite","Level","baddie","baddie2","npc","NPC","otherFloor","botRedSpriteSheet","npcSprite","botFile","botRedFile","baddieFile","blockFile","npcFile","jumpSound","hitSound","gotEmSound","bot","botRed","__webpack_require__","scriptUrl","importScripts","currentScript","scripts","getElementsByTagName"],"sourceRoot":""}