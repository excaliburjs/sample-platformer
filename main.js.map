{"version":3,"file":"main.js","mappings":"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M,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,GAAM,IAAM,GACZ,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,GAAM,IAAM,GACZ,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,EACb,IAAO,IAAM,EACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,GACb,IAAO,IAAM,EACb,IAAO,IAAM,EACb,IAAO,IAAM,EACb,IAAO,IAAM,EACb,IAAO,IAAM,EACb,IAAO,IAA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","sources":["webpack://sample-platformer/./node_modules/excalibur/build/esm/excalibur.js","webpack://sample-platformer/./res/baddie.png","webpack://sample-platformer/./res/block.png","webpack://sample-platformer/./res/excalibot-red.png","webpack://sample-platformer/./res/excalibot.png","webpack://sample-platformer/./res/gottem.wav","webpack://sample-platformer/./res/hurt.wav","webpack://sample-platformer/./res/jump.wav","webpack://sample-platformer/./res/npc.png","webpack://sample-platformer/./src/baddie.ts","webpack://sample-platformer/./src/bot.ts","webpack://sample-platformer/./src/floor.ts","webpack://sample-platformer/./src/level.ts","webpack://sample-platformer/./src/main.ts","webpack://sample-platformer/./src/npc.ts","webpack://sample-platformer/./src/resources.ts","webpack://sample-platformer/webpack/bootstrap","webpack://sample-platformer/webpack/runtime/define property getters","webpack://sample-platformer/webpack/runtime/global","webpack://sample-platformer/webpack/runtime/hasOwnProperty shorthand","webpack://sample-platformer/webpack/runtime/make namespace object","webpack://sample-platformer/webpack/runtime/publicPath","webpack://sample-platformer/webpack/startup"],"sourcesContent":["/*!\n * excalibur - 0.25.1 - 2021-11-5\n * https://github.com/excaliburjs/Excalibur\n * Copyright (c) 2021 Excalibur.js <https://github.com/excaliburjs/Excalibur/graphs/contributors>\n * Licensed BSD-2-Clause\n * @preserve\n */\n/******/ var __webpack_modules__ = ({\n\n/***/ 4662:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n__webpack_require__(3430);\nvar entryUnbind = __webpack_require__(8791);\n\nmodule.exports = entryUnbind('Array', 'sort');\n\n\n/***/ }),\n\n/***/ 8343:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n__webpack_require__(4769);\nvar path = __webpack_require__(9276);\n\nmodule.exports = path.Object.keys;\n\n\n/***/ }),\n\n/***/ 7111:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar isCallable = __webpack_require__(6733);\nvar tryToString = __webpack_require__(9821);\n\n// `Assert: IsCallable(argument) is true`\nmodule.exports = function (argument) {\n  if (isCallable(argument)) return argument;\n  throw TypeError(tryToString(argument) + ' is not a function');\n};\n\n\n/***/ }),\n\n/***/ 1176:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar isObject = __webpack_require__(5052);\n\n// `Assert: Type(argument) is Object`\nmodule.exports = function (argument) {\n  if (isObject(argument)) return argument;\n  throw TypeError(String(argument) + ' is not an object');\n};\n\n\n/***/ }),\n\n/***/ 9540:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar toIndexedObject = __webpack_require__(905);\nvar toLength = __webpack_require__(4237);\nvar toAbsoluteIndex = __webpack_require__(3231);\n\n// `Array.prototype.{ indexOf, includes }` methods implementation\nvar createMethod = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIndexedObject($this);\n    var length = toLength(O.length);\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare -- NaN check\n    if (IS_INCLUDES && el != el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare -- NaN check\n      if (value != value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) {\n      if ((IS_INCLUDES || index in O) && O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.includes` method\n  // https://tc39.es/ecma262/#sec-array.prototype.includes\n  includes: createMethod(true),\n  // `Array.prototype.indexOf` method\n  // https://tc39.es/ecma262/#sec-array.prototype.indexof\n  indexOf: createMethod(false)\n};\n\n\n/***/ }),\n\n/***/ 6038:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar fails = __webpack_require__(4229);\n\nmodule.exports = function (METHOD_NAME, argument) {\n  var method = [][METHOD_NAME];\n  return !!method && fails(function () {\n    // eslint-disable-next-line no-useless-call,no-throw-literal -- required for testing\n    method.call(null, argument || function () { throw 1; }, 1);\n  });\n};\n\n\n/***/ }),\n\n/***/ 3867:\n/***/ ((module) => {\n\n// TODO: use something more complex like timsort?\nvar floor = Math.floor;\n\nvar mergeSort = function (array, comparefn) {\n  var length = array.length;\n  var middle = floor(length / 2);\n  return length < 8 ? insertionSort(array, comparefn) : merge(\n    mergeSort(array.slice(0, middle), comparefn),\n    mergeSort(array.slice(middle), comparefn),\n    comparefn\n  );\n};\n\nvar insertionSort = function (array, comparefn) {\n  var length = array.length;\n  var i = 1;\n  var element, j;\n\n  while (i < length) {\n    j = i;\n    element = array[i];\n    while (j && comparefn(array[j - 1], element) > 0) {\n      array[j] = array[--j];\n    }\n    if (j !== i++) array[j] = element;\n  } return array;\n};\n\nvar merge = function (left, right, comparefn) {\n  var llength = left.length;\n  var rlength = right.length;\n  var lindex = 0;\n  var rindex = 0;\n  var result = [];\n\n  while (lindex < llength || rindex < rlength) {\n    if (lindex < llength && rindex < rlength) {\n      result.push(comparefn(left[lindex], right[rindex]) <= 0 ? left[lindex++] : right[rindex++]);\n    } else {\n      result.push(lindex < llength ? left[lindex++] : right[rindex++]);\n    }\n  } return result;\n};\n\nmodule.exports = mergeSort;\n\n\n/***/ }),\n\n/***/ 7079:\n/***/ ((module) => {\n\nvar toString = {}.toString;\n\nmodule.exports = function (it) {\n  return toString.call(it).slice(8, -1);\n};\n\n\n/***/ }),\n\n/***/ 1589:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar TO_STRING_TAG_SUPPORT = __webpack_require__(1601);\nvar isCallable = __webpack_require__(6733);\nvar classofRaw = __webpack_require__(7079);\nvar wellKnownSymbol = __webpack_require__(95);\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\n// ES3 wrong here\nvar CORRECT_ARGUMENTS = classofRaw(function () { return arguments; }()) == 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (error) { /* empty */ }\n};\n\n// getting tag from ES6+ `Object.prototype.toString`\nmodule.exports = TO_STRING_TAG_SUPPORT ? classofRaw : function (it) {\n  var O, tag, result;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (tag = tryGet(O = Object(it), TO_STRING_TAG)) == 'string' ? tag\n    // builtinTag case\n    : CORRECT_ARGUMENTS ? classofRaw(O)\n    // ES3 arguments fallback\n    : (result = classofRaw(O)) == 'Object' && isCallable(O.callee) ? 'Arguments' : result;\n};\n\n\n/***/ }),\n\n/***/ 7081:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar has = __webpack_require__(816);\nvar ownKeys = __webpack_require__(4826);\nvar getOwnPropertyDescriptorModule = __webpack_require__(7933);\nvar definePropertyModule = __webpack_require__(1787);\n\nmodule.exports = function (target, source) {\n  var keys = ownKeys(source);\n  var defineProperty = definePropertyModule.f;\n  var getOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    if (!has(target, key)) defineProperty(target, key, getOwnPropertyDescriptor(source, key));\n  }\n};\n\n\n/***/ }),\n\n/***/ 5762:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar DESCRIPTORS = __webpack_require__(7400);\nvar definePropertyModule = __webpack_require__(1787);\nvar createPropertyDescriptor = __webpack_require__(5358);\n\nmodule.exports = DESCRIPTORS ? function (object, key, value) {\n  return definePropertyModule.f(object, key, createPropertyDescriptor(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n\n\n/***/ }),\n\n/***/ 5358:\n/***/ ((module) => {\n\nmodule.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n\n\n/***/ }),\n\n/***/ 7400:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar fails = __webpack_require__(4229);\n\n// Detect IE8's incomplete defineProperty implementation\nmodule.exports = !fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- required for testing\n  return Object.defineProperty({}, 1, { get: function () { return 7; } })[1] != 7;\n});\n\n\n/***/ }),\n\n/***/ 2635:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar isObject = __webpack_require__(5052);\n\nvar document = global.document;\n// typeof document.createElement is 'object' in old IE\nvar EXISTS = isObject(document) && isObject(document.createElement);\n\nmodule.exports = function (it) {\n  return EXISTS ? document.createElement(it) : {};\n};\n\n\n/***/ }),\n\n/***/ 2671:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar userAgent = __webpack_require__(598);\n\nvar firefox = userAgent.match(/firefox\\/(\\d+)/i);\n\nmodule.exports = !!firefox && +firefox[1];\n\n\n/***/ }),\n\n/***/ 8506:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar UA = __webpack_require__(598);\n\nmodule.exports = /MSIE|Trident/.test(UA);\n\n\n/***/ }),\n\n/***/ 598:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar getBuiltIn = __webpack_require__(1333);\n\nmodule.exports = getBuiltIn('navigator', 'userAgent') || '';\n\n\n/***/ }),\n\n/***/ 6358:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar userAgent = __webpack_require__(598);\n\nvar process = global.process;\nvar Deno = global.Deno;\nvar versions = process && process.versions || Deno && Deno.version;\nvar v8 = versions && versions.v8;\nvar match, version;\n\nif (v8) {\n  match = v8.split('.');\n  version = match[0] < 4 ? 1 : match[0] + match[1];\n} else if (userAgent) {\n  match = userAgent.match(/Edge\\/(\\d+)/);\n  if (!match || match[1] >= 74) {\n    match = userAgent.match(/Chrome\\/(\\d+)/);\n    if (match) version = match[1];\n  }\n}\n\nmodule.exports = version && +version;\n\n\n/***/ }),\n\n/***/ 9811:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar userAgent = __webpack_require__(598);\n\nvar webkit = userAgent.match(/AppleWebKit\\/(\\d+)\\./);\n\nmodule.exports = !!webkit && +webkit[1];\n\n\n/***/ }),\n\n/***/ 8791:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar bind = __webpack_require__(7636);\n\nvar call = Function.call;\n\nmodule.exports = function (CONSTRUCTOR, METHOD, length) {\n  return bind(call, global[CONSTRUCTOR].prototype[METHOD], length);\n};\n\n\n/***/ }),\n\n/***/ 3837:\n/***/ ((module) => {\n\n// IE8- don't enum bug keys\nmodule.exports = [\n  'constructor',\n  'hasOwnProperty',\n  'isPrototypeOf',\n  'propertyIsEnumerable',\n  'toLocaleString',\n  'toString',\n  'valueOf'\n];\n\n\n/***/ }),\n\n/***/ 3103:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar getOwnPropertyDescriptor = __webpack_require__(7933).f;\nvar createNonEnumerableProperty = __webpack_require__(5762);\nvar redefine = __webpack_require__(7487);\nvar setGlobal = __webpack_require__(2079);\nvar copyConstructorProperties = __webpack_require__(7081);\nvar isForced = __webpack_require__(6541);\n\n/*\n  options.target      - name of the target object\n  options.global      - target is the global object\n  options.stat        - export as static methods of target\n  options.proto       - export as prototype methods of target\n  options.real        - real prototype method for the `pure` version\n  options.forced      - export even if the native feature is available\n  options.bind        - bind methods to the target, required for the `pure` version\n  options.wrap        - wrap constructors to preventing global pollution, required for the `pure` version\n  options.unsafe      - use the simple assignment of property instead of delete + defineProperty\n  options.sham        - add a flag to not completely full polyfills\n  options.enumerable  - export as enumerable property\n  options.noTargetGet - prevent calling a getter on target\n  options.name        - the .name of the function if it does not match the key\n*/\nmodule.exports = function (options, source) {\n  var TARGET = options.target;\n  var GLOBAL = options.global;\n  var STATIC = options.stat;\n  var FORCED, target, key, targetProperty, sourceProperty, descriptor;\n  if (GLOBAL) {\n    target = global;\n  } else if (STATIC) {\n    target = global[TARGET] || setGlobal(TARGET, {});\n  } else {\n    target = (global[TARGET] || {}).prototype;\n  }\n  if (target) for (key in source) {\n    sourceProperty = source[key];\n    if (options.noTargetGet) {\n      descriptor = getOwnPropertyDescriptor(target, key);\n      targetProperty = descriptor && descriptor.value;\n    } else targetProperty = target[key];\n    FORCED = isForced(GLOBAL ? key : TARGET + (STATIC ? '.' : '#') + key, options.forced);\n    // contained in target\n    if (!FORCED && targetProperty !== undefined) {\n      if (typeof sourceProperty === typeof targetProperty) continue;\n      copyConstructorProperties(sourceProperty, targetProperty);\n    }\n    // add a flag to not completely full polyfills\n    if (options.sham || (targetProperty && targetProperty.sham)) {\n      createNonEnumerableProperty(sourceProperty, 'sham', true);\n    }\n    // extend global\n    redefine(target, key, sourceProperty, options);\n  }\n};\n\n\n/***/ }),\n\n/***/ 4229:\n/***/ ((module) => {\n\nmodule.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (error) {\n    return true;\n  }\n};\n\n\n/***/ }),\n\n/***/ 7636:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar aCallable = __webpack_require__(7111);\n\n// optional / simple context binding\nmodule.exports = function (fn, that, length) {\n  aCallable(fn);\n  if (that === undefined) return fn;\n  switch (length) {\n    case 0: return function () {\n      return fn.call(that);\n    };\n    case 1: return function (a) {\n      return fn.call(that, a);\n    };\n    case 2: return function (a, b) {\n      return fn.call(that, a, b);\n    };\n    case 3: return function (a, b, c) {\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function (/* ...args */) {\n    return fn.apply(that, arguments);\n  };\n};\n\n\n/***/ }),\n\n/***/ 1805:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar DESCRIPTORS = __webpack_require__(7400);\nvar has = __webpack_require__(816);\n\nvar FunctionPrototype = Function.prototype;\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar getDescriptor = DESCRIPTORS && Object.getOwnPropertyDescriptor;\n\nvar EXISTS = has(FunctionPrototype, 'name');\n// additional protection from minified / mangled / dropped function names\nvar PROPER = EXISTS && (function something() { /* empty */ }).name === 'something';\nvar CONFIGURABLE = EXISTS && (!DESCRIPTORS || (DESCRIPTORS && getDescriptor(FunctionPrototype, 'name').configurable));\n\nmodule.exports = {\n  EXISTS: EXISTS,\n  PROPER: PROPER,\n  CONFIGURABLE: CONFIGURABLE\n};\n\n\n/***/ }),\n\n/***/ 1333:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar isCallable = __webpack_require__(6733);\n\nvar aFunction = function (argument) {\n  return isCallable(argument) ? argument : undefined;\n};\n\nmodule.exports = function (namespace, method) {\n  return arguments.length < 2 ? aFunction(global[namespace]) : global[namespace] && global[namespace][method];\n};\n\n\n/***/ }),\n\n/***/ 5300:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar aCallable = __webpack_require__(7111);\n\n// `GetMethod` abstract operation\n// https://tc39.es/ecma262/#sec-getmethod\nmodule.exports = function (V, P) {\n  var func = V[P];\n  return func == null ? undefined : aCallable(func);\n};\n\n\n/***/ }),\n\n/***/ 9859:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar check = function (it) {\n  return it && it.Math == Math && it;\n};\n\n// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nmodule.exports =\n  // eslint-disable-next-line es/no-global-this -- safe\n  check(typeof globalThis == 'object' && globalThis) ||\n  check(typeof window == 'object' && window) ||\n  // eslint-disable-next-line no-restricted-globals -- safe\n  check(typeof self == 'object' && self) ||\n  check(typeof __webpack_require__.g == 'object' && __webpack_require__.g) ||\n  // eslint-disable-next-line no-new-func -- fallback\n  (function () { return this; })() || Function('return this')();\n\n\n/***/ }),\n\n/***/ 816:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar toObject = __webpack_require__(2991);\n\nvar hasOwnProperty = {}.hasOwnProperty;\n\nmodule.exports = Object.hasOwn || function hasOwn(it, key) {\n  return hasOwnProperty.call(toObject(it), key);\n};\n\n\n/***/ }),\n\n/***/ 5977:\n/***/ ((module) => {\n\nmodule.exports = {};\n\n\n/***/ }),\n\n/***/ 4394:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar DESCRIPTORS = __webpack_require__(7400);\nvar fails = __webpack_require__(4229);\nvar createElement = __webpack_require__(2635);\n\n// Thank's IE8 for his funny defineProperty\nmodule.exports = !DESCRIPTORS && !fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- requied for testing\n  return Object.defineProperty(createElement('div'), 'a', {\n    get: function () { return 7; }\n  }).a != 7;\n});\n\n\n/***/ }),\n\n/***/ 9337:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar fails = __webpack_require__(4229);\nvar classof = __webpack_require__(7079);\n\nvar split = ''.split;\n\n// fallback for non-array-like ES3 and non-enumerable old V8 strings\nmodule.exports = fails(function () {\n  // throws an error in rhino, see https://github.com/mozilla/rhino/issues/346\n  // eslint-disable-next-line no-prototype-builtins -- safe\n  return !Object('z').propertyIsEnumerable(0);\n}) ? function (it) {\n  return classof(it) == 'String' ? split.call(it, '') : Object(it);\n} : Object;\n\n\n/***/ }),\n\n/***/ 8511:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar isCallable = __webpack_require__(6733);\nvar store = __webpack_require__(5353);\n\nvar functionToString = Function.toString;\n\n// this helper broken in `core-js@3.4.1-3.4.4`, so we can't use `shared` helper\nif (!isCallable(store.inspectSource)) {\n  store.inspectSource = function (it) {\n    return functionToString.call(it);\n  };\n}\n\nmodule.exports = store.inspectSource;\n\n\n/***/ }),\n\n/***/ 6407:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar NATIVE_WEAK_MAP = __webpack_require__(8694);\nvar global = __webpack_require__(9859);\nvar isObject = __webpack_require__(5052);\nvar createNonEnumerableProperty = __webpack_require__(5762);\nvar objectHas = __webpack_require__(816);\nvar shared = __webpack_require__(5353);\nvar sharedKey = __webpack_require__(4399);\nvar hiddenKeys = __webpack_require__(5977);\n\nvar OBJECT_ALREADY_INITIALIZED = 'Object already initialized';\nvar WeakMap = global.WeakMap;\nvar set, get, has;\n\nvar enforce = function (it) {\n  return has(it) ? get(it) : set(it, {});\n};\n\nvar getterFor = function (TYPE) {\n  return function (it) {\n    var state;\n    if (!isObject(it) || (state = get(it)).type !== TYPE) {\n      throw TypeError('Incompatible receiver, ' + TYPE + ' required');\n    } return state;\n  };\n};\n\nif (NATIVE_WEAK_MAP || shared.state) {\n  var store = shared.state || (shared.state = new WeakMap());\n  var wmget = store.get;\n  var wmhas = store.has;\n  var wmset = store.set;\n  set = function (it, metadata) {\n    if (wmhas.call(store, it)) throw new TypeError(OBJECT_ALREADY_INITIALIZED);\n    metadata.facade = it;\n    wmset.call(store, it, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return wmget.call(store, it) || {};\n  };\n  has = function (it) {\n    return wmhas.call(store, it);\n  };\n} else {\n  var STATE = sharedKey('state');\n  hiddenKeys[STATE] = true;\n  set = function (it, metadata) {\n    if (objectHas(it, STATE)) throw new TypeError(OBJECT_ALREADY_INITIALIZED);\n    metadata.facade = it;\n    createNonEnumerableProperty(it, STATE, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return objectHas(it, STATE) ? it[STATE] : {};\n  };\n  has = function (it) {\n    return objectHas(it, STATE);\n  };\n}\n\nmodule.exports = {\n  set: set,\n  get: get,\n  has: has,\n  enforce: enforce,\n  getterFor: getterFor\n};\n\n\n/***/ }),\n\n/***/ 6733:\n/***/ ((module) => {\n\n// `IsCallable` abstract operation\n// https://tc39.es/ecma262/#sec-iscallable\nmodule.exports = function (argument) {\n  return typeof argument === 'function';\n};\n\n\n/***/ }),\n\n/***/ 6541:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar fails = __webpack_require__(4229);\nvar isCallable = __webpack_require__(6733);\n\nvar replacement = /#|\\.prototype\\./;\n\nvar isForced = function (feature, detection) {\n  var value = data[normalize(feature)];\n  return value == POLYFILL ? true\n    : value == NATIVE ? false\n    : isCallable(detection) ? fails(detection)\n    : !!detection;\n};\n\nvar normalize = isForced.normalize = function (string) {\n  return String(string).replace(replacement, '.').toLowerCase();\n};\n\nvar data = isForced.data = {};\nvar NATIVE = isForced.NATIVE = 'N';\nvar POLYFILL = isForced.POLYFILL = 'P';\n\nmodule.exports = isForced;\n\n\n/***/ }),\n\n/***/ 5052:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar isCallable = __webpack_require__(6733);\n\nmodule.exports = function (it) {\n  return typeof it === 'object' ? it !== null : isCallable(it);\n};\n\n\n/***/ }),\n\n/***/ 4231:\n/***/ ((module) => {\n\nmodule.exports = false;\n\n\n/***/ }),\n\n/***/ 9395:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar isCallable = __webpack_require__(6733);\nvar getBuiltIn = __webpack_require__(1333);\nvar USE_SYMBOL_AS_UID = __webpack_require__(6969);\n\nmodule.exports = USE_SYMBOL_AS_UID ? function (it) {\n  return typeof it == 'symbol';\n} : function (it) {\n  var $Symbol = getBuiltIn('Symbol');\n  return isCallable($Symbol) && Object(it) instanceof $Symbol;\n};\n\n\n/***/ }),\n\n/***/ 3839:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n/* eslint-disable es/no-symbol -- required for testing */\nvar V8_VERSION = __webpack_require__(6358);\nvar fails = __webpack_require__(4229);\n\n// eslint-disable-next-line es/no-object-getownpropertysymbols -- required for testing\nmodule.exports = !!Object.getOwnPropertySymbols && !fails(function () {\n  var symbol = Symbol();\n  // Chrome 38 Symbol has incorrect toString conversion\n  // `get-own-property-symbols` polyfill symbols converted to object are not Symbol instances\n  return !String(symbol) || !(Object(symbol) instanceof Symbol) ||\n    // Chrome 38-40 symbols are not inherited from DOM collections prototypes to instances\n    !Symbol.sham && V8_VERSION && V8_VERSION < 41;\n});\n\n\n/***/ }),\n\n/***/ 8694:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar isCallable = __webpack_require__(6733);\nvar inspectSource = __webpack_require__(8511);\n\nvar WeakMap = global.WeakMap;\n\nmodule.exports = isCallable(WeakMap) && /native code/.test(inspectSource(WeakMap));\n\n\n/***/ }),\n\n/***/ 1787:\n/***/ ((__unused_webpack_module, exports, __webpack_require__) => {\n\nvar DESCRIPTORS = __webpack_require__(7400);\nvar IE8_DOM_DEFINE = __webpack_require__(4394);\nvar anObject = __webpack_require__(1176);\nvar toPropertyKey = __webpack_require__(9310);\n\n// eslint-disable-next-line es/no-object-defineproperty -- safe\nvar $defineProperty = Object.defineProperty;\n\n// `Object.defineProperty` method\n// https://tc39.es/ecma262/#sec-object.defineproperty\nexports.f = DESCRIPTORS ? $defineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPropertyKey(P);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return $defineProperty(O, P, Attributes);\n  } catch (error) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n\n\n/***/ }),\n\n/***/ 7933:\n/***/ ((__unused_webpack_module, exports, __webpack_require__) => {\n\nvar DESCRIPTORS = __webpack_require__(7400);\nvar propertyIsEnumerableModule = __webpack_require__(9195);\nvar createPropertyDescriptor = __webpack_require__(5358);\nvar toIndexedObject = __webpack_require__(905);\nvar toPropertyKey = __webpack_require__(9310);\nvar has = __webpack_require__(816);\nvar IE8_DOM_DEFINE = __webpack_require__(4394);\n\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar $getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// `Object.getOwnPropertyDescriptor` method\n// https://tc39.es/ecma262/#sec-object.getownpropertydescriptor\nexports.f = DESCRIPTORS ? $getOwnPropertyDescriptor : function getOwnPropertyDescriptor(O, P) {\n  O = toIndexedObject(O);\n  P = toPropertyKey(P);\n  if (IE8_DOM_DEFINE) try {\n    return $getOwnPropertyDescriptor(O, P);\n  } catch (error) { /* empty */ }\n  if (has(O, P)) return createPropertyDescriptor(!propertyIsEnumerableModule.f.call(O, P), O[P]);\n};\n\n\n/***/ }),\n\n/***/ 8151:\n/***/ ((__unused_webpack_module, exports, __webpack_require__) => {\n\nvar internalObjectKeys = __webpack_require__(140);\nvar enumBugKeys = __webpack_require__(3837);\n\nvar hiddenKeys = enumBugKeys.concat('length', 'prototype');\n\n// `Object.getOwnPropertyNames` method\n// https://tc39.es/ecma262/#sec-object.getownpropertynames\n// eslint-disable-next-line es/no-object-getownpropertynames -- safe\nexports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {\n  return internalObjectKeys(O, hiddenKeys);\n};\n\n\n/***/ }),\n\n/***/ 894:\n/***/ ((__unused_webpack_module, exports) => {\n\n// eslint-disable-next-line es/no-object-getownpropertysymbols -- safe\nexports.f = Object.getOwnPropertySymbols;\n\n\n/***/ }),\n\n/***/ 140:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar has = __webpack_require__(816);\nvar toIndexedObject = __webpack_require__(905);\nvar indexOf = __webpack_require__(9540).indexOf;\nvar hiddenKeys = __webpack_require__(5977);\n\nmodule.exports = function (object, names) {\n  var O = toIndexedObject(object);\n  var i = 0;\n  var result = [];\n  var key;\n  for (key in O) !has(hiddenKeys, key) && has(O, key) && result.push(key);\n  // Don't enum bug & hidden keys\n  while (names.length > i) if (has(O, key = names[i++])) {\n    ~indexOf(result, key) || result.push(key);\n  }\n  return result;\n};\n\n\n/***/ }),\n\n/***/ 5632:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar internalObjectKeys = __webpack_require__(140);\nvar enumBugKeys = __webpack_require__(3837);\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n// eslint-disable-next-line es/no-object-keys -- safe\nmodule.exports = Object.keys || function keys(O) {\n  return internalObjectKeys(O, enumBugKeys);\n};\n\n\n/***/ }),\n\n/***/ 9195:\n/***/ ((__unused_webpack_module, exports) => {\n\n\nvar $propertyIsEnumerable = {}.propertyIsEnumerable;\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// Nashorn ~ JDK8 bug\nvar NASHORN_BUG = getOwnPropertyDescriptor && !$propertyIsEnumerable.call({ 1: 2 }, 1);\n\n// `Object.prototype.propertyIsEnumerable` method implementation\n// https://tc39.es/ecma262/#sec-object.prototype.propertyisenumerable\nexports.f = NASHORN_BUG ? function propertyIsEnumerable(V) {\n  var descriptor = getOwnPropertyDescriptor(this, V);\n  return !!descriptor && descriptor.enumerable;\n} : $propertyIsEnumerable;\n\n\n/***/ }),\n\n/***/ 2914:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar isCallable = __webpack_require__(6733);\nvar isObject = __webpack_require__(5052);\n\n// `OrdinaryToPrimitive` abstract operation\n// https://tc39.es/ecma262/#sec-ordinarytoprimitive\nmodule.exports = function (input, pref) {\n  var fn, val;\n  if (pref === 'string' && isCallable(fn = input.toString) && !isObject(val = fn.call(input))) return val;\n  if (isCallable(fn = input.valueOf) && !isObject(val = fn.call(input))) return val;\n  if (pref !== 'string' && isCallable(fn = input.toString) && !isObject(val = fn.call(input))) return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n\n\n/***/ }),\n\n/***/ 4826:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar getBuiltIn = __webpack_require__(1333);\nvar getOwnPropertyNamesModule = __webpack_require__(8151);\nvar getOwnPropertySymbolsModule = __webpack_require__(894);\nvar anObject = __webpack_require__(1176);\n\n// all object keys, includes non-enumerable and symbols\nmodule.exports = getBuiltIn('Reflect', 'ownKeys') || function ownKeys(it) {\n  var keys = getOwnPropertyNamesModule.f(anObject(it));\n  var getOwnPropertySymbols = getOwnPropertySymbolsModule.f;\n  return getOwnPropertySymbols ? keys.concat(getOwnPropertySymbols(it)) : keys;\n};\n\n\n/***/ }),\n\n/***/ 9276:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\n\nmodule.exports = global;\n\n\n/***/ }),\n\n/***/ 7487:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar isCallable = __webpack_require__(6733);\nvar has = __webpack_require__(816);\nvar createNonEnumerableProperty = __webpack_require__(5762);\nvar setGlobal = __webpack_require__(2079);\nvar inspectSource = __webpack_require__(8511);\nvar InternalStateModule = __webpack_require__(6407);\nvar CONFIGURABLE_FUNCTION_NAME = __webpack_require__(1805).CONFIGURABLE;\n\nvar getInternalState = InternalStateModule.get;\nvar enforceInternalState = InternalStateModule.enforce;\nvar TEMPLATE = String(String).split('String');\n\n(module.exports = function (O, key, value, options) {\n  var unsafe = options ? !!options.unsafe : false;\n  var simple = options ? !!options.enumerable : false;\n  var noTargetGet = options ? !!options.noTargetGet : false;\n  var name = options && options.name !== undefined ? options.name : key;\n  var state;\n  if (isCallable(value)) {\n    if (String(name).slice(0, 7) === 'Symbol(') {\n      name = '[' + String(name).replace(/^Symbol\\(([^)]*)\\)/, '$1') + ']';\n    }\n    if (!has(value, 'name') || (CONFIGURABLE_FUNCTION_NAME && value.name !== name)) {\n      createNonEnumerableProperty(value, 'name', name);\n    }\n    state = enforceInternalState(value);\n    if (!state.source) {\n      state.source = TEMPLATE.join(typeof name == 'string' ? name : '');\n    }\n  }\n  if (O === global) {\n    if (simple) O[key] = value;\n    else setGlobal(key, value);\n    return;\n  } else if (!unsafe) {\n    delete O[key];\n  } else if (!noTargetGet && O[key]) {\n    simple = true;\n  }\n  if (simple) O[key] = value;\n  else createNonEnumerableProperty(O, key, value);\n// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative\n})(Function.prototype, 'toString', function toString() {\n  return isCallable(this) && getInternalState(this).source || inspectSource(this);\n});\n\n\n/***/ }),\n\n/***/ 8885:\n/***/ ((module) => {\n\n// `RequireObjectCoercible` abstract operation\n// https://tc39.es/ecma262/#sec-requireobjectcoercible\nmodule.exports = function (it) {\n  if (it == undefined) throw TypeError(\"Can't call method on \" + it);\n  return it;\n};\n\n\n/***/ }),\n\n/***/ 2079:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\n\nmodule.exports = function (key, value) {\n  try {\n    // eslint-disable-next-line es/no-object-defineproperty -- safe\n    Object.defineProperty(global, key, { value: value, configurable: true, writable: true });\n  } catch (error) {\n    global[key] = value;\n  } return value;\n};\n\n\n/***/ }),\n\n/***/ 4399:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar shared = __webpack_require__(3036);\nvar uid = __webpack_require__(1441);\n\nvar keys = shared('keys');\n\nmodule.exports = function (key) {\n  return keys[key] || (keys[key] = uid(key));\n};\n\n\n/***/ }),\n\n/***/ 5353:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar setGlobal = __webpack_require__(2079);\n\nvar SHARED = '__core-js_shared__';\nvar store = global[SHARED] || setGlobal(SHARED, {});\n\nmodule.exports = store;\n\n\n/***/ }),\n\n/***/ 3036:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar IS_PURE = __webpack_require__(4231);\nvar store = __webpack_require__(5353);\n\n(module.exports = function (key, value) {\n  return store[key] || (store[key] = value !== undefined ? value : {});\n})('versions', []).push({\n  version: '3.18.1',\n  mode: IS_PURE ? 'pure' : 'global',\n  copyright: '© 2021 Denis Pushkarev (zloirock.ru)'\n});\n\n\n/***/ }),\n\n/***/ 3231:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar toInteger = __webpack_require__(6051);\n\nvar max = Math.max;\nvar min = Math.min;\n\n// Helper for a popular repeating case of the spec:\n// Let integer be ? ToInteger(index).\n// If integer < 0, let result be max((length + integer), 0); else let result be min(integer, length).\nmodule.exports = function (index, length) {\n  var integer = toInteger(index);\n  return integer < 0 ? max(integer + length, 0) : min(integer, length);\n};\n\n\n/***/ }),\n\n/***/ 905:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n// toObject with fallback for non-array-like ES3 strings\nvar IndexedObject = __webpack_require__(9337);\nvar requireObjectCoercible = __webpack_require__(8885);\n\nmodule.exports = function (it) {\n  return IndexedObject(requireObjectCoercible(it));\n};\n\n\n/***/ }),\n\n/***/ 6051:\n/***/ ((module) => {\n\nvar ceil = Math.ceil;\nvar floor = Math.floor;\n\n// `ToInteger` abstract operation\n// https://tc39.es/ecma262/#sec-tointeger\nmodule.exports = function (argument) {\n  return isNaN(argument = +argument) ? 0 : (argument > 0 ? floor : ceil)(argument);\n};\n\n\n/***/ }),\n\n/***/ 4237:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar toInteger = __webpack_require__(6051);\n\nvar min = Math.min;\n\n// `ToLength` abstract operation\n// https://tc39.es/ecma262/#sec-tolength\nmodule.exports = function (argument) {\n  return argument > 0 ? min(toInteger(argument), 0x1FFFFFFFFFFFFF) : 0; // 2 ** 53 - 1 == 9007199254740991\n};\n\n\n/***/ }),\n\n/***/ 2991:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar requireObjectCoercible = __webpack_require__(8885);\n\n// `ToObject` abstract operation\n// https://tc39.es/ecma262/#sec-toobject\nmodule.exports = function (argument) {\n  return Object(requireObjectCoercible(argument));\n};\n\n\n/***/ }),\n\n/***/ 2066:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar isObject = __webpack_require__(5052);\nvar isSymbol = __webpack_require__(9395);\nvar getMethod = __webpack_require__(5300);\nvar ordinaryToPrimitive = __webpack_require__(2914);\nvar wellKnownSymbol = __webpack_require__(95);\n\nvar TO_PRIMITIVE = wellKnownSymbol('toPrimitive');\n\n// `ToPrimitive` abstract operation\n// https://tc39.es/ecma262/#sec-toprimitive\nmodule.exports = function (input, pref) {\n  if (!isObject(input) || isSymbol(input)) return input;\n  var exoticToPrim = getMethod(input, TO_PRIMITIVE);\n  var result;\n  if (exoticToPrim) {\n    if (pref === undefined) pref = 'default';\n    result = exoticToPrim.call(input, pref);\n    if (!isObject(result) || isSymbol(result)) return result;\n    throw TypeError(\"Can't convert object to primitive value\");\n  }\n  if (pref === undefined) pref = 'number';\n  return ordinaryToPrimitive(input, pref);\n};\n\n\n/***/ }),\n\n/***/ 9310:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar toPrimitive = __webpack_require__(2066);\nvar isSymbol = __webpack_require__(9395);\n\n// `ToPropertyKey` abstract operation\n// https://tc39.es/ecma262/#sec-topropertykey\nmodule.exports = function (argument) {\n  var key = toPrimitive(argument, 'string');\n  return isSymbol(key) ? key : String(key);\n};\n\n\n/***/ }),\n\n/***/ 1601:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar wellKnownSymbol = __webpack_require__(95);\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar test = {};\n\ntest[TO_STRING_TAG] = 'z';\n\nmodule.exports = String(test) === '[object z]';\n\n\n/***/ }),\n\n/***/ 3326:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar classof = __webpack_require__(1589);\n\nmodule.exports = function (argument) {\n  if (classof(argument) === 'Symbol') throw TypeError('Cannot convert a Symbol value to a string');\n  return String(argument);\n};\n\n\n/***/ }),\n\n/***/ 9821:\n/***/ ((module) => {\n\nmodule.exports = function (argument) {\n  try {\n    return String(argument);\n  } catch (error) {\n    return 'Object';\n  }\n};\n\n\n/***/ }),\n\n/***/ 1441:\n/***/ ((module) => {\n\nvar id = 0;\nvar postfix = Math.random();\n\nmodule.exports = function (key) {\n  return 'Symbol(' + String(key === undefined ? '' : key) + ')_' + (++id + postfix).toString(36);\n};\n\n\n/***/ }),\n\n/***/ 6969:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n/* eslint-disable es/no-symbol -- required for testing */\nvar NATIVE_SYMBOL = __webpack_require__(3839);\n\nmodule.exports = NATIVE_SYMBOL\n  && !Symbol.sham\n  && typeof Symbol.iterator == 'symbol';\n\n\n/***/ }),\n\n/***/ 95:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\nvar global = __webpack_require__(9859);\nvar shared = __webpack_require__(3036);\nvar has = __webpack_require__(816);\nvar uid = __webpack_require__(1441);\nvar NATIVE_SYMBOL = __webpack_require__(3839);\nvar USE_SYMBOL_AS_UID = __webpack_require__(6969);\n\nvar WellKnownSymbolsStore = shared('wks');\nvar Symbol = global.Symbol;\nvar createWellKnownSymbol = USE_SYMBOL_AS_UID ? Symbol : Symbol && Symbol.withoutSetter || uid;\n\nmodule.exports = function (name) {\n  if (!has(WellKnownSymbolsStore, name) || !(NATIVE_SYMBOL || typeof WellKnownSymbolsStore[name] == 'string')) {\n    if (NATIVE_SYMBOL && has(Symbol, name)) {\n      WellKnownSymbolsStore[name] = Symbol[name];\n    } else {\n      WellKnownSymbolsStore[name] = createWellKnownSymbol('Symbol.' + name);\n    }\n  } return WellKnownSymbolsStore[name];\n};\n\n\n/***/ }),\n\n/***/ 3430:\n/***/ ((__unused_webpack_module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar $ = __webpack_require__(3103);\nvar aCallable = __webpack_require__(7111);\nvar toObject = __webpack_require__(2991);\nvar toLength = __webpack_require__(4237);\nvar toString = __webpack_require__(3326);\nvar fails = __webpack_require__(4229);\nvar internalSort = __webpack_require__(3867);\nvar arrayMethodIsStrict = __webpack_require__(6038);\nvar FF = __webpack_require__(2671);\nvar IE_OR_EDGE = __webpack_require__(8506);\nvar V8 = __webpack_require__(6358);\nvar WEBKIT = __webpack_require__(9811);\n\nvar test = [];\nvar nativeSort = test.sort;\n\n// IE8-\nvar FAILS_ON_UNDEFINED = fails(function () {\n  test.sort(undefined);\n});\n// V8 bug\nvar FAILS_ON_NULL = fails(function () {\n  test.sort(null);\n});\n// Old WebKit\nvar STRICT_METHOD = arrayMethodIsStrict('sort');\n\nvar STABLE_SORT = !fails(function () {\n  // feature detection can be too slow, so check engines versions\n  if (V8) return V8 < 70;\n  if (FF && FF > 3) return;\n  if (IE_OR_EDGE) return true;\n  if (WEBKIT) return WEBKIT < 603;\n\n  var result = '';\n  var code, chr, value, index;\n\n  // generate an array with more 512 elements (Chakra and old V8 fails only in this case)\n  for (code = 65; code < 76; code++) {\n    chr = String.fromCharCode(code);\n\n    switch (code) {\n      case 66: case 69: case 70: case 72: value = 3; break;\n      case 68: case 71: value = 4; break;\n      default: value = 2;\n    }\n\n    for (index = 0; index < 47; index++) {\n      test.push({ k: chr + index, v: value });\n    }\n  }\n\n  test.sort(function (a, b) { return b.v - a.v; });\n\n  for (index = 0; index < test.length; index++) {\n    chr = test[index].k.charAt(0);\n    if (result.charAt(result.length - 1) !== chr) result += chr;\n  }\n\n  return result !== 'DGBEFHACIJK';\n});\n\nvar FORCED = FAILS_ON_UNDEFINED || !FAILS_ON_NULL || !STRICT_METHOD || !STABLE_SORT;\n\nvar getSortCompare = function (comparefn) {\n  return function (x, y) {\n    if (y === undefined) return -1;\n    if (x === undefined) return 1;\n    if (comparefn !== undefined) return +comparefn(x, y) || 0;\n    return toString(x) > toString(y) ? 1 : -1;\n  };\n};\n\n// `Array.prototype.sort` method\n// https://tc39.es/ecma262/#sec-array.prototype.sort\n$({ target: 'Array', proto: true, forced: FORCED }, {\n  sort: function sort(comparefn) {\n    if (comparefn !== undefined) aCallable(comparefn);\n\n    var array = toObject(this);\n\n    if (STABLE_SORT) return comparefn === undefined ? nativeSort.call(array) : nativeSort.call(array, comparefn);\n\n    var items = [];\n    var arrayLength = toLength(array.length);\n    var itemsLength, index;\n\n    for (index = 0; index < arrayLength; index++) {\n      if (index in array) items.push(array[index]);\n    }\n\n    items = internalSort(items, getSortCompare(comparefn));\n    itemsLength = items.length;\n    index = 0;\n\n    while (index < itemsLength) array[index] = items[index++];\n    while (index < arrayLength) delete array[index++];\n\n    return array;\n  }\n});\n\n\n/***/ }),\n\n/***/ 4769:\n/***/ ((__unused_webpack_module, __unused_webpack_exports, __webpack_require__) => {\n\nvar $ = __webpack_require__(3103);\nvar toObject = __webpack_require__(2991);\nvar nativeKeys = __webpack_require__(5632);\nvar fails = __webpack_require__(4229);\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeKeys(1); });\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES }, {\n  keys: function keys(it) {\n    return nativeKeys(toObject(it));\n  }\n});\n\n\n/***/ }),\n\n/***/ 1388:\n/***/ ((module, __webpack_exports__, __webpack_require__) => {\n\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"Z\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(272);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(2609);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__);\n// Imports\n\n\nvar ___CSS_LOADER_EXPORT___ = _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default()((_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default()));\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"/* Buttons styles start */\\r\\n\\r\\nbutton#excalibur-play {\\r\\n  display: inline-block;\\r\\n  position: relative;\\r\\n  z-index: 999;\\r\\n  border-radius: 6px;\\r\\n  border: none;\\r\\n  /*border: 3px solid;\\r\\n    border-color: white;\\r\\n    box-shadow: 0 0 10px #ccc;*/\\r\\n  padding: 1rem 1.5rem 1rem 4rem;\\r\\n  margin: 0;\\r\\n  text-decoration: none;\\r\\n  background: #00b233;\\r\\n  color: #ffffff;\\r\\n  font-family: sans-serif;\\r\\n  font-size: 2rem;\\r\\n  white-space: nowrap;\\r\\n  line-height: 1;\\r\\n  cursor: pointer;\\r\\n  text-align: center;\\r\\n  transition: background 250ms ease-in-out, transform 150ms ease;\\r\\n  -webkit-appearance: none;\\r\\n  -moz-appearance: none;\\r\\n\\r\\n  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\\r\\n  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\\r\\n  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\\r\\n  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\\r\\n  animation: excalibur-button-fadein 200ms;\\r\\n}\\r\\n\\r\\n/*\\r\\nbutton#excalibur-play {\\r\\n  display: none;\\r\\n}*/\\r\\n\\r\\nbutton#excalibur-play:after {\\r\\n  position: absolute;\\r\\n  content: '';\\r\\n  border: 8px solid;\\r\\n  border-color: transparent transparent transparent white;\\r\\n  left: 35px;\\r\\n  top: 24px;\\r\\n  width: 0;\\r\\n  height: 0;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:before {\\r\\n  position: absolute;\\r\\n  content: '';\\r\\n  border: 3px solid;\\r\\n  left: 19px;\\r\\n  top: 14px;\\r\\n  border-radius: 20px;\\r\\n  width: 30px;\\r\\n  height: 30px;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:hover,\\r\\nbutton#excalibur-play:focus {\\r\\n  background: #00982c;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:focus {\\r\\n  outline: 1px solid #fff;\\r\\n  outline-offset: -4px;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:active {\\r\\n  transform: scale(0.99);\\r\\n}\\r\\n\\r\\n@keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Firefox < 16 */\\r\\n@-moz-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Safari, Chrome and Opera > 12.1 */\\r\\n@-webkit-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Internet Explorer */\\r\\n@-ms-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Opera < 12.1 */\\r\\n@-o-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./Loader.css\"],\"names\":[],\"mappings\":\"AAAA,yBAAyB;;AAEzB;EACE,qBAAqB;EACrB,kBAAkB;EAClB,YAAY;EACZ,kBAAkB;EAClB,YAAY;EACZ;;+BAE6B;EAC7B,8BAA8B;EAC9B,SAAS;EACT,qBAAqB;EACrB,mBAAmB;EACnB,cAAc;EACd,uBAAuB;EACvB,eAAe;EACf,mBAAmB;EACnB,cAAc;EACd,eAAe;EACf,kBAAkB;EAClB,8DAA8D;EAC9D,wBAAwB;EACxB,qBAAqB;;EAErB,gDAAgD,EAAE,oCAAoC;EACtF,6CAA6C,EAAE,iBAAiB;EAChE,4CAA4C,EAAE,sBAAsB;EACpE,2CAA2C,EAAE,iBAAiB;EAC9D,wCAAwC;AAC1C;;AAEA;;;EAGE;;AAEF;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,uDAAuD;EACvD,UAAU;EACV,SAAS;EACT,QAAQ;EACR,SAAS;AACX;;AAEA;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,UAAU;EACV,SAAS;EACT,mBAAmB;EACnB,WAAW;EACX,YAAY;AACd;;AAEA;;EAEE,mBAAmB;AACrB;;AAEA;EACE,uBAAuB;EACvB,oBAAoB;AACtB;;AAEA;EACE,sBAAsB;AACxB;;AAEA;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,oCAAoC;AACpC;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,sBAAsB;AACtB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF\",\"sourcesContent\":[\"/* Buttons styles start */\\r\\n\\r\\nbutton#excalibur-play {\\r\\n  display: inline-block;\\r\\n  position: relative;\\r\\n  z-index: 999;\\r\\n  border-radius: 6px;\\r\\n  border: none;\\r\\n  /*border: 3px solid;\\r\\n    border-color: white;\\r\\n    box-shadow: 0 0 10px #ccc;*/\\r\\n  padding: 1rem 1.5rem 1rem 4rem;\\r\\n  margin: 0;\\r\\n  text-decoration: none;\\r\\n  background: #00b233;\\r\\n  color: #ffffff;\\r\\n  font-family: sans-serif;\\r\\n  font-size: 2rem;\\r\\n  white-space: nowrap;\\r\\n  line-height: 1;\\r\\n  cursor: pointer;\\r\\n  text-align: center;\\r\\n  transition: background 250ms ease-in-out, transform 150ms ease;\\r\\n  -webkit-appearance: none;\\r\\n  -moz-appearance: none;\\r\\n\\r\\n  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\\r\\n  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\\r\\n  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\\r\\n  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\\r\\n  animation: excalibur-button-fadein 200ms;\\r\\n}\\r\\n\\r\\n/*\\r\\nbutton#excalibur-play {\\r\\n  display: none;\\r\\n}*/\\r\\n\\r\\nbutton#excalibur-play:after {\\r\\n  position: absolute;\\r\\n  content: '';\\r\\n  border: 8px solid;\\r\\n  border-color: transparent transparent transparent white;\\r\\n  left: 35px;\\r\\n  top: 24px;\\r\\n  width: 0;\\r\\n  height: 0;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:before {\\r\\n  position: absolute;\\r\\n  content: '';\\r\\n  border: 3px solid;\\r\\n  left: 19px;\\r\\n  top: 14px;\\r\\n  border-radius: 20px;\\r\\n  width: 30px;\\r\\n  height: 30px;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:hover,\\r\\nbutton#excalibur-play:focus {\\r\\n  background: #00982c;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:focus {\\r\\n  outline: 1px solid #fff;\\r\\n  outline-offset: -4px;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:active {\\r\\n  transform: scale(0.99);\\r\\n}\\r\\n\\r\\n@keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Firefox < 16 */\\r\\n@-moz-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Safari, Chrome and Opera > 12.1 */\\r\\n@-webkit-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Internet Explorer */\\r\\n@-ms-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Opera < 12.1 */\\r\\n@-o-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (___CSS_LOADER_EXPORT___);\n\n\n/***/ }),\n\n/***/ 2609:\n/***/ ((module) => {\n\n\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\nmodule.exports = function (cssWithMappingToString) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = \"\";\n      var needLayer = typeof item[5] !== \"undefined\";\n\n      if (item[4]) {\n        content += \"@supports (\".concat(item[4], \") {\");\n      }\n\n      if (item[2]) {\n        content += \"@media \".concat(item[2], \" {\");\n      }\n\n      if (needLayer) {\n        content += \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\");\n      }\n\n      content += cssWithMappingToString(item);\n\n      if (needLayer) {\n        content += \"}\";\n      }\n\n      if (item[2]) {\n        content += \"}\";\n      }\n\n      if (item[4]) {\n        content += \"}\";\n      }\n\n      return content;\n    }).join(\"\");\n  }; // import a list of modules into the list\n\n\n  list.i = function i(modules, media, dedupe, supports, layer) {\n    if (typeof modules === \"string\") {\n      modules = [[null, modules, undefined]];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var _i = 0; _i < this.length; _i++) {\n        var id = this[_i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i2 = 0; _i2 < modules.length; _i2++) {\n      var item = [].concat(modules[_i2]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        continue;\n      }\n\n      if (typeof layer !== \"undefined\") {\n        if (typeof item[5] === \"undefined\") {\n          item[5] = layer;\n        } else {\n          item[1] = \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\").concat(item[1], \"}\");\n          item[5] = layer;\n        }\n      }\n\n      if (media) {\n        if (!item[2]) {\n          item[2] = media;\n        } else {\n          item[1] = \"@media \".concat(item[2], \" {\").concat(item[1], \"}\");\n          item[2] = media;\n        }\n      }\n\n      if (supports) {\n        if (!item[4]) {\n          item[4] = \"\".concat(supports);\n        } else {\n          item[1] = \"@supports (\".concat(item[4], \") {\").concat(item[1], \"}\");\n          item[4] = supports;\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};\n\n/***/ }),\n\n/***/ 272:\n/***/ ((module) => {\n\n\n\nmodule.exports = function (item) {\n  var content = item[1];\n  var cssMapping = item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (typeof btoa === \"function\") {\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || \"\").concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join(\"\\n\");\n  }\n\n  return [content].join(\"\\n\");\n};\n\n/***/ })\n\n/******/ });\n/************************************************************************/\n/******/ // The module cache\n/******/ var __webpack_module_cache__ = {};\n/******/ \n/******/ // The require function\n/******/ function __webpack_require__(moduleId) {\n/******/ \t// Check if module is in cache\n/******/ \tvar cachedModule = __webpack_module_cache__[moduleId];\n/******/ \tif (cachedModule !== undefined) {\n/******/ \t\treturn cachedModule.exports;\n/******/ \t}\n/******/ \t// Create a new module (and put it into the cache)\n/******/ \tvar module = __webpack_module_cache__[moduleId] = {\n/******/ \t\tid: moduleId,\n/******/ \t\t// no module.loaded needed\n/******/ \t\texports: {}\n/******/ \t};\n/******/ \n/******/ \t// Execute the module function\n/******/ \t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n/******/ \n/******/ \t// Return the exports of the module\n/******/ \treturn module.exports;\n/******/ }\n/******/ \n/************************************************************************/\n/******/ /* webpack/runtime/compat get default export */\n/******/ (() => {\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = (module) => {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\t() => (module['default']) :\n/******/ \t\t\t() => (module);\n/******/ \t\t__webpack_require__.d(getter, { a: getter });\n/******/ \t\treturn getter;\n/******/ \t};\n/******/ })();\n/******/ \n/******/ /* webpack/runtime/define property getters */\n/******/ (() => {\n/******/ \t// define getter functions for harmony exports\n/******/ \t__webpack_require__.d = (exports, definition) => {\n/******/ \t\tfor(var key in definition) {\n/******/ \t\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n/******/ \t\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n/******/ \t\t\t}\n/******/ \t\t}\n/******/ \t};\n/******/ })();\n/******/ \n/******/ /* webpack/runtime/global */\n/******/ (() => {\n/******/ \t__webpack_require__.g = (function() {\n/******/ \t\tif (typeof globalThis === 'object') return globalThis;\n/******/ \t\ttry {\n/******/ \t\t\treturn this || new Function('return this')();\n/******/ \t\t} catch (e) {\n/******/ \t\t\tif (typeof window === 'object') return window;\n/******/ \t\t}\n/******/ \t})();\n/******/ })();\n/******/ \n/******/ /* webpack/runtime/hasOwnProperty shorthand */\n/******/ (() => {\n/******/ \t__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))\n/******/ })();\n/******/ \n/******/ /* webpack/runtime/make namespace object */\n/******/ (() => {\n/******/ \t// define __esModule on exports\n/******/ \t__webpack_require__.r = (exports) => {\n/******/ \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n/******/ \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n/******/ \t\t}\n/******/ \t\tObject.defineProperty(exports, '__esModule', { value: true });\n/******/ \t};\n/******/ })();\n/******/ \n/************************************************************************/\nvar __webpack_exports__ = {};\n// This entry need to be wrapped in an IIFE because it need to be isolated against other modules in the chunk.\n(() => {\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, {\n  \"fWn\": () => (/* reexport */ ActionContext),\n  \"Ia8\": () => (/* reexport */ ActionQueue),\n  \"hLI\": () => (/* reexport */ ActionsComponent),\n  \"yyv\": () => (/* reexport */ ActionsSystem),\n  \"tX5\": () => (/* reexport */ ActivateEvent),\n  \"vtX\": () => (/* reexport */ Actor),\n  \"r7K\": () => (/* reexport */ AddedComponent),\n  \"lCh\": () => (/* reexport */ AddedEntity),\n  \"fwF\": () => (/* reexport */ Animation),\n  \"sce\": () => (/* reexport */ AnimationDirection),\n  \"_c7\": () => (/* reexport */ AnimationStrategy),\n  \"KUs\": () => (/* reexport */ ArcadeSolver),\n  \"Ajp\": () => (/* reexport */ AudioContextFactory),\n  \"RDh\": () => (/* reexport */ Axis),\n  \"_H9\": () => (/* reexport */ BaseAlign),\n  \"Ulf\": () => (/* reexport */ BinaryTreeNode),\n  \"mxs\": () => (/* reexport */ Blink),\n  \"OmD\": () => (/* reexport */ BodyComponent),\n  \"kBf\": () => (/* reexport */ BoundingBox),\n  \"C4F\": () => (/* reexport */ BroadphaseStrategy),\n  \"NQt\": () => (/* reexport */ BrowserComponent),\n  \"JjN\": () => (/* reexport */ BrowserEvents),\n  \"V1s\": () => (/* reexport */ Camera),\n  \"Xz7\": () => (/* reexport */ Canvas),\n  \"bLd\": () => (/* reexport */ Cell),\n  \"Cdc\": () => (/* reexport */ Circle),\n  \"FKn\": () => (/* reexport */ CircleCollider),\n  \"wTW\": () => (/* reexport */ Class),\n  \"ab2\": () => (/* reexport */ ClosestLine),\n  \"GfZ\": () => (/* reexport */ ClosestLineJumpTable),\n  \"YMS\": () => (/* reexport */ Collider),\n  \"oyv\": () => (/* reexport */ ColliderComponent),\n  \"aUb\": () => (/* reexport */ CollisionContact),\n  \"SdD\": () => (/* reexport */ CollisionEndEvent),\n  \"JUv\": () => (/* reexport */ CollisionGroup),\n  \"jEj\": () => (/* reexport */ CollisionGroupManager),\n  \"TFq\": () => (/* reexport */ CollisionJumpTable),\n  \"HDU\": () => (/* reexport */ CollisionPostSolveEvent),\n  \"R_y\": () => (/* reexport */ CollisionPreSolveEvent),\n  \"ydN\": () => (/* reexport */ CollisionResolutionStrategy),\n  \"_N2\": () => (/* reexport */ CollisionSolver),\n  \"t50\": () => (/* reexport */ CollisionStartEvent),\n  \"s$$\": () => (/* reexport */ CollisionSystem),\n  \"v2G\": () => (/* reexport */ CollisionType),\n  \"Ilk\": () => (/* reexport */ Color),\n  \"H_9\": () => (/* reexport */ ColorBlindCorrector),\n  \"s9i\": () => (/* reexport */ ColorBlindFlags),\n  \"ksl\": () => (/* reexport */ ColorBlindness),\n  \"wA2\": () => (/* reexport */ Component),\n  \"R_p\": () => (/* reexport */ CompositeCollider),\n  \"IQ$\": () => (/* reexport */ Configurable),\n  \"I5F\": () => (/* reexport */ ConsoleAppender),\n  \"X8$\": () => (/* reexport */ ContactConstraintPoint),\n  \"FR6\": () => (/* reexport */ ContactEndEvent),\n  \"U8o\": () => (/* reexport */ ContactStartEvent),\n  \"kbG\": () => (/* reexport */ CoordPlane),\n  \"oeJ\": () => (/* reexport */ CullingBox),\n  \"iS_\": () => (/* reexport */ DeactivateEvent),\n  \"cGG\": () => (/* reexport */ Debug),\n  \"skb\": () => (/* reexport */ DebugSystem),\n  \"SLU\": () => (/* reexport */ DebugText),\n  \"RdJ\": () => (/* reexport */ DegreeOfFreedom),\n  \"gU7\": () => (/* reexport */ Detector),\n  \"LSk\": () => (/* reexport */ Die),\n  \"Nmp\": () => (/* reexport */ Direction),\n  \"d1Y\": () => (/* reexport */ DisplayMode),\n  \"xrL\": () => (/* reexport */ DynamicTree),\n  \"sRW\": () => (/* reexport */ DynamicTreeCollisionProcessor),\n  \"cmV\": () => (/* binding */ EX_VERSION),\n  \"N0Q\": () => (/* reexport */ EaseTo),\n  \"q8b\": () => (/* reexport */ EasingFunctions),\n  \"ynB\": () => (/* reexport */ EdgeCollider),\n  \"jT9\": () => (/* reexport */ ElasticToActorStrategy),\n  \"wAz\": () => (/* reexport */ EmitterType),\n  \"D4V\": () => (/* reexport */ Engine),\n  \"N6H\": () => (/* reexport */ EnterTriggerEvent),\n  \"W1A\": () => (/* reexport */ EnterViewPortEvent),\n  \"JHW\": () => (/* reexport */ Entity),\n  \"v2K\": () => (/* reexport */ EntityManager),\n  \"pBf\": () => (/* reexport */ EventDispatcher),\n  \"GMl\": () => (/* reexport */ EventTypes),\n  \"zW2\": () => (/* reexport */ Events_namespaceObject),\n  \"B0K\": () => (/* reexport */ ExResponse),\n  \"Nv7\": () => (/* reexport */ ExcaliburGraphicsContext2DCanvas),\n  \"C_p\": () => (/* reexport */ ExcaliburGraphicsContextWebGL),\n  \"MUA\": () => (/* reexport */ ExitTriggerEvent),\n  \"xqU\": () => (/* reexport */ ExitViewPortEvent),\n  \"peG\": () => (/* reexport */ Experiments),\n  \"pTp\": () => (/* reexport */ Fade),\n  \"vUK\": () => (/* reexport */ Flags),\n  \"j9l\": () => (/* reexport */ Follow),\n  \"Zxw\": () => (/* reexport */ Font),\n  \"Hdx\": () => (/* reexport */ FontStyle),\n  \"Z$d\": () => (/* reexport */ FontUnit),\n  \"o$7\": () => (/* reexport */ FrameStats),\n  \"Zm$\": () => (/* reexport */ GameEvent),\n  \"$QH\": () => (/* reexport */ GameStartEvent),\n  \"i78\": () => (/* reexport */ GameStopEvent),\n  \"h6u\": () => (/* reexport */ GamepadAxisEvent),\n  \"hts\": () => (/* reexport */ GamepadButtonEvent),\n  \"j88\": () => (/* reexport */ GamepadConnectEvent),\n  \"VME\": () => (/* reexport */ GamepadDisconnectEvent),\n  \"nt\": () => (/* reexport */ Gif),\n  \"Ukr\": () => (/* reexport */ GlobalCoordinates),\n  \"zsu\": () => (/* reexport */ Graphic),\n  \"oA6\": () => (/* reexport */ GraphicsComponent),\n  \"TVh\": () => (/* reexport */ GraphicsGroup),\n  \"TwZ\": () => (/* reexport */ GraphicsLayer),\n  \"GTT\": () => (/* reexport */ GraphicsLayers),\n  \"xxj\": () => (/* reexport */ GraphicsSystem),\n  \"XdK\": () => (/* reexport */ HiddenEvent),\n  \"cXo\": () => (/* reexport */ ImageSource),\n  \"Dm5\": () => (/* reexport */ InitializeEvent),\n  \"IIB\": () => (/* reexport */ Input_Index_namespaceObject),\n  \"zI0\": () => (/* reexport */ Integrator),\n  \"SKZ\": () => (/* reexport */ KillEvent),\n  \"__J\": () => (/* reexport */ Label_Label),\n  \"Dvr\": () => (/* reexport */ Legacy),\n  \"Tf9\": () => (/* reexport */ Drawing_Index_namespaceObject),\n  \"RI$\": () => (/* reexport */ LimitCameraBoundsStrategy),\n  \"x12\": () => (/* reexport */ Line),\n  \"aNw\": () => (/* reexport */ Loader),\n  \"xwn\": () => (/* reexport */ LockCameraToActorAxisStrategy),\n  \"dNK\": () => (/* reexport */ LockCameraToActorStrategy),\n  \"ini\": () => (/* reexport */ LogLevel),\n  \"YdH\": () => (/* reexport */ Logger),\n  \"y3G\": () => (/* reexport */ Matrix),\n  \"l57\": () => (/* reexport */ MatrixLocations),\n  \"xn0\": () => (/* reexport */ MediaEvent),\n  \"t2V\": () => (/* reexport */ Meet),\n  \"ZyS\": () => (/* reexport */ MockedElement),\n  \"uxB\": () => (/* reexport */ MotionComponent),\n  \"cpd\": () => (/* reexport */ MotionSystem),\n  \"fiy\": () => (/* reexport */ MoveBy),\n  \"$XZ\": () => (/* reexport */ MoveTo),\n  \"uqK\": () => (/* reexport */ NativeSoundEvent),\n  \"STE\": () => (/* reexport */ NativeSoundProcessedEvent),\n  \"y$z\": () => (/* reexport */ Observable),\n  \"sOq\": () => (/* reexport */ Pair),\n  \"Sqs\": () => (/* reexport */ ParseGif),\n  \"hpZ\": () => (/* reexport */ Particle),\n  \"Vol\": () => (/* reexport */ ParticleEmitter),\n  \"wIZ\": () => (/* reexport */ Physics),\n  \"cBi\": () => (/* reexport */ PhysicsStats),\n  \"mgq\": () => (/* reexport */ Polygon_Polygon),\n  \"YVA\": () => (/* reexport */ PolygonCollider),\n  \"Kgp\": () => (/* reexport */ Pool),\n  \"HH$\": () => (/* reexport */ PostCollisionEvent),\n  \"M_d\": () => (/* reexport */ PostDebugDrawEvent),\n  \"rgh\": () => (/* reexport */ PostDrawEvent),\n  \"Ra6\": () => (/* reexport */ PostFrameEvent),\n  \"KhR\": () => (/* reexport */ PostKillEvent),\n  \"BS5\": () => (/* reexport */ PostUpdateEvent),\n  \"xhz\": () => (/* reexport */ PreCollisionEvent),\n  \"xOq\": () => (/* reexport */ PreDebugDrawEvent),\n  \"a9j\": () => (/* reexport */ PreDrawEvent),\n  \"bHk\": () => (/* reexport */ PreFrameEvent),\n  \"CgK\": () => (/* reexport */ PreKillEvent),\n  \"cuY\": () => (/* reexport */ PreUpdateEvent),\n  \"kvE\": () => (/* reexport */ Projection),\n  \"JDb\": () => (/* reexport */ Promises_Promise),\n  \"Cbi\": () => (/* reexport */ PromiseState),\n  \"AE_\": () => (/* reexport */ Query),\n  \"ctO\": () => (/* reexport */ QueryManager),\n  \"OLH\": () => (/* reexport */ RadiusAroundActorStrategy),\n  \"kky\": () => (/* reexport */ Random),\n  \"nSF\": () => (/* reexport */ Raster),\n  \"zHn\": () => (/* reexport */ Ray),\n  \"zwx\": () => (/* reexport */ RealisticSolver),\n  \"AeJ\": () => (/* reexport */ Rectangle),\n  \"hLz\": () => (/* reexport */ RemovedComponent),\n  \"D9g\": () => (/* reexport */ RemovedEntity),\n  \"wA\": () => (/* reexport */ Repeat),\n  \"jhr\": () => (/* reexport */ RepeatForever),\n  \"GVs\": () => (/* reexport */ Resolution),\n  \"_zO\": () => (/* reexport */ Resource),\n  \"w6$\": () => (/* reexport */ RotateBy),\n  \"mhV\": () => (/* reexport */ RotateTo),\n  \"MOD\": () => (/* reexport */ RotationType),\n  \"kwd\": () => (/* reexport */ ScaleBy),\n  \"Lmr\": () => (/* reexport */ ScaleTo),\n  \"xsS\": () => (/* reexport */ Scene),\n  \"lLr\": () => (/* reexport */ Screen),\n  \"Z$r\": () => (/* reexport */ ScreenAppender),\n  \"IXb\": () => (/* reexport */ ScreenElement_ScreenElement),\n  \"SMj\": () => (/* reexport */ ScrollPreventionMode),\n  \"bnF\": () => (/* reexport */ Shape),\n  \"MFA\": () => (/* reexport */ Side),\n  \"$XC\": () => (/* reexport */ SortedList),\n  \"$uU\": () => (/* reexport */ Sound),\n  \"jyi\": () => (/* reexport */ Sprite),\n  \"E03\": () => (/* reexport */ SpriteFont_SpriteFont),\n  \"V6q\": () => (/* reexport */ SpriteSheet),\n  \"nVo\": () => (/* reexport */ StrategyContainer),\n  \"F6N\": () => (/* reexport */ Stream),\n  \"ad3\": () => (/* reexport */ SubscribeEvent),\n  \"xP7\": () => (/* reexport */ System),\n  \"Odq\": () => (/* reexport */ SystemManager),\n  \"Zif\": () => (/* reexport */ SystemType),\n  \"ZGJ\": () => (/* reexport */ TagComponent),\n  \"xvT\": () => (/* reexport */ Text),\n  \"PHM\": () => (/* reexport */ TextAlign),\n  \"KwO\": () => (/* reexport */ TileMap),\n  \"B7y\": () => (/* reexport */ Timer),\n  \"SFp\": () => (/* reexport */ Traits_Index_namespaceObject),\n  \"Uvn\": () => (/* reexport */ TransformComponent),\n  \"OFT\": () => (/* reexport */ TreeNode),\n  \"xzN\": () => (/* reexport */ Trigger_Trigger),\n  \"H6j\": () => (/* reexport */ UnsubscribeEvent),\n  \"ZrN\": () => (/* reexport */ Util_Index_namespaceObject),\n  \"OWs\": () => (/* reexport */ Vector),\n  \"dF9\": () => (/* reexport */ VectorView),\n  \"VHo\": () => (/* reexport */ VisibleEvent),\n  \"R$E\": () => (/* reexport */ WebAudioInstance),\n  \"q3I\": () => (/* reexport */ World),\n  \"Pab\": () => (/* reexport */ canonicalizeAngle),\n  \"uZ5\": () => (/* reexport */ clamp),\n  \"McK\": () => (/* reexport */ createId),\n  \"k0b\": () => (/* reexport */ hasGraphicsTick),\n  \"hnT\": () => (/* reexport */ hasOnInitialize),\n  \"RSJ\": () => (/* reexport */ hasOnPostUpdate),\n  \"Mku\": () => (/* reexport */ hasOnPreUpdate),\n  \"h90\": () => (/* reexport */ hasPostDraw),\n  \"rms\": () => (/* reexport */ hasPreDraw),\n  \"ErP\": () => (/* reexport */ has_initialize),\n  \"aVg\": () => (/* reexport */ has_postupdate),\n  \"lPc\": () => (/* reexport */ has_preupdate),\n  \"Z8E\": () => (/* reexport */ isAddedComponent),\n  \"NNA\": () => (/* reexport */ isAddedSystemEntity),\n  \"yFn\": () => (/* reexport */ isRemoveSystemEntity),\n  \"lNv\": () => (/* reexport */ isRemovedComponent),\n  \"MZQ\": () => (/* reexport */ maxMessages),\n  \"FUM\": () => (/* reexport */ obsolete),\n  \"vdf\": () => (/* reexport */ randomInRange),\n  \"iaL\": () => (/* reexport */ randomIntInRange),\n  \"w6H\": () => (/* reexport */ range),\n  \"Q4c\": () => (/* reexport */ resetObsoleteCounter),\n  \"Uxb\": () => (/* reexport */ toDegrees),\n  \"Yr5\": () => (/* reexport */ toRadians),\n  \"Bhw\": () => (/* reexport */ vec)\n});\n\n// NAMESPACE OBJECT: ./Events.ts\nvar Events_namespaceObject = {};\n__webpack_require__.r(Events_namespaceObject);\n__webpack_require__.d(Events_namespaceObject, {\n  \"ActivateEvent\": () => (ActivateEvent),\n  \"CollisionEndEvent\": () => (CollisionEndEvent),\n  \"CollisionPostSolveEvent\": () => (CollisionPostSolveEvent),\n  \"CollisionPreSolveEvent\": () => (CollisionPreSolveEvent),\n  \"CollisionStartEvent\": () => (CollisionStartEvent),\n  \"ContactEndEvent\": () => (ContactEndEvent),\n  \"ContactStartEvent\": () => (ContactStartEvent),\n  \"DeactivateEvent\": () => (DeactivateEvent),\n  \"EnterTriggerEvent\": () => (EnterTriggerEvent),\n  \"EnterViewPortEvent\": () => (EnterViewPortEvent),\n  \"EventTypes\": () => (EventTypes),\n  \"ExitTriggerEvent\": () => (ExitTriggerEvent),\n  \"ExitViewPortEvent\": () => (ExitViewPortEvent),\n  \"GameEvent\": () => (GameEvent),\n  \"GameStartEvent\": () => (GameStartEvent),\n  \"GameStopEvent\": () => (GameStopEvent),\n  \"GamepadAxisEvent\": () => (GamepadAxisEvent),\n  \"GamepadButtonEvent\": () => (GamepadButtonEvent),\n  \"GamepadConnectEvent\": () => (GamepadConnectEvent),\n  \"GamepadDisconnectEvent\": () => (GamepadDisconnectEvent),\n  \"HiddenEvent\": () => (HiddenEvent),\n  \"InitializeEvent\": () => (InitializeEvent),\n  \"KillEvent\": () => (KillEvent),\n  \"PostCollisionEvent\": () => (PostCollisionEvent),\n  \"PostDebugDrawEvent\": () => (PostDebugDrawEvent),\n  \"PostDrawEvent\": () => (PostDrawEvent),\n  \"PostFrameEvent\": () => (PostFrameEvent),\n  \"PostKillEvent\": () => (PostKillEvent),\n  \"PostUpdateEvent\": () => (PostUpdateEvent),\n  \"PreCollisionEvent\": () => (PreCollisionEvent),\n  \"PreDebugDrawEvent\": () => (PreDebugDrawEvent),\n  \"PreDrawEvent\": () => (PreDrawEvent),\n  \"PreFrameEvent\": () => (PreFrameEvent),\n  \"PreKillEvent\": () => (PreKillEvent),\n  \"PreUpdateEvent\": () => (PreUpdateEvent),\n  \"SubscribeEvent\": () => (SubscribeEvent),\n  \"UnsubscribeEvent\": () => (UnsubscribeEvent),\n  \"VisibleEvent\": () => (VisibleEvent)\n});\n\n// NAMESPACE OBJECT: ./Drawing/SpriteEffects.ts\nvar SpriteEffects_namespaceObject = {};\n__webpack_require__.r(SpriteEffects_namespaceObject);\n__webpack_require__.d(SpriteEffects_namespaceObject, {\n  \"Colorize\": () => (Colorize),\n  \"Darken\": () => (Darken),\n  \"Desaturate\": () => (Desaturate),\n  \"Fill\": () => (Fill),\n  \"Grayscale\": () => (Grayscale),\n  \"Invert\": () => (Invert),\n  \"Lighten\": () => (Lighten),\n  \"Opacity\": () => (Opacity),\n  \"Saturate\": () => (Saturate)\n});\n\n// NAMESPACE OBJECT: ./Util/DrawUtil.ts\nvar DrawUtil_namespaceObject = {};\n__webpack_require__.r(DrawUtil_namespaceObject);\n__webpack_require__.d(DrawUtil_namespaceObject, {\n  \"circle\": () => (circle),\n  \"line\": () => (line),\n  \"point\": () => (point),\n  \"roundRect\": () => (roundRect),\n  \"vector\": () => (vector)\n});\n\n// NAMESPACE OBJECT: ./Drawing/Index.ts\nvar Drawing_Index_namespaceObject = {};\n__webpack_require__.r(Drawing_Index_namespaceObject);\n__webpack_require__.d(Drawing_Index_namespaceObject, {\n  \"Animation\": () => (Animation_Animation),\n  \"CanvasDrawComponent\": () => (CanvasDrawComponent),\n  \"CanvasDrawingSystem\": () => (CanvasDrawingSystem),\n  \"Effects\": () => (SpriteEffects_namespaceObject),\n  \"Polygon\": () => (Polygon),\n  \"Sprite\": () => (Sprite_Sprite),\n  \"SpriteFont\": () => (SpriteFont),\n  \"SpriteSheet\": () => (SpriteSheet_SpriteSheet),\n  \"Texture\": () => (Texture)\n});\n\n// NAMESPACE OBJECT: ./Input/Index.ts\nvar Input_Index_namespaceObject = {};\n__webpack_require__.r(Input_Index_namespaceObject);\n__webpack_require__.d(Input_Index_namespaceObject, {\n  \"Axes\": () => (Axes),\n  \"Buttons\": () => (Buttons),\n  \"Gamepad\": () => (Gamepad),\n  \"Gamepads\": () => (Gamepads),\n  \"KeyEvent\": () => (KeyEvent),\n  \"Keyboard\": () => (Keyboard),\n  \"Keys\": () => (Keys),\n  \"NativePointerButton\": () => (NativePointerButton),\n  \"Pointer\": () => (Pointer),\n  \"PointerButton\": () => (PointerButton),\n  \"PointerCancelEvent\": () => (PointerCancelEvent),\n  \"PointerDownEvent\": () => (PointerDownEvent),\n  \"PointerDragEvent\": () => (PointerDragEvent),\n  \"PointerEnterEvent\": () => (PointerEnterEvent),\n  \"PointerEvent\": () => (PointerEvent),\n  \"PointerEventFactory\": () => (PointerEventFactory),\n  \"PointerLeaveEvent\": () => (PointerLeaveEvent),\n  \"PointerMoveEvent\": () => (PointerMoveEvent),\n  \"PointerScope\": () => (PointerScope),\n  \"PointerType\": () => (PointerType),\n  \"PointerUpEvent\": () => (PointerUpEvent),\n  \"Pointers\": () => (Pointers),\n  \"WheelDeltaMode\": () => (WheelDeltaMode),\n  \"WheelEvent\": () => (WheelEvent),\n  \"createPointerEventByName\": () => (createPointerEventByName)\n});\n\n// NAMESPACE OBJECT: ./Traits/Index.ts\nvar Traits_Index_namespaceObject = {};\n__webpack_require__.r(Traits_Index_namespaceObject);\n__webpack_require__.d(Traits_Index_namespaceObject, {\n  \"CapturePointer\": () => (CapturePointer),\n  \"OffscreenCulling\": () => (OffscreenCulling)\n});\n\n// NAMESPACE OBJECT: ./Util/Index.ts\nvar Util_Index_namespaceObject = {};\n__webpack_require__.r(Util_Index_namespaceObject);\n__webpack_require__.d(Util_Index_namespaceObject, {\n  \"Collection\": () => (Collection),\n  \"ConsoleAppender\": () => (ConsoleAppender),\n  \"DrawUtil\": () => (DrawUtil_namespaceObject),\n  \"EasingFunctions\": () => (EasingFunctions),\n  \"LogLevel\": () => (LogLevel),\n  \"Logger\": () => (Logger),\n  \"Observable\": () => (Observable),\n  \"ScreenAppender\": () => (ScreenAppender),\n  \"TwoPI\": () => (TwoPI),\n  \"addItemToArray\": () => (addItemToArray),\n  \"base64Encode\": () => (base64Encode),\n  \"canonicalizeAngle\": () => (canonicalizeAngle),\n  \"clamp\": () => (clamp),\n  \"contains\": () => (contains),\n  \"delay\": () => (delay),\n  \"extend\": () => (extend),\n  \"fail\": () => (fail),\n  \"getOppositeSide\": () => (getOppositeSide),\n  \"getPosition\": () => (getPosition),\n  \"getSideFromDirection\": () => (getSideFromDirection),\n  \"nullish\": () => (nullish),\n  \"randomInRange\": () => (randomInRange),\n  \"randomIntInRange\": () => (randomIntInRange),\n  \"range\": () => (range),\n  \"removeItemFromArray\": () => (removeItemFromArray),\n  \"toDegrees\": () => (toDegrees),\n  \"toRadians\": () => (toRadians)\n});\n\n// EXTERNAL MODULE: ../../node_modules/core-js/es/array/sort.js\nvar sort = __webpack_require__(4662);\n// EXTERNAL MODULE: ../../node_modules/core-js/es/object/keys.js\nvar keys = __webpack_require__(8343);\n;// CONCATENATED MODULE: ./Polyfill.ts\n\r\n\r\n/**\r\n * Polyfill adding function\r\n */\r\nfunction polyfill() {\r\n    /* istanbul ignore next */\r\n    if (typeof window === 'undefined') {\r\n        window = {\r\n            audioContext: function () {\r\n                return;\r\n            }\r\n        };\r\n    }\r\n    /* istanbul ignore next */\r\n    if (typeof window !== 'undefined' && !window.requestAnimationFrame) {\r\n        window.requestAnimationFrame =\r\n            window.webkitRequestAnimationFrame ||\r\n                window.mozRequestAnimationFrame ||\r\n                function (callback) {\r\n                    window.setInterval(callback, 1000 / 60);\r\n                };\r\n    }\r\n    /* istanbul ignore next */\r\n    if (typeof window !== 'undefined' && !window.cancelAnimationFrame) {\r\n        window.cancelAnimationFrame =\r\n            window.webkitCancelAnimationFrame ||\r\n                window.mozCancelAnimationFrame ||\r\n                function () {\r\n                    return;\r\n                };\r\n    }\r\n    /* istanbul ignore next */\r\n    if (typeof window !== 'undefined' && !window.AudioContext) {\r\n        if (window.webkitAudioContext) {\r\n            const ctx = window.webkitAudioContext;\r\n            const replaceMe = ctx.prototype.decodeAudioData;\r\n            window.webkitAudioContext.prototype.decodeAudioData = function (arrayBuffer) {\r\n                return new Promise((resolve, reject) => {\r\n                    replaceMe.call(this, arrayBuffer, resolve, reject);\r\n                });\r\n            };\r\n        }\r\n        window.AudioContext =\r\n            window.AudioContext ||\r\n                window.webkitAudioContext ||\r\n                window.mozAudioContext ||\r\n                window.msAudioContext ||\r\n                window.oAudioContext;\r\n    }\r\n    /* istanbul ignore next */\r\n    if (typeof window !== 'undefined' && !window.devicePixelRatio) {\r\n        window.devicePixelRatio = window.devicePixelRatio || 1;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Flags.ts\n/**\r\n * Features in preview\r\n */\r\nvar Experiments;\r\n(function (Experiments) {\r\n    Experiments[\"WebGL\"] = \"use-webgl\";\r\n})(Experiments || (Experiments = {}));\r\n/**\r\n * Legacy features that will go away\r\n */\r\nvar Legacy;\r\n(function (Legacy) {\r\n    Legacy[\"Canvas\"] = \"use-canvas-context\";\r\n    Legacy[\"LegacyDrawing\"] = \"use-legacy-drawing\";\r\n})(Legacy || (Legacy = {}));\r\n/**\r\n * Flags is a feature flag implementation for Excalibur. They can only be operated **before [[Engine]] construction**\r\n * after which they are frozen and are read-only.\r\n *\r\n * Flags are used to enable experimental or preview features in Excalibur.\r\n */\r\nclass Flags {\r\n    /**\r\n     * Freeze all flag modifications making them readonly\r\n     */\r\n    static freeze() {\r\n        Flags._FROZEN = true;\r\n    }\r\n    /**\r\n     * Resets internal flag state, not meant to be called by users. Only used for testing.\r\n     *\r\n     * Calling this in your game is UNSUPPORTED\r\n     * @internal\r\n     */\r\n    static _reset() {\r\n        Flags._FROZEN = false;\r\n        Flags._FLAGS = {};\r\n    }\r\n    /**\r\n     * Turn on webgl support\r\n     */\r\n    static useWebGL() {\r\n        Flags.enable(Experiments.WebGL);\r\n    }\r\n    static useCanvasGraphicsContext() {\r\n        Flags.enable(Legacy.Canvas);\r\n    }\r\n    /**\r\n     * @deprecated Recommended not to use legacy drawing, going away in v0.26.0\r\n     */\r\n    static useLegacyDrawing() {\r\n        Flags.enable(Legacy.LegacyDrawing);\r\n    }\r\n    /**\r\n     * Enable a specific feature flag by name. **Note: can only be set before [[Engine]] constructor time**\r\n     * @param flagName\r\n     */\r\n    static enable(flagName) {\r\n        if (this._FROZEN) {\r\n            throw Error('Feature flags can only be enabled before Engine constructor time');\r\n        }\r\n        Flags._FLAGS[flagName] = true;\r\n    }\r\n    /**\r\n     * Disable a specific feature flag by name. **Note: can only be set before [[Engine]] constructor time**\r\n     * @param flagName\r\n     */\r\n    static disable(flagName) {\r\n        if (this._FROZEN) {\r\n            throw Error('Feature flags can only be disabled before Engine constructor time');\r\n        }\r\n        Flags._FLAGS[flagName] = false;\r\n    }\r\n    /**\r\n     * Check if a flag is enabled. If the flag is disabled or does not exist `false` is returned\r\n     * @param flagName\r\n     */\r\n    static isEnabled(flagName) {\r\n        return !!Flags._FLAGS[flagName];\r\n    }\r\n    /**\r\n     * Show a list of currently known flags\r\n     */\r\n    static show() {\r\n        return Object.keys(Flags._FLAGS);\r\n    }\r\n}\r\nFlags._FROZEN = false;\r\nFlags._FLAGS = {};\r\n\n;// CONCATENATED MODULE: ./Id.ts\n/**\r\n *\r\n */\r\nfunction createId(type, value) {\r\n    return { type, value };\r\n}\r\n;\r\n\n;// CONCATENATED MODULE: ./Util/Log.ts\n/* eslint-disable no-console */\r\n/**\r\n * Logging level that Excalibur will tag\r\n */\r\nvar LogLevel;\r\n(function (LogLevel) {\r\n    LogLevel[LogLevel[\"Debug\"] = 0] = \"Debug\";\r\n    LogLevel[LogLevel[\"Info\"] = 1] = \"Info\";\r\n    LogLevel[LogLevel[\"Warn\"] = 2] = \"Warn\";\r\n    LogLevel[LogLevel[\"Error\"] = 3] = \"Error\";\r\n    LogLevel[LogLevel[\"Fatal\"] = 4] = \"Fatal\";\r\n})(LogLevel || (LogLevel = {}));\r\n/**\r\n * Static singleton that represents the logging facility for Excalibur.\r\n * Excalibur comes built-in with a [[ConsoleAppender]] and [[ScreenAppender]].\r\n * Derive from [[Appender]] to create your own logging appenders.\r\n */\r\nclass Logger {\r\n    constructor() {\r\n        this._appenders = [];\r\n        /**\r\n         * Gets or sets the default logging level. Excalibur will only log\r\n         * messages if equal to or above this level. Default: [[LogLevel.Info]]\r\n         */\r\n        this.defaultLevel = LogLevel.Info;\r\n        if (Logger._INSTANCE) {\r\n            throw new Error('Logger is a singleton');\r\n        }\r\n        Logger._INSTANCE = this;\r\n        // Default console appender\r\n        Logger._INSTANCE.addAppender(new ConsoleAppender());\r\n        return Logger._INSTANCE;\r\n    }\r\n    /**\r\n     * Gets the current static instance of Logger\r\n     */\r\n    static getInstance() {\r\n        if (Logger._INSTANCE == null) {\r\n            Logger._INSTANCE = new Logger();\r\n        }\r\n        return Logger._INSTANCE;\r\n    }\r\n    /**\r\n     * Adds a new [[Appender]] to the list of appenders to write to\r\n     */\r\n    addAppender(appender) {\r\n        this._appenders.push(appender);\r\n    }\r\n    /**\r\n     * Clears all appenders from the logger\r\n     */\r\n    clearAppenders() {\r\n        this._appenders.length = 0;\r\n    }\r\n    /**\r\n     * Logs a message at a given LogLevel\r\n     * @param level  The LogLevel`to log the message at\r\n     * @param args   An array of arguments to write to an appender\r\n     */\r\n    _log(level, args) {\r\n        if (level == null) {\r\n            level = this.defaultLevel;\r\n        }\r\n        const len = this._appenders.length;\r\n        for (let i = 0; i < len; i++) {\r\n            if (level >= this.defaultLevel) {\r\n                this._appenders[i].log(level, args);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Writes a log message at the [[LogLevel.Debug]] level\r\n     * @param args  Accepts any number of arguments\r\n     */\r\n    debug(...args) {\r\n        this._log(LogLevel.Debug, args);\r\n    }\r\n    /**\r\n     * Writes a log message at the [[LogLevel.Info]] level\r\n     * @param args  Accepts any number of arguments\r\n     */\r\n    info(...args) {\r\n        this._log(LogLevel.Info, args);\r\n    }\r\n    /**\r\n     * Writes a log message at the [[LogLevel.Warn]] level\r\n     * @param args  Accepts any number of arguments\r\n     */\r\n    warn(...args) {\r\n        this._log(LogLevel.Warn, args);\r\n    }\r\n    /**\r\n     * Writes a log message at the [[LogLevel.Error]] level\r\n     * @param args  Accepts any number of arguments\r\n     */\r\n    error(...args) {\r\n        this._log(LogLevel.Error, args);\r\n    }\r\n    /**\r\n     * Writes a log message at the [[LogLevel.Fatal]] level\r\n     * @param args  Accepts any number of arguments\r\n     */\r\n    fatal(...args) {\r\n        this._log(LogLevel.Fatal, args);\r\n    }\r\n}\r\nLogger._INSTANCE = null;\r\n/**\r\n * Console appender for browsers (i.e. `console.log`)\r\n */\r\nclass ConsoleAppender {\r\n    /**\r\n     * Logs a message at the given [[LogLevel]]\r\n     * @param level  Level to log at\r\n     * @param args   Arguments to log\r\n     */\r\n    log(level, args) {\r\n        // Check for console support\r\n        if (!console && !console.log && console.warn && console.error) {\r\n            // todo maybe do something better than nothing\r\n            return;\r\n        }\r\n        // Create a new console args array\r\n        const consoleArgs = [];\r\n        consoleArgs.unshift.apply(consoleArgs, args);\r\n        consoleArgs.unshift('[' + LogLevel[level] + '] : ');\r\n        if (level < LogLevel.Warn) {\r\n            // Call .log for Debug/Info\r\n            if (console.log.apply) {\r\n                // this is required on some older browsers that don't support apply on console.log :(\r\n                console.log.apply(console, consoleArgs);\r\n            }\r\n            else {\r\n                console.log(consoleArgs.join(' '));\r\n            }\r\n        }\r\n        else if (level < LogLevel.Error) {\r\n            // Call .warn for Warn\r\n            if (console.warn.apply) {\r\n                console.warn.apply(console, consoleArgs);\r\n            }\r\n            else {\r\n                console.warn(consoleArgs.join(' '));\r\n            }\r\n        }\r\n        else {\r\n            // Call .error for Error/Fatal\r\n            if (console.error.apply) {\r\n                console.error.apply(console, consoleArgs);\r\n            }\r\n            else {\r\n                console.error(consoleArgs.join(' '));\r\n            }\r\n        }\r\n    }\r\n}\r\n/**\r\n * On-screen (canvas) appender\r\n */\r\nclass ScreenAppender {\r\n    /**\r\n     * @param width   Width of the screen appender in pixels\r\n     * @param height  Height of the screen appender in pixels\r\n     */\r\n    constructor(width, height) {\r\n        // @todo Clean this up\r\n        this._messages = [];\r\n        this._canvas = document.createElement('canvas');\r\n        this._canvas.width = width || window.innerWidth;\r\n        this._canvas.height = height || window.innerHeight;\r\n        this._canvas.style.position = 'absolute';\r\n        // eslint-disable-next-line\r\n        this._ctx = this._canvas.getContext('2d'); // eslint-disable-line\r\n        document.body.appendChild(this._canvas);\r\n    }\r\n    /**\r\n     * Logs a message at the given [[LogLevel]]\r\n     * @param level  Level to log at\r\n     * @param args   Arguments to log\r\n     */\r\n    log(level, args) {\r\n        const message = args.join(',');\r\n        this._ctx.clearRect(0, 0, this._canvas.width, this._canvas.height);\r\n        this._messages.unshift('[' + LogLevel[level] + '] : ' + message);\r\n        let pos = 10;\r\n        let opacity = 1.0;\r\n        for (let i = 0; i < this._messages.length; i++) {\r\n            this._ctx.fillStyle = 'rgba(255,255,255,' + opacity.toFixed(2) + ')';\r\n            this._ctx.fillText(this._messages[i], 200, pos);\r\n            pos += 10;\r\n            opacity = opacity > 0 ? opacity - 0.05 : 0;\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/Random.ts\n/**\r\n * @module\r\n * Pseudo-Random Utility\r\n *\r\n * A pseudo-random utility to add seeded random support for help in\r\n * generating things like terrain or reproducible randomness. Uses the\r\n * [Mersenne Twister](https://en.wikipedia.org/wiki/Mersenne_Twister) algorithm.\r\n */\r\n/**\r\n * 32-bit mask\r\n */\r\nconst BITMASK32 = 0xffffffff;\r\n/**\r\n * Pseudo-random number generator following the Mersenne_Twister algorithm. Given a seed this generator will produce the same sequence\r\n * of numbers each time it is called.\r\n * See https://en.wikipedia.org/wiki/Mersenne_Twister for more details.\r\n * Uses the MT19937-32 (2002) implementation documented here http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/MT2002/emt19937ar.html\r\n *\r\n * Api inspired by http://chancejs.com/# https://github.com/chancejs/chancejs\r\n */\r\nclass Random {\r\n    /**\r\n     * If no seed is specified, the Date.now() is used\r\n     */\r\n    constructor(seed) {\r\n        this.seed = seed;\r\n        // Separation point of one one word, the number of bits in the lower bitmask 0 <= r <= w-1\r\n        this._lowerMask = 0x7fffffff; // 31 bits same as _r\r\n        this._upperMask = 0x80000000; // 34 high bits\r\n        // Word size, 64 bits\r\n        this._w = 32;\r\n        // Degree of recurrence\r\n        this._n = 624;\r\n        // Middle word, an offset used in the recurrence defining the series x, 1<=m<n\r\n        this._m = 397;\r\n        // coefficients of teh rational normal form twist matrix\r\n        this._a = 0x9908b0df;\r\n        // tempering bit shifts and masks\r\n        this._u = 11;\r\n        this._s = 7;\r\n        this._b = 0x9d2c5680;\r\n        this._t = 15;\r\n        this._c = 0xefc60000;\r\n        this._l = 18;\r\n        this._f = 1812433253;\r\n        this._mt = new Array(this._n);\r\n        // need to mask to support higher bit machines\r\n        this._mt[0] = (seed || Date.now()) >>> 0;\r\n        for (let i = 1; i < this._n; i++) {\r\n            const s = this._mt[i - 1] ^ (this._mt[i - 1] >>> (this._w - 2));\r\n            // numbers are bigger than the JS max safe int, add in 16-bit chunks to prevent IEEE rounding errors on high bits\r\n            this._mt[i] = (((this._f * ((s & 0xffff0000) >>> 16)) << 16) + this._f * (s & 0xffff) + i) >>> 0;\r\n        }\r\n        this._index = this._n;\r\n    }\r\n    /**\r\n     * Apply the twist\r\n     */\r\n    _twist() {\r\n        const mag01 = [0x0, this._a];\r\n        let y = 0, i = 0;\r\n        for (; i < this._n - this._m; i++) {\r\n            y = (this._mt[i] & this._upperMask) | (this._mt[i + 1] & this._lowerMask);\r\n            this._mt[i] = this._mt[i + this._m] ^ (y >>> 1) ^ (mag01[y & 0x1] & BITMASK32);\r\n        }\r\n        for (; i < this._n - 1; i++) {\r\n            y = (this._mt[i] & this._upperMask) | (this._mt[i + 1] & this._lowerMask);\r\n            this._mt[i] = this._mt[i + (this._m - this._n)] ^ (y >>> 1) ^ (mag01[y & 0x1] & BITMASK32);\r\n        }\r\n        y = (this._mt[this._n - 1] & this._upperMask) | (this._mt[0] & this._lowerMask);\r\n        this._mt[this._n - 1] = this._mt[this._m - 1] ^ (y >>> 1) ^ (mag01[y & 0x1] & BITMASK32);\r\n        this._index = 0;\r\n    }\r\n    /**\r\n     * Return next 32 bit integer number in sequence\r\n     */\r\n    nextInt() {\r\n        if (this._index >= this._n) {\r\n            this._twist();\r\n        }\r\n        let y = this._mt[this._index++];\r\n        y ^= y >>> this._u;\r\n        y ^= (y << this._s) & this._b;\r\n        y ^= (y << this._t) & this._c;\r\n        y ^= y >>> this._l;\r\n        return y >>> 0;\r\n    }\r\n    /**\r\n     * Return a random floating point number between [0, 1)\r\n     */\r\n    next() {\r\n        return this.nextInt() * (1.0 / 4294967296.0); // divided by 2^32\r\n    }\r\n    /**\r\n     * Return a random floating point in range [min, max) min is included, max is not included\r\n     */\r\n    floating(min, max) {\r\n        return (max - min) * this.next() + min;\r\n    }\r\n    /**\r\n     * Return a random integer in range [min, max] min is included, max is included.\r\n     * Implemented with rejection sampling, see https://medium.com/@betable/tifu-by-using-math-random-f1c308c4fd9d#.i13tdiu5a\r\n     */\r\n    integer(min, max) {\r\n        return Math.floor((max - min + 1) * this.next() + min);\r\n    }\r\n    /**\r\n     * Returns true or false randomly with 50/50 odds by default.\r\n     * By default the likelihood of returning a true is .5 (50%).\r\n     * @param likelihood takes values between [0, 1]\r\n     */\r\n    bool(likelihood = 0.5) {\r\n        return this.next() <= likelihood;\r\n    }\r\n    /**\r\n     * Returns one element from an array at random\r\n     */\r\n    pickOne(array) {\r\n        return array[this.integer(0, array.length - 1)];\r\n    }\r\n    /**\r\n     * Returns a new array random picking elements from the original\r\n     * @param array Original array to pick from\r\n     * @param numPicks can be any positive number\r\n     * @param allowDuplicates indicates whether the returned set is allowed duplicates (it does not mean there will always be duplicates\r\n     * just that it is possible)\r\n     */\r\n    pickSet(array, numPicks, allowDuplicates = false) {\r\n        if (allowDuplicates) {\r\n            return this._pickSetWithDuplicates(array, numPicks);\r\n        }\r\n        else {\r\n            return this._pickSetWithoutDuplicates(array, numPicks);\r\n        }\r\n    }\r\n    /**\r\n     * Returns a new array randomly picking elements in the original (not reused)\r\n     * @param array Array to pick elements out of\r\n     * @param numPicks must be less than or equal to the number of elements in the array.\r\n     */\r\n    _pickSetWithoutDuplicates(array, numPicks) {\r\n        if (numPicks > array.length || numPicks < 0) {\r\n            throw new Error('Invalid number of elements to pick, must pick a value 0 < n <= length');\r\n        }\r\n        if (numPicks === array.length) {\r\n            return array;\r\n        }\r\n        const result = new Array(numPicks);\r\n        let currentPick = 0;\r\n        const tempArray = array.slice(0);\r\n        while (currentPick < numPicks) {\r\n            const index = this.integer(0, tempArray.length - 1);\r\n            result[currentPick++] = tempArray[index];\r\n            tempArray.splice(index, 1);\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Returns a new array random picking elements from the original allowing duplicates\r\n     * @param array Array to pick elements out of\r\n     * @param numPicks can be any positive number\r\n     */\r\n    _pickSetWithDuplicates(array, numPicks) {\r\n        // Typescript numbers are all floating point, so do we add check for int? (or floor the input?)\r\n        if (numPicks < 0) {\r\n            throw new Error('Invalid number of elements to pick, must pick a value 0 <= n < MAX_INT');\r\n        }\r\n        const result = new Array(numPicks);\r\n        for (let i = 0; i < numPicks; i++) {\r\n            result[i] = this.pickOne(array);\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Returns a new array that has its elements shuffled. Using the Fisher/Yates method\r\n     * https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle\r\n     */\r\n    shuffle(array) {\r\n        const tempArray = array.slice(0);\r\n        let swap = null;\r\n        for (let i = 0; i < tempArray.length - 2; i++) {\r\n            const randomIndex = this.integer(i, tempArray.length - 1);\r\n            swap = tempArray[i];\r\n            tempArray[i] = tempArray[randomIndex];\r\n            tempArray[randomIndex] = swap;\r\n        }\r\n        return tempArray;\r\n    }\r\n    /**\r\n     * Generate a list of random integer numbers\r\n     * @param length the length of the final array\r\n     * @param min the minimum integer number to generate inclusive\r\n     * @param max the maximum integer number to generate inclusive\r\n     */\r\n    range(length, min, max) {\r\n        const result = new Array(length);\r\n        for (let i = 0; i < length; i++) {\r\n            result[i] = this.integer(min, max);\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Returns the result of a d4 dice roll\r\n     */\r\n    d4() {\r\n        return this.integer(1, 4);\r\n    }\r\n    /**\r\n     * Returns the result of a d6 dice roll\r\n     */\r\n    d6() {\r\n        return this.integer(1, 6);\r\n    }\r\n    /**\r\n     * Returns the result of a d8 dice roll\r\n     */\r\n    d8() {\r\n        return this.integer(1, 8);\r\n    }\r\n    /**\r\n     * Returns the result of a d10 dice roll\r\n     */\r\n    d10() {\r\n        return this.integer(1, 10);\r\n    }\r\n    /**\r\n     * Returns the result of a d12 dice roll\r\n     */\r\n    d12() {\r\n        return this.integer(1, 12);\r\n    }\r\n    /**\r\n     * Returns the result of a d20 dice roll\r\n     */\r\n    d20() {\r\n        return this.integer(1, 20);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Side.ts\n\r\n/**\r\n * An enum that describes the sides of an axis aligned box for collision\r\n */\r\nvar Side;\r\n(function (Side) {\r\n    Side[\"None\"] = \"None\";\r\n    Side[\"Top\"] = \"Top\";\r\n    Side[\"Bottom\"] = \"Bottom\";\r\n    Side[\"Left\"] = \"Left\";\r\n    Side[\"Right\"] = \"Right\";\r\n})(Side || (Side = {}));\r\n(function (Side) {\r\n    /**\r\n     * Returns the opposite side from the current\r\n     */\r\n    function getOpposite(side) {\r\n        if (side === Side.Top) {\r\n            return Side.Bottom;\r\n        }\r\n        if (side === Side.Bottom) {\r\n            return Side.Top;\r\n        }\r\n        if (side === Side.Left) {\r\n            return Side.Right;\r\n        }\r\n        if (side === Side.Right) {\r\n            return Side.Left;\r\n        }\r\n        return Side.None;\r\n    }\r\n    Side.getOpposite = getOpposite;\r\n    /**\r\n     * Given a vector, return the Side most in that direction (via dot product)\r\n     */\r\n    function fromDirection(direction) {\r\n        const directions = [Vector.Left, Vector.Right, Vector.Up, Vector.Down];\r\n        const directionEnum = [Side.Left, Side.Right, Side.Top, Side.Bottom];\r\n        let max = -Number.MAX_VALUE;\r\n        let maxIndex = -1;\r\n        for (let i = 0; i < directions.length; i++) {\r\n            if (directions[i].dot(direction) > max) {\r\n                max = directions[i].dot(direction);\r\n                maxIndex = i;\r\n            }\r\n        }\r\n        return directionEnum[maxIndex];\r\n    }\r\n    Side.fromDirection = fromDirection;\r\n})(Side || (Side = {}));\r\n\n;// CONCATENATED MODULE: ./Util/Util.ts\n\r\n\r\n\r\n/**\r\n * Two PI constant\r\n */\r\nconst TwoPI = Math.PI * 2;\r\n/**\r\n * Merges one or more objects into a single target object\r\n *\r\n * @returns Merged object with properties from other objects\r\n * @credit https://gomakethings.com/vanilla-javascript-version-of-jquery-extend/\r\n */\r\nfunction extend() {\r\n    const extended = {};\r\n    let deep = false;\r\n    let i = 0;\r\n    const length = arguments.length;\r\n    // Check if a deep merge\r\n    if (Object.prototype.toString.call(arguments[0]) === '[object Boolean]') {\r\n        deep = arguments[0];\r\n        i++;\r\n    }\r\n    // Merge the object into the extended object\r\n    const assignExists = typeof Object.assign === 'function';\r\n    let merge = null;\r\n    if (!assignExists) {\r\n        merge = function (obj) {\r\n            for (const prop in obj) {\r\n                if (Object.prototype.hasOwnProperty.call(obj, prop)) {\r\n                    // If deep merge and property is an object, merge properties\r\n                    if (deep && Object.prototype.toString.call(obj[prop]) === '[object Object]') {\r\n                        extended[prop] = extend(true, extended[prop], obj[prop]);\r\n                    }\r\n                    else {\r\n                        extended[prop] = obj[prop];\r\n                    }\r\n                }\r\n            }\r\n        };\r\n    }\r\n    else {\r\n        merge = Object.assign;\r\n    }\r\n    // Loop through each object and conduct a merge\r\n    for (; i < length; i++) {\r\n        const obj = arguments[i];\r\n        if (!assignExists) {\r\n            merge(obj);\r\n        }\r\n        else {\r\n            merge(extended, obj);\r\n        }\r\n    }\r\n    return extended;\r\n}\r\n/**\r\n * Encode a string in base64\r\n * @deprecated This will be removed in v0.26.0\r\n */\r\nfunction base64Encode(inputStr) {\r\n    const b64 = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\r\n    let outputStr = '';\r\n    let i = 0;\r\n    while (i < inputStr.length) {\r\n        //all three \"& 0xff\" added below are there to fix a known bug\r\n        //with bytes returned by xhr.responseText\r\n        const byte1 = inputStr.charCodeAt(i++) & 0xff;\r\n        const byte2 = inputStr.charCodeAt(i++) & 0xff;\r\n        const byte3 = inputStr.charCodeAt(i++) & 0xff;\r\n        const enc1 = byte1 >> 2;\r\n        const enc2 = ((byte1 & 3) << 4) | (byte2 >> 4);\r\n        let enc3, enc4;\r\n        if (isNaN(byte2)) {\r\n            enc3 = enc4 = 64;\r\n        }\r\n        else {\r\n            enc3 = ((byte2 & 15) << 2) | (byte3 >> 6);\r\n            if (isNaN(byte3)) {\r\n                enc4 = 64;\r\n            }\r\n            else {\r\n                enc4 = byte3 & 63;\r\n            }\r\n        }\r\n        outputStr += b64.charAt(enc1) + b64.charAt(enc2) + b64.charAt(enc3) + b64.charAt(enc4);\r\n    }\r\n    return outputStr;\r\n}\r\n/**\r\n * Sugar that will use `nullishVal` if it's not null or undefined. Simulates the `??` operator\r\n * @param nullishVal\r\n * @param defaultVal\r\n */\r\nfunction nullish(nullishVal, defaultVal) {\r\n    return nullishVal !== null && nullishVal !== undefined ? nullishVal : defaultVal;\r\n}\r\n/**\r\n * Clamps a value between a min and max inclusive\r\n */\r\nfunction clamp(val, min, max) {\r\n    return Math.min(Math.max(min, val), max);\r\n}\r\n/**\r\n * Find a random floating point number in range\r\n */\r\nfunction randomInRange(min, max, random = new Random()) {\r\n    return random ? random.floating(min, max) : min + Math.random() * (max - min);\r\n}\r\n/**\r\n * Find a random integer in a range\r\n */\r\nfunction randomIntInRange(min, max, random = new Random()) {\r\n    return random ? random.integer(min, max) : Math.round(randomInRange(min, max));\r\n}\r\n/**\r\n * Convert an angle to be the equivalent in the range [0, 2PI]\r\n */\r\nfunction canonicalizeAngle(angle) {\r\n    let tmpAngle = angle;\r\n    if (angle > TwoPI) {\r\n        while (tmpAngle > TwoPI) {\r\n            tmpAngle -= TwoPI;\r\n        }\r\n    }\r\n    if (angle < 0) {\r\n        while (tmpAngle < 0) {\r\n            tmpAngle += TwoPI;\r\n        }\r\n    }\r\n    return tmpAngle;\r\n}\r\n/**\r\n * Convert radians to degrees\r\n */\r\nfunction toDegrees(radians) {\r\n    return (180 / Math.PI) * radians;\r\n}\r\n/**\r\n * Convert degrees to radians\r\n */\r\nfunction toRadians(degrees) {\r\n    return (degrees / 180) * Math.PI;\r\n}\r\n/**\r\n * Find the screen position of an HTML element\r\n */\r\nfunction getPosition(el) {\r\n    let oLeft = 0, oTop = 0;\r\n    const calcOffsetLeft = (parent) => {\r\n        oLeft += parent.offsetLeft;\r\n        if (parent.offsetParent) {\r\n            calcOffsetLeft(parent.offsetParent);\r\n        }\r\n    };\r\n    const calcOffsetTop = (parent) => {\r\n        oTop += parent.offsetTop;\r\n        if (parent.offsetParent) {\r\n            calcOffsetTop(parent.offsetParent);\r\n        }\r\n    };\r\n    calcOffsetLeft(el);\r\n    calcOffsetTop(el);\r\n    return new Vector(oLeft, oTop);\r\n}\r\n/**\r\n * Add an item to an array list if it doesn't already exist. Returns true if added, false if not and already exists in the array.\r\n * @deprecated Will be removed in v0.26.0\r\n */\r\nfunction addItemToArray(item, array) {\r\n    if (array.indexOf(item) === -1) {\r\n        array.push(item);\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * Remove an item from an list\r\n * @deprecated Will be removed in v0.26.0\r\n */\r\nfunction removeItemFromArray(item, array) {\r\n    let index = -1;\r\n    if ((index = array.indexOf(item)) > -1) {\r\n        array.splice(index, 1);\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * See if an array contains something\r\n */\r\nfunction contains(array, obj) {\r\n    for (let i = 0; i < array.length; i++) {\r\n        if (array[i] === obj) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * Get the opposit side\r\n * TODO: Move to Side type\r\n * @deprecated Will be removed in v0.26.0\r\n */\r\nfunction getOppositeSide(side) {\r\n    if (side === Side.Top) {\r\n        return Side.Bottom;\r\n    }\r\n    if (side === Side.Bottom) {\r\n        return Side.Top;\r\n    }\r\n    if (side === Side.Left) {\r\n        return Side.Right;\r\n    }\r\n    if (side === Side.Right) {\r\n        return Side.Left;\r\n    }\r\n    return Side.None;\r\n}\r\n/**\r\n * Returns the side in the direction of the vector supplied\r\n * @param direction Vector to check\r\n * @deprecated\r\n * TODO: Move to Side type\r\n */\r\nfunction getSideFromDirection(direction) {\r\n    const directions = [Vector.Left, Vector.Right, Vector.Up, Vector.Down];\r\n    const directionEnum = [Side.Left, Side.Right, Side.Top, Side.Bottom];\r\n    let max = -Number.MAX_VALUE;\r\n    let maxIndex = -1;\r\n    for (let i = 0; i < directions.length; i++) {\r\n        if (directions[i].dot(direction) > max) {\r\n            max = directions[i].dot(direction);\r\n            maxIndex = i;\r\n        }\r\n    }\r\n    return directionEnum[maxIndex];\r\n}\r\n/**\r\n * Excalibur's dynamically resizing collection\r\n * @deprecated Will be removed v0.26.0\r\n */\r\nclass Collection {\r\n    /**\r\n     * @param initialSize  Initial size of the internal backing array\r\n     */\r\n    constructor(initialSize = Collection.DefaultSize) {\r\n        this._internalArray = null;\r\n        this._endPointer = 0;\r\n        this._internalArray = new Array(initialSize);\r\n    }\r\n    _resize() {\r\n        const newSize = this._internalArray.length * 2;\r\n        const newArray = new Array(newSize);\r\n        const count = this.count();\r\n        for (let i = 0; i < count; i++) {\r\n            newArray[i] = this._internalArray[i];\r\n        }\r\n        delete this._internalArray;\r\n        this._internalArray = newArray;\r\n    }\r\n    /**\r\n     * Push elements to the end of the collection\r\n     */\r\n    push(element) {\r\n        if (this._endPointer === this._internalArray.length) {\r\n            this._resize();\r\n        }\r\n        return (this._internalArray[this._endPointer++] = element);\r\n    }\r\n    /**\r\n     * Removes elements from the end of the collection\r\n     */\r\n    pop() {\r\n        this._endPointer = this._endPointer - 1 < 0 ? 0 : this._endPointer - 1;\r\n        return this._internalArray[this._endPointer];\r\n    }\r\n    /**\r\n     * Returns the count of the collection\r\n     */\r\n    count() {\r\n        return this._endPointer;\r\n    }\r\n    /**\r\n     * Empties the collection\r\n     */\r\n    clear() {\r\n        this._endPointer = 0;\r\n    }\r\n    /**\r\n     * Returns the size of the internal backing array\r\n     */\r\n    internalSize() {\r\n        return this._internalArray.length;\r\n    }\r\n    /**\r\n     * Returns an element at a specific index\r\n     * @param index  Index of element to retrieve\r\n     */\r\n    elementAt(index) {\r\n        if (index >= this.count()) {\r\n            //Logger.getInstance().error('Invalid parameter: ' + index);\r\n            throw new Error('Invalid index ' + index);\r\n        }\r\n        return this._internalArray[index];\r\n    }\r\n    /**\r\n     * Inserts an element at a specific index\r\n     * @param index  Index to insert the element\r\n     * @param value  Element to insert\r\n     */\r\n    insert(index, value) {\r\n        if (index >= this.count()) {\r\n            this._resize();\r\n        }\r\n        return (this._internalArray[index] = value);\r\n    }\r\n    /**\r\n     * Removes an element at a specific index\r\n     * @param index  Index of element to remove\r\n     */\r\n    remove(index) {\r\n        const count = this.count();\r\n        if (count === 0) {\r\n            //Logger.getInstance().error('Invalid parameter: ' + index);\r\n            throw new Error('Invalid parameter ' + index);\r\n        }\r\n        // O(n) Shift\r\n        const removed = this._internalArray[index];\r\n        for (let i = index; i < count; i++) {\r\n            this._internalArray[i] = this._internalArray[i + 1];\r\n        }\r\n        this._endPointer--;\r\n        return removed;\r\n    }\r\n    /**\r\n     * Removes an element by reference\r\n     * @param element  Element to retrieve\r\n     */\r\n    removeElement(element) {\r\n        const index = this._internalArray.indexOf(element);\r\n        this.remove(index);\r\n    }\r\n    /**\r\n     * Returns a array representing the collection\r\n     */\r\n    toArray() {\r\n        return this._internalArray.slice(0, this._endPointer);\r\n    }\r\n    /**\r\n     * Iterate over every element in the collection\r\n     * @param func  Callback to call for each element passing a reference to the element and its index, returned values are ignored\r\n     */\r\n    forEach(func) {\r\n        let i = 0;\r\n        const count = this.count();\r\n        for (i; i < count; i++) {\r\n            func.call(this, this._internalArray[i], i);\r\n        }\r\n    }\r\n    /**\r\n     * Mutate every element in the collection\r\n     * @param func  Callback to call for each element passing a reference to the element and its index, any values returned mutate\r\n     * the collection\r\n     */\r\n    map(func) {\r\n        const count = this.count();\r\n        for (let i = 0; i < count; i++) {\r\n            this._internalArray[i] = func.call(this, this._internalArray[i], i);\r\n        }\r\n    }\r\n}\r\n/**\r\n * Default collection size\r\n */\r\nCollection.DefaultSize = 200;\r\n/**\r\n * Used for exhaustive checks at compile time\r\n */\r\nfunction fail(message) {\r\n    throw new Error(message);\r\n}\r\n/**\r\n * Generate a range of numbers\r\n * For example: range(0, 5) -> [0, 1, 2, 3, 4, 5]\r\n * @param from inclusive\r\n * @param to inclusive\r\n */\r\nconst range = (from, to) => Array.from(new Array(to - from + 1), (_x, i) => i + from);\r\n/**\r\n * Create a promise that resolves after a certain number of milliseconds\r\n * @param milliseconds\r\n */\r\nfunction delay(milliseconds) {\r\n    return new Promise((resolve) => {\r\n        setTimeout(() => {\r\n            resolve();\r\n        }, milliseconds);\r\n    });\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Decorators.ts\n\r\n\r\n\r\nconst maxMessages = 5;\r\nconst obsoleteMessage = {};\r\nconst resetObsoleteCounter = () => {\r\n    for (const message in obsoleteMessage) {\r\n        obsoleteMessage[message] = 0;\r\n    }\r\n};\r\nconst logMessage = (message, options) => {\r\n    const suppressObsoleteMessages = Flags.isEnabled('suppress-obsolete-message');\r\n    if (obsoleteMessage[message] < maxMessages && !suppressObsoleteMessages) {\r\n        Logger.getInstance().warn(message);\r\n        // tslint:disable-next-line: no-console\r\n        if (console.trace && options.showStackTrace) {\r\n            // tslint:disable-next-line: no-console\r\n            console.trace();\r\n        }\r\n    }\r\n    obsoleteMessage[message]++;\r\n};\r\n/**\r\n * Obsolete decorator for marking Excalibur methods obsolete, you can optionally specify a custom message and/or alternate replacement\r\n * method do the deprecated one. Inspired by https://github.com/jayphelps/core-decorators.js\r\n */\r\nfunction obsolete(options) {\r\n    options = extend({}, {\r\n        message: 'This feature will be removed in future versions of Excalibur.',\r\n        alternateMethod: null,\r\n        showStackTrack: false\r\n    }, options);\r\n    return function (target, property, descriptor) {\r\n        if (descriptor &&\r\n            !(typeof descriptor.value === 'function' || typeof descriptor.get === 'function' || typeof descriptor.set === 'function')) {\r\n            throw new SyntaxError('Only classes/functions/getters/setters can be marked as obsolete');\r\n        }\r\n        const methodSignature = `${target.name || ''}${target.name && property ? '.' : ''}${property ? property : ''}`;\r\n        const message = `${methodSignature} is marked obsolete: ${options.message}` +\r\n            (options.alternateMethod ? ` Use ${options.alternateMethod} instead` : '');\r\n        if (!obsoleteMessage[message]) {\r\n            obsoleteMessage[message] = 0;\r\n        }\r\n        // If descriptor is null it is a class\r\n        const method = descriptor ? Object.assign({}, descriptor) : target;\r\n        if (!descriptor) {\r\n            // with es2015 classes we need to change our decoration tactic\r\n            class DecoratedClass extends method {\r\n                constructor(...args) {\r\n                    logMessage(message, options);\r\n                    super(...args);\r\n                }\r\n            }\r\n            return DecoratedClass;\r\n        }\r\n        if (descriptor && descriptor.value) {\r\n            method.value = function () {\r\n                logMessage(message, options);\r\n                return descriptor.value.apply(this, arguments);\r\n            };\r\n            return method;\r\n        }\r\n        if (descriptor && descriptor.get) {\r\n            method.get = function () {\r\n                logMessage(message, options);\r\n                return descriptor.get.apply(this, arguments);\r\n            };\r\n        }\r\n        if (descriptor && descriptor.set) {\r\n            method.set = function () {\r\n                logMessage(message, options);\r\n                return descriptor.set.apply(this, arguments);\r\n            };\r\n        }\r\n        return method;\r\n    };\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/vector.ts\nvar __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\n/**\r\n * A 2D vector on a plane.\r\n */\r\nclass Vector {\r\n    /**\r\n     * @param x  X component of the Vector\r\n     * @param y  Y component of the Vector\r\n     */\r\n    constructor(x, y) {\r\n        this._x = 0;\r\n        this._y = 0;\r\n        this._x = x;\r\n        this._y = y;\r\n    }\r\n    /**\r\n     * A (0, 0) vector\r\n     */\r\n    static get Zero() {\r\n        return new Vector(0, 0);\r\n    }\r\n    /**\r\n     * A (1, 1) vector\r\n     */\r\n    static get One() {\r\n        return new Vector(1, 1);\r\n    }\r\n    /**\r\n     * A (0.5, 0.5) vector\r\n     */\r\n    static get Half() {\r\n        return new Vector(0.5, 0.5);\r\n    }\r\n    /**\r\n     * A unit vector pointing up (0, -1)\r\n     */\r\n    static get Up() {\r\n        return new Vector(0, -1);\r\n    }\r\n    /**\r\n     * A unit vector pointing down (0, 1)\r\n     */\r\n    static get Down() {\r\n        return new Vector(0, 1);\r\n    }\r\n    /**\r\n     * A unit vector pointing left (-1, 0)\r\n     */\r\n    static get Left() {\r\n        return new Vector(-1, 0);\r\n    }\r\n    /**\r\n     * A unit vector pointing right (1, 0)\r\n     */\r\n    static get Right() {\r\n        return new Vector(1, 0);\r\n    }\r\n    /**\r\n     * Returns a vector of unit length in the direction of the specified angle in Radians.\r\n     * @param angle The angle to generate the vector\r\n     */\r\n    static fromAngle(angle) {\r\n        return new Vector(Math.cos(angle), Math.sin(angle));\r\n    }\r\n    /**\r\n     * Checks if vector is not null, undefined, or if any of its components are NaN or Infinity.\r\n     */\r\n    static isValid(vec) {\r\n        if (vec === null || vec === undefined) {\r\n            return false;\r\n        }\r\n        if (isNaN(vec.x) || isNaN(vec.y)) {\r\n            return false;\r\n        }\r\n        if (vec.x === Infinity || vec.y === Infinity || vec.x === -Infinity || vec.y === -Infinity) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    /**\r\n     * Calculates distance between two Vectors\r\n     * @param vec1\r\n     * @param vec2\r\n     */\r\n    static distance(vec1, vec2) {\r\n        return Math.sqrt(Math.pow(vec1.x - vec2.x, 2) + Math.pow(vec1.y - vec2.y, 2));\r\n    }\r\n    /**\r\n     * Get the x component of the vector\r\n     */\r\n    get x() {\r\n        return this._x;\r\n    }\r\n    /**\r\n     * Set the x component, THIS MUTATES the current vector. It is usually better to create a new vector.\r\n     * @warning **Be very careful setting components on shared vectors, mutating shared vectors can cause hard to find bugs**\r\n     */\r\n    set x(val) {\r\n        this._x = val;\r\n    }\r\n    /**\r\n     * Get the y component of the vector\r\n     */\r\n    get y() {\r\n        return this._y;\r\n    }\r\n    /**\r\n     * Set the y component, THIS MUTATES the current vector. It is usually better to create a new vector.\r\n     * @warning **Be very careful setting components on shared vectors, mutating shared vectors can cause hard to find bugs**\r\n     */\r\n    set y(val) {\r\n        this._y = val;\r\n    }\r\n    /**\r\n     * Sets the x and y components at once, THIS MUTATES the current vector. It is usually better to create a new vector.\r\n     *\r\n     * @warning **Be very careful using this, mutating vectors can cause hard to find bugs**\r\n     */\r\n    setTo(x, y) {\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n    /**\r\n     * Compares this point against another and tests for equality\r\n     * @param vector The other point to compare to\r\n     * @param tolerance Amount of euclidean distance off we are willing to tolerate\r\n     */\r\n    equals(vector, tolerance = 0.001) {\r\n        return Math.abs(this.x - vector.x) <= tolerance && Math.abs(this.y - vector.y) <= tolerance;\r\n    }\r\n    /**\r\n     * The distance to another vector. If no other Vector is specified, this will return the [[magnitude]].\r\n     * @param v  The other vector. Leave blank to use origin vector.\r\n     */\r\n    distance(v) {\r\n        if (!v) {\r\n            v = Vector.Zero;\r\n        }\r\n        return Math.sqrt(Math.pow(this.x - v.x, 2) + Math.pow(this.y - v.y, 2));\r\n    }\r\n    squareDistance(v) {\r\n        if (!v) {\r\n            v = Vector.Zero;\r\n        }\r\n        return Math.pow(this.x - v.x, 2) + Math.pow(this.y - v.y, 2);\r\n    }\r\n    /**\r\n     * The magnitude (size) of the Vector\r\n     * @deprecated magnitude will be removed in favour of '.size' in version 0.25.0\r\n     */\r\n    magnitude() {\r\n        return this.distance();\r\n    }\r\n    /**\r\n     * The size (magnitude) of the Vector\r\n     */\r\n    get size() {\r\n        return this.distance();\r\n    }\r\n    /**\r\n     * Setting the size mutates the current vector\r\n     *\r\n     * @warning Can be used to set the size of the vector, **be very careful using this, mutating vectors can cause hard to find bugs**\r\n     */\r\n    set size(newLength) {\r\n        const v = this.normalize().scale(newLength);\r\n        this.setTo(v.x, v.y);\r\n    }\r\n    /**\r\n     * Normalizes a vector to have a magnitude of 1.\r\n     */\r\n    normalize() {\r\n        const d = this.distance();\r\n        if (d > 0) {\r\n            return new Vector(this.x / d, this.y / d);\r\n        }\r\n        else {\r\n            return new Vector(0, 1);\r\n        }\r\n    }\r\n    /**\r\n     * Returns the average (midpoint) between the current point and the specified\r\n     */\r\n    average(vec) {\r\n        return this.add(vec).scale(0.5);\r\n    }\r\n    scale(sizeOrScale) {\r\n        if (sizeOrScale instanceof Vector) {\r\n            return new Vector(this.x * sizeOrScale.x, this.y * sizeOrScale.y);\r\n        }\r\n        else {\r\n            return new Vector(this.x * sizeOrScale, this.y * sizeOrScale);\r\n        }\r\n    }\r\n    /**\r\n     * Adds one vector to another\r\n     * @param v The vector to add\r\n     */\r\n    add(v) {\r\n        return new Vector(this.x + v.x, this.y + v.y);\r\n    }\r\n    /**\r\n     * Subtracts a vector from another, if you subtract vector `B.sub(A)` the resulting vector points from A -> B\r\n     * @param v The vector to subtract\r\n     */\r\n    sub(v) {\r\n        return new Vector(this.x - v.x, this.y - v.y);\r\n    }\r\n    /**\r\n     * Adds one vector to this one modifying the original\r\n     * @param v The vector to add\r\n     * @warning Be very careful using this, mutating vectors can cause hard to find bugs\r\n     */\r\n    addEqual(v) {\r\n        this.setTo(this.x + v.x, this.y + v.y);\r\n        return this;\r\n    }\r\n    /**\r\n     * Subtracts a vector from this one modifying the original\r\n     * @param v The vector to subtract\r\n     * @warning Be very careful using this, mutating vectors can cause hard to find bugs\r\n     */\r\n    subEqual(v) {\r\n        this.setTo(this.x - v.x, this.y - v.y);\r\n        return this;\r\n    }\r\n    /**\r\n     * Scales this vector by a factor of size and modifies the original\r\n     * @warning Be very careful using this, mutating vectors can cause hard to find bugs\r\n     */\r\n    scaleEqual(size) {\r\n        this.setTo(this.x * size, this.y * size);\r\n        return this;\r\n    }\r\n    /**\r\n     * Performs a dot product with another vector\r\n     * @param v  The vector to dot\r\n     */\r\n    dot(v) {\r\n        return this.x * v.x + this.y * v.y;\r\n    }\r\n    cross(v) {\r\n        if (v instanceof Vector) {\r\n            return this.x * v.y - this.y * v.x;\r\n        }\r\n        else if (typeof v === 'number') {\r\n            return new Vector(v * this.y, -v * this.x);\r\n        }\r\n    }\r\n    static cross(num, vec) {\r\n        return new Vector(-num * vec.y, num * vec.x);\r\n    }\r\n    /**\r\n     * Returns the perpendicular vector to this one\r\n     */\r\n    perpendicular() {\r\n        return new Vector(this.y, -this.x);\r\n    }\r\n    /**\r\n     * Returns the normal vector to this one, same as the perpendicular of length 1\r\n     */\r\n    normal() {\r\n        return this.perpendicular().normalize();\r\n    }\r\n    /**\r\n     * Negate the current vector\r\n     */\r\n    negate() {\r\n        return this.scale(-1);\r\n    }\r\n    /**\r\n     * Returns the angle of this vector.\r\n     */\r\n    toAngle() {\r\n        return Math.atan2(this.y, this.x);\r\n    }\r\n    /**\r\n     * Rotates the current vector around a point by a certain number of\r\n     * degrees in radians\r\n     */\r\n    rotate(angle, anchor) {\r\n        if (!anchor) {\r\n            anchor = new Vector(0, 0);\r\n        }\r\n        const sinAngle = Math.sin(angle);\r\n        const cosAngle = Math.cos(angle);\r\n        const x = cosAngle * (this.x - anchor.x) - sinAngle * (this.y - anchor.y) + anchor.x;\r\n        const y = sinAngle * (this.x - anchor.x) + cosAngle * (this.y - anchor.y) + anchor.y;\r\n        return new Vector(x, y);\r\n    }\r\n    /**\r\n     * Creates new vector that has the same values as the previous.\r\n     */\r\n    clone() {\r\n        return new Vector(this.x, this.y);\r\n    }\r\n    /**\r\n     * Returns a string representation of the vector.\r\n     */\r\n    toString(fixed) {\r\n        if (fixed) {\r\n            return `(${this.x.toFixed(fixed)}, ${this.y.toFixed(fixed)})`;\r\n        }\r\n        return `(${this.x}, ${this.y})`;\r\n    }\r\n}\r\n__decorate([\r\n    obsolete({ message: 'will be removed in favour of `.size` in version 0.25.0' })\r\n], Vector.prototype, \"magnitude\", null);\r\n/**\r\n * Shorthand for creating new Vectors - returns a new Vector instance with the\r\n * provided X and Y components.\r\n *\r\n * @param x  X component of the Vector\r\n * @param y  Y component of the Vector\r\n */\r\nfunction vec(x, y) {\r\n    return new Vector(x, y);\r\n}\r\n\n;// CONCATENATED MODULE: ./Color.ts\nvar Color_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\n/**\r\n * Provides standard colors (e.g. [[Color.Black]])\r\n * but you can also create custom colors using RGB, HSL, or Hex. Also provides\r\n * useful color operations like [[Color.lighten]], [[Color.darken]], and more.\r\n */\r\nclass Color {\r\n    /**\r\n     * Creates a new instance of Color from an r, g, b, a\r\n     *\r\n     * @param r  The red component of color (0-255)\r\n     * @param g  The green component of color (0-255)\r\n     * @param b  The blue component of color (0-255)\r\n     * @param a  The alpha component of color (0-1.0)\r\n     */\r\n    constructor(r, g, b, a) {\r\n        this.r = r;\r\n        this.g = g;\r\n        this.b = b;\r\n        this.a = a != null ? a : 1;\r\n    }\r\n    /**\r\n     * Creates a new instance of Color from an r, g, b, a\r\n     *\r\n     * @param r  The red component of color (0-255)\r\n     * @param g  The green component of color (0-255)\r\n     * @param b  The blue component of color (0-255)\r\n     * @param a  The alpha component of color (0-1.0)\r\n     */\r\n    static fromRGB(r, g, b, a) {\r\n        return new Color(r, g, b, a);\r\n    }\r\n    /**\r\n     * Creates a new instance of Color from a rgb string\r\n     *\r\n     * @param string  CSS color string of the form rgba(255, 255, 255, 1) or rgb(255, 255, 255)\r\n     */\r\n    static fromRGBString(string) {\r\n        const rgbaRegEx = /^rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)(?:,\\s*(\\d+(?:\\.\\d+)?))?\\)/i;\r\n        let match = null;\r\n        if ((match = string.match(rgbaRegEx))) {\r\n            const r = parseInt(match[1], 10);\r\n            const g = parseInt(match[2], 10);\r\n            const b = parseInt(match[3], 10);\r\n            let a = 1;\r\n            if (match[4]) {\r\n                a = parseFloat(match[4]);\r\n            }\r\n            return new Color(r, g, b, a);\r\n        }\r\n        else {\r\n            throw new Error('Invalid rgb/a string: ' + string);\r\n        }\r\n    }\r\n    /**\r\n     * Creates a new instance of Color from a hex string\r\n     *\r\n     * @param hex  CSS color string of the form #ffffff, the alpha component is optional\r\n     */\r\n    static fromHex(hex) {\r\n        const hexRegEx = /^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i;\r\n        let match = null;\r\n        if ((match = hex.match(hexRegEx))) {\r\n            const r = parseInt(match[1], 16);\r\n            const g = parseInt(match[2], 16);\r\n            const b = parseInt(match[3], 16);\r\n            let a = 1;\r\n            if (match[4]) {\r\n                a = parseInt(match[4], 16) / 255;\r\n            }\r\n            return new Color(r, g, b, a);\r\n        }\r\n        else {\r\n            throw new Error('Invalid hex string: ' + hex);\r\n        }\r\n    }\r\n    /**\r\n     * Creates a new instance of Color from hsla values\r\n     *\r\n     * @param h  Hue is represented [0-1]\r\n     * @param s  Saturation is represented [0-1]\r\n     * @param l  Luminance is represented [0-1]\r\n     * @param a  Alpha is represented [0-1]\r\n     */\r\n    static fromHSL(h, s, l, a = 1.0) {\r\n        const temp = new HSLColor(h, s, l, a);\r\n        return temp.toRGBA();\r\n    }\r\n    /**\r\n     * Lightens the current color by a specified amount\r\n     *\r\n     * @param factor  The amount to lighten by [0-1]\r\n     */\r\n    lighten(factor = 0.1) {\r\n        const temp = HSLColor.fromRGBA(this.r, this.g, this.b, this.a);\r\n        temp.l += (1 - temp.l) * factor;\r\n        return temp.toRGBA();\r\n    }\r\n    /**\r\n     * Darkens the current color by a specified amount\r\n     *\r\n     * @param factor  The amount to darken by [0-1]\r\n     */\r\n    darken(factor = 0.1) {\r\n        const temp = HSLColor.fromRGBA(this.r, this.g, this.b, this.a);\r\n        temp.l -= temp.l * factor;\r\n        return temp.toRGBA();\r\n    }\r\n    /**\r\n     * Saturates the current color by a specified amount\r\n     *\r\n     * @param factor  The amount to saturate by [0-1]\r\n     */\r\n    saturate(factor = 0.1) {\r\n        const temp = HSLColor.fromRGBA(this.r, this.g, this.b, this.a);\r\n        temp.s += temp.s * factor;\r\n        return temp.toRGBA();\r\n    }\r\n    /**\r\n     * Desaturates the current color by a specified amount\r\n     *\r\n     * @param factor  The amount to desaturate by [0-1]\r\n     */\r\n    desaturate(factor = 0.1) {\r\n        const temp = HSLColor.fromRGBA(this.r, this.g, this.b, this.a);\r\n        temp.s -= temp.s * factor;\r\n        return temp.toRGBA();\r\n    }\r\n    /**\r\n     * Multiplies a color by another, results in a darker color\r\n     *\r\n     * @param color  The other color\r\n     */\r\n    multiply(color) {\r\n        const newR = (((color.r / 255) * this.r) / 255) * 255;\r\n        const newG = (((color.g / 255) * this.g) / 255) * 255;\r\n        const newB = (((color.b / 255) * this.b) / 255) * 255;\r\n        const newA = color.a * this.a;\r\n        return new Color(newR, newG, newB, newA);\r\n    }\r\n    /**\r\n     * Multiplies a color by another, results in a darker color\r\n     * @param color\r\n     * @deprecated Alias for incorrect spelling used in older versions, use multiply instead, will be removed in v0.25.0\r\n     */\r\n    mulitiply(color) {\r\n        return this.multiply(color);\r\n    }\r\n    /**\r\n     * Screens a color by another, results in a lighter color\r\n     *\r\n     * @param color  The other color\r\n     */\r\n    screen(color) {\r\n        const color1 = color.invert();\r\n        const color2 = color.invert();\r\n        return color1.multiply(color2).invert();\r\n    }\r\n    /**\r\n     * Inverts the current color\r\n     */\r\n    invert() {\r\n        return new Color(255 - this.r, 255 - this.g, 255 - this.b, 1.0 - this.a);\r\n    }\r\n    /**\r\n     * Averages the current color with another\r\n     *\r\n     * @param color  The other color\r\n     */\r\n    average(color) {\r\n        const newR = (color.r + this.r) / 2;\r\n        const newG = (color.g + this.g) / 2;\r\n        const newB = (color.b + this.b) / 2;\r\n        const newA = (color.a + this.a) / 2;\r\n        return new Color(newR, newG, newB, newA);\r\n    }\r\n    equal(color) {\r\n        return this.toString() === color.toString();\r\n    }\r\n    /**\r\n     * Returns a CSS string representation of a color.\r\n     *\r\n     * @param format Color representation, accepts: rgb, hsl, or hex\r\n     */\r\n    toString(format = 'rgb') {\r\n        switch (format) {\r\n            case 'rgb':\r\n                return this.toRGBA();\r\n            case 'hsl':\r\n                return this.toHSLA();\r\n            case 'hex':\r\n                return this.toHex();\r\n            default:\r\n                throw new Error('Invalid Color format');\r\n        }\r\n    }\r\n    /**\r\n     * Returns Hex Value of a color component\r\n     * @param c color component\r\n     * @see https://stackoverflow.com/questions/5623838/rgb-to-hex-and-hex-to-rgb\r\n     */\r\n    _componentToHex(c) {\r\n        const hex = c.toString(16);\r\n        return hex.length === 1 ? '0' + hex : hex;\r\n    }\r\n    /**\r\n     * Return Hex representation of a color.\r\n     */\r\n    toHex() {\r\n        return '#' + this._componentToHex(this.r) + this._componentToHex(this.g) + this._componentToHex(this.b);\r\n    }\r\n    /**\r\n     * Return RGBA representation of a color.\r\n     */\r\n    toRGBA() {\r\n        const result = String(this.r.toFixed(0)) + ', ' + String(this.g.toFixed(0)) + ', ' + String(this.b.toFixed(0));\r\n        if (this.a !== undefined || this.a !== null) {\r\n            return 'rgba(' + result + ', ' + String(this.a) + ')';\r\n        }\r\n        return 'rgb(' + result + ')';\r\n    }\r\n    /**\r\n     * Return HSLA representation of a color.\r\n     */\r\n    toHSLA() {\r\n        return HSLColor.fromRGBA(this.r, this.g, this.b, this.a).toString();\r\n    }\r\n    /**\r\n     * Returns a CSS string representation of a color.\r\n     */\r\n    fillStyle() {\r\n        return this.toString();\r\n    }\r\n    /**\r\n     * Returns a clone of the current color.\r\n     */\r\n    clone() {\r\n        return new Color(this.r, this.g, this.b, this.a);\r\n    }\r\n    /**\r\n     * Black (#000000)\r\n     */\r\n    static get Black() {\r\n        return Color.fromHex('#000000');\r\n    }\r\n    /**\r\n     * White (#FFFFFF)\r\n     */\r\n    static get White() {\r\n        return Color.fromHex('#FFFFFF');\r\n    }\r\n    /**\r\n     * Gray (#808080)\r\n     */\r\n    static get Gray() {\r\n        return Color.fromHex('#808080');\r\n    }\r\n    /**\r\n     * Light gray (#D3D3D3)\r\n     */\r\n    static get LightGray() {\r\n        return Color.fromHex('#D3D3D3');\r\n    }\r\n    /**\r\n     * Dark gray (#A9A9A9)\r\n     */\r\n    static get DarkGray() {\r\n        return Color.fromHex('#A9A9A9');\r\n    }\r\n    /**\r\n     * Yellow (#FFFF00)\r\n     */\r\n    static get Yellow() {\r\n        return Color.fromHex('#FFFF00');\r\n    }\r\n    /**\r\n     * Orange (#FFA500)\r\n     */\r\n    static get Orange() {\r\n        return Color.fromHex('#FFA500');\r\n    }\r\n    /**\r\n     * Red (#FF0000)\r\n     */\r\n    static get Red() {\r\n        return Color.fromHex('#FF0000');\r\n    }\r\n    /**\r\n     * Vermilion (#FF5B31)\r\n     */\r\n    static get Vermilion() {\r\n        return Color.fromHex('#FF5B31');\r\n    }\r\n    /**\r\n     * Vermilion (#FF5B31)\r\n     * @deprecated Alias for incorrect spelling used in older versions, use multiply instead, will be removed in v0.25.0\r\n     */\r\n    static get Vermillion() {\r\n        return Color.Vermilion;\r\n    }\r\n    /**\r\n     * Rose (#FF007F)\r\n     */\r\n    static get Rose() {\r\n        return Color.fromHex('#FF007F');\r\n    }\r\n    /**\r\n     * Magenta (#FF00FF)\r\n     */\r\n    static get Magenta() {\r\n        return Color.fromHex('#FF00FF');\r\n    }\r\n    /**\r\n     * Violet (#7F00FF)\r\n     */\r\n    static get Violet() {\r\n        return Color.fromHex('#7F00FF');\r\n    }\r\n    /**\r\n     * Blue (#0000FF)\r\n     */\r\n    static get Blue() {\r\n        return Color.fromHex('#0000FF');\r\n    }\r\n    /**\r\n     * Azure (#007FFF)\r\n     */\r\n    static get Azure() {\r\n        return Color.fromHex('#007FFF');\r\n    }\r\n    /**\r\n     * Cyan (#00FFFF)\r\n     */\r\n    static get Cyan() {\r\n        return Color.fromHex('#00FFFF');\r\n    }\r\n    /**\r\n     * Viridian (#59978F)\r\n     */\r\n    static get Viridian() {\r\n        return Color.fromHex('#59978F');\r\n    }\r\n    /**\r\n     * Green (#00FF00)\r\n     */\r\n    static get Green() {\r\n        return Color.fromHex('#00FF00');\r\n    }\r\n    /**\r\n     * Chartreuse (#7FFF00)\r\n     */\r\n    static get Chartreuse() {\r\n        return Color.fromHex('#7FFF00');\r\n    }\r\n    /**\r\n     * Transparent (#FFFFFF00)\r\n     */\r\n    static get Transparent() {\r\n        return Color.fromHex('#FFFFFF00');\r\n    }\r\n    /**\r\n     * ExcaliburBlue (#176BAA)\r\n     */\r\n    static get ExcaliburBlue() {\r\n        return Color.fromHex('#176BAA');\r\n    }\r\n}\r\nColor_decorate([\r\n    obsolete({ message: 'Alias for incorrect spelling used in older versions, use multiply instead, will be removed in v0.25.0' })\r\n], Color.prototype, \"mulitiply\", null);\r\nColor_decorate([\r\n    obsolete({\r\n        message: 'Alias for incorrect spelling used in older versions',\r\n        alternateMethod: 'Vermilion'\r\n    })\r\n], Color, \"Vermillion\", null);\r\n/**\r\n * Internal HSL Color representation\r\n *\r\n * http://en.wikipedia.org/wiki/HSL_and_HSV\r\n * http://axonflux.com/handy-rgb-to-hsl-and-rgb-to-hsv-color-model-c\r\n */\r\nclass HSLColor {\r\n    constructor(h, s, l, a) {\r\n        this.h = h;\r\n        this.s = s;\r\n        this.l = l;\r\n        this.a = a;\r\n    }\r\n    static hue2rgb(p, q, t) {\r\n        if (t < 0) {\r\n            t += 1;\r\n        }\r\n        if (t > 1) {\r\n            t -= 1;\r\n        }\r\n        if (t < 1 / 6) {\r\n            return p + (q - p) * 6 * t;\r\n        }\r\n        if (t < 1 / 2) {\r\n            return q;\r\n        }\r\n        if (t < 2 / 3) {\r\n            return p + (q - p) * (2 / 3 - t) * 6;\r\n        }\r\n        return p;\r\n    }\r\n    static fromRGBA(r, g, b, a) {\r\n        r /= 255;\r\n        g /= 255;\r\n        b /= 255;\r\n        const max = Math.max(r, g, b), min = Math.min(r, g, b);\r\n        let h, s;\r\n        const l = (max + min) / 2;\r\n        if (max === min) {\r\n            h = s = 0; // achromatic\r\n        }\r\n        else {\r\n            const d = max - min;\r\n            s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\r\n            switch (max) {\r\n                case r:\r\n                    h = (g - b) / d + (g < b ? 6 : 0);\r\n                    break;\r\n                case g:\r\n                    h = (b - r) / d + 2;\r\n                    break;\r\n                case b:\r\n                    h = (r - g) / d + 4;\r\n                    break;\r\n            }\r\n            h /= 6;\r\n        }\r\n        return new HSLColor(h, s, l, a);\r\n    }\r\n    toRGBA() {\r\n        let r, g, b;\r\n        if (this.s === 0) {\r\n            r = g = b = this.l; // achromatic\r\n        }\r\n        else {\r\n            const q = this.l < 0.5 ? this.l * (1 + this.s) : this.l + this.s - this.l * this.s;\r\n            const p = 2 * this.l - q;\r\n            r = HSLColor.hue2rgb(p, q, this.h + 1 / 3);\r\n            g = HSLColor.hue2rgb(p, q, this.h);\r\n            b = HSLColor.hue2rgb(p, q, this.h - 1 / 3);\r\n        }\r\n        return new Color(r * 255, g * 255, b * 255, this.a);\r\n    }\r\n    toString() {\r\n        const h = this.h.toFixed(0), s = this.s.toFixed(0), l = this.l.toFixed(0), a = this.a.toFixed(0);\r\n        return `hsla(${h}, ${s}, ${l}, ${a})`;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/BoundingBox.ts\n\r\n\r\n\r\n/**\r\n * Axis Aligned collision primitive for Excalibur.\r\n */\r\nclass BoundingBox {\r\n    /**\r\n     * Constructor allows passing of either an object with all coordinate components,\r\n     * or the coordinate components passed separately.\r\n     * @param leftOrOptions    Either x coordinate of the left edge or an options object\r\n     * containing the four coordinate components.\r\n     * @param top     y coordinate of the top edge\r\n     * @param right   x coordinate of the right edge\r\n     * @param bottom  y coordinate of the bottom edge\r\n     */\r\n    constructor(leftOrOptions = 0, top = 0, right = 0, bottom = 0) {\r\n        if (typeof leftOrOptions === 'object') {\r\n            this.left = leftOrOptions.left;\r\n            this.top = leftOrOptions.top;\r\n            this.right = leftOrOptions.right;\r\n            this.bottom = leftOrOptions.bottom;\r\n        }\r\n        else if (typeof leftOrOptions === 'number') {\r\n            this.left = leftOrOptions;\r\n            this.top = top;\r\n            this.right = right;\r\n            this.bottom = bottom;\r\n        }\r\n    }\r\n    /**\r\n     * Given bounding box A & B, returns the side relative to A when intersection is performed.\r\n     * @param intersection Intersection vector between 2 bounding boxes\r\n     */\r\n    static getSideFromIntersection(intersection) {\r\n        if (!intersection) {\r\n            return Side.None;\r\n        }\r\n        if (intersection) {\r\n            if (Math.abs(intersection.x) > Math.abs(intersection.y)) {\r\n                if (intersection.x < 0) {\r\n                    return Side.Right;\r\n                }\r\n                return Side.Left;\r\n            }\r\n            else {\r\n                if (intersection.y < 0) {\r\n                    return Side.Bottom;\r\n                }\r\n                return Side.Top;\r\n            }\r\n        }\r\n        return Side.None;\r\n    }\r\n    static fromPoints(points) {\r\n        let minX = Infinity;\r\n        let minY = Infinity;\r\n        let maxX = -Infinity;\r\n        let maxY = -Infinity;\r\n        for (let i = 0; i < points.length; i++) {\r\n            if (points[i].x < minX) {\r\n                minX = points[i].x;\r\n            }\r\n            if (points[i].x > maxX) {\r\n                maxX = points[i].x;\r\n            }\r\n            if (points[i].y < minY) {\r\n                minY = points[i].y;\r\n            }\r\n            if (points[i].y > maxY) {\r\n                maxY = points[i].y;\r\n            }\r\n        }\r\n        return new BoundingBox(minX, minY, maxX, maxY);\r\n    }\r\n    static fromDimension(width, height, anchor = Vector.Half, pos = Vector.Zero) {\r\n        return new BoundingBox(-width * anchor.x + pos.x, -height * anchor.y + pos.y, width - width * anchor.x + pos.x, height - height * anchor.y + pos.y);\r\n    }\r\n    /**\r\n     * Returns the calculated width of the bounding box\r\n     */\r\n    get width() {\r\n        return this.right - this.left;\r\n    }\r\n    /**\r\n     * Returns the calculated height of the bounding box\r\n     */\r\n    get height() {\r\n        return this.bottom - this.top;\r\n    }\r\n    /**\r\n     * Return whether the bounding box has zero dimensions in height,width or both\r\n     */\r\n    hasZeroDimensions() {\r\n        return this.width === 0 || this.height === 0;\r\n    }\r\n    /**\r\n     * Returns the center of the bounding box\r\n     */\r\n    get center() {\r\n        return new Vector((this.left + this.right) / 2, (this.top + this.bottom) / 2);\r\n    }\r\n    translate(pos) {\r\n        return new BoundingBox(this.left + pos.x, this.top + pos.y, this.right + pos.x, this.bottom + pos.y);\r\n    }\r\n    /**\r\n     * Rotates a bounding box by and angle and around a point, if no point is specified (0, 0) is used by default. The resulting bounding\r\n     * box is also axis-align. This is useful when a new axis-aligned bounding box is needed for rotated geometry.\r\n     */\r\n    rotate(angle, point = Vector.Zero) {\r\n        const points = this.getPoints().map((p) => p.rotate(angle, point));\r\n        return BoundingBox.fromPoints(points);\r\n    }\r\n    scale(scale, point = Vector.Zero) {\r\n        const shifted = this.translate(point);\r\n        return new BoundingBox(shifted.left * scale.x, shifted.top * scale.y, shifted.right * scale.x, shifted.bottom * scale.y);\r\n    }\r\n    transform(matrix) {\r\n        const points = this.getPoints().map((p) => matrix.multv(p));\r\n        return BoundingBox.fromPoints(points);\r\n    }\r\n    /**\r\n     * Returns the perimeter of the bounding box\r\n     */\r\n    getPerimeter() {\r\n        const wx = this.width;\r\n        const wy = this.height;\r\n        return 2 * (wx + wy);\r\n    }\r\n    getPoints() {\r\n        const results = [];\r\n        results.push(new Vector(this.left, this.top));\r\n        results.push(new Vector(this.right, this.top));\r\n        results.push(new Vector(this.right, this.bottom));\r\n        results.push(new Vector(this.left, this.bottom));\r\n        return results;\r\n    }\r\n    /**\r\n     * Determines whether a ray intersects with a bounding box\r\n     */\r\n    rayCast(ray, farClipDistance = Infinity) {\r\n        // algorithm from https://tavianator.com/fast-branchless-raybounding-box-intersections/\r\n        let tmin = -Infinity;\r\n        let tmax = +Infinity;\r\n        const xinv = ray.dir.x === 0 ? Number.MAX_VALUE : 1 / ray.dir.x;\r\n        const yinv = ray.dir.y === 0 ? Number.MAX_VALUE : 1 / ray.dir.y;\r\n        const tx1 = (this.left - ray.pos.x) * xinv;\r\n        const tx2 = (this.right - ray.pos.x) * xinv;\r\n        tmin = Math.min(tx1, tx2);\r\n        tmax = Math.max(tx1, tx2);\r\n        const ty1 = (this.top - ray.pos.y) * yinv;\r\n        const ty2 = (this.bottom - ray.pos.y) * yinv;\r\n        tmin = Math.max(tmin, Math.min(ty1, ty2));\r\n        tmax = Math.min(tmax, Math.max(ty1, ty2));\r\n        return tmax >= Math.max(0, tmin) && tmin < farClipDistance;\r\n    }\r\n    rayCastTime(ray, farClipDistance = Infinity) {\r\n        // algorithm from https://tavianator.com/fast-branchless-raybounding-box-intersections/\r\n        let tmin = -Infinity;\r\n        let tmax = +Infinity;\r\n        const xinv = ray.dir.x === 0 ? Number.MAX_VALUE : 1 / ray.dir.x;\r\n        const yinv = ray.dir.y === 0 ? Number.MAX_VALUE : 1 / ray.dir.y;\r\n        const tx1 = (this.left - ray.pos.x) * xinv;\r\n        const tx2 = (this.right - ray.pos.x) * xinv;\r\n        tmin = Math.min(tx1, tx2);\r\n        tmax = Math.max(tx1, tx2);\r\n        const ty1 = (this.top - ray.pos.y) * yinv;\r\n        const ty2 = (this.bottom - ray.pos.y) * yinv;\r\n        tmin = Math.max(tmin, Math.min(ty1, ty2));\r\n        tmax = Math.min(tmax, Math.max(ty1, ty2));\r\n        if (tmax >= Math.max(0, tmin) && tmin < farClipDistance) {\r\n            return tmin;\r\n        }\r\n        return -1;\r\n    }\r\n    contains(val) {\r\n        if (val instanceof Vector) {\r\n            return this.left <= val.x && this.top <= val.y && this.bottom >= val.y && this.right >= val.x;\r\n        }\r\n        else if (val instanceof BoundingBox) {\r\n            if (this.left < val.left && this.top < val.top && val.bottom < this.bottom && val.right < this.right) {\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n        return false;\r\n    }\r\n    /**\r\n     * Combines this bounding box and another together returning a new bounding box\r\n     * @param other  The bounding box to combine\r\n     */\r\n    combine(other) {\r\n        const compositeBB = new BoundingBox(Math.min(this.left, other.left), Math.min(this.top, other.top), Math.max(this.right, other.right), Math.max(this.bottom, other.bottom));\r\n        return compositeBB;\r\n    }\r\n    get dimensions() {\r\n        return new Vector(this.width, this.height);\r\n    }\r\n    /**\r\n     * Test wether this bounding box intersects with another returning\r\n     * the intersection vector that can be used to resolve the collision. If there\r\n     * is no intersection null is returned.\r\n     *\r\n     * @param other  Other [[BoundingBox]] to test intersection with\r\n     * @returns A Vector in the direction of the current BoundingBox, this <- other\r\n     */\r\n    intersect(other) {\r\n        const totalBoundingBox = this.combine(other);\r\n        // If the total bounding box is less than or equal the sum of the 2 bounds then there is collision\r\n        if (totalBoundingBox.width < other.width + this.width &&\r\n            totalBoundingBox.height < other.height + this.height &&\r\n            !totalBoundingBox.dimensions.equals(other.dimensions) &&\r\n            !totalBoundingBox.dimensions.equals(this.dimensions)) {\r\n            // collision\r\n            let overlapX = 0;\r\n            // right edge is between the other's left and right edge\r\n            /**\r\n             *     +-this-+\r\n             *     |      |\r\n             *     |    +-other-+\r\n             *     +----|-+     |\r\n             *          |       |\r\n             *          +-------+\r\n             *         <---\r\n             *          ^ overlap\r\n             */\r\n            if (this.right >= other.left && this.right <= other.right) {\r\n                overlapX = other.left - this.right;\r\n                // right edge is past the other's right edge\r\n                /**\r\n                 *     +-other-+\r\n                 *     |       |\r\n                 *     |    +-this-+\r\n                 *     +----|--+   |\r\n                 *          |      |\r\n                 *          +------+\r\n                 *          --->\r\n                 *          ^ overlap\r\n                 */\r\n            }\r\n            else {\r\n                overlapX = other.right - this.left;\r\n            }\r\n            let overlapY = 0;\r\n            // top edge is between the other's top and bottom edge\r\n            /**\r\n             *     +-other-+\r\n             *     |       |\r\n             *     |    +-this-+   | <- overlap\r\n             *     +----|--+   |   |\r\n             *          |      |  \\ /\r\n             *          +------+   '\r\n             */\r\n            if (this.top <= other.bottom && this.top >= other.top) {\r\n                overlapY = other.bottom - this.top;\r\n                // top edge is above the other top edge\r\n                /**\r\n                 *     +-this-+         .\r\n                 *     |      |        / \\\r\n                 *     |    +-other-+   | <- overlap\r\n                 *     +----|-+     |   |\r\n                 *          |       |\r\n                 *          +-------+\r\n                 */\r\n            }\r\n            else {\r\n                overlapY = other.top - this.bottom;\r\n            }\r\n            if (Math.abs(overlapX) < Math.abs(overlapY)) {\r\n                return new Vector(overlapX, 0);\r\n            }\r\n            else {\r\n                return new Vector(0, overlapY);\r\n            }\r\n            // Case of total containment of one bounding box by another\r\n        }\r\n        else if (totalBoundingBox.dimensions.equals(other.dimensions) || totalBoundingBox.dimensions.equals(this.dimensions)) {\r\n            let overlapX = 0;\r\n            // this is wider than the other\r\n            if (this.width - other.width >= 0) {\r\n                // This right edge is closest to the others right edge\r\n                if (this.right - other.right <= other.left - this.left) {\r\n                    overlapX = other.left - this.right;\r\n                    // This left edge is closest to the others left edge\r\n                }\r\n                else {\r\n                    overlapX = other.right - this.left;\r\n                }\r\n                // other is wider than this\r\n            }\r\n            else {\r\n                // This right edge is closest to the others right edge\r\n                if (other.right - this.right <= this.left - other.left) {\r\n                    overlapX = this.left - other.right;\r\n                    // This left edge is closest to the others left edge\r\n                }\r\n                else {\r\n                    overlapX = this.right - other.left;\r\n                }\r\n            }\r\n            let overlapY = 0;\r\n            // this is taller than other\r\n            if (this.height - other.height >= 0) {\r\n                // The bottom edge is closest to the others bottom edge\r\n                if (this.bottom - other.bottom <= other.top - this.top) {\r\n                    overlapY = other.top - this.bottom;\r\n                }\r\n                else {\r\n                    overlapY = other.bottom - this.top;\r\n                }\r\n                // other is taller than this\r\n            }\r\n            else {\r\n                // The bottom edge is closest to the others bottom edge\r\n                if (other.bottom - this.bottom <= this.top - other.top) {\r\n                    overlapY = this.top - other.bottom;\r\n                }\r\n                else {\r\n                    overlapY = this.bottom - other.top;\r\n                }\r\n            }\r\n            if (Math.abs(overlapX) < Math.abs(overlapY)) {\r\n                return new Vector(overlapX, 0);\r\n            }\r\n            else {\r\n                return new Vector(0, overlapY);\r\n            }\r\n        }\r\n        else {\r\n            return null;\r\n        }\r\n    }\r\n    /**\r\n     * Test whether the bounding box has intersected with another bounding box, returns the side of the current bb that intersected.\r\n     * @param bb The other actor to test\r\n     */\r\n    intersectWithSide(bb) {\r\n        const intersect = this.intersect(bb);\r\n        return BoundingBox.getSideFromIntersection(intersect);\r\n    }\r\n    /* istanbul ignore next */\r\n    debugDraw(ctx, color = Color.Yellow) {\r\n        ctx.strokeStyle = color.toString();\r\n        ctx.strokeRect(this.left, this.top, this.width, this.height);\r\n    }\r\n    /**\r\n     * Draw a debug bounding box\r\n     * @param ex\r\n     * @param color\r\n     */\r\n    draw(ex, color = Color.Yellow) {\r\n        ex.debug.drawRect(this.left, this.top, this.width, this.height, { color });\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/matrix.ts\n\r\n\r\n\r\nvar MatrixLocations;\r\n(function (MatrixLocations) {\r\n    MatrixLocations[MatrixLocations[\"X\"] = 12] = \"X\";\r\n    MatrixLocations[MatrixLocations[\"Y\"] = 13] = \"Y\";\r\n})(MatrixLocations || (MatrixLocations = {}));\r\nconst sign = (val) => {\r\n    if (val === 0) {\r\n        return 0;\r\n    }\r\n    return val < 0 ? -1 : 1;\r\n};\r\n// const multMatch = (a: number, b: number) => {\r\n//   if (sign(a) < 0 && sign(b) < 0) {\r\n//     return -Math.abs(a * b);\r\n//   }\r\n//   return a * b;\r\n// }\r\n// const epsilon = (val: number) => {\r\n//   if (val * val < .0001) {\r\n//     return 0;\r\n//   }\r\n//   return val;\r\n// }\r\n/**\r\n * Excalibur Matrix helper for 4x4 matrices\r\n *\r\n * Useful for webgl 4x4 matrices\r\n */\r\nclass Matrix {\r\n    constructor() {\r\n        /**\r\n         *  4x4 matrix in column major order\r\n         *\r\n         * |         |         |          |          |\r\n         * | ------- | ------- | -------- |          |\r\n         * | data[0] | data[4] | data[8]  | data[12] |\r\n         * | data[1] | data[5] | data[9]  | data[13] |\r\n         * | data[2] | data[6] | data[10] | data[14] |\r\n         * | data[3] | data[7] | data[11] | data[15] |\r\n         *\r\n         */\r\n        this.data = new Float32Array(16);\r\n        this._scaleSignX = 1;\r\n        this._scaleSignY = 1;\r\n    }\r\n    /**\r\n     * Creates an orthographic (flat non-perspective) projection\r\n     * https://en.wikipedia.org/wiki/Orthographic_projection\r\n     * @param left\r\n     * @param right\r\n     * @param bottom\r\n     * @param top\r\n     * @param near\r\n     * @param far\r\n     */\r\n    static ortho(left, right, bottom, top, near, far) {\r\n        const mat = new Matrix();\r\n        mat.data[0] = 2 / (right - left);\r\n        mat.data[1] = 0;\r\n        mat.data[2] = 0;\r\n        mat.data[3] = 0;\r\n        mat.data[4] = 0;\r\n        mat.data[5] = 2 / (top - bottom);\r\n        mat.data[6] = 0;\r\n        mat.data[7] = 0;\r\n        mat.data[8] = 0;\r\n        mat.data[9] = 0;\r\n        mat.data[10] = -2 / (far - near);\r\n        mat.data[11] = 0;\r\n        mat.data[12] = -(right + left) / (right - left);\r\n        mat.data[13] = -(top + bottom) / (top - bottom);\r\n        mat.data[14] = -(far + near) / (far - near);\r\n        mat.data[15] = 1;\r\n        return mat;\r\n    }\r\n    /**\r\n     * Creates a new Matrix with the same data as the current 4x4\r\n     */\r\n    clone() {\r\n        const mat = new Matrix();\r\n        mat.data[0] = this.data[0];\r\n        mat.data[1] = this.data[1];\r\n        mat.data[2] = this.data[2];\r\n        mat.data[3] = this.data[3];\r\n        mat.data[4] = this.data[4];\r\n        mat.data[5] = this.data[5];\r\n        mat.data[6] = this.data[6];\r\n        mat.data[7] = this.data[7];\r\n        mat.data[8] = this.data[8];\r\n        mat.data[9] = this.data[9];\r\n        mat.data[10] = this.data[10];\r\n        mat.data[11] = this.data[11];\r\n        mat.data[12] = this.data[12];\r\n        mat.data[13] = this.data[13];\r\n        mat.data[14] = this.data[14];\r\n        mat.data[15] = this.data[15];\r\n        return mat;\r\n    }\r\n    /**\r\n     * Creates a new identity matrix (a matrix that when applied does nothing)\r\n     */\r\n    static identity() {\r\n        const mat = new Matrix();\r\n        mat.data[0] = 1;\r\n        mat.data[1] = 0;\r\n        mat.data[2] = 0;\r\n        mat.data[3] = 0;\r\n        mat.data[4] = 0;\r\n        mat.data[5] = 1;\r\n        mat.data[6] = 0;\r\n        mat.data[7] = 0;\r\n        mat.data[8] = 0;\r\n        mat.data[9] = 0;\r\n        mat.data[10] = 1;\r\n        mat.data[11] = 0;\r\n        mat.data[12] = 0;\r\n        mat.data[13] = 0;\r\n        mat.data[14] = 0;\r\n        mat.data[15] = 1;\r\n        return mat;\r\n    }\r\n    /**\r\n     * Creates a brand new translation matrix at the specified 3d point\r\n     * @param x\r\n     * @param y\r\n     */\r\n    static translation(x, y) {\r\n        const mat = Matrix.identity();\r\n        mat.data[12] = x;\r\n        mat.data[13] = y;\r\n        return mat;\r\n    }\r\n    /**\r\n     * Creates a brand new scaling matrix with the specified scaling factor\r\n     * @param sx\r\n     * @param sy\r\n     */\r\n    static scale(sx, sy) {\r\n        const mat = Matrix.identity();\r\n        mat.data[0] = sx;\r\n        mat.data[5] = sy;\r\n        mat.data[10] = 1;\r\n        mat.data[15] = 1;\r\n        return mat;\r\n    }\r\n    /**\r\n     * Creates a brand new rotation matrix with the specified angle\r\n     * @param angleRadians\r\n     */\r\n    static rotation(angleRadians) {\r\n        const mat = Matrix.identity();\r\n        mat.data[0] = Math.cos(angleRadians);\r\n        mat.data[4] = -Math.sin(angleRadians);\r\n        mat.data[1] = Math.sin(angleRadians);\r\n        mat.data[5] = Math.cos(angleRadians);\r\n        return mat;\r\n    }\r\n    multv(other) {\r\n        const z = 0;\r\n        if (other instanceof Vector) {\r\n            return new Vector(other.x * this.data[0] + other.y * this.data[4] + z * this.data[6] + 1 * this.data[12], other.x * this.data[1] + other.y * this.data[5] + z * this.data[9] + 1 * this.data[13]);\r\n        }\r\n        else {\r\n            const dest = [\r\n                other[0] * this.data[0] + other[1] * this.data[4] + z * this.data[6] + 1 * this.data[12],\r\n                other[0] * this.data[1] + other[1] * this.data[5] + z * this.data[9] + 1 * this.data[13]\r\n            ];\r\n            return dest;\r\n        }\r\n    }\r\n    /**\r\n     * Multiplies the current matrix by another and returns the resulting matrix\r\n     * @param other\r\n     */\r\n    multm(other) {\r\n        const dest = new Matrix();\r\n        const a11 = this.data[0];\r\n        const a21 = this.data[1];\r\n        const a31 = this.data[2];\r\n        const a41 = this.data[3];\r\n        const a12 = this.data[4];\r\n        const a22 = this.data[5];\r\n        const a32 = this.data[6];\r\n        const a42 = this.data[7];\r\n        const a13 = this.data[8];\r\n        const a23 = this.data[9];\r\n        const a33 = this.data[10];\r\n        const a43 = this.data[11];\r\n        const a14 = this.data[12];\r\n        const a24 = this.data[13];\r\n        const a34 = this.data[14];\r\n        const a44 = this.data[15];\r\n        const b11 = other.data[0];\r\n        const b21 = other.data[1];\r\n        const b31 = other.data[2];\r\n        const b41 = other.data[3];\r\n        const b12 = other.data[4];\r\n        const b22 = other.data[5];\r\n        const b32 = other.data[6];\r\n        const b42 = other.data[7];\r\n        const b13 = other.data[8];\r\n        const b23 = other.data[9];\r\n        const b33 = other.data[10];\r\n        const b43 = other.data[11];\r\n        const b14 = other.data[12];\r\n        const b24 = other.data[13];\r\n        const b34 = other.data[14];\r\n        const b44 = other.data[15];\r\n        dest.data[0] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;\r\n        dest.data[1] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;\r\n        dest.data[2] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;\r\n        dest.data[3] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;\r\n        dest.data[4] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;\r\n        dest.data[5] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;\r\n        dest.data[6] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;\r\n        dest.data[7] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;\r\n        dest.data[8] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;\r\n        dest.data[9] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;\r\n        dest.data[10] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;\r\n        dest.data[11] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;\r\n        dest.data[12] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;\r\n        dest.data[13] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;\r\n        dest.data[14] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;\r\n        dest.data[15] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;\r\n        const s = this.getScale();\r\n        dest._scaleSignX = sign(s.x) * sign(dest._scaleSignX);\r\n        dest._scaleSignY = sign(s.y) * sign(dest._scaleSignY);\r\n        return dest;\r\n    }\r\n    /**\r\n     * Applies translation to the current matrix mutating it\r\n     * @param x\r\n     * @param y\r\n     */\r\n    translate(x, y) {\r\n        const a11 = this.data[0];\r\n        const a21 = this.data[1];\r\n        const a31 = this.data[2];\r\n        const a41 = this.data[3];\r\n        const a12 = this.data[4];\r\n        const a22 = this.data[5];\r\n        const a32 = this.data[6];\r\n        const a42 = this.data[7];\r\n        const a13 = this.data[8];\r\n        const a23 = this.data[9];\r\n        const a33 = this.data[10];\r\n        const a43 = this.data[11];\r\n        const a14 = this.data[12];\r\n        const a24 = this.data[13];\r\n        const a34 = this.data[14];\r\n        const a44 = this.data[15];\r\n        // Doesn't change z\r\n        const z = 0;\r\n        const w = 1;\r\n        this.data[12] = a11 * x + a12 * y + a13 * z + a14 * w;\r\n        this.data[13] = a21 * x + a22 * y + a23 * z + a24 * w;\r\n        this.data[14] = a31 * x + a32 * y + a33 * z + a34 * w;\r\n        this.data[15] = a41 * x + a42 * y + a43 * z + a44 * w;\r\n        return this;\r\n    }\r\n    setPosition(x, y) {\r\n        this.data[12] = x;\r\n        this.data[13] = y;\r\n    }\r\n    getPosition() {\r\n        return vec(this.data[12], this.data[13]);\r\n    }\r\n    /**\r\n     * Applies rotation to the current matrix mutating it\r\n     * @param angle in Radians\r\n     */\r\n    rotate(angle) {\r\n        const a11 = this.data[0];\r\n        const a21 = this.data[1];\r\n        const a31 = this.data[2];\r\n        const a41 = this.data[3];\r\n        const a12 = this.data[4];\r\n        const a22 = this.data[5];\r\n        const a32 = this.data[6];\r\n        const a42 = this.data[7];\r\n        const sine = Math.sin(angle);\r\n        const cosine = Math.cos(angle);\r\n        this.data[0] = cosine * a11 + sine * a12;\r\n        this.data[1] = cosine * a21 + sine * a22;\r\n        this.data[2] = cosine * a31 + sine * a32;\r\n        this.data[3] = cosine * a41 + sine * a42;\r\n        this.data[4] = cosine * a12 - sine * a11;\r\n        this.data[5] = cosine * a22 - sine * a21;\r\n        this.data[6] = cosine * a32 - sine * a31;\r\n        this.data[7] = cosine * a42 - sine * a41;\r\n        return this;\r\n    }\r\n    /**\r\n     * Applies scaling to the current matrix mutating it\r\n     * @param x\r\n     * @param y\r\n     */\r\n    scale(x, y) {\r\n        const a11 = this.data[0];\r\n        const a21 = this.data[1];\r\n        const a31 = this.data[2];\r\n        const a41 = this.data[3];\r\n        const a12 = this.data[4];\r\n        const a22 = this.data[5];\r\n        const a32 = this.data[6];\r\n        const a42 = this.data[7];\r\n        this.data[0] = a11 * x;\r\n        this.data[1] = a21 * x;\r\n        this.data[2] = a31 * x;\r\n        this.data[3] = a41 * x;\r\n        this.data[4] = a12 * y;\r\n        this.data[5] = a22 * y;\r\n        this.data[6] = a32 * y;\r\n        this.data[7] = a42 * y;\r\n        return this;\r\n    }\r\n    setRotation(angle) {\r\n        const currentScale = this.getScale();\r\n        const sine = Math.sin(angle);\r\n        const cosine = Math.cos(angle);\r\n        this.data[0] = cosine * currentScale.x;\r\n        this.data[1] = sine * currentScale.y;\r\n        this.data[4] = -sine * currentScale.x;\r\n        this.data[5] = cosine * currentScale.y;\r\n    }\r\n    getRotation() {\r\n        const angle = Math.atan2(this.data[1] / this.getScaleY(), this.data[0] / this.getScaleX());\r\n        return canonicalizeAngle(angle);\r\n    }\r\n    getScaleX() {\r\n        // absolute scale of the matrix (we lose sign so need to add it back)\r\n        const xscale = vec(this.data[0], this.data[4]).size;\r\n        return this._scaleSignX * xscale;\r\n    }\r\n    getScaleY() {\r\n        // absolute scale of the matrix (we lose sign so need to add it back)\r\n        const yscale = vec(this.data[1], this.data[5]).size;\r\n        return this._scaleSignY * yscale;\r\n    }\r\n    /**\r\n     * Get the scale of the matrix\r\n     */\r\n    getScale() {\r\n        return vec(this.getScaleX(), this.getScaleY());\r\n    }\r\n    setScaleX(val) {\r\n        this._scaleSignX = sign(val);\r\n        // negative scale acts like a 180 rotation, so flip\r\n        const xscale = vec(this.data[0] * this._scaleSignX, this.data[4] * this._scaleSignX).normalize();\r\n        this.data[0] = xscale.x * val;\r\n        this.data[4] = xscale.y * val;\r\n    }\r\n    setScaleY(val) {\r\n        this._scaleSignY = sign(val);\r\n        // negative scale acts like a 180 rotation, so flip\r\n        const yscale = vec(this.data[1] * this._scaleSignY, this.data[5] * this._scaleSignY).normalize();\r\n        this.data[1] = yscale.x * val;\r\n        this.data[5] = yscale.y * val;\r\n    }\r\n    setScale(scale) {\r\n        this.setScaleX(scale.x);\r\n        this.setScaleY(scale.y);\r\n    }\r\n    /**\r\n     * Determinant of the upper left 2x2 matrix\r\n     */\r\n    getBasisDeterminant() {\r\n        return this.data[0] * this.data[5] - this.data[1] * this.data[4];\r\n    }\r\n    getAffineInverse() {\r\n        // See http://negativeprobability.blogspot.com/2011/11/affine-transformations-and-their.html\r\n        // See https://www.mathsisfun.com/algebra/matrix-inverse.html\r\n        // Since we are actually only doing 2D transformations we can use this hack\r\n        // We don't actually use the 3rd or 4th dimension\r\n        const det = this.getBasisDeterminant();\r\n        const inverseDet = 1 / det; // todo zero check\r\n        const a = this.data[0];\r\n        const b = this.data[4];\r\n        const c = this.data[1];\r\n        const d = this.data[5];\r\n        const m = Matrix.identity();\r\n        // inverts rotation and scale\r\n        m.data[0] = d * inverseDet;\r\n        m.data[1] = -c * inverseDet;\r\n        m.data[4] = -b * inverseDet;\r\n        m.data[5] = a * inverseDet;\r\n        const tx = this.data[12];\r\n        const ty = this.data[13];\r\n        // invert translation\r\n        // transform translation into the matrix basis created by rot/scale\r\n        m.data[12] = -(tx * m.data[0] + ty * m.data[4]);\r\n        m.data[13] = -(tx * m.data[1] + ty * m.data[5]);\r\n        return m;\r\n    }\r\n    isIdentity() {\r\n        return (this.data[0] === 1 &&\r\n            this.data[1] === 0 &&\r\n            this.data[2] === 0 &&\r\n            this.data[3] === 0 &&\r\n            this.data[4] === 0 &&\r\n            this.data[5] === 1 &&\r\n            this.data[6] === 0 &&\r\n            this.data[7] === 0 &&\r\n            this.data[8] === 0 &&\r\n            this.data[9] === 0 &&\r\n            this.data[10] === 1 &&\r\n            this.data[11] === 0 &&\r\n            this.data[12] === 0 &&\r\n            this.data[13] === 0 &&\r\n            this.data[14] === 0 &&\r\n            this.data[15] === 1);\r\n    }\r\n    toString() {\r\n        return `\n[${this.data[0]} ${this.data[4]} ${this.data[8]} ${this.data[12]}]\n[${this.data[1]} ${this.data[5]} ${this.data[9]} ${this.data[13]}]\n[${this.data[2]} ${this.data[6]} ${this.data[10]} ${this.data[14]}]\n[${this.data[3]} ${this.data[7]} ${this.data[11]} ${this.data[15]}]\n`;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/transform-stack.ts\n\r\nclass TransformStack {\r\n    constructor() {\r\n        this._transforms = [];\r\n        this._currentTransform = Matrix.identity();\r\n    }\r\n    save() {\r\n        this._transforms.push(this._currentTransform);\r\n        this._currentTransform = this._currentTransform.clone();\r\n    }\r\n    restore() {\r\n        this._currentTransform = this._transforms.pop();\r\n    }\r\n    translate(x, y) {\r\n        return this._currentTransform.translate(x, y);\r\n    }\r\n    rotate(angle) {\r\n        return this._currentTransform.rotate(angle);\r\n    }\r\n    scale(x, y) {\r\n        return this._currentTransform.scale(x, y);\r\n    }\r\n    set current(matrix) {\r\n        this._currentTransform = matrix;\r\n    }\r\n    get current() {\r\n        return this._currentTransform;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/state-stack.ts\nclass StateStack {\r\n    constructor() {\r\n        this._states = [];\r\n        this._currentState = this._getDefaultState();\r\n    }\r\n    _getDefaultState() {\r\n        return {\r\n            opacity: 1\r\n        };\r\n    }\r\n    _cloneState() {\r\n        return {\r\n            opacity: this._currentState.opacity\r\n        };\r\n    }\r\n    save() {\r\n        this._states.push(this._currentState);\r\n        this._currentState = this._cloneState();\r\n    }\r\n    restore() {\r\n        this._currentState = this._states.pop();\r\n    }\r\n    get current() {\r\n        return this._currentState;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/shader.ts\n/**\r\n * Create a shader program for the Excalibur WebGL Graphics Context\r\n */\r\nclass Shader {\r\n    /**\r\n     * Create a shader program in excalibur\r\n     * @param _gl WebGL graphics context\r\n     * @param _vertexSource Vertex shader source as a string\r\n     * @param _fragmentSource Fragment shader source as a string\r\n     */\r\n    constructor(_gl, _vertexSource, _fragmentSource) {\r\n        this._gl = _gl;\r\n        this._vertexSource = _vertexSource;\r\n        this._fragmentSource = _fragmentSource;\r\n        this.program = null;\r\n        this.uniforms = {};\r\n        this.attributes = {};\r\n        this.layout = [];\r\n        this.compile(_gl);\r\n    }\r\n    _createProgram(gl, vertexShader, fragmentShader) {\r\n        const program = gl.createProgram();\r\n        if (program === null) {\r\n            throw Error('Could not create graphics shader program');\r\n        }\r\n        // attach the shaders.\r\n        gl.attachShader(program, vertexShader);\r\n        gl.attachShader(program, fragmentShader);\r\n        // link the program.\r\n        gl.linkProgram(program);\r\n        const success = gl.getProgramParameter(program, gl.LINK_STATUS);\r\n        if (!success) {\r\n            throw Error(`Could not link the program: [${gl.getProgramInfoLog(program)}]`);\r\n        }\r\n        return program;\r\n    }\r\n    _compileShader(gl, source, type) {\r\n        const shader = gl.createShader(type);\r\n        if (shader === null) {\r\n            throw Error(`Could not build shader: [${source}]`);\r\n        }\r\n        gl.shaderSource(shader, source);\r\n        gl.compileShader(shader);\r\n        const success = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\r\n        if (!success) {\r\n            throw Error(`Could not compile shader [${gl.getShaderInfoLog(shader)}]`);\r\n        }\r\n        return shader;\r\n    }\r\n    /**\r\n     * Compile the current shader against a webgl context\r\n     * @param gl WebGL context\r\n     */\r\n    compile(gl) {\r\n        const vertexShader = this._compileShader(gl, this._vertexSource, gl.VERTEX_SHADER);\r\n        const fragmentShader = this._compileShader(gl, this._fragmentSource, gl.FRAGMENT_SHADER);\r\n        const program = this._createProgram(gl, vertexShader, fragmentShader);\r\n        return (this.program = program);\r\n    }\r\n    /**\r\n     * Add a uniform [[Matrix]] to the shader\r\n     * @param name Name of the uniform in the shader source\r\n     * @param data (4x4) matrix in column major order\r\n     */\r\n    addUniformMatrix(name, data) {\r\n        if (!data) {\r\n            throw Error(`Shader Uniform Matrix '${name}' was set to null or undefined`);\r\n        }\r\n        const gl = this._gl;\r\n        this.uniforms[name] = {\r\n            name,\r\n            type: 'matrix',\r\n            location: gl.getUniformLocation(this.program, name),\r\n            data: data\r\n        };\r\n    }\r\n    /**\r\n     * Add a uniform array of numbers to the shader\r\n     * @param name Name of the uniform in the shader source\r\n     * @param data List of numbers\r\n     */\r\n    addUniformIntegerArray(name, data) {\r\n        if (!data) {\r\n            throw Error(`Shader Uniform Integery Array '${name}' was set to null or undefined`);\r\n        }\r\n        const gl = this._gl;\r\n        this.uniforms[name] = {\r\n            name,\r\n            type: 'numbers',\r\n            location: gl.getUniformLocation(this.program, name),\r\n            data: data\r\n        };\r\n    }\r\n    /**\r\n     * Add attributes in the order they appear in the VBO\r\n     * @param name Name of the attribute in the shader source\r\n     * @param size The size of the attribute in gl.Type units, for example `vec2 a_pos` would be 2 gl.FLOAT\r\n     * @param glType The gl.Type of the attribute\r\n     */\r\n    addAttribute(name, size, glType, normalized = false) {\r\n        const gl = this._gl;\r\n        // TODO needs to be compiled first\r\n        const location = gl.getAttribLocation(this.program, name);\r\n        this.attributes[name] = {\r\n            name,\r\n            size,\r\n            glType,\r\n            normalized,\r\n            location\r\n        };\r\n        this.layout.push(this.attributes[name]);\r\n    }\r\n    /**\r\n     * Number of javascript floats a vertex will take up\r\n     */\r\n    get vertexAttributeSize() {\r\n        let vertexSize = 0;\r\n        for (const vert of this.layout) {\r\n            vertexSize += vert.size;\r\n        }\r\n        return vertexSize;\r\n    }\r\n    /**\r\n     * Total number of bytes that the vertex will take up\r\n     */\r\n    get totalVertexSizeBytes() {\r\n        let vertexSize = 0;\r\n        for (const vert of this.layout) {\r\n            let typeSize = 1;\r\n            switch (vert.glType) {\r\n                case this._gl.FLOAT: {\r\n                    typeSize = 4;\r\n                    break;\r\n                }\r\n                default: {\r\n                    typeSize = 1;\r\n                }\r\n            }\r\n            vertexSize += typeSize * vert.size;\r\n        }\r\n        return vertexSize;\r\n    }\r\n    /**\r\n     * Get a previously defined attribute size in bytes\r\n     * @param name\r\n     */\r\n    getAttributeSize(name) {\r\n        let typeSize = 1;\r\n        switch (this.attributes[name].glType) {\r\n            case this._gl.FLOAT: {\r\n                typeSize = 4;\r\n                break;\r\n            }\r\n            default: {\r\n                typeSize = 1;\r\n            }\r\n        }\r\n        return typeSize * this.attributes[name].size;\r\n    }\r\n    /**\r\n     * Sets this shader program as the current in the underlying webgl context\r\n     *\r\n     * **Must** specify all attributes and uniforms before calling this\r\n     */\r\n    use() {\r\n        const gl = this._gl;\r\n        gl.useProgram(this.program);\r\n        let offset = 0;\r\n        for (const vert of this.layout) {\r\n            gl.vertexAttribPointer(vert.location, vert.size, vert.glType, vert.normalized, this.totalVertexSizeBytes, offset);\r\n            gl.enableVertexAttribArray(vert.location);\r\n            offset += this.getAttributeSize(vert.name);\r\n        }\r\n        for (const key in this.uniforms) {\r\n            const uniform = this.uniforms[key];\r\n            switch (uniform.type) {\r\n                case 'matrix': {\r\n                    gl.uniformMatrix4fv(uniform.location, false, uniform.data);\r\n                    break;\r\n                }\r\n                case 'numbers': {\r\n                    gl.uniform1iv(uniform.location, uniform.data);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/shaders/line-vertex.glsl\n/* harmony default export */ const line_vertex = (\"attribute vec4 a_position;\\r\\nattribute vec4 a_color;\\r\\n\\r\\nvarying lowp vec4 v_color;\\r\\n\\r\\nuniform mat4 u_matrix;\\r\\n\\r\\n\\r\\nvoid main() {\\r\\n   // Set the vertex position using the ortho transform matrix\\r\\n   gl_Position = u_matrix * a_position;\\r\\n\\r\\n   // Passthrough the color\\r\\n   v_color = a_color;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/shaders/line-fragment.glsl\n/* harmony default export */ const line_fragment = (\"precision mediump float;\\r\\n\\r\\n// Color\\r\\nvarying lowp vec4 v_color;\\r\\n\\r\\n\\r\\nvoid main() {\\r\\n  gl_FragColor = v_color;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/batch.ts\nclass BatchCommand {\r\n    constructor(max) {\r\n        this.max = max;\r\n        this._pool = undefined;\r\n        this.commands = [];\r\n    }\r\n    isFull() {\r\n        if (this.commands.length >= this.max) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    canAdd() {\r\n        return !this.isFull();\r\n    }\r\n    add(cmd) {\r\n        this.commands.push(cmd);\r\n    }\r\n    dispose() {\r\n        this.commands.length = 0;\r\n        return this;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/GraphicsDiagnostics.ts\nclass GraphicsDiagnostics {\r\n    static clear() {\r\n        GraphicsDiagnostics.DrawCallCount = 0;\r\n        GraphicsDiagnostics.DrawnImagesCount = 0;\r\n    }\r\n}\r\nGraphicsDiagnostics.DrawCallCount = 0;\r\nGraphicsDiagnostics.DrawnImagesCount = 0;\r\n\n;// CONCATENATED MODULE: ./Util/Pool.ts\n\r\nclass Pool {\r\n    constructor(builder, recycler, maxObjects = 100) {\r\n        this.builder = builder;\r\n        this.recycler = recycler;\r\n        this.maxObjects = maxObjects;\r\n        this.totalAllocations = 0;\r\n        this.index = 0;\r\n        this.objects = [];\r\n        this._logger = Logger.getInstance();\r\n    }\r\n    /**\r\n     * Use many instances out of the in the context and return all to the pool.\r\n     *\r\n     * By returning values out of the contex they will be un-hooked from the pool and are free to be passed to consumers\r\n     * @param context\r\n     */\r\n    using(context) {\r\n        const result = context(this);\r\n        if (result) {\r\n            return this.done(...result);\r\n        }\r\n        return this.done();\r\n    }\r\n    /**\r\n     * Use a single instance out of th pool and immediately return it to the pool\r\n     * @param context\r\n     */\r\n    borrow(context) {\r\n        const object = this.get();\r\n        context(object);\r\n        this.index--;\r\n    }\r\n    /**\r\n     * Retrieve a value from the pool, will allocate a new instance if necessary or recycle from the pool\r\n     * @param args\r\n     */\r\n    get(...args) {\r\n        if (this.index === this.maxObjects) {\r\n            // TODO implement hard or soft cap\r\n            this._logger.warn('Max pooled objects reached, possible memory leak? Doubling');\r\n            this.maxObjects = this.maxObjects * 2;\r\n            // throw new Error('Max pooled objects reached, possible memory leak?');\r\n        }\r\n        if (this.objects[this.index]) {\r\n            // Pool has an available object already constructed\r\n            return this.recycler(this.objects[this.index++], ...args);\r\n        }\r\n        else {\r\n            // New allocation\r\n            this.totalAllocations++;\r\n            const object = (this.objects[this.index++] = this.builder(...args));\r\n            object._pool = this;\r\n            return object;\r\n        }\r\n    }\r\n    done(...objects) {\r\n        // All objects in pool now considered \"free\"\r\n        this.index = 0;\r\n        for (const object of objects) {\r\n            const poolIndex = this.objects.indexOf(object);\r\n            // Build a new object to take the pool place\r\n            this.objects[poolIndex] = this.builder(); // TODO problematic 0-arg only support\r\n            this.objects[poolIndex]._pool = this;\r\n            this.totalAllocations++;\r\n            // Unhook object from the pool\r\n            object._pool = undefined;\r\n        }\r\n        return objects;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/renderer.ts\n\r\n// import { Pool, Poolable } from './pool';\r\n\r\n\r\nclass BatchRenderer {\r\n    constructor(options) {\r\n        var _a, _b, _c;\r\n        this.priority = 0;\r\n        this._buffer = null;\r\n        this._maxCommandsPerBatch = 2000;\r\n        this._batches = [];\r\n        this._gl = options.gl;\r\n        const command = options.command;\r\n        this._verticesPerCommand = (_a = options === null || options === void 0 ? void 0 : options.verticesPerCommand) !== null && _a !== void 0 ? _a : 1;\r\n        this._maxCommandsPerBatch = (_b = options === null || options === void 0 ? void 0 : options.maxCommandsPerBatch) !== null && _b !== void 0 ? _b : this._maxCommandsPerBatch;\r\n        const batchFactory = (_c = options === null || options === void 0 ? void 0 : options.batchFactory) !== null && _c !== void 0 ? _c : (() => new BatchCommand(this._maxCommandsPerBatch));\r\n        this.commands = new Pool(() => new command(), (c) => c.dispose(), this._maxCommandsPerBatch);\r\n        this._batchPool = new Pool(batchFactory, (b) => b.dispose(), 100);\r\n    }\r\n    /**\r\n     * Initialize render, builds shader and initialized webgl buffers\r\n     */\r\n    init() {\r\n        const gl = this._gl;\r\n        this.shader = this.buildShader(gl);\r\n        // Initialize VBO\r\n        // https://groups.google.com/forum/#!topic/webgl-dev-list/vMNXSNRAg8M\r\n        this._vertices = new Float32Array(this.shader.vertexAttributeSize * this._verticesPerCommand * this._maxCommandsPerBatch);\r\n        this._buffer = gl.createBuffer();\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, this._buffer);\r\n        gl.bufferData(gl.ARRAY_BUFFER, this._vertices, gl.DYNAMIC_DRAW);\r\n    }\r\n    get vertexSize() {\r\n        return this.shader.vertexAttributeSize;\r\n    }\r\n    addCommand(cmd) {\r\n        if (this._batches.length === 0) {\r\n            this._batches.push(this._batchPool.get());\r\n        }\r\n        const lastBatch = this._batches[this._batches.length - 1];\r\n        if (lastBatch.canAdd()) {\r\n            lastBatch.add(cmd);\r\n        }\r\n        else {\r\n            const newBatch = this._batchPool.get();\r\n            newBatch.add(cmd);\r\n            this._batches.push(newBatch);\r\n        }\r\n    }\r\n    /**\r\n     * Build batch geometry, submit to the gpu, and issue draw command to underlying webgl\r\n     */\r\n    render() {\r\n        const gl = this._gl;\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, this._buffer);\r\n        this.shader.use();\r\n        let drawCallCount = 0;\r\n        let drawnImagesCount = 0;\r\n        for (const batch of this._batches) {\r\n            // Build all geometry and ship to GPU\r\n            // interleave VBOs https://goharsha.com/lwjgl-tutorial-series/interleaving-buffer-objects/\r\n            const vertexCount = this.buildBatchVertices(this._vertices, batch);\r\n            gl.bufferSubData(gl.ARRAY_BUFFER, 0, this._vertices);\r\n            this.renderBatch(gl, batch, vertexCount);\r\n            drawnImagesCount += batch.commands.length;\r\n            drawCallCount++;\r\n        }\r\n        this.commands.done();\r\n        this._batchPool.done();\r\n        this._batches.length = 0;\r\n        GraphicsDiagnostics.DrawCallCount += drawCallCount;\r\n        GraphicsDiagnostics.DrawnImagesCount += drawnImagesCount;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/line-renderer.ts\n\r\n\r\n\r\n\r\n\r\n\r\nclass DrawLine {\r\n    constructor() {\r\n        this.color = Color.Black;\r\n        this.start = Vector.Zero;\r\n        this.end = Vector.Zero;\r\n    }\r\n    dispose() {\r\n        this.color.r = 0;\r\n        this.color.g = 0;\r\n        this.color.b = 0;\r\n        this.color.a = 1;\r\n        this.start.setTo(0, 0);\r\n        this.end.setTo(0, 0);\r\n        return this;\r\n    }\r\n}\r\nclass LineRenderer extends BatchRenderer {\r\n    constructor(gl, _contextInfo) {\r\n        super({ gl, command: DrawLine, verticesPerCommand: 2 });\r\n        this._contextInfo = _contextInfo;\r\n        this.init();\r\n    }\r\n    buildShader(gl) {\r\n        const shader = new Shader(gl, line_vertex, line_fragment);\r\n        shader.addAttribute('a_position', 2, gl.FLOAT);\r\n        shader.addAttribute('a_color', 4, gl.FLOAT);\r\n        shader.addUniformMatrix('u_matrix', this._contextInfo.matrix.data);\r\n        return shader;\r\n    }\r\n    addLine(start, end, color) {\r\n        const cmd = this.commands.get();\r\n        cmd.start = this._contextInfo.transform.current.multv(start);\r\n        cmd.end = this._contextInfo.transform.current.multv(end);\r\n        cmd.color.r = color.r;\r\n        cmd.color.g = color.g;\r\n        cmd.color.b = color.b;\r\n        cmd.color.a = cmd.color.a * this._contextInfo.state.current.opacity;\r\n        this.addCommand(cmd);\r\n    }\r\n    buildBatchVertices(vertexBuffer, batch) {\r\n        let index = 0;\r\n        for (const command of batch.commands) {\r\n            // Start\r\n            vertexBuffer[index++] = command.start.x;\r\n            vertexBuffer[index++] = command.start.y;\r\n            vertexBuffer[index++] = command.color.r / 255;\r\n            vertexBuffer[index++] = command.color.g / 255;\r\n            vertexBuffer[index++] = command.color.b / 255;\r\n            vertexBuffer[index++] = command.color.a;\r\n            // End\r\n            vertexBuffer[index++] = command.end.x;\r\n            vertexBuffer[index++] = command.end.y;\r\n            vertexBuffer[index++] = command.color.r / 255;\r\n            vertexBuffer[index++] = command.color.g / 255;\r\n            vertexBuffer[index++] = command.color.b / 255;\r\n            vertexBuffer[index++] = command.color.a;\r\n        }\r\n        return index / this.vertexSize;\r\n    }\r\n    renderBatch(gl, _batch, vertexCount) {\r\n        gl.drawArrays(gl.LINES, 0, vertexCount);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/shaders/image-vertex.glsl\n/* harmony default export */ const image_vertex = (\"attribute vec4 a_position;\\r\\n\\r\\n// Opacity \\r\\nattribute float a_opacity;\\r\\nvarying float v_opacity;\\r\\n\\r\\nattribute vec4 a_color;\\r\\nvarying vec4 v_color;\\r\\n\\r\\n// UV coordinate\\r\\nattribute vec2 a_texcoord;\\r\\nvarying vec2 v_texcoord;\\r\\n\\r\\n// Texture number\\r\\nattribute lowp float a_textureIndex;\\r\\nvarying lowp float v_textureIndex;\\r\\n\\r\\nuniform mat4 u_matrix;\\r\\n\\r\\n\\r\\nvoid main() {\\r\\n   // Set the vertex position using the ortho transform matrix\\r\\n   gl_Position = u_matrix * a_position;\\r\\n\\r\\n   // Pass through the Opacity to the fragment shader\\r\\n   v_opacity = a_opacity;\\r\\n   // Pass through the UV coord to the fragment shader\\r\\n   v_texcoord = a_texcoord;\\r\\n   // Pass through the texture number to the fragment shader\\r\\n   v_textureIndex = a_textureIndex;\\r\\n   // Pass through the color to the fragment shader\\r\\n   v_color = a_color;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/shaders/image-fragment.glsl\n/* harmony default export */ const image_fragment = (\"#ifdef GL_OES_standard_derivatives\\r\\n#extension GL_OES_standard_derivatives : enable\\r\\n#endif\\r\\nprecision mediump float;\\r\\n\\r\\n// UV coord\\r\\nvarying vec2 v_texcoord;\\r\\n\\r\\n// Texture index\\r\\nvarying lowp float v_textureIndex;\\r\\n\\r\\n// Color coord to blend with image\\r\\nvarying lowp vec4 v_color;\\r\\n\\r\\n// Opacity\\r\\nvarying float v_opacity;\\r\\n\\r\\nuniform sampler2D u_textures[%%count%%];\\r\\n\\r\\nfloat circle(in vec2 st, in float radius) {\\r\\n  vec2 dist = st - vec2(0.5);\\r\\n  float r = dot(dist, dist) * 4.0;\\r\\n  float delta = fwidth(r);\\r\\n  return 1.0 - smoothstep(radius - delta, radius + delta, r);\\r\\n}\\r\\n\\r\\nvoid main() {\\r\\n  float r = 0.0, delta = 0.0, alpha = 1.0;\\r\\n   // In order to support the most efficient sprite batching, we have multiple\\r\\n   // textures loaded into the gpu (usually 8) this picker logic skips over textures\\r\\n   // that do not apply to a particular sprite.\\r\\n\\r\\n   vec4 color;\\r\\n   // -1 If there is no texture to sample we are drawing a solid geometry (rectangles)\\r\\n   if (v_textureIndex == -1.0) {\\r\\n     color = v_color;\\r\\n     color.w = color.w * v_opacity;\\r\\n   // -2 If there is no texture we are drawing a circle\\r\\n   } else if (v_textureIndex == -2.0) {\\r\\n     color = v_color;\\r\\n     color.a = color.a * circle(v_texcoord, .95);\\r\\n   } else {\\r\\n     // GLSL is templated out to pick the right texture and set the vec4 color\\r\\n      %%texture_picker%%\\r\\n   }\\r\\n   color.w = color.w * v_opacity;\\r\\n   gl_FragColor = color;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/draw-image-command.ts\n\r\nvar DrawCommandType;\r\n(function (DrawCommandType) {\r\n    DrawCommandType[\"Image\"] = \"image\";\r\n    DrawCommandType[\"Line\"] = \"line\";\r\n    DrawCommandType[\"Rectangle\"] = \"rectangle\";\r\n    DrawCommandType[\"Circle\"] = \"circle\";\r\n})(DrawCommandType || (DrawCommandType = {}));\r\nclass DrawImageCommand {\r\n    constructor(image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight) {\r\n        this._pool = undefined;\r\n        this.snapToPixel = true;\r\n        this.type = DrawCommandType.Image;\r\n        this.opacity = 1;\r\n        this.width = 0;\r\n        this.height = 0;\r\n        this.dest = [0, 0]; // x, y\r\n        this.view = [0, 0, 0, 0]; // sx, sy, sw, sh\r\n        this._geom = [\r\n            [0, 0],\r\n            [0, 0],\r\n            [0, 0],\r\n            [0, 0],\r\n            [0, 0],\r\n            [0, 0]\r\n        ];\r\n        this.init(image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight);\r\n    }\r\n    init(image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight) {\r\n        this.type = DrawCommandType.Image;\r\n        this.image = image;\r\n        this.width = (image === null || image === void 0 ? void 0 : image.width) || swidth || 0;\r\n        this.height = (image === null || image === void 0 ? void 0 : image.height) || sheight || 0;\r\n        this.view = [0, 0, swidth !== null && swidth !== void 0 ? swidth : image === null || image === void 0 ? void 0 : image.width, sheight !== null && sheight !== void 0 ? sheight : image === null || image === void 0 ? void 0 : image.height];\r\n        this.dest = [sx, sy];\r\n        // If destination is specified, update view and dest\r\n        if (dx !== undefined && dy !== undefined && dwidth !== undefined && dheight !== undefined) {\r\n            this.view = [sx, sy, swidth !== null && swidth !== void 0 ? swidth : image === null || image === void 0 ? void 0 : image.width, sheight !== null && sheight !== void 0 ? sheight : image === null || image === void 0 ? void 0 : image.height];\r\n            this.dest = [dx, dy];\r\n            this.width = dwidth;\r\n            this.height = dheight;\r\n        }\r\n        let index = 0;\r\n        this._geom[index++] = [this.dest[0], this.dest[1]];\r\n        this._geom[index++] = [this.dest[0], this.dest[1] + this.height];\r\n        this._geom[index++] = [this.dest[0] + this.width, this.dest[1]];\r\n        this._geom[index++] = [this.dest[0] + this.width, this.dest[1]];\r\n        this._geom[index++] = [this.dest[0], this.dest[1] + this.height];\r\n        this._geom[index++] = [this.dest[0] + this.width, this.dest[1] + this.height];\r\n        if (this.snapToPixel) {\r\n            for (const point of this._geom) {\r\n                point[0] = ~~point[0];\r\n                point[1] = ~~point[1];\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n    initRect(color, start, width, height) {\r\n        this.type = DrawCommandType.Rectangle;\r\n        this.color = color;\r\n        this.width = width;\r\n        this.height = height;\r\n        let index = 0;\r\n        this._geom[index++] = [start.x, start.y];\r\n        this._geom[index++] = [start.x, start.y + this.height];\r\n        this._geom[index++] = [start.x + this.width, start.y];\r\n        this._geom[index++] = [start.x + this.width, start.y];\r\n        this._geom[index++] = [start.x, start.y + this.height];\r\n        this._geom[index++] = [start.x + this.width, start.y + this.height];\r\n        if (this.snapToPixel) {\r\n            for (const point of this._geom) {\r\n                point[0] = ~~point[0];\r\n                point[1] = ~~point[1];\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n    initLine(color, start, end, thickness) {\r\n        this.type = DrawCommandType.Line;\r\n        this.color = color;\r\n        const dir = end.sub(start).normalize();\r\n        const normal = dir.perpendicular();\r\n        const halfThick = thickness / 2;\r\n        const startTop = normal.scale(halfThick).add(start);\r\n        const startBottom = normal.scale(-halfThick).add(start);\r\n        const endTop = normal.scale(halfThick).add(end);\r\n        const endBottom = normal.scale(-halfThick).add(end);\r\n        /**\r\n         *    +---------------------^----------------------+\r\n         *    |                     | (normal)             |\r\n         *   (startx, starty)------------------>(endx, endy)\r\n         *    |                                            |\r\n         *    + -------------------------------------------+\r\n         */\r\n        let index = 0;\r\n        this._geom[index++] = [startTop.x, startTop.y];\r\n        this._geom[index++] = [endTop.x, endTop.y];\r\n        this._geom[index++] = [startBottom.x, startBottom.y];\r\n        this._geom[index++] = [startBottom.x, startBottom.y];\r\n        this._geom[index++] = [endTop.x, endTop.y];\r\n        this._geom[index++] = [endBottom.x, endBottom.y];\r\n        if (this.snapToPixel) {\r\n            for (const point of this._geom) {\r\n                point[0] = ~~point[0];\r\n                point[1] = ~~point[1];\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n    initCircle(pos, radius, color) {\r\n        this.type = DrawCommandType.Circle;\r\n        this.color = color;\r\n        const topLeft = pos.add(vec(-radius, -radius));\r\n        const topRight = pos.add(vec(radius, -radius));\r\n        const bottomRight = pos.add(vec(radius, radius));\r\n        const bottomLeft = pos.add(vec(-radius, radius));\r\n        let index = 0;\r\n        this._geom[index++] = [topLeft.x, topLeft.y];\r\n        this._geom[index++] = [topRight.x, topRight.y];\r\n        this._geom[index++] = [bottomLeft.x, bottomLeft.y];\r\n        this._geom[index++] = [bottomLeft.x, bottomLeft.y];\r\n        this._geom[index++] = [topRight.x, topRight.y];\r\n        this._geom[index++] = [bottomRight.x, bottomRight.y];\r\n        if (this.snapToPixel) {\r\n            for (const point of this._geom) {\r\n                point[0] = ~~point[0];\r\n                point[1] = ~~point[1];\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n    dispose() {\r\n        this.image = null;\r\n        this.width = 0;\r\n        this.height = 0;\r\n        this.view = [0, 0, 0, 0];\r\n        this.dest = [0, 0];\r\n        let index = 0;\r\n        this._geom[index++] = [this.dest[0], this.dest[1]];\r\n        this._geom[index++] = [this.dest[0], this.dest[1] + this.height];\r\n        this._geom[index++] = [this.dest[0] + this.width, this.dest[1]];\r\n        this._geom[index++] = [this.dest[0] + this.width, this.dest[1]];\r\n        this._geom[index++] = [this.dest[0], this.dest[1] + this.height];\r\n        this._geom[index++] = [this.dest[0] + this.width, this.dest[1] + this.height];\r\n        return this;\r\n    }\r\n    // todo weird\r\n    applyTransform(transform, opacity) {\r\n        if (transform) {\r\n            for (let i = 0; i < this._geom.length; i++) {\r\n                this._geom[i] = transform.multv(this._geom[i]);\r\n                if (this.snapToPixel) {\r\n                    this._geom[i] = [~~this._geom[i][0], ~~this._geom[i][1]];\r\n                }\r\n            }\r\n        }\r\n        this.opacity = opacity;\r\n    }\r\n    get geometry() {\r\n        return this._geom;\r\n    }\r\n}\r\nclass DrawRectCommand {\r\n    constructor(x, y, width, height) {\r\n        this.dest = [0, 0];\r\n        this.width = 0;\r\n        this.height = 0;\r\n        this.dest = [x, y];\r\n        this.width = width;\r\n        this.height = height;\r\n    }\r\n}\r\nclass DrawDebugRectCommand {\r\n    constructor(bounds, color) {\r\n        this.bounds = bounds;\r\n        this.color = color;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/webgl-util.ts\n/**\r\n * Checks if the current number is a power of two\r\n */\r\nfunction isPowerOfTwo(x) {\r\n    return (x & (x - 1)) === 0;\r\n}\r\n/**\r\n * Returns the next highest power of two\r\n */\r\nfunction nextHighestPowerOfTwo(x) {\r\n    --x;\r\n    for (let i = 1; i < 32; i <<= 1) {\r\n        x = x | (x >> i);\r\n    }\r\n    return x + 1;\r\n}\r\n/**\r\n * Returns the input number if a power of two, otherwise the next highest power of two\r\n */\r\nfunction ensurePowerOfTwo(x) {\r\n    if (!isPowerOfTwo(x)) {\r\n        return nextHighestPowerOfTwo(x);\r\n    }\r\n    return x;\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/texture-loader.ts\n\r\n/**\r\n * Manages loading image sources into webgl textures, a unique id is associated with all sources\r\n */\r\nclass TextureLoader {\r\n    static registerContext(context) {\r\n        TextureLoader._GL = context;\r\n    }\r\n    /**\r\n     * Get the WebGL Texture from a source image\r\n     * @param image\r\n     */\r\n    static get(image) {\r\n        return TextureLoader._TEXTURE_MAP.get(image);\r\n    }\r\n    /**\r\n     * Returns whether a source image has been loaded as a texture\r\n     * @param image\r\n     */\r\n    static has(image) {\r\n        return TextureLoader._TEXTURE_MAP.has(image);\r\n    }\r\n    /**\r\n     * Loads a graphic into webgl and returns it's texture info, a webgl context must be previously registered\r\n     * @param image Source graphic\r\n     * @param forceUpdate Optionally force a texture to be reloaded, useful if the source graphic has changed\r\n     */\r\n    static load(image, forceUpdate = false) {\r\n        // Ignore loading if webgl is not registered\r\n        const gl = TextureLoader._GL;\r\n        if (!gl) {\r\n            return null;\r\n        }\r\n        let tex = null;\r\n        // If reuse the texture if it's from the same source\r\n        if (TextureLoader.has(image)) {\r\n            tex = TextureLoader.get(image);\r\n        }\r\n        // Update existing webgl texture and return early\r\n        if (tex) {\r\n            if (forceUpdate) {\r\n                gl.bindTexture(gl.TEXTURE_2D, tex);\r\n                const source = TextureLoader.toPowerOfTwoImage(image);\r\n                gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, source);\r\n            }\r\n            return tex;\r\n        }\r\n        // No texture exists create a new one\r\n        tex = gl.createTexture();\r\n        const source = TextureLoader.toPowerOfTwoImage(image);\r\n        gl.bindTexture(gl.TEXTURE_2D, tex);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n        // NEAREST for pixels\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\r\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, source);\r\n        TextureLoader._TEXTURE_MAP.set(image, tex);\r\n        return tex;\r\n    }\r\n    /**\r\n     * Converts source images into power of two images, WebGL only supports POT images\r\n     * https://www.khronos.org/webgl/wiki/WebGL_and_OpenGL_Differences#Non-Power_of_Two_Texture_Support\r\n     * @param image\r\n     */\r\n    static toPowerOfTwoImage(image) {\r\n        const potCanvas = TextureLoader._POT_CANVAS;\r\n        const potCtx = TextureLoader._POT_CTX;\r\n        if (!isPowerOfTwo(image.width) || !isPowerOfTwo(image.height)) {\r\n            // Scale up the texture to the next highest power of two dimensions.\r\n            potCanvas.width = ensurePowerOfTwo(image.width);\r\n            potCanvas.height = ensurePowerOfTwo(image.height);\r\n            potCtx.imageSmoothingEnabled = false;\r\n            potCtx.clearRect(0, 0, potCanvas.width, potCanvas.height);\r\n            potCtx.drawImage(image, 0, 0, image.width, image.height);\r\n            image = potCanvas;\r\n        }\r\n        return image;\r\n    }\r\n}\r\nTextureLoader._POT_CANVAS = document.createElement('canvas');\r\nTextureLoader._POT_CTX = TextureLoader._POT_CANVAS.getContext('2d');\r\nTextureLoader._TEXTURE_MAP = new Map();\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/image-renderer.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass BatchImage extends BatchCommand {\r\n    constructor(maxDraws, maxTextures) {\r\n        super(maxDraws);\r\n        this.maxDraws = maxDraws;\r\n        this.maxTextures = maxTextures;\r\n        this.textures = [];\r\n        this.commands = [];\r\n        this._graphicMap = {};\r\n    }\r\n    isFull() {\r\n        if (this.commands.length >= this.maxDraws) {\r\n            return true;\r\n        }\r\n        if (this.textures.length >= this.maxTextures) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    canAdd() {\r\n        if (this.commands.length >= this.maxDraws) {\r\n            return false;\r\n        }\r\n        if (this.textures.length < this.maxTextures) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    _isCommandFull() {\r\n        return this.commands.length >= this.maxDraws;\r\n    }\r\n    _isTextureFull() {\r\n        return this.textures.length >= this.maxTextures;\r\n    }\r\n    _wouldAddTexture(command) {\r\n        return !this._graphicMap[command.image.id];\r\n    }\r\n    maybeAdd(command) {\r\n        if ((this._isCommandFull() || this._isTextureFull()) && this._wouldAddTexture(command)) {\r\n            return false;\r\n        }\r\n        this.add(command);\r\n        return true;\r\n    }\r\n    add(command) {\r\n        if (command.type === DrawCommandType.Image) {\r\n            const texture = TextureLoader.load(command.image);\r\n            if (this.textures.indexOf(texture) === -1) {\r\n                this.textures.push(texture);\r\n            }\r\n        }\r\n        this.commands.push(command);\r\n    }\r\n    bindTextures(gl) {\r\n        // Bind textures in the correct order\r\n        for (let i = 0; i < this.maxTextures; i++) {\r\n            gl.activeTexture(gl.TEXTURE0 + i);\r\n            gl.bindTexture(gl.TEXTURE_2D, this.textures[i] || this.textures[0]);\r\n        }\r\n    }\r\n    getBatchTextureId(command) {\r\n        if (command.image) {\r\n            return this.textures.indexOf(TextureLoader.get(command.image));\r\n        }\r\n        return -1;\r\n    }\r\n    dispose() {\r\n        this.clear();\r\n        return this;\r\n    }\r\n    clear() {\r\n        this.commands.length = 0;\r\n        this.textures.length = 0;\r\n        this._graphicMap = {};\r\n    }\r\n}\r\nclass ImageRenderer extends BatchRenderer {\r\n    constructor(gl, _contextInfo) {\r\n        super({\r\n            gl,\r\n            command: DrawImageCommand,\r\n            // 6 verts per quad\r\n            verticesPerCommand: 6,\r\n            maxCommandsPerBatch: 2000,\r\n            batchFactory: () => new BatchImage(2000, gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS))\r\n        });\r\n        this._contextInfo = _contextInfo;\r\n        TextureLoader.registerContext(gl);\r\n        this.init();\r\n    }\r\n    buildShader(gl) {\r\n        // Initialilze default batch rendering shader\r\n        const maxGPUTextures = gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);\r\n        const shader = new Shader(gl, image_vertex, this._transformFragmentSource(image_fragment, maxGPUTextures));\r\n        shader.addAttribute('a_position', 3, gl.FLOAT);\r\n        shader.addAttribute('a_texcoord', 2, gl.FLOAT);\r\n        shader.addAttribute('a_textureIndex', 1, gl.FLOAT);\r\n        shader.addAttribute('a_opacity', 1, gl.FLOAT);\r\n        shader.addAttribute('a_color', 4, gl.FLOAT);\r\n        shader.addUniformMatrix('u_matrix', this._contextInfo.matrix.data);\r\n        // Initialize texture slots to [0, 1, 2, 3, 4, .... maxGPUTextures]\r\n        shader.addUniformIntegerArray('u_textures', [...Array(maxGPUTextures)].map((_, i) => i));\r\n        return shader;\r\n    }\r\n    _transformFragmentSource(source, maxTextures) {\r\n        let newSource = source.replace('%%count%%', maxTextures.toString());\r\n        let texturePickerBuilder = '';\r\n        for (let i = 0; i < maxTextures; i++) {\r\n            if (i === 0) {\r\n                texturePickerBuilder += `if (v_textureIndex <= ${i}.5) {\\n`;\r\n            }\r\n            else {\r\n                texturePickerBuilder += `   else if (v_textureIndex <= ${i}.5) {\\n`;\r\n            }\r\n            texturePickerBuilder += `      color = texture2D(u_textures[${i}], v_texcoord);\\n`;\r\n            texturePickerBuilder += `   }\\n`;\r\n        }\r\n        newSource = newSource.replace('%%texture_picker%%', texturePickerBuilder);\r\n        return newSource;\r\n    }\r\n    addCircle(pos, radius, color) {\r\n        const command = this.commands.get().initCircle(pos, radius, color);\r\n        command.applyTransform(this._contextInfo.transform.current, this._contextInfo.state.current.opacity);\r\n        this.addCommand(command);\r\n    }\r\n    addRectangle(color, pos, width, height) {\r\n        const command = this.commands.get().initRect(color, pos, width, height);\r\n        command.applyTransform(this._contextInfo.transform.current, this._contextInfo.state.current.opacity);\r\n        this.addCommand(command);\r\n    }\r\n    addLine(color, start, end, thickness = 1) {\r\n        const command = this.commands.get().initLine(color, start, end, thickness);\r\n        command.applyTransform(this._contextInfo.transform.current, this._contextInfo.state.current.opacity);\r\n        this.addCommand(command);\r\n    }\r\n    addImage(graphic, sx, sy, swidth, sheight, dx, dy, dwidth, dheight) {\r\n        const command = this.commands.get().init(graphic, sx, sy, swidth, sheight, dx, dy, dwidth, dheight);\r\n        command.applyTransform(this._contextInfo.transform.current, this._contextInfo.state.current.opacity);\r\n        this.addCommand(command);\r\n    }\r\n    renderBatch(gl, batch, vertexCount) {\r\n        // Bind textures in the correct order\r\n        batch.bindTextures(gl);\r\n        // draw the quads\r\n        gl.drawArrays(gl.TRIANGLES, 0, vertexCount);\r\n    }\r\n    buildBatchVertices(vertexBuffer, batch) {\r\n        var _a, _b;\r\n        let vertIndex = 0;\r\n        let sx = 0;\r\n        let sy = 0;\r\n        let sw = 0;\r\n        let sh = 0;\r\n        let potWidth = 1;\r\n        let potHeight = 1;\r\n        let textureId = 0;\r\n        let commandColor = Color.Transparent;\r\n        for (const command of batch.commands) {\r\n            sx = command.view[0];\r\n            sy = command.view[1];\r\n            sw = command.view[2];\r\n            sh = command.view[3];\r\n            potWidth = ensurePowerOfTwo(((_a = command.image) === null || _a === void 0 ? void 0 : _a.width) || command.width);\r\n            potHeight = ensurePowerOfTwo(((_b = command.image) === null || _b === void 0 ? void 0 : _b.height) || command.height);\r\n            textureId = batch.getBatchTextureId(command);\r\n            if (command.type === DrawCommandType.Line || command.type === DrawCommandType.Rectangle) {\r\n                textureId = -1; // sentinel for no image rect\r\n                commandColor = command.color;\r\n            }\r\n            if (command.type === DrawCommandType.Circle) {\r\n                textureId = -2; // sentinel for circle\r\n                commandColor = command.color;\r\n            }\r\n            // potential optimization when divding by 2 (bitshift)\r\n            // Modifying the images to poweroftwo images warp the UV coordinates\r\n            let uvx0 = sx / potWidth;\r\n            let uvy0 = sy / potHeight;\r\n            let uvx1 = (sx + sw) / potWidth;\r\n            let uvy1 = (sy + sh) / potHeight;\r\n            if (textureId === -2) {\r\n                uvx0 = 0;\r\n                uvy0 = 0;\r\n                uvx1 = 1;\r\n                uvy1 = 1;\r\n            }\r\n            // Quad update\r\n            // (0, 0, z) z-index doesn't work in batch rendering between batches\r\n            vertexBuffer[vertIndex++] = command.geometry[0][0]; // x + 0 * width;\r\n            vertexBuffer[vertIndex++] = command.geometry[0][1]; //y + 0 * height;\r\n            vertexBuffer[vertIndex++] = 0;\r\n            // UV coords\r\n            vertexBuffer[vertIndex++] = uvx0; // 0;\r\n            vertexBuffer[vertIndex++] = uvy0; // 0;\r\n            // texture id\r\n            vertexBuffer[vertIndex++] = textureId;\r\n            // opacity\r\n            vertexBuffer[vertIndex++] = command.opacity;\r\n            // color\r\n            vertexBuffer[vertIndex++] = commandColor.r / 255;\r\n            vertexBuffer[vertIndex++] = commandColor.g / 255;\r\n            vertexBuffer[vertIndex++] = commandColor.b / 255;\r\n            vertexBuffer[vertIndex++] = commandColor.a;\r\n            // (0, 1)\r\n            vertexBuffer[vertIndex++] = command.geometry[1][0]; // x + 0 * width;\r\n            vertexBuffer[vertIndex++] = command.geometry[1][1]; // y + 1 * height;\r\n            vertexBuffer[vertIndex++] = 0;\r\n            // UV coords\r\n            vertexBuffer[vertIndex++] = uvx0; // 0;\r\n            vertexBuffer[vertIndex++] = uvy1; // 1;\r\n            // texture id\r\n            vertexBuffer[vertIndex++] = textureId;\r\n            // opacity\r\n            vertexBuffer[vertIndex++] = command.opacity;\r\n            // color\r\n            vertexBuffer[vertIndex++] = commandColor.r / 255;\r\n            vertexBuffer[vertIndex++] = commandColor.g / 255;\r\n            vertexBuffer[vertIndex++] = commandColor.b / 255;\r\n            vertexBuffer[vertIndex++] = commandColor.a;\r\n            // (1, 0)\r\n            vertexBuffer[vertIndex++] = command.geometry[2][0]; // x + 1 * width;\r\n            vertexBuffer[vertIndex++] = command.geometry[2][1]; // y + 0 * height;\r\n            vertexBuffer[vertIndex++] = 0;\r\n            // UV coords\r\n            vertexBuffer[vertIndex++] = uvx1; //1;\r\n            vertexBuffer[vertIndex++] = uvy0; //0;\r\n            // texture id\r\n            vertexBuffer[vertIndex++] = textureId;\r\n            // opacity\r\n            vertexBuffer[vertIndex++] = command.opacity;\r\n            // color\r\n            vertexBuffer[vertIndex++] = commandColor.r / 255;\r\n            vertexBuffer[vertIndex++] = commandColor.g / 255;\r\n            vertexBuffer[vertIndex++] = commandColor.b / 255;\r\n            vertexBuffer[vertIndex++] = commandColor.a;\r\n            // (1, 0)\r\n            vertexBuffer[vertIndex++] = command.geometry[3][0]; // x + 1 * width;\r\n            vertexBuffer[vertIndex++] = command.geometry[3][1]; // y + 0 * height;\r\n            vertexBuffer[vertIndex++] = 0;\r\n            // UV coords\r\n            vertexBuffer[vertIndex++] = uvx1; //1;\r\n            vertexBuffer[vertIndex++] = uvy0; //0;\r\n            // texture id\r\n            vertexBuffer[vertIndex++] = textureId;\r\n            // opacity\r\n            vertexBuffer[vertIndex++] = command.opacity;\r\n            // color\r\n            vertexBuffer[vertIndex++] = commandColor.r / 255;\r\n            vertexBuffer[vertIndex++] = commandColor.g / 255;\r\n            vertexBuffer[vertIndex++] = commandColor.b / 255;\r\n            vertexBuffer[vertIndex++] = commandColor.a;\r\n            // (0, 1)\r\n            vertexBuffer[vertIndex++] = command.geometry[4][0]; // x + 0 * width;\r\n            vertexBuffer[vertIndex++] = command.geometry[4][1]; // y + 1 * height\r\n            vertexBuffer[vertIndex++] = 0;\r\n            // UV coords\r\n            vertexBuffer[vertIndex++] = uvx0; // 0;\r\n            vertexBuffer[vertIndex++] = uvy1; // 1;\r\n            // texture id\r\n            vertexBuffer[vertIndex++] = textureId;\r\n            // opacity\r\n            vertexBuffer[vertIndex++] = command.opacity;\r\n            // color\r\n            vertexBuffer[vertIndex++] = commandColor.r / 255;\r\n            vertexBuffer[vertIndex++] = commandColor.g / 255;\r\n            vertexBuffer[vertIndex++] = commandColor.b / 255;\r\n            vertexBuffer[vertIndex++] = commandColor.a;\r\n            // (1, 1)\r\n            vertexBuffer[vertIndex++] = command.geometry[5][0]; // x + 1 * width;\r\n            vertexBuffer[vertIndex++] = command.geometry[5][1]; // y + 1 * height;\r\n            vertexBuffer[vertIndex++] = 0;\r\n            // UV coords\r\n            vertexBuffer[vertIndex++] = uvx1; // 1;\r\n            vertexBuffer[vertIndex++] = uvy1; // 1;\r\n            // texture id\r\n            vertexBuffer[vertIndex++] = textureId;\r\n            // opacity\r\n            vertexBuffer[vertIndex++] = command.opacity;\r\n            // color\r\n            vertexBuffer[vertIndex++] = commandColor.r / 255;\r\n            vertexBuffer[vertIndex++] = commandColor.g / 255;\r\n            vertexBuffer[vertIndex++] = commandColor.b / 255;\r\n            vertexBuffer[vertIndex++] = commandColor.a;\r\n        }\r\n        return vertIndex / this.vertexSize;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/shaders/point-vertex.glsl\n/* harmony default export */ const point_vertex = (\"attribute vec4 a_position;\\r\\nattribute vec4 a_color;\\r\\nattribute float a_size;\\r\\nvarying lowp vec4 v_color;\\r\\nuniform mat4 u_matrix;\\r\\n\\r\\nvoid main() {\\r\\n  gl_Position = u_matrix * a_position;\\r\\n  gl_PointSize = a_size * 2.0;\\r\\n  v_color = a_color;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/shaders/point-fragment.glsl\n/* harmony default export */ const point_fragment = (\"#ifdef GL_OES_standard_derivatives\\r\\n#extension GL_OES_standard_derivatives : enable\\r\\n#endif\\r\\n\\r\\nprecision mediump float;\\r\\nvarying lowp vec4 v_color;\\r\\n\\r\\nvoid main() {\\r\\n  float r = 0.0, delta = 0.0, alpha = 1.0;\\r\\n  vec2 cxy = 2.0 * gl_PointCoord - 1.0;\\r\\n  r = dot(cxy, cxy);\\r\\n  \\r\\n#ifdef GL_OES_standard_derivatives\\r\\n  delta = fwidth(r);\\r\\n  alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\\r\\n#else\\r\\n  if (r > 1.0) {\\r\\n    discard;\\r\\n  }\\r\\n#endif\\r\\n  gl_FragColor = vec4(v_color.rgb, v_color.a * alpha);\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/point-renderer.ts\n\r\n\r\n\r\n\r\n\r\n\r\n// import { Random } from '../../Math/Index';\r\nclass DrawPoint {\r\n    constructor() {\r\n        this.point = Vector.Zero;\r\n        this.color = Color.Black;\r\n        this.size = 1;\r\n    }\r\n    dispose() {\r\n        this.point.setTo(0, 0);\r\n        this.color.r = 0;\r\n        this.color.g = 0;\r\n        this.color.b = 0;\r\n        this.color.a = 1;\r\n        this.size = 1;\r\n        return this;\r\n    }\r\n}\r\nclass PointRenderer extends BatchRenderer {\r\n    constructor(gl, _contextInfo) {\r\n        super({ gl, command: DrawPoint, verticesPerCommand: 1 });\r\n        this._contextInfo = _contextInfo;\r\n        this.init();\r\n    }\r\n    buildShader(gl) {\r\n        gl.getExtension('OES_standard_derivatives');\r\n        const shader = new Shader(gl, point_vertex, point_fragment);\r\n        shader.addAttribute('a_position', 2, gl.FLOAT);\r\n        shader.addAttribute('a_color', 4, gl.FLOAT);\r\n        shader.addAttribute('a_size', 1, gl.FLOAT);\r\n        shader.addUniformMatrix('u_matrix', this._contextInfo.matrix.data);\r\n        return shader;\r\n    }\r\n    addPoint(point, color, size) {\r\n        const cmd = this.commands.get();\r\n        cmd.point = this._contextInfo.transform.current.multv(point);\r\n        cmd.color.r = color.r;\r\n        cmd.color.g = color.g;\r\n        cmd.color.b = color.b;\r\n        cmd.color.a = color.a * this._contextInfo.state.current.opacity;\r\n        cmd.size = size * Math.max(this._contextInfo.transform.current.getScaleX(), this._contextInfo.transform.current.getScaleY());\r\n        this.addCommand(cmd);\r\n    }\r\n    buildBatchVertices(vertexBuffer, batch) {\r\n        let index = 0;\r\n        for (const command of batch.commands) {\r\n            vertexBuffer[index++] = command.point.x;\r\n            vertexBuffer[index++] = command.point.y;\r\n            // normalize to [0, 1] for webgl\r\n            vertexBuffer[index++] = command.color.r / 255;\r\n            vertexBuffer[index++] = command.color.g / 255;\r\n            vertexBuffer[index++] = command.color.b / 255;\r\n            vertexBuffer[index++] = command.color.a;\r\n            vertexBuffer[index++] = command.size;\r\n        }\r\n        return index / this.vertexSize;\r\n    }\r\n    renderBatch(gl, _batch, vertexCount) {\r\n        gl.drawArrays(gl.POINTS, 0, vertexCount);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Graphic.ts\n\r\n\r\n/**\r\n * A Graphic is the base Excalibur primitive for something that can be drawn to the [[ExcaliburGraphicsContext]].\r\n * [[Sprite]], [[Animation]], [[GraphicsGroup]], [[Canvas]], [[Rectangle]], [[Circle]], and [[Polygon]] all derive from the\r\n * [[Graphic]] abstract class.\r\n *\r\n * Implementors of a Graphic must override the abstract [[Graphic._drawImage]] method to render an image to the graphics context. Graphic\r\n * handles all the position, rotation, and scale transformations in [[Graphic._preDraw]] and [[Graphic._postDraw]]\r\n */\r\nclass Graphic {\r\n    constructor(options) {\r\n        var _a, _b, _c, _d, _e, _f;\r\n        this.id = Graphic._ID++;\r\n        /**\r\n         * Gets or sets wether to show debug information about the graphic\r\n         */\r\n        this.showDebug = false;\r\n        /**\r\n         * Gets or sets the flipHorizontal, which will flip the graphic horizontally (across the y axis)\r\n         */\r\n        this.flipHorizontal = false;\r\n        /**\r\n         * Gets or sets the flipVertical, which will flip the graphic vertically (across the x axis)\r\n         */\r\n        this.flipVertical = false;\r\n        /**\r\n         * Gets or sets the rotation of the graphic\r\n         */\r\n        this.rotation = 0;\r\n        /**\r\n         * Gets or sets the opacity of the graphic, 0 is transparent, 1 is solid (opaque).\r\n         */\r\n        this.opacity = 1;\r\n        /**\r\n         * Gets or sets the scale of the graphic, this affects the width and\r\n         */\r\n        this.scale = Vector.One;\r\n        /**\r\n         * Gets or sets the origin of the graphic, if not set the center of the graphic is the origin\r\n         */\r\n        this.origin = null;\r\n        this._width = 0;\r\n        this._height = 0;\r\n        if (options) {\r\n            this.origin = (_a = options.origin) !== null && _a !== void 0 ? _a : this.origin;\r\n            this.flipHorizontal = (_b = options.flipHorizontal) !== null && _b !== void 0 ? _b : this.flipHorizontal;\r\n            this.flipVertical = (_c = options.flipVertical) !== null && _c !== void 0 ? _c : this.flipVertical;\r\n            this.rotation = (_d = options.rotation) !== null && _d !== void 0 ? _d : this.rotation;\r\n            this.opacity = (_e = options.opacity) !== null && _e !== void 0 ? _e : this.opacity;\r\n            this.scale = (_f = options.scale) !== null && _f !== void 0 ? _f : this.scale;\r\n        }\r\n    }\r\n    cloneGraphicOptions() {\r\n        return {\r\n            origin: this.origin ? this.origin.clone() : null,\r\n            flipHorizontal: this.flipHorizontal,\r\n            flipVertical: this.flipVertical,\r\n            rotation: this.rotation,\r\n            opacity: this.opacity,\r\n            scale: this.scale ? this.scale.clone() : null\r\n        };\r\n    }\r\n    /**\r\n     * Gets or sets the width of the graphic (always positive)\r\n     */\r\n    get width() {\r\n        return Math.abs(this._width * this.scale.x);\r\n    }\r\n    /**\r\n     * Gets or sets the height of the graphic (always positive)\r\n     */\r\n    get height() {\r\n        return Math.abs(this._height * this.scale.y);\r\n    }\r\n    set width(value) {\r\n        this._width = value;\r\n    }\r\n    set height(value) {\r\n        this._height = value;\r\n    }\r\n    /**\r\n     * Gets a copy of the bounds in pixels occupied by the graphic on the the screen. This includes scale.\r\n     */\r\n    get localBounds() {\r\n        return BoundingBox.fromDimension(this.width, this.height, Vector.Zero);\r\n    }\r\n    /**\r\n     * Draw the whole graphic to the context including transform\r\n     * @param ex The excalibur graphics context\r\n     * @param x\r\n     * @param y\r\n     */\r\n    draw(ex, x, y) {\r\n        this._preDraw(ex, x, y);\r\n        this._drawImage(ex, 0, 0);\r\n        this._postDraw(ex);\r\n    }\r\n    /**\r\n     * Apply affine transformations to the graphics context to manipulate the graphic before [[Graphic._drawImage]]\r\n     * @param ex\r\n     * @param x\r\n     * @param y\r\n     */\r\n    _preDraw(ex, x, y) {\r\n        ex.save();\r\n        ex.translate(x, y);\r\n        ex.scale(Math.abs(this.scale.x), Math.abs(this.scale.y));\r\n        this._rotate(ex);\r\n        this._flip(ex);\r\n        // it is important to multiply alphas so graphics respect the current context\r\n        ex.opacity = ex.opacity * this.opacity;\r\n    }\r\n    _rotate(ex) {\r\n        var _a;\r\n        const scaleDirX = this.scale.x > 0 ? 1 : -1;\r\n        const scaleDirY = this.scale.y > 0 ? 1 : -1;\r\n        const origin = (_a = this.origin) !== null && _a !== void 0 ? _a : vec(this.width / 2, this.height / 2);\r\n        ex.translate(origin.x, origin.y);\r\n        ex.rotate(this.rotation);\r\n        // This is for handling direction changes 1 or -1, that way we don't have mismatched translates()\r\n        ex.scale(scaleDirX, scaleDirY);\r\n        ex.translate(-origin.x, -origin.y);\r\n    }\r\n    _flip(ex) {\r\n        if (this.flipHorizontal) {\r\n            ex.translate(this.width / this.scale.x, 0);\r\n            ex.scale(-1, 1);\r\n        }\r\n        if (this.flipVertical) {\r\n            ex.translate(0, this.height / this.scale.y);\r\n            ex.scale(1, -1);\r\n        }\r\n    }\r\n    /**\r\n     * Apply any addtional work after [[Graphic._drawImage]] and restore the context state.\r\n     * @param ex\r\n     */\r\n    _postDraw(ex) {\r\n        if (this.showDebug) {\r\n            ex.debug.drawRect(0, 0, this.width, this.height);\r\n        }\r\n        ex.restore();\r\n    }\r\n}\r\nGraphic._ID = 0;\r\n\n;// CONCATENATED MODULE: ./Util/Watch.ts\n/**\r\n * Watch an object with a proxy, only fires if property value is different\r\n */\r\nfunction watch(type, change) {\r\n    if (!type) {\r\n        return type;\r\n    }\r\n    if (type.__isProxy === undefined) {\r\n        // expando hack to mark a proxy\r\n        return new Proxy(type, {\r\n            set: (obj, prop, value) => {\r\n                // The default behavior to store the value\r\n                if (obj[prop] !== value) {\r\n                    obj[prop] = value;\r\n                    // Avoid watching private junk\r\n                    if (typeof prop === 'string') {\r\n                        if (prop[0] !== '_') {\r\n                            change(obj);\r\n                        }\r\n                    }\r\n                }\r\n                // Indicate success\r\n                return true;\r\n            },\r\n            get: (obj, prop) => {\r\n                if (prop !== '__isProxy') {\r\n                    return obj[prop];\r\n                }\r\n                return true;\r\n            }\r\n        });\r\n    }\r\n    return type;\r\n}\r\n/**\r\n * Watch an object with a proxy, fires change on any property value change\r\n */\r\nfunction watchAny(type, change) {\r\n    if (!type) {\r\n        return type;\r\n    }\r\n    if (type.__isProxy === undefined) {\r\n        // expando hack to mark a proxy\r\n        return new Proxy(type, {\r\n            set: (obj, prop, value) => {\r\n                // The default behavior to store the value\r\n                obj[prop] = value;\r\n                // Avoid watching private junk\r\n                if (typeof prop === 'string') {\r\n                    if (prop[0] !== '_') {\r\n                        change(obj);\r\n                    }\r\n                }\r\n                // Indicate success\r\n                return true;\r\n            },\r\n            get: (obj, prop) => {\r\n                if (prop !== '__isProxy') {\r\n                    return obj[prop];\r\n                }\r\n                return true;\r\n            }\r\n        });\r\n    }\r\n    return type;\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Raster.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * A Raster is a Graphic that needs to be first painted to a HTMLCanvasElement before it can be drawn to the\r\n * [[ExcaliburGraphicsContext]]. This is useful for generating custom images using the 2D canvas api.\r\n *\r\n * Implementors must implemenet the [[Raster.execute]] method to rasterize their drawing.\r\n */\r\nclass Raster extends Graphic {\r\n    constructor(options) {\r\n        var _a, _b, _c, _d, _e, _f, _g;\r\n        super(options);\r\n        this._dirty = true;\r\n        this._smoothing = false;\r\n        this._color = watch(Color.Black, () => this.flagDirty());\r\n        this._lineWidth = 1;\r\n        this._lineDash = [];\r\n        this._padding = 0;\r\n        if (options) {\r\n            this.color = (_a = options.color) !== null && _a !== void 0 ? _a : Color.Black;\r\n            this.strokeColor = options === null || options === void 0 ? void 0 : options.strokeColor;\r\n            this.smoothing = (_b = options.smoothing) !== null && _b !== void 0 ? _b : this.smoothing;\r\n            this.lineWidth = (_c = options.lineWidth) !== null && _c !== void 0 ? _c : this.lineWidth;\r\n            this.lineDash = (_d = options.lineDash) !== null && _d !== void 0 ? _d : this.lineDash;\r\n            this.padding = (_e = options.padding) !== null && _e !== void 0 ? _e : this.padding;\r\n        }\r\n        this._bitmap = document.createElement('canvas');\r\n        // get the default canvas width/height as a fallback\r\n        const bitmapWidth = (_f = options === null || options === void 0 ? void 0 : options.width) !== null && _f !== void 0 ? _f : this._bitmap.width;\r\n        const bitmapHeight = (_g = options === null || options === void 0 ? void 0 : options.height) !== null && _g !== void 0 ? _g : this._bitmap.height;\r\n        // Rasters use power of two images as an optimization for webgl\r\n        this.width = ensurePowerOfTwo(bitmapWidth);\r\n        this.height = ensurePowerOfTwo(bitmapHeight);\r\n        const maybeCtx = this._bitmap.getContext('2d');\r\n        if (!maybeCtx) {\r\n            /* istanbul ignore next */\r\n            throw new Error('Browser does not support 2d canvas drawing, cannot create Raster graphic');\r\n        }\r\n        else {\r\n            this._ctx = maybeCtx;\r\n        }\r\n    }\r\n    cloneRasterOptions() {\r\n        return {\r\n            color: this.color ? this.color.clone() : null,\r\n            strokeColor: this.strokeColor ? this.strokeColor.clone() : null,\r\n            smoothing: this.smoothing,\r\n            lineWidth: this.lineWidth,\r\n            lineDash: this.lineDash,\r\n            padding: this.padding\r\n        };\r\n    }\r\n    /**\r\n     * Gets whether the graphic is dirty, this means there are changes that haven't been re-rasterized\r\n     */\r\n    get dirty() {\r\n        return this._dirty;\r\n    }\r\n    /**\r\n     * Flags the graphic as dirty, meaning it must be re-rasterized before draw.\r\n     * This should be called any time the graphics state changes such that it affects the outputed drawing\r\n     */\r\n    flagDirty() {\r\n        this._dirty = true;\r\n    }\r\n    /**\r\n     * Gets or sets the current width of the Raster graphic. Setting the width will cause the raster\r\n     * to be flagged dirty causing a re-raster on the next draw.\r\n     *\r\n     * Any `padding`s set will be factored into the width\r\n     */\r\n    get width() {\r\n        return this._getTotalWidth();\r\n    }\r\n    set width(value) {\r\n        this._bitmap.width = value;\r\n        this._originalWidth = value;\r\n        this.flagDirty();\r\n    }\r\n    /**\r\n     * Gets or sets the current height of the Raster graphic. Setting the height will cause the raster\r\n     * to be flagged dirty causing a re-raster on the next draw.\r\n     *\r\n     * Any `padding` set will be factored into the height\r\n     */\r\n    get height() {\r\n        return this._getTotalHeight();\r\n    }\r\n    set height(value) {\r\n        this._bitmap.height = value;\r\n        this._originalHeight = value;\r\n        this.flagDirty();\r\n    }\r\n    _getTotalWidth() {\r\n        var _a;\r\n        return ((_a = this._originalWidth) !== null && _a !== void 0 ? _a : this._bitmap.width) + this.padding * 2;\r\n    }\r\n    _getTotalHeight() {\r\n        var _a;\r\n        return ((_a = this._originalHeight) !== null && _a !== void 0 ? _a : this._bitmap.height) + this.padding * 2;\r\n    }\r\n    /**\r\n     * Returns the local bounds of the Raster including the padding\r\n     */\r\n    get localBounds() {\r\n        return BoundingBox.fromDimension(this._getTotalWidth() * this.scale.x, this._getTotalHeight() * this.scale.y, Vector.Zero);\r\n    }\r\n    /**\r\n     * Gets or sets the smoothing (anti-aliasing of the graphic). Setting the height will cause the raster\r\n     * to be flagged dirty causing a re-raster on the next draw.\r\n     */\r\n    get smoothing() {\r\n        return this._smoothing;\r\n    }\r\n    set smoothing(value) {\r\n        this._smoothing = value;\r\n        this.flagDirty();\r\n    }\r\n    /**\r\n     * Gets or sets the fillStyle of the Raster graphic. Setting the fillStyle will cause the raster to be\r\n     * flagged dirty causing a re-raster on the next draw.\r\n     */\r\n    get color() {\r\n        return this._color;\r\n    }\r\n    set color(value) {\r\n        var _a;\r\n        if (!((_a = this._color) === null || _a === void 0 ? void 0 : _a.equal(value))) {\r\n            this.flagDirty();\r\n        }\r\n        this._color = watch(value, () => this.flagDirty());\r\n    }\r\n    /**\r\n     * Gets or sets the strokeStyle of the Raster graphic. Setting the strokeStyle will cause the raster to be\r\n     * flagged dirty causing a re-raster on the next draw.\r\n     */\r\n    get strokeColor() {\r\n        return this._strokeColor;\r\n    }\r\n    set strokeColor(value) {\r\n        var _a;\r\n        if (!((_a = this._strokeColor) === null || _a === void 0 ? void 0 : _a.equal(value))) {\r\n            this.flagDirty();\r\n        }\r\n        this._strokeColor = watch(value, () => this.flagDirty());\r\n    }\r\n    /**\r\n     * Gets or sets the line width of the Raster graphic. Setting the lineWidth will cause the raster to be\r\n     * flagged dirty causing a re-raster on the next draw.\r\n     */\r\n    get lineWidth() {\r\n        return this._lineWidth;\r\n    }\r\n    set lineWidth(value) {\r\n        this._lineWidth = value;\r\n        this.flagDirty();\r\n    }\r\n    get lineDash() {\r\n        return this._lineDash;\r\n    }\r\n    set lineDash(value) {\r\n        this._lineDash = value;\r\n        this.flagDirty();\r\n    }\r\n    get padding() {\r\n        return this._padding;\r\n    }\r\n    set padding(value) {\r\n        this._padding = value;\r\n        this.flagDirty();\r\n    }\r\n    /**\r\n     * Rasterize the graphic to a bitmap making it usuable as in excalibur. Rasterize is called automatically if\r\n     * the graphic is [[Raster.dirty]] on the next [[Graphic.draw]] call\r\n     */\r\n    rasterize() {\r\n        this._dirty = false;\r\n        this._ctx.clearRect(0, 0, this._getTotalWidth(), this._getTotalHeight());\r\n        this._ctx.save();\r\n        this._applyRasterProperites(this._ctx);\r\n        this.execute(this._ctx);\r\n        this._ctx.restore();\r\n        // The webgl texture needs to be updated if it exists after a raster cycle\r\n        TextureLoader.load(this._bitmap, true);\r\n    }\r\n    _applyRasterProperites(ctx) {\r\n        var _a, _b, _c;\r\n        this._bitmap.width = this._getTotalWidth();\r\n        this._bitmap.height = this._getTotalHeight();\r\n        ctx.translate(this.padding, this.padding);\r\n        ctx.imageSmoothingEnabled = this.smoothing;\r\n        ctx.lineWidth = this.lineWidth;\r\n        ctx.setLineDash((_a = this.lineDash) !== null && _a !== void 0 ? _a : ctx.getLineDash());\r\n        ctx.strokeStyle = (_b = this.strokeColor) === null || _b === void 0 ? void 0 : _b.toString();\r\n        ctx.fillStyle = (_c = this.color) === null || _c === void 0 ? void 0 : _c.toString();\r\n    }\r\n    _drawImage(ex, x, y) {\r\n        if (this._dirty) {\r\n            this.rasterize();\r\n        }\r\n        ex.drawImage(this._bitmap, x, y);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Canvas.ts\n\r\n/**\r\n * A canvas [[Graphic]] to provide an adapter between the 2D Canvas API and the [[ExcaliburGraphicsContext]].\r\n *\r\n * The [[Canvas]] works by re-rastering a draw handler to a HTMLCanvasElement for every draw which is then passed\r\n * to the [[ExcaliburGraphicsContext]] implementation as a rendered image.\r\n *\r\n * **Low performance API**\r\n */\r\nclass Canvas extends Raster {\r\n    constructor(_options) {\r\n        super(_options);\r\n        this._options = _options;\r\n    }\r\n    /**\r\n     * Return the 2D graphics context of this canvas\r\n     */\r\n    get ctx() {\r\n        return this._ctx;\r\n    }\r\n    clone() {\r\n        return new Canvas(Object.assign(Object.assign(Object.assign({}, this._options), this.cloneGraphicOptions()), this.cloneRasterOptions()));\r\n    }\r\n    execute(ctx) {\r\n        var _a, _b;\r\n        if ((_a = this._options) === null || _a === void 0 ? void 0 : _a.draw) {\r\n            (_b = this._options) === null || _b === void 0 ? void 0 : _b.draw(ctx);\r\n        }\r\n        if (!this._options.cache) {\r\n            this.flagDirty();\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Events.ts\nvar EventTypes;\r\n(function (EventTypes) {\r\n    EventTypes[\"Kill\"] = \"kill\";\r\n    EventTypes[\"PreKill\"] = \"prekill\";\r\n    EventTypes[\"PostKill\"] = \"postkill\";\r\n    EventTypes[\"PreDraw\"] = \"predraw\";\r\n    EventTypes[\"PostDraw\"] = \"postdraw\";\r\n    EventTypes[\"PreDebugDraw\"] = \"predebugdraw\";\r\n    EventTypes[\"PostDebugDraw\"] = \"postdebugdraw\";\r\n    EventTypes[\"PreUpdate\"] = \"preupdate\";\r\n    EventTypes[\"PostUpdate\"] = \"postupdate\";\r\n    EventTypes[\"PreFrame\"] = \"preframe\";\r\n    EventTypes[\"PostFrame\"] = \"postframe\";\r\n    EventTypes[\"PreCollision\"] = \"precollision\";\r\n    EventTypes[\"CollisionStart\"] = \"collisionstart\";\r\n    EventTypes[\"CollisionEnd\"] = \"collisionend\";\r\n    EventTypes[\"PostCollision\"] = \"postcollision\";\r\n    EventTypes[\"Initialize\"] = \"initialize\";\r\n    EventTypes[\"Activate\"] = \"activate\";\r\n    EventTypes[\"Deactivate\"] = \"deactivate\";\r\n    EventTypes[\"ExitViewport\"] = \"exitviewport\";\r\n    EventTypes[\"EnterViewport\"] = \"enterviewport\";\r\n    EventTypes[\"ExitTrigger\"] = \"exit\";\r\n    EventTypes[\"EnterTrigger\"] = \"enter\";\r\n    EventTypes[\"Connect\"] = \"connect\";\r\n    EventTypes[\"Disconnect\"] = \"disconnect\";\r\n    EventTypes[\"Button\"] = \"button\";\r\n    EventTypes[\"Axis\"] = \"axis\";\r\n    EventTypes[\"Subscribe\"] = \"subscribe\";\r\n    EventTypes[\"Unsubscribe\"] = \"unsubscribe\";\r\n    EventTypes[\"Visible\"] = \"visible\";\r\n    EventTypes[\"Hidden\"] = \"hidden\";\r\n    EventTypes[\"Start\"] = \"start\";\r\n    EventTypes[\"Stop\"] = \"stop\";\r\n    EventTypes[\"PointerUp\"] = \"pointerup\";\r\n    EventTypes[\"PointerDown\"] = \"pointerdown\";\r\n    EventTypes[\"PointerMove\"] = \"pointermove\";\r\n    EventTypes[\"PointerEnter\"] = \"pointerenter\";\r\n    EventTypes[\"PointerLeave\"] = \"pointerleave\";\r\n    EventTypes[\"PointerCancel\"] = \"pointercancel\";\r\n    EventTypes[\"PointerWheel\"] = \"pointerwheel\";\r\n    EventTypes[\"Up\"] = \"up\";\r\n    EventTypes[\"Down\"] = \"down\";\r\n    EventTypes[\"Move\"] = \"move\";\r\n    EventTypes[\"Enter\"] = \"enter\";\r\n    EventTypes[\"Leave\"] = \"leave\";\r\n    EventTypes[\"Cancel\"] = \"cancel\";\r\n    EventTypes[\"Wheel\"] = \"wheel\";\r\n    EventTypes[\"Press\"] = \"press\";\r\n    EventTypes[\"Release\"] = \"release\";\r\n    EventTypes[\"Hold\"] = \"hold\";\r\n    EventTypes[\"PointerDragStart\"] = \"pointerdragstart\";\r\n    EventTypes[\"PointerDragEnd\"] = \"pointerdragend\";\r\n    EventTypes[\"PointerDragEnter\"] = \"pointerdragenter\";\r\n    EventTypes[\"PointerDragLeave\"] = \"pointerdragleave\";\r\n    EventTypes[\"PointerDragMove\"] = \"pointerdragmove\";\r\n})(EventTypes || (EventTypes = {}));\r\n/**\r\n * Base event type in Excalibur that all other event types derive from. Not all event types are thrown on all Excalibur game objects,\r\n * some events are unique to a type, others are not.\r\n *\r\n */\r\nclass GameEvent {\r\n    constructor() {\r\n        this._bubbles = true;\r\n    }\r\n    /**\r\n     * If set to false, prevents event from propagating to other actors. If true it will be propagated\r\n     * to all actors that apply.\r\n     */\r\n    get bubbles() {\r\n        return this._bubbles;\r\n    }\r\n    set bubbles(value) {\r\n        this._bubbles = value;\r\n    }\r\n    /**\r\n     * Prevents event from bubbling\r\n     */\r\n    stopPropagation() {\r\n        this.bubbles = false;\r\n    }\r\n}\r\n/**\r\n * The 'kill' event is emitted on actors when it is killed. The target is the actor that was killed.\r\n */\r\nclass KillEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'prekill' event is emitted directly before an actor is killed.\r\n */\r\nclass PreKillEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'postkill' event is emitted directly after the actor is killed.\r\n */\r\nclass PostKillEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'start' event is emitted on engine when has started and is ready for interaction.\r\n */\r\nclass GameStartEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'stop' event is emitted on engine when has been stopped and will no longer take input, update or draw.\r\n */\r\nclass GameStopEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'predraw' event is emitted on actors, scenes, and engine before drawing starts. Actors' predraw happens inside their graphics\r\n * transform so that all drawing takes place with the actor as the origin.\r\n *\r\n */\r\nclass PreDrawEvent extends GameEvent {\r\n    constructor(ctx, delta, target) {\r\n        super();\r\n        this.ctx = ctx;\r\n        this.delta = delta;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'postdraw' event is emitted on actors, scenes, and engine after drawing finishes. Actors' postdraw happens inside their graphics\r\n * transform so that all drawing takes place with the actor as the origin.\r\n *\r\n */\r\nclass PostDrawEvent extends GameEvent {\r\n    constructor(ctx, delta, target) {\r\n        super();\r\n        this.ctx = ctx;\r\n        this.delta = delta;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'predebugdraw' event is emitted on actors, scenes, and engine before debug drawing starts.\r\n */\r\nclass PreDebugDrawEvent extends GameEvent {\r\n    constructor(ctx, target) {\r\n        super();\r\n        this.ctx = ctx;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'postdebugdraw' event is emitted on actors, scenes, and engine after debug drawing starts.\r\n */\r\nclass PostDebugDrawEvent extends GameEvent {\r\n    constructor(ctx, target) {\r\n        super();\r\n        this.ctx = ctx;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'preupdate' event is emitted on actors, scenes, camera, and engine before the update starts.\r\n */\r\nclass PreUpdateEvent extends GameEvent {\r\n    constructor(engine, delta, target) {\r\n        super();\r\n        this.engine = engine;\r\n        this.delta = delta;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'postupdate' event is emitted on actors, scenes, camera, and engine after the update ends.\r\n */\r\nclass PostUpdateEvent extends GameEvent {\r\n    constructor(engine, delta, target) {\r\n        super();\r\n        this.engine = engine;\r\n        this.delta = delta;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'preframe' event is emitted on the engine, before the frame begins.\r\n */\r\nclass PreFrameEvent extends GameEvent {\r\n    constructor(engine, prevStats) {\r\n        super();\r\n        this.engine = engine;\r\n        this.prevStats = prevStats;\r\n        this.target = engine;\r\n    }\r\n}\r\n/**\r\n * The 'postframe' event is emitted on the engine, after a frame ends.\r\n */\r\nclass PostFrameEvent extends GameEvent {\r\n    constructor(engine, stats) {\r\n        super();\r\n        this.engine = engine;\r\n        this.stats = stats;\r\n        this.target = engine;\r\n    }\r\n}\r\n/**\r\n * Event received when a gamepad is connected to Excalibur. [[Gamepads]] receives this event.\r\n */\r\nclass GamepadConnectEvent extends GameEvent {\r\n    constructor(index, gamepad) {\r\n        super();\r\n        this.index = index;\r\n        this.gamepad = gamepad;\r\n        this.target = gamepad;\r\n    }\r\n}\r\n/**\r\n * Event received when a gamepad is disconnected from Excalibur. [[Gamepads]] receives this event.\r\n */\r\nclass GamepadDisconnectEvent extends GameEvent {\r\n    constructor(index, gamepad) {\r\n        super();\r\n        this.index = index;\r\n        this.gamepad = gamepad;\r\n        this.target = gamepad;\r\n    }\r\n}\r\n/**\r\n * Gamepad button event. See [[Gamepads]] for information on responding to controller input. [[Gamepad]] instances receive this event;\r\n */\r\nclass GamepadButtonEvent extends GameEvent {\r\n    /**\r\n     * @param button  The Gamepad button\r\n     * @param value   A numeric value between 0 and 1\r\n     */\r\n    constructor(button, value, target) {\r\n        super();\r\n        this.button = button;\r\n        this.value = value;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Gamepad axis event. See [[Gamepads]] for information on responding to controller input. [[Gamepad]] instances receive this event;\r\n */\r\nclass GamepadAxisEvent extends GameEvent {\r\n    /**\r\n     * @param axis  The Gamepad axis\r\n     * @param value A numeric value between -1 and 1\r\n     */\r\n    constructor(axis, value, target) {\r\n        super();\r\n        this.axis = axis;\r\n        this.value = value;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Subscribe event thrown when handlers for events other than subscribe are added. Meta event that is received by\r\n * [[EventDispatcher|event dispatchers]].\r\n */\r\nclass SubscribeEvent extends GameEvent {\r\n    constructor(topic, handler) {\r\n        super();\r\n        this.topic = topic;\r\n        this.handler = handler;\r\n    }\r\n}\r\n/**\r\n * Unsubscribe event thrown when handlers for events other than unsubscribe are removed. Meta event that is received by\r\n * [[EventDispatcher|event dispatchers]].\r\n */\r\nclass UnsubscribeEvent extends GameEvent {\r\n    constructor(topic, handler) {\r\n        super();\r\n        this.topic = topic;\r\n        this.handler = handler;\r\n    }\r\n}\r\n/**\r\n * Event received by the [[Engine]] when the browser window is visible on a screen.\r\n */\r\nclass VisibleEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Event received by the [[Engine]] when the browser window is hidden from all screens.\r\n */\r\nclass HiddenEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Event thrown on an [[Actor|actor]] when a collision will occur this frame if it resolves\r\n */\r\nclass PreCollisionEvent extends GameEvent {\r\n    /**\r\n     * @param actor         The actor the event was thrown on\r\n     * @param other         The actor that will collided with the current actor\r\n     * @param side          The side that will be collided with the current actor\r\n     * @param intersection  Intersection vector\r\n     */\r\n    constructor(actor, other, side, intersection) {\r\n        super();\r\n        this.other = other;\r\n        this.side = side;\r\n        this.intersection = intersection;\r\n        this.target = actor;\r\n    }\r\n}\r\n/**\r\n * Event thrown on an [[Actor|actor]] when a collision has been resolved (body reacted) this frame\r\n */\r\nclass PostCollisionEvent extends GameEvent {\r\n    /**\r\n     * @param actor         The actor the event was thrown on\r\n     * @param other         The actor that did collide with the current actor\r\n     * @param side          The side that did collide with the current actor\r\n     * @param intersection  Intersection vector\r\n     */\r\n    constructor(actor, other, side, intersection) {\r\n        super();\r\n        this.other = other;\r\n        this.side = side;\r\n        this.intersection = intersection;\r\n        this.target = actor;\r\n    }\r\n    get actor() {\r\n        return this.target;\r\n    }\r\n    set actor(actor) {\r\n        this.target = actor;\r\n    }\r\n}\r\nclass ContactStartEvent {\r\n    constructor(target, other, contact) {\r\n        this.target = target;\r\n        this.other = other;\r\n        this.contact = contact;\r\n    }\r\n}\r\nclass ContactEndEvent {\r\n    constructor(target, other) {\r\n        this.target = target;\r\n        this.other = other;\r\n    }\r\n}\r\nclass CollisionPreSolveEvent {\r\n    constructor(target, other, side, intersection, contact) {\r\n        this.target = target;\r\n        this.other = other;\r\n        this.side = side;\r\n        this.intersection = intersection;\r\n        this.contact = contact;\r\n    }\r\n}\r\nclass CollisionPostSolveEvent {\r\n    constructor(target, other, side, intersection, contact) {\r\n        this.target = target;\r\n        this.other = other;\r\n        this.side = side;\r\n        this.intersection = intersection;\r\n        this.contact = contact;\r\n    }\r\n}\r\n/**\r\n * Event thrown the first time an [[Actor|actor]] collides with another, after an actor is in contact normal collision events are fired.\r\n */\r\nclass CollisionStartEvent extends GameEvent {\r\n    /**\r\n     *\r\n     * @param actor\r\n     * @param other\r\n     * @param contact\r\n     */\r\n    constructor(actor, other, contact) {\r\n        super();\r\n        this.other = other;\r\n        this.contact = contact;\r\n        this.target = actor;\r\n    }\r\n    get actor() {\r\n        return this.target;\r\n    }\r\n    set actor(actor) {\r\n        this.target = actor;\r\n    }\r\n}\r\n/**\r\n * Event thrown when the [[Actor|actor]] is no longer colliding with another\r\n */\r\nclass CollisionEndEvent extends GameEvent {\r\n    /**\r\n     *\r\n     */\r\n    constructor(actor, other) {\r\n        super();\r\n        this.other = other;\r\n        this.target = actor;\r\n    }\r\n    get actor() {\r\n        return this.target;\r\n    }\r\n    set actor(actor) {\r\n        this.target = actor;\r\n    }\r\n}\r\n/**\r\n * Event thrown on an [[Actor]] and a [[Scene]] only once before the first update call\r\n */\r\nclass InitializeEvent extends GameEvent {\r\n    /**\r\n     * @param engine  The reference to the current engine\r\n     */\r\n    constructor(engine, target) {\r\n        super();\r\n        this.engine = engine;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Event thrown on a [[Scene]] on activation\r\n */\r\nclass ActivateEvent extends GameEvent {\r\n    /**\r\n     * @param oldScene  The reference to the old scene\r\n     */\r\n    constructor(oldScene, target) {\r\n        super();\r\n        this.oldScene = oldScene;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Event thrown on a [[Scene]] on deactivation\r\n */\r\nclass DeactivateEvent extends GameEvent {\r\n    /**\r\n     * @param newScene  The reference to the new scene\r\n     */\r\n    constructor(newScene, target) {\r\n        super();\r\n        this.newScene = newScene;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Event thrown on an [[Actor]] when it completely leaves the screen.\r\n */\r\nclass ExitViewPortEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Event thrown on an [[Actor]] when it completely leaves the screen.\r\n */\r\nclass EnterViewPortEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\nclass EnterTriggerEvent extends GameEvent {\r\n    constructor(target, actor) {\r\n        super();\r\n        this.target = target;\r\n        this.actor = actor;\r\n    }\r\n}\r\nclass ExitTriggerEvent extends GameEvent {\r\n    constructor(target, actor) {\r\n        super();\r\n        this.target = target;\r\n        this.actor = actor;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EventDispatcher.ts\n\r\nclass EventDispatcher {\r\n    /**\r\n     * @param target  The object that will be the recipient of events from this event dispatcher\r\n     */\r\n    constructor(target) {\r\n        this._handlers = {};\r\n        this._wiredEventDispatchers = [];\r\n        this._target = target;\r\n    }\r\n    /**\r\n     * Clears any existing handlers or wired event dispatchers on this event dispatcher\r\n     */\r\n    clear() {\r\n        this._handlers = {};\r\n        this._wiredEventDispatchers = [];\r\n    }\r\n    /**\r\n     * Emits an event for target\r\n     * @param eventName  The name of the event to publish\r\n     * @param event      Optionally pass an event data object to the handler\r\n     */\r\n    emit(eventName, event) {\r\n        if (!eventName) {\r\n            // key not mapped\r\n            return;\r\n        }\r\n        eventName = eventName.toLowerCase();\r\n        const target = this._target;\r\n        if (!event) {\r\n            event = new GameEvent();\r\n        }\r\n        try {\r\n            if (!event.target) {\r\n                event.target = target;\r\n            }\r\n        }\r\n        catch (_a) {\r\n            // pass\r\n        }\r\n        let i, len;\r\n        if (this._handlers[eventName]) {\r\n            i = 0;\r\n            len = this._handlers[eventName].length;\r\n            for (i; i < len; i++) {\r\n                this._handlers[eventName][i].call(target, event);\r\n            }\r\n        }\r\n        i = 0;\r\n        len = this._wiredEventDispatchers.length;\r\n        for (i; i < len; i++) {\r\n            this._wiredEventDispatchers[i].emit(eventName, event);\r\n        }\r\n    }\r\n    /**\r\n     * Subscribe an event handler to a particular event name, multiple handlers per event name are allowed.\r\n     * @param eventName  The name of the event to subscribe to\r\n     * @param handler    The handler callback to fire on this event\r\n     */\r\n    on(eventName, handler) {\r\n        eventName = eventName.toLowerCase();\r\n        if (!this._handlers[eventName]) {\r\n            this._handlers[eventName] = [];\r\n        }\r\n        this._handlers[eventName].push(handler);\r\n        // meta event handlers\r\n        if (eventName !== 'unsubscribe' && eventName !== 'subscribe') {\r\n            this.emit('subscribe', new SubscribeEvent(eventName, handler));\r\n        }\r\n    }\r\n    /**\r\n     * Unsubscribe an event handler(s) from an event. If a specific handler\r\n     * is specified for an event, only that handler will be unsubscribed.\r\n     * Otherwise all handlers will be unsubscribed for that event.\r\n     *\r\n     * @param eventName  The name of the event to unsubscribe\r\n     * @param handler    Optionally the specific handler to unsubscribe\r\n     */\r\n    off(eventName, handler) {\r\n        eventName = eventName.toLowerCase();\r\n        const eventHandlers = this._handlers[eventName];\r\n        if (eventHandlers) {\r\n            // if no explicit handler is give with the event name clear all handlers\r\n            if (!handler) {\r\n                this._handlers[eventName].length = 0;\r\n            }\r\n            else {\r\n                const index = eventHandlers.indexOf(handler);\r\n                this._handlers[eventName].splice(index, 1);\r\n            }\r\n        }\r\n        // meta event handlers\r\n        if (eventName !== 'unsubscribe' && eventName !== 'subscribe') {\r\n            this.emit('unsubscribe', new UnsubscribeEvent(eventName, handler));\r\n        }\r\n    }\r\n    /**\r\n     * Once listens to an event one time, then unsubscribes from that event\r\n     *\r\n     * @param eventName The name of the event to subscribe to once\r\n     * @param handler   The handler of the event that will be auto unsubscribed\r\n     */\r\n    once(eventName, handler) {\r\n        const metaHandler = (event) => {\r\n            const ev = event || new GameEvent();\r\n            try {\r\n                ev.target = ev.target || this._target;\r\n            }\r\n            catch (_a) {\r\n                // pass\r\n            }\r\n            this.off(eventName, handler);\r\n            handler.call(ev.target, ev);\r\n        };\r\n        this.on(eventName, metaHandler);\r\n    }\r\n    /**\r\n     * Wires this event dispatcher to also receive events from another\r\n     */\r\n    wire(eventDispatcher) {\r\n        eventDispatcher._wiredEventDispatchers.push(this);\r\n    }\r\n    /**\r\n     * Unwires this event dispatcher from another\r\n     */\r\n    unwire(eventDispatcher) {\r\n        const index = eventDispatcher._wiredEventDispatchers.indexOf(this);\r\n        if (index > -1) {\r\n            eventDispatcher._wiredEventDispatchers.splice(index, 1);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Resources/Resource.ts\n\r\n\r\n/**\r\n * The [[Resource]] type allows games built in Excalibur to load generic resources.\r\n * For any type of remote resource it is recommended to use [[Resource]] for preloading.\r\n */\r\nclass Resource {\r\n    /**\r\n     * @param path          Path to the remote resource\r\n     * @param responseType  The type to expect as a response: \"\" | \"arraybuffer\" | \"blob\" | \"document\" | \"json\" | \"text\";\r\n     * @param bustCache     Whether or not to cache-bust requests\r\n     */\r\n    constructor(path, responseType, bustCache = true) {\r\n        this.path = path;\r\n        this.responseType = responseType;\r\n        this.bustCache = bustCache;\r\n        this.data = null;\r\n        this.logger = Logger.getInstance();\r\n        this.events = new EventDispatcher(this);\r\n    }\r\n    /**\r\n     * Returns true if the Resource is completely loaded and is ready\r\n     * to be drawn.\r\n     */\r\n    isLoaded() {\r\n        return this.data !== null;\r\n    }\r\n    _cacheBust(uri) {\r\n        const query = /\\?\\w*=\\w*/;\r\n        if (query.test(uri)) {\r\n            uri += '&__=' + Date.now();\r\n        }\r\n        else {\r\n            uri += '?__=' + Date.now();\r\n        }\r\n        return uri;\r\n    }\r\n    /**\r\n     * Begin loading the resource and returns a promise to be resolved on completion\r\n     */\r\n    load() {\r\n        return new Promise((resolve, reject) => {\r\n            // Exit early if we already have data\r\n            if (this.data !== null) {\r\n                this.logger.debug('Already have data for resource', this.path);\r\n                this.events.emit('complete', this.data);\r\n                resolve(this.data);\r\n                return;\r\n            }\r\n            const request = new XMLHttpRequest();\r\n            request.open('GET', this.bustCache ? this._cacheBust(this.path) : this.path, true);\r\n            request.responseType = this.responseType;\r\n            request.addEventListener('loadstart', (e) => this.events.emit('loadstart', e));\r\n            request.addEventListener('progress', (e) => this.events.emit('progress', e));\r\n            request.addEventListener('error', (e) => this.events.emit('error', e));\r\n            request.addEventListener('load', (e) => this.events.emit('load', e));\r\n            request.addEventListener('load', () => {\r\n                // XHR on file:// success status is 0, such as with PhantomJS\r\n                if (request.status !== 0 && request.status !== 200) {\r\n                    this.logger.error('Failed to load resource ', this.path, ' server responded with error code', request.status);\r\n                    this.events.emit('error', request.response);\r\n                    reject(new Error(request.statusText));\r\n                    return;\r\n                }\r\n                this.data = request.response;\r\n                this.events.emit('complete', this.data);\r\n                this.logger.debug('Completed loading resource', this.path);\r\n                resolve(this.data);\r\n            });\r\n            request.send();\r\n        });\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Drawing/SpriteEffects.ts\n/**\r\n * @module\r\n * @deprecated\r\n * These effects can be applied to any bitmap image but are mainly used\r\n * for [[Sprite]] effects or [[Animation]] effects.\r\n */\r\nvar SpriteEffects_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n/**\r\n * @typedoc\r\n */\r\n\r\n\r\n/**\r\n * Applies the \"Grayscale\" effect to a sprite, removing color information.\r\n * @deprecated [[Grayscale]] will be removed in v0.26.0\r\n */\r\nlet Grayscale = class Grayscale {\r\n    updatePixel(x, y, imageData) {\r\n        const firstPixel = (x + y * imageData.width) * 4;\r\n        const pixel = imageData.data;\r\n        const avg = (pixel[firstPixel + 0] + pixel[firstPixel + 1] + pixel[firstPixel + 2]) / 3;\r\n        pixel[firstPixel + 0] = avg;\r\n        pixel[firstPixel + 1] = avg;\r\n        pixel[firstPixel + 2] = avg;\r\n    }\r\n};\r\nGrayscale = SpriteEffects_decorate([\r\n    obsolete({\r\n        message: 'Grayscale will be removed in v0.26.0'\r\n    })\r\n], Grayscale);\r\n\r\n/**\r\n * Applies the \"Invert\" effect to a sprite, inverting the pixel colors.\r\n * @deprecated [[Invert]] will be removed in v0.26.0\r\n */\r\nlet Invert = class Invert {\r\n    updatePixel(x, y, imageData) {\r\n        const firstPixel = (x + y * imageData.width) * 4;\r\n        const pixel = imageData.data;\r\n        pixel[firstPixel + 0] = 255 - pixel[firstPixel + 0];\r\n        pixel[firstPixel + 1] = 255 - pixel[firstPixel + 1];\r\n        pixel[firstPixel + 2] = 255 - pixel[firstPixel + 2];\r\n    }\r\n};\r\nInvert = SpriteEffects_decorate([\r\n    obsolete({\r\n        message: 'Invert will be removed in v0.26.0'\r\n    })\r\n], Invert);\r\n\r\n/**\r\n * Applies the \"Opacity\" effect to a sprite, setting the alpha of all pixels to a given value.\r\n * @deprecated [[Opacity]] will be removed in v0.26.0\r\n */\r\nlet Opacity = class Opacity {\r\n    /**\r\n     * @param opacity  The new opacity of the sprite from 0-1.0\r\n     */\r\n    constructor(opacity) {\r\n        this.opacity = opacity;\r\n    }\r\n    updatePixel(x, y, imageData) {\r\n        const firstPixel = (x + y * imageData.width) * 4;\r\n        const pixel = imageData.data;\r\n        if (pixel[firstPixel + 3] !== 0) {\r\n            pixel[firstPixel + 3] = Math.round(this.opacity * pixel[firstPixel + 3]);\r\n        }\r\n    }\r\n};\r\nOpacity = SpriteEffects_decorate([\r\n    obsolete({\r\n        message: 'Opacity will be removed in v0.26.0'\r\n    })\r\n], Opacity);\r\n\r\n/**\r\n * Applies the \"Colorize\" effect to a sprite, changing the color channels of all the pixels to an\r\n * average of the original color and the provided color\r\n * @deprecated [[Colorize]] will be removed in v0.26.0\r\n */\r\nlet Colorize = class Colorize {\r\n    /**\r\n     * @param color  The color to apply to the sprite\r\n     */\r\n    constructor(color) {\r\n        this.color = color;\r\n    }\r\n    updatePixel(x, y, imageData) {\r\n        const firstPixel = (x + y * imageData.width) * 4;\r\n        const pixel = imageData.data;\r\n        if (pixel[firstPixel + 3] !== 0) {\r\n            pixel[firstPixel + 0] = (pixel[firstPixel + 0] + this.color.r) / 2;\r\n            pixel[firstPixel + 1] = (pixel[firstPixel + 1] + this.color.g) / 2;\r\n            pixel[firstPixel + 2] = (pixel[firstPixel + 2] + this.color.b) / 2;\r\n        }\r\n    }\r\n};\r\nColorize = SpriteEffects_decorate([\r\n    obsolete({\r\n        message: 'Colorize will be removed in v0.26.0'\r\n    })\r\n], Colorize);\r\n\r\n/**\r\n * Applies the \"Lighten\" effect to a sprite, changes the lightness of the color according to HSL\r\n * @deprecated [[Lighten]] will be removed in v0.26.0\r\n */\r\nlet Lighten = class Lighten {\r\n    /**\r\n     * @param factor  The factor of the effect between 0-1\r\n     */\r\n    constructor(factor = 0.1) {\r\n        this.factor = factor;\r\n    }\r\n    updatePixel(x, y, imageData) {\r\n        const firstPixel = (x + y * imageData.width) * 4;\r\n        const pixel = imageData.data;\r\n        const color = Color.fromRGB(pixel[firstPixel + 0], pixel[firstPixel + 1], pixel[firstPixel + 2], pixel[firstPixel + 3]).lighten(this.factor);\r\n        pixel[firstPixel + 0] = color.r;\r\n        pixel[firstPixel + 1] = color.g;\r\n        pixel[firstPixel + 2] = color.b;\r\n        pixel[firstPixel + 3] = color.a;\r\n    }\r\n};\r\nLighten = SpriteEffects_decorate([\r\n    obsolete({\r\n        message: 'Lighten will be removed in v0.26.0'\r\n    })\r\n], Lighten);\r\n\r\n/**\r\n * Applies the \"Darken\" effect to a sprite, changes the darkness of the color according to HSL\r\n * @deprecated [[Darken]] will be removed in v0.26.0\r\n */\r\nlet Darken = class Darken {\r\n    /**\r\n     * @param factor  The factor of the effect between 0-1\r\n     */\r\n    constructor(factor = 0.1) {\r\n        this.factor = factor;\r\n    }\r\n    updatePixel(x, y, imageData) {\r\n        const firstPixel = (x + y * imageData.width) * 4;\r\n        const pixel = imageData.data;\r\n        const color = Color.fromRGB(pixel[firstPixel + 0], pixel[firstPixel + 1], pixel[firstPixel + 2], pixel[firstPixel + 3]).darken(this.factor);\r\n        pixel[firstPixel + 0] = color.r;\r\n        pixel[firstPixel + 1] = color.g;\r\n        pixel[firstPixel + 2] = color.b;\r\n        pixel[firstPixel + 3] = color.a;\r\n    }\r\n};\r\nDarken = SpriteEffects_decorate([\r\n    obsolete({\r\n        message: 'Darken will be removed v0.26.0'\r\n    })\r\n], Darken);\r\n\r\n/**\r\n * Applies the \"Saturate\" effect to a sprite, saturates the color according to HSL\r\n * @deprecated [[Saturate]] will be removed in v0.26.0\r\n */\r\nlet Saturate = class Saturate {\r\n    /**\r\n     * @param factor  The factor of the effect between 0-1\r\n     */\r\n    constructor(factor = 0.1) {\r\n        this.factor = factor;\r\n    }\r\n    updatePixel(x, y, imageData) {\r\n        const firstPixel = (x + y * imageData.width) * 4;\r\n        const pixel = imageData.data;\r\n        const color = Color.fromRGB(pixel[firstPixel + 0], pixel[firstPixel + 1], pixel[firstPixel + 2], pixel[firstPixel + 3]).saturate(this.factor);\r\n        pixel[firstPixel + 0] = color.r;\r\n        pixel[firstPixel + 1] = color.g;\r\n        pixel[firstPixel + 2] = color.b;\r\n        pixel[firstPixel + 3] = color.a;\r\n    }\r\n};\r\nSaturate = SpriteEffects_decorate([\r\n    obsolete({\r\n        message: 'Saturate will be removed in v0.26.0'\r\n    })\r\n], Saturate);\r\n\r\n/**\r\n * Applies the \"Desaturate\" effect to a sprite, desaturates the color according to HSL\r\n * @deprecated [[Desaturate]] will be removed in v0.26.0\r\n */\r\nlet Desaturate = class Desaturate {\r\n    /**\r\n     * @param factor  The factor of the effect between 0-1\r\n     */\r\n    constructor(factor = 0.1) {\r\n        this.factor = factor;\r\n    }\r\n    updatePixel(x, y, imageData) {\r\n        const firstPixel = (x + y * imageData.width) * 4;\r\n        const pixel = imageData.data;\r\n        const color = Color.fromRGB(pixel[firstPixel + 0], pixel[firstPixel + 1], pixel[firstPixel + 2], pixel[firstPixel + 3]).desaturate(this.factor);\r\n        pixel[firstPixel + 0] = color.r;\r\n        pixel[firstPixel + 1] = color.g;\r\n        pixel[firstPixel + 2] = color.b;\r\n        pixel[firstPixel + 3] = color.a;\r\n    }\r\n};\r\nDesaturate = SpriteEffects_decorate([\r\n    obsolete({\r\n        message: 'Desaturate will be removed in v0.26.0'\r\n    })\r\n], Desaturate);\r\n\r\n/**\r\n * Applies the \"Fill\" effect to a sprite, changing the color channels of all non-transparent pixels to match\r\n * a given color\r\n * @deprecated [[Fill]] will be removed in v0.26.0\r\n */\r\nlet Fill = class Fill {\r\n    /**\r\n     * @param color  The color to apply to the sprite\r\n     */\r\n    constructor(color) {\r\n        this.color = color;\r\n    }\r\n    updatePixel(x, y, imageData) {\r\n        const firstPixel = (x + y * imageData.width) * 4;\r\n        const pixel = imageData.data;\r\n        if (pixel[firstPixel + 3] !== 0) {\r\n            pixel[firstPixel + 0] = this.color.r;\r\n            pixel[firstPixel + 1] = this.color.g;\r\n            pixel[firstPixel + 2] = this.color.b;\r\n        }\r\n    }\r\n};\r\nFill = SpriteEffects_decorate([\r\n    obsolete({\r\n        message: 'Fill will be removed in v0.26.0'\r\n    })\r\n], Fill);\r\n\r\n\n;// CONCATENATED MODULE: ./Drawing/Texture.ts\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\n\r\n\r\n/**\r\n * The [[Texture]] object allows games built in Excalibur to load image resources.\r\n * [[Texture]] is an [[Loadable]] which means it can be passed to a [[Loader]]\r\n * to pre-load before starting a level or game.\r\n * @deprecated\r\n */\r\nclass Texture {\r\n    /**\r\n     * @param path       Path to the image resource or a base64 string representing an image \"data:image/png;base64,iVB...\"\r\n     * @param bustCache  Optionally load texture with cache busting\r\n     */\r\n    constructor(path, bustCache = true) {\r\n        this.path = path;\r\n        this.bustCache = bustCache;\r\n        this._sprite = null;\r\n        this.loaded = new Promise(resolve => {\r\n            this._loadedResolve = resolve;\r\n        });\r\n        this._resource = new Resource(path, 'blob', bustCache);\r\n        this._sprite = new Sprite_Sprite(this, 0, 0, 0, 0);\r\n    }\r\n    get image() {\r\n        return this.data;\r\n    }\r\n    /**\r\n     * Returns true if the Texture is completely loaded and is ready\r\n     * to be drawn.\r\n     */\r\n    isLoaded() {\r\n        return !!this.data;\r\n    }\r\n    /**\r\n     * Begins loading the texture and returns a promise to be resolved on completion\r\n     */\r\n    load() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            try {\r\n                // Load base64 or blob if needed\r\n                let url;\r\n                if (!this.path.includes('data:image/')) {\r\n                    const blob = yield this._resource.load();\r\n                    url = URL.createObjectURL(blob);\r\n                }\r\n                else {\r\n                    url = this.path;\r\n                }\r\n                // Decode the image\r\n                const image = new Image();\r\n                image.src = url;\r\n                yield image.decode();\r\n                // Set results\r\n                this.data = image;\r\n                this.width = this._sprite.width = image.naturalWidth;\r\n                this.height = this._sprite.height = image.naturalHeight;\r\n                this._sprite = new Sprite_Sprite(this, 0, 0, this.width, this.height);\r\n            }\r\n            catch (_a) {\r\n                yield Promise.reject('Error loading texture');\r\n            }\r\n            // todo emit complete\r\n            this._loadedResolve(this.data);\r\n            return this.data;\r\n        });\r\n    }\r\n    asSprite() {\r\n        return this._sprite;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Configurable.ts\n/**\r\n * Configurable helper extends base type and makes all properties available as option bag arguments\r\n * @internal\r\n * @param base\r\n */\r\nfunction Configurable(base) {\r\n    return class extends base {\r\n        assign(props) {\r\n            //set the value of every property that was passed in,\r\n            //if the constructor previously set this value, it will be overridden here\r\n            for (const k in props) {\r\n                // eslint-disable-next-line\r\n                if (typeof this[k] !== 'function') {\r\n                    // eslint-disable-next-line\r\n                    this[k] = props[k];\r\n                }\r\n            }\r\n        }\r\n        constructor(...args) {\r\n            super(...args);\r\n            //get the number of arguments that aren't undefined. TS passes a value to all parameters\r\n            //of whatever ctor is the implementation, so args.length doesn't work here.\r\n            const size = args.filter(function (value) {\r\n                return value !== undefined;\r\n            }).length;\r\n            if (size === 1 && args[0] && typeof args[0] === 'object' && !(args[0] instanceof Array)) {\r\n                this.assign(args[0]);\r\n            }\r\n        }\r\n    };\r\n}\r\n\n;// CONCATENATED MODULE: ./Drawing/Sprite.ts\nvar Sprite_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar Sprite_awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * @hidden\r\n * @deprecated Use [[Sprite]]\r\n */\r\nclass SpriteImpl {\r\n    /**\r\n     * @param imageOrConfig  The backing image texture to build the Sprite, or Sprite option bag\r\n     * @param x      The x position of the sprite\r\n     * @param y      The y position of the sprite\r\n     * @param width  The width of the sprite in pixels\r\n     * @param height The height of the sprite in pixels\r\n     */\r\n    constructor(imageOrConfig, x, y, width, height) {\r\n        this.x = 0;\r\n        this.y = 0;\r\n        this.rotation = 0.0;\r\n        this.anchor = Vector.Half;\r\n        this.offset = Vector.Zero;\r\n        this.scale = Vector.One;\r\n        /**\r\n         * Default: false, should the sprite be drawn around the anchor or from the top left.\r\n         * Sprite rotations/scaling still happen around the anchor regardless of this setting.\r\n         */\r\n        this.drawAroundAnchor = false;\r\n        this.logger = Logger.getInstance();\r\n        /**\r\n         * Draws the sprite flipped vertically\r\n         */\r\n        this.flipVertical = false;\r\n        /**\r\n         * Draws the sprite flipped horizontally\r\n         */\r\n        this.flipHorizontal = false;\r\n        this.effects = [];\r\n        this.width = 0;\r\n        this.height = 0;\r\n        this._spriteCanvas = null;\r\n        this._spriteCtx = null;\r\n        this._pixelData = null;\r\n        this._pixelsLoaded = false;\r\n        this._dirtyEffect = true;\r\n        this._opacity = 1;\r\n        let image = imageOrConfig;\r\n        if (imageOrConfig && !(imageOrConfig instanceof Texture)) {\r\n            x = imageOrConfig.x | 0;\r\n            y = imageOrConfig.y | 0;\r\n            width = imageOrConfig.width | 0;\r\n            height = imageOrConfig.height | 0;\r\n            image = imageOrConfig.image;\r\n            if (!image) {\r\n                const message = 'An image texture is required to construct a sprite';\r\n                throw new Error(message);\r\n            }\r\n        }\r\n        this.x = x || 0;\r\n        this.y = y || 0;\r\n        this.texture = image;\r\n        this._spriteCanvas = document.createElement('canvas');\r\n        this._spriteCanvas.width = width;\r\n        this._spriteCanvas.height = height;\r\n        this._spriteCtx = this._spriteCanvas.getContext('2d');\r\n        this._initPixelsFromTexture();\r\n        this.width = width;\r\n        this.height = height;\r\n    }\r\n    get drawWidth() {\r\n        return Math.abs(this.width * this.scale.x);\r\n    }\r\n    get drawHeight() {\r\n        return Math.abs(this.height * this.scale.y);\r\n    }\r\n    _initPixelsFromTexture() {\r\n        return Sprite_awaiter(this, void 0, void 0, function* () {\r\n            try {\r\n                const image = yield this.texture.loaded;\r\n                this.width = this.width || image.naturalWidth;\r\n                this.height = this.height || image.naturalHeight;\r\n                this._spriteCanvas.width = this._spriteCanvas.width || image.naturalWidth;\r\n                this._spriteCanvas.height = this._spriteCanvas.height || image.naturalHeight;\r\n                this._loadPixels();\r\n                this._dirtyEffect = true;\r\n            }\r\n            catch (e) {\r\n                this.logger.error('Error loading texture ', this.texture.path, e);\r\n            }\r\n        });\r\n    }\r\n    _loadPixels() {\r\n        if (this.texture.isLoaded() && !this._pixelsLoaded) {\r\n            const naturalWidth = this.texture.image.naturalWidth || 0;\r\n            const naturalHeight = this.texture.image.naturalHeight || 0;\r\n            if (this.width > naturalWidth) {\r\n                this.logger.warn(`The sprite width ${this.width} exceeds the width \r\n                              ${naturalWidth} of the backing texture ${this.texture.path}`);\r\n            }\r\n            if (this.width <= 0 || naturalWidth <= 0) {\r\n                throw new Error(`The width of a sprite cannot be 0 or negative, sprite width: ${this.width}, original width: ${naturalWidth}`);\r\n            }\r\n            if (this.height > naturalHeight) {\r\n                this.logger.warn(`The sprite height ${this.height} exceeds the height \r\n                              ${naturalHeight} of the backing texture ${this.texture.path}`);\r\n            }\r\n            if (this.height <= 0 || naturalHeight <= 0) {\r\n                throw new Error(`The height of a sprite cannot be 0 or negative, sprite height: ${this.height}, original height: ${naturalHeight}`);\r\n            }\r\n            this._flushTexture();\r\n            this._pixelsLoaded = true;\r\n        }\r\n    }\r\n    _flushTexture() {\r\n        const naturalWidth = this.texture.image.naturalWidth || 0;\r\n        const naturalHeight = this.texture.image.naturalHeight || 0;\r\n        this._spriteCtx.clearRect(0, 0, this.width, this.height);\r\n        this._spriteCtx.drawImage(this.texture.image, clamp(this.x, 0, naturalWidth), clamp(this.y, 0, naturalHeight), clamp(this.width, 0, naturalWidth), clamp(this.height, 0, naturalHeight), 0, 0, this.width, this.height);\r\n    }\r\n    /**\r\n     * Applies the [[Opacity]] effect to a sprite, setting the alpha of all pixels to a given value\r\n     */\r\n    opacity(value) {\r\n        this._opacity = value;\r\n    }\r\n    /**\r\n     * Applies the [[Grayscale]] effect to a sprite, removing color information.\r\n     */\r\n    grayscale() {\r\n        this.addEffect(new Grayscale());\r\n    }\r\n    /**\r\n     * Applies the [[Invert]] effect to a sprite, inverting the pixel colors.\r\n     */\r\n    invert() {\r\n        this.addEffect(new Invert());\r\n    }\r\n    /**\r\n     * Applies the [[Fill]] effect to a sprite, changing the color channels of all non-transparent pixels to match a given color\r\n     */\r\n    fill(color) {\r\n        this.addEffect(new Fill(color));\r\n    }\r\n    /**\r\n     * Applies the [[Colorize]] effect to a sprite, changing the color channels of all pixels to be the average of the original color\r\n     * and the provided color.\r\n     */\r\n    colorize(color) {\r\n        this.addEffect(new Colorize(color));\r\n    }\r\n    /**\r\n     * Applies the [[Lighten]] effect to a sprite, changes the lightness of the color according to HSL\r\n     */\r\n    lighten(factor = 0.1) {\r\n        this.addEffect(new Lighten(factor));\r\n    }\r\n    /**\r\n     * Applies the [[Darken]] effect to a sprite, changes the darkness of the color according to HSL\r\n     */\r\n    darken(factor = 0.1) {\r\n        this.addEffect(new Darken(factor));\r\n    }\r\n    /**\r\n     * Applies the [[Saturate]] effect to a sprite, saturates the color according to HSL\r\n     */\r\n    saturate(factor = 0.1) {\r\n        this.addEffect(new Saturate(factor));\r\n    }\r\n    /**\r\n     * Applies the [[Desaturate]] effect to a sprite, desaturates the color according to HSL\r\n     */\r\n    desaturate(factor = 0.1) {\r\n        this.addEffect(new Desaturate(factor));\r\n    }\r\n    /**\r\n     * Adds a new [[SpriteEffect]] to this drawing.\r\n     * @param effect  Effect to add to the this drawing\r\n     */\r\n    addEffect(effect) {\r\n        this.effects.push(effect);\r\n        // We must check if the texture and the backing sprite pixels are loaded as well before\r\n        // an effect can be applied\r\n        if (!this.texture.isLoaded() || !this._pixelsLoaded) {\r\n            this._dirtyEffect = true;\r\n        }\r\n        else {\r\n            this._applyEffects();\r\n        }\r\n    }\r\n    removeEffect(param) {\r\n        let indexToRemove = -1;\r\n        if (typeof param === 'number') {\r\n            indexToRemove = param;\r\n        }\r\n        else {\r\n            indexToRemove = this.effects.indexOf(param);\r\n        }\r\n        // bounds check\r\n        if (indexToRemove < 0 || indexToRemove >= this.effects.length) {\r\n            return;\r\n        }\r\n        this.effects.splice(indexToRemove, 1);\r\n        // We must check if the texture and the backing sprite pixels are loaded as well before\r\n        // an effect can be applied\r\n        if (!this.texture.isLoaded() || !this._pixelsLoaded) {\r\n            this._dirtyEffect = true;\r\n        }\r\n        else {\r\n            this._applyEffects();\r\n        }\r\n    }\r\n    _applyEffects() {\r\n        this._flushTexture();\r\n        if (this.effects.length > 0) {\r\n            this._pixelData = this._spriteCtx.getImageData(0, 0, this.width, this.height);\r\n            const len = this.effects.length;\r\n            for (let i = 0; i < len; i++) {\r\n                for (let y = 0; y < this.height; y++) {\r\n                    for (let x = 0; x < this.width; x++) {\r\n                        this.effects[i].updatePixel(x, y, this._pixelData);\r\n                    }\r\n                }\r\n            }\r\n            this._spriteCtx.clearRect(0, 0, this.width, this.height);\r\n            this._spriteCtx.putImageData(this._pixelData, 0, 0);\r\n        }\r\n        this._dirtyEffect = false;\r\n    }\r\n    /**\r\n     * Clears all effects from the drawing and return it to its original state.\r\n     */\r\n    clearEffects() {\r\n        this.effects.length = 0;\r\n        this._applyEffects();\r\n    }\r\n    /**\r\n     * Resets the internal state of the drawing (if any)\r\n     */\r\n    reset() {\r\n        // do nothing\r\n    }\r\n    debugDraw(ctx, x, y) {\r\n        ctx.save();\r\n        ctx.translate(x, y);\r\n        ctx.rotate(this.rotation);\r\n        const xpoint = this.drawWidth * this.anchor.x;\r\n        const ypoint = this.drawHeight * this.anchor.y;\r\n        ctx.strokeStyle = Color.Black.toString();\r\n        ctx.strokeRect(-xpoint, -ypoint, this.drawWidth, this.drawHeight);\r\n        ctx.restore();\r\n    }\r\n    draw(ctxOrOptions, x, y) {\r\n        if (ctxOrOptions instanceof CanvasRenderingContext2D) {\r\n            this._drawWithOptions({ ctx: ctxOrOptions, x, y });\r\n        }\r\n        else {\r\n            this._drawWithOptions(ctxOrOptions);\r\n        }\r\n    }\r\n    _drawWithOptions(options) {\r\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j;\r\n        const { ctx, x, y, rotation, drawWidth, drawHeight, anchor, offset, opacity, flipHorizontal, flipVertical } = Object.assign(Object.assign({}, options), { rotation: (_a = options.rotation) !== null && _a !== void 0 ? _a : this.rotation, drawWidth: (_b = options.drawWidth) !== null && _b !== void 0 ? _b : this.width, drawHeight: (_c = options.drawHeight) !== null && _c !== void 0 ? _c : this.height, flipHorizontal: (_d = options.flipHorizontal) !== null && _d !== void 0 ? _d : this.flipHorizontal, flipVertical: (_e = options.flipVertical) !== null && _e !== void 0 ? _e : this.flipVertical, anchor: (_f = options.anchor) !== null && _f !== void 0 ? _f : this.anchor, offset: (_g = options.offset) !== null && _g !== void 0 ? _g : this.offset, opacity: ((_h = options.opacity) !== null && _h !== void 0 ? _h : 1) * ((_j = this._opacity) !== null && _j !== void 0 ? _j : 1) });\r\n        if (this._dirtyEffect) {\r\n            this._applyEffects();\r\n        }\r\n        // calculating current dimensions\r\n        const anchorX = drawWidth * anchor.x + offset.x;\r\n        const anchorY = drawHeight * anchor.y + offset.y;\r\n        const scaleDirX = this.scale.x > 0 ? 1 : -1;\r\n        const scaleDirY = this.scale.y > 0 ? 1 : -1;\r\n        ctx.save();\r\n        // Move the draw point of origin\r\n        ctx.translate(x, y);\r\n        // Rotate and scale around anchor point\r\n        // This requires a bit of explaination, scale coordinates first positive flipping or rotating\r\n        ctx.scale(Math.abs(this.scale.x), Math.abs(this.scale.y));\r\n        if (this.drawAroundAnchor) {\r\n            // In the case where you want the anchor to match with the point of draw\r\n            // Otherwise sprites are always drawn from top-left\r\n            ctx.translate(-anchorX, -anchorY);\r\n        }\r\n        ctx.translate(anchorX, anchorY);\r\n        ctx.rotate(rotation);\r\n        // This is for handling direction changes 1 or -1, that way we don't have mismatched translates()\r\n        ctx.scale(scaleDirX, scaleDirY);\r\n        ctx.translate(-anchorX, -anchorY);\r\n        if (flipHorizontal) {\r\n            ctx.translate(drawWidth, 0);\r\n            ctx.scale(-1, 1);\r\n        }\r\n        if (flipVertical) {\r\n            ctx.translate(0, drawHeight);\r\n            ctx.scale(1, -1);\r\n        }\r\n        const oldAlpha = ctx.globalAlpha;\r\n        ctx.globalAlpha = opacity;\r\n        // Context is already rotated and scaled\r\n        ctx.drawImage(this._spriteCanvas, 0, 0, this.width, this.height, // source\r\n        0, 0, this.width, this.height); // dest\r\n        ctx.globalAlpha = oldAlpha;\r\n        ctx.restore();\r\n    }\r\n    /**\r\n     * Produces a copy of the current sprite\r\n     */\r\n    clone() {\r\n        const result = new Sprite_Sprite(this.texture, this.x, this.y, this.width, this.height);\r\n        result.anchor = this.anchor.clone();\r\n        result.scale = this.scale.clone();\r\n        result.rotation = this.rotation;\r\n        result.flipHorizontal = this.flipHorizontal;\r\n        result.flipVertical = this.flipVertical;\r\n        const len = this.effects.length;\r\n        for (let i = 0; i < len; i++) {\r\n            result.addEffect(this.effects[i]);\r\n        }\r\n        return result;\r\n    }\r\n}\r\n/**\r\n * A [[LegacyDrawing.Sprite]] is one of the main drawing primitives. It is responsible for drawing\r\n * images or parts of images from a [[LegacyDrawing.Texture]] resource to the screen.\r\n * @deprecated Use [[Sprite]]\r\n */\r\nlet Sprite_Sprite = class Sprite extends Configurable(SpriteImpl) {\r\n    constructor(imageOrConfig, x, y, width, height) {\r\n        super(imageOrConfig, x, y, width, height);\r\n    }\r\n};\r\nSprite_Sprite = Sprite_decorate([\r\n    obsolete({\r\n        message: 'Label.clearTextShadow will be removed in v0.26.0',\r\n        alternateMethod: 'Use Label.font.shadow'\r\n    })\r\n], Sprite_Sprite);\r\n\r\n\n;// CONCATENATED MODULE: ./Graphics/Sprite.ts\n\r\n\r\n\r\n\r\nclass Sprite extends Graphic {\r\n    constructor(options) {\r\n        var _a, _b;\r\n        super(options);\r\n        this.image = options.image;\r\n        const { width, height } = options;\r\n        this.sourceView = (_a = options.sourceView) !== null && _a !== void 0 ? _a : { x: 0, y: 0, width: width !== null && width !== void 0 ? width : 0, height: height !== null && height !== void 0 ? height : 0 };\r\n        this.destSize = (_b = options.destSize) !== null && _b !== void 0 ? _b : { width: width !== null && width !== void 0 ? width : 0, height: height !== null && height !== void 0 ? height : 0 };\r\n        this._updateSpriteDimensions();\r\n        this.image.ready.then(() => {\r\n            this._updateSpriteDimensions();\r\n        });\r\n    }\r\n    static from(image) {\r\n        return new Sprite({\r\n            image: image\r\n        });\r\n    }\r\n    _updateSpriteDimensions() {\r\n        var _a, _b, _c, _d, _e, _f;\r\n        const { width: nativeWidth, height: nativeHeight } = this.image;\r\n        // This code uses || to avoid 0's\r\n        // If the source is not specified, use the native dimension\r\n        this.sourceView.width = ((_a = this.sourceView) === null || _a === void 0 ? void 0 : _a.width) || nativeWidth;\r\n        this.sourceView.height = ((_b = this.sourceView) === null || _b === void 0 ? void 0 : _b.height) || nativeHeight;\r\n        // If the destination is not specified, use the source if specified, then native\r\n        this.destSize.width = ((_c = this.destSize) === null || _c === void 0 ? void 0 : _c.width) || ((_d = this.sourceView) === null || _d === void 0 ? void 0 : _d.width) || nativeWidth;\r\n        this.destSize.height = ((_e = this.destSize) === null || _e === void 0 ? void 0 : _e.height) || ((_f = this.sourceView) === null || _f === void 0 ? void 0 : _f.height) || nativeHeight;\r\n        this.width = Math.ceil(this.destSize.width);\r\n        this.height = Math.ceil(this.destSize.height);\r\n    }\r\n    _preDraw(ex, x, y) {\r\n        if (this.image.isLoaded()) {\r\n            this._updateSpriteDimensions();\r\n        }\r\n        super._preDraw(ex, x, y);\r\n    }\r\n    _drawImage(ex, x, y) {\r\n        if (this.image.isLoaded()) {\r\n            this._updateSpriteDimensions();\r\n            ex.drawImage(this.image.image, this.sourceView.x, this.sourceView.y, this.sourceView.width, this.sourceView.height, x, y, this.destSize.width, this.destSize.height);\r\n        }\r\n    }\r\n    /**\r\n     * Create a ImageSource from legacy texture\r\n     * @param sprite\r\n     */\r\n    static fromLegacySprite(sprite) {\r\n        const tex = sprite.texture;\r\n        const image = ImageSource.fromLegacyTexture(tex);\r\n        return new Sprite({\r\n            image,\r\n            sourceView: {\r\n                x: sprite.x,\r\n                y: sprite.y,\r\n                width: sprite.width,\r\n                height: sprite.height\r\n            }\r\n        });\r\n    }\r\n    /**\r\n     * Converts a sprite to a Legacy sprite\r\n     * @deprecated\r\n     * @param sprite\r\n     * @returns LegacyDrawing.Sprite\r\n     */\r\n    static toLegacySprite(sprite) {\r\n        const image = sprite.image;\r\n        const tex = new Texture(image.path);\r\n        tex.data = image.image;\r\n        return new Sprite_Sprite(tex, sprite.sourceView.x, sprite.sourceView.y, sprite.sourceView.width, sprite.sourceView.height);\r\n    }\r\n    clone() {\r\n        return new Sprite(Object.assign({ image: this.image, sourceView: Object.assign({}, this.sourceView), destSize: Object.assign({}, this.destSize) }, this.cloneGraphicOptions()));\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/ImageSource.ts\nvar ImageSource_awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\n\r\n\r\n\r\nclass ImageSource {\r\n    /**\r\n     * The path to the image, can also be a data url like 'data:image/'\r\n     * @param path\r\n     */\r\n    constructor(path, bustCache = false) {\r\n        this.path = path;\r\n        this._logger = Logger.getInstance();\r\n        /**\r\n         * Access to the underlying html image elmeent\r\n         */\r\n        this.data = new Image();\r\n        this._resource = new Resource(path, 'blob', bustCache);\r\n        if (path.endsWith('.svg') || path.endsWith('.gif')) {\r\n            this._logger.warn(`Image type is not fully supported, you may have mixed results ${path}. Fully supported: jpg, bmp, and png`);\r\n        }\r\n        this.ready = new Promise((resolve) => {\r\n            this._loadedResolve = resolve;\r\n        });\r\n    }\r\n    /**\r\n     * The original size of the source image in pixels\r\n     */\r\n    get width() {\r\n        return this.image.naturalWidth;\r\n    }\r\n    /**\r\n     * The original height of the source image in pixels\r\n     */\r\n    get height() {\r\n        return this.image.naturalHeight;\r\n    }\r\n    /**\r\n     * Returns true if the Texture is completely loaded and is ready\r\n     * to be drawn.\r\n     */\r\n    isLoaded() {\r\n        return !!this.data.src;\r\n    }\r\n    get image() {\r\n        return this.data;\r\n    }\r\n    /**\r\n     * Begins loading the image and returns a promise that resolves when the image is loaded\r\n     */\r\n    load() {\r\n        return ImageSource_awaiter(this, void 0, void 0, function* () {\r\n            if (this.isLoaded()) {\r\n                return this.data;\r\n            }\r\n            try {\r\n                // Load base64 or blob if needed\r\n                let url;\r\n                if (!this.path.includes('data:image/')) {\r\n                    const blob = yield this._resource.load();\r\n                    url = URL.createObjectURL(blob);\r\n                }\r\n                else {\r\n                    url = this.path;\r\n                }\r\n                // Decode the image\r\n                const image = new Image();\r\n                image.src = url;\r\n                yield image.decode();\r\n                // Set results\r\n                this.data = image;\r\n            }\r\n            catch (error) {\r\n                throw `Error loading ImageSource from path '${this.path}' with error [${error.message}]`;\r\n            }\r\n            // todo emit complete\r\n            this._loadedResolve(this.data);\r\n            return this.data;\r\n        });\r\n    }\r\n    /**\r\n     * Build a sprite from this ImageSource\r\n     */\r\n    toSprite() {\r\n        return Sprite.from(this);\r\n    }\r\n    /**\r\n     * Create a ImageSource from legacy texture\r\n     * @param tex\r\n     */\r\n    static fromLegacyTexture(tex) {\r\n        const image = new ImageSource(tex.path);\r\n        if (tex.isLoaded()) {\r\n            image.data = tex.data;\r\n        }\r\n        else {\r\n            tex.loaded.then(() => {\r\n                image.data = tex.data;\r\n            });\r\n        }\r\n        return image;\r\n    }\r\n    /**\r\n     * Unload images from memory\r\n     */\r\n    unload() {\r\n        this.data = new Image();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Drawing/Animation.ts\nvar Animation_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * @hidden\r\n * @deprecated Use [[Animation]]\r\n */\r\nclass AnimationImpl {\r\n    /**\r\n     * Typically you will use a [[SpriteSheet]] to generate an [[Animation]].\r\n     *\r\n     * @param engineOrConfig  Reference to the current game engine\r\n     * @param sprites  An array of sprites to create the frames for the animation\r\n     * @param speed   The number in milliseconds to display each frame in the animation\r\n     * @param loop    Indicates whether the animation should loop after it is completed\r\n     */\r\n    constructor(engineOrConfig, sprites, speed, loop) {\r\n        /**\r\n         * The sprite frames to play, in order. See [[SpriteSheet.getAnimationForAll]] to quickly\r\n         * generate an [[Animation]].\r\n         */\r\n        this.sprites = [];\r\n        /**\r\n         * Current frame index being shown\r\n         */\r\n        this.currentFrame = 0;\r\n        this._timeLeftInFrame = 0;\r\n        this._idempotencyToken = -1;\r\n        this.anchor = Vector.Zero;\r\n        this.rotation = 0.0;\r\n        this.scale = Vector.One;\r\n        /**\r\n         * Indicates whether the animation should loop after it is completed\r\n         */\r\n        this.loop = true;\r\n        /**\r\n         * Indicates the frame index the animation should freeze on for a non-looping\r\n         * animation. By default it is the last frame.\r\n         */\r\n        this.freezeFrame = -1;\r\n        /**\r\n         * Flip each frame vertically. Sets [[Sprite.flipVertical]].\r\n         */\r\n        this.flipVertical = false;\r\n        /**\r\n         * Flip each frame horizontally. Sets [[Sprite.flipHorizontal]].\r\n         */\r\n        this.flipHorizontal = false;\r\n        this.drawWidth = 0;\r\n        this.drawHeight = 0;\r\n        this.width = 0;\r\n        this.height = 0;\r\n        this._opacity = 1;\r\n        let engine = engineOrConfig;\r\n        if (engineOrConfig && !(engineOrConfig instanceof Engine)) {\r\n            const config = engineOrConfig;\r\n            engine = config.engine;\r\n            sprites = config.sprites;\r\n            speed = config.speed;\r\n            loop = config.loop;\r\n        }\r\n        this.sprites = sprites;\r\n        this.speed = speed;\r\n        this._engine = engine;\r\n        this._timeLeftInFrame = this.speed;\r\n        if (loop != null) {\r\n            this.loop = loop;\r\n        }\r\n        if (sprites && sprites[0]) {\r\n            this.drawHeight = sprites[0] ? sprites[0].drawHeight : 0;\r\n            this.drawWidth = sprites[0] ? sprites[0].drawWidth : 0;\r\n            this.width = sprites[0] ? sprites[0].width : 0;\r\n            this.height = sprites[0] ? sprites[0].height : 0;\r\n            this.freezeFrame = sprites.length - 1;\r\n        }\r\n    }\r\n    /**\r\n     * Applies the opacity effect to a sprite, setting the alpha of all pixels to a given value\r\n     */\r\n    opacity(value) {\r\n        this._opacity = value;\r\n    }\r\n    /**\r\n     * Applies the grayscale effect to a sprite, removing color information.\r\n     */\r\n    grayscale() {\r\n        this.addEffect(new Grayscale());\r\n    }\r\n    /**\r\n     * Applies the invert effect to a sprite, inverting the pixel colors.\r\n     */\r\n    invert() {\r\n        this.addEffect(new Invert());\r\n    }\r\n    /**\r\n     * Applies the fill effect to a sprite, changing the color channels of all non-transparent pixels to match a given color\r\n     */\r\n    fill(color) {\r\n        this.addEffect(new Fill(color));\r\n    }\r\n    /**\r\n     * Applies the colorize effect to a sprite, changing the color channels of all pixels to be the average of the original color and the\r\n     * provided color.\r\n     */\r\n    colorize(color) {\r\n        this.addEffect(new Colorize(color));\r\n    }\r\n    /**\r\n     * Applies the lighten effect to a sprite, changes the lightness of the color according to hsl\r\n     */\r\n    lighten(factor = 0.1) {\r\n        this.addEffect(new Lighten(factor));\r\n    }\r\n    /**\r\n     * Applies the darken effect to a sprite, changes the darkness of the color according to hsl\r\n     */\r\n    darken(factor = 0.1) {\r\n        this.addEffect(new Darken(factor));\r\n    }\r\n    /**\r\n     * Applies the saturate effect to a sprite, saturates the color according to hsl\r\n     */\r\n    saturate(factor = 0.1) {\r\n        this.addEffect(new Saturate(factor));\r\n    }\r\n    /**\r\n     * Applies the desaturate effect to a sprite, desaturates the color according to hsl\r\n     */\r\n    desaturate(factor = 0.1) {\r\n        this.addEffect(new Desaturate(factor));\r\n    }\r\n    /**\r\n     * Add a [[SpriteEffect]] manually\r\n     */\r\n    addEffect(effect) {\r\n        for (const i in this.sprites) {\r\n            this.sprites[i].addEffect(effect);\r\n        }\r\n    }\r\n    removeEffect(param) {\r\n        for (const i in this.sprites) {\r\n            this.sprites[i].removeEffect(param);\r\n        }\r\n    }\r\n    /**\r\n     * Clear all sprite effects\r\n     */\r\n    clearEffects() {\r\n        for (const i in this.sprites) {\r\n            this.sprites[i].clearEffects();\r\n        }\r\n    }\r\n    _setAnchor(point) {\r\n        //if (!this.anchor.equals(point)) {\r\n        for (const i in this.sprites) {\r\n            this.sprites[i].anchor.setTo(point.x, point.y);\r\n        }\r\n        //}\r\n    }\r\n    _setRotation(radians) {\r\n        //if (this.rotation !== radians) {\r\n        for (const i in this.sprites) {\r\n            this.sprites[i].rotation = radians;\r\n        }\r\n        //}\r\n    }\r\n    _setScale(scale) {\r\n        //if (!this.scale.equals(scale)) {\r\n        for (const i in this.sprites) {\r\n            this.sprites[i].scale = scale;\r\n        }\r\n        //}\r\n    }\r\n    /**\r\n     * Resets the animation to first frame.\r\n     */\r\n    reset() {\r\n        this.currentFrame = 0;\r\n    }\r\n    /**\r\n     * Indicates whether the animation is complete, animations that loop are never complete.\r\n     */\r\n    isDone() {\r\n        return !this.loop && this.currentFrame >= this.sprites.length;\r\n    }\r\n    /**\r\n     * Not meant to be called by game developers. Ticks the animation forward internally and\r\n     * calculates whether to change to the frame.\r\n     * @internal\r\n     */\r\n    tick(elapsed, idempotencyToken) {\r\n        if (this._idempotencyToken === idempotencyToken) {\r\n            return;\r\n        }\r\n        this._idempotencyToken = idempotencyToken;\r\n        this._timeLeftInFrame -= elapsed;\r\n        if (this._timeLeftInFrame <= 0) {\r\n            this.currentFrame = this.loop ? (this.currentFrame + 1) % this.sprites.length : this.currentFrame + 1;\r\n            this._timeLeftInFrame = this.speed;\r\n        }\r\n        this._updateValues();\r\n        const current = this.sprites[this.currentFrame];\r\n        if (current) {\r\n            this.width = current.width;\r\n            this.height = current.height;\r\n            this.drawWidth = current.drawWidth;\r\n            this.drawHeight = current.drawHeight;\r\n        }\r\n    }\r\n    _updateValues() {\r\n        this._setAnchor(this.anchor);\r\n        this._setRotation(this.rotation);\r\n        this._setScale(this.scale);\r\n    }\r\n    /**\r\n     * Skips ahead a specified number of frames in the animation\r\n     * @param frames  Frames to skip ahead\r\n     */\r\n    skip(frames) {\r\n        this.currentFrame = (this.currentFrame + frames) % this.sprites.length;\r\n    }\r\n    draw(ctxOrOptions, x, y) {\r\n        if (ctxOrOptions instanceof CanvasRenderingContext2D) {\r\n            this._drawWithOptions({ ctx: ctxOrOptions, x, y });\r\n        }\r\n        else {\r\n            this._drawWithOptions(ctxOrOptions);\r\n        }\r\n    }\r\n    _drawWithOptions(options) {\r\n        var _a, _b, _c, _d, _e, _f, _g, _h;\r\n        const animOptions = Object.assign(Object.assign({}, options), { rotation: (_a = options.rotation) !== null && _a !== void 0 ? _a : this.rotation, drawWidth: (_b = options.drawWidth) !== null && _b !== void 0 ? _b : this.drawWidth, drawHeight: (_c = options.drawHeight) !== null && _c !== void 0 ? _c : this.drawHeight, flipHorizontal: (_d = options.flipHorizontal) !== null && _d !== void 0 ? _d : this.flipHorizontal, flipVertical: (_e = options.flipVertical) !== null && _e !== void 0 ? _e : this.flipVertical, anchor: (_f = options.anchor) !== null && _f !== void 0 ? _f : this.anchor, opacity: ((_g = options.opacity) !== null && _g !== void 0 ? _g : 1) * ((_h = this._opacity) !== null && _h !== void 0 ? _h : 1) });\r\n        this._updateValues();\r\n        let currSprite;\r\n        if (this.currentFrame < this.sprites.length) {\r\n            currSprite = this.sprites[this.currentFrame];\r\n            currSprite.draw(animOptions);\r\n        }\r\n        if (this.freezeFrame !== -1 && this.currentFrame >= this.sprites.length) {\r\n            currSprite = this.sprites[clamp(this.freezeFrame, 0, this.sprites.length - 1)];\r\n            currSprite.draw(animOptions);\r\n        }\r\n        // add the calculated width\r\n        if (currSprite) {\r\n            this.drawWidth = currSprite.drawWidth;\r\n            this.drawHeight = currSprite.drawHeight;\r\n        }\r\n    }\r\n    /**\r\n     * Plays an animation at an arbitrary location in the game.\r\n     * @param x  The x position in the game to play\r\n     * @param y  The y position in the game to play\r\n     */\r\n    play(x, y) {\r\n        this.reset();\r\n        this._engine.playAnimation(this, x, y);\r\n    }\r\n}\r\n/**\r\n * Animations allow you to display a series of images one after another,\r\n * creating the illusion of change. Generally these images will come from a [[SpriteSheet]] source.\r\n * @deprecated Use [[Animation]]\r\n */\r\nlet Animation_Animation = class Animation extends Configurable(AnimationImpl) {\r\n    constructor(engineOrConfig, images, speed, loop) {\r\n        super(engineOrConfig, images, speed, loop);\r\n    }\r\n};\r\nAnimation_Animation = Animation_decorate([\r\n    obsolete({\r\n        message: 'Animation will be removed in v0.26.0',\r\n        alternateMethod: 'Use Graphics.Animation'\r\n    })\r\n], Animation_Animation);\r\n\r\n\n;// CONCATENATED MODULE: ./Graphics/FontCommon.ts\n/**\r\n * Enum representing the different font size units\r\n * https://developer.mozilla.org/en-US/docs/Web/CSS/font-size\r\n */\r\nvar FontUnit;\r\n(function (FontUnit) {\r\n    /**\r\n     * Em is a scalable unit, 1 em is equal to the current font size of the current element, parent elements can effect em values\r\n     */\r\n    FontUnit[\"Em\"] = \"em\";\r\n    /**\r\n     * Rem is similar to the Em, it is a scalable unit. 1 rem is equal to the font size of the root element\r\n     */\r\n    FontUnit[\"Rem\"] = \"rem\";\r\n    /**\r\n     * Pixel is a unit of length in screen pixels\r\n     */\r\n    FontUnit[\"Px\"] = \"px\";\r\n    /**\r\n     * Point is a physical unit length (1/72 of an inch)\r\n     */\r\n    FontUnit[\"Pt\"] = \"pt\";\r\n    /**\r\n     * Percent is a scalable unit similar to Em, the only difference is the Em units scale faster when Text-Size stuff\r\n     */\r\n    FontUnit[\"Percent\"] = \"%\";\r\n})(FontUnit || (FontUnit = {}));\r\n/**\r\n * Enum representing the different horizontal text alignments\r\n */\r\nvar TextAlign;\r\n(function (TextAlign) {\r\n    /**\r\n     * The text is left-aligned.\r\n     */\r\n    TextAlign[\"Left\"] = \"left\";\r\n    /**\r\n     * The text is right-aligned.\r\n     */\r\n    TextAlign[\"Right\"] = \"right\";\r\n    /**\r\n     * The text is centered.\r\n     */\r\n    TextAlign[\"Center\"] = \"center\";\r\n    /**\r\n     * The text is aligned at the normal start of the line (left-aligned for left-to-right locales,\r\n     * right-aligned for right-to-left locales).\r\n     */\r\n    TextAlign[\"Start\"] = \"start\";\r\n    /**\r\n     * The text is aligned at the normal end of the line (right-aligned for left-to-right locales,\r\n     * left-aligned for right-to-left locales).\r\n     */\r\n    TextAlign[\"End\"] = \"end\";\r\n})(TextAlign || (TextAlign = {}));\r\n/**\r\n * Enum representing the different baseline text alignments\r\n */\r\nvar BaseAlign;\r\n(function (BaseAlign) {\r\n    /**\r\n     * The text baseline is the top of the em square.\r\n     */\r\n    BaseAlign[\"Top\"] = \"top\";\r\n    /**\r\n     * The text baseline is the hanging baseline.  Currently unsupported; this will act like\r\n     * alphabetic.\r\n     */\r\n    BaseAlign[\"Hanging\"] = \"hanging\";\r\n    /**\r\n     * The text baseline is the middle of the em square.\r\n     */\r\n    BaseAlign[\"Middle\"] = \"middle\";\r\n    /**\r\n     * The text baseline is the normal alphabetic baseline.\r\n     */\r\n    BaseAlign[\"Alphabetic\"] = \"alphabetic\";\r\n    /**\r\n     * The text baseline is the ideographic baseline; this is the bottom of\r\n     * the body of the characters, if the main body of characters protrudes\r\n     * beneath the alphabetic baseline.  Currently unsupported; this will\r\n     * act like alphabetic.\r\n     */\r\n    BaseAlign[\"Ideographic\"] = \"ideographic\";\r\n    /**\r\n     * The text baseline is the bottom of the bounding box.  This differs\r\n     * from the ideographic baseline in that the ideographic baseline\r\n     * doesn't consider descenders.\r\n     */\r\n    BaseAlign[\"Bottom\"] = \"bottom\";\r\n})(BaseAlign || (BaseAlign = {}));\r\n/**\r\n * Enum representing the different possible font styles\r\n */\r\nvar FontStyle;\r\n(function (FontStyle) {\r\n    FontStyle[\"Normal\"] = \"normal\";\r\n    FontStyle[\"Italic\"] = \"italic\";\r\n    FontStyle[\"Oblique\"] = \"oblique\";\r\n})(FontStyle || (FontStyle = {}));\r\nvar Direction;\r\n(function (Direction) {\r\n    Direction[\"LeftToRight\"] = \"ltr\";\r\n    Direction[\"RightToLeft\"] = \"rtl\";\r\n})(Direction || (Direction = {}));\r\n\n;// CONCATENATED MODULE: ./Drawing/SpriteSheet.ts\nvar SpriteSheet_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Sprite sheets are a useful mechanism for slicing up image resources into\r\n * separate sprites or for generating in game animations. [[Sprite|Sprites]] are organized\r\n * in row major order in the [[SpriteSheet]].\r\n * @deprecated Will be removed in v0.26.0\r\n */\r\nclass SpriteSheet_SpriteSheet {\r\n    /**\r\n     * @param imageOrConfigOrSprites The backing image texture to build the SpriteSheet, option bag, or sprite list\r\n     * @param columns   The number of columns in the image texture\r\n     * @param rows      The number of rows in the image texture\r\n     * @param spWidth   The width of each individual sprite in pixels\r\n     * @param spHeight  The height of each individual sprite in pixels\r\n     * @param spacing   The spacing between every sprite in a spritesheet\r\n     */\r\n    constructor(imageOrConfigOrSprites, columns, rows, spWidth, spHeight, spacing) {\r\n        this._sprites = [];\r\n        this._image = null;\r\n        this._columns = 0;\r\n        this._rows = 0;\r\n        this._spWidth = 0;\r\n        this._spHeight = 0;\r\n        this._spacing = 0;\r\n        let loadFromImage = false;\r\n        if (imageOrConfigOrSprites instanceof Array) {\r\n            this._sprites = imageOrConfigOrSprites;\r\n        }\r\n        else {\r\n            if (imageOrConfigOrSprites && !(imageOrConfigOrSprites instanceof Texture)) {\r\n                this._columns = imageOrConfigOrSprites.columns;\r\n                this._rows = imageOrConfigOrSprites.rows;\r\n                this._spWidth = imageOrConfigOrSprites.spWidth;\r\n                this._spHeight = imageOrConfigOrSprites.spHeight;\r\n                this._image = imageOrConfigOrSprites.image;\r\n                this._spacing = imageOrConfigOrSprites.spacing || 0;\r\n            }\r\n            else {\r\n                this._image = imageOrConfigOrSprites;\r\n                this._columns = columns;\r\n                this._rows = rows;\r\n                this._spWidth = spWidth;\r\n                this._spHeight = spHeight;\r\n                this._spacing = spacing || 0;\r\n            }\r\n            this._sprites = new Array(this._columns * this._rows);\r\n            loadFromImage = true;\r\n        }\r\n        // Inspect actual image dimensions with preloading\r\n        if (this.image instanceof Texture) {\r\n            let isWidthError = false;\r\n            let isHeightError = false;\r\n            if (this.image.isLoaded()) {\r\n                isWidthError = this.spWidth * this.columns > this.image.image.naturalWidth;\r\n                isHeightError = this.spHeight * this.rows > this.image.image.naturalHeight;\r\n                if (isWidthError) {\r\n                    throw new RangeError(`SpriteSheet specified is wider, ` +\r\n                        `${this.columns} cols x ${this.spWidth} pixels > ${this.image.image.naturalWidth} ` +\r\n                        `pixels than image width`);\r\n                }\r\n                if (isHeightError) {\r\n                    throw new RangeError(`SpriteSheet specified is taller, ` +\r\n                        `${this.rows} rows x ${this.spHeight} pixels > ${this.image.image.naturalHeight} ` +\r\n                        `pixels than image height`);\r\n                }\r\n            }\r\n        }\r\n        if (loadFromImage) {\r\n            const spacing = this.getSpacingDimensions();\r\n            for (let row = 0; row < this.rows; row++) {\r\n                for (let col = 0; col < this.columns; col++) {\r\n                    this._sprites[col + row * this.columns] = new Sprite_Sprite(this.image, col * this.spWidth + spacing.margin * col + spacing.left, row * this.spHeight + spacing.margin * row + spacing.top, this.spWidth, this.spHeight);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Gets the raw spacing dimensions for the sprites in the sheet, which can be a fixed number or custom dimensions.\r\n     */\r\n    get spacing() {\r\n        return this._spacing;\r\n    }\r\n    /**\r\n     * Get a copy of the backing sprite array\r\n     */\r\n    get sprites() {\r\n        return [...this._sprites];\r\n    }\r\n    /**\r\n     * The backing texture used for the sprite sheet\r\n     */\r\n    get image() {\r\n        return this._image;\r\n    }\r\n    /**\r\n     * The number of columns in the sheet\r\n     */\r\n    get columns() {\r\n        return this._columns;\r\n    }\r\n    /**\r\n     * The number of rows in the sheet\r\n     */\r\n    get rows() {\r\n        return this._rows;\r\n    }\r\n    /**\r\n     * The width of the individual sprites\r\n     */\r\n    get spWidth() {\r\n        return this._spWidth;\r\n    }\r\n    /**\r\n     * The height of the individual sprites\r\n     */\r\n    get spHeight() {\r\n        return this._spHeight;\r\n    }\r\n    /**\r\n     * Gets the calculated spacing dimensions based on whether spacing\r\n     * is a fixed number or has different values for each dimension\r\n     */\r\n    getSpacingDimensions() {\r\n        var _a, _b, _c;\r\n        if (typeof this.spacing === 'number') {\r\n            return {\r\n                left: this.spacing,\r\n                top: this.spacing,\r\n                margin: this.spacing\r\n            };\r\n        }\r\n        else {\r\n            return {\r\n                left: (_a = this.spacing.left) !== null && _a !== void 0 ? _a : 0,\r\n                top: (_b = this.spacing.top) !== null && _b !== void 0 ? _b : 0,\r\n                margin: (_c = this.spacing.margin) !== null && _c !== void 0 ? _c : 0\r\n            };\r\n        }\r\n    }\r\n    /**\r\n     * Create an animation from the this SpriteSheet by listing out the\r\n     * sprite indices. Sprites are organized in row major order in the SpriteSheet.\r\n     * @param engine   Reference to the current game [[Engine]]\r\n     * @param indices  An array of sprite indices to use in the animation\r\n     * @param speed    The number in milliseconds to display each frame in the animation\r\n     */\r\n    getAnimationByIndices(engine, indices, speed) {\r\n        let images = indices.map((index) => {\r\n            return this.sprites[index];\r\n        });\r\n        images = images.map(function (i) {\r\n            return i.clone();\r\n        });\r\n        return new Animation_Animation(engine, images, speed);\r\n    }\r\n    /**\r\n     * Create an animation from the this SpriteSheet by specifying the range of\r\n     * images with the beginning (inclusive) and ending (exclusive) index\r\n     * For example `getAnimationBetween(engine, 0, 5, 200)` returns an animation with 5 frames.\r\n     * @param engine      Reference to the current game Engine\r\n     * @param beginIndex  The index to start taking frames (inclusive)\r\n     * @param endIndex    The index to stop taking frames (exclusive)\r\n     * @param speed       The number in milliseconds to display each frame in the animation\r\n     */\r\n    getAnimationBetween(engine, beginIndex, endIndex, speed) {\r\n        let images = this.sprites.slice(beginIndex, endIndex);\r\n        images = images.map(function (i) {\r\n            return i.clone();\r\n        });\r\n        return new Animation_Animation(engine, images, speed);\r\n    }\r\n    /**\r\n     * Treat the entire SpriteSheet as one animation, organizing the frames in\r\n     * row major order.\r\n     * @param engine  Reference to the current game [[Engine]]\r\n     * @param speed   The number in milliseconds to display each frame the animation\r\n     */\r\n    getAnimationForAll(engine, speed) {\r\n        const sprites = this.sprites.map(function (i) {\r\n            return i.clone();\r\n        });\r\n        return new Animation_Animation(engine, sprites, speed);\r\n    }\r\n    /**\r\n     * Retrieve a specific sprite from the SpriteSheet by its index. Sprites are organized\r\n     * in row major order in the SpriteSheet.\r\n     * @param index  The index of the sprite\r\n     */\r\n    getSprite(index) {\r\n        if (index >= 0 && index < this.sprites.length) {\r\n            return this.sprites[index];\r\n        }\r\n        else {\r\n            throw new Error('Invalid index: ' + index);\r\n        }\r\n    }\r\n    /**\r\n     * Get an animation with bespoke sprite coordinates. This is useful if the SpriteSheet is\r\n     * packed and not a uniform width or height. The resulting [[Animation]] will have the height and width of the\r\n     * largest dimension (width, height) from among the sprite coordinates\r\n     * @param engine\r\n     * @param spriteCoordinates\r\n     * @param speed\r\n     */\r\n    getAnimationByCoords(engine, spriteCoordinates, speed) {\r\n        let maxWidth = 0;\r\n        let maxHeight = 0;\r\n        const sprites = new Array(spriteCoordinates.length);\r\n        for (let i = 0; i < spriteCoordinates.length; i++) {\r\n            const coord = spriteCoordinates[i];\r\n            // no need to pass image again if using a spritesheet\r\n            coord.image = coord.image || this.image;\r\n            maxWidth = Math.max(maxWidth, coord.drawWidth);\r\n            maxHeight = Math.max(maxHeight, coord.drawHeight);\r\n            sprites[i] = new Sprite_Sprite(coord);\r\n        }\r\n        const anim = new Animation_Animation(engine, sprites, speed);\r\n        anim.drawWidth = maxWidth;\r\n        anim.drawHeight = maxHeight;\r\n        return anim;\r\n    }\r\n}\r\n/**\r\n * Sprite fonts are a used in conjunction with a [[Label]] to specify\r\n * a particular bitmap as a font. Note that some font features are not\r\n * supported by Sprite fonts.\r\n * @deprecated Will be removed into v0.26.0\r\n */\r\nlet SpriteFont = class SpriteFont extends SpriteSheet_SpriteSheet {\r\n    /**\r\n     * @param imageOrConfig   The backing image texture to build the SpriteFont or the sprite font option bag\r\n     * @param alphabet        A string representing all the characters in the image, in row major order.\r\n     * @param caseInsensitive  Indicate whether this font takes case into account\r\n     * @param columns         The number of columns of characters in the image\r\n     * @param rows            The number of rows of characters in the image\r\n     * @param spWidth         The width of each character in pixels\r\n     * @param spHeight        The height of each character in pixels\r\n     */\r\n    constructor(imageOrConfig, alphabet, caseInsensitive, columns, rows, spWidth, spHeight, spacing) {\r\n        super(imageOrConfig instanceof Texture\r\n            ? {\r\n                image: imageOrConfig,\r\n                spWidth: spWidth,\r\n                spHeight: spHeight,\r\n                rows: rows,\r\n                columns: columns,\r\n                spacing: spacing || 0\r\n            }\r\n            : imageOrConfig);\r\n        this._currentColor = Color.Black;\r\n        this._currentOpacity = 1.0;\r\n        this._spriteRecord = {};\r\n        // text shadow\r\n        this._textShadowOn = false;\r\n        this._textShadowDirty = true;\r\n        this._textShadowColor = Color.Black;\r\n        this._textShadowSprites = {};\r\n        this._shadowOffsetX = 5;\r\n        this._shadowOffsetY = 5;\r\n        if (imageOrConfig && !(imageOrConfig instanceof Texture)) {\r\n            alphabet = imageOrConfig.alphabet;\r\n            caseInsensitive = imageOrConfig.caseInsensitive;\r\n        }\r\n        this.alphabet = alphabet;\r\n        this.caseInsensitive = caseInsensitive;\r\n        this._spriteRecord = this.getTextSprites();\r\n    }\r\n    /**\r\n     * Returns a dictionary that maps each character in the alphabet to the appropriate [[Sprite]].\r\n     */\r\n    getTextSprites() {\r\n        const lookup = {};\r\n        for (let i = 0; i < this.alphabet.length; i++) {\r\n            let char = this.alphabet[i];\r\n            if (this.caseInsensitive) {\r\n                char = char.toLowerCase();\r\n            }\r\n            lookup[char] = this.sprites[i].clone();\r\n        }\r\n        return lookup;\r\n    }\r\n    /**\r\n     * Sets the text shadow for sprite fonts\r\n     * @param offsetX      The x offset in pixels to place the shadow\r\n     * @param offsetY      The y offset in pixels to place the shadow\r\n     * @param shadowColor  The color of the text shadow\r\n     */\r\n    setTextShadow(offsetX, offsetY, shadowColor) {\r\n        this._textShadowOn = true;\r\n        this._shadowOffsetX = offsetX;\r\n        this._shadowOffsetY = offsetY;\r\n        this._textShadowColor = shadowColor.clone();\r\n        this._textShadowDirty = true;\r\n        for (const character in this._spriteRecord) {\r\n            this._textShadowSprites[character] = this._spriteRecord[character].clone();\r\n        }\r\n    }\r\n    /**\r\n     * Toggles text shadows on or off\r\n     */\r\n    useTextShadow(on) {\r\n        this._textShadowOn = on;\r\n        if (on) {\r\n            this.setTextShadow(5, 5, this._textShadowColor);\r\n        }\r\n    }\r\n    /**\r\n     * Draws the current sprite font\r\n     */\r\n    draw(ctx, text, x, y, options) {\r\n        options = this._parseOptions(options);\r\n        if (this._currentColor.toString() !== options.color.toString() || this._currentOpacity !== options.opacity) {\r\n            this._currentOpacity = options.opacity;\r\n            this._currentColor = options.color;\r\n            for (const char in this._spriteRecord) {\r\n                this._spriteRecord[char].clearEffects();\r\n                this._spriteRecord[char].fill(options.color);\r\n                this._spriteRecord[char].opacity(options.opacity);\r\n            }\r\n        }\r\n        if (this._textShadowOn && this._textShadowDirty && this._textShadowColor) {\r\n            for (const characterShadow in this._textShadowSprites) {\r\n                this._textShadowSprites[characterShadow].clearEffects();\r\n                this._textShadowSprites[characterShadow].addEffect(new Fill(this._textShadowColor.clone()));\r\n            }\r\n            this._textShadowDirty = false;\r\n        }\r\n        // find the current length of text in pixels\r\n        const sprite = this.sprites[0];\r\n        // find the current height fo the text in pixels\r\n        const height = sprite.height;\r\n        // calculate appropriate scale for font size\r\n        const scale = options.fontSize / height;\r\n        const length = text.length * sprite.width * scale + text.length * options.letterSpacing;\r\n        let currX = x;\r\n        if (options.textAlign === TextAlign.Left || options.textAlign === TextAlign.Start) {\r\n            currX = x;\r\n        }\r\n        else if (options.textAlign === TextAlign.Right || options.textAlign === TextAlign.End) {\r\n            currX = x - length;\r\n        }\r\n        else if (options.textAlign === TextAlign.Center) {\r\n            currX = x - length / 2;\r\n        }\r\n        let currY = y - height * scale;\r\n        if (options.baseAlign === BaseAlign.Top || options.baseAlign === BaseAlign.Hanging) {\r\n            currY = y;\r\n        }\r\n        else if (options.baseAlign === BaseAlign.Ideographic ||\r\n            options.baseAlign === BaseAlign.Bottom ||\r\n            options.baseAlign === BaseAlign.Alphabetic) {\r\n            currY = y - height * scale;\r\n        }\r\n        else if (options.baseAlign === BaseAlign.Middle) {\r\n            currY = y - (height * scale) / 2;\r\n        }\r\n        for (let i = 0; i < text.length; i++) {\r\n            let character = text[i];\r\n            if (this.caseInsensitive) {\r\n                character = character.toLowerCase();\r\n            }\r\n            try {\r\n                // if text shadow\r\n                if (this._textShadowOn) {\r\n                    this._textShadowSprites[character].drawAroundAnchor = false;\r\n                    this._textShadowSprites[character].scale = vec(scale, scale);\r\n                    this._textShadowSprites[character].draw(ctx, currX + this._shadowOffsetX, currY + this._shadowOffsetY);\r\n                }\r\n                const charSprite = this._spriteRecord[character];\r\n                charSprite.drawAroundAnchor = false;\r\n                charSprite.scale = vec(scale, scale);\r\n                charSprite.draw(ctx, currX, currY);\r\n                currX += charSprite.drawWidth + options.letterSpacing;\r\n            }\r\n            catch (e) {\r\n                Logger.getInstance().error(`SpriteFont Error drawing char ${character}`);\r\n            }\r\n        }\r\n    }\r\n    _parseOptions(options) {\r\n        return {\r\n            fontSize: options.fontSize || 10,\r\n            letterSpacing: options.letterSpacing || 0,\r\n            color: options.color || Color.Black,\r\n            textAlign: typeof options.textAlign === undefined ? TextAlign.Left : options.textAlign,\r\n            baseAlign: typeof options.baseAlign === undefined ? BaseAlign.Bottom : options.baseAlign,\r\n            maxWidth: options.maxWidth || -1,\r\n            opacity: options.opacity || 0\r\n        };\r\n    }\r\n};\r\nSpriteFont = SpriteSheet_decorate([\r\n    obsolete({\r\n        message: 'SpriteSheet will be removed in v0.26.0',\r\n        alternateMethod: 'Use Graphics.SpriteSheet'\r\n    })\r\n], SpriteFont);\r\n\r\n\n;// CONCATENATED MODULE: ./Graphics/SpriteSheet.ts\n\r\n\r\n\r\n/**\r\n * Represents a collection of sprites from a source image with some organization in a grid\r\n */\r\nclass SpriteSheet {\r\n    /**\r\n     * Build a new sprite sheet from a list of sprites\r\n     *\r\n     * Use [[SpriteSheet.fromImageSource]] to create a SpriteSheet from an [[ImageSource]] organized in a grid\r\n     * @param options\r\n     */\r\n    constructor(options) {\r\n        this._logger = Logger.getInstance();\r\n        this.sprites = [];\r\n        const { sprites, rows, columns } = options;\r\n        this.sprites = sprites;\r\n        this.rows = rows !== null && rows !== void 0 ? rows : 1;\r\n        this.columns = columns !== null && columns !== void 0 ? columns : this.sprites.length;\r\n    }\r\n    /**\r\n     * Find a sprite by their x/y position in the SpriteSheet, for example `getSprite(0, 0)` is the [[Sprite]] in the top-left\r\n     * @param x\r\n     * @param y\r\n     */\r\n    getSprite(x, y) {\r\n        if (x >= this.columns || x < 0) {\r\n            this._logger.warn(`No sprite exists in the SpriteSheet at (${x}, ${y}), x: ${x} should be between 0 and ${this.columns - 1}`);\r\n            return null;\r\n        }\r\n        if (y >= this.rows || y < 0) {\r\n            this._logger.warn(`No sprite exists in the SpriteSheet at (${x}, ${y}), y: ${y} should be between 0 and ${this.rows - 1}`);\r\n            return null;\r\n        }\r\n        const spriteIndex = x + y * this.columns;\r\n        return this.sprites[spriteIndex];\r\n    }\r\n    /**\r\n     * To a graphics sprite sheet from a legacy sprite sheet\r\n     */\r\n    static fromLegacySpriteSheet(legacySpriteSheet) {\r\n        const sprites = legacySpriteSheet.sprites.map(oldSprite => Sprite.fromLegacySprite(oldSprite));\r\n        return new SpriteSheet({\r\n            sprites\r\n        });\r\n    }\r\n    /**\r\n     * @deprecated\r\n     * @param spriteSheet\r\n     * @returns\r\n     */\r\n    static toLegacySpriteSheet(spriteSheet) {\r\n        const sprites = spriteSheet.sprites.map(sprite => Sprite.toLegacySprite(sprite));\r\n        return new SpriteSheet_SpriteSheet(sprites);\r\n    }\r\n    /**\r\n     * Create a SpriteSheet from an [[ImageSource]] organized in a grid\r\n     *\r\n     * Example:\r\n     * ```\r\n     * const spriteSheet = SpriteSheet.fromImageSource({\r\n     *   image: imageSource,\r\n     *   grid: {\r\n     *     rows: 5,\r\n     *     columns: 2,\r\n     *     spriteWidth: 32, // pixels\r\n     *     spriteHeight: 32 // pixels\r\n     *   },\r\n     *   // Optionally specify spacing\r\n     *   spacing: {\r\n     *     // pixels from the top left to start the sprite parsing\r\n     *     originOffset: {\r\n     *       x: 5,\r\n     *       y: 5\r\n     *     },\r\n     *     // pixels between each sprite while parsing\r\n     *     margin: {\r\n     *       x: 1,\r\n     *       y: 1\r\n     *     }\r\n     *   }\r\n     * })\r\n     * ```\r\n     *\r\n     * @param options\r\n     */\r\n    static fromImageSource(options) {\r\n        var _a;\r\n        const sprites = [];\r\n        options.spacing = (_a = options.spacing) !== null && _a !== void 0 ? _a : {};\r\n        const { image, grid: { rows, columns: cols, spriteWidth, spriteHeight }, spacing: { originOffset, margin } } = options;\r\n        const offsetDefaults = Object.assign({ x: 0, y: 0 }, originOffset);\r\n        const marginDefaults = Object.assign({ x: 0, y: 0 }, margin);\r\n        for (let x = 0; x < cols; x++) {\r\n            for (let y = 0; y < rows; y++) {\r\n                sprites[x + y * cols] = new Sprite({\r\n                    image: image,\r\n                    sourceView: {\r\n                        x: x * spriteWidth + marginDefaults.x * x + offsetDefaults.x,\r\n                        y: y * spriteHeight + marginDefaults.y * y + offsetDefaults.y,\r\n                        width: spriteWidth,\r\n                        height: spriteHeight\r\n                    },\r\n                    destSize: { height: spriteHeight, width: spriteWidth }\r\n                });\r\n            }\r\n        }\r\n        return new SpriteSheet({\r\n            sprites: sprites,\r\n            rows: rows,\r\n            columns: cols\r\n        });\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/SpriteFont.ts\n\r\n\r\n\r\n\r\nclass SpriteFont_SpriteFont extends Graphic {\r\n    constructor(options) {\r\n        super(options);\r\n        this._text = '';\r\n        this._dirty = true;\r\n        this.alphabet = '';\r\n        this.shadow = null;\r\n        this.caseInsensitive = false;\r\n        this.spacing = 0;\r\n        this._logger = Logger.getInstance();\r\n        this._sprites = [];\r\n        const { alphabet, spriteSheet, caseInsensitive, spacing, shadow } = options;\r\n        this.alphabet = alphabet;\r\n        this.spriteSheet = spriteSheet;\r\n        this.caseInsensitive = caseInsensitive !== null && caseInsensitive !== void 0 ? caseInsensitive : this.caseInsensitive;\r\n        this.spacing = spacing !== null && spacing !== void 0 ? spacing : this.spacing;\r\n        this.shadow = shadow !== null && shadow !== void 0 ? shadow : this.shadow;\r\n        this.spriteSheet.sprites[0].image.ready.then(() => {\r\n            this._updateDimensions();\r\n        });\r\n    }\r\n    static fromLegacySpriteFont(spriteFont) {\r\n        const sprites = spriteFont.sprites.map(Sprite.fromLegacySprite);\r\n        return new SpriteFont_SpriteFont({\r\n            alphabet: spriteFont.alphabet,\r\n            spacing: 0,\r\n            caseInsensitive: spriteFont.caseInsensitive,\r\n            spriteSheet: new SpriteSheet({\r\n                sprites\r\n            })\r\n        });\r\n    }\r\n    _getCharacterSprites(text) {\r\n        if (!this._dirty) {\r\n            return this._sprites;\r\n        }\r\n        const results = [];\r\n        // handle case insenstive\r\n        const textToRender = this.caseInsensitive ? text.toLocaleLowerCase() : text;\r\n        const alphabet = this.caseInsensitive ? this.alphabet.toLocaleLowerCase() : this.alphabet;\r\n        // for each letter in text\r\n        for (let letterIndex = 0; letterIndex < textToRender.length; letterIndex++) {\r\n            // find the sprite index in alphabet , if there is an error pick the first\r\n            const letter = textToRender[letterIndex];\r\n            let spriteIndex = alphabet.indexOf(letter);\r\n            if (spriteIndex === -1) {\r\n                spriteIndex = 0;\r\n                this._logger.warn(`SpriteFont - Cannot find letter '${letter}' in configured alphabet '${alphabet}'`);\r\n            }\r\n            const letterSprite = this.spriteSheet.sprites[spriteIndex];\r\n            if (letterSprite) {\r\n                results.push(letterSprite);\r\n            }\r\n            else {\r\n                this._logger.warn(`SpriteFont - Cannot find sprite for '${letter}' at index '${spriteIndex}' in configured SpriteSheet`);\r\n            }\r\n        }\r\n        this._dirty = false;\r\n        return (this._sprites = results);\r\n    }\r\n    _updateDimensions() {\r\n        const sprites = this._getCharacterSprites(this._text);\r\n        let width = 0;\r\n        let height = 0;\r\n        for (const sprite of sprites) {\r\n            width += sprite.width + this.spacing;\r\n            height = Math.max(height, sprite.height);\r\n        }\r\n        this.width = width;\r\n        this.height = height;\r\n    }\r\n    updateText(text) {\r\n        if (this._text !== text) {\r\n            this._dirty = true;\r\n            this._text = text;\r\n            this._updateDimensions();\r\n        }\r\n    }\r\n    _preDraw(ex, x, y) {\r\n        this._updateDimensions();\r\n        super._preDraw(ex, x, y);\r\n    }\r\n    _drawImage(ex, x, y) {\r\n        let cursor = 0;\r\n        for (const sprite of this._getCharacterSprites(this._text)) {\r\n            // draw it in the right spot and increase the cursor by sprite width\r\n            sprite.draw(ex, x + cursor, y);\r\n            cursor += sprite.width + this.spacing;\r\n        }\r\n    }\r\n    render(ex, text, x, y) {\r\n        if (this._text !== text) {\r\n            this._dirty = true;\r\n            this._text = text;\r\n        }\r\n        if (this.shadow) {\r\n            ex.save();\r\n            ex.translate(this.shadow.offset.x, this.shadow.offset.y);\r\n            this.draw(ex, x, y);\r\n            ex.restore();\r\n        }\r\n        this.draw(ex, x, y);\r\n    }\r\n    clone() {\r\n        return new SpriteFont_SpriteFont({\r\n            alphabet: this.alphabet,\r\n            spriteSheet: this.spriteSheet,\r\n            spacing: this.spacing\r\n        });\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/debug-font.png\n/* harmony default export */ const debug_font = (\"data:image/png;base64,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\");\n;// CONCATENATED MODULE: ./Graphics/Context/debug-text.ts\n\r\n\r\n/**\r\n * Internal debugtext helper\r\n */\r\nclass DebugText {\r\n    constructor() {\r\n        /**\r\n         * base64 font\r\n         */\r\n        this.fontSheet = debug_font;\r\n        this.size = 16;\r\n        this.load();\r\n    }\r\n    load() {\r\n        this._imageSource = new ImageSource(this.fontSheet);\r\n        return this._imageSource.load().then(() => {\r\n            this._spriteSheet = SpriteSheet.fromImageSource({\r\n                image: this._imageSource,\r\n                grid: {\r\n                    rows: 3,\r\n                    columns: 16,\r\n                    spriteWidth: 16,\r\n                    spriteHeight: 16\r\n                }\r\n            });\r\n            this._spriteFont = new SpriteFont_SpriteFont({\r\n                alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ,!\\'&.\"?-()+ ',\r\n                caseInsensitive: true,\r\n                spriteSheet: this._spriteSheet,\r\n                spacing: -6\r\n            });\r\n        });\r\n    }\r\n    /**\r\n     * Writes debug text using the built in sprint font\r\n     * @param ctx\r\n     * @param text\r\n     * @param pos\r\n     */\r\n    write(ctx, text, pos) {\r\n        if (this._imageSource.isLoaded()) {\r\n            this._spriteFont.render(ctx, text, pos.x, pos.y);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/ExcaliburGraphicsContextWebGL.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass ExcaliburGraphicsContextWebGLDebug {\r\n    constructor(_webglCtx) {\r\n        this._webglCtx = _webglCtx;\r\n        this._debugText = new DebugText();\r\n    }\r\n    /**\r\n     * Draw a debugging rectangle to the context\r\n     * @param x\r\n     * @param y\r\n     * @param width\r\n     * @param height\r\n     */\r\n    drawRect(x, y, width, height, rectOptions = { color: Color.Black }) {\r\n        this.drawLine(vec(x, y), vec(x + width, y), Object.assign({}, rectOptions));\r\n        this.drawLine(vec(x + width, y), vec(x + width, y + height), Object.assign({}, rectOptions));\r\n        this.drawLine(vec(x + width, y + height), vec(x, y + height), Object.assign({}, rectOptions));\r\n        this.drawLine(vec(x, y + height), vec(x, y), Object.assign({}, rectOptions));\r\n    }\r\n    /**\r\n     * Draw a debugging line to the context\r\n     * @param start\r\n     * @param end\r\n     * @param lineOptions\r\n     */\r\n    drawLine(start, end, lineOptions = { color: Color.Black }) {\r\n        this._webglCtx.__lineRenderer.addLine(start, end, lineOptions.color);\r\n    }\r\n    /**\r\n     * Draw a debugging point to the context\r\n     * @param point\r\n     * @param pointOptions\r\n     */\r\n    drawPoint(point, pointOptions = { color: Color.Black, size: 5 }) {\r\n        this._webglCtx.__pointRenderer.addPoint(point, pointOptions.color, pointOptions.size);\r\n    }\r\n    drawText(text, pos) {\r\n        this._debugText.write(this._webglCtx, text, pos);\r\n    }\r\n}\r\nclass ExcaliburGraphicsContextWebGL {\r\n    constructor(options) {\r\n        this._transform = new TransformStack();\r\n        this._state = new StateStack();\r\n        this.snapToPixel = true;\r\n        this.smoothing = false;\r\n        this.backgroundColor = Color.ExcaliburBlue;\r\n        this.debug = new ExcaliburGraphicsContextWebGLDebug(this);\r\n        const { canvasElement, enableTransparency, smoothing, snapToPixel, backgroundColor } = options;\r\n        this.__gl = canvasElement.getContext('webgl', {\r\n            antialias: smoothing !== null && smoothing !== void 0 ? smoothing : this.smoothing,\r\n            premultipliedAlpha: false,\r\n            alpha: enableTransparency !== null && enableTransparency !== void 0 ? enableTransparency : true,\r\n            depth: true,\r\n            powerPreference: 'high-performance'\r\n        });\r\n        this.snapToPixel = snapToPixel !== null && snapToPixel !== void 0 ? snapToPixel : this.snapToPixel;\r\n        this.smoothing = smoothing !== null && smoothing !== void 0 ? smoothing : this.smoothing;\r\n        this.backgroundColor = backgroundColor !== null && backgroundColor !== void 0 ? backgroundColor : this.backgroundColor;\r\n        this._init();\r\n    }\r\n    get opacity() {\r\n        return this._state.current.opacity;\r\n    }\r\n    set opacity(value) {\r\n        this._state.current.opacity = value;\r\n    }\r\n    get width() {\r\n        return this.__gl.canvas.width;\r\n    }\r\n    get height() {\r\n        return this.__gl.canvas.height;\r\n    }\r\n    /**\r\n     * Checks the underlying webgl implementation if the requested internal resolution is supported\r\n     * @param dim\r\n     */\r\n    checkIfResolutionSupported(dim) {\r\n        // Slight hack based on this thread https://groups.google.com/g/webgl-dev-list/c/AHONvz3oQTo\r\n        const gl = this.__gl;\r\n        // If any dimension is greater than max texture size (divide by 4 bytes per pixel)\r\n        const maxDim = gl.getParameter(gl.MAX_TEXTURE_SIZE) / 4;\r\n        let supported = true;\r\n        if (dim.width > maxDim || dim.height > maxDim) {\r\n            supported = false;\r\n        }\r\n        return supported;\r\n    }\r\n    _init() {\r\n        const gl = this.__gl;\r\n        // Setup viewport and view matrix\r\n        this._ortho = Matrix.ortho(0, gl.canvas.width, gl.canvas.height, 0, 400, -400);\r\n        gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);\r\n        // Clear background\r\n        gl.clearColor(this.backgroundColor.r / 255, this.backgroundColor.g / 255, this.backgroundColor.b / 255, this.backgroundColor.a);\r\n        gl.clear(gl.COLOR_BUFFER_BIT);\r\n        // Enable alpha blending\r\n        gl.enable(gl.BLEND);\r\n        gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\r\n        this.__pointRenderer = new PointRenderer(gl, { matrix: this._ortho, transform: this._transform, state: this._state });\r\n        this.__lineRenderer = new LineRenderer(gl, { matrix: this._ortho, transform: this._transform, state: this._state });\r\n        this.__imageRenderer = new ImageRenderer(gl, { matrix: this._ortho, transform: this._transform, state: this._state });\r\n        // 2D ctx shim\r\n        this._canvas = new Canvas({\r\n            width: gl.canvas.width,\r\n            height: gl.canvas.height\r\n        });\r\n        this.__ctx = this._canvas.ctx;\r\n    }\r\n    resetTransform() {\r\n        this._transform.current = Matrix.identity();\r\n    }\r\n    updateViewport() {\r\n        const gl = this.__gl;\r\n        this._ortho = this._ortho = Matrix.ortho(0, gl.canvas.width, gl.canvas.height, 0, 400, -400);\r\n        this.__pointRenderer.shader.addUniformMatrix('u_matrix', this._ortho.data);\r\n        this.__lineRenderer.shader.addUniformMatrix('u_matrix', this._ortho.data);\r\n        this.__imageRenderer.shader.addUniformMatrix('u_matrix', this._ortho.data);\r\n        // 2D ctx shim\r\n        this._canvas.width = gl.canvas.width;\r\n        this._canvas.height = gl.canvas.height;\r\n    }\r\n    drawImage(image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight) {\r\n        if (swidth === 0 || sheight === 0) {\r\n            return; // zero dimension dest exit early\r\n        }\r\n        else if (dwidth === 0 || dheight === 0) {\r\n            return; // zero dimension dest exit early\r\n        }\r\n        else if (image.width === 0 || image.height === 0) {\r\n            return; // zero dimension source exit early\r\n        }\r\n        if (!image) {\r\n            Logger.getInstance().warn('Cannot draw a null or undefined image');\r\n            // tslint:disable-next-line: no-console\r\n            if (console.trace) {\r\n                // tslint:disable-next-line: no-console\r\n                console.trace();\r\n            }\r\n            return;\r\n        }\r\n        this.__imageRenderer.addImage(image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight);\r\n    }\r\n    drawLine(start, end, color, thickness = 1) {\r\n        this.__imageRenderer.addLine(color, start, end, thickness);\r\n    }\r\n    drawRectangle(pos, width, height, color) {\r\n        this.__imageRenderer.addRectangle(color, pos, width, height);\r\n    }\r\n    drawCircle(pos, radius, color) {\r\n        this.__imageRenderer.addCircle(pos, radius, color);\r\n    }\r\n    save() {\r\n        this._transform.save();\r\n        this._state.save();\r\n    }\r\n    restore() {\r\n        this._transform.restore();\r\n        this._state.restore();\r\n    }\r\n    translate(x, y) {\r\n        this._transform.translate(this.snapToPixel ? ~~x : x, this.snapToPixel ? ~~y : y);\r\n    }\r\n    rotate(angle) {\r\n        this._transform.rotate(angle);\r\n    }\r\n    scale(x, y) {\r\n        this._transform.scale(x, y);\r\n    }\r\n    transform(matrix) {\r\n        this._transform.current = matrix;\r\n    }\r\n    clear() {\r\n        const gl = this.__gl;\r\n        gl.clearColor(this.backgroundColor.r / 255, this.backgroundColor.g / 255, this.backgroundColor.b / 255, this.backgroundColor.a);\r\n        // Clear the context with the newly set color. This is\r\n        // the function call that actually does the drawing.\r\n        gl.clear(gl.COLOR_BUFFER_BIT);\r\n        GraphicsDiagnostics.clear();\r\n    }\r\n    /**\r\n     * Flushes all batched rendering to the screen\r\n     */\r\n    flush() {\r\n        const gl = this.__gl;\r\n        gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);\r\n        this.__imageRenderer.render();\r\n        this.__lineRenderer.render();\r\n        this.__pointRenderer.render();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Screen.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Enum representing the different display modes available to Excalibur.\r\n */\r\nvar DisplayMode;\r\n(function (DisplayMode) {\r\n    /**\r\n     * Default, use a specified resolution for the game. Like 800x600 pixels for example.\r\n     */\r\n    DisplayMode[\"Fixed\"] = \"Fixed\";\r\n    /**\r\n     * Fit to screen using as much space as possible while maintaining aspect ratio and resolution.\r\n     * This is not the same as [[Screen.goFullScreen]] but behaves in a similar way maintaining aspect ratio.\r\n     *\r\n     * You may want to center your game here is an example\r\n     * ```html\r\n     * <!-- html -->\r\n     * <body>\r\n     * <main>\r\n     *   <canvas id=\"game\"></canvas>\r\n     * </main>\r\n     * </body>\r\n     * ```\r\n     *\r\n     * ```css\r\n     * // css\r\n     * main {\r\n     *   display: flex;\r\n     *   align-items: center;\r\n     *   justify-content: center;\r\n     *   height: 100%;\r\n     *   width: 100%;\r\n     * }\r\n     * ```\r\n     *\r\n     */\r\n    DisplayMode[\"FitScreen\"] = \"FitScreen\";\r\n    /**\r\n     * Fill the entire screen's css width/height for the game resolution dynamically. This means the resolution of the game will\r\n     * change dynamically as the window is resized. This is not the same as [[Screen.goFullScreen]]\r\n     */\r\n    DisplayMode[\"FillScreen\"] = \"FillScreen\";\r\n    /**\r\n     * Fit to parent element width/height using as much space as possible while maintaining aspect ratio and resolution.\r\n     */\r\n    DisplayMode[\"FitContainer\"] = \"FitContainer\";\r\n    /**\r\n     * Use the parent DOM container's css width/height for the game resolution dynamically\r\n     */\r\n    DisplayMode[\"FillContainer\"] = \"FillContainer\";\r\n    /**\r\n     * Allow the game to be positioned with the [[EngineOptions.position]] option\r\n     * @deprecated Use CSS to position the game canvas, will be removed in v0.26.0\r\n     */\r\n    DisplayMode[\"Position\"] = \"Position\";\r\n})(DisplayMode || (DisplayMode = {}));\r\n/**\r\n * Convenience class for quick resolutions\r\n * Mostly sourced from https://emulation.gametechwiki.com/index.php/Resolution\r\n */\r\nclass Resolution {\r\n    /* istanbul ignore next */\r\n    static get SVGA() {\r\n        return { width: 800, height: 600 };\r\n    }\r\n    /* istanbul ignore next */\r\n    static get Standard() {\r\n        return { width: 1920, height: 1080 };\r\n    }\r\n    /* istanbul ignore next */\r\n    static get Atari2600() {\r\n        return { width: 160, height: 192 };\r\n    }\r\n    /* istanbul ignore next */\r\n    static get GameBoy() {\r\n        return { width: 160, height: 144 };\r\n    }\r\n    /* istanbul ignore next */\r\n    static get GameBoyAdvance() {\r\n        return { width: 240, height: 160 };\r\n    }\r\n    /* istanbul ignore next */\r\n    static get NintendoDS() {\r\n        return { width: 256, height: 192 };\r\n    }\r\n    /* istanbul ignore next */\r\n    static get NES() {\r\n        return { width: 256, height: 224 };\r\n    }\r\n    /* istanbul ignore next */\r\n    static get SNES() {\r\n        return { width: 256, height: 244 };\r\n    }\r\n}\r\n/**\r\n * The Screen handles all aspects of interacting with the screen for Excalibur.\r\n */\r\nclass Screen {\r\n    constructor(options) {\r\n        var _a, _b, _c;\r\n        this._antialiasing = true;\r\n        this._resolutionStack = [];\r\n        this._viewportStack = [];\r\n        this._pixelRatioOverride = null;\r\n        this._isFullScreen = false;\r\n        this._isDisposed = false;\r\n        this._logger = Logger.getInstance();\r\n        this._fullscreenChangeHandler = () => {\r\n            this._isFullScreen = !this._isFullScreen;\r\n            this._logger.debug('Fullscreen Change', this._isFullScreen);\r\n        };\r\n        this._pixelRatioChangeHandler = () => {\r\n            this._logger.debug('Pixel Ratio Change', window.devicePixelRatio);\r\n            this._devicePixelRatio = this._calculateDevicePixelRatio();\r\n            this.applyResolutionAndViewport();\r\n        };\r\n        this._resizeHandler = () => {\r\n            const parent = this.parent;\r\n            this._logger.debug('View port resized');\r\n            this._setResolutionAndViewportByDisplayMode(parent);\r\n            this.applyResolutionAndViewport();\r\n        };\r\n        // Asking the window.devicePixelRatio is expensive we do it once\r\n        this._devicePixelRatio = this._calculateDevicePixelRatio();\r\n        this._alreadyWarned = false;\r\n        this.viewport = options.viewport;\r\n        this.resolution = (_a = options.resolution) !== null && _a !== void 0 ? _a : Object.assign({}, this.viewport);\r\n        this._displayMode = (_b = options.displayMode) !== null && _b !== void 0 ? _b : DisplayMode.Fixed;\r\n        this._canvas = options.canvas;\r\n        this._ctx = options.context;\r\n        this._antialiasing = (_c = options.antialiasing) !== null && _c !== void 0 ? _c : this._antialiasing;\r\n        this._browser = options.browser;\r\n        this._position = options.position;\r\n        this._pixelRatioOverride = options.pixelRatio;\r\n        this._applyDisplayMode();\r\n        this._mediaQueryList = this._browser.window.nativeComponent.matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);\r\n        this._mediaQueryList.addEventListener('change', this._pixelRatioChangeHandler);\r\n        this._canvas.addEventListener('fullscreenchange', this._fullscreenChangeHandler);\r\n        this.applyResolutionAndViewport();\r\n    }\r\n    dispose() {\r\n        if (!this._isDisposed) {\r\n            // Clean up handlers\r\n            this._isDisposed = true;\r\n            this._browser.window.off('resize', this._resizeHandler);\r\n            if (this._resizeObserver) {\r\n                this._resizeObserver.disconnect();\r\n            }\r\n            this.parent.removeEventListener('resize', this._resizeHandler);\r\n            this._mediaQueryList.removeEventListener('change', this._pixelRatioChangeHandler);\r\n            this._canvas.removeEventListener('fullscreenchange', this._fullscreenChangeHandler);\r\n        }\r\n    }\r\n    _calculateDevicePixelRatio() {\r\n        if (window.devicePixelRatio < 1) {\r\n            return 1;\r\n        }\r\n        const devicePixelRatio = window.devicePixelRatio || 1;\r\n        return devicePixelRatio;\r\n    }\r\n    get pixelRatio() {\r\n        if (this._pixelRatioOverride) {\r\n            return this._pixelRatioOverride;\r\n        }\r\n        return this._devicePixelRatio;\r\n    }\r\n    get isHiDpi() {\r\n        return this.pixelRatio !== 1;\r\n    }\r\n    get displayMode() {\r\n        return this._displayMode;\r\n    }\r\n    get canvas() {\r\n        return this._canvas;\r\n    }\r\n    get parent() {\r\n        return ((this.displayMode === DisplayMode.FillContainer || this.displayMode === DisplayMode.FitContainer\r\n            ? this.canvas.parentElement || document.body\r\n            : window));\r\n    }\r\n    get resolution() {\r\n        return this._resolution;\r\n    }\r\n    set resolution(resolution) {\r\n        this._resolution = resolution;\r\n    }\r\n    get viewport() {\r\n        if (this._viewport) {\r\n            return this._viewport;\r\n        }\r\n        return this._resolution;\r\n    }\r\n    set viewport(viewport) {\r\n        this._viewport = viewport;\r\n    }\r\n    get aspectRatio() {\r\n        return this._resolution.width / this._resolution.height;\r\n    }\r\n    get scaledWidth() {\r\n        return this._resolution.width * this.pixelRatio;\r\n    }\r\n    get scaledHeight() {\r\n        return this._resolution.height * this.pixelRatio;\r\n    }\r\n    setCurrentCamera(camera) {\r\n        this._camera = camera;\r\n    }\r\n    pushResolutionAndViewport() {\r\n        this._resolutionStack.push(this.resolution);\r\n        this._viewportStack.push(this.viewport);\r\n        this.resolution = Object.assign({}, this.resolution);\r\n        this.viewport = Object.assign({}, this.viewport);\r\n    }\r\n    peekViewport() {\r\n        return this._viewportStack[this._viewportStack.length - 1];\r\n    }\r\n    peekResolution() {\r\n        return this._resolutionStack[this._resolutionStack.length - 1];\r\n    }\r\n    popResolutionAndViewport() {\r\n        this.resolution = this._resolutionStack.pop();\r\n        this.viewport = this._viewportStack.pop();\r\n    }\r\n    applyResolutionAndViewport() {\r\n        this._canvas.width = this.scaledWidth;\r\n        this._canvas.height = this.scaledHeight;\r\n        if (this._ctx instanceof ExcaliburGraphicsContextWebGL) {\r\n            const supported = this._ctx.checkIfResolutionSupported({\r\n                width: this.scaledWidth,\r\n                height: this.scaledHeight\r\n            });\r\n            if (!supported && !this._alreadyWarned) {\r\n                this._alreadyWarned = true; // warn once\r\n                this._logger.warn(`The currently configured resolution (${this.resolution.width}x${this.resolution.height})` +\r\n                    ' is too large for the platform WebGL implementation, this may work but cause WebGL rendering to behave oddly.' +\r\n                    ' Try reducing the resolution or disabling Hi DPI scaling to avoid this' +\r\n                    ' (read more here https://excaliburjs.com/docs/screens#understanding-viewport--resolution).');\r\n            }\r\n        }\r\n        if (this._antialiasing) {\r\n            this._canvas.style.imageRendering = 'auto';\r\n        }\r\n        else {\r\n            this._canvas.style.imageRendering = 'pixelated';\r\n            // Fall back to 'crisp-edges' if 'pixelated' is not supported\r\n            // Currently for firefox https://developer.mozilla.org/en-US/docs/Web/CSS/image-rendering\r\n            if (this._canvas.style.imageRendering === '') {\r\n                this._canvas.style.imageRendering = 'crisp-edges';\r\n            }\r\n        }\r\n        this._canvas.style.width = this.viewport.width + 'px';\r\n        this._canvas.style.height = this.viewport.height + 'px';\r\n        // After messing with the canvas width/height the graphics context is invalidated and needs to have some properties reset\r\n        this._ctx.updateViewport();\r\n        this._ctx.resetTransform();\r\n        this._ctx.scale(this.pixelRatio, this.pixelRatio);\r\n        this._ctx.smoothing = this._antialiasing;\r\n    }\r\n    get antialiasing() {\r\n        return this._antialiasing;\r\n    }\r\n    set antialiasing(isSmooth) {\r\n        this._antialiasing = isSmooth;\r\n        this._ctx.smoothing = this._antialiasing;\r\n    }\r\n    /**\r\n     * Returns true if excalibur is fullscreened using the browser fullscreen api\r\n     */\r\n    get isFullScreen() {\r\n        return this._isFullScreen;\r\n    }\r\n    /**\r\n     * Requests to go fullscreen using the browser fullscreen api, requires user interaction to be successful.\r\n     * For example, wire this to a user click handler.\r\n     */\r\n    goFullScreen() {\r\n        return this._canvas.requestFullscreen();\r\n    }\r\n    /**\r\n     * Requests to exit fullscreen using the browser fullscreen api\r\n     */\r\n    exitFullScreen() {\r\n        return document.exitFullscreen();\r\n    }\r\n    /**\r\n     * Takes a coordinate in normal html page space, for example from a pointer move event, and translates it to\r\n     * Excalibur screen space.\r\n     *\r\n     * Excalibur screen space starts at the top left (0, 0) corner of the viewport, and extends to the\r\n     * bottom right corner (resolutionX, resolutionY)\r\n     * @param point\r\n     */\r\n    pageToScreenCoordinates(point) {\r\n        let newX = point.x;\r\n        let newY = point.y;\r\n        if (!this._isFullScreen) {\r\n            newX -= getPosition(this._canvas).x;\r\n            newY -= getPosition(this._canvas).y;\r\n        }\r\n        // if fullscreen api on it centers with black bars\r\n        // we need to adjust the screen to world coordinates in this case\r\n        if (this._isFullScreen) {\r\n            if (window.innerWidth / this.aspectRatio < window.innerHeight) {\r\n                const screenHeight = window.innerWidth / this.aspectRatio;\r\n                const screenMarginY = (window.innerHeight - screenHeight) / 2;\r\n                newY = ((newY - screenMarginY) / screenHeight) * this.viewport.height;\r\n                newX = (newX / window.innerWidth) * this.viewport.width;\r\n            }\r\n            else {\r\n                const screenWidth = window.innerHeight * this.aspectRatio;\r\n                const screenMarginX = (window.innerWidth - screenWidth) / 2;\r\n                newX = ((newX - screenMarginX) / screenWidth) * this.viewport.width;\r\n                newY = (newY / window.innerHeight) * this.viewport.height;\r\n            }\r\n        }\r\n        newX = (newX / this.viewport.width) * this.resolution.width;\r\n        newY = (newY / this.viewport.height) * this.resolution.height;\r\n        return new Vector(newX, newY);\r\n    }\r\n    /**\r\n     * Takes a coordinate in Excalibur screen space, and translates it to normal html page space. For example,\r\n     * this is where html elements might live if you want to position them relative to Excalibur.\r\n     *\r\n     * Excalibur screen space starts at the top left (0, 0) corner of the viewport, and extends to the\r\n     * bottom right corner (resolutionX, resolutionY)\r\n     * @param point\r\n     */\r\n    screenToPageCoordinates(point) {\r\n        let newX = point.x;\r\n        let newY = point.y;\r\n        newX = (newX / this.resolution.width) * this.viewport.width;\r\n        newY = (newY / this.resolution.height) * this.viewport.height;\r\n        if (this._isFullScreen) {\r\n            if (window.innerWidth / this.aspectRatio < window.innerHeight) {\r\n                const screenHeight = window.innerWidth / this.aspectRatio;\r\n                const screenMarginY = (window.innerHeight - screenHeight) / 2;\r\n                newY = (newY / this.viewport.height) * screenHeight + screenMarginY;\r\n                newX = (newX / this.viewport.width) * window.innerWidth;\r\n            }\r\n            else {\r\n                const screenWidth = window.innerHeight * this.aspectRatio;\r\n                const screenMarginX = (window.innerWidth - screenWidth) / 2;\r\n                newX = (newX / this.viewport.width) * screenWidth + screenMarginX;\r\n                newY = (newY / this.viewport.height) * window.innerHeight;\r\n            }\r\n        }\r\n        if (!this._isFullScreen) {\r\n            newX += getPosition(this._canvas).x;\r\n            newY += getPosition(this._canvas).y;\r\n        }\r\n        return new Vector(newX, newY);\r\n    }\r\n    /**\r\n     * Takes a coordinate in Excalibur screen space, and translates it to Excalibur world space.\r\n     *\r\n     * World space is where [[Entity|entities]] in Excalibur live by default [[CoordPlane.World]]\r\n     * and extends infinitely out relative from the [[Camera]].\r\n     * @param point  Screen coordinate to convert\r\n     */\r\n    screenToWorldCoordinates(point) {\r\n        var _a, _b, _c, _d;\r\n        let newX = point.x;\r\n        let newY = point.y;\r\n        // transform back to world space\r\n        newX = (newX / this.resolution.width) * this.drawWidth;\r\n        newY = (newY / this.resolution.height) * this.drawHeight;\r\n        // transform based on zoom\r\n        newX = newX - this.halfDrawWidth;\r\n        newY = newY - this.halfDrawHeight;\r\n        // shift by camera focus\r\n        newX += (_b = (_a = this._camera) === null || _a === void 0 ? void 0 : _a.x) !== null && _b !== void 0 ? _b : 0;\r\n        newY += (_d = (_c = this._camera) === null || _c === void 0 ? void 0 : _c.y) !== null && _d !== void 0 ? _d : 0;\r\n        return new Vector(newX, newY);\r\n    }\r\n    /**\r\n     * Takes a coordinate in Excalibur world space, and translates it to Excalibur screen space.\r\n     *\r\n     * Screen space is where [[ScreenElement|screen elements]] and [[Entity|entities]] with [[CoordPlane.Screen]] live.\r\n     * @param point  World coordinate to convert\r\n     */\r\n    worldToScreenCoordinates(point) {\r\n        var _a, _b, _c, _d;\r\n        let screenX = point.x;\r\n        let screenY = point.y;\r\n        // shift by camera focus\r\n        screenX -= (_b = (_a = this._camera) === null || _a === void 0 ? void 0 : _a.x) !== null && _b !== void 0 ? _b : 0;\r\n        screenY -= (_d = (_c = this._camera) === null || _c === void 0 ? void 0 : _c.y) !== null && _d !== void 0 ? _d : 0;\r\n        // transform back on zoom\r\n        screenX = screenX + this.halfDrawWidth;\r\n        screenY = screenY + this.halfDrawHeight;\r\n        // transform back to screen space\r\n        screenX = (screenX / this.drawWidth) * this.resolution.width;\r\n        screenY = (screenY / this.drawHeight) * this.resolution.height;\r\n        return new Vector(screenX, screenY);\r\n    }\r\n    pageToWorldCoordinates(point) {\r\n        const screen = this.pageToScreenCoordinates(point);\r\n        return this.screenToWorldCoordinates(screen);\r\n    }\r\n    worldToPageCoordinates(point) {\r\n        const screen = this.worldToScreenCoordinates(point);\r\n        return this.screenToPageCoordinates(screen);\r\n    }\r\n    /**\r\n     * Returns a BoundingBox of the top left corner of the screen\r\n     * and the bottom right corner of the screen.\r\n     *\r\n     * World bounds are in world coordinates, useful for culling objects offscreen\r\n     */\r\n    getWorldBounds() {\r\n        const left = this.screenToWorldCoordinates(Vector.Zero).x;\r\n        const top = this.screenToWorldCoordinates(Vector.Zero).y;\r\n        const right = left + this.drawWidth;\r\n        const bottom = top + this.drawHeight;\r\n        return new BoundingBox(left, top, right, bottom);\r\n    }\r\n    /**\r\n     * The width of the game canvas in pixels (physical width component of the\r\n     * resolution of the canvas element)\r\n     */\r\n    get canvasWidth() {\r\n        return this.canvas.width;\r\n    }\r\n    /**\r\n     * Returns half width of the game canvas in pixels (half physical width component)\r\n     */\r\n    get halfCanvasWidth() {\r\n        return this.canvas.width / 2;\r\n    }\r\n    /**\r\n     * The height of the game canvas in pixels, (physical height component of\r\n     * the resolution of the canvas element)\r\n     */\r\n    get canvasHeight() {\r\n        return this.canvas.height;\r\n    }\r\n    /**\r\n     * Returns half height of the game canvas in pixels (half physical height component)\r\n     */\r\n    get halfCanvasHeight() {\r\n        return this.canvas.height / 2;\r\n    }\r\n    /**\r\n     * Returns the width of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get drawWidth() {\r\n        if (this._camera) {\r\n            return this.resolution.width / this._camera.zoom;\r\n        }\r\n        return this.resolution.width;\r\n    }\r\n    /**\r\n     * Returns half the width of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get halfDrawWidth() {\r\n        return this.drawWidth / 2;\r\n    }\r\n    /**\r\n     * Returns the height of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get drawHeight() {\r\n        if (this._camera) {\r\n            return this.resolution.height / this._camera.zoom;\r\n        }\r\n        return this.resolution.height;\r\n    }\r\n    /**\r\n     * Returns half the height of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get halfDrawHeight() {\r\n        return this.drawHeight / 2;\r\n    }\r\n    /**\r\n     * Returns screen center coordinates including zoom and device pixel ratio.\r\n     */\r\n    get center() {\r\n        return vec(this.halfDrawWidth, this.halfDrawHeight);\r\n    }\r\n    _computeFit() {\r\n        document.body.style.margin = '0px';\r\n        document.body.style.overflow = 'hidden';\r\n        const aspect = this.aspectRatio;\r\n        let adjustedWidth = 0;\r\n        let adjustedHeight = 0;\r\n        if (window.innerWidth / aspect < window.innerHeight) {\r\n            adjustedWidth = window.innerWidth;\r\n            adjustedHeight = window.innerWidth / aspect;\r\n        }\r\n        else {\r\n            adjustedWidth = window.innerHeight * aspect;\r\n            adjustedHeight = window.innerHeight;\r\n        }\r\n        this.viewport = {\r\n            width: adjustedWidth,\r\n            height: adjustedHeight\r\n        };\r\n    }\r\n    _computeFitContainer() {\r\n        const aspect = this.aspectRatio;\r\n        let adjustedWidth = 0;\r\n        let adjustedHeight = 0;\r\n        const parent = this.canvas.parentElement;\r\n        if (parent.clientWidth / aspect < parent.clientHeight) {\r\n            adjustedWidth = parent.clientWidth;\r\n            adjustedHeight = parent.clientWidth / aspect;\r\n        }\r\n        else {\r\n            adjustedWidth = parent.clientHeight * aspect;\r\n            adjustedHeight = parent.clientHeight;\r\n        }\r\n        this.viewport = {\r\n            width: adjustedWidth,\r\n            height: adjustedHeight\r\n        };\r\n    }\r\n    _applyDisplayMode() {\r\n        if (this.displayMode === DisplayMode.Position) {\r\n            this._initializeDisplayModePosition(this._position);\r\n        }\r\n        else {\r\n            this._setResolutionAndViewportByDisplayMode(this.parent);\r\n            // watch resizing\r\n            if (this.parent instanceof Window) {\r\n                this._browser.window.on('resize', this._resizeHandler);\r\n            }\r\n            else {\r\n                this._resizeObserver = new ResizeObserver(() => {\r\n                    this._resizeHandler();\r\n                });\r\n                this._resizeObserver.observe(this.parent);\r\n            }\r\n            this.parent.addEventListener('resize', this._resizeHandler);\r\n        }\r\n    }\r\n    /**\r\n     * Sets the resoultion and viewport based on the selected display mode.\r\n     */\r\n    _setResolutionAndViewportByDisplayMode(parent) {\r\n        if (this.displayMode === DisplayMode.FillContainer) {\r\n            this.resolution = {\r\n                width: parent.clientWidth,\r\n                height: parent.clientHeight\r\n            };\r\n            this.viewport = this.resolution;\r\n        }\r\n        if (this.displayMode === DisplayMode.FillScreen) {\r\n            document.body.style.margin = '0px';\r\n            document.body.style.overflow = 'hidden';\r\n            this.resolution = {\r\n                width: parent.innerWidth,\r\n                height: parent.innerHeight\r\n            };\r\n            this.viewport = this.resolution;\r\n        }\r\n        if (this.displayMode === DisplayMode.FitScreen) {\r\n            this._computeFit();\r\n        }\r\n        if (this.displayMode === DisplayMode.FitContainer) {\r\n            this._computeFitContainer();\r\n        }\r\n    }\r\n    _initializeDisplayModePosition(position) {\r\n        if (!position) {\r\n            throw new Error('DisplayMode of Position was selected but no position option was given');\r\n        }\r\n        else {\r\n            this.canvas.style.display = 'block';\r\n            this.canvas.style.position = 'absolute';\r\n            if (typeof position === 'string') {\r\n                const specifiedPosition = position.split(' ');\r\n                switch (specifiedPosition[0]) {\r\n                    case 'top':\r\n                        this.canvas.style.top = '0px';\r\n                        break;\r\n                    case 'bottom':\r\n                        this.canvas.style.bottom = '0px';\r\n                        break;\r\n                    case 'middle':\r\n                        this.canvas.style.top = '50%';\r\n                        const offsetY = -this.halfDrawHeight;\r\n                        this.canvas.style.marginTop = offsetY.toString();\r\n                        break;\r\n                    default:\r\n                        throw new Error('Invalid Position Given');\r\n                }\r\n                if (specifiedPosition[1]) {\r\n                    switch (specifiedPosition[1]) {\r\n                        case 'left':\r\n                            this.canvas.style.left = '0px';\r\n                            break;\r\n                        case 'right':\r\n                            this.canvas.style.right = '0px';\r\n                            break;\r\n                        case 'center':\r\n                            this.canvas.style.left = '50%';\r\n                            const offsetX = -this.halfDrawWidth;\r\n                            this.canvas.style.marginLeft = offsetX.toString();\r\n                            break;\r\n                        default:\r\n                            throw new Error('Invalid Position Given');\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                if (position.top) {\r\n                    typeof position.top === 'number'\r\n                        ? (this.canvas.style.top = position.top.toString() + 'px')\r\n                        : (this.canvas.style.top = position.top);\r\n                }\r\n                if (position.right) {\r\n                    typeof position.right === 'number'\r\n                        ? (this.canvas.style.right = position.right.toString() + 'px')\r\n                        : (this.canvas.style.right = position.right);\r\n                }\r\n                if (position.bottom) {\r\n                    typeof position.bottom === 'number'\r\n                        ? (this.canvas.style.bottom = position.bottom.toString() + 'px')\r\n                        : (this.canvas.style.bottom = position.bottom);\r\n                }\r\n                if (position.left) {\r\n                    typeof position.left === 'number'\r\n                        ? (this.canvas.style.left = position.left.toString() + 'px')\r\n                        : (this.canvas.style.left = position.left);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Resources/Sound/AudioContext.ts\n/**\r\n * Internal class used to build instances of AudioContext\r\n */\r\n/* istanbul ignore next */\r\nclass AudioContextFactory {\r\n    static create() {\r\n        if (!this._INSTANCE) {\r\n            if (window.AudioContext || window.webkitAudioContext) {\r\n                this._INSTANCE = new AudioContext();\r\n            }\r\n        }\r\n        return this._INSTANCE;\r\n    }\r\n}\r\nAudioContextFactory._INSTANCE = null;\r\n\n;// CONCATENATED MODULE: ./Util/WebAudio.ts\n\r\n\r\n/**\r\n * Patch for detecting legacy web audio in browsers\r\n * @internal\r\n * @param source\r\n */\r\nfunction isLegacyWebAudioSource(source) {\r\n    return !!source.playbackState;\r\n}\r\nclass WebAudio {\r\n    /**\r\n     * Play an empty sound to unlock Safari WebAudio context. Call this function\r\n     * right after a user interaction event.\r\n     * @source https://paulbakaus.com/tutorials/html5/web-audio-on-ios/\r\n     */\r\n    static unlock() {\r\n        const promise = new Promise((resolve, reject) => {\r\n            if (WebAudio._UNLOCKED || !AudioContextFactory.create()) {\r\n                return resolve(true);\r\n            }\r\n            const unlockTimeoutTimer = setTimeout(() => {\r\n                Logger.getInstance().warn('Excalibur was unable to unlock the audio context, audio probably will not play in this browser.');\r\n                resolve(false);\r\n            }, 200);\r\n            const audioContext = AudioContextFactory.create();\r\n            audioContext.resume().then(() => {\r\n                // create empty buffer and play it\r\n                const buffer = audioContext.createBuffer(1, 1, 22050);\r\n                const source = audioContext.createBufferSource();\r\n                let ended = false;\r\n                source.buffer = buffer;\r\n                source.connect(audioContext.destination);\r\n                source.onended = () => (ended = true);\r\n                source.start(0);\r\n                // by checking the play state after some time, we know if we're really unlocked\r\n                setTimeout(() => {\r\n                    if (isLegacyWebAudioSource(source)) {\r\n                        if (source.playbackState === source.PLAYING_STATE || source.playbackState === source.FINISHED_STATE) {\r\n                            WebAudio._UNLOCKED = true;\r\n                        }\r\n                    }\r\n                    else {\r\n                        if (audioContext.currentTime > 0 || ended) {\r\n                            WebAudio._UNLOCKED = true;\r\n                        }\r\n                    }\r\n                }, 0);\r\n                clearTimeout(unlockTimeoutTimer);\r\n                resolve(true);\r\n            }, () => {\r\n                reject();\r\n            });\r\n        });\r\n        return promise;\r\n    }\r\n    static isUnlocked() {\r\n        return this._UNLOCKED;\r\n    }\r\n}\r\nWebAudio._UNLOCKED = false;\r\n\n;// CONCATENATED MODULE: ./Class.ts\n\r\n/**\r\n * Excalibur base class that provides basic functionality such as [[EventDispatcher]]\r\n * and extending abilities for vanilla Javascript projects\r\n */\r\nclass Class {\r\n    constructor() {\r\n        this.eventDispatcher = new EventDispatcher(this);\r\n    }\r\n    /**\r\n     * Alias for `addEventListener`. You can listen for a variety of\r\n     * events off of the engine; see the events section below for a complete list.\r\n     * @param eventName  Name of the event to listen for\r\n     * @param handler    Event handler for the thrown event\r\n     */\r\n    on(eventName, handler) {\r\n        this.eventDispatcher.on(eventName, handler);\r\n    }\r\n    /**\r\n     * Alias for `removeEventListener`. If only the eventName is specified\r\n     * it will remove all handlers registered for that specific event. If the eventName\r\n     * and the handler instance are specified only that handler will be removed.\r\n     *\r\n     * @param eventName  Name of the event to listen for\r\n     * @param handler    Event handler for the thrown event\r\n     */\r\n    off(eventName, handler) {\r\n        this.eventDispatcher.off(eventName, handler);\r\n    }\r\n    /**\r\n     * Emits a new event\r\n     * @param eventName   Name of the event to emit\r\n     * @param eventObject Data associated with this event\r\n     */\r\n    emit(eventName, eventObject) {\r\n        this.eventDispatcher.emit(eventName, eventObject);\r\n    }\r\n    /**\r\n     * Once listens to an event one time, then unsubscribes from that event\r\n     *\r\n     * @param eventName The name of the event to subscribe to once\r\n     * @param handler   The handler of the event that will be auto unsubscribed\r\n     */\r\n    once(eventName, handler) {\r\n        this.eventDispatcher.once(eventName, handler);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/DrawUtil.ts\n\r\n/* istanbul ignore next */\r\n/**\r\n * Draw a line on canvas context\r\n *\r\n * @param ctx The canvas context\r\n * @param color The color of the line\r\n * @param x1 The start x coordinate\r\n * @param y1 The start y coordinate\r\n * @param x2 The ending x coordinate\r\n * @param y2 The ending y coordinate\r\n * @param thickness The line thickness\r\n * @param cap The [[LineCapStyle]] (butt, round, or square)\r\n */\r\nfunction line(ctx, color = Color.Red, x1, y1, x2, y2, thickness = 1, cap = 'butt') {\r\n    ctx.beginPath();\r\n    ctx.lineWidth = thickness;\r\n    ctx.lineCap = cap;\r\n    ctx.strokeStyle = color.toString();\r\n    ctx.moveTo(x1, y1);\r\n    ctx.lineTo(x2, y2);\r\n    ctx.closePath();\r\n    ctx.stroke();\r\n}\r\n/* istanbul ignore next */\r\n/**\r\n * Draw the vector as a point onto the canvas.\r\n */\r\nfunction point(ctx, color = Color.Red, point) {\r\n    ctx.beginPath();\r\n    ctx.strokeStyle = color.toString();\r\n    ctx.arc(point.x, point.y, 5, 0, Math.PI * 2);\r\n    ctx.closePath();\r\n    ctx.stroke();\r\n}\r\n/**\r\n * Draw the vector as a line onto the canvas starting a origin point.\r\n */\r\n/* istanbul ignore next */\r\n/**\r\n *\r\n */\r\nfunction vector(ctx, color, origin, vector, scale = 1.0) {\r\n    const c = color ? color.toString() : 'blue';\r\n    const v = vector.scale(scale);\r\n    ctx.beginPath();\r\n    ctx.strokeStyle = c;\r\n    ctx.moveTo(origin.x, origin.y);\r\n    ctx.lineTo(origin.x + v.x, origin.y + v.y);\r\n    ctx.closePath();\r\n    ctx.stroke();\r\n}\r\n/**\r\n * Draw a round rectangle on a canvas context\r\n *\r\n * @param ctx The canvas context\r\n * @param x The top-left x coordinate\r\n * @param y The top-left y coordinate\r\n * @param width The width of the rectangle\r\n * @param height The height of the rectangle\r\n * @param radius The border radius of the rectangle\r\n * @param stroke The [[Color]] to stroke rectangle with\r\n * @param fill The [[Color]] to fill rectangle with\r\n */\r\nfunction roundRect(ctx, x, y, width, height, radius = 5, stroke = Color.White, fill = null) {\r\n    let br;\r\n    if (typeof radius === 'number') {\r\n        br = { tl: radius, tr: radius, br: radius, bl: radius };\r\n    }\r\n    else {\r\n        const defaultRadius = { tl: 0, tr: 0, br: 0, bl: 0 };\r\n        for (const prop in defaultRadius) {\r\n            if (defaultRadius.hasOwnProperty(prop)) {\r\n                const side = prop;\r\n                br[side] = radius[side] || defaultRadius[side];\r\n            }\r\n        }\r\n    }\r\n    ctx.beginPath();\r\n    ctx.moveTo(x + br.tl, y);\r\n    ctx.lineTo(x + width - br.tr, y);\r\n    ctx.quadraticCurveTo(x + width, y, x + width, y + br.tr);\r\n    ctx.lineTo(x + width, y + height - br.br);\r\n    ctx.quadraticCurveTo(x + width, y + height, x + width - br.br, y + height);\r\n    ctx.lineTo(x + br.bl, y + height);\r\n    ctx.quadraticCurveTo(x, y + height, x, y + height - br.bl);\r\n    ctx.lineTo(x, y + br.tl);\r\n    ctx.quadraticCurveTo(x, y, x + br.tl, y);\r\n    ctx.closePath();\r\n    if (fill) {\r\n        ctx.fillStyle = fill.toString();\r\n        ctx.fill();\r\n    }\r\n    if (stroke) {\r\n        ctx.strokeStyle = stroke.toString();\r\n        ctx.stroke();\r\n    }\r\n}\r\n/**\r\n *\r\n */\r\nfunction circle(ctx, x, y, radius, stroke = Color.White, fill = null) {\r\n    ctx.beginPath();\r\n    ctx.arc(x, y, radius, 0, Math.PI * 2);\r\n    ctx.closePath();\r\n    if (fill) {\r\n        ctx.fillStyle = fill.toString();\r\n        ctx.fill();\r\n    }\r\n    if (stroke) {\r\n        ctx.strokeStyle = stroke.toString();\r\n        ctx.stroke();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Loader.logo.png\n/* harmony default export */ const Loader_logo = (\"data:image/png;base64,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\");\n// EXTERNAL MODULE: ./Loader.css\nvar Loader_0 = __webpack_require__(1388);\n;// CONCATENATED MODULE: ./Loader.ts\nvar Loader_awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Pre-loading assets\r\n *\r\n * The loader provides a mechanism to preload multiple resources at\r\n * one time. The loader must be passed to the engine in order to\r\n * trigger the loading progress bar.\r\n *\r\n * The [[Loader]] itself implements [[Loadable]] so you can load loaders.\r\n *\r\n * ## Example: Pre-loading resources for a game\r\n *\r\n * ```js\r\n * // create a loader\r\n * var loader = new ex.Loader();\r\n *\r\n * // create a resource dictionary (best practice is to keep a separate file)\r\n * var resources = {\r\n *   TextureGround: new ex.Texture(\"/images/textures/ground.png\"),\r\n *   SoundDeath: new ex.Sound(\"/sound/death.wav\", \"/sound/death.mp3\")\r\n * };\r\n *\r\n * // loop through dictionary and add to loader\r\n * for (var loadable in resources) {\r\n *   if (resources.hasOwnProperty(loadable)) {\r\n *     loader.addResource(resources[loadable]);\r\n *   }\r\n * }\r\n *\r\n * // start game\r\n * game.start(loader).then(function () {\r\n *   console.log(\"Game started!\");\r\n * });\r\n * ```\r\n *\r\n * ## Customize the Loader\r\n *\r\n * The loader can be customized to show different, text, logo, background color, and button.\r\n *\r\n * ```typescript\r\n * const loader = new ex.Loader([playerTexture]);\r\n *\r\n * // The loaders button text can simply modified using this\r\n * loader.playButtonText = 'Start the best game ever';\r\n *\r\n * // The logo can be changed by inserting a base64 image string here\r\n *\r\n * loader.logo = 'data:image/png;base64,iVBORw...';\r\n * loader.logoWidth = 15;\r\n * loader.logoHeight = 14;\r\n *\r\n * // The background color can be changed like so by supplying a valid CSS color string\r\n *\r\n * loader.backgroundColor = 'red'\r\n * loader.backgroundColor = '#176BAA'\r\n *\r\n * // To build a completely new button\r\n * loader.startButtonFactory = () => {\r\n *     let myButton = document.createElement('button');\r\n *     myButton.textContent = 'The best button';\r\n *     return myButton;\r\n * };\r\n *\r\n * engine.start(loader).then(() => {});\r\n * ```\r\n */\r\nclass Loader extends Class {\r\n    /**\r\n     * @param loadables  Optionally provide the list of resources you want to load at constructor time\r\n     */\r\n    constructor(loadables) {\r\n        super();\r\n        this.canvas = new Canvas({\r\n            smoothing: true,\r\n            draw: this.draw.bind(this)\r\n        });\r\n        this._resourceList = [];\r\n        this._index = 0;\r\n        this._playButtonShown = false;\r\n        this._resourceCount = 0;\r\n        this._numLoaded = 0;\r\n        this._progressCounts = {};\r\n        this._totalCounts = {};\r\n        // logo drawing stuff\r\n        // base64 string encoding of the excalibur logo (logo-white.png)\r\n        this.logo = Loader_logo;\r\n        this.logoWidth = 468;\r\n        this.logoHeight = 118;\r\n        /**\r\n         * Gets or sets the color of the loading bar, default is [[Color.White]]\r\n         */\r\n        this.loadingBarColor = Color.White;\r\n        /**\r\n         * Gets or sets the background color of the loader as a hex string\r\n         */\r\n        this.backgroundColor = '#176BAA';\r\n        this.suppressPlayButton = false;\r\n        /** Loads the css from Loader.css */\r\n        this._playButtonStyles = Loader_0/* default.toString */.Z.toString();\r\n        /**\r\n         * Get/set play button text\r\n         */\r\n        this.playButtonText = 'Play game';\r\n        /**\r\n         * Return a html button element for excalibur to use as a play button\r\n         */\r\n        this.startButtonFactory = () => {\r\n            let buttonElement = document.getElementById('excalibur-play');\r\n            if (!buttonElement) {\r\n                buttonElement = document.createElement('button');\r\n            }\r\n            buttonElement.id = 'excalibur-play';\r\n            buttonElement.textContent = this.playButtonText;\r\n            buttonElement.style.display = 'none';\r\n            return buttonElement;\r\n        };\r\n        if (loadables) {\r\n            this.addResources(loadables);\r\n        }\r\n    }\r\n    get _image() {\r\n        if (!this._imageElement) {\r\n            this._imageElement = new Image();\r\n            this._imageElement.src = this.logo;\r\n        }\r\n        return this._imageElement;\r\n    }\r\n    get playButtonRootElement() {\r\n        return this._playButtonRootElement;\r\n    }\r\n    get playButtonElement() {\r\n        return this._playButtonElement;\r\n    }\r\n    get _playButton() {\r\n        const existingRoot = document.getElementById('excalibur-play-root');\r\n        if (existingRoot) {\r\n            this._playButtonRootElement = existingRoot;\r\n        }\r\n        if (!this._playButtonRootElement) {\r\n            this._playButtonRootElement = document.createElement('div');\r\n            this._playButtonRootElement.id = 'excalibur-play-root';\r\n            this._playButtonRootElement.style.position = 'absolute';\r\n            document.body.appendChild(this._playButtonRootElement);\r\n        }\r\n        if (!this._styleBlock) {\r\n            this._styleBlock = document.createElement('style');\r\n            this._styleBlock.textContent = this._playButtonStyles;\r\n            document.head.appendChild(this._styleBlock);\r\n        }\r\n        if (!this._playButtonElement) {\r\n            this._playButtonElement = this.startButtonFactory();\r\n            this._playButtonRootElement.appendChild(this._playButtonElement);\r\n        }\r\n        return this._playButtonElement;\r\n    }\r\n    wireEngine(engine) {\r\n        this._engine = engine;\r\n        this.canvas.width = this._engine.canvas.width;\r\n        this.canvas.height = this._engine.canvas.height;\r\n    }\r\n    /**\r\n     * Add a resource to the loader to load\r\n     * @param loadable  Resource to add\r\n     */\r\n    addResource(loadable) {\r\n        const key = this._index++;\r\n        this._resourceList.push(loadable);\r\n        this._progressCounts[key] = 0;\r\n        this._totalCounts[key] = 1;\r\n        this._resourceCount++;\r\n    }\r\n    /**\r\n     * Add a list of resources to the loader to load\r\n     * @param loadables  The list of resources to load\r\n     */\r\n    addResources(loadables) {\r\n        let i = 0;\r\n        const len = loadables.length;\r\n        for (i; i < len; i++) {\r\n            this.addResource(loadables[i]);\r\n        }\r\n    }\r\n    /**\r\n     * Returns true if the loader has completely loaded all resources\r\n     */\r\n    isLoaded() {\r\n        return this._numLoaded === this._resourceCount;\r\n    }\r\n    /**\r\n     * Shows the play button and returns a promise that resolves when clicked\r\n     */\r\n    showPlayButton() {\r\n        var _a;\r\n        if (this.suppressPlayButton) {\r\n            this.hidePlayButton();\r\n            return Promise.resolve();\r\n        }\r\n        else {\r\n            const resizeHandler = () => {\r\n                this._positionPlayButton();\r\n            };\r\n            if ((_a = this._engine) === null || _a === void 0 ? void 0 : _a.browser) {\r\n                this._engine.browser.window.on('resize', resizeHandler);\r\n            }\r\n            this._playButtonShown = true;\r\n            this._playButton.style.display = 'block';\r\n            document.body.addEventListener('keyup', (evt) => {\r\n                if (evt.key === 'Enter') {\r\n                    this._playButton.click();\r\n                }\r\n            });\r\n            const promise = new Promise((resolve) => {\r\n                const startButtonHandler = (e) => {\r\n                    var _a;\r\n                    // We want to stop propogation to keep bubbling to the engine pointer handlers\r\n                    e.stopPropagation();\r\n                    // Hide Button after click\r\n                    this.hidePlayButton();\r\n                    if ((_a = this._engine) === null || _a === void 0 ? void 0 : _a.browser) {\r\n                        this._engine.browser.window.off('resize', resizeHandler);\r\n                    }\r\n                    resolve();\r\n                };\r\n                this._playButton.addEventListener('click', startButtonHandler);\r\n                this._playButton.addEventListener('touchend', startButtonHandler);\r\n                this._playButton.addEventListener('pointerup', startButtonHandler);\r\n            });\r\n            return promise;\r\n        }\r\n    }\r\n    hidePlayButton() {\r\n        this._playButtonShown = false;\r\n        this._playButton.style.display = 'none';\r\n    }\r\n    /**\r\n     * Clean up generated elements for the loader\r\n     */\r\n    dispose() {\r\n        if (this._playButtonRootElement.parentElement) {\r\n            this._playButtonRootElement.removeChild(this._playButtonElement);\r\n            document.body.removeChild(this._playButtonRootElement);\r\n            document.head.removeChild(this._styleBlock);\r\n            this._playButtonRootElement = null;\r\n            this._playButtonElement = null;\r\n            this._styleBlock = null;\r\n        }\r\n    }\r\n    update(_engine, _delta) {\r\n        // override me\r\n    }\r\n    /**\r\n     * Begin loading all of the supplied resources, returning a promise\r\n     * that resolves when loading of all is complete\r\n     */\r\n    load() {\r\n        return Loader_awaiter(this, void 0, void 0, function* () {\r\n            yield Promise.all(this._resourceList.map((r) => r.load().finally(() => {\r\n                // capture progress\r\n                this._numLoaded++;\r\n            })));\r\n            // short delay in showing the button for aesthetics\r\n            yield delay(200);\r\n            yield this.showPlayButton();\r\n            // Unlock browser AudioContext in after user gesture\r\n            // See: https://github.com/excaliburjs/Excalibur/issues/262\r\n            // See: https://github.com/excaliburjs/Excalibur/issues/1031\r\n            yield WebAudio.unlock();\r\n            return (this.data = this._resourceList);\r\n        });\r\n    }\r\n    markResourceComplete() {\r\n        this._numLoaded++;\r\n    }\r\n    /**\r\n     * Returns the progess of the loader as a number between [0, 1] inclusive.\r\n     */\r\n    get progress() {\r\n        return this._resourceCount > 0 ? clamp(this._numLoaded, 0, this._resourceCount) / this._resourceCount : 1;\r\n    }\r\n    _positionPlayButton() {\r\n        const screenHeight = this._engine.screen.viewport.height;\r\n        const screenWidth = this._engine.screen.viewport.width;\r\n        if (this._playButtonRootElement) {\r\n            const left = this._engine.canvas.offsetLeft;\r\n            const top = this._engine.canvas.offsetTop;\r\n            const buttonWidth = this._playButton.clientWidth;\r\n            const buttonHeight = this._playButton.clientHeight;\r\n            if (this.playButtonPosition) {\r\n                this._playButtonRootElement.style.left = `${this.playButtonPosition.x}px`;\r\n                this._playButtonRootElement.style.top = `${this.playButtonPosition.y}px`;\r\n            }\r\n            else {\r\n                this._playButtonRootElement.style.left = `${left + screenWidth / 2 - buttonWidth / 2}px`;\r\n                this._playButtonRootElement.style.top = `${top + screenHeight / 2 - buttonHeight / 2 + 100}px`;\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Loader draw function. Draws the default Excalibur loading screen.\r\n     * Override `logo`, `logoWidth`, `logoHeight` and `backgroundColor` properties\r\n     * to customize the drawing, or just override entire method.\r\n     */\r\n    draw(ctx) {\r\n        const canvasHeight = this._engine.canvasHeight / this._engine.pixelRatio;\r\n        const canvasWidth = this._engine.canvasWidth / this._engine.pixelRatio;\r\n        this._positionPlayButton();\r\n        ctx.fillStyle = this.backgroundColor;\r\n        ctx.fillRect(0, 0, canvasWidth, canvasHeight);\r\n        let logoY = canvasHeight / 2;\r\n        const width = Math.min(this.logoWidth, canvasWidth * 0.75);\r\n        let logoX = canvasWidth / 2 - width / 2;\r\n        if (this.logoPosition) {\r\n            logoX = this.logoPosition.x;\r\n            logoY = this.logoPosition.y;\r\n        }\r\n        const imageHeight = Math.floor(width * (this.logoHeight / this.logoWidth)); // OG height/width factor\r\n        const oldAntialias = this._engine.getAntialiasing();\r\n        this._engine.setAntialiasing(true);\r\n        if (!this.logoPosition) {\r\n            ctx.drawImage(this._image, 0, 0, this.logoWidth, this.logoHeight, logoX, logoY - imageHeight - 20, width, imageHeight);\r\n        }\r\n        else {\r\n            ctx.drawImage(this._image, 0, 0, this.logoWidth, this.logoHeight, logoX, logoY, width, imageHeight);\r\n        }\r\n        // loading box\r\n        if (!this.suppressPlayButton && this._playButtonShown) {\r\n            this._engine.setAntialiasing(oldAntialias);\r\n            return;\r\n        }\r\n        let loadingX = logoX;\r\n        let loadingY = logoY;\r\n        if (this.loadingBarPosition) {\r\n            loadingX = this.loadingBarPosition.x;\r\n            loadingY = this.loadingBarPosition.y;\r\n        }\r\n        ctx.lineWidth = 2;\r\n        roundRect(ctx, loadingX, loadingY, width, 20, 10, this.loadingBarColor);\r\n        const progress = width * this.progress;\r\n        const margin = 5;\r\n        const progressWidth = progress - margin * 2;\r\n        const height = 20 - margin * 2;\r\n        roundRect(ctx, loadingX + margin, loadingY + margin, progressWidth > 10 ? progressWidth : 10, height, 5, null, this.loadingBarColor);\r\n        this._engine.setAntialiasing(oldAntialias);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Detector.ts\n\r\n/**\r\n * This is the list of features that will be used to log the supported\r\n * features to the console when Detector.logBrowserFeatures() is called.\r\n */\r\nconst REPORTED_FEATURES = {\r\n    webgl: 'WebGL',\r\n    webaudio: 'WebAudio',\r\n    gamepadapi: 'Gamepad API'\r\n};\r\n/**\r\n * Excalibur internal feature detection helper class\r\n */\r\nclass Detector {\r\n    constructor() {\r\n        this._features = null;\r\n        this.failedTests = [];\r\n        // critical browser features required for ex to run\r\n        this._criticalTests = {\r\n            // Test canvas/2d context support\r\n            canvasSupport: function () {\r\n                const elem = document.createElement('canvas');\r\n                return !!(elem.getContext && elem.getContext('2d'));\r\n            },\r\n            // Test array buffer support ex uses for downloading binary data\r\n            arrayBufferSupport: function () {\r\n                const xhr = new XMLHttpRequest();\r\n                xhr.open('GET', '/');\r\n                try {\r\n                    xhr.responseType = 'arraybuffer';\r\n                }\r\n                catch (e) {\r\n                    return false;\r\n                }\r\n                return xhr.responseType === 'arraybuffer';\r\n            },\r\n            // Test data urls ex uses for sprites\r\n            dataUrlSupport: function () {\r\n                const canvas = document.createElement('canvas');\r\n                return canvas.toDataURL('image/png').indexOf('data:image/png') === 0;\r\n            },\r\n            // Test object url support for loading\r\n            objectUrlSupport: function () {\r\n                return 'URL' in window && 'revokeObjectURL' in URL && 'createObjectURL' in URL;\r\n            },\r\n            // RGBA support for colors\r\n            rgbaSupport: function () {\r\n                const style = document.createElement('a').style;\r\n                style.cssText = 'background-color:rgba(150,255,150,.5)';\r\n                return ('' + style.backgroundColor).indexOf('rgba') > -1;\r\n            }\r\n        };\r\n        // warnings excalibur performance will be degraded\r\n        this._warningTest = {\r\n            webAudioSupport: function () {\r\n                return !!(window.AudioContext ||\r\n                    window.webkitAudioContext ||\r\n                    window.mozAudioContext ||\r\n                    window.msAudioContext ||\r\n                    window.oAudioContext);\r\n            },\r\n            webglSupport: function () {\r\n                const elem = document.createElement('canvas');\r\n                return !!(elem.getContext && elem.getContext('webgl'));\r\n            }\r\n        };\r\n        this._features = this._loadBrowserFeatures();\r\n    }\r\n    /**\r\n     * Returns a map of currently supported browser features. This method\r\n     * treats the features as a singleton and will only calculate feature\r\n     * support if it has not previously been done.\r\n     */\r\n    getBrowserFeatures() {\r\n        if (this._features === null) {\r\n            this._features = this._loadBrowserFeatures();\r\n        }\r\n        return this._features;\r\n    }\r\n    /**\r\n     * Report on non-critical browser support for debugging purposes.\r\n     * Use native browser console colors for visibility.\r\n     */\r\n    logBrowserFeatures() {\r\n        let msg = '%cSUPPORTED BROWSER FEATURES\\n==========================%c\\n';\r\n        const args = ['font-weight: bold; color: navy', 'font-weight: normal; color: inherit'];\r\n        const supported = this.getBrowserFeatures();\r\n        for (const feature of Object.keys(REPORTED_FEATURES)) {\r\n            if (supported[feature]) {\r\n                msg += '(%c\\u2713%c)'; // (✓)\r\n                args.push('font-weight: bold; color: green');\r\n                args.push('font-weight: normal; color: inherit');\r\n            }\r\n            else {\r\n                msg += '(%c\\u2717%c)'; // (✗)\r\n                args.push('font-weight: bold; color: red');\r\n                args.push('font-weight: normal; color: inherit');\r\n            }\r\n            msg += ' ' + REPORTED_FEATURES[feature] + '\\n';\r\n        }\r\n        args.unshift(msg);\r\n        // eslint-disable-next-line no-console\r\n        console.log.apply(console, args);\r\n    }\r\n    /**\r\n     * Executes several IIFE's to get a constant reference to supported\r\n     * features within the current execution context.\r\n     */\r\n    _loadBrowserFeatures() {\r\n        return {\r\n            // IIFE to check canvas support\r\n            canvas: (() => {\r\n                return this._criticalTests.canvasSupport();\r\n            })(),\r\n            // IIFE to check arraybuffer support\r\n            arraybuffer: (() => {\r\n                return this._criticalTests.arrayBufferSupport();\r\n            })(),\r\n            // IIFE to check dataurl support\r\n            dataurl: (() => {\r\n                return this._criticalTests.dataUrlSupport();\r\n            })(),\r\n            // IIFE to check objecturl support\r\n            objecturl: (() => {\r\n                return this._criticalTests.objectUrlSupport();\r\n            })(),\r\n            // IIFE to check rgba support\r\n            rgba: (() => {\r\n                return this._criticalTests.rgbaSupport();\r\n            })(),\r\n            // IIFE to check webaudio support\r\n            webaudio: (() => {\r\n                return this._warningTest.webAudioSupport();\r\n            })(),\r\n            // IIFE to check webgl support\r\n            webgl: (() => {\r\n                return this._warningTest.webglSupport();\r\n            })(),\r\n            // IIFE to check gamepadapi support\r\n            gamepadapi: (() => {\r\n                return !!navigator.getGamepads;\r\n            })()\r\n        };\r\n    }\r\n    test() {\r\n        // Critical test will for ex not to run\r\n        let failedCritical = false;\r\n        for (const test in this._criticalTests) {\r\n            if (!this._criticalTests[test].call(this)) {\r\n                this.failedTests.push(test);\r\n                Logger.getInstance().error('Critical browser feature missing, Excalibur requires:', test);\r\n                failedCritical = true;\r\n            }\r\n        }\r\n        if (failedCritical) {\r\n            return false;\r\n        }\r\n        // Warning tests do not for ex to return false to compatibility\r\n        for (const warning in this._warningTest) {\r\n            if (!this._warningTest[warning]()) {\r\n                Logger.getInstance().warn('Warning browser feature missing, Excalibur will have reduced performance:', warning);\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/CollisionType.ts\n/**\r\n * An enum that describes the types of collisions bodies can participate in\r\n */\r\nvar CollisionType;\r\n(function (CollisionType) {\r\n    /**\r\n     * Bodies with the `PreventCollision` setting do not participate in any\r\n     * collisions and do not raise collision events.\r\n     */\r\n    CollisionType[\"PreventCollision\"] = \"PreventCollision\";\r\n    /**\r\n     * Bodies with the `Passive` setting only raise collision events, but are not\r\n     * influenced or moved by other bodies and do not influence or move other bodies.\r\n     * This is useful for use in trigger type behavior.\r\n     */\r\n    CollisionType[\"Passive\"] = \"Passive\";\r\n    /**\r\n     * Bodies with the `Active` setting raise collision events and participate\r\n     * in collisions with other bodies and will be push or moved by bodies sharing\r\n     * the `Active` or `Fixed` setting.\r\n     */\r\n    CollisionType[\"Active\"] = \"Active\";\r\n    /**\r\n     * Bodies with the `Fixed` setting raise collision events and participate in\r\n     * collisions with other bodies. Actors with the `Fixed` setting will not be\r\n     * pushed or moved by other bodies sharing the `Fixed`. Think of Fixed\r\n     * bodies as \"immovable/unstoppable\" objects. If two `Fixed` bodies meet they will\r\n     * not be pushed or moved by each other, they will not interact except to throw\r\n     * collision events.\r\n     */\r\n    CollisionType[\"Fixed\"] = \"Fixed\";\r\n})(CollisionType || (CollisionType = {}));\r\n\n;// CONCATENATED MODULE: ./Collision/Physics.ts\nvar Physics_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\n\r\n/**\r\n * Possible collision resolution strategies\r\n *\r\n * The default is [[CollisionResolutionStrategy.Arcade]] which performs simple axis aligned arcade style physics. This is useful for things\r\n * like platformers or top down games.\r\n *\r\n * More advanced rigid body physics are enabled by setting [[CollisionResolutionStrategy.Realistic]] which allows for complicated\r\n * simulated physical interactions.\r\n */\r\nvar CollisionResolutionStrategy;\r\n(function (CollisionResolutionStrategy) {\r\n    CollisionResolutionStrategy[\"Arcade\"] = \"arcade\";\r\n    CollisionResolutionStrategy[\"Realistic\"] = \"realistic\";\r\n})(CollisionResolutionStrategy || (CollisionResolutionStrategy = {}));\r\n/**\r\n * Possible broadphase collision pair identification strategies\r\n *\r\n * The default strategy is [[BroadphaseStrategy.DynamicAABBTree]] which uses a binary tree of axis-aligned bounding boxes to identify\r\n * potential collision pairs which is O(nlog(n)) faster.\r\n */\r\nvar BroadphaseStrategy;\r\n(function (BroadphaseStrategy) {\r\n    BroadphaseStrategy[BroadphaseStrategy[\"DynamicAABBTree\"] = 0] = \"DynamicAABBTree\";\r\n})(BroadphaseStrategy || (BroadphaseStrategy = {}));\r\n/**\r\n * Possible numerical integrators for position and velocity\r\n */\r\nvar Integrator;\r\n(function (Integrator) {\r\n    Integrator[Integrator[\"Euler\"] = 0] = \"Euler\";\r\n})(Integrator || (Integrator = {}));\r\n/**\r\n * The [[Physics]] object is the global configuration object for all Excalibur physics.\r\n */\r\n/* istanbul ignore next */\r\nclass Physics {\r\n    static get gravity() {\r\n        return Physics.acc;\r\n    }\r\n    static set gravity(v) {\r\n        Physics.acc = v;\r\n    }\r\n    /**\r\n     * Configures Excalibur to use \"arcade\" physics. Arcade physics which performs simple axis aligned arcade style physics.\r\n     */\r\n    static useArcadePhysics() {\r\n        Physics.collisionResolutionStrategy = CollisionResolutionStrategy.Arcade;\r\n    }\r\n    /**\r\n     * Configures Excalibur to use rigid body physics. Rigid body physics allows for complicated\r\n     * simulated physical interactions.\r\n     */\r\n    static useRealisticPhysics() {\r\n        Physics.collisionResolutionStrategy = CollisionResolutionStrategy.Realistic;\r\n    }\r\n    static get dynamicTreeVelocityMultiplyer() {\r\n        return Physics.dynamicTreeVelocityMultiplier;\r\n    }\r\n    static set dynamicTreeVelocityMultiplyer(value) {\r\n        Physics.dynamicTreeVelocityMultiplier = value;\r\n    }\r\n}\r\n/**\r\n * Global acceleration that is applied to all vanilla actors that have a [[CollisionType.Active|active]] collision type.\r\n * Global acceleration won't effect [[Label|labels]], [[ScreenElement|ui actors]], or [[Trigger|triggers]] in Excalibur.\r\n *\r\n * This is a great way to globally simulate effects like gravity.\r\n */\r\nPhysics.acc = new Vector(0, 0);\r\n/**\r\n * Globally switches all Excalibur physics behavior on or off.\r\n */\r\nPhysics.enabled = true;\r\n/**\r\n * Gets or sets the broadphase pair identification strategy.\r\n *\r\n * The default strategy is [[BroadphaseStrategy.DynamicAABBTree]] which uses a binary tree of axis-aligned bounding boxes to identify\r\n * potential collision pairs which is O(nlog(n)) faster.\r\n */\r\nPhysics.broadphaseStrategy = BroadphaseStrategy.DynamicAABBTree;\r\n/**\r\n * Gets or sets the global collision resolution strategy (narrowphase).\r\n *\r\n * The default is [[CollisionResolutionStrategy.Arcade]] which performs simple axis aligned arcade style physics.\r\n *\r\n * More advanced rigid body physics are enabled by setting [[CollisionResolutionStrategy.Realistic]] which allows for complicated\r\n * simulated physical interactions.\r\n */\r\nPhysics.collisionResolutionStrategy = CollisionResolutionStrategy.Arcade;\r\n/**\r\n * The default mass to use if none is specified\r\n */\r\nPhysics.defaultMass = 10;\r\n/**\r\n * Gets or sets the position and velocity positional integrator, currently only Euler is supported.\r\n */\r\nPhysics.integrator = Integrator.Euler;\r\n/**\r\n * Factor to add to the RigidBody BoundingBox, bounding box (dimensions += vel * dynamicTreeVelocityMultiplier);\r\n */\r\nPhysics.dynamicTreeVelocityMultiplier = 2;\r\n/**\r\n * Pad RigidBody BoundingBox by a constant amount\r\n */\r\nPhysics.boundsPadding = 5;\r\n/**\r\n * Number of position iterations (overlap) to run in the solver\r\n */\r\nPhysics.positionIterations = 3;\r\n/**\r\n * Number of velocity iteration (response) to run in the solver\r\n */\r\nPhysics.velocityIterations = 8;\r\n/**\r\n * Amount of overlap to tolerate in pixels\r\n */\r\nPhysics.slop = 1;\r\n/**\r\n * Amount of positional overlap correction to apply each position iteration of the solver\r\n * O - meaning no correction, 1 - meaning correct all overlap\r\n */\r\nPhysics.steeringFactor = 0.2;\r\n/**\r\n * Warm start set to true re-uses impulses from previous frames back in the solver\r\n */\r\nPhysics.warmStart = true;\r\n/**\r\n * By default bodies do not sleep\r\n */\r\nPhysics.bodiesCanSleepByDefault = false;\r\n/**\r\n * Surface epsilon is used to help deal with surface penetration\r\n */\r\nPhysics.surfaceEpsilon = 0.1;\r\nPhysics.sleepEpsilon = 0.07;\r\nPhysics.wakeThreshold = Physics.sleepEpsilon * 3;\r\nPhysics.sleepBias = 0.9;\r\n/**\r\n * Enable fast moving body checking, this enables checking for collision pairs via raycast for fast moving objects to prevent\r\n * bodies from tunneling through one another.\r\n */\r\nPhysics.checkForFastBodies = true;\r\n/**\r\n * Disable minimum fast moving body raycast, by default if ex.Physics.checkForFastBodies = true Excalibur will only check if the\r\n * body is moving at least half of its minimum dimension in an update. If ex.Physics.disableMinimumSpeedForFastBody is set to true,\r\n * Excalibur will always perform the fast body raycast regardless of speed.\r\n */\r\nPhysics.disableMinimumSpeedForFastBody = false;\r\nPhysics_decorate([\r\n    obsolete({\r\n        message: 'Alias for incorrect spelling used in older versions, will be removed in v0.25.0',\r\n        alternateMethod: 'dynamicTreeVelocityMultiplier'\r\n    })\r\n], Physics, \"dynamicTreeVelocityMultiplyer\", null);\r\n\n;// CONCATENATED MODULE: ./Math/vector-view.ts\n\r\nclass VectorView extends Vector {\r\n    constructor(options) {\r\n        super(0, 0);\r\n        this._getX = options.getX;\r\n        this._getY = options.getY;\r\n        this._setX = options.setX;\r\n        this._setY = options.setY;\r\n    }\r\n    get x() {\r\n        return (this._x = this._getX());\r\n    }\r\n    set x(val) {\r\n        this._setX(val);\r\n        this._x = val;\r\n    }\r\n    get y() {\r\n        return (this._y = this._getY());\r\n    }\r\n    set y(val) {\r\n        this._setY(val);\r\n        this._y = val;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/Component.ts\n/**\r\n * Type guard to check if a component implements clone\r\n * @param x\r\n */\r\nfunction hasClone(x) {\r\n    return !!(x === null || x === void 0 ? void 0 : x.clone);\r\n}\r\n/**\r\n * Components are containers for state in Excalibur, the are meant to convey capabilities that an Entity posesses\r\n *\r\n * Implementations of Component must have a zero-arg constructor to support dependecies\r\n *\r\n * ```typescript\r\n * class MyComponent extends ex.Component<'my'> {\r\n *   public readonly type = 'my';\r\n *   // zero arg support required if you want to use component dependencies\r\n *   constructor(public optionalPos?: ex.Vector) {}\r\n * }\r\n * ```\r\n */\r\nclass Component {\r\n    constructor() {\r\n        /**\r\n         * Current owning [[Entity]], if any, of this component. Null if not added to any [[Entity]]\r\n         */\r\n        this.owner = null;\r\n    }\r\n    /**\r\n     * Clones any properties on this component, if that property value has a `clone()` method it will be called\r\n     */\r\n    clone() {\r\n        const newComponent = new this.constructor();\r\n        for (const prop in this) {\r\n            if (this.hasOwnProperty(prop)) {\r\n                const val = this[prop];\r\n                if (hasClone(val) && prop !== 'owner' && prop !== 'clone') {\r\n                    newComponent[prop] = val.clone();\r\n                }\r\n                else {\r\n                    newComponent[prop] = val;\r\n                }\r\n            }\r\n        }\r\n        return newComponent;\r\n    }\r\n}\r\n/**\r\n * Tag components are a way of tagging a component with label and a simple value\r\n *\r\n * For example:\r\n *\r\n * ```typescript\r\n * const isOffscreen = new TagComponent('offscreen');\r\n * entity.addComponent(isOffscreen);\r\n * entity.tags.includes\r\n * ```\r\n */\r\nclass TagComponent extends Component {\r\n    constructor(type, value) {\r\n        super();\r\n        this.type = type;\r\n        this.value = value;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/Components/TransformComponent.ts\n\r\n\r\n\r\n\r\nconst createPosView = (matrix) => {\r\n    const source = matrix;\r\n    return new VectorView({\r\n        setX: (x) => {\r\n            source.data[MatrixLocations.X] = x;\r\n        },\r\n        setY: (y) => {\r\n            source.data[MatrixLocations.Y] = y;\r\n        },\r\n        getX: () => {\r\n            return source.data[MatrixLocations.X];\r\n        },\r\n        getY: () => {\r\n            return source.data[MatrixLocations.Y];\r\n        }\r\n    });\r\n};\r\nconst createScaleView = (matrix) => {\r\n    const source = matrix;\r\n    return new VectorView({\r\n        setX: (x) => {\r\n            source.setScaleX(x);\r\n        },\r\n        setY: (y) => {\r\n            source.setScaleY(y);\r\n        },\r\n        getX: () => {\r\n            return source.getScaleX();\r\n        },\r\n        getY: () => {\r\n            return source.getScaleY();\r\n        }\r\n    });\r\n};\r\n/**\r\n * Enum representing the coordinate plane for the position 2D vector in the [[TransformComponent]]\r\n */\r\nvar CoordPlane;\r\n(function (CoordPlane) {\r\n    /**\r\n     * The world coordinate plane (default) represents world space, any entities drawn with world\r\n     * space move when the camera moves.\r\n     */\r\n    CoordPlane[\"World\"] = \"world\";\r\n    /**\r\n     * The screen coordinate plane represents screen space, entities drawn in screen space are pinned\r\n     * to screen coordinates ignoring the camera.\r\n     */\r\n    CoordPlane[\"Screen\"] = \"screen\";\r\n})(CoordPlane || (CoordPlane = {}));\r\nclass TransformComponent extends Component {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.type = 'ex.transform';\r\n        this._dirty = false;\r\n        this.matrix = Matrix.identity().translate(0, 0).rotate(0).scale(1, 1);\r\n        this._position = createPosView(this.matrix);\r\n        this._rotation = 0;\r\n        this._scale = createScaleView(this.matrix);\r\n        /**\r\n         * The [[CoordPlane|coordinate plane|]] for this transform for the entity.\r\n         */\r\n        this.coordPlane = CoordPlane.World;\r\n        /**\r\n         * The z-index ordering of the entity, a higher values are drawn on top of lower values.\r\n         * For example z=99 would be drawn on top of z=0.\r\n         */\r\n        this.z = 0;\r\n    }\r\n    _recalculate() {\r\n        this._rotation = this.matrix.getRotation();\r\n        this._dirty = false;\r\n    }\r\n    getGlobalMatrix() {\r\n        if (!this.parent) {\r\n            return this.matrix;\r\n        }\r\n        else {\r\n            return this.parent.getGlobalMatrix().multm(this.matrix);\r\n        }\r\n    }\r\n    getGlobalTransform() {\r\n        return {\r\n            pos: this.globalPos,\r\n            scale: this.globalScale,\r\n            rotation: this.globalRotation,\r\n            z: this.z,\r\n            coordPlane: this.coordPlane\r\n        };\r\n    }\r\n    get parent() {\r\n        var _a, _b;\r\n        return (_b = (_a = this === null || this === void 0 ? void 0 : this.owner) === null || _a === void 0 ? void 0 : _a.parent) === null || _b === void 0 ? void 0 : _b.get(TransformComponent);\r\n    }\r\n    /**\r\n     * The current position of the entity in world space or in screen space depending on the the [[CoordPlane|coordinate plane]].\r\n     *\r\n     * If a parent entity exists coordinates are local to the parent.\r\n     */\r\n    get pos() {\r\n        if (this._dirty) {\r\n            this._recalculate();\r\n        }\r\n        return this._position;\r\n    }\r\n    set pos(val) {\r\n        this.matrix.setPosition(val.x, val.y);\r\n        this._dirty = true;\r\n    }\r\n    // Dirty flag check up the chain\r\n    get dirty() {\r\n        var _a;\r\n        if ((_a = this === null || this === void 0 ? void 0 : this.owner) === null || _a === void 0 ? void 0 : _a.parent) {\r\n            const parent = this.parent;\r\n            return parent.dirty || this._dirty;\r\n        }\r\n        return this._dirty;\r\n    }\r\n    /**\r\n     * The current world position calculated\r\n     */\r\n    get globalPos() {\r\n        const source = this.getGlobalMatrix();\r\n        return new VectorView({\r\n            getX: () => source.data[MatrixLocations.X],\r\n            getY: () => source.data[MatrixLocations.Y],\r\n            setX: (x) => {\r\n                var _a;\r\n                if (this.parent) {\r\n                    const [newX] = (_a = this.parent) === null || _a === void 0 ? void 0 : _a.getGlobalMatrix().getAffineInverse().multv([x, source.data[MatrixLocations.Y]]);\r\n                    this.matrix.data[MatrixLocations.X] = newX;\r\n                }\r\n                else {\r\n                    this.matrix.data[MatrixLocations.X] = x;\r\n                }\r\n            },\r\n            setY: (y) => {\r\n                var _a;\r\n                if (this.parent) {\r\n                    const [, newY] = (_a = this.parent) === null || _a === void 0 ? void 0 : _a.getGlobalMatrix().getAffineInverse().multv([source.data[MatrixLocations.X], y]);\r\n                    this.matrix.data[MatrixLocations.Y] = newY;\r\n                }\r\n                else {\r\n                    this.matrix.data[MatrixLocations.Y] = y;\r\n                }\r\n            }\r\n        });\r\n    }\r\n    set globalPos(val) {\r\n        const parentTransform = this.parent;\r\n        if (!parentTransform) {\r\n            this.pos = val;\r\n        }\r\n        else {\r\n            this.pos = parentTransform.getGlobalMatrix().getAffineInverse().multv(val);\r\n        }\r\n    }\r\n    /**\r\n     * The rotation of the entity in radians. For example `Math.PI` radians is the same as 180 degrees.\r\n     */\r\n    get rotation() {\r\n        if (this._dirty) {\r\n            this._recalculate();\r\n        }\r\n        return this._rotation;\r\n    }\r\n    set rotation(val) {\r\n        this.matrix.setRotation(val);\r\n        this._dirty = true;\r\n    }\r\n    get globalRotation() {\r\n        return this.getGlobalMatrix().getRotation();\r\n    }\r\n    set globalRotation(val) {\r\n        const parentTransform = this.parent;\r\n        if (!parentTransform) {\r\n            this.rotation = val;\r\n        }\r\n        else {\r\n            this.rotation = val - parentTransform.globalRotation;\r\n        }\r\n    }\r\n    /**\r\n     * The scale of the entity.\r\n     */\r\n    get scale() {\r\n        if (this._dirty) {\r\n            this._recalculate();\r\n        }\r\n        return this._scale;\r\n    }\r\n    set scale(val) {\r\n        this.matrix.setScale(val);\r\n        this._dirty = true;\r\n    }\r\n    get globalScale() {\r\n        const source = this.getGlobalMatrix();\r\n        return new VectorView({\r\n            getX: () => source.getScaleX(),\r\n            getY: () => source.getScaleY(),\r\n            setX: (x) => {\r\n                if (this.parent) {\r\n                    const globalScaleX = this.parent.globalScale.x;\r\n                    this.matrix.setScaleX(x / globalScaleX);\r\n                }\r\n                else {\r\n                    this.matrix.setScaleX(x);\r\n                }\r\n            },\r\n            setY: (y) => {\r\n                if (this.parent) {\r\n                    const globalScaleY = this.parent.globalScale.y;\r\n                    this.matrix.setScaleY(y / globalScaleY);\r\n                }\r\n                else {\r\n                    this.matrix.setScaleY(y);\r\n                }\r\n            }\r\n        });\r\n    }\r\n    set globalScale(val) {\r\n        const parentTransform = this.parent;\r\n        if (!parentTransform) {\r\n            this.scale = val;\r\n        }\r\n        else {\r\n            this.scale = vec(val.x / parentTransform.globalScale.x, val.y / parentTransform.globalScale.y);\r\n        }\r\n    }\r\n    /**\r\n     * Apply the transform to a point\r\n     * @param point\r\n     */\r\n    apply(point) {\r\n        return this.matrix.multv(point);\r\n    }\r\n    /**\r\n     * Apply the inverse transform to a point\r\n     * @param point\r\n     */\r\n    applyInverse(point) {\r\n        return this.matrix.getAffineInverse().multv(point);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/Components/MotionComponent.ts\n\r\n\r\nclass MotionComponent extends Component {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.type = 'ex.motion';\r\n        /**\r\n         * The velocity of an entity in pixels per second\r\n         */\r\n        this.vel = Vector.Zero;\r\n        /**\r\n         * The acceleration of entity in pixels per second^2\r\n         */\r\n        this.acc = Vector.Zero;\r\n        /**\r\n         * The scale rate of change in scale units per second\r\n         */\r\n        this.scaleFactor = Vector.Zero;\r\n        /**\r\n         * The angular velocity which is how quickly the entity is rotating in radians per second\r\n         */\r\n        this.angularVelocity = 0;\r\n        /**\r\n         * The amount of torque applied to the entity, angular acceleration is torque * inertia\r\n         */\r\n        this.torque = 0;\r\n        /**\r\n         * Inerita can be thought of as the resistance to motion\r\n         */\r\n        this.inertia = 1;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Group/CollisionGroup.ts\n/**\r\n * CollisionGroups indicate like members that do not collide with each other. Use [[CollisionGroupManager]] to create [[CollisionGroup]]s\r\n *\r\n * For example:\r\n *\r\n * Players have collision group \"player\"\r\n *\r\n * ![Player Collision Group](/assets/images/docs/CollisionGroupsPlayer.png)\r\n *\r\n * Enemies have collision group \"enemy\"\r\n *\r\n * ![Enemy Collision Group](/assets/images/docs/CollisionGroupsEnemy.png)\r\n *\r\n * Blocks have collision group \"ground\"\r\n *\r\n * ![Ground collision group](/assets/images/docs/CollisionGroupsGround.png)\r\n *\r\n * Players don't collide with each other, but enemies and blocks. Likewise, enemies don't collide with each other but collide\r\n * with players and blocks.\r\n *\r\n * This is done with bitmasking, see the following pseudo-code\r\n *\r\n * PlayerGroup = `0b001`\r\n * PlayerGroupMask = `0b110`\r\n *\r\n * EnemyGroup = `0b010`\r\n * EnemyGroupMask = `0b101`\r\n *\r\n * BlockGroup = `0b100`\r\n * BlockGroupMask = `0b011`\r\n *\r\n * Should Players collide? No because the bitwise mask evaluates to 0\r\n * `(player1.group & player2.mask) === 0`\r\n * `(0b001 & 0b110) === 0`\r\n *\r\n * Should Players and Enemies collide? Yes because the bitwise mask is non-zero\r\n * `(player1.group & enemy1.mask) === 1`\r\n * `(0b001 & 0b101) === 1`\r\n *\r\n * Should Players and Blocks collide? Yes because the bitwise mask is non-zero\r\n * `(player1.group & blocks1.mask) === 1`\r\n * `(0b001 & 0b011) === 1`\r\n */\r\nclass CollisionGroup {\r\n    /**\r\n     * STOP!!** It is preferred that [[CollisionGroupManager.create]] is used to create collision groups\r\n     *  unless you know how to construct the proper bitmasks. See https://github.com/excaliburjs/Excalibur/issues/1091 for more info.\r\n     * @param name Name of the collision group\r\n     * @param category 32 bit category for the group, should be a unique power of 2. For example `0b001` or `0b010`\r\n     * @param mask 32 bit mask of category, or `~category` generally. For a category of `0b001`, the mask would be `0b110`\r\n     */\r\n    constructor(name, category, mask) {\r\n        this._name = name;\r\n        this._category = category;\r\n        this._mask = mask;\r\n    }\r\n    /**\r\n     * Get the name of the collision group\r\n     */\r\n    get name() {\r\n        return this._name;\r\n    }\r\n    /**\r\n     * Get the category of the collision group, a 32 bit number which should be a unique power of 2\r\n     */\r\n    get category() {\r\n        return this._category;\r\n    }\r\n    /**\r\n     * Get the mask for this collision group\r\n     */\r\n    get mask() {\r\n        return this._mask;\r\n    }\r\n    /**\r\n     * Evaluates whether 2 collision groups can collide\r\n     * @param other  CollisionGroup\r\n     */\r\n    canCollide(other) {\r\n        return (this.category & other.mask) !== 0 && (other.category & this.mask) !== 0;\r\n    }\r\n    /**\r\n     * Inverts the collision group. For example, if before the group specified \"players\",\r\n     * inverting would specify all groups except players\r\n     * @returns CollisionGroup\r\n     */\r\n    invert() {\r\n        return new CollisionGroup('~(' + this.name + ')', ~this.category, ~this.mask);\r\n    }\r\n    /**\r\n     * Combine collision groups with each other. The new group includes all of the previous groups.\r\n     *\r\n     * @param collisionGroups\r\n     * @returns\r\n     */\r\n    static combine(collisionGroups) {\r\n        const combinedName = collisionGroups.map((c) => c.name).join('+');\r\n        const combinedCategory = collisionGroups.reduce((current, g) => g.category | current, 0b0);\r\n        const combinedMask = ~combinedCategory;\r\n        return new CollisionGroup(combinedName, combinedCategory, combinedMask);\r\n    }\r\n    /**\r\n     * Creates a collision group that collides with the listed groups\r\n     * @param collisionGroups\r\n     */\r\n    static collidesWith(collisionGroups) {\r\n        return CollisionGroup.combine(collisionGroups).invert();\r\n    }\r\n}\r\n/**\r\n * The `All` [[CollisionGroup]] is a special group that collides with all other groups including itself,\r\n * it is the default collision group on colliders.\r\n */\r\nCollisionGroup.All = new CollisionGroup('Collide with all groups', -1, -1);\r\n\n;// CONCATENATED MODULE: ./Util/Observable.ts\n/**\r\n * Simple Observable implemenation\r\n * @template T is the typescript Type that defines the data being observed\r\n */\r\nclass Observable {\r\n    constructor() {\r\n        this.observers = [];\r\n        this.subscriptions = [];\r\n    }\r\n    /**\r\n     * Register an observer to listen to this observable\r\n     * @param observer\r\n     */\r\n    register(observer) {\r\n        this.observers.push(observer);\r\n    }\r\n    /**\r\n     * Register a callback to listen to this observable\r\n     * @param func\r\n     */\r\n    subscribe(func) {\r\n        this.subscriptions.push(func);\r\n    }\r\n    /**\r\n     * Remove an observer from the observable\r\n     * @param observer\r\n     */\r\n    unregister(observer) {\r\n        const i = this.observers.indexOf(observer);\r\n        if (i !== -1) {\r\n            this.observers.splice(i, 1);\r\n        }\r\n    }\r\n    /**\r\n     * Remove a callback that is listening to this observable\r\n     * @param func\r\n     */\r\n    unsubscribe(func) {\r\n        const i = this.subscriptions.indexOf(func);\r\n        if (i !== -1) {\r\n            this.subscriptions.splice(i, 1);\r\n        }\r\n    }\r\n    /**\r\n     * Broadcasts a message to all observers and callbacks\r\n     * @param message\r\n     */\r\n    notifyAll(message) {\r\n        this.observers.forEach((o) => o.notify(message));\r\n        this.subscriptions.forEach(cb => cb(message));\r\n    }\r\n    /**\r\n     * Removes all observers and callbacks\r\n     */\r\n    clear() {\r\n        this.observers.length = 0;\r\n        this.subscriptions.length = 0;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Detection/Pair.ts\n\r\n\r\n/**\r\n * Models a potential collision between 2 colliders\r\n */\r\nclass Pair {\r\n    constructor(colliderA, colliderB) {\r\n        this.colliderA = colliderA;\r\n        this.colliderB = colliderB;\r\n        this.id = null;\r\n        this.id = Pair.calculatePairHash(colliderA.id, colliderB.id);\r\n    }\r\n    static canCollide(colliderA, colliderB) {\r\n        var _a, _b;\r\n        const bodyA = (_a = colliderA === null || colliderA === void 0 ? void 0 : colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n        const bodyB = (_b = colliderB === null || colliderB === void 0 ? void 0 : colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n        // Body's needed for collision in the current state\r\n        // TODO can we collide without a body?\r\n        if (!bodyA || !bodyB) {\r\n            return false;\r\n        }\r\n        // If both are in the same collision group short circuit\r\n        if (!bodyA.group.canCollide(bodyB.group)) {\r\n            return false;\r\n        }\r\n        // if both are fixed short circuit\r\n        if (bodyA.collisionType === CollisionType.Fixed && bodyB.collisionType === CollisionType.Fixed) {\r\n            return false;\r\n        }\r\n        // if the either is prevent collision short circuit\r\n        if (bodyB.collisionType === CollisionType.PreventCollision || bodyA.collisionType === CollisionType.PreventCollision) {\r\n            return false;\r\n        }\r\n        // if either is dead short circuit\r\n        if (!bodyA.active || !bodyB.active) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    /**\r\n     * Returns whether or not it is possible for the pairs to collide\r\n     */\r\n    get canCollide() {\r\n        const colliderA = this.colliderA;\r\n        const colliderB = this.colliderB;\r\n        return Pair.canCollide(colliderA, colliderB);\r\n    }\r\n    /**\r\n     * Runs the collision intersection logic on the members of this pair\r\n     */\r\n    collide() {\r\n        return this.colliderA.collide(this.colliderB);\r\n    }\r\n    /**\r\n     * Check if the collider is part of the pair\r\n     * @param collider\r\n     * @returns\r\n     */\r\n    hasCollider(collider) {\r\n        return collider === this.colliderA || collider === this.colliderB;\r\n    }\r\n    /**\r\n     * Calculates the unique pair hash id for this collision pair (owning id)\r\n     */\r\n    static calculatePairHash(idA, idB) {\r\n        if (idA.value < idB.value) {\r\n            return `#${idA.value}+${idB.value}`;\r\n        }\r\n        else {\r\n            return `#${idB.value}+${idA.value}`;\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/projection.ts\n/**\r\n * A 1 dimensional projection on an axis, used to test overlaps\r\n */\r\nclass Projection {\r\n    constructor(min, max) {\r\n        this.min = min;\r\n        this.max = max;\r\n    }\r\n    overlaps(projection) {\r\n        return this.max > projection.min && projection.max > this.min;\r\n    }\r\n    getOverlap(projection) {\r\n        if (this.overlaps(projection)) {\r\n            if (this.max > projection.max) {\r\n                return projection.max - this.min;\r\n            }\r\n            else {\r\n                return this.max - projection.min;\r\n            }\r\n        }\r\n        return 0;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Detection/DynamicTree.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Dynamic Tree Node used for tracking bounds within the tree\r\n */\r\nclass TreeNode {\r\n    constructor(parent) {\r\n        this.parent = parent;\r\n        this.parent = parent || null;\r\n        this.data = null;\r\n        this.bounds = new BoundingBox();\r\n        this.left = null;\r\n        this.right = null;\r\n        this.height = 0;\r\n    }\r\n    isLeaf() {\r\n        return !this.left && !this.right;\r\n    }\r\n}\r\n/**\r\n * The DynamicTrees provides a spatial partitioning data structure for quickly querying for overlapping bounding boxes for\r\n * all tracked bodies. The worst case performance of this is O(n*log(n)) where n is the number of bodies in the tree.\r\n *\r\n * Internally the bounding boxes are organized as a balanced binary tree of bounding boxes, where the leaf nodes are tracked bodies.\r\n * Every non-leaf node is a bounding box that contains child bounding boxes.\r\n */\r\nclass DynamicTree {\r\n    constructor(worldBounds = new BoundingBox(-Number.MAX_VALUE, -Number.MAX_VALUE, Number.MAX_VALUE, Number.MAX_VALUE)) {\r\n        this.worldBounds = worldBounds;\r\n        this.root = null;\r\n        this.nodes = {};\r\n    }\r\n    /**\r\n     * Inserts a node into the dynamic tree\r\n     */\r\n    _insert(leaf) {\r\n        // If there are no nodes in the tree, make this the root leaf\r\n        if (this.root === null) {\r\n            this.root = leaf;\r\n            this.root.parent = null;\r\n            return;\r\n        }\r\n        // Search the tree for a node that is not a leaf and find the best place to insert\r\n        const leafAABB = leaf.bounds;\r\n        let currentRoot = this.root;\r\n        while (!currentRoot.isLeaf()) {\r\n            const left = currentRoot.left;\r\n            const right = currentRoot.right;\r\n            const area = currentRoot.bounds.getPerimeter();\r\n            const combinedAABB = currentRoot.bounds.combine(leafAABB);\r\n            const combinedArea = combinedAABB.getPerimeter();\r\n            // Calculate cost heuristic for creating a new parent and leaf\r\n            const cost = 2 * combinedArea;\r\n            // Minimum cost of pushing the leaf down the tree\r\n            const inheritanceCost = 2 * (combinedArea - area);\r\n            // Cost of descending\r\n            let leftCost = 0;\r\n            const leftCombined = leafAABB.combine(left.bounds);\r\n            let newArea;\r\n            let oldArea;\r\n            if (left.isLeaf()) {\r\n                leftCost = leftCombined.getPerimeter() + inheritanceCost;\r\n            }\r\n            else {\r\n                oldArea = left.bounds.getPerimeter();\r\n                newArea = leftCombined.getPerimeter();\r\n                leftCost = newArea - oldArea + inheritanceCost;\r\n            }\r\n            let rightCost = 0;\r\n            const rightCombined = leafAABB.combine(right.bounds);\r\n            if (right.isLeaf()) {\r\n                rightCost = rightCombined.getPerimeter() + inheritanceCost;\r\n            }\r\n            else {\r\n                oldArea = right.bounds.getPerimeter();\r\n                newArea = rightCombined.getPerimeter();\r\n                rightCost = newArea - oldArea + inheritanceCost;\r\n            }\r\n            // cost is acceptable\r\n            if (cost < leftCost && cost < rightCost) {\r\n                break;\r\n            }\r\n            // Descend to the depths\r\n            if (leftCost < rightCost) {\r\n                currentRoot = left;\r\n            }\r\n            else {\r\n                currentRoot = right;\r\n            }\r\n        }\r\n        // Create the new parent node and insert into the tree\r\n        const oldParent = currentRoot.parent;\r\n        const newParent = new TreeNode(oldParent);\r\n        newParent.bounds = leafAABB.combine(currentRoot.bounds);\r\n        newParent.height = currentRoot.height + 1;\r\n        if (oldParent !== null) {\r\n            // The sibling node was not the root\r\n            if (oldParent.left === currentRoot) {\r\n                oldParent.left = newParent;\r\n            }\r\n            else {\r\n                oldParent.right = newParent;\r\n            }\r\n            newParent.left = currentRoot;\r\n            newParent.right = leaf;\r\n            currentRoot.parent = newParent;\r\n            leaf.parent = newParent;\r\n        }\r\n        else {\r\n            // The sibling node was the root\r\n            newParent.left = currentRoot;\r\n            newParent.right = leaf;\r\n            currentRoot.parent = newParent;\r\n            leaf.parent = newParent;\r\n            this.root = newParent;\r\n        }\r\n        // Walk up the tree fixing heights and AABBs\r\n        let currentNode = leaf.parent;\r\n        while (currentNode) {\r\n            currentNode = this._balance(currentNode);\r\n            if (!currentNode.left) {\r\n                throw new Error('Parent of current leaf cannot have a null left child' + currentNode);\r\n            }\r\n            if (!currentNode.right) {\r\n                throw new Error('Parent of current leaf cannot have a null right child' + currentNode);\r\n            }\r\n            currentNode.height = 1 + Math.max(currentNode.left.height, currentNode.right.height);\r\n            currentNode.bounds = currentNode.left.bounds.combine(currentNode.right.bounds);\r\n            currentNode = currentNode.parent;\r\n        }\r\n    }\r\n    /**\r\n     * Removes a node from the dynamic tree\r\n     */\r\n    _remove(leaf) {\r\n        if (leaf === this.root) {\r\n            this.root = null;\r\n            return;\r\n        }\r\n        const parent = leaf.parent;\r\n        const grandParent = parent.parent;\r\n        let sibling;\r\n        if (parent.left === leaf) {\r\n            sibling = parent.right;\r\n        }\r\n        else {\r\n            sibling = parent.left;\r\n        }\r\n        if (grandParent) {\r\n            if (grandParent.left === parent) {\r\n                grandParent.left = sibling;\r\n            }\r\n            else {\r\n                grandParent.right = sibling;\r\n            }\r\n            sibling.parent = grandParent;\r\n            let currentNode = grandParent;\r\n            while (currentNode) {\r\n                currentNode = this._balance(currentNode);\r\n                currentNode.bounds = currentNode.left.bounds.combine(currentNode.right.bounds);\r\n                currentNode.height = 1 + Math.max(currentNode.left.height, currentNode.right.height);\r\n                currentNode = currentNode.parent;\r\n            }\r\n        }\r\n        else {\r\n            this.root = sibling;\r\n            sibling.parent = null;\r\n        }\r\n    }\r\n    /**\r\n     * Tracks a body in the dynamic tree\r\n     */\r\n    trackCollider(collider) {\r\n        const node = new TreeNode();\r\n        node.data = collider;\r\n        node.bounds = collider.bounds;\r\n        node.bounds.left -= 2;\r\n        node.bounds.top -= 2;\r\n        node.bounds.right += 2;\r\n        node.bounds.bottom += 2;\r\n        this.nodes[collider.id.value] = node;\r\n        this._insert(node);\r\n    }\r\n    /**\r\n     * Updates the dynamic tree given the current bounds of each body being tracked\r\n     */\r\n    updateCollider(collider) {\r\n        var _a;\r\n        const node = this.nodes[collider.id.value];\r\n        if (!node) {\r\n            return false;\r\n        }\r\n        const b = collider.bounds;\r\n        // if the body is outside the world no longer update it\r\n        if (!this.worldBounds.contains(b)) {\r\n            Logger.getInstance().warn('Collider with id ' + collider.id.value + ' is outside the world bounds and will no longer be tracked for physics');\r\n            this.untrackCollider(collider);\r\n            return false;\r\n        }\r\n        if (node.bounds.contains(b)) {\r\n            return false;\r\n        }\r\n        this._remove(node);\r\n        b.left -= Physics.boundsPadding;\r\n        b.top -= Physics.boundsPadding;\r\n        b.right += Physics.boundsPadding;\r\n        b.bottom += Physics.boundsPadding;\r\n        // THIS IS CAUSING UNECESSARY CHECKS\r\n        if (collider.owner) {\r\n            const body = (_a = collider.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n            if (body) {\r\n                const multdx = ((body.vel.x * 32) / 1000) * Physics.dynamicTreeVelocityMultiplier;\r\n                const multdy = ((body.vel.y * 32) / 1000) * Physics.dynamicTreeVelocityMultiplier;\r\n                if (multdx < 0) {\r\n                    b.left += multdx;\r\n                }\r\n                else {\r\n                    b.right += multdx;\r\n                }\r\n                if (multdy < 0) {\r\n                    b.top += multdy;\r\n                }\r\n                else {\r\n                    b.bottom += multdy;\r\n                }\r\n            }\r\n        }\r\n        node.bounds = b;\r\n        this._insert(node);\r\n        return true;\r\n    }\r\n    /**\r\n     * Untracks a body from the dynamic tree\r\n     */\r\n    untrackCollider(collider) {\r\n        const node = this.nodes[collider.id.value];\r\n        if (!node) {\r\n            return;\r\n        }\r\n        this._remove(node);\r\n        this.nodes[collider.id.value] = null;\r\n        delete this.nodes[collider.id.value];\r\n    }\r\n    /**\r\n     * Balances the tree about a node\r\n     */\r\n    _balance(node) {\r\n        if (node === null) {\r\n            throw new Error('Cannot balance at null node');\r\n        }\r\n        if (node.isLeaf() || node.height < 2) {\r\n            return node;\r\n        }\r\n        const left = node.left;\r\n        const right = node.right;\r\n        const a = node;\r\n        const b = left;\r\n        const c = right;\r\n        const d = left.left;\r\n        const e = left.right;\r\n        const f = right.left;\r\n        const g = right.right;\r\n        const balance = c.height - b.height;\r\n        // Rotate c node up\r\n        if (balance > 1) {\r\n            // Swap the right node with it's parent\r\n            c.left = a;\r\n            c.parent = a.parent;\r\n            a.parent = c;\r\n            // The original node's old parent should point to the right node\r\n            // this is mega confusing\r\n            if (c.parent) {\r\n                if (c.parent.left === a) {\r\n                    c.parent.left = c;\r\n                }\r\n                else {\r\n                    c.parent.right = c;\r\n                }\r\n            }\r\n            else {\r\n                this.root = c;\r\n            }\r\n            // Rotate\r\n            if (f.height > g.height) {\r\n                c.right = f;\r\n                a.right = g;\r\n                g.parent = a;\r\n                a.bounds = b.bounds.combine(g.bounds);\r\n                c.bounds = a.bounds.combine(f.bounds);\r\n                a.height = 1 + Math.max(b.height, g.height);\r\n                c.height = 1 + Math.max(a.height, f.height);\r\n            }\r\n            else {\r\n                c.right = g;\r\n                a.right = f;\r\n                f.parent = a;\r\n                a.bounds = b.bounds.combine(f.bounds);\r\n                c.bounds = a.bounds.combine(g.bounds);\r\n                a.height = 1 + Math.max(b.height, f.height);\r\n                c.height = 1 + Math.max(a.height, g.height);\r\n            }\r\n            return c;\r\n        }\r\n        // Rotate left node up\r\n        if (balance < -1) {\r\n            // swap\r\n            b.left = a;\r\n            b.parent = a.parent;\r\n            a.parent = b;\r\n            // node's old parent should point to b\r\n            if (b.parent) {\r\n                if (b.parent.left === a) {\r\n                    b.parent.left = b;\r\n                }\r\n                else {\r\n                    if (b.parent.right !== a) {\r\n                        throw 'Error rotating Dynamic Tree';\r\n                    }\r\n                    b.parent.right = b;\r\n                }\r\n            }\r\n            else {\r\n                this.root = b;\r\n            }\r\n            // rotate\r\n            if (d.height > e.height) {\r\n                b.right = d;\r\n                a.left = e;\r\n                e.parent = a;\r\n                a.bounds = c.bounds.combine(e.bounds);\r\n                b.bounds = a.bounds.combine(d.bounds);\r\n                a.height = 1 + Math.max(c.height, e.height);\r\n                b.height = 1 + Math.max(a.height, d.height);\r\n            }\r\n            else {\r\n                b.right = e;\r\n                a.left = d;\r\n                d.parent = a;\r\n                a.bounds = c.bounds.combine(d.bounds);\r\n                b.bounds = a.bounds.combine(e.bounds);\r\n                a.height = 1 + Math.max(c.height, d.height);\r\n                b.height = 1 + Math.max(a.height, e.height);\r\n            }\r\n            return b;\r\n        }\r\n        return node;\r\n    }\r\n    /**\r\n     * Returns the internal height of the tree, shorter trees are better. Performance drops as the tree grows\r\n     */\r\n    getHeight() {\r\n        if (this.root === null) {\r\n            return 0;\r\n        }\r\n        return this.root.height;\r\n    }\r\n    /**\r\n     * Queries the Dynamic Axis Aligned Tree for bodies that could be colliding with the provided body.\r\n     *\r\n     * In the query callback, it will be passed a potential collider. Returning true from this callback indicates\r\n     * that you are complete with your query and you do not want to continue. Returning false will continue searching\r\n     * the tree until all possible colliders have been returned.\r\n     */\r\n    query(collider, callback) {\r\n        const bounds = collider.bounds;\r\n        const helper = (currentNode) => {\r\n            if (currentNode && currentNode.bounds.intersect(bounds)) {\r\n                if (currentNode.isLeaf() && currentNode.data !== collider) {\r\n                    if (callback.call(collider, currentNode.data)) {\r\n                        return true;\r\n                    }\r\n                }\r\n                else {\r\n                    return helper(currentNode.left) || helper(currentNode.right);\r\n                }\r\n            }\r\n            return false;\r\n        };\r\n        helper(this.root);\r\n    }\r\n    /**\r\n     * Queries the Dynamic Axis Aligned Tree for bodies that could be intersecting. By default the raycast query uses an infinitely\r\n     * long ray to test the tree specified by `max`.\r\n     *\r\n     * In the query callback, it will be passed a potential body that intersects with the raycast. Returning true from this\r\n     * callback indicates that your are complete with your query and do not want to continue. Return false will continue searching\r\n     * the tree until all possible bodies that would intersect with the ray have been returned.\r\n     */\r\n    rayCastQuery(ray, max = Infinity, callback) {\r\n        const helper = (currentNode) => {\r\n            if (currentNode && currentNode.bounds.rayCast(ray, max)) {\r\n                if (currentNode.isLeaf()) {\r\n                    if (callback.call(ray, currentNode.data)) {\r\n                        // ray hit a leaf! return the body\r\n                        return true;\r\n                    }\r\n                }\r\n                else {\r\n                    // ray hit but not at a leaf, recurse deeper\r\n                    return helper(currentNode.left) || helper(currentNode.right);\r\n                }\r\n            }\r\n            return false; // ray missed\r\n        };\r\n        helper(this.root);\r\n    }\r\n    getNodes() {\r\n        const helper = (currentNode) => {\r\n            if (currentNode) {\r\n                return [currentNode].concat(helper(currentNode.left), helper(currentNode.right));\r\n            }\r\n            else {\r\n                return [];\r\n            }\r\n        };\r\n        return helper(this.root);\r\n    }\r\n    debug(ex) {\r\n        // draw all the nodes in the Dynamic Tree\r\n        const helper = (currentNode) => {\r\n            if (currentNode) {\r\n                if (currentNode.isLeaf()) {\r\n                    currentNode.bounds.draw(ex, Color.Green);\r\n                }\r\n                else {\r\n                    currentNode.bounds.draw(ex, Color.White);\r\n                }\r\n                if (currentNode.left) {\r\n                    helper(currentNode.left);\r\n                }\r\n                if (currentNode.right) {\r\n                    helper(currentNode.right);\r\n                }\r\n            }\r\n        };\r\n        helper(this.root);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/ray.ts\n/**\r\n * A 2D ray that can be cast into the scene to do collision detection\r\n */\r\nclass Ray {\r\n    /**\r\n     * @param pos The starting position for the ray\r\n     * @param dir The vector indicating the direction of the ray\r\n     */\r\n    constructor(pos, dir) {\r\n        this.pos = pos;\r\n        this.dir = dir.normalize();\r\n    }\r\n    /**\r\n     * Tests a whether this ray intersects with a line segment. Returns a number greater than or equal to 0 on success.\r\n     * This number indicates the mathematical intersection time.\r\n     * @param line  The line to test\r\n     */\r\n    intersect(line) {\r\n        const numerator = line.begin.sub(this.pos);\r\n        // Test is line and ray are parallel and non intersecting\r\n        if (this.dir.cross(line.getSlope()) === 0 && numerator.cross(this.dir) !== 0) {\r\n            return -1;\r\n        }\r\n        // Lines are parallel\r\n        const divisor = this.dir.cross(line.getSlope());\r\n        if (divisor === 0) {\r\n            return -1;\r\n        }\r\n        const t = numerator.cross(line.getSlope()) / divisor;\r\n        if (t >= 0) {\r\n            const u = numerator.cross(this.dir) / divisor / line.getLength();\r\n            if (u >= 0 && u <= 1) {\r\n                return t;\r\n            }\r\n        }\r\n        return -1;\r\n    }\r\n    intersectPoint(line) {\r\n        const time = this.intersect(line);\r\n        if (time < 0) {\r\n            return null;\r\n        }\r\n        return this.getPoint(time);\r\n    }\r\n    /**\r\n     * Returns the point of intersection given the intersection time\r\n     */\r\n    getPoint(time) {\r\n        return this.pos.add(this.dir.scale(time));\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Detection/DynamicTreeCollisionProcessor.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Responsible for performing the collision broadphase (locating potential colllisions) and\r\n * the narrowphase (actual collision contacts)\r\n */\r\nclass DynamicTreeCollisionProcessor {\r\n    constructor() {\r\n        this._dynamicCollisionTree = new DynamicTree();\r\n        this._collisions = new Set();\r\n        this._collisionPairCache = [];\r\n        this._colliders = [];\r\n    }\r\n    getColliders() {\r\n        return this._colliders;\r\n    }\r\n    /**\r\n     * Tracks a physics body for collisions\r\n     */\r\n    track(target) {\r\n        if (!target) {\r\n            Logger.getInstance().warn('Cannot track null collider');\r\n            return;\r\n        }\r\n        if (target instanceof CompositeCollider) {\r\n            const colliders = target.getColliders();\r\n            for (const c of colliders) {\r\n                c.owner = target.owner;\r\n                this._colliders.push(c);\r\n                this._dynamicCollisionTree.trackCollider(c);\r\n            }\r\n        }\r\n        else {\r\n            this._colliders.push(target);\r\n            this._dynamicCollisionTree.trackCollider(target);\r\n        }\r\n    }\r\n    /**\r\n     * Untracks a physics body\r\n     */\r\n    untrack(target) {\r\n        if (!target) {\r\n            Logger.getInstance().warn('Cannot untrack a null collider');\r\n            return;\r\n        }\r\n        if (target instanceof CompositeCollider) {\r\n            const colliders = target.getColliders();\r\n            for (const c of colliders) {\r\n                const index = this._colliders.indexOf(c);\r\n                if (index !== -1) {\r\n                    this._colliders.splice(index, 1);\r\n                }\r\n                this._dynamicCollisionTree.untrackCollider(c);\r\n            }\r\n        }\r\n        else {\r\n            const index = this._colliders.indexOf(target);\r\n            if (index !== -1) {\r\n                this._colliders.splice(index, 1);\r\n            }\r\n            this._dynamicCollisionTree.untrackCollider(target);\r\n        }\r\n    }\r\n    _shouldGenerateCollisionPair(colliderA, colliderB) {\r\n        // if the collision pair must be 2 separate colliders\r\n        // Also separate owners for composite colliders\r\n        if ((colliderA.id !== null &&\r\n            colliderB.id !== null &&\r\n            colliderA.id === colliderB.id) ||\r\n            (colliderA.owner !== null &&\r\n                colliderB.owner !== null &&\r\n                colliderA.owner === colliderB.owner)) {\r\n            return false;\r\n        }\r\n        // if the collision pair has been calculated already short circuit\r\n        const hash = Pair.calculatePairHash(colliderA.id, colliderB.id);\r\n        if (this._collisions.has(hash)) {\r\n            return false; // pair exists easy exit return false\r\n        }\r\n        // if the pair has a member with zero dimension\r\n        if (colliderA.localBounds.hasZeroDimensions() || colliderB.localBounds.hasZeroDimensions()) {\r\n            return false;\r\n        }\r\n        return Pair.canCollide(colliderA, colliderB);\r\n    }\r\n    /**\r\n     * Detects potential collision pairs in a broadphase approach with the dynamic aabb tree strategy\r\n     */\r\n    broadphase(targets, delta, stats) {\r\n        const seconds = delta / 1000;\r\n        // Retrieve the list of potential colliders, exclude killed, prevented, and self\r\n        const potentialColliders = targets.filter((other) => {\r\n            var _a, _b;\r\n            const body = (_a = other.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n            return ((_b = other.owner) === null || _b === void 0 ? void 0 : _b.active) && body.collisionType !== CollisionType.PreventCollision;\r\n        });\r\n        // clear old list of collision pairs\r\n        this._collisionPairCache = [];\r\n        this._collisions.clear();\r\n        // check for normal collision pairs\r\n        let collider;\r\n        for (let j = 0, l = potentialColliders.length; j < l; j++) {\r\n            collider = potentialColliders[j];\r\n            // Query the collision tree for potential colliders\r\n            this._dynamicCollisionTree.query(collider, (other) => {\r\n                if (this._shouldGenerateCollisionPair(collider, other)) {\r\n                    const pair = new Pair(collider, other);\r\n                    this._collisions.add(pair.id);\r\n                    this._collisionPairCache.push(pair);\r\n                }\r\n                // Always return false, to query whole tree. Returning true in the query method stops searching\r\n                return false;\r\n            });\r\n        }\r\n        if (stats) {\r\n            stats.physics.pairs = this._collisionPairCache.length;\r\n        }\r\n        // Check dynamic tree for fast moving objects\r\n        // Fast moving objects are those moving at least there smallest bound per frame\r\n        if (Physics.checkForFastBodies) {\r\n            for (const collider of potentialColliders) {\r\n                const body = collider.owner.get(BodyComponent);\r\n                // Skip non-active objects. Does not make sense on other collision types\r\n                if (body.collisionType !== CollisionType.Active) {\r\n                    continue;\r\n                }\r\n                // Maximum travel distance next frame\r\n                const updateDistance = body.vel.size * seconds + // velocity term\r\n                    body.acc.size * 0.5 * seconds * seconds; // acc term\r\n                // Find the minimum dimension\r\n                const minDimension = Math.min(collider.bounds.height, collider.bounds.width);\r\n                if (Physics.disableMinimumSpeedForFastBody || updateDistance > minDimension / 2) {\r\n                    if (stats) {\r\n                        stats.physics.fastBodies++;\r\n                    }\r\n                    // start with the oldPos because the integration for actors has already happened\r\n                    // objects resting on a surface may be slightly penetrating in the current position\r\n                    const updateVec = body.pos.sub(body.oldPos);\r\n                    const centerPoint = collider.center;\r\n                    const furthestPoint = collider.getFurthestPoint(body.vel);\r\n                    const origin = furthestPoint.sub(updateVec);\r\n                    const ray = new Ray(origin, body.vel);\r\n                    // back the ray up by -2x surfaceEpsilon to account for fast moving objects starting on the surface\r\n                    ray.pos = ray.pos.add(ray.dir.scale(-2 * Physics.surfaceEpsilon));\r\n                    let minCollider;\r\n                    let minTranslate = new Vector(Infinity, Infinity);\r\n                    this._dynamicCollisionTree.rayCastQuery(ray, updateDistance + Physics.surfaceEpsilon * 2, (other) => {\r\n                        if (collider !== other && Pair.canCollide(collider, other)) {\r\n                            const hitPoint = other.rayCast(ray, updateDistance + Physics.surfaceEpsilon * 10);\r\n                            if (hitPoint) {\r\n                                const translate = hitPoint.sub(origin);\r\n                                if (translate.size < minTranslate.size) {\r\n                                    minTranslate = translate;\r\n                                    minCollider = other;\r\n                                }\r\n                            }\r\n                        }\r\n                        return false;\r\n                    });\r\n                    if (minCollider && Vector.isValid(minTranslate)) {\r\n                        const pair = new Pair(collider, minCollider);\r\n                        if (!this._collisions.has(pair.id)) {\r\n                            this._collisions.add(pair.id);\r\n                            this._collisionPairCache.push(pair);\r\n                        }\r\n                        // move the fast moving object to the other body\r\n                        // need to push into the surface by ex.Physics.surfaceEpsilon\r\n                        const shift = centerPoint.sub(furthestPoint);\r\n                        body.pos = origin\r\n                            .add(shift)\r\n                            .add(minTranslate)\r\n                            .add(ray.dir.scale(10 * Physics.surfaceEpsilon)); // needed to push the shape slightly into contact\r\n                        collider.update(body.transform);\r\n                        if (stats) {\r\n                            stats.physics.fastBodyCollisions++;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        // return cache\r\n        return this._collisionPairCache;\r\n    }\r\n    /**\r\n     * Applies narrow phase on collision pairs to find actual area intersections\r\n     * Adds actual colliding pairs to stats' Frame data\r\n     */\r\n    narrowphase(pairs, stats) {\r\n        let contacts = [];\r\n        for (let i = 0; i < pairs.length; i++) {\r\n            const newContacts = pairs[i].collide();\r\n            contacts = contacts.concat(newContacts);\r\n            if (stats && newContacts.length > 0) {\r\n                for (const c of newContacts) {\r\n                    stats.physics.contacts.set(c.id, c);\r\n                }\r\n            }\r\n        }\r\n        if (stats) {\r\n            stats.physics.collisions += contacts.length;\r\n        }\r\n        return contacts;\r\n    }\r\n    /**\r\n     * Update the dynamic tree positions\r\n     */\r\n    update(targets) {\r\n        let updated = 0;\r\n        const len = targets.length;\r\n        for (let i = 0; i < len; i++) {\r\n            if (this._dynamicCollisionTree.updateCollider(targets[i])) {\r\n                updated++;\r\n            }\r\n        }\r\n        return updated;\r\n    }\r\n    debug(ex) {\r\n        this._dynamicCollisionTree.debug(ex);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/Collider.ts\n\r\n\r\n/**\r\n * A collision collider specifies the geometry that can detect when other collision colliders intersect\r\n * for the purposes of colliding 2 objects in excalibur.\r\n */\r\nclass Collider {\r\n    constructor() {\r\n        this.id = createId('collider', Collider._ID++);\r\n        this.events = new EventDispatcher(this);\r\n    }\r\n    /**\r\n     * Returns a boolean indicating whether this body collided with\r\n     * or was in stationary contact with\r\n     * the body of the other [[Collider]]\r\n     */\r\n    touching(other) {\r\n        const contact = this.collide(other);\r\n        if (contact) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n}\r\nCollider._ID = 0;\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/CompositeCollider.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass CompositeCollider extends Collider {\r\n    constructor(colliders) {\r\n        super();\r\n        this._collisionProcessor = new DynamicTreeCollisionProcessor();\r\n        this._dynamicAABBTree = new DynamicTree();\r\n        this._colliders = [];\r\n        for (const c of colliders) {\r\n            this.addCollider(c);\r\n        }\r\n    }\r\n    clearColliders() {\r\n        this._colliders = [];\r\n    }\r\n    addCollider(collider) {\r\n        this.events.wire(collider.events);\r\n        this._colliders.push(collider);\r\n        this._collisionProcessor.track(collider);\r\n        this._dynamicAABBTree.trackCollider(collider);\r\n    }\r\n    removeCollider(collider) {\r\n        this.events.unwire(collider.events);\r\n        removeItemFromArray(collider, this._colliders);\r\n        this._collisionProcessor.untrack(collider);\r\n        this._dynamicAABBTree.untrackCollider(collider);\r\n    }\r\n    getColliders() {\r\n        return this._colliders;\r\n    }\r\n    get worldPos() {\r\n        var _a, _b;\r\n        // TODO transform component world pos\r\n        return (_b = (_a = this._transform) === null || _a === void 0 ? void 0 : _a.pos) !== null && _b !== void 0 ? _b : Vector.Zero;\r\n    }\r\n    get center() {\r\n        var _a, _b;\r\n        return (_b = (_a = this._transform) === null || _a === void 0 ? void 0 : _a.pos) !== null && _b !== void 0 ? _b : Vector.Zero;\r\n    }\r\n    get bounds() {\r\n        var _a, _b;\r\n        // TODO cache this\r\n        const colliders = this.getColliders();\r\n        const results = colliders.reduce((acc, collider) => acc.combine(collider.bounds), (_b = (_a = colliders[0]) === null || _a === void 0 ? void 0 : _a.bounds) !== null && _b !== void 0 ? _b : new BoundingBox().translate(this.worldPos));\r\n        return results;\r\n    }\r\n    get localBounds() {\r\n        var _a, _b;\r\n        // TODO cache this\r\n        const colliders = this.getColliders();\r\n        const results = colliders.reduce((acc, collider) => acc.combine(collider.localBounds), (_b = (_a = colliders[0]) === null || _a === void 0 ? void 0 : _a.localBounds) !== null && _b !== void 0 ? _b : new BoundingBox());\r\n        return results;\r\n    }\r\n    get axes() {\r\n        // TODO cache this\r\n        const colliders = this.getColliders();\r\n        let axes = [];\r\n        for (const collider of colliders) {\r\n            axes = axes.concat(collider.axes);\r\n        }\r\n        return axes;\r\n    }\r\n    getFurthestPoint(direction) {\r\n        const colliders = this.getColliders();\r\n        const furthestPoints = [];\r\n        for (const collider of colliders) {\r\n            furthestPoints.push(collider.getFurthestPoint(direction));\r\n        }\r\n        // Pick best point from all colliders\r\n        let bestPoint = furthestPoints[0];\r\n        let maxDistance = -Number.MAX_VALUE;\r\n        for (const point of furthestPoints) {\r\n            const distance = point.dot(direction);\r\n            if (distance > maxDistance) {\r\n                bestPoint = point;\r\n                maxDistance = distance;\r\n            }\r\n        }\r\n        return bestPoint;\r\n    }\r\n    getInertia(mass) {\r\n        const colliders = this.getColliders();\r\n        let totalInertia = 0;\r\n        for (const collider of colliders) {\r\n            totalInertia += collider.getInertia(mass);\r\n        }\r\n        return totalInertia;\r\n    }\r\n    collide(other) {\r\n        let otherColliders = [other];\r\n        if (other instanceof CompositeCollider) {\r\n            otherColliders = other.getColliders();\r\n        }\r\n        const pairs = [];\r\n        for (const c of otherColliders) {\r\n            this._dynamicAABBTree.query(c, (potentialCollider) => {\r\n                pairs.push(new Pair(c, potentialCollider));\r\n                return false;\r\n            });\r\n        }\r\n        let contacts = [];\r\n        for (const p of pairs) {\r\n            contacts = contacts.concat(p.collide());\r\n        }\r\n        return contacts;\r\n    }\r\n    getClosestLineBetween(other) {\r\n        const colliders = this.getColliders();\r\n        const lines = [];\r\n        if (other instanceof CompositeCollider) {\r\n            const otherColliders = other.getColliders();\r\n            for (const colliderA of colliders) {\r\n                for (const colliderB of otherColliders) {\r\n                    const maybeLine = colliderA.getClosestLineBetween(colliderB);\r\n                    if (maybeLine) {\r\n                        lines.push(maybeLine);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            for (const collider of colliders) {\r\n                const maybeLine = other.getClosestLineBetween(collider);\r\n                if (maybeLine) {\r\n                    lines.push(maybeLine);\r\n                }\r\n            }\r\n        }\r\n        if (lines.length) {\r\n            let minLength = lines[0].getLength();\r\n            let minLine = lines[0];\r\n            for (const line of lines) {\r\n                const length = line.getLength();\r\n                if (length < minLength) {\r\n                    minLength = length;\r\n                    minLine = line;\r\n                }\r\n            }\r\n            return minLine;\r\n        }\r\n        return null;\r\n    }\r\n    contains(point) {\r\n        const colliders = this.getColliders();\r\n        for (const collider of colliders) {\r\n            if (collider.contains(point)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    rayCast(ray, max) {\r\n        const colliders = this.getColliders();\r\n        const points = [];\r\n        for (const collider of colliders) {\r\n            const vec = collider.rayCast(ray, max);\r\n            if (vec) {\r\n                points.push(vec);\r\n            }\r\n        }\r\n        if (points.length) {\r\n            let minPoint = points[0];\r\n            let minDistance = minPoint.dot(ray.dir);\r\n            for (const point of points) {\r\n                const distance = ray.dir.dot(point);\r\n                if (distance < minDistance) {\r\n                    minPoint = point;\r\n                    minDistance = distance;\r\n                }\r\n            }\r\n            return minPoint;\r\n        }\r\n        return null;\r\n    }\r\n    project(axis) {\r\n        const colliders = this.getColliders();\r\n        const projs = [];\r\n        for (const collider of colliders) {\r\n            const proj = collider.project(axis);\r\n            if (proj) {\r\n                projs.push(proj);\r\n            }\r\n        }\r\n        // Merge all proj's on the same axis\r\n        if (projs.length) {\r\n            const newProjection = new Projection(projs[0].min, projs[0].max);\r\n            for (const proj of projs) {\r\n                newProjection.min = Math.min(proj.min, newProjection.min);\r\n                newProjection.max = Math.max(proj.max, newProjection.max);\r\n            }\r\n            return newProjection;\r\n        }\r\n        return null;\r\n    }\r\n    update(transform) {\r\n        if (transform) {\r\n            const colliders = this.getColliders();\r\n            for (const collider of colliders) {\r\n                collider.owner = this.owner;\r\n                collider.update(transform);\r\n            }\r\n        }\r\n    }\r\n    draw(ctx, color, pos) {\r\n        const colliders = this.getColliders();\r\n        for (const collider of colliders) {\r\n            collider.draw(ctx, color, pos);\r\n        }\r\n    }\r\n    debug(ex, color) {\r\n        const colliders = this.getColliders();\r\n        for (const collider of colliders) {\r\n            collider.debug(ex, color);\r\n        }\r\n    }\r\n    debugDraw(ctx, color) {\r\n        const colliders = this.getColliders();\r\n        for (const collider of colliders) {\r\n            collider.draw(ctx, color);\r\n        }\r\n    }\r\n    clone() {\r\n        return new CompositeCollider(this._colliders.map((c) => c.clone()));\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/line.ts\n\r\n/**\r\n * A 2D line segment\r\n */\r\nclass Line {\r\n    /**\r\n     * @param begin  The starting point of the line segment\r\n     * @param end  The ending point of the line segment\r\n     */\r\n    constructor(begin, end) {\r\n        this.begin = begin;\r\n        this.end = end;\r\n    }\r\n    /**\r\n     * Gets the raw slope (m) of the line. Will return (+/-)Infinity for vertical lines.\r\n     */\r\n    get slope() {\r\n        return (this.end.y - this.begin.y) / (this.end.x - this.begin.x);\r\n    }\r\n    /**\r\n     * Gets the Y-intercept (b) of the line. Will return (+/-)Infinity if there is no intercept.\r\n     */\r\n    get intercept() {\r\n        return this.begin.y - this.slope * this.begin.x;\r\n    }\r\n    /**\r\n     * Gets the normal of the line\r\n     */\r\n    normal() {\r\n        return this.end.sub(this.begin).normal();\r\n    }\r\n    dir() {\r\n        return this.end.sub(this.begin);\r\n    }\r\n    getPoints() {\r\n        return [this.begin, this.end];\r\n    }\r\n    /**\r\n     * Returns the slope of the line in the form of a vector of length 1\r\n     */\r\n    getSlope() {\r\n        const begin = this.begin;\r\n        const end = this.end;\r\n        const distance = begin.distance(end);\r\n        return end.sub(begin).scale(1 / distance);\r\n    }\r\n    /**\r\n     * Returns the edge of the line as vector, the length of the vector is the length of the edge\r\n     */\r\n    getEdge() {\r\n        const begin = this.begin;\r\n        const end = this.end;\r\n        return end.sub(begin);\r\n    }\r\n    /**\r\n     * Returns the length of the line segment in pixels\r\n     */\r\n    getLength() {\r\n        const begin = this.begin;\r\n        const end = this.end;\r\n        const distance = begin.distance(end);\r\n        return distance;\r\n    }\r\n    /**\r\n     * Returns the midpoint of the edge\r\n     */\r\n    get midpoint() {\r\n        return this.begin.add(this.end).scale(0.5);\r\n    }\r\n    /**\r\n     * Flips the direction of the line segment\r\n     */\r\n    flip() {\r\n        return new Line(this.end, this.begin);\r\n    }\r\n    /**\r\n     * Tests if a given point is below the line, points in the normal direction above the line are considered above.\r\n     * @param point\r\n     */\r\n    below(point) {\r\n        const above2 = (this.end.x - this.begin.x) * (point.y - this.begin.y) - (this.end.y - this.begin.y) * (point.x - this.begin.x);\r\n        return above2 >= 0;\r\n    }\r\n    /**\r\n     * Returns the clip point\r\n     * @param sideVector Vector that traces the line\r\n     * @param length Length to clip along side\r\n     */\r\n    clip(sideVector, length) {\r\n        let dir = sideVector;\r\n        dir = dir.normalize();\r\n        const near = dir.dot(this.begin) - length;\r\n        const far = dir.dot(this.end) - length;\r\n        const results = [];\r\n        if (near <= 0) {\r\n            results.push(this.begin);\r\n        }\r\n        if (far <= 0) {\r\n            results.push(this.end);\r\n        }\r\n        if (near * far < 0) {\r\n            const clipTime = near / (near - far);\r\n            results.push(this.begin.add(this.end.sub(this.begin).scale(clipTime)));\r\n        }\r\n        if (results.length !== 2) {\r\n            return null;\r\n        }\r\n        return new Line(results[0], results[1]);\r\n    }\r\n    /**\r\n     * Find the perpendicular distance from the line to a point\r\n     * https://en.wikipedia.org/wiki/Distance_from_a_point_to_a_line\r\n     * @param point\r\n     */\r\n    distanceToPoint(point, signed = false) {\r\n        const x0 = point.x;\r\n        const y0 = point.y;\r\n        const l = this.getLength();\r\n        const dy = this.end.y - this.begin.y;\r\n        const dx = this.end.x - this.begin.x;\r\n        const distance = (dy * x0 - dx * y0 + this.end.x * this.begin.y - this.end.y * this.begin.x) / l;\r\n        return signed ? distance : Math.abs(distance);\r\n    }\r\n    /**\r\n     * Find the perpendicular line from the line to a point\r\n     * https://en.wikipedia.org/wiki/Distance_from_a_point_to_a_line\r\n     * (a - p) - ((a - p) * n)n\r\n     * a is a point on the line\r\n     * p is the arbitrary point above the line\r\n     * n is a unit vector in direction of the line\r\n     * @param point\r\n     */\r\n    findVectorToPoint(point) {\r\n        const aMinusP = this.begin.sub(point);\r\n        const n = this.getSlope();\r\n        return aMinusP.sub(n.scale(aMinusP.dot(n)));\r\n    }\r\n    /**\r\n     * Finds a point on the line given only an X or a Y value. Given an X value, the function returns\r\n     * a new point with the calculated Y value and vice-versa.\r\n     *\r\n     * @param x The known X value of the target point\r\n     * @param y The known Y value of the target point\r\n     * @returns A new point with the other calculated axis value\r\n     */\r\n    findPoint(x = null, y = null) {\r\n        const m = this.slope;\r\n        const b = this.intercept;\r\n        if (x !== null) {\r\n            return new Vector(x, m * x + b);\r\n        }\r\n        else if (y !== null) {\r\n            return new Vector((y - b) / m, y);\r\n        }\r\n        else {\r\n            throw new Error('You must provide an X or a Y value');\r\n        }\r\n    }\r\n    /**\r\n     * @see http://stackoverflow.com/a/11908158/109458\r\n     */\r\n    hasPoint() {\r\n        let currPoint;\r\n        let threshold = 0;\r\n        if (typeof arguments[0] === 'number' && typeof arguments[1] === 'number') {\r\n            currPoint = new Vector(arguments[0], arguments[1]);\r\n            threshold = arguments[2] || 0;\r\n        }\r\n        else if (arguments[0] instanceof Vector) {\r\n            currPoint = arguments[0];\r\n            threshold = arguments[1] || 0;\r\n        }\r\n        else {\r\n            throw 'Could not determine the arguments for Vector.hasPoint';\r\n        }\r\n        const dxc = currPoint.x - this.begin.x;\r\n        const dyc = currPoint.y - this.begin.y;\r\n        const dx1 = this.end.x - this.begin.x;\r\n        const dy1 = this.end.y - this.begin.y;\r\n        const cross = dxc * dy1 - dyc * dx1;\r\n        // check whether point lines on the line\r\n        if (Math.abs(cross) > threshold) {\r\n            return false;\r\n        }\r\n        // check whether point lies in-between start and end\r\n        if (Math.abs(dx1) >= Math.abs(dy1)) {\r\n            return dx1 > 0 ? this.begin.x <= currPoint.x && currPoint.x <= this.end.x : this.end.x <= currPoint.x && currPoint.x <= this.begin.x;\r\n        }\r\n        else {\r\n            return dy1 > 0 ? this.begin.y <= currPoint.y && currPoint.y <= this.end.y : this.end.y <= currPoint.y && currPoint.y <= this.begin.y;\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/ClosestLineJumpTable.ts\n\r\n\r\n\r\n/**\r\n * Finds the closes line between 2 line segments, were the magnitude of u, v are the lengths of each segment\r\n * L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\r\n * L2 = Q(t) = q0 + t * v, where t is time and q0 is the start of the line\r\n * @param p0 Point where L1 begins\r\n * @param u Direction and length of L1\r\n * @param q0 Point were L2 begins\r\n * @param v Direction and length of L2\r\n */\r\nfunction ClosestLine(p0, u, q0, v) {\r\n    // Distance between 2 lines http://geomalgorithms.com/a07-_distance.html\r\n    // w(s, t) = P(s) - Q(t)\r\n    // The w(s, t) that has the minimum distance we will say is w(sClosest, tClosest) = wClosest\r\n    //\r\n    // wClosest is the vector that is uniquely perpendicular to the 2 line directions u & v.\r\n    // wClosest = w0 + sClosest * u - tClosest * v, where w0 is p0 - q0\r\n    //\r\n    // The closest point between 2 lines then satisfies this pair of equations\r\n    // 1: u * wClosest = 0\r\n    // 2: v * wClosest = 0\r\n    //\r\n    // Substituting wClosest into the equations we get\r\n    //\r\n    // 1: (u * u) * sClosest - (u * v) tClosest = -u * w0\r\n    // 2: (v * u) * sClosest - (v * v) tClosest = -v * w0\r\n    // simplify w0\r\n    const w0 = p0.sub(q0);\r\n    // simplify (u * u);\r\n    const a = u.dot(u);\r\n    // simplify (u * v);\r\n    const b = u.dot(v);\r\n    // simplify (v * v)\r\n    const c = v.dot(v);\r\n    // simplify (u * w0)\r\n    const d = u.dot(w0);\r\n    // simplify (v * w0)\r\n    const e = v.dot(w0);\r\n    // denominator ac - b^2\r\n    const denom = a * c - b * b;\r\n    let sDenom = denom;\r\n    let tDenom = denom;\r\n    // if denom is 0 they are parallel, use any point from either as the start in this case p0\r\n    if (denom === 0 || denom <= 0.01) {\r\n        const tClosestParallel = d / b;\r\n        return new Line(p0, q0.add(v.scale(tClosestParallel)));\r\n    }\r\n    // Solve for sClosest for infinite line\r\n    let sClosest = b * e - c * d; // / denom;\r\n    // Solve for tClosest for infinite line\r\n    let tClosest = a * e - b * d; // / denom;\r\n    // Solve for segments candidate edges, if sClosest and tClosest are outside their segments\r\n    if (sClosest < 0) {\r\n        sClosest = 0;\r\n        tClosest = e;\r\n        tDenom = c;\r\n    }\r\n    else if (sClosest > sDenom) {\r\n        sClosest = sDenom;\r\n        tClosest = e + b;\r\n        tDenom = c;\r\n    }\r\n    if (tClosest < 0) {\r\n        tClosest = 0;\r\n        if (-d < 0) {\r\n            sClosest = 0;\r\n        }\r\n        else if (-d > a) {\r\n            sClosest = sDenom;\r\n        }\r\n        else {\r\n            sClosest = -d;\r\n            sDenom = a;\r\n        }\r\n    }\r\n    else if (tClosest > tDenom) {\r\n        tClosest = tDenom;\r\n        if (-d + b < 0) {\r\n            sClosest = 0;\r\n        }\r\n        else if (-d + b > a) {\r\n            sClosest = sDenom;\r\n        }\r\n        else {\r\n            sClosest = -d + b;\r\n            sDenom = a;\r\n        }\r\n    }\r\n    sClosest = Math.abs(sClosest) < 0.001 ? 0 : sClosest / sDenom;\r\n    tClosest = Math.abs(tClosest) < 0.001 ? 0 : tClosest / tDenom;\r\n    return new Line(p0.add(u.scale(sClosest)), q0.add(v.scale(tClosest)));\r\n}\r\nconst ClosestLineJumpTable = {\r\n    PolygonPolygonClosestLine(polygonA, polygonB) {\r\n        // Find the 2 closest faces on each polygon\r\n        const otherWorldPos = polygonB.worldPos;\r\n        const otherDirection = otherWorldPos.sub(polygonA.worldPos);\r\n        const thisDirection = otherDirection.negate();\r\n        const rayTowardsOther = new Ray(polygonA.worldPos, otherDirection);\r\n        const rayTowardsThis = new Ray(otherWorldPos, thisDirection);\r\n        const thisPoint = polygonA.rayCast(rayTowardsOther).add(rayTowardsOther.dir.scale(0.1));\r\n        const otherPoint = polygonB.rayCast(rayTowardsThis).add(rayTowardsThis.dir.scale(0.1));\r\n        const thisFace = polygonA.getClosestFace(thisPoint);\r\n        const otherFace = polygonB.getClosestFace(otherPoint);\r\n        // L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\r\n        const p0 = thisFace.face.begin;\r\n        const u = thisFace.face.getEdge();\r\n        // L2 = Q(t) = q0 + t * v, where t is time and q0 is the start of the line\r\n        const q0 = otherFace.face.begin;\r\n        const v = otherFace.face.getEdge();\r\n        return ClosestLine(p0, u, q0, v);\r\n    },\r\n    PolygonEdgeClosestLine(polygon, edge) {\r\n        // Find the 2 closest faces on each polygon\r\n        const otherWorldPos = edge.worldPos;\r\n        const otherDirection = otherWorldPos.sub(polygon.worldPos);\r\n        const rayTowardsOther = new Ray(polygon.worldPos, otherDirection);\r\n        const thisPoint = polygon.rayCast(rayTowardsOther).add(rayTowardsOther.dir.scale(0.1));\r\n        const thisFace = polygon.getClosestFace(thisPoint);\r\n        // L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\r\n        const p0 = thisFace.face.begin;\r\n        const u = thisFace.face.getEdge();\r\n        // L2 = Q(t) = q0 + t * v, where t is time and q0 is the start of the line\r\n        const edgeLine = edge.asLine();\r\n        const edgeStart = edgeLine.begin;\r\n        const edgeVector = edgeLine.getEdge();\r\n        const q0 = edgeStart;\r\n        const v = edgeVector;\r\n        return ClosestLine(p0, u, q0, v);\r\n    },\r\n    PolygonCircleClosestLine(polygon, circle) {\r\n        // https://math.stackexchange.com/questions/1919177/how-to-find-point-on-line-closest-to-sphere\r\n        // Find the 2 closest faces on each polygon\r\n        const otherWorldPos = circle.worldPos;\r\n        const otherDirection = otherWorldPos.sub(polygon.worldPos);\r\n        const rayTowardsOther = new Ray(polygon.worldPos, otherDirection.normalize());\r\n        const thisPoint = polygon.rayCast(rayTowardsOther).add(rayTowardsOther.dir.scale(0.1));\r\n        const thisFace = polygon.getClosestFace(thisPoint);\r\n        // L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\r\n        const p0 = thisFace.face.begin;\r\n        const u = thisFace.face.getEdge();\r\n        // Time of minimum distance\r\n        let t = (u.x * (otherWorldPos.x - p0.x) + u.y * (otherWorldPos.y - p0.y)) / (u.x * u.x + u.y * u.y);\r\n        // If time of minimum is past the edge clamp\r\n        if (t > 1) {\r\n            t = 1;\r\n        }\r\n        else if (t < 0) {\r\n            t = 0;\r\n        }\r\n        // Minimum distance\r\n        const d = Math.sqrt(Math.pow(p0.x + u.x * t - otherWorldPos.x, 2) + Math.pow(p0.y + u.y * t - otherWorldPos.y, 2)) - circle.radius;\r\n        const circlex = ((p0.x + u.x * t - otherWorldPos.x) * circle.radius) / (circle.radius + d);\r\n        const circley = ((p0.y + u.y * t - otherWorldPos.y) * circle.radius) / (circle.radius + d);\r\n        return new Line(u.scale(t).add(p0), new Vector(otherWorldPos.x + circlex, otherWorldPos.y + circley));\r\n    },\r\n    CircleCircleClosestLine(circleA, circleB) {\r\n        // Find the 2 closest faces on each polygon\r\n        const otherWorldPos = circleB.worldPos;\r\n        const otherDirection = otherWorldPos.sub(circleA.worldPos);\r\n        const thisWorldPos = circleA.worldPos;\r\n        const thisDirection = thisWorldPos.sub(circleB.worldPos);\r\n        const rayTowardsOther = new Ray(circleA.worldPos, otherDirection);\r\n        const rayTowardsThis = new Ray(circleB.worldPos, thisDirection);\r\n        const thisPoint = circleA.rayCast(rayTowardsOther);\r\n        const otherPoint = circleB.rayCast(rayTowardsThis);\r\n        return new Line(thisPoint, otherPoint);\r\n    },\r\n    CircleEdgeClosestLine(circle, edge) {\r\n        // https://math.stackexchange.com/questions/1919177/how-to-find-point-on-line-closest-to-sphere\r\n        const circleWorlPos = circle.worldPos;\r\n        // L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\r\n        const edgeLine = edge.asLine();\r\n        const edgeStart = edgeLine.begin;\r\n        const edgeVector = edgeLine.getEdge();\r\n        const p0 = edgeStart;\r\n        const u = edgeVector;\r\n        // Time of minimum distance\r\n        let t = (u.x * (circleWorlPos.x - p0.x) + u.y * (circleWorlPos.y - p0.y)) / (u.x * u.x + u.y * u.y);\r\n        // If time of minimum is past the edge clamp to edge\r\n        if (t > 1) {\r\n            t = 1;\r\n        }\r\n        else if (t < 0) {\r\n            t = 0;\r\n        }\r\n        // Minimum distance\r\n        const d = Math.sqrt(Math.pow(p0.x + u.x * t - circleWorlPos.x, 2) + Math.pow(p0.y + u.y * t - circleWorlPos.y, 2)) - circle.radius;\r\n        const circlex = ((p0.x + u.x * t - circleWorlPos.x) * circle.radius) / (circle.radius + d);\r\n        const circley = ((p0.y + u.y * t - circleWorlPos.y) * circle.radius) / (circle.radius + d);\r\n        return new Line(u.scale(t).add(p0), new Vector(circleWorlPos.x + circlex, circleWorlPos.y + circley));\r\n    },\r\n    EdgeEdgeClosestLine(edgeA, edgeB) {\r\n        // L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\r\n        const edgeLineA = edgeA.asLine();\r\n        const edgeStartA = edgeLineA.begin;\r\n        const edgeVectorA = edgeLineA.getEdge();\r\n        const p0 = edgeStartA;\r\n        const u = edgeVectorA;\r\n        // L2 = Q(t) = q0 + t * v, where t is time and q0 is the start of the line\r\n        const edgeLineB = edgeB.asLine();\r\n        const edgeStartB = edgeLineB.begin;\r\n        const edgeVectorB = edgeLineB.getEdge();\r\n        const q0 = edgeStartB;\r\n        const v = edgeVectorB;\r\n        return ClosestLine(p0, u, q0, v);\r\n    }\r\n};\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/CircleCollider.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * This is a circle collider for the excalibur rigid body physics simulation\r\n */\r\nclass CircleCollider extends Collider {\r\n    constructor(options) {\r\n        super();\r\n        /**\r\n         * Position of the circle relative to the collider, by default (0, 0).\r\n         */\r\n        this.offset = Vector.Zero;\r\n        this.offset = options.offset || Vector.Zero;\r\n        this.radius = options.radius || 0;\r\n    }\r\n    get worldPos() {\r\n        var _a, _b;\r\n        return this.offset.add((_b = (_a = this._transform) === null || _a === void 0 ? void 0 : _a.pos) !== null && _b !== void 0 ? _b : Vector.Zero);\r\n    }\r\n    /**\r\n     * Returns a clone of this shape, not associated with any collider\r\n     */\r\n    clone() {\r\n        return new CircleCollider({\r\n            offset: this.offset.clone(),\r\n            radius: this.radius\r\n        });\r\n    }\r\n    /**\r\n     * Get the center of the collider in world coordinates\r\n     */\r\n    get center() {\r\n        var _a, _b;\r\n        return this.offset.add((_b = (_a = this._transform) === null || _a === void 0 ? void 0 : _a.pos) !== null && _b !== void 0 ? _b : Vector.Zero);\r\n    }\r\n    /**\r\n     * Tests if a point is contained in this collider\r\n     */\r\n    contains(point) {\r\n        var _a, _b;\r\n        const pos = (_b = (_a = this._transform) === null || _a === void 0 ? void 0 : _a.pos) !== null && _b !== void 0 ? _b : this.offset;\r\n        const distance = pos.distance(point);\r\n        if (distance <= this.radius) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    /**\r\n     * Casts a ray at the Circle collider and returns the nearest point of collision\r\n     * @param ray\r\n     */\r\n    rayCast(ray, max = Infinity) {\r\n        //https://en.wikipedia.org/wiki/Line%E2%80%93sphere_intersection\r\n        const c = this.center;\r\n        const dir = ray.dir;\r\n        const orig = ray.pos;\r\n        const discriminant = Math.sqrt(Math.pow(dir.dot(orig.sub(c)), 2) - Math.pow(orig.sub(c).distance(), 2) + Math.pow(this.radius, 2));\r\n        if (discriminant < 0) {\r\n            // no intersection\r\n            return null;\r\n        }\r\n        else {\r\n            let toi = 0;\r\n            if (discriminant === 0) {\r\n                toi = -dir.dot(orig.sub(c));\r\n                if (toi > 0 && toi < max) {\r\n                    return ray.getPoint(toi);\r\n                }\r\n                return null;\r\n            }\r\n            else {\r\n                const toi1 = -dir.dot(orig.sub(c)) + discriminant;\r\n                const toi2 = -dir.dot(orig.sub(c)) - discriminant;\r\n                const positiveToi = [];\r\n                if (toi1 >= 0) {\r\n                    positiveToi.push(toi1);\r\n                }\r\n                if (toi2 >= 0) {\r\n                    positiveToi.push(toi2);\r\n                }\r\n                const mintoi = Math.min(...positiveToi);\r\n                if (mintoi <= max) {\r\n                    return ray.getPoint(mintoi);\r\n                }\r\n                return null;\r\n            }\r\n        }\r\n    }\r\n    getClosestLineBetween(shape) {\r\n        if (shape instanceof CircleCollider) {\r\n            return ClosestLineJumpTable.CircleCircleClosestLine(this, shape);\r\n        }\r\n        else if (shape instanceof PolygonCollider) {\r\n            return ClosestLineJumpTable.PolygonCircleClosestLine(shape, this).flip();\r\n        }\r\n        else if (shape instanceof EdgeCollider) {\r\n            return ClosestLineJumpTable.CircleEdgeClosestLine(this, shape).flip();\r\n        }\r\n        else {\r\n            throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof shape}`);\r\n        }\r\n    }\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    collide(collider) {\r\n        if (collider instanceof CircleCollider) {\r\n            return CollisionJumpTable.CollideCircleCircle(this, collider);\r\n        }\r\n        else if (collider instanceof PolygonCollider) {\r\n            return CollisionJumpTable.CollideCirclePolygon(this, collider);\r\n        }\r\n        else if (collider instanceof EdgeCollider) {\r\n            return CollisionJumpTable.CollideCircleEdge(this, collider);\r\n        }\r\n        else {\r\n            throw new Error(`Circle could not collide with unknown CollisionShape ${typeof collider}`);\r\n        }\r\n    }\r\n    /**\r\n     * Find the point on the collider furthest in the direction specified\r\n     */\r\n    getFurthestPoint(direction) {\r\n        return this.center.add(direction.normalize().scale(this.radius));\r\n    }\r\n    /**\r\n     * Find the local point on the shape in the direction specified\r\n     * @param direction\r\n     */\r\n    getFurthestLocalPoint(direction) {\r\n        const dir = direction.normalize();\r\n        return dir.scale(this.radius);\r\n    }\r\n    /**\r\n     * Get the axis aligned bounding box for the circle collider in world coordinates\r\n     */\r\n    get bounds() {\r\n        var _a;\r\n        const tx = this._transform;\r\n        const bodyPos = (_a = tx === null || tx === void 0 ? void 0 : tx.globalPos) !== null && _a !== void 0 ? _a : Vector.Zero;\r\n        return new BoundingBox(this.offset.x + bodyPos.x - this.radius, this.offset.y + bodyPos.y - this.radius, this.offset.x + bodyPos.x + this.radius, this.offset.y + bodyPos.y + this.radius);\r\n    }\r\n    /**\r\n     * Get the axis aligned bounding box for the circle collider in local coordinates\r\n     */\r\n    get localBounds() {\r\n        return new BoundingBox(this.offset.x - this.radius, this.offset.y - this.radius, this.offset.x + this.radius, this.offset.y + this.radius);\r\n    }\r\n    /**\r\n     * Get axis not implemented on circles, since there are infinite axis in a circle\r\n     */\r\n    get axes() {\r\n        return [];\r\n    }\r\n    /**\r\n     * Returns the moment of inertia of a circle given it's mass\r\n     * https://en.wikipedia.org/wiki/List_of_moments_of_inertia\r\n     */\r\n    getInertia(mass) {\r\n        return (mass * this.radius * this.radius) / 2;\r\n    }\r\n    /* istanbul ignore next */\r\n    update(transform) {\r\n        this._transform = transform;\r\n    }\r\n    /**\r\n     * Project the circle along a specified axis\r\n     */\r\n    project(axis) {\r\n        const scalars = [];\r\n        const point = this.center;\r\n        const dotProduct = point.dot(axis);\r\n        scalars.push(dotProduct);\r\n        scalars.push(dotProduct + this.radius);\r\n        scalars.push(dotProduct - this.radius);\r\n        return new Projection(Math.min.apply(Math, scalars), Math.max.apply(Math, scalars));\r\n    }\r\n    draw(ctx, color = Color.Green, pos = Vector.Zero) {\r\n        const newPos = pos.add(this.offset);\r\n        ctx.beginPath();\r\n        ctx.fillStyle = color.toString();\r\n        ctx.arc(newPos.x, newPos.y, this.radius, 0, Math.PI * 2);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n    }\r\n    debug(ex, color) {\r\n        const tx = this._transform;\r\n        const pos = (tx === null || tx === void 0 ? void 0 : tx.globalPos) ? tx === null || tx === void 0 ? void 0 : tx.globalPos.add(this.offset) : this.offset;\r\n        ex.drawCircle(pos, this.radius, color);\r\n    }\r\n    /* istanbul ignore next */\r\n    debugDraw(ctx, color = Color.Green) {\r\n        const transform = this._transform;\r\n        const pos = transform ? transform.pos.add(this.offset) : this.offset;\r\n        const rotation = transform ? transform.rotation : 0;\r\n        ctx.beginPath();\r\n        ctx.strokeStyle = color.toString();\r\n        ctx.arc(pos.x, pos.y, this.radius, 0, Math.PI * 2);\r\n        ctx.closePath();\r\n        ctx.stroke();\r\n        ctx.beginPath();\r\n        ctx.moveTo(pos.x, pos.y);\r\n        ctx.lineTo(Math.cos(rotation) * this.radius + pos.x, Math.sin(rotation) * this.radius + pos.y);\r\n        ctx.closePath();\r\n        ctx.stroke();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Detection/CollisionContact.ts\n\r\n\r\n\r\n\r\n/**\r\n * Collision contacts are used internally by Excalibur to resolve collision between colliders. This\r\n * Pair prevents collisions from being evaluated more than one time\r\n */\r\nclass CollisionContact {\r\n    constructor(colliderA, colliderB, mtv, normal, tangent, points, localPoints, info) {\r\n        this._canceled = false;\r\n        this.colliderA = colliderA;\r\n        this.colliderB = colliderB;\r\n        this.mtv = mtv;\r\n        this.normal = normal;\r\n        this.tangent = tangent;\r\n        this.points = points;\r\n        this.localPoints = localPoints;\r\n        this.info = info;\r\n        this.id = Pair.calculatePairHash(colliderA.id, colliderB.id);\r\n    }\r\n    /**\r\n     * Match contact awake state, except if body's are Fixed\r\n     */\r\n    matchAwake() {\r\n        const bodyA = this.colliderA.owner.get(BodyComponent);\r\n        const bodyB = this.colliderB.owner.get(BodyComponent);\r\n        if (bodyA && bodyB) {\r\n            if (bodyA.sleeping !== bodyB.sleeping) {\r\n                if (bodyA.sleeping && bodyA.collisionType !== CollisionType.Fixed && bodyB.sleepMotion >= Physics.wakeThreshold) {\r\n                    bodyA.setSleeping(false);\r\n                }\r\n                if (bodyB.sleeping && bodyB.collisionType !== CollisionType.Fixed && bodyA.sleepMotion >= Physics.wakeThreshold) {\r\n                    bodyB.setSleeping(false);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    isCanceled() {\r\n        return this._canceled;\r\n    }\r\n    cancel() {\r\n        this._canceled = true;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/SeparatingAxis.ts\nclass SeparatingAxis {\r\n    static findPolygonPolygonSeparation(polyA, polyB) {\r\n        let bestSeparation = -Number.MAX_VALUE;\r\n        let bestSide = null;\r\n        let bestAxis = null;\r\n        let bestSideIndex = -1;\r\n        let bestOtherPoint = null;\r\n        const sides = polyA.getSides();\r\n        const localSides = polyA.getLocalSides();\r\n        for (let i = 0; i < sides.length; i++) {\r\n            const side = sides[i];\r\n            const axis = side.normal();\r\n            const vertB = polyB.getFurthestPoint(axis.negate());\r\n            // Separation on side i's axis\r\n            // We are looking for the largest separation between poly A's sides\r\n            const vertSeparation = side.distanceToPoint(vertB, true);\r\n            if (vertSeparation > bestSeparation) {\r\n                bestSeparation = vertSeparation;\r\n                bestSide = side;\r\n                bestAxis = axis;\r\n                bestSideIndex = i;\r\n                bestOtherPoint = vertB;\r\n            }\r\n        }\r\n        return {\r\n            collider: polyA,\r\n            separation: bestAxis ? bestSeparation : 99,\r\n            axis: bestAxis,\r\n            side: bestSide,\r\n            localSide: localSides[bestSideIndex],\r\n            sideId: bestSideIndex,\r\n            point: bestOtherPoint,\r\n            localPoint: bestAxis ? polyB.getFurthestLocalPoint(bestAxis.negate()) : null\r\n        };\r\n    }\r\n    static findCirclePolygonSeparation(circle, polygon) {\r\n        const axes = polygon.axes;\r\n        const pc = polygon.center;\r\n        // Special SAT with circles\r\n        const polyDir = pc.sub(circle.worldPos);\r\n        const closestPointOnPoly = polygon.getFurthestPoint(polyDir.negate());\r\n        axes.push(closestPointOnPoly.sub(circle.worldPos).normalize());\r\n        let minOverlap = Number.MAX_VALUE;\r\n        let minAxis = null;\r\n        let minIndex = -1;\r\n        for (let i = 0; i < axes.length; i++) {\r\n            const proj1 = polygon.project(axes[i]);\r\n            const proj2 = circle.project(axes[i]);\r\n            const overlap = proj1.getOverlap(proj2);\r\n            if (overlap <= 0) {\r\n                return null;\r\n            }\r\n            else {\r\n                if (overlap < minOverlap) {\r\n                    minOverlap = overlap;\r\n                    minAxis = axes[i];\r\n                    minIndex = i;\r\n                }\r\n            }\r\n        }\r\n        if (minIndex < 0) {\r\n            return null;\r\n        }\r\n        return minAxis.normalize().scale(minOverlap);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/CollisionJumpTable.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst CollisionJumpTable = {\r\n    CollideCircleCircle(circleA, circleB) {\r\n        const circleAPos = circleA.worldPos;\r\n        const circleBPos = circleB.worldPos;\r\n        const combinedRadius = circleA.radius + circleB.radius;\r\n        const distance = circleAPos.distance(circleBPos);\r\n        if (distance > combinedRadius) {\r\n            return [];\r\n        }\r\n        // negative means overlap\r\n        const separation = combinedRadius - distance;\r\n        // Normal points from A -> B\r\n        const normal = circleBPos.sub(circleAPos).normalize();\r\n        const tangent = normal.perpendicular();\r\n        const mvt = normal.scale(separation);\r\n        const point = circleA.getFurthestPoint(normal);\r\n        const local = circleA.getFurthestLocalPoint(normal);\r\n        const info = {\r\n            collider: circleA,\r\n            separation,\r\n            axis: normal,\r\n            point: point\r\n        };\r\n        return [new CollisionContact(circleA, circleB, mvt, normal, tangent, [point], [local], info)];\r\n    },\r\n    CollideCirclePolygon(circle, polygon) {\r\n        var _a, _b;\r\n        let minAxis = SeparatingAxis.findCirclePolygonSeparation(circle, polygon);\r\n        if (!minAxis) {\r\n            return [];\r\n        }\r\n        // make sure that the minAxis is pointing away from circle\r\n        const samedir = minAxis.dot(polygon.center.sub(circle.center));\r\n        minAxis = samedir < 0 ? minAxis.negate() : minAxis;\r\n        const point = circle.getFurthestPoint(minAxis);\r\n        const xf = (_b = (_a = circle.owner) === null || _a === void 0 ? void 0 : _a.get(TransformComponent)) !== null && _b !== void 0 ? _b : new TransformComponent();\r\n        const local = xf.applyInverse(point);\r\n        const normal = minAxis.normalize();\r\n        const info = {\r\n            collider: circle,\r\n            separation: -minAxis.size,\r\n            axis: normal,\r\n            point: point,\r\n            localPoint: local,\r\n            side: polygon.findSide(normal.negate()),\r\n            localSide: polygon.findLocalSide(normal.negate())\r\n        };\r\n        return [new CollisionContact(circle, polygon, minAxis, normal, normal.perpendicular(), [point], [local], info)];\r\n    },\r\n    CollideCircleEdge(circle, edge) {\r\n        // TODO not sure this actually abides by local/world collisions\r\n        // Are edge.begin and edge.end local space or world space? I think they should be local\r\n        // center of the circle in world pos\r\n        const cc = circle.center;\r\n        // vector in the direction of the edge\r\n        const edgeWorld = edge.asLine();\r\n        const e = edgeWorld.end.sub(edgeWorld.begin);\r\n        // amount of overlap with the circle's center along the edge direction\r\n        const u = e.dot(edgeWorld.end.sub(cc));\r\n        const v = e.dot(cc.sub(edgeWorld.begin));\r\n        const side = edge.asLine();\r\n        const localSide = edge.asLocalLine();\r\n        // Potential region A collision (circle is on the left side of the edge, before the beginning)\r\n        if (v <= 0) {\r\n            const da = edgeWorld.begin.sub(cc);\r\n            const dda = da.dot(da); // quick and dirty way of calc'n distance in r^2 terms saves some sqrts\r\n            // save some sqrts\r\n            if (dda > circle.radius * circle.radius) {\r\n                return []; // no collision\r\n            }\r\n            const normal = da.normalize();\r\n            const separation = circle.radius - Math.sqrt(dda);\r\n            const info = {\r\n                collider: circle,\r\n                separation: separation,\r\n                axis: normal,\r\n                point: side.begin,\r\n                side: side,\r\n                localSide: localSide\r\n            };\r\n            return [\r\n                new CollisionContact(circle, edge, normal.scale(separation), normal, normal.perpendicular(), [side.begin], [localSide.begin], info)\r\n            ];\r\n        }\r\n        // Potential region B collision (circle is on the right side of the edge, after the end)\r\n        if (u <= 0) {\r\n            const db = edgeWorld.end.sub(cc);\r\n            const ddb = db.dot(db);\r\n            if (ddb > circle.radius * circle.radius) {\r\n                return [];\r\n            }\r\n            const normal = db.normalize();\r\n            const separation = circle.radius - Math.sqrt(ddb);\r\n            const info = {\r\n                collider: circle,\r\n                separation: separation,\r\n                axis: normal,\r\n                point: side.end,\r\n                side: side,\r\n                localSide: localSide\r\n            };\r\n            return [\r\n                new CollisionContact(circle, edge, normal.scale(separation), normal, normal.perpendicular(), [side.end], [localSide.end], info)\r\n            ];\r\n        }\r\n        // Otherwise potential region AB collision (circle is in the middle of the edge between the beginning and end)\r\n        const den = e.dot(e);\r\n        const pointOnEdge = edgeWorld.begin\r\n            .scale(u)\r\n            .add(edgeWorld.end.scale(v))\r\n            .scale(1 / den);\r\n        const d = cc.sub(pointOnEdge);\r\n        const dd = d.dot(d);\r\n        if (dd > circle.radius * circle.radius) {\r\n            return []; // no collision\r\n        }\r\n        let normal = e.perpendicular();\r\n        // flip correct direction\r\n        if (normal.dot(cc.sub(edgeWorld.begin)) < 0) {\r\n            normal.x = -normal.x;\r\n            normal.y = -normal.y;\r\n        }\r\n        normal = normal.normalize();\r\n        const separation = circle.radius - Math.sqrt(dd);\r\n        const mvt = normal.scale(separation);\r\n        const info = {\r\n            collider: circle,\r\n            separation: separation,\r\n            axis: normal,\r\n            point: pointOnEdge,\r\n            side: side,\r\n            localSide: localSide\r\n        };\r\n        return [\r\n            new CollisionContact(circle, edge, mvt, normal.negate(), normal.negate().perpendicular(), [pointOnEdge], [pointOnEdge.sub(edge.worldPos)], info)\r\n        ];\r\n    },\r\n    CollideEdgeEdge() {\r\n        // Edge-edge collision doesn't make sense\r\n        return [];\r\n    },\r\n    CollidePolygonEdge(polygon, edge) {\r\n        var _a;\r\n        const pc = polygon.center;\r\n        const ec = edge.center;\r\n        const dir = ec.sub(pc).normalize();\r\n        // build a temporary polygon from the edge to use SAT\r\n        const linePoly = new PolygonCollider({\r\n            points: [edge.begin, edge.end, edge.end.add(dir.scale(100)), edge.begin.add(dir.scale(100))],\r\n            offset: edge.offset\r\n        });\r\n        linePoly.owner = edge.owner;\r\n        const tx = (_a = edge.owner) === null || _a === void 0 ? void 0 : _a.get(TransformComponent);\r\n        if (tx) {\r\n            linePoly.update(edge.owner.get(TransformComponent));\r\n        }\r\n        // Gross hack but poly-poly works well\r\n        const contact = this.CollidePolygonPolygon(polygon, linePoly);\r\n        if (contact.length) {\r\n            // Fudge the contact back to edge\r\n            contact[0].colliderB = edge;\r\n            contact[0].id = Pair.calculatePairHash(polygon.id, edge.id);\r\n            // contact[0].info.collider\r\n        }\r\n        return contact;\r\n    },\r\n    CollidePolygonPolygon(polyA, polyB) {\r\n        var _a, _b, _c, _d;\r\n        // Multi contact from SAT\r\n        // https://gamedev.stackexchange.com/questions/111390/multiple-contacts-for-sat-collision-detection\r\n        // do a SAT test to find a min axis if it exists\r\n        const separationA = SeparatingAxis.findPolygonPolygonSeparation(polyA, polyB);\r\n        // If there is no overlap from boxA's perspective we can end early\r\n        if (separationA.separation > 0) {\r\n            return [];\r\n        }\r\n        const separationB = SeparatingAxis.findPolygonPolygonSeparation(polyB, polyA);\r\n        // If there is no overlap from boxB's perspective exit now\r\n        if (separationB.separation > 0) {\r\n            return [];\r\n        }\r\n        // Separations are both negative, we want to pick the least negative (minimal movement)\r\n        const separation = separationA.separation > separationB.separation ? separationA : separationB;\r\n        // The incident side is the most opposite from the axes of collision on the other collider\r\n        const other = separation.collider === polyA ? polyB : polyA;\r\n        const incident = other.findSide(separation.axis.negate());\r\n        // Clip incident side by the perpendicular lines at each end of the reference side\r\n        // https://en.wikipedia.org/wiki/Sutherland%E2%80%93Hodgman_algorithm\r\n        const reference = separation.side;\r\n        const refDir = reference.dir().normalize();\r\n        // Find our contact points by clipping the incident by the collision side\r\n        const clipRight = incident.clip(refDir.negate(), -refDir.dot(reference.begin));\r\n        let clipLeft = null;\r\n        if (clipRight) {\r\n            clipLeft = clipRight.clip(refDir, refDir.dot(reference.end));\r\n        }\r\n        // If there is no left there is no collision\r\n        if (clipLeft) {\r\n            // We only want clip points below the reference edge, discard the others\r\n            const points = clipLeft.getPoints().filter((p) => {\r\n                return reference.below(p);\r\n            });\r\n            let normal = separation.axis;\r\n            let tangent = normal.perpendicular();\r\n            // Point Contact A -> B\r\n            if (polyB.worldPos.sub(polyA.worldPos).dot(normal) < 0) {\r\n                normal = normal.negate();\r\n                tangent = normal.perpendicular();\r\n            }\r\n            // Points are clipped from incident which is the other collider\r\n            // Store those as locals\r\n            let localPoints = [];\r\n            if (separation.collider === polyA) {\r\n                const xf = (_b = (_a = polyB.owner) === null || _a === void 0 ? void 0 : _a.get(TransformComponent)) !== null && _b !== void 0 ? _b : new TransformComponent();\r\n                localPoints = points.map((p) => xf.applyInverse(p));\r\n            }\r\n            else {\r\n                const xf = (_d = (_c = polyA.owner) === null || _c === void 0 ? void 0 : _c.get(TransformComponent)) !== null && _d !== void 0 ? _d : new TransformComponent();\r\n                localPoints = points.map((p) => xf.applyInverse(p));\r\n            }\r\n            return [new CollisionContact(polyA, polyB, normal.scale(-separation.separation), normal, tangent, points, localPoints, separation)];\r\n        }\r\n        return [];\r\n    },\r\n    FindContactSeparation(contact, localPoint) {\r\n        var _a, _b, _c, _d;\r\n        const shapeA = contact.colliderA;\r\n        const txA = (_b = (_a = contact.colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(TransformComponent)) !== null && _b !== void 0 ? _b : new TransformComponent();\r\n        const shapeB = contact.colliderB;\r\n        const txB = (_d = (_c = contact.colliderB.owner) === null || _c === void 0 ? void 0 : _c.get(TransformComponent)) !== null && _d !== void 0 ? _d : new TransformComponent();\r\n        // both are circles\r\n        if (shapeA instanceof CircleCollider && shapeB instanceof CircleCollider) {\r\n            const combinedRadius = shapeA.radius + shapeB.radius;\r\n            const distance = txA.pos.distance(txB.pos);\r\n            const separation = combinedRadius - distance;\r\n            return -separation;\r\n        }\r\n        // both are polygons\r\n        if (shapeA instanceof PolygonCollider && shapeB instanceof PolygonCollider) {\r\n            if (contact.info.localSide) {\r\n                let side;\r\n                let worldPoint;\r\n                if (contact.info.collider === shapeA) {\r\n                    side = new Line(txA.apply(contact.info.localSide.begin), txA.apply(contact.info.localSide.end));\r\n                    worldPoint = txB.apply(localPoint);\r\n                }\r\n                else {\r\n                    side = new Line(txB.apply(contact.info.localSide.begin), txB.apply(contact.info.localSide.end));\r\n                    worldPoint = txA.apply(localPoint);\r\n                }\r\n                return side.distanceToPoint(worldPoint, true);\r\n            }\r\n        }\r\n        // polygon v circle\r\n        if ((shapeA instanceof PolygonCollider && shapeB instanceof CircleCollider) ||\r\n            (shapeB instanceof PolygonCollider && shapeA instanceof CircleCollider)) {\r\n            const worldPoint = txA.apply(localPoint);\r\n            if (contact.info.side) {\r\n                return contact.info.side.distanceToPoint(worldPoint, true);\r\n            }\r\n        }\r\n        // polygon v edge\r\n        if ((shapeA instanceof EdgeCollider && shapeB instanceof PolygonCollider) ||\r\n            (shapeB instanceof EdgeCollider && shapeA instanceof PolygonCollider)) {\r\n            let worldPoint;\r\n            if (contact.info.collider === shapeA) {\r\n                worldPoint = txB.apply(localPoint);\r\n            }\r\n            else {\r\n                worldPoint = txA.apply(localPoint);\r\n            }\r\n            if (contact.info.side) {\r\n                return contact.info.side.distanceToPoint(worldPoint, true);\r\n            }\r\n        }\r\n        // circle v edge\r\n        if ((shapeA instanceof CircleCollider && shapeB instanceof EdgeCollider) ||\r\n            (shapeB instanceof CircleCollider && shapeA instanceof EdgeCollider)) {\r\n            // Local point is always on the edge which is always shapeB\r\n            const worldPoint = txB.apply(localPoint);\r\n            let circlePoint;\r\n            if (shapeA instanceof CircleCollider) {\r\n                circlePoint = shapeA.getFurthestPoint(contact.normal);\r\n            }\r\n            const dist = worldPoint.distance(circlePoint);\r\n            if (contact.info.side) {\r\n                return dist > 0 ? -dist : 0;\r\n            }\r\n        }\r\n        return 0;\r\n    }\r\n};\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/EdgeCollider.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Edge is a single line collider to create collisions with a single line.\r\n */\r\nclass EdgeCollider extends Collider {\r\n    constructor(options) {\r\n        var _a;\r\n        super();\r\n        this.begin = options.begin || Vector.Zero;\r\n        this.end = options.end || Vector.Zero;\r\n        this.offset = (_a = options.offset) !== null && _a !== void 0 ? _a : Vector.Zero;\r\n    }\r\n    /**\r\n     * Returns a clone of this Edge, not associated with any collider\r\n     */\r\n    clone() {\r\n        return new EdgeCollider({\r\n            begin: this.begin.clone(),\r\n            end: this.end.clone()\r\n        });\r\n    }\r\n    get worldPos() {\r\n        var _a;\r\n        const tx = this._transform;\r\n        return (_a = tx === null || tx === void 0 ? void 0 : tx.globalPos.add(this.offset)) !== null && _a !== void 0 ? _a : this.offset;\r\n    }\r\n    /**\r\n     * Get the center of the collision area in world coordinates\r\n     */\r\n    get center() {\r\n        const pos = this.begin.average(this.end).add(this._getBodyPos());\r\n        return pos;\r\n    }\r\n    _getBodyPos() {\r\n        var _a;\r\n        const tx = this._transform;\r\n        const bodyPos = (_a = tx === null || tx === void 0 ? void 0 : tx.globalPos) !== null && _a !== void 0 ? _a : Vector.Zero;\r\n        return bodyPos;\r\n    }\r\n    _getTransformedBegin() {\r\n        const tx = this._transform;\r\n        const angle = tx ? tx.globalRotation : 0;\r\n        return this.begin.rotate(angle).add(this._getBodyPos());\r\n    }\r\n    _getTransformedEnd() {\r\n        const tx = this._transform;\r\n        const angle = tx ? tx.globalRotation : 0;\r\n        return this.end.rotate(angle).add(this._getBodyPos());\r\n    }\r\n    /**\r\n     * Returns the slope of the line in the form of a vector\r\n     */\r\n    getSlope() {\r\n        const begin = this._getTransformedBegin();\r\n        const end = this._getTransformedEnd();\r\n        const distance = begin.distance(end);\r\n        return end.sub(begin).scale(1 / distance);\r\n    }\r\n    /**\r\n     * Returns the length of the line segment in pixels\r\n     */\r\n    getLength() {\r\n        const begin = this._getTransformedBegin();\r\n        const end = this._getTransformedEnd();\r\n        const distance = begin.distance(end);\r\n        return distance;\r\n    }\r\n    /**\r\n     * Tests if a point is contained in this collision area\r\n     */\r\n    contains() {\r\n        return false;\r\n    }\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    rayCast(ray, max = Infinity) {\r\n        const numerator = this._getTransformedBegin().sub(ray.pos);\r\n        // Test is line and ray are parallel and non intersecting\r\n        if (ray.dir.cross(this.getSlope()) === 0 && numerator.cross(ray.dir) !== 0) {\r\n            return null;\r\n        }\r\n        // Lines are parallel\r\n        const divisor = ray.dir.cross(this.getSlope());\r\n        if (divisor === 0) {\r\n            return null;\r\n        }\r\n        const t = numerator.cross(this.getSlope()) / divisor;\r\n        if (t >= 0 && t <= max) {\r\n            const u = numerator.cross(ray.dir) / divisor / this.getLength();\r\n            if (u >= 0 && u <= 1) {\r\n                return ray.getPoint(t);\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n    /**\r\n     * Returns the closes line between this and another collider, from this -> collider\r\n     * @param shape\r\n     */\r\n    getClosestLineBetween(shape) {\r\n        if (shape instanceof CircleCollider) {\r\n            return ClosestLineJumpTable.CircleEdgeClosestLine(shape, this);\r\n        }\r\n        else if (shape instanceof PolygonCollider) {\r\n            return ClosestLineJumpTable.PolygonEdgeClosestLine(shape, this).flip();\r\n        }\r\n        else if (shape instanceof EdgeCollider) {\r\n            return ClosestLineJumpTable.EdgeEdgeClosestLine(this, shape);\r\n        }\r\n        else {\r\n            throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof shape}`);\r\n        }\r\n    }\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    collide(shape) {\r\n        if (shape instanceof CircleCollider) {\r\n            return CollisionJumpTable.CollideCircleEdge(shape, this);\r\n        }\r\n        else if (shape instanceof PolygonCollider) {\r\n            return CollisionJumpTable.CollidePolygonEdge(shape, this);\r\n        }\r\n        else if (shape instanceof EdgeCollider) {\r\n            return CollisionJumpTable.CollideEdgeEdge();\r\n        }\r\n        else {\r\n            throw new Error(`Edge could not collide with unknown CollisionShape ${typeof shape}`);\r\n        }\r\n    }\r\n    /**\r\n     * Find the point on the collider furthest in the direction specified\r\n     */\r\n    getFurthestPoint(direction) {\r\n        const transformedBegin = this._getTransformedBegin();\r\n        const transformedEnd = this._getTransformedEnd();\r\n        if (direction.dot(transformedBegin) > 0) {\r\n            return transformedBegin;\r\n        }\r\n        else {\r\n            return transformedEnd;\r\n        }\r\n    }\r\n    _boundsFromBeginEnd(begin, end, padding = 10) {\r\n        // A perfectly vertical or horizontal edge would have a bounds 0 width or height\r\n        // this causes problems for the collision system so we give them some padding\r\n        return new BoundingBox(Math.min(begin.x, end.x) - padding, Math.min(begin.y, end.y) - padding, Math.max(begin.x, end.x) + padding, Math.max(begin.y, end.y) + padding);\r\n    }\r\n    /**\r\n     * Get the axis aligned bounding box for the edge collider in world space\r\n     */\r\n    get bounds() {\r\n        const transformedBegin = this._getTransformedBegin();\r\n        const transformedEnd = this._getTransformedEnd();\r\n        return this._boundsFromBeginEnd(transformedBegin, transformedEnd);\r\n    }\r\n    /**\r\n     * Get the axis aligned bounding box for the edge collider in local space\r\n     */\r\n    get localBounds() {\r\n        return this._boundsFromBeginEnd(this.begin, this.end);\r\n    }\r\n    /**\r\n     * Returns this edge represented as a line in world coordinates\r\n     */\r\n    asLine() {\r\n        return new Line(this._getTransformedBegin(), this._getTransformedEnd());\r\n    }\r\n    /**\r\n     * Return this edge as a line in local line coordinates (relative to the position)\r\n     */\r\n    asLocalLine() {\r\n        return new Line(this.begin, this.end);\r\n    }\r\n    /**\r\n     * Get the axis associated with the edge\r\n     */\r\n    get axes() {\r\n        const e = this._getTransformedEnd().sub(this._getTransformedBegin());\r\n        const edgeNormal = e.normal();\r\n        const axes = [];\r\n        axes.push(edgeNormal);\r\n        axes.push(edgeNormal.negate());\r\n        axes.push(edgeNormal.normal());\r\n        axes.push(edgeNormal.normal().negate());\r\n        return axes;\r\n    }\r\n    /**\r\n     * Get the moment of inertia for an edge\r\n     * https://en.wikipedia.org/wiki/List_of_moments_of_inertia\r\n     */\r\n    getInertia(mass) {\r\n        const length = this.end.sub(this.begin).distance() / 2;\r\n        return mass * length * length;\r\n    }\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    update(transform) {\r\n        this._transform = transform;\r\n    }\r\n    /**\r\n     * Project the edge along a specified axis\r\n     */\r\n    project(axis) {\r\n        const scalars = [];\r\n        const points = [this._getTransformedBegin(), this._getTransformedEnd()];\r\n        const len = points.length;\r\n        for (let i = 0; i < len; i++) {\r\n            scalars.push(points[i].dot(axis));\r\n        }\r\n        return new Projection(Math.min.apply(Math, scalars), Math.max.apply(Math, scalars));\r\n    }\r\n    draw(ctx, color = Color.Green, pos = Vector.Zero) {\r\n        const begin = this.begin.add(pos);\r\n        const end = this.end.add(pos);\r\n        ctx.strokeStyle = color.toString();\r\n        ctx.beginPath();\r\n        ctx.moveTo(begin.x, begin.y);\r\n        ctx.lineTo(end.x, end.y);\r\n        ctx.closePath();\r\n        ctx.stroke();\r\n    }\r\n    debug(ex, color) {\r\n        const begin = this._getTransformedBegin();\r\n        const end = this._getTransformedEnd();\r\n        ex.drawLine(begin, end, color, 2);\r\n        ex.drawCircle(begin, 2, color);\r\n        ex.drawCircle(end, 2, color);\r\n    }\r\n    /* istanbul ignore next */\r\n    debugDraw(ctx, color = Color.Red) {\r\n        const begin = this._getTransformedBegin();\r\n        const end = this._getTransformedEnd();\r\n        ctx.strokeStyle = color.toString();\r\n        ctx.beginPath();\r\n        ctx.moveTo(begin.x, begin.y);\r\n        ctx.lineTo(end.x, end.y);\r\n        ctx.closePath();\r\n        ctx.stroke();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/PolygonCollider.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Polygon collider for detecting collisions\r\n */\r\nclass PolygonCollider extends Collider {\r\n    constructor(options) {\r\n        var _a;\r\n        super();\r\n        this._transformedPoints = [];\r\n        this._axes = [];\r\n        this._sides = [];\r\n        this._localSides = [];\r\n        this.offset = (_a = options.offset) !== null && _a !== void 0 ? _a : Vector.Zero;\r\n        const winding = !!options.clockwiseWinding;\r\n        this.points = (winding ? options.points.reverse() : options.points) || [];\r\n        // calculate initial transformation\r\n        this._calculateTransformation();\r\n    }\r\n    /**\r\n     * Returns a clone of this ConvexPolygon, not associated with any collider\r\n     */\r\n    clone() {\r\n        return new PolygonCollider({\r\n            offset: this.offset.clone(),\r\n            points: this.points.map((p) => p.clone())\r\n        });\r\n    }\r\n    /**\r\n     * Returns the world position of the collider, which is the current body transform plus any defined offset\r\n     */\r\n    get worldPos() {\r\n        if (this._transform) {\r\n            return this._transform.pos.add(this.offset);\r\n        }\r\n        return this.offset;\r\n    }\r\n    /**\r\n     * Get the center of the collider in world coordinates\r\n     */\r\n    get center() {\r\n        return this.bounds.center;\r\n    }\r\n    /**\r\n     * Calculates the underlying transformation from the body relative space to world space\r\n     */\r\n    _calculateTransformation() {\r\n        const transform = this._transform;\r\n        const pos = transform ? transform.globalPos.add(this.offset) : this.offset;\r\n        const angle = transform ? transform.globalRotation : 0;\r\n        const scale = transform ? transform.globalScale : Vector.One;\r\n        const len = this.points.length;\r\n        this._transformedPoints.length = 0; // clear out old transform\r\n        for (let i = 0; i < len; i++) {\r\n            this._transformedPoints[i] = this.points[i].scale(scale).rotate(angle).add(pos);\r\n        }\r\n    }\r\n    /**\r\n     * Gets the points that make up the polygon in world space, from actor relative space (if specified)\r\n     */\r\n    getTransformedPoints() {\r\n        this._calculateTransformation();\r\n        return this._transformedPoints;\r\n    }\r\n    /**\r\n     * Gets the sides of the polygon in world space\r\n     */\r\n    getSides() {\r\n        if (this._sides.length) {\r\n            return this._sides;\r\n        }\r\n        const lines = [];\r\n        const points = this.getTransformedPoints();\r\n        const len = points.length;\r\n        for (let i = 0; i < len; i++) {\r\n            // This winding is important\r\n            lines.push(new Line(points[i], points[(i + 1) % len]));\r\n        }\r\n        this._sides = lines;\r\n        return this._sides;\r\n    }\r\n    /**\r\n     * Returns the local coordinate space sides\r\n     */\r\n    getLocalSides() {\r\n        if (this._localSides.length) {\r\n            return this._localSides;\r\n        }\r\n        const lines = [];\r\n        const points = this.points;\r\n        const len = points.length;\r\n        for (let i = 0; i < len; i++) {\r\n            // This winding is important\r\n            lines.push(new Line(points[i], points[(i + 1) % len]));\r\n        }\r\n        this._localSides = lines;\r\n        return this._localSides;\r\n    }\r\n    /**\r\n     * Given a direction vector find the world space side that is most in that direction\r\n     * @param direction\r\n     */\r\n    findSide(direction) {\r\n        const sides = this.getSides();\r\n        let bestSide = sides[0];\r\n        let maxDistance = -Number.MAX_VALUE;\r\n        for (let side = 0; side < sides.length; side++) {\r\n            const currentSide = sides[side];\r\n            const sideNormal = currentSide.normal();\r\n            const mostDirection = sideNormal.dot(direction);\r\n            if (mostDirection > maxDistance) {\r\n                bestSide = currentSide;\r\n                maxDistance = mostDirection;\r\n            }\r\n        }\r\n        return bestSide;\r\n    }\r\n    /**\r\n     * Given a direction vector find the local space side that is most in that direction\r\n     * @param direction\r\n     */\r\n    findLocalSide(direction) {\r\n        const sides = this.getLocalSides();\r\n        let bestSide = sides[0];\r\n        let maxDistance = -Number.MAX_VALUE;\r\n        for (let side = 0; side < sides.length; side++) {\r\n            const currentSide = sides[side];\r\n            const sideNormal = currentSide.normal();\r\n            const mostDirection = sideNormal.dot(direction);\r\n            if (mostDirection > maxDistance) {\r\n                bestSide = currentSide;\r\n                maxDistance = mostDirection;\r\n            }\r\n        }\r\n        return bestSide;\r\n    }\r\n    /**\r\n     * Get the axis associated with the convex polygon\r\n     */\r\n    get axes() {\r\n        if (this._axes.length) {\r\n            return this._axes;\r\n        }\r\n        const axes = this.getSides().map((s) => s.normal());\r\n        this._axes = axes;\r\n        return this._axes;\r\n    }\r\n    update(transform) {\r\n        this._transform = transform;\r\n        this._sides.length = 0;\r\n        this._localSides.length = 0;\r\n        this._axes.length = 0;\r\n        this._transformedPoints.length = 0;\r\n        this.getTransformedPoints();\r\n        this.getSides();\r\n        this.getLocalSides();\r\n    }\r\n    /**\r\n     * Tests if a point is contained in this collider in world space\r\n     */\r\n    contains(point) {\r\n        // Always cast to the right, as long as we cast in a consistent fixed direction we\r\n        // will be fine\r\n        const testRay = new Ray(point, new Vector(1, 0));\r\n        const intersectCount = this.getSides().reduce(function (accum, side) {\r\n            if (testRay.intersect(side) >= 0) {\r\n                return accum + 1;\r\n            }\r\n            return accum;\r\n        }, 0);\r\n        if (intersectCount % 2 === 0) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    getClosestLineBetween(collider) {\r\n        if (collider instanceof CircleCollider) {\r\n            return ClosestLineJumpTable.PolygonCircleClosestLine(this, collider);\r\n        }\r\n        else if (collider instanceof PolygonCollider) {\r\n            return ClosestLineJumpTable.PolygonPolygonClosestLine(this, collider);\r\n        }\r\n        else if (collider instanceof EdgeCollider) {\r\n            return ClosestLineJumpTable.PolygonEdgeClosestLine(this, collider);\r\n        }\r\n        else {\r\n            throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof collider}`);\r\n        }\r\n    }\r\n    /**\r\n     * Returns a collision contact if the 2 colliders collide, otherwise collide will\r\n     * return null.\r\n     * @param collider\r\n     */\r\n    collide(collider) {\r\n        if (collider instanceof CircleCollider) {\r\n            return CollisionJumpTable.CollideCirclePolygon(collider, this);\r\n        }\r\n        else if (collider instanceof PolygonCollider) {\r\n            return CollisionJumpTable.CollidePolygonPolygon(this, collider);\r\n        }\r\n        else if (collider instanceof EdgeCollider) {\r\n            return CollisionJumpTable.CollidePolygonEdge(this, collider);\r\n        }\r\n        else {\r\n            throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof collider}`);\r\n        }\r\n    }\r\n    /**\r\n     * Find the point on the collider furthest in the direction specified\r\n     */\r\n    getFurthestPoint(direction) {\r\n        const pts = this.getTransformedPoints();\r\n        let furthestPoint = null;\r\n        let maxDistance = -Number.MAX_VALUE;\r\n        for (let i = 0; i < pts.length; i++) {\r\n            const distance = direction.dot(pts[i]);\r\n            if (distance > maxDistance) {\r\n                maxDistance = distance;\r\n                furthestPoint = pts[i];\r\n            }\r\n        }\r\n        return furthestPoint;\r\n    }\r\n    /**\r\n     * Find the local point on the collider furthest in the direction specified\r\n     * @param direction\r\n     */\r\n    getFurthestLocalPoint(direction) {\r\n        const pts = this.points;\r\n        let furthestPoint = pts[0];\r\n        let maxDistance = -Number.MAX_VALUE;\r\n        for (let i = 0; i < pts.length; i++) {\r\n            const distance = direction.dot(pts[i]);\r\n            if (distance > maxDistance) {\r\n                maxDistance = distance;\r\n                furthestPoint = pts[i];\r\n            }\r\n        }\r\n        return furthestPoint;\r\n    }\r\n    /**\r\n     * Finds the closes face to the point using perpendicular distance\r\n     * @param point point to test against polygon\r\n     */\r\n    getClosestFace(point) {\r\n        const sides = this.getSides();\r\n        let min = Number.POSITIVE_INFINITY;\r\n        let faceIndex = -1;\r\n        let distance = -1;\r\n        for (let i = 0; i < sides.length; i++) {\r\n            const dist = sides[i].distanceToPoint(point);\r\n            if (dist < min) {\r\n                min = dist;\r\n                faceIndex = i;\r\n                distance = dist;\r\n            }\r\n        }\r\n        if (faceIndex !== -1) {\r\n            return {\r\n                distance: sides[faceIndex].normal().scale(distance),\r\n                face: sides[faceIndex]\r\n            };\r\n        }\r\n        return null;\r\n    }\r\n    /**\r\n     * Get the axis aligned bounding box for the polygon collider in world coordinates\r\n     */\r\n    get bounds() {\r\n        var _a, _b, _c;\r\n        const tx = this._transform;\r\n        const scale = (_a = tx === null || tx === void 0 ? void 0 : tx.globalScale) !== null && _a !== void 0 ? _a : Vector.One;\r\n        const rotation = (_b = tx === null || tx === void 0 ? void 0 : tx.globalRotation) !== null && _b !== void 0 ? _b : 0;\r\n        const pos = ((_c = tx === null || tx === void 0 ? void 0 : tx.globalPos) !== null && _c !== void 0 ? _c : Vector.Zero).add(this.offset);\r\n        return this.localBounds.scale(scale).rotate(rotation).translate(pos);\r\n    }\r\n    /**\r\n     * Get the axis aligned bounding box for the polygon collider in local coordinates\r\n     */\r\n    get localBounds() {\r\n        return BoundingBox.fromPoints(this.points);\r\n    }\r\n    /**\r\n     * Get the moment of inertia for an arbitrary polygon\r\n     * https://en.wikipedia.org/wiki/List_of_moments_of_inertia\r\n     */\r\n    getInertia(mass) {\r\n        let numerator = 0;\r\n        let denominator = 0;\r\n        for (let i = 0; i < this.points.length; i++) {\r\n            const iplusone = (i + 1) % this.points.length;\r\n            const crossTerm = this.points[iplusone].cross(this.points[i]);\r\n            numerator +=\r\n                crossTerm *\r\n                    (this.points[i].dot(this.points[i]) + this.points[i].dot(this.points[iplusone]) + this.points[iplusone].dot(this.points[iplusone]));\r\n            denominator += crossTerm;\r\n        }\r\n        return (mass / 6) * (numerator / denominator);\r\n    }\r\n    /**\r\n     * Casts a ray into the polygon and returns a vector representing the point of contact (in world space) or null if no collision.\r\n     */\r\n    rayCast(ray, max = Infinity) {\r\n        // find the minimum contact time greater than 0\r\n        // contact times less than 0 are behind the ray and we don't want those\r\n        const sides = this.getSides();\r\n        const len = sides.length;\r\n        let minContactTime = Number.MAX_VALUE;\r\n        let contactIndex = -1;\r\n        for (let i = 0; i < len; i++) {\r\n            const contactTime = ray.intersect(sides[i]);\r\n            if (contactTime >= 0 && contactTime < minContactTime && contactTime <= max) {\r\n                minContactTime = contactTime;\r\n                contactIndex = i;\r\n            }\r\n        }\r\n        // contact was found\r\n        if (contactIndex >= 0) {\r\n            return ray.getPoint(minContactTime);\r\n        }\r\n        // no contact found\r\n        return null;\r\n    }\r\n    /**\r\n     * Project the edges of the polygon along a specified axis\r\n     */\r\n    project(axis) {\r\n        const points = this.getTransformedPoints();\r\n        const len = points.length;\r\n        let min = Number.MAX_VALUE;\r\n        let max = -Number.MAX_VALUE;\r\n        for (let i = 0; i < len; i++) {\r\n            const scalar = points[i].dot(axis);\r\n            min = Math.min(min, scalar);\r\n            max = Math.max(max, scalar);\r\n        }\r\n        return new Projection(min, max);\r\n    }\r\n    draw(ctx, color = Color.Green, pos = Vector.Zero) {\r\n        const effectiveOffset = pos.add(this.offset);\r\n        ctx.beginPath();\r\n        ctx.fillStyle = color.toString();\r\n        const firstPoint = this.points[0].add(effectiveOffset);\r\n        ctx.moveTo(firstPoint.x, firstPoint.y);\r\n        // Points are relative\r\n        this.points\r\n            .map((p) => p.add(effectiveOffset))\r\n            .forEach(function (point) {\r\n            ctx.lineTo(point.x, point.y);\r\n        });\r\n        ctx.lineTo(firstPoint.x, firstPoint.y);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n    }\r\n    debug(ex, color) {\r\n        const firstPoint = this.getTransformedPoints()[0];\r\n        const points = [firstPoint, ...this.getTransformedPoints(), firstPoint];\r\n        for (let i = 0; i < points.length - 1; i++) {\r\n            ex.drawLine(points[i], points[i + 1], color, 2);\r\n            ex.drawCircle(points[i], 2, color);\r\n            ex.drawCircle(points[i + 1], 2, color);\r\n        }\r\n    }\r\n    /* istanbul ignore next */\r\n    debugDraw(ctx, color = Color.Red) {\r\n        ctx.beginPath();\r\n        ctx.strokeStyle = color.toString();\r\n        // Iterate through the supplied points and construct a 'polygon'\r\n        const firstPoint = this.getTransformedPoints()[0];\r\n        ctx.moveTo(firstPoint.x, firstPoint.y);\r\n        this.getTransformedPoints().forEach(function (point) {\r\n            ctx.lineTo(point.x, point.y);\r\n        });\r\n        ctx.lineTo(firstPoint.x, firstPoint.y);\r\n        ctx.closePath();\r\n        ctx.stroke();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/Shape.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Excalibur helper for defining colliders quickly\r\n */\r\nclass Shape {\r\n    /**\r\n     * Creates a box collider, under the hood defines a [[PolygonCollider]] collider\r\n     * @param width Width of the box\r\n     * @param height Height of the box\r\n     * @param anchor Anchor of the box (default (.5, .5)) which positions the box relative to the center of the collider's position\r\n     * @param offset Optional offset relative to the collider in local coordinates\r\n     */\r\n    static Box(width, height, anchor = Vector.Half, offset = Vector.Zero) {\r\n        return new PolygonCollider({\r\n            points: new BoundingBox(-width * anchor.x, -height * anchor.y, width - width * anchor.x, height - height * anchor.y).getPoints(),\r\n            offset: offset\r\n        });\r\n    }\r\n    /**\r\n     * Creates a new [[PolygonCollider|arbitrary polygon]] collider\r\n     *\r\n     * PolygonColliders are useful for creating convex polygon shapes\r\n     * @param points Points specified in counter clockwise\r\n     * @param clockwiseWinding Optionally changed the winding of points, by default false meaning counter-clockwise winding.\r\n     * @param offset Optional offset relative to the collider in local coordinates\r\n     */\r\n    static Polygon(points, clockwiseWinding = false, offset = Vector.Zero) {\r\n        return new PolygonCollider({\r\n            points: points,\r\n            offset: offset,\r\n            clockwiseWinding: clockwiseWinding\r\n        });\r\n    }\r\n    /**\r\n     * Creates a new [[CircleCollider|circle]] collider\r\n     *\r\n     * Circle colliders are useful for balls, or to make collisions more forgiving on sharp edges\r\n     * @param radius Radius of the circle collider\r\n     * @param offset Optional offset relative to the collider in local coordinates\r\n     */\r\n    static Circle(radius, offset = Vector.Zero) {\r\n        return new CircleCollider({\r\n            radius: radius,\r\n            offset: offset\r\n        });\r\n    }\r\n    /**\r\n     * Creates a new [[EdgeCollider|edge]] collider\r\n     *\r\n     * Edge colliders are useful for  floors, walls, and other barriers\r\n     * @param begin Beginning of the edge in local coordinates to the collider\r\n     * @param end Ending of the edge in local coordinates to the collider\r\n     */\r\n    static Edge(begin, end) {\r\n        return new EdgeCollider({\r\n            begin: begin,\r\n            end: end\r\n        });\r\n    }\r\n    /**\r\n     * Creates a new capsule shaped [[CompositeCollider]] using 2 circles and a box\r\n     *\r\n     * Capsule colliders are useful for platformers with incline or jagged floors to have a smooth\r\n     * player experience.\r\n     *\r\n     * @param width\r\n     * @param height\r\n     * @param offset Optional offset\r\n     */\r\n    static Capsule(width, height, offset = Vector.Zero) {\r\n        const logger = Logger.getInstance();\r\n        if (width === height) {\r\n            logger.warn('A capsule collider with equal width and height is a circle, consider using a ex.Shape.Circle or ex.CircleCollider');\r\n        }\r\n        const vertical = height >= width;\r\n        if (vertical) {\r\n            // height > width, if equal maybe use a circle\r\n            const capsule = new CompositeCollider([\r\n                Shape.Circle(width / 2, vec(0, -height / 2 + width / 2).add(offset)),\r\n                Shape.Box(width, height - width, Vector.Half, offset),\r\n                Shape.Circle(width / 2, vec(0, height / 2 - width / 2).add(offset))\r\n            ]);\r\n            return capsule;\r\n        }\r\n        else {\r\n            // width > height, if equal maybe use a circle\r\n            const capsule = new CompositeCollider([\r\n                Shape.Circle(height / 2, vec(-width / 2 + height / 2, 0).add(offset)),\r\n                Shape.Box(width - height, height, Vector.Half, offset),\r\n                Shape.Circle(height / 2, vec(width / 2 - height / 2, 0).add(offset))\r\n            ]);\r\n            return capsule;\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/ColliderComponent.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass ColliderComponent extends Component {\r\n    constructor(collider) {\r\n        super();\r\n        this.type = 'ex.collider';\r\n        this.events = new EventDispatcher(this);\r\n        /**\r\n         * Observable that notifies when a collider is added to the body\r\n         */\r\n        this.$colliderAdded = new Observable();\r\n        /**\r\n         * Observable that notifies when a collider is removed from the body\r\n         */\r\n        this.$colliderRemoved = new Observable();\r\n        this.set(collider);\r\n    }\r\n    /**\r\n     * Get the current collider geometry\r\n     * @returns\r\n     */\r\n    get() {\r\n        return this._collider;\r\n    }\r\n    /**\r\n     * Set the collider geometry\r\n     * @param collider\r\n     * @returns the collider you set\r\n     */\r\n    set(collider) {\r\n        this.clear();\r\n        if (collider) {\r\n            this._collider = collider;\r\n            this._collider.owner = this.owner;\r\n            this.events.wire(collider.events);\r\n            this.$colliderAdded.notifyAll(collider);\r\n            this.update();\r\n        }\r\n        return collider;\r\n    }\r\n    /**\r\n     * Remove collider geometry from collider component\r\n     */\r\n    clear() {\r\n        if (this._collider) {\r\n            this.events.unwire(this._collider.events);\r\n            this.$colliderRemoved.notifyAll(this._collider);\r\n            this._collider.owner = null;\r\n            this._collider = null;\r\n        }\r\n    }\r\n    /**\r\n     * Return world space bounds\r\n     */\r\n    get bounds() {\r\n        var _a, _b;\r\n        return (_b = (_a = this._collider) === null || _a === void 0 ? void 0 : _a.bounds) !== null && _b !== void 0 ? _b : new BoundingBox();\r\n    }\r\n    /**\r\n     * Return local space bounds\r\n     */\r\n    get localBounds() {\r\n        var _a, _b;\r\n        return (_b = (_a = this._collider) === null || _a === void 0 ? void 0 : _a.localBounds) !== null && _b !== void 0 ? _b : new BoundingBox();\r\n    }\r\n    /**\r\n     * Update the collider's transformed geometry\r\n     */\r\n    update() {\r\n        var _a;\r\n        const tx = (_a = this.owner) === null || _a === void 0 ? void 0 : _a.get(TransformComponent);\r\n        if (this._collider) {\r\n            this._collider.owner = this.owner;\r\n            if (tx) {\r\n                this._collider.update(tx);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Collide component with another\r\n     * @param other\r\n     * @returns\r\n     */\r\n    collide(other) {\r\n        let colliderA = this._collider;\r\n        let colliderB = other._collider;\r\n        if (!colliderA || !colliderB) {\r\n            return [];\r\n        }\r\n        // If we have a composite lefthand side :(\r\n        // Might bite us, but to avoid updating all the handlers make composite always left side\r\n        let flipped = false;\r\n        if (colliderB instanceof CompositeCollider) {\r\n            colliderA = colliderB;\r\n            colliderB = this._collider;\r\n            flipped = true;\r\n        }\r\n        if (this._collider) {\r\n            const contacts = colliderA.collide(colliderB);\r\n            if (contacts) {\r\n                if (flipped) {\r\n                    contacts.forEach((contact) => {\r\n                        contact.mtv = contact.mtv.negate();\r\n                        contact.normal = contact.normal.negate();\r\n                        contact.tangent = contact.normal.perpendicular();\r\n                        contact.colliderA = this._collider;\r\n                        contact.colliderB = other._collider;\r\n                    });\r\n                }\r\n                return contacts;\r\n            }\r\n            return [];\r\n        }\r\n        return [];\r\n    }\r\n    onAdd(entity) {\r\n        if (this._collider) {\r\n            this.update();\r\n        }\r\n        // Wire up the collider events to the owning entity\r\n        this.events.on('precollision', (evt) => {\r\n            const precollision = evt;\r\n            entity.events.emit('precollision', new PreCollisionEvent(precollision.target.owner, precollision.other.owner, precollision.side, precollision.intersection));\r\n        });\r\n        this.events.on('postcollision', (evt) => {\r\n            const postcollision = evt;\r\n            entity.events.emit('postcollision', new PostCollisionEvent(postcollision.target.owner, postcollision.other.owner, postcollision.side, postcollision.intersection));\r\n        });\r\n        this.events.on('collisionstart', (evt) => {\r\n            const start = evt;\r\n            entity.events.emit('collisionstart', new CollisionStartEvent(start.target.owner, start.other.owner, start.contact));\r\n        });\r\n        this.events.on('collisionend', (evt) => {\r\n            const end = evt;\r\n            entity.events.emit('collisionend', new CollisionEndEvent(end.target.owner, end.other.owner));\r\n        });\r\n    }\r\n    onRemove() {\r\n        this.events.clear();\r\n        this.$colliderRemoved.notifyAll(this._collider);\r\n    }\r\n    /**\r\n     * Sets up a box geometry based on the current bounds of the associated actor of this physics body.\r\n     *\r\n     * If no width/height are specified the body will attempt to use the associated actor's width/height.\r\n     *\r\n     * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.\r\n     */\r\n    useBoxCollider(width, height, anchor = Vector.Half, center = Vector.Zero) {\r\n        const collider = Shape.Box(width, height, anchor, center);\r\n        return (this.set(collider));\r\n    }\r\n    /**\r\n     * Sets up a [[PolygonCollider|polygon]] collision geometry based on a list of of points relative\r\n     *  to the anchor of the associated actor\r\n     * of this physics body.\r\n     *\r\n     * Only [convex polygon](https://en.wikipedia.org/wiki/Convex_polygon) definitions are supported.\r\n     *\r\n     * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.\r\n     */\r\n    usePolygonCollider(points, center = Vector.Zero) {\r\n        const poly = Shape.Polygon(points, false, center);\r\n        return (this.set(poly));\r\n    }\r\n    /**\r\n     * Sets up a [[Circle|circle collision geometry]] as the only collider with a specified radius in pixels.\r\n     *\r\n     * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.\r\n     */\r\n    useCircleCollider(radius, center = Vector.Zero) {\r\n        const collider = Shape.Circle(radius, center);\r\n        return (this.set(collider));\r\n    }\r\n    /**\r\n     * Sets up an [[Edge|edge collision geometry]] with a start point and an end point relative to the anchor of the associated actor\r\n     * of this physics body.\r\n     *\r\n     * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.\r\n     */\r\n    useEdgeCollider(begin, end) {\r\n        const collider = Shape.Edge(begin, end);\r\n        return (this.set(collider));\r\n    }\r\n    /**\r\n     * Setups up a [[CompositeCollider]] which can define any arbitrary set of excalibur colliders\r\n     * @param colliders\r\n     * @returns\r\n     */\r\n    useCompositeCollider(colliders) {\r\n        return (this.set(new CompositeCollider(colliders)));\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/BodyComponent.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar DegreeOfFreedom;\r\n(function (DegreeOfFreedom) {\r\n    DegreeOfFreedom[\"Rotation\"] = \"rotation\";\r\n    DegreeOfFreedom[\"X\"] = \"x\";\r\n    DegreeOfFreedom[\"Y\"] = \"y\";\r\n})(DegreeOfFreedom || (DegreeOfFreedom = {}));\r\n/**\r\n * Body describes all the physical properties pos, vel, acc, rotation, angular velocity for the purpose of\r\n * of physics simulation.\r\n */\r\nclass BodyComponent extends Component {\r\n    constructor(options) {\r\n        var _a, _b, _c;\r\n        super();\r\n        this.type = 'ex.body';\r\n        this.dependencies = [TransformComponent, MotionComponent];\r\n        this.id = createId('body', BodyComponent._ID++);\r\n        this.events = new EventDispatcher(this);\r\n        /**\r\n         * Collision type for the rigidbody physics simulation, by default [[CollisionType.PreventCollision]]\r\n         */\r\n        this.collisionType = CollisionType.PreventCollision;\r\n        /**\r\n         * The collision group for the body's colliders, by default body colliders collide with everything\r\n         */\r\n        this.group = CollisionGroup.All;\r\n        /**\r\n         * The amount of mass the body has\r\n         */\r\n        this.mass = Physics.defaultMass;\r\n        /**\r\n         * Amount of \"motion\" the body has before sleeping. If below [[Physics.sleepEpsilon]] it goes to \"sleep\"\r\n         */\r\n        this.sleepMotion = Physics.sleepEpsilon * 5;\r\n        /**\r\n         * Can this body sleep, by default bodies do not sleep\r\n         */\r\n        this.canSleep = Physics.bodiesCanSleepByDefault;\r\n        this._sleeping = false;\r\n        /**\r\n         * The also known as coefficient of restitution of this actor, represents the amount of energy preserved after collision or the\r\n         * bounciness. If 1, it is 100% bouncy, 0 it completely absorbs.\r\n         */\r\n        this.bounciness = 0.2;\r\n        /**\r\n         * The coefficient of friction on this actor\r\n         */\r\n        this.friction = 0.99;\r\n        /**\r\n         * Should use global gravity [[Physics.gravity]] in it's physics simulation, default is true\r\n         */\r\n        this.useGravity = true;\r\n        /**\r\n         * Degrees of freedom to limit\r\n         */\r\n        this.limitDegreeOfFreedom = [];\r\n        /**\r\n         * The position of the actor last frame (x, y) in pixels\r\n         */\r\n        this.oldPos = new Vector(0, 0);\r\n        /**\r\n         * The velocity of the actor last frame (vx, vy) in pixels/second\r\n         */\r\n        this.oldVel = new Vector(0, 0);\r\n        /**\r\n         * Gets/sets the acceleration of the actor from the last frame. This does not include the global acc [[Physics.acc]].\r\n         */\r\n        this.oldAcc = Vector.Zero;\r\n        /**\r\n         * Gets/sets the rotation of the body from the last frame.\r\n         */\r\n        this.oldRotation = 0; // radians\r\n        /**\r\n         * The scale of the actor last frame\r\n         * @deprecated ex.Body.scale will be removed in v0.25.0\r\n         */\r\n        this.oldScale = Vector.One;\r\n        if (options) {\r\n            this.collisionType = (_a = options.type) !== null && _a !== void 0 ? _a : this.collisionType;\r\n            this.group = (_b = options.group) !== null && _b !== void 0 ? _b : this.group;\r\n            this.useGravity = (_c = options.useGravity) !== null && _c !== void 0 ? _c : this.useGravity;\r\n        }\r\n    }\r\n    /**\r\n     * The inverse mass (1/mass) of the body. If [[CollisionType.Fixed]] this is 0, meaning \"infinite\" mass\r\n     */\r\n    get inverseMass() {\r\n        return this.collisionType === CollisionType.Fixed ? 0 : 1 / this.mass;\r\n    }\r\n    /**\r\n     * Whether this body is sleeping or not\r\n     */\r\n    get sleeping() {\r\n        return this._sleeping;\r\n    }\r\n    /**\r\n     * Set the sleep state of the body\r\n     * @param sleeping\r\n     */\r\n    setSleeping(sleeping) {\r\n        this._sleeping = sleeping;\r\n        if (!sleeping) {\r\n            // Give it a kick to keep it from falling asleep immediately\r\n            this.sleepMotion = Physics.sleepEpsilon * 5;\r\n        }\r\n        else {\r\n            this.vel = Vector.Zero;\r\n            this.acc = Vector.Zero;\r\n            this.angularVelocity = 0;\r\n            this.sleepMotion = 0;\r\n        }\r\n    }\r\n    /**\r\n     * Update body's [[BodyComponent.sleepMotion]] for the purpose of sleeping\r\n     */\r\n    updateMotion() {\r\n        if (this._sleeping) {\r\n            this.setSleeping(true);\r\n        }\r\n        const currentMotion = this.vel.size * this.vel.size + Math.abs(this.angularVelocity * this.angularVelocity);\r\n        const bias = Physics.sleepBias;\r\n        this.sleepMotion = bias * this.sleepMotion + (1 - bias) * currentMotion;\r\n        this.sleepMotion = clamp(this.sleepMotion, 0, 10 * Physics.sleepEpsilon);\r\n        if (this.canSleep && this.sleepMotion < Physics.sleepEpsilon) {\r\n            this.setSleeping(true);\r\n        }\r\n    }\r\n    /**\r\n     * Get the moment of inertia from the [[ColliderComponent]]\r\n     */\r\n    get inertia() {\r\n        // Inertia is a property of the geometry, so this is a little goofy but seems to be okay?\r\n        const collider = this.owner.get(ColliderComponent);\r\n        if (collider === null || collider === void 0 ? void 0 : collider.get()) {\r\n            return collider.get().getInertia(this.mass);\r\n        }\r\n        return 0;\r\n    }\r\n    /**\r\n     * Get the inverse moment of inertial from the [[ColliderComponent]]. If [[CollisionType.Fixed]] this is 0, meaning \"infinite\" mass\r\n     */\r\n    get inverseInertia() {\r\n        return this.collisionType === CollisionType.Fixed ? 0 : 1 / this.inertia;\r\n    }\r\n    /**\r\n     * Returns if the owner is active\r\n     */\r\n    get active() {\r\n        var _a;\r\n        return !!((_a = this.owner) === null || _a === void 0 ? void 0 : _a.active);\r\n    }\r\n    get center() {\r\n        return this.pos;\r\n    }\r\n    get transform() {\r\n        var _a;\r\n        return (_a = this.owner) === null || _a === void 0 ? void 0 : _a.get(TransformComponent);\r\n    }\r\n    get motion() {\r\n        var _a;\r\n        return (_a = this.owner) === null || _a === void 0 ? void 0 : _a.get(MotionComponent);\r\n    }\r\n    /**\r\n     * The (x, y) position of the actor this will be in the middle of the actor if the\r\n     * [[Actor.anchor]] is set to (0.5, 0.5) which is default.\r\n     * If you want the (x, y) position to be the top left of the actor specify an anchor of (0, 0).\r\n     */\r\n    get pos() {\r\n        return this.transform.globalPos;\r\n    }\r\n    set pos(val) {\r\n        this.transform.globalPos = val;\r\n    }\r\n    /**\r\n     * The current velocity vector (vx, vy) of the actor in pixels/second\r\n     */\r\n    get vel() {\r\n        return this.motion.vel;\r\n    }\r\n    set vel(val) {\r\n        this.motion.vel = val;\r\n    }\r\n    /**\r\n     * The current acceleration vector (ax, ay) of the actor in pixels/second/second. An acceleration pointing down such as (0, 100) may\r\n     * be useful to simulate a gravitational effect.\r\n     */\r\n    get acc() {\r\n        return this.motion.acc;\r\n    }\r\n    set acc(val) {\r\n        this.motion.acc = val;\r\n    }\r\n    /**\r\n     * The current torque applied to the actor\r\n     */\r\n    get torque() {\r\n        return this.motion.torque;\r\n    }\r\n    set torque(val) {\r\n        this.motion.torque = val;\r\n    }\r\n    /**\r\n     * The rotation of the body in radians\r\n     */\r\n    get rotation() {\r\n        return this.transform.globalRotation;\r\n    }\r\n    set rotation(val) {\r\n        this.transform.globalRotation = val;\r\n    }\r\n    /**\r\n     * The scale vector of the actor\r\n     * @deprecated ex.Body.scale will be removed in v0.25.0, Use ex.Transform.scale\r\n     */\r\n    get scale() {\r\n        return this.transform.globalScale;\r\n    }\r\n    set scale(val) {\r\n        this.transform.globalScale = val;\r\n    }\r\n    /**\r\n     * The x scalar velocity of the actor in scale/second\r\n     * @deprecated ex.Body.scale will be removed in v0.25.0\r\n     */\r\n    get sx() {\r\n        return this.motion.scaleFactor.x;\r\n    }\r\n    set sx(xFactor) {\r\n        this.motion.scaleFactor.x = xFactor;\r\n    }\r\n    /**\r\n     * The y scalar velocity of the actor in scale/second\r\n     * @deprecated ex.Body.scale will be removed in v0.25.0\r\n     */\r\n    get sy() {\r\n        return this.motion.scaleFactor.y;\r\n    }\r\n    set sy(yFactor) {\r\n        this.motion.scaleFactor.y = yFactor;\r\n    }\r\n    /**\r\n     * The rotational velocity of the actor in radians/second\r\n     * @deprecated\r\n     */\r\n    get rx() {\r\n        return this.motion.angularVelocity;\r\n    }\r\n    /**\r\n     * The rotational velocity of the actor in radians/second\r\n     * @deprecated\r\n     */\r\n    set rx(value) {\r\n        this.motion.angularVelocity = value;\r\n    }\r\n    /**\r\n     * Get the angular velocity in radians/second\r\n     */\r\n    get angularVelocity() {\r\n        return this.motion.angularVelocity;\r\n    }\r\n    /**\r\n     * Set the angular velocity in radians/second\r\n     */\r\n    set angularVelocity(value) {\r\n        this.motion.angularVelocity = value;\r\n    }\r\n    /**\r\n     * Apply a specific impulse to the body\r\n     * @param point\r\n     * @param impulse\r\n     */\r\n    applyImpulse(point, impulse) {\r\n        if (this.collisionType !== CollisionType.Active) {\r\n            return; // only active objects participate in the simulation\r\n        }\r\n        const finalImpulse = impulse.scale(this.inverseMass);\r\n        if (this.limitDegreeOfFreedom.includes(DegreeOfFreedom.X)) {\r\n            finalImpulse.x = 0;\r\n        }\r\n        if (this.limitDegreeOfFreedom.includes(DegreeOfFreedom.Y)) {\r\n            finalImpulse.y = 0;\r\n        }\r\n        this.vel.addEqual(finalImpulse);\r\n        if (!this.limitDegreeOfFreedom.includes(DegreeOfFreedom.Rotation)) {\r\n            const distanceFromCenter = point.sub(this.pos);\r\n            this.angularVelocity += this.inverseInertia * distanceFromCenter.cross(impulse);\r\n        }\r\n    }\r\n    /**\r\n     * Apply only linear impulse to the body\r\n     * @param impulse\r\n     */\r\n    applyLinearImpulse(impulse) {\r\n        if (this.collisionType !== CollisionType.Active) {\r\n            return; // only active objects participate in the simulation\r\n        }\r\n        const finalImpulse = impulse.scale(this.inverseMass);\r\n        if (this.limitDegreeOfFreedom.includes(DegreeOfFreedom.X)) {\r\n            finalImpulse.x = 0;\r\n        }\r\n        if (this.limitDegreeOfFreedom.includes(DegreeOfFreedom.Y)) {\r\n            finalImpulse.y = 0;\r\n        }\r\n        this.vel = this.vel.add(finalImpulse);\r\n    }\r\n    /**\r\n     * Apply only angular impuse to the body\r\n     * @param point\r\n     * @param impulse\r\n     */\r\n    applyAngularImpulse(point, impulse) {\r\n        if (this.collisionType !== CollisionType.Active) {\r\n            return; // only active objects participate in the simulation\r\n        }\r\n        if (!this.limitDegreeOfFreedom.includes(DegreeOfFreedom.Rotation)) {\r\n            const distanceFromCenter = point.sub(this.pos);\r\n            this.angularVelocity += this.inverseInertia * distanceFromCenter.cross(impulse);\r\n        }\r\n    }\r\n    /**\r\n     * Sets the old versions of pos, vel, acc, and scale.\r\n     */\r\n    captureOldTransform() {\r\n        // Capture old values before integration step updates them\r\n        this.oldVel.setTo(this.vel.x, this.vel.y);\r\n        this.oldPos.setTo(this.pos.x, this.pos.y);\r\n        this.oldAcc.setTo(this.acc.x, this.acc.y);\r\n        this.oldScale.setTo(this.scale.x, this.scale.y);\r\n        this.oldRotation = this.rotation;\r\n    }\r\n    debugDraw(_ctx) {\r\n        // pass\r\n    }\r\n}\r\nBodyComponent._ID = 0;\r\n\n;// CONCATENATED MODULE: ./Util/CullingBox.ts\n\r\n\r\n/**\r\n * @deprecated Will be removed in 0.26.0\r\n */\r\nclass CullingBox {\r\n    constructor() {\r\n        this._topLeft = new Vector(0, 0);\r\n        this._topRight = new Vector(0, 0);\r\n        this._bottomLeft = new Vector(0, 0);\r\n        this._bottomRight = new Vector(0, 0);\r\n    }\r\n    isSpriteOffScreen(actor, engine) {\r\n        const drawingWidth = actor.currentDrawing.drawWidth;\r\n        const drawingHeight = actor.currentDrawing.drawHeight;\r\n        const rotation = actor.rotation;\r\n        const anchor = actor.center;\r\n        const worldPos = actor.getGlobalPos();\r\n        this._topLeft = vec(worldPos.x - drawingWidth / 2, worldPos.y - drawingHeight / 2);\r\n        this._topLeft = this._topLeft.rotate(rotation, anchor);\r\n        this._topRight = vec(worldPos.x + drawingWidth / 2, worldPos.y - drawingHeight / 2);\r\n        this._topRight = this._topRight.rotate(rotation, anchor);\r\n        this._bottomLeft = vec(worldPos.x - drawingWidth / 2, worldPos.y + drawingHeight / 2);\r\n        this._bottomLeft = this._bottomLeft.rotate(rotation, anchor);\r\n        this._bottomRight = vec(worldPos.x + drawingWidth / 2, worldPos.y + drawingHeight / 2);\r\n        this._bottomRight = this._bottomRight.rotate(rotation, anchor);\r\n        const topLeftScreen = engine.worldToScreenCoordinates(this._topLeft);\r\n        const topRightScreen = engine.worldToScreenCoordinates(this._topRight);\r\n        const bottomLeftScreen = engine.worldToScreenCoordinates(this._bottomLeft);\r\n        const bottomRightScreen = engine.worldToScreenCoordinates(this._bottomRight);\r\n        this._xCoords = [];\r\n        this._yCoords = [];\r\n        this._xCoords.push(topLeftScreen.x, topRightScreen.x, bottomLeftScreen.x, bottomRightScreen.x);\r\n        this._yCoords.push(topLeftScreen.y, topRightScreen.y, bottomLeftScreen.y, bottomRightScreen.y);\r\n        this._xMin = Math.min.apply(null, this._xCoords);\r\n        this._yMin = Math.min.apply(null, this._yCoords);\r\n        this._xMax = Math.max.apply(null, this._xCoords);\r\n        this._yMax = Math.max.apply(null, this._yCoords);\r\n        const minWorld = engine.screenToWorldCoordinates(new Vector(this._xMin, this._yMin));\r\n        const maxWorld = engine.screenToWorldCoordinates(new Vector(this._xMax, this._yMax));\r\n        this._xMinWorld = minWorld.x;\r\n        this._yMinWorld = minWorld.y;\r\n        this._xMaxWorld = maxWorld.x;\r\n        this._yMaxWorld = maxWorld.y;\r\n        const boundingPoints = [\r\n            new Vector(this._xMin, this._yMin),\r\n            new Vector(this._xMax, this._yMin),\r\n            new Vector(this._xMin, this._yMax),\r\n            new Vector(this._xMax, this._yMax) // bottom right\r\n        ];\r\n        // sprite can be wider than canvas screen (and still visible within canvas)\r\n        // top or bottom of sprite must be within canvas\r\n        if (boundingPoints[0].x < 0 &&\r\n            boundingPoints[1].x > engine.canvas.clientWidth &&\r\n            (boundingPoints[0].y > 0 || boundingPoints[2].y < engine.canvas.clientHeight)) {\r\n            return false;\r\n        }\r\n        // sprite can be taller than canvas screen (and still visible within canvas)\r\n        // left or right of sprite must be within canvas\r\n        if (boundingPoints[0].y < 0 &&\r\n            boundingPoints[2].y > engine.canvas.clientHeight &&\r\n            (boundingPoints[1].x > 0 || boundingPoints[0].x < engine.canvas.clientWidth)) {\r\n            return false;\r\n        }\r\n        // otherwise if any corner is visible, we're not offscreen\r\n        for (let i = 0; i < boundingPoints.length; i++) {\r\n            if (boundingPoints[i].x > 0 &&\r\n                boundingPoints[i].y > 0 &&\r\n                boundingPoints[i].x < engine.canvas.clientWidth &&\r\n                boundingPoints[i].y < engine.canvas.clientHeight) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n    debugDraw(ctx) {\r\n        // bounding rectangle\r\n        ctx.beginPath();\r\n        ctx.strokeStyle = Color.White.toString();\r\n        ctx.rect(this._xMinWorld, this._yMinWorld, this._xMaxWorld - this._xMinWorld, this._yMaxWorld - this._yMinWorld);\r\n        ctx.stroke();\r\n        ctx.fillStyle = Color.Red.toString();\r\n        ctx.beginPath();\r\n        ctx.arc(this._topLeft.x, this._topLeft.y, 5, 0, Math.PI * 2);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n        ctx.fillStyle = Color.Green.toString();\r\n        ctx.beginPath();\r\n        ctx.arc(this._topRight.x, this._topRight.y, 5, 0, Math.PI * 2);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n        ctx.fillStyle = Color.Blue.toString();\r\n        ctx.beginPath();\r\n        ctx.arc(this._bottomLeft.x, this._bottomLeft.y, 5, 0, Math.PI * 2);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n        ctx.fillStyle = Color.Magenta.toString();\r\n        ctx.beginPath();\r\n        ctx.arc(this._bottomRight.x, this._bottomRight.y, 5, 0, Math.PI * 2);\r\n        ctx.closePath();\r\n        ctx.fill();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Traits/OffscreenCulling.ts\n\r\n\r\n\r\n/**\r\n * @deprecated will be removed in 0.26.0\r\n */\r\nclass OffscreenCulling {\r\n    constructor() {\r\n        this.cullingBox = new CullingBox();\r\n    }\r\n    update(actor, engine) {\r\n        const events = actor.eventDispatcher;\r\n        let isSpriteOffScreen = true;\r\n        if (actor.currentDrawing != null) {\r\n            isSpriteOffScreen = this.cullingBox.isSpriteOffScreen(actor, engine);\r\n        }\r\n        let actorBoundsOffscreen = false;\r\n        if (engine && engine.currentScene && engine.currentScene.camera && engine.currentScene.camera.viewport && !actor.parent) {\r\n            actorBoundsOffscreen = !engine.currentScene.camera.viewport.intersect(actor.collider.bounds);\r\n        }\r\n        if (!actor.isOffScreen) {\r\n            if (actorBoundsOffscreen && isSpriteOffScreen) {\r\n                events.emit('exitviewport', new ExitViewPortEvent(actor));\r\n                actor.addComponent(new TagComponent('offscreen'));\r\n            }\r\n        }\r\n        else {\r\n            if (!actorBoundsOffscreen || !isSpriteOffScreen) {\r\n                events.emit('enterviewport', new EnterViewPortEvent(actor));\r\n                actor.removeComponent('offscreen');\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Traits/CapturePointer.ts\n/**\r\n * Revises pointer events path accordingly to the actor\r\n * @deprecated Will be removed in 0.26.0\r\n */\r\nclass CapturePointer {\r\n    update(actor, engine) {\r\n        if (!actor.enableCapturePointer) {\r\n            return;\r\n        }\r\n        if (actor.isKilled()) {\r\n            return;\r\n        }\r\n        engine.input.pointers.checkAndUpdateActorUnderPointer(actor);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/Entity.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * AddedComponent message\r\n */\r\nclass AddedComponent {\r\n    constructor(data) {\r\n        this.data = data;\r\n        this.type = 'Component Added';\r\n    }\r\n}\r\n/**\r\n * Type guard to know if message is f an Added Component\r\n */\r\nfunction isAddedComponent(x) {\r\n    return !!x && x.type === 'Component Added';\r\n}\r\n/**\r\n * RemovedComponent message\r\n */\r\nclass RemovedComponent {\r\n    constructor(data) {\r\n        this.data = data;\r\n        this.type = 'Component Removed';\r\n    }\r\n}\r\n/**\r\n * Type guard to know if message is for a Removed Component\r\n */\r\nfunction isRemovedComponent(x) {\r\n    return !!x && x.type === 'Component Removed';\r\n}\r\n/**\r\n * An Entity is the base type of anything that can have behavior in Excalibur, they are part of the built in entity component system\r\n *\r\n * Entities can be strongly typed with the components they contain\r\n *\r\n * ```typescript\r\n * const entity = new Entity<ComponentA | ComponentB>();\r\n * entity.components.a; // Type ComponentA\r\n * entity.components.b; // Type ComponentB\r\n * ```\r\n */\r\nclass Entity extends Class {\r\n    constructor(components, name) {\r\n        super();\r\n        /**\r\n         * The unique identifier for the entity\r\n         */\r\n        this.id = Entity._ID++;\r\n        this._name = 'anonymous';\r\n        /**\r\n         * Whether this entity is active, if set to false it will be reclaimed\r\n         */\r\n        this.active = true;\r\n        /**\r\n         * Bucket to hold on to deferred removals\r\n         */\r\n        this._componentsToRemove = [];\r\n        this._componentTypeToInstance = new Map();\r\n        this._componentStringToInstance = new Map();\r\n        this._tagsMemo = [];\r\n        this._typesMemo = [];\r\n        /**\r\n         * Observable that keeps track of component add or remove changes on the entity\r\n         */\r\n        this.componentAdded$ = new Observable();\r\n        this.componentRemoved$ = new Observable();\r\n        this._parent = null;\r\n        this.childrenAdded$ = new Observable();\r\n        this.childrenRemoved$ = new Observable();\r\n        this._children = [];\r\n        this._isInitialized = false;\r\n        this._setName(name);\r\n        if (components) {\r\n            for (const component of components) {\r\n                this.addComponent(component);\r\n            }\r\n        }\r\n    }\r\n    _setName(name) {\r\n        if (name) {\r\n            this._name = name;\r\n        }\r\n    }\r\n    get name() {\r\n        return this._name;\r\n    }\r\n    get events() {\r\n        return this.eventDispatcher;\r\n    }\r\n    /**\r\n     * Kill the entity, means it will no longer be updated. Kills are deferred to the end of the update.\r\n     */\r\n    kill() {\r\n        this.active = false;\r\n    }\r\n    isKilled() {\r\n        return !this.active;\r\n    }\r\n    /**\r\n     * Specifically get the tags on the entity from [[TagComponent]]\r\n     */\r\n    get tags() {\r\n        return this._tagsMemo;\r\n    }\r\n    /**\r\n     * Check if a tag exists on the entity\r\n     * @param tag name to check for\r\n     */\r\n    hasTag(tag) {\r\n        return this.tags.includes(tag);\r\n    }\r\n    /**\r\n     * Adds a tag to an entity\r\n     * @param tag\r\n     * @returns Entity\r\n     */\r\n    addTag(tag) {\r\n        return this.addComponent(new TagComponent(tag));\r\n    }\r\n    /**\r\n     * Removes a tag on the entity\r\n     *\r\n     * Removals are deferred until the end of update\r\n     * @param tag\r\n     * @param force Remove component immediately, no deferred\r\n     */\r\n    removeTag(tag, force = false) {\r\n        return this.removeComponent(tag, force);\r\n    }\r\n    /**\r\n     * The types of the components on the Entity\r\n     */\r\n    get types() {\r\n        return this._typesMemo;\r\n    }\r\n    _rebuildMemos() {\r\n        this._tagsMemo = Array.from(this._componentStringToInstance.values())\r\n            .filter((c) => c instanceof TagComponent)\r\n            .map((c) => c.type);\r\n        this._typesMemo = Array.from(this._componentStringToInstance.keys());\r\n    }\r\n    getComponents() {\r\n        return Array.from(this._componentStringToInstance.values());\r\n    }\r\n    _notifyAddComponent(component) {\r\n        this._rebuildMemos();\r\n        const added = new AddedComponent({\r\n            component,\r\n            entity: this\r\n        });\r\n        this.componentAdded$.notifyAll(added);\r\n    }\r\n    _notifyRemoveComponent(component) {\r\n        const removed = new RemovedComponent({\r\n            component,\r\n            entity: this\r\n        });\r\n        this.componentRemoved$.notifyAll(removed);\r\n        this._rebuildMemos();\r\n    }\r\n    get parent() {\r\n        return this._parent;\r\n    }\r\n    /**\r\n     * Get the direct children of this entity\r\n     */\r\n    get children() {\r\n        return this._children;\r\n    }\r\n    /**\r\n     * Unparents this entity, if there is a parent. Otherwise it does nothing.\r\n     */\r\n    unparent() {\r\n        if (this._parent) {\r\n            this._parent.removeChild(this);\r\n            this._parent = null;\r\n        }\r\n    }\r\n    /**\r\n     * Adds an entity to be a child of this entity\r\n     * @param entity\r\n     */\r\n    addChild(entity) {\r\n        if (entity.parent === null) {\r\n            if (this.getAncestors().includes(entity)) {\r\n                throw new Error('Cycle detected, cannot add entity');\r\n            }\r\n            this._children.push(entity);\r\n            entity._parent = this;\r\n            this.childrenAdded$.notifyAll(entity);\r\n        }\r\n        else {\r\n            throw new Error('Entity already has a parent, cannot add without unparenting');\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Remove an entity from children if it exists\r\n     * @param entity\r\n     */\r\n    removeChild(entity) {\r\n        if (entity.parent === this) {\r\n            removeItemFromArray(entity, this._children);\r\n            entity._parent = null;\r\n            this.childrenRemoved$.notifyAll(entity);\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Removes all children from this entity\r\n     */\r\n    removeAllChildren() {\r\n        this.children.forEach((c) => {\r\n            this.removeChild(c);\r\n        });\r\n        return this;\r\n    }\r\n    /**\r\n     * Returns a list of parent entities starting with the topmost parent. Includes the current entity.\r\n     */\r\n    getAncestors() {\r\n        const result = [this];\r\n        let current = this.parent;\r\n        while (current) {\r\n            result.push(current);\r\n            current = current.parent;\r\n        }\r\n        return result.reverse();\r\n    }\r\n    /**\r\n     * Returns a list of all the entities that descend from this entity. Includes the current entity.\r\n     */\r\n    getDescendants() {\r\n        let result = [this];\r\n        let queue = [this];\r\n        while (queue.length > 0) {\r\n            const curr = queue.pop();\r\n            queue = queue.concat(curr.children);\r\n            result = result.concat(curr.children);\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Creates a deep copy of the entity and a copy of all its components\r\n     */\r\n    clone() {\r\n        const newEntity = new Entity();\r\n        for (const c of this.types) {\r\n            newEntity.addComponent(this.get(c).clone());\r\n        }\r\n        for (const child of this.children) {\r\n            newEntity.addChild(child.clone());\r\n        }\r\n        return newEntity;\r\n    }\r\n    /**\r\n     * Adds a copy of all the components from another template entity as a \"prefab\"\r\n     * @param templateEntity Entity to use as a template\r\n     * @param force Force component replacement if it aleady exists on the target entity\r\n     */\r\n    addTemplate(templateEntity, force = false) {\r\n        for (const c of templateEntity.getComponents()) {\r\n            this.addComponent(c.clone(), force);\r\n        }\r\n        for (const child of templateEntity.children) {\r\n            this.addChild(child.clone().addTemplate(child));\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Adds a component to the entity\r\n     * @param component Component or Entity to add copy of components from\r\n     * @param force Optionally overwrite any existing components of the same type\r\n     */\r\n    addComponent(component, force = false) {\r\n        // if component already exists, skip if not forced\r\n        if (this.has(component.type)) {\r\n            if (force) {\r\n                // Remove existing component type if exists when forced\r\n                this.removeComponent(component);\r\n            }\r\n            else {\r\n                // early exit component exiss\r\n                return this;\r\n            }\r\n        }\r\n        // TODO circular dependencies will be a problem\r\n        if (component.dependencies && component.dependencies.length) {\r\n            for (const ctor of component.dependencies) {\r\n                this.addComponent(new ctor());\r\n            }\r\n        }\r\n        component.owner = this;\r\n        const constuctorType = component.constructor;\r\n        this._componentTypeToInstance.set(constuctorType, component);\r\n        this._componentStringToInstance.set(component.type, component);\r\n        if (component.onAdd) {\r\n            component.onAdd(this);\r\n        }\r\n        this._notifyAddComponent(component);\r\n        return this;\r\n    }\r\n    /**\r\n     * Removes a component from the entity, by default removals are deferred to the end of entity update to avoid consistency issues\r\n     *\r\n     * Components can be force removed with the `force` flag, the removal is not deferred and happens immediately\r\n     * @param componentOrType\r\n     * @param force\r\n     */\r\n    removeComponent(componentOrType, force = false) {\r\n        if (force) {\r\n            if (typeof componentOrType === 'string') {\r\n                this._removeComponentByType(componentOrType);\r\n            }\r\n            else if (componentOrType instanceof Component) {\r\n                this._removeComponentByType(componentOrType.type);\r\n            }\r\n        }\r\n        else {\r\n            this._componentsToRemove.push(componentOrType);\r\n        }\r\n        return this;\r\n    }\r\n    _removeComponentByType(type) {\r\n        if (this.has(type)) {\r\n            const component = this.get(type);\r\n            component.owner = null;\r\n            if (component.onRemove) {\r\n                component.onRemove(this);\r\n            }\r\n            const ctor = component.constructor;\r\n            this._componentTypeToInstance.delete(ctor);\r\n            this._componentStringToInstance.delete(component.type);\r\n            this._notifyRemoveComponent(component);\r\n        }\r\n    }\r\n    /**\r\n     * @hidden\r\n     * @internal\r\n     */\r\n    processComponentRemoval() {\r\n        for (const componentOrType of this._componentsToRemove) {\r\n            const type = typeof componentOrType === 'string' ? componentOrType : componentOrType.type;\r\n            this._removeComponentByType(type);\r\n        }\r\n        this._componentsToRemove.length = 0;\r\n    }\r\n    has(type) {\r\n        if (typeof type === 'string') {\r\n            return this._componentStringToInstance.has(type);\r\n        }\r\n        else {\r\n            return this._componentTypeToInstance.has(type);\r\n        }\r\n    }\r\n    get(type) {\r\n        if (typeof type === 'string') {\r\n            return this._componentStringToInstance.get(type);\r\n        }\r\n        else {\r\n            return this._componentTypeToInstance.get(type);\r\n        }\r\n    }\r\n    /**\r\n     * Gets whether the actor is Initialized\r\n     */\r\n    get isInitialized() {\r\n        return this._isInitialized;\r\n    }\r\n    /**\r\n     * Initializes this entity, meant to be called by the Scene before first update not by users of Excalibur.\r\n     *\r\n     * It is not recommended that internal excalibur methods be overriden, do so at your own risk.\r\n     *\r\n     * @internal\r\n     */\r\n    _initialize(engine) {\r\n        if (!this.isInitialized) {\r\n            this.onInitialize(engine);\r\n            super.emit('initialize', new InitializeEvent(engine, this));\r\n            this._isInitialized = true;\r\n        }\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overriden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPreUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _preupdate(engine, delta) {\r\n        this.emit('preupdate', new PreUpdateEvent(engine, delta, this));\r\n        this.onPreUpdate(engine, delta);\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overriden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPostUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _postupdate(engine, delta) {\r\n        this.emit('postupdate', new PostUpdateEvent(engine, delta, this));\r\n        this.onPostUpdate(engine, delta);\r\n    }\r\n    /**\r\n     * `onInitialize` is called before the first update of the entity. This method is meant to be\r\n     * overridden.\r\n     *\r\n     * Synonymous with the event handler `.on('initialize', (evt) => {...})`\r\n     */\r\n    onInitialize(_engine) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * Safe to override onPreUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPreUpdate` is called directly before an entity is updated.\r\n     */\r\n    onPreUpdate(_engine, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('postupdate', (evt) =>{...})`\r\n     *\r\n     * `onPostUpdate` is called directly after an entity is updated.\r\n     */\r\n    onPostUpdate(_engine, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     *\r\n     * Entity update lifecycle, called internally\r\n     *\r\n     * @internal\r\n     * @param engine\r\n     * @param delta\r\n     */\r\n    update(engine, delta) {\r\n        this._initialize(engine);\r\n        this._preupdate(engine, delta);\r\n        for (const child of this.children) {\r\n            child.update(engine, delta);\r\n        }\r\n        this._postupdate(engine, delta);\r\n    }\r\n}\r\nEntity._ID = 0;\r\n\n;// CONCATENATED MODULE: ./Drawing/CanvasDrawComponent.ts\n\r\n/**\r\n * Shim to draw to the canvas when in LegacyDrawing mode\r\n * @deprecated\r\n */\r\nclass CanvasDrawComponent extends Component {\r\n    constructor(draw) {\r\n        var _a;\r\n        super();\r\n        this.draw = draw;\r\n        this.type = 'ex.canvas';\r\n        // eslint-disable-next-line @typescript-eslint/no-empty-function\r\n        this.draw = (_a = this.draw) !== null && _a !== void 0 ? _a : (() => { });\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/GraphicsComponent.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Type guard for checking if a Graphic HasTick (used for graphics that change over time like animations)\r\n * @param graphic\r\n */\r\nfunction hasGraphicsTick(graphic) {\r\n    return !!graphic.tick;\r\n}\r\nclass GraphicsLayer {\r\n    constructor(_options, _graphics) {\r\n        this._options = _options;\r\n        this._graphics = _graphics;\r\n        this.graphics = [];\r\n    }\r\n    get name() {\r\n        return this._options.name;\r\n    }\r\n    hide(nameOrGraphic) {\r\n        if (!nameOrGraphic) {\r\n            this.graphics.length = 0;\r\n        }\r\n        else {\r\n            let gfx = null;\r\n            if (nameOrGraphic instanceof Graphic) {\r\n                gfx = nameOrGraphic;\r\n            }\r\n            else {\r\n                gfx = this._graphics.getGraphic(nameOrGraphic);\r\n            }\r\n            this.graphics = this.graphics.filter((g) => g.graphic !== gfx);\r\n        }\r\n    }\r\n    /**\r\n     * Show a graphic by name or instance at an offset, graphics are shown in the order in which `show()` is called.\r\n     *\r\n     * If `show()` is called multiple times for the same graphic it will be shown multiple times.\r\n     * @param nameOrGraphic\r\n     * @param options\r\n     */\r\n    show(nameOrGraphic, options) {\r\n        options = Object.assign({}, options);\r\n        let gfx;\r\n        if (nameOrGraphic instanceof Graphic) {\r\n            gfx = this._graphics.copyGraphics ? nameOrGraphic.clone() : nameOrGraphic;\r\n        }\r\n        else {\r\n            gfx = this._graphics.getGraphic(nameOrGraphic);\r\n            if (!gfx) {\r\n                Logger.getInstance().error(`No such graphic added to component named ${nameOrGraphic}. These named graphics are available: `, this._graphics.getNames());\r\n            }\r\n        }\r\n        if (gfx) {\r\n            this.graphics.push({ graphic: gfx, options });\r\n            return gfx;\r\n        }\r\n        else {\r\n            return null;\r\n        }\r\n    }\r\n    /**\r\n     * Use a specific graphic, swap out any current graphics being shown\r\n     * @param nameOrGraphic\r\n     * @param options\r\n     */\r\n    use(nameOrGraphic, options) {\r\n        options = Object.assign({}, options);\r\n        this.hide();\r\n        return this.show(nameOrGraphic, options);\r\n    }\r\n    /**\r\n     * Current order of the layer, higher numbers are on top, lower numbers are on the bottom.\r\n     *\r\n     * For example a layer with `order = -1` would be under a layer of `order = 1`\r\n     */\r\n    get order() {\r\n        return this._options.order;\r\n    }\r\n    /**\r\n     * Set the order of the layer, higher numbers are on top, lower numbers are on the bottom.\r\n     *\r\n     * For example a layer with `order = -1` would be under a layer of `order = 1`\r\n     */\r\n    set order(order) {\r\n        this._options.order = order;\r\n    }\r\n    /**\r\n     * Get or set the pixel offset from the layer anchor for all graphics in the layer\r\n     */\r\n    get offset() {\r\n        var _a;\r\n        return (_a = this._options.offset) !== null && _a !== void 0 ? _a : Vector.Zero;\r\n    }\r\n    set offset(value) {\r\n        this._options.offset = value;\r\n    }\r\n    get currentKeys() {\r\n        var _a;\r\n        return (_a = this.name) !== null && _a !== void 0 ? _a : 'anonymous';\r\n    }\r\n}\r\nclass GraphicsLayers {\r\n    constructor(_component) {\r\n        this._component = _component;\r\n        this._layers = [];\r\n        this._layerMap = {};\r\n        this.default = new GraphicsLayer({ name: 'default', order: 0 }, _component);\r\n        this._maybeAddLayer(this.default);\r\n    }\r\n    create(options) {\r\n        const layer = new GraphicsLayer(options, this._component);\r\n        return this._maybeAddLayer(layer);\r\n    }\r\n    get(name) {\r\n        if (name) {\r\n            return this._getLayer(name);\r\n        }\r\n        return this._layers;\r\n    }\r\n    currentKeys() {\r\n        const graphicsLayerKeys = [];\r\n        for (const layer of this._layers) {\r\n            graphicsLayerKeys.push(layer.currentKeys);\r\n        }\r\n        return graphicsLayerKeys;\r\n    }\r\n    has(name) {\r\n        return name in this._layerMap;\r\n    }\r\n    _maybeAddLayer(layer) {\r\n        if (this._layerMap[layer.name]) {\r\n            // todo log warning\r\n            return this._layerMap[layer.name];\r\n        }\r\n        this._layerMap[layer.name] = layer;\r\n        this._layers.push(layer);\r\n        this._layers.sort((a, b) => a.order - b.order);\r\n        return layer;\r\n    }\r\n    _getLayer(name) {\r\n        return this._layerMap[name];\r\n    }\r\n}\r\n/**\r\n * Component to manage drawings, using with the position component\r\n */\r\nclass GraphicsComponent extends Component {\r\n    constructor(options) {\r\n        super();\r\n        this.type = 'ex.graphics';\r\n        this._graphics = {};\r\n        /**\r\n         * Sets or gets wether any drawing should be visible in this component\r\n         */\r\n        this.visible = true;\r\n        /**\r\n         * Sets or gets wither all drawings should have an opacity applied\r\n         */\r\n        this.opacity = 1;\r\n        /**\r\n         * Offset to apply to graphics by default\r\n         */\r\n        this.offset = Vector.Zero;\r\n        /**\r\n         * Anchor to apply to graphics by default\r\n         */\r\n        this.anchor = Vector.Half;\r\n        /**\r\n         * If set to true graphics added to the component will be copied. This can affect performance\r\n         */\r\n        this.copyGraphics = false;\r\n        this._bounds = null;\r\n        // Defaults\r\n        options = Object.assign({ visible: this.visible }, options);\r\n        const { current, anchor, opacity, visible, graphics, offset, copyGraphics, onPreDraw, onPostDraw } = options;\r\n        this._graphics = graphics || {};\r\n        this.offset = offset !== null && offset !== void 0 ? offset : this.offset;\r\n        this.opacity = opacity !== null && opacity !== void 0 ? opacity : this.opacity;\r\n        this.anchor = anchor !== null && anchor !== void 0 ? anchor : this.anchor;\r\n        this.copyGraphics = copyGraphics !== null && copyGraphics !== void 0 ? copyGraphics : this.copyGraphics;\r\n        this.onPreDraw = onPreDraw !== null && onPreDraw !== void 0 ? onPreDraw : this.onPreDraw;\r\n        this.onPostDraw = onPostDraw !== null && onPostDraw !== void 0 ? onPostDraw : this.onPostDraw;\r\n        this.visible = !!visible;\r\n        this.layers = new GraphicsLayers(this);\r\n        if (current && this._graphics[current]) {\r\n            this.show(this._graphics[current]);\r\n        }\r\n    }\r\n    getGraphic(name) {\r\n        return this._graphics[name];\r\n    }\r\n    /**\r\n     * Get registered graphics names\r\n     */\r\n    getNames() {\r\n        return Object.keys(this._graphics);\r\n    }\r\n    /**\r\n     * Returns the currently displayed graphics and their offsets, empty array if hidden\r\n     */\r\n    get current() {\r\n        return this.layers.default.graphics;\r\n    }\r\n    /**\r\n     * Returns all graphics associated with this component\r\n     */\r\n    get graphics() {\r\n        return this._graphics;\r\n    }\r\n    add(nameOrGraphic, graphic) {\r\n        let name = 'default';\r\n        let graphicToSet = null;\r\n        if (typeof nameOrGraphic === 'string') {\r\n            name = nameOrGraphic;\r\n            graphicToSet = graphic;\r\n        }\r\n        else {\r\n            graphicToSet = nameOrGraphic;\r\n        }\r\n        this._graphics[name] = this.copyGraphics ? graphicToSet.clone() : graphicToSet;\r\n        if (name === 'default') {\r\n            this.show('default');\r\n        }\r\n        return graphicToSet;\r\n    }\r\n    /**\r\n     * Show a graphic by name on the **default** layer, returns the new [[Graphic]]\r\n     */\r\n    show(nameOrGraphic, options) {\r\n        return this.layers.default.show(nameOrGraphic, options);\r\n    }\r\n    /**\r\n     * Use a graphic only, swap out any graphics on the **default** layer, returns the new [[Graphic]]\r\n     * @param nameOrGraphic\r\n     * @param options\r\n     */\r\n    use(nameOrGraphic, options) {\r\n        return this.layers.default.use(nameOrGraphic, options);\r\n    }\r\n    hide(nameOrGraphic) {\r\n        this.layers.default.hide(nameOrGraphic);\r\n    }\r\n    set localBounds(bounds) {\r\n        this._bounds = bounds;\r\n    }\r\n    get localBounds() {\r\n        if (this._bounds) {\r\n            return this._bounds;\r\n        }\r\n        let bb = new BoundingBox();\r\n        for (const layer of this.layers.get()) {\r\n            for (const { graphic, options } of layer.graphics) {\r\n                let anchor = this.anchor;\r\n                let offset = this.offset;\r\n                if (options === null || options === void 0 ? void 0 : options.anchor) {\r\n                    anchor = options.anchor;\r\n                }\r\n                if (options === null || options === void 0 ? void 0 : options.offset) {\r\n                    offset = options.offset;\r\n                }\r\n                const bounds = graphic.localBounds;\r\n                const offsetX = -bounds.width * graphic.scale.x * anchor.x + offset.x;\r\n                const offsetY = -bounds.height * graphic.scale.y * anchor.y + offset.y;\r\n                bb = graphic === null || graphic === void 0 ? void 0 : graphic.localBounds.translate(vec(offsetX + layer.offset.x, offsetY + layer.offset.y)).combine(bb);\r\n            }\r\n        }\r\n        return bb;\r\n    }\r\n    /**\r\n     * Update underlying graphics if necesary, called internally\r\n     * @param elapsed\r\n     * @internal\r\n     */\r\n    update(elapsed, idempotencyToken = 0) {\r\n        for (const layer of this.layers.get()) {\r\n            for (const { graphic } of layer.graphics) {\r\n                if (hasGraphicsTick(graphic)) {\r\n                    graphic === null || graphic === void 0 ? void 0 : graphic.tick(elapsed, idempotencyToken);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Rectangle.ts\n\r\n/**\r\n * A Rectangle [[Graphic]] for drawing rectangles to the [[ExcaliburGraphicsContext]]\r\n */\r\nclass Rectangle extends Raster {\r\n    constructor(options) {\r\n        super(options);\r\n        this.width = options.width;\r\n        this.height = options.height;\r\n        this.rasterize();\r\n    }\r\n    clone() {\r\n        return new Rectangle(Object.assign(Object.assign({ width: this.width, height: this.height }, this.cloneGraphicOptions()), this.cloneRasterOptions()));\r\n    }\r\n    execute(ctx) {\r\n        if (this.color) {\r\n            ctx.fillRect(0, 0, this.width, this.height);\r\n        }\r\n        if (this.strokeColor) {\r\n            ctx.strokeRect(0, 0, this.width, this.height);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Circle.ts\n\r\n/**\r\n * A circle [[Graphic]] for drawing circles to the [[ExcaliburGraphicsContext]]\r\n */\r\nclass Circle extends Raster {\r\n    constructor(options) {\r\n        var _a;\r\n        super(options);\r\n        this._radius = 0;\r\n        this.padding = (_a = options.padding) !== null && _a !== void 0 ? _a : 2; // default 2 padding for circles looks nice\r\n        this.radius = options.radius;\r\n        this.rasterize();\r\n    }\r\n    get radius() {\r\n        return this._radius;\r\n    }\r\n    set radius(value) {\r\n        this._radius = value;\r\n        this.width = this._radius * 2;\r\n        this.height = this._radius * 2;\r\n        this.flagDirty();\r\n    }\r\n    clone() {\r\n        return new Circle(Object.assign(Object.assign({ radius: this.radius }, this.cloneGraphicOptions()), this.cloneRasterOptions()));\r\n    }\r\n    execute(ctx) {\r\n        if (this.radius > 0) {\r\n            ctx.beginPath();\r\n            ctx.arc(this.radius, this.radius, this.radius, 0, Math.PI * 2);\r\n            if (this.color) {\r\n                ctx.fill();\r\n            }\r\n            if (this.strokeColor) {\r\n                ctx.stroke();\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/EasingFunctions.ts\nvar EasingFunctions_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\n\r\n/**\r\n * Standard easing functions for motion in Excalibur, defined on a domain of [0, duration] and a range from [+startValue,+endValue]\r\n * Given a time, the function will return a value from positive startValue to positive endValue.\r\n *\r\n * ```js\r\n * function Linear (t) {\r\n *    return t * t;\r\n * }\r\n *\r\n * // accelerating from zero velocity\r\n * function EaseInQuad (t) {\r\n *    return t * t;\r\n * }\r\n *\r\n * // decelerating to zero velocity\r\n * function EaseOutQuad (t) {\r\n *    return t * (2 - t);\r\n * }\r\n *\r\n * // acceleration until halfway, then deceleration\r\n * function EaseInOutQuad (t) {\r\n *    return t < .5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\r\n * }\r\n *\r\n * // accelerating from zero velocity\r\n * function EaseInCubic (t) {\r\n *    return t * t * t;\r\n * }\r\n *\r\n * // decelerating to zero velocity\r\n * function EaseOutCubic (t) {\r\n *    return (--t) * t * t + 1;\r\n * }\r\n *\r\n * // acceleration until halfway, then deceleration\r\n * function EaseInOutCubic (t) {\r\n *    return t < .5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1;\r\n * }\r\n * ```\r\n */\r\nclass EasingFunctions {\r\n    static CreateReversibleEasingFunction(easing) {\r\n        return (time, start, end, duration) => {\r\n            if (end < start) {\r\n                return start - (easing(time, end, start, duration) - end);\r\n            }\r\n            else {\r\n                return easing(time, start, end, duration);\r\n            }\r\n        };\r\n    }\r\n    static CreateReversableEasingFunction(easing) {\r\n        return EasingFunctions.CreateReversibleEasingFunction(easing);\r\n    }\r\n    static CreateVectorEasingFunction(easing) {\r\n        return (time, start, end, duration) => {\r\n            return new Vector(easing(time, start.x, end.x, duration), easing(time, start.y, end.y, duration));\r\n        };\r\n    }\r\n}\r\nEasingFunctions.Linear = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\r\n    endValue = endValue - startValue;\r\n    return (endValue * currentTime) / duration + startValue;\r\n});\r\nEasingFunctions.EaseInQuad = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\r\n    endValue = endValue - startValue;\r\n    currentTime /= duration;\r\n    return endValue * currentTime * currentTime + startValue;\r\n});\r\nEasingFunctions.EaseOutQuad = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\r\n    endValue = endValue - startValue;\r\n    currentTime /= duration;\r\n    return -endValue * currentTime * (currentTime - 2) + startValue;\r\n});\r\nEasingFunctions.EaseInOutQuad = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\r\n    endValue = endValue - startValue;\r\n    currentTime /= duration / 2;\r\n    if (currentTime < 1) {\r\n        return (endValue / 2) * currentTime * currentTime + startValue;\r\n    }\r\n    currentTime--;\r\n    return (-endValue / 2) * (currentTime * (currentTime - 2) - 1) + startValue;\r\n});\r\nEasingFunctions.EaseInCubic = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\r\n    endValue = endValue - startValue;\r\n    currentTime /= duration;\r\n    return endValue * currentTime * currentTime * currentTime + startValue;\r\n});\r\nEasingFunctions.EaseOutCubic = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\r\n    endValue = endValue - startValue;\r\n    currentTime /= duration;\r\n    currentTime--;\r\n    return endValue * (currentTime * currentTime * currentTime + 1) + startValue;\r\n});\r\nEasingFunctions.EaseInOutCubic = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\r\n    endValue = endValue - startValue;\r\n    currentTime /= duration / 2;\r\n    if (currentTime < 1) {\r\n        return (endValue / 2) * currentTime * currentTime * currentTime + startValue;\r\n    }\r\n    currentTime -= 2;\r\n    return (endValue / 2) * (currentTime * currentTime * currentTime + 2) + startValue;\r\n});\r\nEasingFunctions_decorate([\r\n    obsolete({\r\n        message: 'Alias for incorrect spelling used in older versions, will be removed in v0.25.0',\r\n        alternateMethod: 'CreateReversibleEasingFunction'\r\n    })\r\n], EasingFunctions, \"CreateReversableEasingFunction\", null);\r\n\n;// CONCATENATED MODULE: ./Actions/ActionQueue.ts\n/**\r\n * Action Queues represent an ordered sequence of actions\r\n *\r\n * Action queues are part of the [[ActionContext|Action API]] and\r\n * store the list of actions to be executed for an [[Actor]].\r\n *\r\n * Actors implement [[Actor.actions]] which can be manipulated by\r\n * advanced users to adjust the actions currently being executed in the\r\n * queue.\r\n */\r\nclass ActionQueue {\r\n    constructor(entity) {\r\n        this._actions = [];\r\n        this._completedActions = [];\r\n        this._entity = entity;\r\n    }\r\n    /**\r\n     * Add an action to the sequence\r\n     * @param action\r\n     */\r\n    add(action) {\r\n        this._actions.push(action);\r\n    }\r\n    /**\r\n     * Remove an action by reference from the sequence\r\n     * @param action\r\n     */\r\n    remove(action) {\r\n        const index = this._actions.indexOf(action);\r\n        this._actions.splice(index, 1);\r\n    }\r\n    /**\r\n     * Removes all actions from this sequence\r\n     */\r\n    clearActions() {\r\n        this._actions.length = 0;\r\n        this._completedActions.length = 0;\r\n        if (this._currentAction) {\r\n            this._currentAction.stop();\r\n        }\r\n    }\r\n    /**\r\n     *\r\n     * @returns The total list of actions in this sequence complete or not\r\n     */\r\n    getActions() {\r\n        return this._actions.concat(this._completedActions);\r\n    }\r\n    /**\r\n     *\r\n     * @returns `true` if there are more actions to process in the sequence\r\n     */\r\n    hasNext() {\r\n        return this._actions.length > 0;\r\n    }\r\n    /**\r\n     * @returns `true` if the current sequence of actions is done\r\n     */\r\n    isComplete() {\r\n        return this._actions.length === 0;\r\n    }\r\n    /**\r\n     * Resets the sequence of actions, this is used to restart a sequence from the beginning\r\n     */\r\n    reset() {\r\n        this._actions = this.getActions();\r\n        const len = this._actions.length;\r\n        for (let i = 0; i < len; i++) {\r\n            this._actions[i].reset();\r\n        }\r\n        this._completedActions = [];\r\n    }\r\n    /**\r\n     * Update the queue which updates actions and handles completing actions\r\n     * @param elapsedMs\r\n     */\r\n    update(elapsedMs) {\r\n        if (this._actions.length > 0) {\r\n            this._currentAction = this._actions[0];\r\n            this._currentAction.update(elapsedMs);\r\n            if (this._currentAction.isComplete(this._entity)) {\r\n                this._completedActions.push(this._actions.shift());\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/Repeat.ts\n\r\nclass Repeat {\r\n    constructor(entity, repeatBuilder, repeat) {\r\n        this._stopped = false;\r\n        this._repeatBuilder = repeatBuilder;\r\n        this._repeatContext = new ActionContext(entity);\r\n        this._actionQueue = this._repeatContext.getQueue();\r\n        this._repeat = repeat;\r\n        this._originalRepeat = repeat;\r\n        this._repeatBuilder(this._repeatContext);\r\n        this._repeat--; // current execution is the first repeat\r\n    }\r\n    update(delta) {\r\n        if (this._actionQueue.isComplete()) {\r\n            this._actionQueue.clearActions();\r\n            this._repeatBuilder(this._repeatContext);\r\n            this._repeat--;\r\n        }\r\n        this._actionQueue.update(delta);\r\n    }\r\n    isComplete() {\r\n        return this._stopped || (this._repeat <= 0 && this._actionQueue.isComplete());\r\n    }\r\n    stop() {\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._repeat = this._originalRepeat;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/RepeatForever.ts\n\r\n/**\r\n * RepeatForever Action implementation, it is recommended you use the fluent action\r\n * context API.\r\n *\r\n *\r\n */\r\nclass RepeatForever {\r\n    constructor(entity, repeatBuilder) {\r\n        this._stopped = false;\r\n        this._repeatBuilder = repeatBuilder;\r\n        this._repeatContext = new ActionContext(entity);\r\n        this._actionQueue = this._repeatContext.getQueue();\r\n        this._repeatBuilder(this._repeatContext);\r\n    }\r\n    update(delta) {\r\n        if (this._stopped) {\r\n            return;\r\n        }\r\n        if (this._actionQueue.isComplete()) {\r\n            this._actionQueue.clearActions();\r\n            this._repeatBuilder(this._repeatContext);\r\n        }\r\n        this._actionQueue.update(delta);\r\n    }\r\n    isComplete() {\r\n        return this._stopped;\r\n    }\r\n    stop() {\r\n        this._stopped = true;\r\n        this._actionQueue.clearActions();\r\n    }\r\n    reset() {\r\n        return;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/MoveBy.ts\n\r\n\r\n\r\n\r\nclass MoveBy {\r\n    constructor(entity, offsetX, offsetY, speed) {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._entity = entity;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._speed = speed;\r\n        this._offset = new Vector(offsetX, offsetY);\r\n        if (speed <= 0) {\r\n            Logger.getInstance().error('Attempted to moveBy with speed less than or equal to zero : ' + speed);\r\n            throw new Error('Speed must be greater than 0 pixels per second');\r\n        }\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._start = new Vector(this._tx.pos.x, this._tx.pos.y);\r\n            this._end = this._start.add(this._offset);\r\n            this._distance = this._offset.size;\r\n            this._dir = this._end.sub(this._start).normalize();\r\n        }\r\n        if (this.isComplete(this._entity)) {\r\n            this._tx.pos = vec(this._end.x, this._end.y);\r\n            this._motion.vel = vec(0, 0);\r\n        }\r\n        else {\r\n            this._motion.vel = this._dir.scale(this._speed);\r\n        }\r\n    }\r\n    isComplete(entity) {\r\n        const tx = entity.get(TransformComponent);\r\n        return this._stopped || tx.pos.distance(this._start) >= this._distance;\r\n    }\r\n    stop() {\r\n        this._motion.vel = vec(0, 0);\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/MoveTo.ts\n\r\n\r\n\r\nclass MoveTo {\r\n    constructor(entity, destx, desty, speed) {\r\n        this.entity = entity;\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._end = new Vector(destx, desty);\r\n        this._speed = speed;\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._start = new Vector(this._tx.pos.x, this._tx.pos.y);\r\n            this._distance = this._start.distance(this._end);\r\n            this._dir = this._end.sub(this._start).normalize();\r\n        }\r\n        const m = this._dir.scale(this._speed);\r\n        this._motion.vel = vec(m.x, m.y);\r\n        if (this.isComplete(this.entity)) {\r\n            this._tx.pos = vec(this._end.x, this._end.y);\r\n            this._motion.vel = vec(0, 0);\r\n        }\r\n    }\r\n    isComplete(entity) {\r\n        const tx = entity.get(TransformComponent);\r\n        return this._stopped || new Vector(tx.pos.x, tx.pos.y).distance(this._start) >= this._distance;\r\n    }\r\n    stop() {\r\n        this._motion.vel = vec(0, 0);\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/RotationType.ts\n/**\r\n * An enum that describes the strategies that rotation actions can use\r\n */\r\nvar RotationType;\r\n(function (RotationType) {\r\n    /**\r\n     * Rotation via `ShortestPath` will use the smallest angle\r\n     * between the starting and ending points. This strategy is the default behavior.\r\n     */\r\n    RotationType[RotationType[\"ShortestPath\"] = 0] = \"ShortestPath\";\r\n    /**\r\n     * Rotation via `LongestPath` will use the largest angle\r\n     * between the starting and ending points.\r\n     */\r\n    RotationType[RotationType[\"LongestPath\"] = 1] = \"LongestPath\";\r\n    /**\r\n     * Rotation via `Clockwise` will travel in a clockwise direction,\r\n     * regardless of the starting and ending points.\r\n     */\r\n    RotationType[RotationType[\"Clockwise\"] = 2] = \"Clockwise\";\r\n    /**\r\n     * Rotation via `CounterClockwise` will travel in a counterclockwise direction,\r\n     * regardless of the starting and ending points.\r\n     */\r\n    RotationType[RotationType[\"CounterClockwise\"] = 3] = \"CounterClockwise\";\r\n})(RotationType || (RotationType = {}));\r\n\n;// CONCATENATED MODULE: ./Actions/Action/RotateTo.ts\n\r\n\r\n\r\n\r\nclass RotateTo {\r\n    constructor(entity, angleRadians, speed, rotationType) {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._end = angleRadians;\r\n        this._speed = speed;\r\n        this._rotationType = rotationType || RotationType.ShortestPath;\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._start = this._tx.rotation;\r\n            this._currentNonCannonAngle = this._tx.rotation;\r\n            const distance1 = Math.abs(this._end - this._start);\r\n            const distance2 = TwoPI - distance1;\r\n            if (distance1 > distance2) {\r\n                this._shortDistance = distance2;\r\n                this._longDistance = distance1;\r\n            }\r\n            else {\r\n                this._shortDistance = distance1;\r\n                this._longDistance = distance2;\r\n            }\r\n            this._shortestPathIsPositive = (this._start - this._end + TwoPI) % TwoPI >= Math.PI;\r\n            switch (this._rotationType) {\r\n                case RotationType.ShortestPath:\r\n                    this._distance = this._shortDistance;\r\n                    if (this._shortestPathIsPositive) {\r\n                        this._direction = 1;\r\n                    }\r\n                    else {\r\n                        this._direction = -1;\r\n                    }\r\n                    break;\r\n                case RotationType.LongestPath:\r\n                    this._distance = this._longDistance;\r\n                    if (this._shortestPathIsPositive) {\r\n                        this._direction = -1;\r\n                    }\r\n                    else {\r\n                        this._direction = 1;\r\n                    }\r\n                    break;\r\n                case RotationType.Clockwise:\r\n                    this._direction = 1;\r\n                    if (this._shortestPathIsPositive) {\r\n                        this._distance = this._shortDistance;\r\n                    }\r\n                    else {\r\n                        this._distance = this._longDistance;\r\n                    }\r\n                    break;\r\n                case RotationType.CounterClockwise:\r\n                    this._direction = -1;\r\n                    if (!this._shortestPathIsPositive) {\r\n                        this._distance = this._shortDistance;\r\n                    }\r\n                    else {\r\n                        this._distance = this._longDistance;\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n        this._motion.angularVelocity = this._direction * this._speed;\r\n        this._currentNonCannonAngle += this._direction * this._speed * (_delta / 1000);\r\n        if (this.isComplete()) {\r\n            this._tx.rotation = this._end;\r\n            this._motion.angularVelocity = 0;\r\n            this._stopped = true;\r\n        }\r\n    }\r\n    isComplete() {\r\n        const distanceTravelled = Math.abs(this._currentNonCannonAngle - this._start);\r\n        return this._stopped || distanceTravelled >= Math.abs(this._distance);\r\n    }\r\n    stop() {\r\n        this._motion.angularVelocity = 0;\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/RotateBy.ts\n\r\n\r\n\r\n\r\nclass RotateBy {\r\n    constructor(entity, angleRadiansOffset, speed, rotationType) {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._speed = speed;\r\n        this._offset = angleRadiansOffset;\r\n        this._rotationType = rotationType || RotationType.ShortestPath;\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._start = this._tx.rotation;\r\n            this._currentNonCannonAngle = this._tx.rotation;\r\n            this._end = this._start + this._offset;\r\n            const distance1 = Math.abs(this._end - this._start);\r\n            const distance2 = TwoPI - distance1;\r\n            if (distance1 > distance2) {\r\n                this._shortDistance = distance2;\r\n                this._longDistance = distance1;\r\n            }\r\n            else {\r\n                this._shortDistance = distance1;\r\n                this._longDistance = distance2;\r\n            }\r\n            this._shortestPathIsPositive = (this._start - this._end + TwoPI) % TwoPI >= Math.PI;\r\n            switch (this._rotationType) {\r\n                case RotationType.ShortestPath:\r\n                    this._distance = this._shortDistance;\r\n                    if (this._shortestPathIsPositive) {\r\n                        this._direction = 1;\r\n                    }\r\n                    else {\r\n                        this._direction = -1;\r\n                    }\r\n                    break;\r\n                case RotationType.LongestPath:\r\n                    this._distance = this._longDistance;\r\n                    if (this._shortestPathIsPositive) {\r\n                        this._direction = -1;\r\n                    }\r\n                    else {\r\n                        this._direction = 1;\r\n                    }\r\n                    break;\r\n                case RotationType.Clockwise:\r\n                    this._direction = 1;\r\n                    if (this._shortDistance >= 0) {\r\n                        this._distance = this._shortDistance;\r\n                    }\r\n                    else {\r\n                        this._distance = this._longDistance;\r\n                    }\r\n                    break;\r\n                case RotationType.CounterClockwise:\r\n                    this._direction = -1;\r\n                    if (this._shortDistance <= 0) {\r\n                        this._distance = this._shortDistance;\r\n                    }\r\n                    else {\r\n                        this._distance = this._longDistance;\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n        this._motion.angularVelocity = this._direction * this._speed;\r\n        this._currentNonCannonAngle += this._direction * this._speed * (_delta / 1000);\r\n        if (this.isComplete()) {\r\n            this._tx.rotation = this._end;\r\n            this._motion.angularVelocity = 0;\r\n            this._stopped = true;\r\n        }\r\n    }\r\n    isComplete() {\r\n        const distanceTravelled = Math.abs(this._currentNonCannonAngle - this._start);\r\n        return this._stopped || distanceTravelled >= Math.abs(this._distance);\r\n    }\r\n    stop() {\r\n        this._motion.angularVelocity = 0;\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/ScaleTo.ts\n\r\n\r\n\r\nclass ScaleTo {\r\n    constructor(entity, scaleX, scaleY, speedX, speedY) {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._endX = scaleX;\r\n        this._endY = scaleY;\r\n        this._speedX = speedX;\r\n        this._speedY = speedY;\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._startX = this._tx.scale.x;\r\n            this._startY = this._tx.scale.y;\r\n            this._distanceX = Math.abs(this._endX - this._startX);\r\n            this._distanceY = Math.abs(this._endY - this._startY);\r\n        }\r\n        if (!(Math.abs(this._tx.scale.x - this._startX) >= this._distanceX)) {\r\n            const directionX = this._endY < this._startY ? -1 : 1;\r\n            this._motion.scaleFactor.x = this._speedX * directionX;\r\n        }\r\n        else {\r\n            this._motion.scaleFactor.x = 0;\r\n        }\r\n        if (!(Math.abs(this._tx.scale.y - this._startY) >= this._distanceY)) {\r\n            const directionY = this._endY < this._startY ? -1 : 1;\r\n            this._motion.scaleFactor.y = this._speedY * directionY;\r\n        }\r\n        else {\r\n            this._motion.scaleFactor.y = 0;\r\n        }\r\n        if (this.isComplete()) {\r\n            this._tx.scale = vec(this._endX, this._endY);\r\n            this._motion.scaleFactor.x = 0;\r\n            this._motion.scaleFactor.y = 0;\r\n        }\r\n    }\r\n    isComplete() {\r\n        return (this._stopped ||\r\n            (Math.abs(this._tx.scale.y - this._startX) >= this._distanceX && Math.abs(this._tx.scale.y - this._startY) >= this._distanceY));\r\n    }\r\n    stop() {\r\n        this._motion.scaleFactor.x = 0;\r\n        this._motion.scaleFactor.y = 0;\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/ScaleBy.ts\n\r\n\r\n\r\nclass ScaleBy {\r\n    constructor(entity, scaleOffsetX, scaleOffsetY, speed) {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._offset = new Vector(scaleOffsetX, scaleOffsetY);\r\n        this._speedX = this._speedY = speed;\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._startScale = this._tx.scale.clone();\r\n            this._endScale = this._startScale.add(this._offset);\r\n            this._distanceX = Math.abs(this._endScale.x - this._startScale.x);\r\n            this._distanceY = Math.abs(this._endScale.y - this._startScale.y);\r\n            this._directionX = this._endScale.x < this._startScale.x ? -1 : 1;\r\n            this._directionY = this._endScale.y < this._startScale.y ? -1 : 1;\r\n        }\r\n        this._motion.scaleFactor.x = this._speedX * this._directionX;\r\n        this._motion.scaleFactor.y = this._speedY * this._directionY;\r\n        if (this.isComplete()) {\r\n            this._tx.scale = this._endScale;\r\n            this._motion.scaleFactor.x = 0;\r\n            this._motion.scaleFactor.y = 0;\r\n        }\r\n    }\r\n    isComplete() {\r\n        return (this._stopped ||\r\n            (Math.abs(this._tx.scale.x - this._startScale.x) >= this._distanceX &&\r\n                Math.abs(this._tx.scale.y - this._startScale.y) >= this._distanceY));\r\n    }\r\n    stop() {\r\n        this._motion.scaleFactor.x = 0;\r\n        this._motion.scaleFactor.y = 0;\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/CallMethod.ts\nclass CallMethod {\r\n    constructor(method) {\r\n        this._method = null;\r\n        this._hasBeenCalled = false;\r\n        this._method = method;\r\n    }\r\n    update(_delta) {\r\n        this._method();\r\n        this._hasBeenCalled = true;\r\n    }\r\n    isComplete() {\r\n        return this._hasBeenCalled;\r\n    }\r\n    reset() {\r\n        this._hasBeenCalled = false;\r\n    }\r\n    stop() {\r\n        this._hasBeenCalled = true;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/EaseTo.ts\n\r\n\r\n\r\nclass EaseTo {\r\n    constructor(entity, x, y, duration, easingFcn) {\r\n        this.easingFcn = easingFcn;\r\n        this._currentLerpTime = 0;\r\n        this._lerpDuration = 1 * 1000; // 1 second\r\n        this._lerpStart = new Vector(0, 0);\r\n        this._lerpEnd = new Vector(0, 0);\r\n        this._initialized = false;\r\n        this._stopped = false;\r\n        this._distance = 0;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._lerpDuration = duration;\r\n        this._lerpEnd = new Vector(x, y);\r\n    }\r\n    _initialize() {\r\n        this._lerpStart = new Vector(this._tx.pos.x, this._tx.pos.y);\r\n        this._currentLerpTime = 0;\r\n        this._distance = this._lerpStart.distance(this._lerpEnd);\r\n    }\r\n    update(delta) {\r\n        if (!this._initialized) {\r\n            this._initialize();\r\n            this._initialized = true;\r\n        }\r\n        // Need to update lerp time first, otherwise the first update will always be zero\r\n        this._currentLerpTime += delta;\r\n        let newX = this._tx.pos.x;\r\n        let newY = this._tx.pos.y;\r\n        if (this._currentLerpTime < this._lerpDuration) {\r\n            if (this._lerpEnd.x < this._lerpStart.x) {\r\n                newX =\r\n                    this._lerpStart.x -\r\n                        (this.easingFcn(this._currentLerpTime, this._lerpEnd.x, this._lerpStart.x, this._lerpDuration) - this._lerpEnd.x);\r\n            }\r\n            else {\r\n                newX = this.easingFcn(this._currentLerpTime, this._lerpStart.x, this._lerpEnd.x, this._lerpDuration);\r\n            }\r\n            if (this._lerpEnd.y < this._lerpStart.y) {\r\n                newY =\r\n                    this._lerpStart.y -\r\n                        (this.easingFcn(this._currentLerpTime, this._lerpEnd.y, this._lerpStart.y, this._lerpDuration) - this._lerpEnd.y);\r\n            }\r\n            else {\r\n                newY = this.easingFcn(this._currentLerpTime, this._lerpStart.y, this._lerpEnd.y, this._lerpDuration);\r\n            }\r\n            // Given the lerp position figure out the velocity in pixels per second\r\n            this._motion.vel = vec((newX - this._tx.pos.x) / (delta / 1000), (newY - this._tx.pos.y) / (delta / 1000));\r\n        }\r\n        else {\r\n            this._tx.pos = vec(this._lerpEnd.x, this._lerpEnd.y);\r\n            this._motion.vel = Vector.Zero;\r\n        }\r\n    }\r\n    isComplete(actor) {\r\n        return this._stopped || new Vector(actor.pos.x, actor.pos.y).distance(this._lerpStart) >= this._distance;\r\n    }\r\n    reset() {\r\n        this._initialized = false;\r\n    }\r\n    stop() {\r\n        this._motion.vel = vec(0, 0);\r\n        this._stopped = true;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/Blink.ts\n\r\nclass Blink {\r\n    constructor(entity, timeVisible, timeNotVisible, numBlinks = 1) {\r\n        this._timeVisible = 0;\r\n        this._timeNotVisible = 0;\r\n        this._elapsedTime = 0;\r\n        this._totalTime = 0;\r\n        this._stopped = false;\r\n        this._started = false;\r\n        this._graphics = entity.get(GraphicsComponent);\r\n        this._timeVisible = timeVisible;\r\n        this._timeNotVisible = timeNotVisible;\r\n        this._duration = (timeVisible + timeNotVisible) * numBlinks;\r\n    }\r\n    update(delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n        }\r\n        if (!this._graphics) {\r\n            return;\r\n        }\r\n        this._elapsedTime += delta;\r\n        this._totalTime += delta;\r\n        if (this._graphics.visible && this._elapsedTime >= this._timeVisible) {\r\n            this._graphics.visible = false;\r\n            this._elapsedTime = 0;\r\n        }\r\n        if (!this._graphics.visible && this._elapsedTime >= this._timeNotVisible) {\r\n            this._graphics.visible = true;\r\n            this._elapsedTime = 0;\r\n        }\r\n        if (this.isComplete()) {\r\n            this._graphics.visible = true;\r\n        }\r\n    }\r\n    isComplete() {\r\n        return this._stopped || this._totalTime >= this._duration;\r\n    }\r\n    stop() {\r\n        if (this._graphics) {\r\n            this._graphics.visible = true;\r\n        }\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n        this._elapsedTime = 0;\r\n        this._totalTime = 0;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/Fade.ts\n\r\n\r\nclass Fade {\r\n    constructor(entity, endOpacity, speed) {\r\n        this._multiplier = 1;\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._graphics = entity.get(GraphicsComponent);\r\n        this._endOpacity = endOpacity;\r\n        this._speed = speed;\r\n    }\r\n    update(delta) {\r\n        if (!this._graphics) {\r\n            return;\r\n        }\r\n        if (!this._started) {\r\n            this._started = true;\r\n            // determine direction when we start\r\n            if (this._endOpacity < this._graphics.opacity) {\r\n                this._multiplier = -1;\r\n            }\r\n            else {\r\n                this._multiplier = 1;\r\n            }\r\n        }\r\n        if (this._speed > 0) {\r\n            this._graphics.opacity += (this._multiplier *\r\n                (Math.abs(this._graphics.opacity - this._endOpacity) * delta)) / this._speed;\r\n        }\r\n        this._speed -= delta;\r\n        if (this.isComplete()) {\r\n            this._graphics.opacity = this._endOpacity;\r\n        }\r\n        Logger.getInstance().debug('[Action fade] Actor opacity:', this._graphics.opacity);\r\n    }\r\n    isComplete() {\r\n        return this._stopped || Math.abs(this._graphics.opacity - this._endOpacity) < 0.05;\r\n    }\r\n    stop() {\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/Delay.ts\nclass Delay {\r\n    constructor(delay) {\r\n        this._elapsedTime = 0;\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._delay = delay;\r\n    }\r\n    update(delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n        }\r\n        this._elapsedTime += delta;\r\n    }\r\n    isComplete() {\r\n        return this._stopped || this._elapsedTime >= this._delay;\r\n    }\r\n    stop() {\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._elapsedTime = 0;\r\n        this._started = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/Die.ts\n\r\nclass Die {\r\n    constructor(entity) {\r\n        this._stopped = false;\r\n        this._entity = entity;\r\n    }\r\n    update(_delta) {\r\n        this._entity.get(ActionsComponent).clearActions();\r\n        this._entity.kill();\r\n        this._stopped = true;\r\n    }\r\n    isComplete() {\r\n        return this._stopped;\r\n    }\r\n    stop() {\r\n        return;\r\n    }\r\n    reset() {\r\n        return;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/Follow.ts\n\r\n\r\n\r\nclass Follow {\r\n    constructor(entity, entityToFollow, followDistance) {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._followTx = entityToFollow.get(TransformComponent);\r\n        this._followMotion = entityToFollow.get(MotionComponent);\r\n        this._current = new Vector(this._tx.pos.x, this._tx.pos.y);\r\n        this._end = new Vector(this._followTx.pos.x, this._followTx.pos.y);\r\n        this._maximumDistance = followDistance !== undefined ? followDistance : this._current.distance(this._end);\r\n        this._speed = 0;\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._distanceBetween = this._current.distance(this._end);\r\n            this._dir = this._end.sub(this._current).normalize();\r\n        }\r\n        const actorToFollowSpeed = Math.sqrt(Math.pow(this._followMotion.vel.x, 2) + Math.pow(this._followMotion.vel.y, 2));\r\n        if (actorToFollowSpeed !== 0) {\r\n            this._speed = actorToFollowSpeed;\r\n        }\r\n        this._current = vec(this._tx.pos.x, this._tx.pos.y);\r\n        this._end = vec(this._followTx.pos.x, this._followTx.pos.y);\r\n        this._distanceBetween = this._current.distance(this._end);\r\n        this._dir = this._end.sub(this._current).normalize();\r\n        if (this._distanceBetween >= this._maximumDistance) {\r\n            const m = this._dir.scale(this._speed);\r\n            this._motion.vel = vec(m.x, m.y);\r\n        }\r\n        else {\r\n            this._motion.vel = vec(0, 0);\r\n        }\r\n        if (this.isComplete()) {\r\n            this._tx.pos = vec(this._end.x, this._end.y);\r\n            this._motion.vel = vec(0, 0);\r\n        }\r\n    }\r\n    stop() {\r\n        this._motion.vel = vec(0, 0);\r\n        this._stopped = true;\r\n    }\r\n    isComplete() {\r\n        // the actor following should never stop unless specified to do so\r\n        return this._stopped;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/Meet.ts\n\r\n\r\n\r\nclass Meet {\r\n    constructor(actor, actorToMeet, speed) {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._speedWasSpecified = false;\r\n        this._tx = actor.get(TransformComponent);\r\n        this._motion = actor.get(MotionComponent);\r\n        this._meetTx = actorToMeet.get(TransformComponent);\r\n        this._meetMotion = actorToMeet.get(MotionComponent);\r\n        this._current = new Vector(this._tx.pos.x, this._tx.pos.y);\r\n        this._end = new Vector(this._meetTx.pos.x, this._meetTx.pos.y);\r\n        this._speed = speed || 0;\r\n        if (speed !== undefined) {\r\n            this._speedWasSpecified = true;\r\n        }\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._distanceBetween = this._current.distance(this._end);\r\n            this._dir = this._end.sub(this._current).normalize();\r\n        }\r\n        const actorToMeetSpeed = Math.sqrt(Math.pow(this._meetMotion.vel.x, 2) + Math.pow(this._meetMotion.vel.y, 2));\r\n        if (actorToMeetSpeed !== 0 && !this._speedWasSpecified) {\r\n            this._speed = actorToMeetSpeed;\r\n        }\r\n        this._current = vec(this._tx.pos.x, this._tx.pos.y);\r\n        this._end = vec(this._meetTx.pos.x, this._meetTx.pos.y);\r\n        this._distanceBetween = this._current.distance(this._end);\r\n        this._dir = this._end.sub(this._current).normalize();\r\n        const m = this._dir.scale(this._speed);\r\n        this._motion.vel = vec(m.x, m.y);\r\n        if (this.isComplete()) {\r\n            this._tx.pos = vec(this._end.x, this._end.y);\r\n            this._motion.vel = vec(0, 0);\r\n        }\r\n    }\r\n    isComplete() {\r\n        return this._stopped || this._distanceBetween <= 1;\r\n    }\r\n    stop() {\r\n        this._motion.vel = vec(0, 0);\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/ActionContext.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * The fluent Action API allows you to perform \"actions\" on\r\n * [[Actor|Actors]] such as following, moving, rotating, and\r\n * more. You can implement your own actions by implementing\r\n * the [[Action]] interface.\r\n */\r\nclass ActionContext {\r\n    constructor(entity) {\r\n        this._entity = entity;\r\n        this._queue = new ActionQueue(entity);\r\n    }\r\n    getQueue() {\r\n        return this._queue;\r\n    }\r\n    update(elapsedMs) {\r\n        this._queue.update(elapsedMs);\r\n    }\r\n    /**\r\n     * Clears all queued actions from the Actor\r\n     */\r\n    clearActions() {\r\n        this._queue.clearActions();\r\n    }\r\n    easeTo(...args) {\r\n        var _a, _b;\r\n        let x = 0;\r\n        let y = 0;\r\n        let duration = 0;\r\n        let easingFcn = EasingFunctions.Linear;\r\n        if (args[0] instanceof Vector) {\r\n            x = args[0].x;\r\n            y = args[0].y;\r\n            duration = args[1];\r\n            easingFcn = (_a = args[2]) !== null && _a !== void 0 ? _a : easingFcn;\r\n        }\r\n        else {\r\n            x = args[0];\r\n            y = args[1];\r\n            duration = args[2];\r\n            easingFcn = (_b = args[3]) !== null && _b !== void 0 ? _b : easingFcn;\r\n        }\r\n        this._queue.add(new EaseTo(this._entity, x, y, duration, easingFcn));\r\n        return this;\r\n    }\r\n    moveTo(xOrPos, yOrSpeed, speedOrUndefined) {\r\n        let x = 0;\r\n        let y = 0;\r\n        let speed = 0;\r\n        if (xOrPos instanceof Vector) {\r\n            x = xOrPos.x;\r\n            y = xOrPos.y;\r\n            speed = yOrSpeed;\r\n        }\r\n        else {\r\n            x = xOrPos;\r\n            y = yOrSpeed;\r\n            speed = speedOrUndefined;\r\n        }\r\n        this._queue.add(new MoveTo(this._entity, x, y, speed));\r\n        return this;\r\n    }\r\n    moveBy(xOffsetOrVector, yOffsetOrSpeed, speedOrUndefined) {\r\n        let xOffset = 0;\r\n        let yOffset = 0;\r\n        let speed = 0;\r\n        if (xOffsetOrVector instanceof Vector) {\r\n            xOffset = xOffsetOrVector.x;\r\n            yOffset = xOffsetOrVector.y;\r\n            speed = yOffsetOrSpeed;\r\n        }\r\n        else {\r\n            xOffset = xOffsetOrVector;\r\n            yOffset = yOffsetOrSpeed;\r\n            speed = speedOrUndefined;\r\n        }\r\n        this._queue.add(new MoveBy(this._entity, xOffset, yOffset, speed));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will rotate an actor to the specified angle at the speed\r\n     * specified (in radians per second) and return back the actor. This\r\n     * method is part of the actor 'Action' fluent API allowing action chaining.\r\n     * @param angleRadians  The angle to rotate to in radians\r\n     * @param speed         The angular velocity of the rotation specified in radians per second\r\n     * @param rotationType  The [[RotationType]] to use for this rotation\r\n     */\r\n    rotateTo(angleRadians, speed, rotationType) {\r\n        this._queue.add(new RotateTo(this._entity, angleRadians, speed, rotationType));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will rotate an actor by the specified angle offset, from it's current rotation given a certain speed\r\n     * in radians/sec and return back the actor. This method is part\r\n     * of the actor 'Action' fluent API allowing action chaining.\r\n     * @param angleRadiansOffset  The angle to rotate to in radians relative to the current rotation\r\n     * @param speed          The speed in radians/sec the actor should rotate at\r\n     * @param rotationType  The [[RotationType]] to use for this rotation, default is shortest path\r\n     */\r\n    rotateBy(angleRadiansOffset, speed, rotationType) {\r\n        this._queue.add(new RotateBy(this._entity, angleRadiansOffset, speed, rotationType));\r\n        return this;\r\n    }\r\n    scaleTo(sizeXOrVector, sizeYOrSpeed, speedXOrUndefined, speedYOrUndefined) {\r\n        let sizeX = 1;\r\n        let sizeY = 1;\r\n        let speedX = 0;\r\n        let speedY = 0;\r\n        if (sizeXOrVector instanceof Vector && sizeYOrSpeed instanceof Vector) {\r\n            sizeX = sizeXOrVector.x;\r\n            sizeY = sizeXOrVector.y;\r\n            speedX = sizeYOrSpeed.x;\r\n            speedY = sizeYOrSpeed.y;\r\n        }\r\n        if (typeof sizeXOrVector === 'number' && typeof sizeYOrSpeed === 'number') {\r\n            sizeX = sizeXOrVector;\r\n            sizeY = sizeYOrSpeed;\r\n            speedX = speedXOrUndefined;\r\n            speedY = speedYOrUndefined;\r\n        }\r\n        this._queue.add(new ScaleTo(this._entity, sizeX, sizeY, speedX, speedY));\r\n        return this;\r\n    }\r\n    scaleBy(sizeOffsetXOrVector, sizeOffsetYOrSpeed, speed) {\r\n        let sizeOffsetX = 1;\r\n        let sizeOffsetY = 1;\r\n        if (sizeOffsetXOrVector instanceof Vector) {\r\n            sizeOffsetX = sizeOffsetXOrVector.x;\r\n            sizeOffsetY = sizeOffsetXOrVector.y;\r\n            speed = sizeOffsetYOrSpeed;\r\n        }\r\n        if (typeof sizeOffsetXOrVector === 'number' && typeof sizeOffsetYOrSpeed === 'number') {\r\n            sizeOffsetX = sizeOffsetXOrVector;\r\n            sizeOffsetY = sizeOffsetYOrSpeed;\r\n        }\r\n        this._queue.add(new ScaleBy(this._entity, sizeOffsetX, sizeOffsetY, speed));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will cause an actor to blink (become visible and not\r\n     * visible). Optionally, you may specify the number of blinks. Specify the amount of time\r\n     * the actor should be visible per blink, and the amount of time not visible.\r\n     * This method is part of the actor 'Action' fluent API allowing action chaining.\r\n     * @param timeVisible     The amount of time to stay visible per blink in milliseconds\r\n     * @param timeNotVisible  The amount of time to stay not visible per blink in milliseconds\r\n     * @param numBlinks       The number of times to blink\r\n     */\r\n    blink(timeVisible, timeNotVisible, numBlinks = 1) {\r\n        this._queue.add(new Blink(this._entity, timeVisible, timeNotVisible, numBlinks));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will cause an actor's opacity to change from its current value\r\n     * to the provided value by a specified time (in milliseconds). This method is\r\n     * part of the actor 'Action' fluent API allowing action chaining.\r\n     * @param opacity  The ending opacity\r\n     * @param time     The time it should take to fade the actor (in milliseconds)\r\n     */\r\n    fade(opacity, time) {\r\n        this._queue.add(new Fade(this._entity, opacity, time));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will delay the next action from executing for a certain\r\n     * amount of time (in milliseconds). This method is part of the actor\r\n     * 'Action' fluent API allowing action chaining.\r\n     * @param time  The amount of time to delay the next action in the queue from executing in milliseconds\r\n     */\r\n    delay(time) {\r\n        this._queue.add(new Delay(time));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will add an action to the queue that will remove the actor from the\r\n     * scene once it has completed its previous  Any actions on the\r\n     * action queue after this action will not be executed.\r\n     */\r\n    die() {\r\n        this._queue.add(new Die(this._entity));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method allows you to call an arbitrary method as the next action in the\r\n     * action queue. This is useful if you want to execute code in after a specific\r\n     * action, i.e An actor arrives at a destination after traversing a path\r\n     */\r\n    callMethod(method) {\r\n        this._queue.add(new CallMethod(method));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will cause the actor to repeat all of the actions built in\r\n     * the `repeatBuilder` callback. If the number of repeats\r\n     * is not specified it will repeat forever. This method is part of\r\n     * the actor 'Action' fluent API allowing action chaining\r\n     *\r\n     * ```typescript\r\n     * // Move up in a zig-zag by repeated moveBy's\r\n     * actor.actions.repeat(repeatCtx => {\r\n     *  repeatCtx.moveBy(10, 0, 10);\r\n     *  repeatCtx.moveBy(0, 10, 10);\r\n     * }, 5);\r\n     * ```\r\n     *\r\n     * @param repeatBuilder The builder to specify the repeatable list of actions\r\n     * @param times  The number of times to repeat all the previous actions in the action queue. If nothing is specified the actions\r\n     * will repeat forever\r\n     */\r\n    repeat(repeatBuilder, times) {\r\n        if (!times) {\r\n            this.repeatForever(repeatBuilder);\r\n            return this;\r\n        }\r\n        this._queue.add(new Repeat(this._entity, repeatBuilder, times));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will cause the actor to repeat all of the actions built in\r\n     * the `repeatBuilder` callback. If the number of repeats\r\n     * is not specified it will repeat forever. This method is part of\r\n     * the actor 'Action' fluent API allowing action chaining\r\n     *\r\n     * ```typescript\r\n     * // Move up in a zig-zag by repeated moveBy's\r\n     * actor.actions.repeat(repeatCtx => {\r\n     *  repeatCtx.moveBy(10, 0, 10);\r\n     *  repeatCtx.moveBy(0, 10, 10);\r\n     * }, 5);\r\n     * ```\r\n     *\r\n     * @param repeatBuilder The builder to specify the repeatable list of actions\r\n     */\r\n    repeatForever(repeatBuilder) {\r\n        this._queue.add(new RepeatForever(this._entity, repeatBuilder));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will cause the entity to follow another at a specified distance\r\n     * @param entity           The entity to follow\r\n     * @param followDistance  The distance to maintain when following, if not specified the actor will follow at the current distance.\r\n     */\r\n    follow(entity, followDistance) {\r\n        if (followDistance === undefined) {\r\n            this._queue.add(new Follow(this._entity, entity));\r\n        }\r\n        else {\r\n            this._queue.add(new Follow(this._entity, entity, followDistance));\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will cause the entity to move towards another until they\r\n     * collide \"meet\" at a specified speed.\r\n     * @param entity  The entity to meet\r\n     * @param speed  The speed in pixels per second to move, if not specified it will match the speed of the other actor\r\n     */\r\n    meet(entity, speed) {\r\n        if (speed === undefined) {\r\n            this._queue.add(new Meet(this._entity, entity));\r\n        }\r\n        else {\r\n            this._queue.add(new Meet(this._entity, entity, speed));\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Returns a promise that resolves when the current action queue up to now\r\n     * is finished.\r\n     * @deprecated Use `toPromise()` will be removed in v0.26.0\r\n     */\r\n    asPromise() {\r\n        return this.toPromise();\r\n    }\r\n    /**\r\n     * Returns a promise that resolves when the current action queue up to now\r\n     * is finished.\r\n     */\r\n    toPromise() {\r\n        const temp = new Promise((resolve) => {\r\n            this._queue.add(new CallMethod(() => {\r\n                resolve();\r\n            }));\r\n        });\r\n        return temp;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/ActionsComponent.ts\n\r\n\r\n\r\n\r\n;\r\nclass ActionsComponent extends Component {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.type = 'ex.actions';\r\n        this.dependencies = [TransformComponent, MotionComponent];\r\n    }\r\n    onAdd(entity) {\r\n        this._ctx = new ActionContext(entity);\r\n    }\r\n    onRemove() {\r\n        this._ctx = null;\r\n    }\r\n    /**\r\n     * Returns the internal action queue\r\n     * @returns action queu\r\n     */\r\n    getQueue() {\r\n        var _a;\r\n        return (_a = this._ctx) === null || _a === void 0 ? void 0 : _a.getQueue();\r\n    }\r\n    /**\r\n     * Updates the internal action context, performing action and moving through the internal queue\r\n     * @param elapsedMs\r\n     */\r\n    update(elapsedMs) {\r\n        var _a;\r\n        return (_a = this._ctx) === null || _a === void 0 ? void 0 : _a.update(elapsedMs);\r\n    }\r\n    /**\r\n     * Clears all queued actions from the Actor\r\n     */\r\n    clearActions() {\r\n        var _a;\r\n        (_a = this._ctx) === null || _a === void 0 ? void 0 : _a.clearActions();\r\n    }\r\n    easeTo(...args) {\r\n        return this._ctx.easeTo.apply(this._ctx, args);\r\n    }\r\n    moveTo(xOrPos, yOrSpeed, speedOrUndefined) {\r\n        return this._ctx.moveTo.apply(this._ctx, [xOrPos, yOrSpeed, speedOrUndefined]);\r\n    }\r\n    moveBy(xOffsetOrVector, yOffsetOrSpeed, speedOrUndefined) {\r\n        return this._ctx.moveBy.apply(this._ctx, [xOffsetOrVector, yOffsetOrSpeed, speedOrUndefined]);\r\n    }\r\n    /**\r\n     * This method will rotate an actor to the specified angle at the speed\r\n     * specified (in radians per second) and return back the actor. This\r\n     * method is part of the actor 'Action' fluent API allowing action chaining.\r\n     * @param angleRadians  The angle to rotate to in radians\r\n     * @param speed         The angular velocity of the rotation specified in radians per second\r\n     * @param rotationType  The [[RotationType]] to use for this rotation\r\n     */\r\n    rotateTo(angleRadians, speed, rotationType) {\r\n        return this._ctx.rotateTo(angleRadians, speed, rotationType);\r\n    }\r\n    /**\r\n     * This method will rotate an actor by the specified angle offset, from it's current rotation given a certain speed\r\n     * in radians/sec and return back the actor. This method is part\r\n     * of the actor 'Action' fluent API allowing action chaining.\r\n     * @param angleRadiansOffset  The angle to rotate to in radians relative to the current rotation\r\n     * @param speed          The speed in radians/sec the actor should rotate at\r\n     * @param rotationType  The [[RotationType]] to use for this rotation, default is shortest path\r\n     */\r\n    rotateBy(angleRadiansOffset, speed, rotationType) {\r\n        return this._ctx.rotateBy(angleRadiansOffset, speed, rotationType);\r\n    }\r\n    scaleTo(sizeXOrVector, sizeYOrSpeed, speedXOrUndefined, speedYOrUndefined) {\r\n        return this._ctx.scaleTo.apply(this._ctx, [sizeXOrVector, sizeYOrSpeed, speedXOrUndefined, speedYOrUndefined]);\r\n    }\r\n    scaleBy(sizeOffsetXOrVector, sizeOffsetYOrSpeed, speed) {\r\n        return this._ctx.scaleBy.apply(this._ctx, [sizeOffsetXOrVector, sizeOffsetYOrSpeed, speed]);\r\n    }\r\n    /**\r\n     * This method will cause an actor to blink (become visible and not\r\n     * visible). Optionally, you may specify the number of blinks. Specify the amount of time\r\n     * the actor should be visible per blink, and the amount of time not visible.\r\n     * This method is part of the actor 'Action' fluent API allowing action chaining.\r\n     * @param timeVisible     The amount of time to stay visible per blink in milliseconds\r\n     * @param timeNotVisible  The amount of time to stay not visible per blink in milliseconds\r\n     * @param numBlinks       The number of times to blink\r\n     */\r\n    blink(timeVisible, timeNotVisible, numBlinks) {\r\n        return this._ctx.blink(timeVisible, timeNotVisible, numBlinks);\r\n    }\r\n    /**\r\n     * This method will cause an actor's opacity to change from its current value\r\n     * to the provided value by a specified time (in milliseconds). This method is\r\n     * part of the actor 'Action' fluent API allowing action chaining.\r\n     * @param opacity  The ending opacity\r\n     * @param time     The time it should take to fade the actor (in milliseconds)\r\n     */\r\n    fade(opacity, time) {\r\n        return this._ctx.fade(opacity, time);\r\n    }\r\n    /**\r\n     * This method will delay the next action from executing for a certain\r\n     * amount of time (in milliseconds). This method is part of the actor\r\n     * 'Action' fluent API allowing action chaining.\r\n     * @param time  The amount of time to delay the next action in the queue from executing in milliseconds\r\n     */\r\n    delay(time) {\r\n        return this._ctx.delay(time);\r\n    }\r\n    /**\r\n     * This method will add an action to the queue that will remove the actor from the\r\n     * scene once it has completed its previous  Any actions on the\r\n     * action queue after this action will not be executed.\r\n     */\r\n    die() {\r\n        return this._ctx.die();\r\n    }\r\n    /**\r\n     * This method allows you to call an arbitrary method as the next action in the\r\n     * action queue. This is useful if you want to execute code in after a specific\r\n     * action, i.e An actor arrives at a destination after traversing a path\r\n     */\r\n    callMethod(method) {\r\n        return this._ctx.callMethod(method);\r\n    }\r\n    /**\r\n     * This method will cause the actor to repeat all of the actions built in\r\n     * the `repeatBuilder` callback. If the number of repeats\r\n     * is not specified it will repeat forever. This method is part of\r\n     * the actor 'Action' fluent API allowing action chaining\r\n     *\r\n     * ```typescript\r\n     * // Move up in a zig-zag by repeated moveBy's\r\n     * actor.actions.repeat(repeatCtx => {\r\n     *  repeatCtx.moveBy(10, 0, 10);\r\n     *  repeatCtx.moveBy(0, 10, 10);\r\n     * }, 5);\r\n     * ```\r\n     *\r\n     * @param repeatBuilder The builder to specify the repeatable list of actions\r\n     * @param times  The number of times to repeat all the previous actions in the action queue. If nothing is specified the actions\r\n     * will repeat forever\r\n     */\r\n    repeat(repeatBuilder, times) {\r\n        return this._ctx.repeat(repeatBuilder, times);\r\n    }\r\n    /**\r\n     * This method will cause the actor to repeat all of the actions built in\r\n     * the `repeatBuilder` callback. If the number of repeats\r\n     * is not specified it will repeat forever. This method is part of\r\n     * the actor 'Action' fluent API allowing action chaining\r\n     *\r\n     * ```typescript\r\n     * // Move up in a zig-zag by repeated moveBy's\r\n     * actor.actions.repeat(repeatCtx => {\r\n     *  repeatCtx.moveBy(10, 0, 10);\r\n     *  repeatCtx.moveBy(0, 10, 10);\r\n     * }, 5);\r\n     * ```\r\n     *\r\n     * @param repeatBuilder The builder to specify the repeatable list of actions\r\n     */\r\n    repeatForever(repeatBuilder) {\r\n        return this._ctx.repeatForever(repeatBuilder);\r\n    }\r\n    /**\r\n     * This method will cause the entity to follow another at a specified distance\r\n     * @param entity           The entity to follow\r\n     * @param followDistance  The distance to maintain when following, if not specified the actor will follow at the current distance.\r\n     */\r\n    follow(entity, followDistance) {\r\n        return this._ctx.follow(entity, followDistance);\r\n    }\r\n    /**\r\n     * This method will cause the entity to move towards another until they\r\n     * collide \"meet\" at a specified speed.\r\n     * @param entity  The entity to meet\r\n     * @param speed  The speed in pixels per second to move, if not specified it will match the speed of the other actor\r\n     */\r\n    meet(entity, speed) {\r\n        return this._ctx.meet(entity, speed);\r\n    }\r\n    /**\r\n     * Returns a promise that resolves when the current action queue up to now\r\n     * is finished.\r\n     * @deprecated Use `toPromise()` will be removed in v0.26.0\r\n     */\r\n    asPromise() {\r\n        return this.toPromise();\r\n    }\r\n    /**\r\n     * Returns a promise that resolves when the current action queue up to now\r\n     * is finished.\r\n     */\r\n    toPromise() {\r\n        return this._ctx.toPromise();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actor.ts\nvar Actor_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Type guard for checking if something is an Actor\r\n * @param x\r\n */\r\nfunction isActor(x) {\r\n    return x instanceof Actor;\r\n}\r\n/**\r\n * The most important primitive in Excalibur is an `Actor`. Anything that\r\n * can move on the screen, collide with another `Actor`, respond to events,\r\n * or interact with the current scene, must be an actor. An `Actor` **must**\r\n * be part of a [[Scene]] for it to be drawn to the screen.\r\n */\r\nclass Actor extends Entity {\r\n    // #endregion\r\n    /**\r\n     *\r\n     * @param config\r\n     */\r\n    constructor(config) {\r\n        super();\r\n        /**\r\n         * The anchor to apply all actor related transformations like rotation,\r\n         * translation, and scaling. By default the anchor is in the center of\r\n         * the actor. By default it is set to the center of the actor (.5, .5)\r\n         *\r\n         * An anchor of (.5, .5) will ensure that drawings are centered.\r\n         *\r\n         * Use `anchor.setTo` to set the anchor to a different point using\r\n         * values between 0 and 1. For example, anchoring to the top-left would be\r\n         * `Actor.anchor.setTo(0, 0)` and top-right would be `Actor.anchor.setTo(0, 1)`.\r\n         */\r\n        this._anchor = watch(Vector.Half, (v) => this._handleAnchorChange(v));\r\n        /**\r\n         * Convenience reference to the global logger\r\n         */\r\n        this.logger = Logger.getInstance();\r\n        /**\r\n         * The scene that the actor is in\r\n         */\r\n        this.scene = null;\r\n        this.frames = {};\r\n        /**\r\n         * Access to the current drawing for the actor, this can be\r\n         * an [[Animation]], [[Sprite]], or [[Polygon]].\r\n         * Set drawings with [[setDrawing]].\r\n         * @deprecated\r\n         */\r\n        this.currentDrawing = null;\r\n        /**\r\n         * Draggable helper\r\n         */\r\n        this._draggable = false;\r\n        this._dragging = false;\r\n        this._pointerDragStartHandler = () => {\r\n            this._dragging = true;\r\n        };\r\n        this._pointerDragEndHandler = () => {\r\n            this._dragging = false;\r\n        };\r\n        this._pointerDragMoveHandler = (pe) => {\r\n            if (this._dragging) {\r\n                this.pos = pe.pointer.lastWorldPos;\r\n            }\r\n        };\r\n        this._pointerDragLeaveHandler = (pe) => {\r\n            if (this._dragging) {\r\n                this.pos = pe.pointer.lastWorldPos;\r\n            }\r\n        };\r\n        /**\r\n         * Modify the current actor update pipeline.\r\n         */\r\n        this.traits = [];\r\n        /**\r\n         * Whether or not to enable the [[Traits.CapturePointer]] trait that propagates\r\n         * pointer events to this actor\r\n         */\r\n        this.enableCapturePointer = false;\r\n        /**\r\n         * Configuration for [[Traits.CapturePointer]] trait\r\n         */\r\n        this.capturePointer = {\r\n            captureMoveEvents: false,\r\n            captureDragEvents: false\r\n        };\r\n        // #region Events\r\n        this._capturePointerEvents = [\r\n            'pointerup',\r\n            'pointerdown',\r\n            'pointermove',\r\n            'pointerenter',\r\n            'pointerleave',\r\n            'pointerdragstart',\r\n            'pointerdragend',\r\n            'pointerdragmove',\r\n            'pointerdragenter',\r\n            'pointerdragleave'\r\n        ];\r\n        this._captureMoveEvents = [\r\n            'pointermove',\r\n            'pointerenter',\r\n            'pointerleave',\r\n            'pointerdragmove',\r\n            'pointerdragenter',\r\n            'pointerdragleave'\r\n        ];\r\n        this._captureDragEvents = [\r\n            'pointerdragstart',\r\n            'pointerdragend',\r\n            'pointerdragmove',\r\n            'pointerdragenter',\r\n            'pointerdragleave'\r\n        ];\r\n        const { name, x, y, pos, scale, width, height, radius, collider, vel, acc, rotation, angularVelocity, z, color, visible, anchor, collisionType, collisionGroup } = Object.assign({}, config);\r\n        this._setName(name);\r\n        this.anchor = anchor !== null && anchor !== void 0 ? anchor : Actor.defaults.anchor.clone();\r\n        this.addComponent(new TransformComponent());\r\n        this.pos = pos !== null && pos !== void 0 ? pos : vec(x !== null && x !== void 0 ? x : 0, y !== null && y !== void 0 ? y : 0);\r\n        this.rotation = rotation !== null && rotation !== void 0 ? rotation : 0;\r\n        this.scale = scale !== null && scale !== void 0 ? scale : vec(1, 1);\r\n        this.z = z !== null && z !== void 0 ? z : 0;\r\n        this.addComponent(new GraphicsComponent());\r\n        this.addComponent(new CanvasDrawComponent((ctx, delta) => this.draw(ctx, delta)));\r\n        this.addComponent(new MotionComponent());\r\n        this.vel = vel !== null && vel !== void 0 ? vel : Vector.Zero;\r\n        this.acc = acc !== null && acc !== void 0 ? acc : Vector.Zero;\r\n        this.angularVelocity = angularVelocity !== null && angularVelocity !== void 0 ? angularVelocity : 0;\r\n        this.addComponent(new ActionsComponent());\r\n        this.addComponent(new BodyComponent());\r\n        this.body.collisionType = collisionType !== null && collisionType !== void 0 ? collisionType : CollisionType.Passive;\r\n        if (collisionGroup) {\r\n            this.body.group = collisionGroup;\r\n        }\r\n        if (collider) {\r\n            this.addComponent(new ColliderComponent(collider));\r\n        }\r\n        else if (radius) {\r\n            this.addComponent(new ColliderComponent(Shape.Circle(radius, this.anchor)));\r\n        }\r\n        else {\r\n            if (width > 0 && height > 0) {\r\n                this.addComponent(new ColliderComponent(Shape.Box(width, height, this.anchor)));\r\n            }\r\n            else {\r\n                this.addComponent(new ColliderComponent()); // no collider\r\n            }\r\n        }\r\n        this.graphics.visible = visible !== null && visible !== void 0 ? visible : true;\r\n        if (color) {\r\n            this.color = color;\r\n            if (width && height) {\r\n                this.graphics.add(new Rectangle({\r\n                    color: color,\r\n                    width,\r\n                    height\r\n                }));\r\n            }\r\n            else if (radius) {\r\n                this.graphics.add(new Circle({\r\n                    color: color,\r\n                    radius\r\n                }));\r\n            }\r\n        }\r\n        // Build default pipeline\r\n        if (Flags.isEnabled(Legacy.LegacyDrawing)) {\r\n            // TODO remove offscreen trait after legacy drawing removed\r\n            this.traits.push(new OffscreenCulling());\r\n        }\r\n        this.traits.push(new CapturePointer());\r\n    }\r\n    /**\r\n     * The physics body the is associated with this actor. The body is the container for all physical properties, like position, velocity,\r\n     * acceleration, mass, inertia, etc.\r\n     */\r\n    get body() {\r\n        return this.get(BodyComponent);\r\n    }\r\n    /**\r\n     * Access the Actor's built in [[TransformComponent]]\r\n     */\r\n    get transform() {\r\n        return this.get(TransformComponent);\r\n    }\r\n    /**\r\n     * Access the Actor's built in [[MotionComponent]]\r\n     */\r\n    get motion() {\r\n        return this.get(MotionComponent);\r\n    }\r\n    /**\r\n     * Access to the Actor's built in [[GraphicsComponent]]\r\n     */\r\n    get graphics() {\r\n        return this.get(GraphicsComponent);\r\n    }\r\n    /**\r\n     * Access to the Actor's built in [[ColliderComponent]]\r\n     */\r\n    get collider() {\r\n        return this.get(ColliderComponent);\r\n    }\r\n    /**\r\n     * Useful for quickly scripting actor behavior, like moving to a place, patroling back and forth, blinking, etc.\r\n     *\r\n     *  Access to the Actor's built in [[ActionsComponent]] which forwards to the\r\n     * [[ActionContext|Action context]] of the actor.\r\n     */\r\n    get actions() {\r\n        return this.get(ActionsComponent);\r\n    }\r\n    /**\r\n     * Gets the position vector of the actor in pixels\r\n     */\r\n    get pos() {\r\n        return this.transform.pos;\r\n    }\r\n    /**\r\n     * Sets the position vector of the actor in pixels\r\n     */\r\n    set pos(thePos) {\r\n        this.transform.pos = thePos.clone();\r\n    }\r\n    /**\r\n     * Gets the position vector of the actor from the last frame\r\n     */\r\n    get oldPos() {\r\n        return this.body.oldPos;\r\n    }\r\n    /**\r\n     * Sets the position vector of the actor in the last frame\r\n     */\r\n    set oldPos(thePos) {\r\n        this.body.oldPos.setTo(thePos.x, thePos.y);\r\n    }\r\n    /**\r\n     * Gets the velocity vector of the actor in pixels/sec\r\n     */\r\n    get vel() {\r\n        return this.motion.vel;\r\n    }\r\n    /**\r\n     * Sets the velocity vector of the actor in pixels/sec\r\n     */\r\n    set vel(theVel) {\r\n        this.motion.vel = theVel.clone();\r\n    }\r\n    /**\r\n     * Gets the velocity vector of the actor from the last frame\r\n     */\r\n    get oldVel() {\r\n        return this.body.oldVel;\r\n    }\r\n    /**\r\n     * Sets the velocity vector of the actor from the last frame\r\n     */\r\n    set oldVel(theVel) {\r\n        this.body.oldVel.setTo(theVel.x, theVel.y);\r\n    }\r\n    /**\r\n     * Gets the acceleration vector of the actor in pixels/second/second. An acceleration pointing down such as (0, 100) may be\r\n     * useful to simulate a gravitational effect.\r\n     */\r\n    get acc() {\r\n        return this.motion.acc;\r\n    }\r\n    /**\r\n     * Sets the acceleration vector of teh actor in pixels/second/second\r\n     */\r\n    set acc(theAcc) {\r\n        this.motion.acc = theAcc.clone();\r\n    }\r\n    /**\r\n     * Sets the acceleration of the actor from the last frame. This does not include the global acc [[Physics.acc]].\r\n     */\r\n    set oldAcc(theAcc) {\r\n        this.body.oldAcc.setTo(theAcc.x, theAcc.y);\r\n    }\r\n    /**\r\n     * Gets the acceleration of the actor from the last frame. This does not include the global acc [[Physics.acc]].\r\n     */\r\n    get oldAcc() {\r\n        return this.body.oldAcc;\r\n    }\r\n    /**\r\n     * Gets the rotation of the actor in radians. 1 radian = 180/PI Degrees.\r\n     */\r\n    get rotation() {\r\n        return this.transform.rotation;\r\n    }\r\n    /**\r\n     * Sets the rotation of the actor in radians. 1 radian = 180/PI Degrees.\r\n     */\r\n    set rotation(theAngle) {\r\n        this.transform.rotation = theAngle;\r\n    }\r\n    /**\r\n     * Gets the rotational velocity of the actor in radians/second\r\n     */\r\n    get angularVelocity() {\r\n        return this.motion.angularVelocity;\r\n    }\r\n    /**\r\n     * Sets the rotational velocity of the actor in radians/sec\r\n     */\r\n    set angularVelocity(angularVelocity) {\r\n        this.motion.angularVelocity = angularVelocity;\r\n    }\r\n    get scale() {\r\n        return this.get(TransformComponent).scale;\r\n    }\r\n    set scale(scale) {\r\n        this.get(TransformComponent).scale = scale;\r\n    }\r\n    get anchor() {\r\n        return this._anchor;\r\n    }\r\n    set anchor(vec) {\r\n        this._anchor = watch(vec, (v) => this._handleAnchorChange(v));\r\n        this._handleAnchorChange(vec);\r\n    }\r\n    _handleAnchorChange(v) {\r\n        if (this.graphics) {\r\n            this.graphics.anchor = v;\r\n        }\r\n    }\r\n    /**\r\n     * Indicates whether the actor is physically in the viewport\r\n     */\r\n    get isOffScreen() {\r\n        return this.hasTag('offscreen');\r\n    }\r\n    /**\r\n     * The visibility of an actor\r\n     * @deprecated Use [[GraphicsComponent.visible|Actor.graphics.visible]], will be removed in v0.26.0\r\n     */\r\n    get visible() {\r\n        return this.graphics.visible;\r\n    }\r\n    set visible(isVisible) {\r\n        this.graphics.visible = isVisible;\r\n    }\r\n    /**\r\n     * The opacity of an actor.\r\n     *\r\n     * @deprecated Actor.opacity will be removed in v0.26.0, use [[GraphicsComponent.opacity|Actor.graphics.opacity]].\r\n     */\r\n    get opacity() {\r\n        return this.graphics.opacity;\r\n    }\r\n    set opacity(opacity) {\r\n        this.graphics.opacity = opacity;\r\n    }\r\n    get draggable() {\r\n        return this._draggable;\r\n    }\r\n    set draggable(isDraggable) {\r\n        if (isDraggable) {\r\n            if (isDraggable && !this._draggable) {\r\n                this.on('pointerdragstart', this._pointerDragStartHandler);\r\n                this.on('pointerdragend', this._pointerDragEndHandler);\r\n                this.on('pointerdragmove', this._pointerDragMoveHandler);\r\n                this.on('pointerdragleave', this._pointerDragLeaveHandler);\r\n            }\r\n            else if (!isDraggable && this._draggable) {\r\n                this.off('pointerdragstart', this._pointerDragStartHandler);\r\n                this.off('pointerdragend', this._pointerDragEndHandler);\r\n                this.off('pointerdragmove', this._pointerDragMoveHandler);\r\n                this.off('pointerdragleave', this._pointerDragLeaveHandler);\r\n            }\r\n            this._draggable = isDraggable;\r\n        }\r\n    }\r\n    /**\r\n     * Sets the color of the actor. A rectangle of this color will be\r\n     * drawn if no [[Drawable]] is specified as the actors drawing.\r\n     *\r\n     * The default is `null` which prevents a rectangle from being drawn.\r\n     */\r\n    get color() {\r\n        return this._color;\r\n    }\r\n    set color(v) {\r\n        this._color = v.clone();\r\n    }\r\n    /**\r\n     * `onInitialize` is called before the first update of the actor. This method is meant to be\r\n     * overridden. This is where initialization of child actors should take place.\r\n     *\r\n     * Synonymous with the event handler `.on('initialize', (evt) => {...})`\r\n     */\r\n    onInitialize(_engine) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * Initializes this actor and all it's child actors, meant to be called by the Scene before first update not by users of Excalibur.\r\n     *\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * @internal\r\n     */\r\n    _initialize(engine) {\r\n        super._initialize(engine);\r\n        for (const child of this.children) {\r\n            child._initialize(engine);\r\n        }\r\n    }\r\n    _checkForPointerOptIn(eventName) {\r\n        if (eventName) {\r\n            const normalized = eventName.toLowerCase();\r\n            if (this._capturePointerEvents.indexOf(normalized) !== -1) {\r\n                this.enableCapturePointer = true;\r\n                if (this._captureMoveEvents.indexOf(normalized) !== -1) {\r\n                    this.capturePointer.captureMoveEvents = true;\r\n                }\r\n                if (this._captureDragEvents.indexOf(normalized) !== -1) {\r\n                    this.capturePointer.captureDragEvents = true;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    on(eventName, handler) {\r\n        this._checkForPointerOptIn(eventName);\r\n        super.on(eventName, handler);\r\n    }\r\n    once(eventName, handler) {\r\n        this._checkForPointerOptIn(eventName);\r\n        super.once(eventName, handler);\r\n    }\r\n    off(eventName, handler) {\r\n        super.off(eventName, handler);\r\n    }\r\n    // #endregion\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _prekill handler for [[onPreKill]] lifecycle event\r\n     * @internal\r\n     */\r\n    _prekill(_scene) {\r\n        super.emit('prekill', new PreKillEvent(this));\r\n        this.onPreKill(_scene);\r\n    }\r\n    /**\r\n     * Safe to override onPreKill lifecycle event handler. Synonymous with `.on('prekill', (evt) =>{...})`\r\n     *\r\n     * `onPreKill` is called directly before an actor is killed and removed from its current [[Scene]].\r\n     */\r\n    onPreKill(_scene) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _prekill handler for [[onPostKill]] lifecycle event\r\n     * @internal\r\n     */\r\n    _postkill(_scene) {\r\n        super.emit('postkill', new PostKillEvent(this));\r\n        this.onPostKill(_scene);\r\n    }\r\n    /**\r\n     * Safe to override onPostKill lifecycle event handler. Synonymous with `.on('postkill', (evt) => {...})`\r\n     *\r\n     * `onPostKill` is called directly after an actor is killed and remove from its current [[Scene]].\r\n     */\r\n    onPostKill(_scene) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * If the current actor is a member of the scene, this will remove\r\n     * it from the scene graph. It will no longer be drawn or updated.\r\n     */\r\n    kill() {\r\n        if (this.scene) {\r\n            this._prekill(this.scene);\r\n            this.emit('kill', new KillEvent(this));\r\n            super.kill();\r\n            this._postkill(this.scene);\r\n        }\r\n        else {\r\n            this.logger.warn('Cannot kill actor, it was never added to the Scene');\r\n        }\r\n    }\r\n    /**\r\n     * If the current actor is killed, it will now not be killed.\r\n     */\r\n    unkill() {\r\n        this.active = true;\r\n    }\r\n    /**\r\n     * Indicates wether the actor has been killed.\r\n     */\r\n    isKilled() {\r\n        return !this.active;\r\n    }\r\n    setDrawing(key) {\r\n        key = key.toString();\r\n        if (this.currentDrawing !== this.frames[key]) {\r\n            if (this.frames[key] != null) {\r\n                this.frames[key].reset();\r\n                this.currentDrawing = this.frames[key];\r\n            }\r\n            else {\r\n                Logger.getInstance().error(`the specified drawing key ${key} does not exist`);\r\n            }\r\n        }\r\n        if (this.currentDrawing && this.currentDrawing instanceof Animation_Animation) {\r\n            this.currentDrawing.tick(0);\r\n        }\r\n    }\r\n    addDrawing() {\r\n        if (arguments.length === 2) {\r\n            this.frames[arguments[0]] = arguments[1];\r\n            if (!this.currentDrawing) {\r\n                this.currentDrawing = arguments[1];\r\n            }\r\n        }\r\n        else {\r\n            if (arguments[0] instanceof Sprite_Sprite) {\r\n                this.addDrawing('default', arguments[0]);\r\n            }\r\n            if (arguments[0] instanceof Texture) {\r\n                this.addDrawing('default', arguments[0].asSprite());\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Gets the z-index of an actor. The z-index determines the relative order an actor is drawn in.\r\n     * Actors with a higher z-index are drawn on top of actors with a lower z-index\r\n     */\r\n    get z() {\r\n        return this.get(TransformComponent).z;\r\n    }\r\n    /**\r\n     * @deprecated Use [[Actor.z]]\r\n     */\r\n    getZIndex() {\r\n        return this.get(TransformComponent).z;\r\n    }\r\n    /**\r\n     * Sets the z-index of an actor and updates it in the drawing list for the scene.\r\n     * The z-index determines the relative order an actor is drawn in.\r\n     * Actors with a higher z-index are drawn on top of actors with a lower z-index\r\n     * @param newZ new z-index to assign\r\n     */\r\n    set z(newZ) {\r\n        this.get(TransformComponent).z = newZ;\r\n    }\r\n    /**\r\n     * @param newIndex new z-index to assign\r\n     * @deprecated Use [[Actor.z]]\r\n     */\r\n    setZIndex(newIndex) {\r\n        this.get(TransformComponent).z = newIndex;\r\n    }\r\n    /**\r\n     * Get the center point of an actor\r\n     */\r\n    get center() {\r\n        return new Vector(this.pos.x + this.width / 2 - this.anchor.x * this.width, this.pos.y + this.height / 2 - this.anchor.y * this.height);\r\n    }\r\n    get width() {\r\n        return this.collider.localBounds.width * this.getGlobalScale().x;\r\n    }\r\n    get height() {\r\n        return this.collider.localBounds.height * this.getGlobalScale().y;\r\n    }\r\n    /**\r\n     * Gets this actor's rotation taking into account any parent relationships\r\n     *\r\n     * @returns Rotation angle in radians\r\n     */\r\n    getGlobalRotation() {\r\n        return this.get(TransformComponent).globalRotation;\r\n    }\r\n    /**\r\n     * Gets an actor's world position taking into account parent relationships, scaling, rotation, and translation\r\n     *\r\n     * @returns Position in world coordinates\r\n     */\r\n    getGlobalPos() {\r\n        return this.get(TransformComponent).globalPos;\r\n    }\r\n    /**\r\n     * Gets the global scale of the Actor\r\n     */\r\n    getGlobalScale() {\r\n        return this.get(TransformComponent).globalScale;\r\n    }\r\n    // #region Collision\r\n    /**\r\n     * Tests whether the x/y specified are contained in the actor\r\n     * @param x  X coordinate to test (in world coordinates)\r\n     * @param y  Y coordinate to test (in world coordinates)\r\n     * @param recurse checks whether the x/y are contained in any child actors (if they exist).\r\n     */\r\n    contains(x, y, recurse = false) {\r\n        const point = vec(x, y);\r\n        const collider = this.get(ColliderComponent);\r\n        collider.update();\r\n        const geom = collider.get();\r\n        if (!geom) {\r\n            return false;\r\n        }\r\n        const containment = geom.contains(point);\r\n        if (recurse) {\r\n            return (containment ||\r\n                this.children.some((child) => {\r\n                    return child.contains(x, y, true);\r\n                }));\r\n        }\r\n        return containment;\r\n    }\r\n    /**\r\n     * Returns true if the two actor.collider's surfaces are less than or equal to the distance specified from each other\r\n     * @param actor     Actor to test\r\n     * @param distance  Distance in pixels to test\r\n     */\r\n    within(actor, distance) {\r\n        const collider = this.get(ColliderComponent);\r\n        const otherCollider = actor.get(ColliderComponent);\r\n        const me = collider.get();\r\n        const other = otherCollider.get();\r\n        if (me && other) {\r\n            return me.getClosestLineBetween(other).getLength() <= distance;\r\n        }\r\n        return false;\r\n    }\r\n    // #endregion\r\n    // #region Update\r\n    /**\r\n     * Called by the Engine, updates the state of the actor\r\n     * @internal\r\n     * @param engine The reference to the current game engine\r\n     * @param delta  The time elapsed since the last update in milliseconds\r\n     */\r\n    update(engine, delta) {\r\n        this._initialize(engine);\r\n        this._preupdate(engine, delta);\r\n        // Tick animations\r\n        const drawing = this.currentDrawing;\r\n        if (drawing && drawing instanceof Animation_Animation) {\r\n            drawing.tick(delta, engine.stats.currFrame.id);\r\n        }\r\n        // Update actor pipeline (movement, collision detection, event propagation, offscreen culling)\r\n        for (const trait of this.traits) {\r\n            trait.update(this, engine, delta);\r\n        }\r\n        this._postupdate(engine, delta);\r\n    }\r\n    /**\r\n     * Safe to override onPreUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPreUpdate` is called directly before an actor is updated.\r\n     */\r\n    onPreUpdate(_engine, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('postupdate', (evt) =>{...})`\r\n     *\r\n     * `onPostUpdate` is called directly after an actor is updated.\r\n     */\r\n    onPostUpdate(_engine, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPreUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _preupdate(engine, delta) {\r\n        this.emit('preupdate', new PreUpdateEvent(engine, delta, this));\r\n        this.onPreUpdate(engine, delta);\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPostUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _postupdate(engine, delta) {\r\n        this.emit('postupdate', new PreUpdateEvent(engine, delta, this));\r\n        this.onPostUpdate(engine, delta);\r\n    }\r\n    // endregion\r\n    // #region Drawing\r\n    /**\r\n     * Called by the Engine, draws the actor to the screen\r\n     * @param ctx   The rendering context\r\n     * @param delta The time since the last draw in milliseconds\r\n     *\r\n     * **Warning** only works with Flags.useLegacyDrawing() enabled\r\n     * @deprecated Use Actor.graphics, will be removed in v0.26.0\r\n     */\r\n    draw(ctx, delta) {\r\n        var _a;\r\n        // translate canvas by anchor offset\r\n        ctx.save();\r\n        if (this.currentDrawing) {\r\n            ctx.translate(-(this.width * this.anchor.x), -(this.height * this.anchor.y));\r\n            this._predraw(ctx, delta);\r\n            const drawing = this.currentDrawing;\r\n            // See https://github.com/excaliburjs/Excalibur/pull/619 for discussion on this formula\r\n            const offsetX = (this.width - drawing.width * drawing.scale.x) * this.anchor.x;\r\n            const offsetY = (this.height - drawing.height * drawing.scale.y) * this.anchor.y;\r\n            this.currentDrawing.draw({ ctx, x: offsetX, y: offsetY, opacity: this.graphics.opacity });\r\n        }\r\n        else {\r\n            this._predraw(ctx, delta);\r\n            if (this.color && this.collider) {\r\n                // update collider geometry based on transform\r\n                const collider = this.get(ColliderComponent);\r\n                collider.update();\r\n                if (collider && !collider.bounds.hasZeroDimensions()) {\r\n                    // Colliders are already shifted by anchor, unshift\r\n                    ctx.globalAlpha = this.graphics.opacity;\r\n                    (_a = collider.get()) === null || _a === void 0 ? void 0 : _a.draw(ctx, this.color, vec(0, 0));\r\n                }\r\n            }\r\n        }\r\n        ctx.restore();\r\n        this._postdraw(ctx, delta);\r\n    }\r\n    /**\r\n     * Safe to override onPreDraw lifecycle event handler. Synonymous with `.on('predraw', (evt) =>{...})`\r\n     *\r\n     * `onPreDraw` is called directly before an actor is drawn, but after local transforms are made.\r\n     *\r\n     * **Warning** only works with Flags.useLegacyDrawing() enabled\r\n     * @deprecated Use Actor.graphics.onPostDraw, will be removed in v0.26.0\r\n     */\r\n    onPreDraw(_ctx, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * Safe to override onPostDraw lifecycle event handler. Synonymous with `.on('postdraw', (evt) =>{...})`\r\n     *\r\n     * `onPostDraw` is called directly after an actor is drawn, and before local transforms are removed.\r\n     *\r\n     * **Warning** only works with Flags.useLegacyDrawing() enabled\r\n     * @deprecated Use Actor.graphics.onPostDraw, will be removed in v0.26.0\r\n     */\r\n    onPostDraw(_ctx, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _predraw handler for [[onPreDraw]] lifecycle event\r\n     *\r\n     * **Warning** only works with Flags.useLegacyDrawing() enabled\r\n     * @deprecated Use Actor.graphics.onPreDraw, will be removed in v0.26.0\r\n     * @internal\r\n     */\r\n    _predraw(ctx, delta) {\r\n        this.emit('predraw', new PreDrawEvent(ctx, delta, this));\r\n        this.onPreDraw(ctx, delta);\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _postdraw handler for [[onPostDraw]] lifecycle event\r\n     *\r\n     * **Warning** only works with Flags.useLegacyDrawing() enabled\r\n     * @deprecated Use Actor.graphics.onPostDraw, will be removed in v0.26.0\r\n     * @internal\r\n     */\r\n    _postdraw(ctx, delta) {\r\n        this.emit('postdraw', new PreDrawEvent(ctx, delta, this));\r\n        this.onPostDraw(ctx, delta);\r\n    }\r\n    /**\r\n     * Called by the Engine, draws the actors debugging to the screen\r\n     * @param ctx The rendering context\r\n     *\r\n     *\r\n     * **Warning** only works with Flags.useLegacyDrawing() enabled\r\n     * @deprecated Use Actor.graphics.onPostDraw, will be removed in v0.26.0\r\n     * @internal\r\n     */\r\n    /* istanbul ignore next */\r\n    debugDraw(_ctx) {\r\n        // pass\r\n    }\r\n}\r\n// #region Properties\r\n/**\r\n * Set defaults for all Actors\r\n */\r\nActor.defaults = {\r\n    anchor: Vector.Half\r\n};\r\nActor_decorate([\r\n    obsolete({ message: 'Actor.visible will be removed in v0.26.0', alternateMethod: 'Use Actor.graphics.visible' })\r\n], Actor.prototype, \"visible\", null);\r\nActor_decorate([\r\n    obsolete({\r\n        message: 'Actor.opacity will be removed in v0.26.0',\r\n        alternateMethod: 'Use Actor.graphics.opacity'\r\n    })\r\n], Actor.prototype, \"opacity\", null);\r\nActor_decorate([\r\n    obsolete({\r\n        message: 'Actor.setDrawing will be removed in v0.26.0',\r\n        alternateMethod: 'Use Actor.graphics.show() or Actor.graphics.use()'\r\n    })\r\n], Actor.prototype, \"setDrawing\", null);\r\nActor_decorate([\r\n    obsolete({\r\n        message: 'Actor.addDrawing will be removed in v0.26.0',\r\n        alternateMethod: 'Use Actor.graphics.add()'\r\n    })\r\n], Actor.prototype, \"addDrawing\", null);\r\nActor_decorate([\r\n    obsolete({\r\n        message: 'Actor.getZIndex will be removed in v0.26.0',\r\n        alternateMethod: 'Use Actor.transform.z or Actor.z'\r\n    })\r\n], Actor.prototype, \"getZIndex\", null);\r\nActor_decorate([\r\n    obsolete({\r\n        message: 'Actor.setZIndex will be removed in v0.26.0',\r\n        alternateMethod: 'Use Actor.transform.z or Actor.z'\r\n    })\r\n], Actor.prototype, \"setZIndex\", null);\r\n\n;// CONCATENATED MODULE: ./ScreenElement.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Helper [[Actor]] primitive for drawing UI's, optimized for UI drawing. Does\r\n * not participate in collisions. Drawn on top of all other actors.\r\n */\r\nclass ScreenElement_ScreenElement extends Actor {\r\n    constructor(config) {\r\n        super(Object.assign({}, config));\r\n        this.get(TransformComponent).coordPlane = CoordPlane.Screen;\r\n        this.traits = [];\r\n        this.traits.push(new CapturePointer());\r\n        this.anchor = vec(0, 0);\r\n        this.body.collisionType = CollisionType.PreventCollision;\r\n        this.collider.useBoxCollider(this.width, this.height, this.anchor);\r\n        this.enableCapturePointer = true;\r\n    }\r\n    _initialize(engine) {\r\n        this._engine = engine;\r\n        super._initialize(engine);\r\n    }\r\n    contains(x, y, useWorld = true) {\r\n        if (useWorld) {\r\n            return super.contains(x, y);\r\n        }\r\n        const coords = this._engine.worldToScreenCoordinates(new Vector(x, y));\r\n        return super.contains(coords.x, coords.y);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Timer.ts\nvar Timer_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\n\r\n/**\r\n * The Excalibur timer hooks into the internal timer and fires callbacks,\r\n * after a certain interval, optionally repeating.\r\n */\r\nclass Timer {\r\n    constructor(fcn, interval, repeats, numberOfRepeats) {\r\n        this._logger = Logger.getInstance();\r\n        this.id = 0;\r\n        this._elapsedTime = 0;\r\n        this._totalTimeAlive = 0;\r\n        this._running = false;\r\n        this._numberOfTicks = 0;\r\n        this.interval = 10;\r\n        this.repeats = false;\r\n        this.maxNumberOfRepeats = -1;\r\n        this._complete = false;\r\n        this.scene = null;\r\n        if (typeof fcn !== 'function') {\r\n            const options = fcn;\r\n            fcn = options.fcn;\r\n            interval = options.interval;\r\n            repeats = options.repeats;\r\n            numberOfRepeats = options.numberOfRepeats;\r\n        }\r\n        if (!!numberOfRepeats && numberOfRepeats >= 0) {\r\n            this.maxNumberOfRepeats = numberOfRepeats;\r\n            if (!repeats) {\r\n                throw new Error('repeats must be set to true if numberOfRepeats is set');\r\n            }\r\n        }\r\n        this.id = Timer._MAX_ID++;\r\n        this.interval = interval || this.interval;\r\n        this.repeats = repeats || this.repeats;\r\n        this._callbacks = [];\r\n        if (fcn) {\r\n            this.on(fcn);\r\n        }\r\n    }\r\n    get complete() {\r\n        return this._complete;\r\n    }\r\n    /**\r\n     * Adds a new callback to be fired after the interval is complete\r\n     * @param fcn The callback to be added to the callback list, to be fired after the interval is complete.\r\n     */\r\n    on(fcn) {\r\n        this._callbacks.push(fcn);\r\n    }\r\n    /**\r\n     * Removes a callback from the callback list to be fired after the interval is complete.\r\n     * @param fcn The callback to be removed from the callback list, to be fired after the interval is complete.\r\n     */\r\n    off(fcn) {\r\n        const index = this._callbacks.indexOf(fcn);\r\n        this._callbacks.splice(index, 1);\r\n    }\r\n    /**\r\n     * Updates the timer after a certain number of milliseconds have elapsed. This is used internally by the engine.\r\n     * @param delta  Number of elapsed milliseconds since the last update.\r\n     */\r\n    update(delta) {\r\n        if (this._running) {\r\n            this._totalTimeAlive += delta;\r\n            this._elapsedTime += delta;\r\n            if (this.maxNumberOfRepeats > -1 && this._numberOfTicks >= this.maxNumberOfRepeats) {\r\n                this._complete = true;\r\n                this._running = false;\r\n                this._elapsedTime = 0;\r\n            }\r\n            if (!this.complete && this._elapsedTime >= this.interval) {\r\n                this._callbacks.forEach((c) => {\r\n                    c.call(this);\r\n                });\r\n                this._numberOfTicks++;\r\n                if (this.repeats) {\r\n                    this._elapsedTime = 0;\r\n                }\r\n                else {\r\n                    this._complete = true;\r\n                    this._running = false;\r\n                    this._elapsedTime = 0;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Resets the timer so that it can be reused, and optionally reconfigure the timers interval.\r\n     *\r\n     * Warning** you may need to call `timer.start()` again if the timer had completed\r\n     * @param newInterval If specified, sets a new non-negative interval in milliseconds to refire the callback\r\n     * @param newNumberOfRepeats If specified, sets a new non-negative upper limit to the number of time this timer executes\r\n     */\r\n    reset(newInterval, newNumberOfRepeats) {\r\n        if (!!newInterval && newInterval >= 0) {\r\n            this.interval = newInterval;\r\n        }\r\n        if (!!this.maxNumberOfRepeats && this.maxNumberOfRepeats >= 0) {\r\n            this.maxNumberOfRepeats = newNumberOfRepeats;\r\n            if (!this.repeats) {\r\n                throw new Error('repeats must be set to true if numberOfRepeats is set');\r\n            }\r\n        }\r\n        this._complete = false;\r\n        this._elapsedTime = 0;\r\n        this._numberOfTicks = 0;\r\n    }\r\n    get timesRepeated() {\r\n        return this._numberOfTicks;\r\n    }\r\n    getTimeRunning() {\r\n        return this._totalTimeAlive;\r\n    }\r\n    /**\r\n     * @returns milliseconds until the next action callback, if complete will return 0\r\n     */\r\n    get timeToNextAction() {\r\n        if (this.complete) {\r\n            return 0;\r\n        }\r\n        return this.interval - this._elapsedTime;\r\n    }\r\n    /**\r\n     * @returns milliseconds elapsed toward the next action\r\n     */\r\n    get timeElapsedTowardNextAction() {\r\n        return this._elapsedTime;\r\n    }\r\n    get isRunning() {\r\n        return this._running;\r\n    }\r\n    /**\r\n     * Pauses the timer, time will no longer increment towards the next call\r\n     */\r\n    pause() {\r\n        this._running = false;\r\n        return this;\r\n    }\r\n    /**\r\n     * Unpauses the timer. Time will now increment towards the next call\r\n     * @deprecated Will be removed in v0.26.0\r\n     */\r\n    unpause() {\r\n        this._running = true;\r\n    }\r\n    /**\r\n     * Resumes the timer, time will now increment towards the next call.\r\n     */\r\n    resume() {\r\n        this._running = true;\r\n        return this;\r\n    }\r\n    /**\r\n     * Starts the timer, if the timer was complete it will restart the timer and reset the elapsed time counter\r\n     */\r\n    start() {\r\n        if (!this.scene) {\r\n            this._logger.warn('Cannot start a timer not part of a scene, timer wont start until added');\r\n        }\r\n        this._running = true;\r\n        if (this.complete) {\r\n            this._complete = false;\r\n            this._elapsedTime = 0;\r\n            this._numberOfTicks = 0;\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Stops the timer and resets the elapsed time counter towards the next action invocation\r\n     */\r\n    stop() {\r\n        this._running = false;\r\n        this._elapsedTime = 0;\r\n        this._numberOfTicks = 0;\r\n        return this;\r\n    }\r\n    /**\r\n     * Cancels the timer, preventing any further executions.\r\n     */\r\n    cancel() {\r\n        this.pause();\r\n        if (this.scene) {\r\n            this.scene.cancelTimer(this);\r\n        }\r\n    }\r\n}\r\nTimer._MAX_ID = 0;\r\nTimer_decorate([\r\n    obsolete({ message: 'Will be removed in v0.26.0', alternateMethod: 'Use Timer.resume()' })\r\n], Timer.prototype, \"unpause\", null);\r\n\n;// CONCATENATED MODULE: ./TileMap.ts\nvar TileMap_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * @hidden\r\n */\r\nclass TileMapImpl extends Entity {\r\n    /**\r\n     * @param xOrConfig     The x coordinate to anchor the TileMap's upper left corner (should not be changed once set) or TileMap option bag\r\n     * @param y             The y coordinate to anchor the TileMap's upper left corner (should not be changed once set)\r\n     * @param cellWidth     The individual width of each cell (in pixels) (should not be changed once set)\r\n     * @param cellHeight    The individual height of each cell (in pixels) (should not be changed once set)\r\n     * @param rows          The number of rows in the TileMap (should not be changed once set)\r\n     * @param cols          The number of cols in the TileMap (should not be changed once set)\r\n     */\r\n    constructor(xOrConfig, y, cellWidth, cellHeight, rows, cols) {\r\n        super();\r\n        this._token = 0;\r\n        this._onScreenXStart = 0;\r\n        this._onScreenXEnd = 9999;\r\n        this._onScreenYStart = 0;\r\n        this._onScreenYEnd = 9999;\r\n        this._spriteSheets = {};\r\n        this._legacySpriteMap = new Map();\r\n        this.logger = Logger.getInstance();\r\n        this.data = [];\r\n        this._rows = [];\r\n        this._cols = [];\r\n        this.visible = true;\r\n        this.isOffscreen = false;\r\n        this._dirty = true;\r\n        if (xOrConfig && typeof xOrConfig === 'object') {\r\n            const config = xOrConfig;\r\n            xOrConfig = config.x;\r\n            y = config.y;\r\n            cellWidth = config.cellWidth;\r\n            cellHeight = config.cellHeight;\r\n            rows = config.rows;\r\n            cols = config.cols;\r\n        }\r\n        this.addComponent(new TransformComponent());\r\n        this.addComponent(new MotionComponent());\r\n        this.addComponent(new BodyComponent({\r\n            type: CollisionType.Fixed\r\n        }));\r\n        this.addComponent(new CanvasDrawComponent((ctx, delta) => this.draw(ctx, delta)));\r\n        this.addComponent(new GraphicsComponent({\r\n            onPostDraw: (ctx, delta) => this.draw(ctx, delta)\r\n        }));\r\n        this.addComponent(new ColliderComponent());\r\n        this._transform = this.get(TransformComponent);\r\n        this._motion = this.get(MotionComponent);\r\n        this._collider = this.get(ColliderComponent);\r\n        this._composite = this._collider.useCompositeCollider([]);\r\n        this.x = xOrConfig;\r\n        this.y = y;\r\n        this.cellWidth = cellWidth;\r\n        this.cellHeight = cellHeight;\r\n        this.rows = rows;\r\n        this.cols = cols;\r\n        this.data = new Array(rows * cols);\r\n        this._rows = new Array(rows);\r\n        this._cols = new Array(cols);\r\n        let currentCol = [];\r\n        for (let i = 0; i < cols; i++) {\r\n            for (let j = 0; j < rows; j++) {\r\n                const cd = new Cell(i * cellWidth + xOrConfig, j * cellHeight + y, cellWidth, cellHeight, i + j * cols);\r\n                cd.map = this;\r\n                this.data[i + j * cols] = cd;\r\n                currentCol.push(cd);\r\n                if (!this._rows[j]) {\r\n                    this._rows[j] = [];\r\n                }\r\n                this._rows[j].push(cd);\r\n            }\r\n            this._cols[i] = currentCol;\r\n            currentCol = [];\r\n        }\r\n        this.get(GraphicsComponent).localBounds = new BoundingBox({\r\n            left: 0,\r\n            top: 0,\r\n            right: this.cols * this.cellWidth,\r\n            bottom: this.rows * this.cellHeight\r\n        });\r\n    }\r\n    flagDirty() {\r\n        this._dirty = true;\r\n    }\r\n    get x() {\r\n        var _a;\r\n        return (_a = this._transform.pos.x) !== null && _a !== void 0 ? _a : 0;\r\n    }\r\n    set x(val) {\r\n        var _a;\r\n        if ((_a = this._transform) === null || _a === void 0 ? void 0 : _a.pos) {\r\n            this.get(TransformComponent).pos = vec(val, this.y);\r\n        }\r\n    }\r\n    get y() {\r\n        var _a, _b;\r\n        return (_b = (_a = this._transform) === null || _a === void 0 ? void 0 : _a.pos.y) !== null && _b !== void 0 ? _b : 0;\r\n    }\r\n    set y(val) {\r\n        var _a;\r\n        if ((_a = this._transform) === null || _a === void 0 ? void 0 : _a.pos) {\r\n            this._transform.pos = vec(this.x, val);\r\n        }\r\n    }\r\n    get z() {\r\n        var _a;\r\n        return (_a = this._transform.z) !== null && _a !== void 0 ? _a : 0;\r\n    }\r\n    set z(val) {\r\n        if (this._transform) {\r\n            this._transform.z = val;\r\n        }\r\n    }\r\n    get rotation() {\r\n        var _a, _b;\r\n        return (_b = (_a = this._transform) === null || _a === void 0 ? void 0 : _a.rotation) !== null && _b !== void 0 ? _b : 0;\r\n    }\r\n    set rotation(val) {\r\n        var _a;\r\n        if ((_a = this._transform) === null || _a === void 0 ? void 0 : _a.rotation) {\r\n            this._transform.rotation = val;\r\n        }\r\n    }\r\n    get scale() {\r\n        var _a, _b;\r\n        return (_b = (_a = this._transform) === null || _a === void 0 ? void 0 : _a.scale) !== null && _b !== void 0 ? _b : Vector.One;\r\n    }\r\n    set scale(val) {\r\n        var _a;\r\n        if ((_a = this._transform) === null || _a === void 0 ? void 0 : _a.scale) {\r\n            this._transform.scale = val;\r\n        }\r\n    }\r\n    get pos() {\r\n        return this._transform.pos;\r\n    }\r\n    set pos(val) {\r\n        this._transform.pos = val;\r\n    }\r\n    get vel() {\r\n        return this._motion.vel;\r\n    }\r\n    set vel(val) {\r\n        this._motion.vel = val;\r\n    }\r\n    on(eventName, handler) {\r\n        super.on(eventName, handler);\r\n    }\r\n    _initialize(engine) {\r\n        super._initialize(engine);\r\n    }\r\n    registerSpriteSheet(key, spriteSheet) {\r\n        if (spriteSheet instanceof SpriteSheet) {\r\n            this._spriteSheets[key] = spriteSheet;\r\n        }\r\n        else {\r\n            this._spriteSheets[key] = SpriteSheet.fromLegacySpriteSheet(spriteSheet);\r\n        }\r\n    }\r\n    /**\r\n     * Tiles colliders based on the solid tiles in the tilemap.\r\n     */\r\n    _updateColliders() {\r\n        this._composite.clearColliders();\r\n        const colliders = [];\r\n        let current;\r\n        // Bad square tessalation algo\r\n        for (let i = 0; i < this.cols; i++) {\r\n            // Scan column for colliders\r\n            for (let j = 0; j < this.rows; j++) {\r\n                // Columns start with a new collider\r\n                if (j === 0) {\r\n                    current = null;\r\n                }\r\n                const tile = this.data[i + j * this.cols];\r\n                // Current tile in column is solid build up current collider\r\n                if (tile.solid) {\r\n                    if (!current) {\r\n                        current = tile.bounds;\r\n                    }\r\n                    else {\r\n                        current = current.combine(tile.bounds);\r\n                    }\r\n                }\r\n                else {\r\n                    // Not solid skip and cut off the current collider\r\n                    if (current) {\r\n                        colliders.push(current);\r\n                    }\r\n                    current = null;\r\n                }\r\n            }\r\n            // After a column is complete check to see if it can be merged into the last one\r\n            if (current) {\r\n                // if previous is the same combine it\r\n                const prev = colliders[colliders.length - 1];\r\n                if (prev && prev.top === current.top && prev.bottom === current.bottom) {\r\n                    colliders[colliders.length - 1] = prev.combine(current);\r\n                }\r\n                else {\r\n                    // else new collider\r\n                    colliders.push(current);\r\n                }\r\n            }\r\n        }\r\n        this._composite = this._collider.useCompositeCollider([]);\r\n        for (const c of colliders) {\r\n            const collider = Shape.Box(c.width, c.height, Vector.Zero, vec(c.left - this.pos.x, c.top - this.pos.y));\r\n            collider.owner = this;\r\n            this._composite.addCollider(collider);\r\n        }\r\n        this._collider.update();\r\n    }\r\n    /**\r\n     * Returns the [[Cell]] by index (row major order)\r\n     */\r\n    getCellByIndex(index) {\r\n        return this.data[index];\r\n    }\r\n    /**\r\n     * Returns the [[Cell]] by its x and y coordinates\r\n     */\r\n    getCell(x, y) {\r\n        if (x < 0 || y < 0 || x >= this.cols || y >= this.rows) {\r\n            return null;\r\n        }\r\n        return this.data[x + y * this.cols];\r\n    }\r\n    /**\r\n     * Returns the [[Cell]] by testing a point in global coordinates,\r\n     * returns `null` if no cell was found.\r\n     */\r\n    getCellByPoint(x, y) {\r\n        x = Math.floor((x - this.pos.x) / this.cellWidth);\r\n        y = Math.floor((y - this.pos.y) / this.cellHeight);\r\n        const cell = this.getCell(x, y);\r\n        if (x >= 0 && y >= 0 && x < this.cols && y < this.rows && cell) {\r\n            return cell;\r\n        }\r\n        return null;\r\n    }\r\n    getRows() {\r\n        return this._rows;\r\n    }\r\n    getColumns() {\r\n        return this._cols;\r\n    }\r\n    onPreUpdate(_engine, _delta) {\r\n        // Override me\r\n    }\r\n    onPostUpdate(_engine, _delta) {\r\n        // Override me\r\n    }\r\n    update(engine, delta) {\r\n        this.onPreUpdate(engine, delta);\r\n        this.emit('preupdate', new PreUpdateEvent(engine, delta, this));\r\n        if (this._dirty) {\r\n            this._dirty = false;\r\n            this._updateColliders();\r\n        }\r\n        this._token++;\r\n        const worldBounds = engine.getWorldBounds();\r\n        const worldCoordsUpperLeft = vec(worldBounds.left, worldBounds.top);\r\n        const worldCoordsLowerRight = vec(worldBounds.right, worldBounds.bottom);\r\n        this._onScreenXStart = Math.max(Math.floor((worldCoordsUpperLeft.x - this.x) / this.cellWidth) - 2, 0);\r\n        this._onScreenYStart = Math.max(Math.floor((worldCoordsUpperLeft.y - this.y) / this.cellHeight) - 2, 0);\r\n        this._onScreenXEnd = Math.max(Math.floor((worldCoordsLowerRight.x - this.x) / this.cellWidth) + 2, 0);\r\n        this._onScreenYEnd = Math.max(Math.floor((worldCoordsLowerRight.y - this.y) / this.cellHeight) + 2, 0);\r\n        this._transform.pos = vec(this.x, this.y);\r\n        this.onPostUpdate(engine, delta);\r\n        this.emit('postupdate', new PostUpdateEvent(engine, delta, this));\r\n    }\r\n    /**\r\n     * Draws the tile map to the screen. Called by the [[Scene]].\r\n     * @param ctx CanvasRenderingContext2D or ExcaliburGraphicsContext\r\n     * @param delta  The number of milliseconds since the last draw\r\n     */\r\n    draw(ctx, delta) {\r\n        this.emit('predraw', new PreDrawEvent(ctx, delta, this)); // TODO fix event\r\n        let x = this._onScreenXStart;\r\n        const xEnd = Math.min(this._onScreenXEnd, this.cols);\r\n        let y = this._onScreenYStart;\r\n        const yEnd = Math.min(this._onScreenYEnd, this.rows);\r\n        let graphics, graphicsIndex, graphicsLen;\r\n        for (x; x < xEnd; x++) {\r\n            for (y; y < yEnd; y++) {\r\n                // get non-negative tile sprites\r\n                graphics = this.getCell(x, y).graphics;\r\n                for (graphicsIndex = 0, graphicsLen = graphics.length; graphicsIndex < graphicsLen; graphicsIndex++) {\r\n                    // draw sprite, warning if sprite doesn't exist\r\n                    const graphic = graphics[graphicsIndex];\r\n                    if (graphic) {\r\n                        if (!(ctx instanceof CanvasRenderingContext2D)) {\r\n                            if (hasGraphicsTick(graphic)) {\r\n                                graphic === null || graphic === void 0 ? void 0 : graphic.tick(delta, this._token);\r\n                            }\r\n                            graphic.draw(ctx, x * this.cellWidth, y * this.cellHeight);\r\n                        }\r\n                        else if (graphic instanceof Sprite) {\r\n                            // TODO legacy drawing mode\r\n                            if (!this._legacySpriteMap.has(graphic)) {\r\n                                this._legacySpriteMap.set(graphic, Sprite.toLegacySprite(graphic));\r\n                            }\r\n                            this._legacySpriteMap.get(graphic).draw(ctx, x * this.cellWidth, y * this.cellHeight);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            y = this._onScreenYStart;\r\n        }\r\n        this.emit('postdraw', new PostDrawEvent(ctx, delta, this));\r\n    }\r\n}\r\nTileMap_decorate([\r\n    obsolete({ message: 'No longer used, will be removed in v0.26.0' })\r\n], TileMapImpl.prototype, \"registerSpriteSheet\", null);\r\n/**\r\n * The [[TileMap]] class provides a lightweight way to do large complex scenes with collision\r\n * without the overhead of actors.\r\n */\r\nclass TileMap extends Configurable(TileMapImpl) {\r\n    constructor(xOrConfig, y, cellWidth, cellHeight, rows, cols) {\r\n        super(xOrConfig, y, cellWidth, cellHeight, rows, cols);\r\n    }\r\n}\r\n/**\r\n * @hidden\r\n */\r\nclass CellImpl extends Entity {\r\n    /**\r\n     * @param xOrConfig Gets or sets x coordinate of the cell in world coordinates or cell option bag\r\n     * @param y       Gets or sets y coordinate of the cell in world coordinates\r\n     * @param width   Gets or sets the width of the cell\r\n     * @param height  Gets or sets the height of the cell\r\n     * @param index   The index of the cell in row major order\r\n     * @param solid   Gets or sets whether this cell is solid\r\n     * @param graphics The list of tile graphics to use to draw in this cell (in order)\r\n     */\r\n    constructor(xOrConfig, y, width, height, index, solid = false, graphics = []) {\r\n        super();\r\n        this._solid = false;\r\n        /**\r\n         * Current list of graphics for this cell\r\n         */\r\n        this.graphics = [];\r\n        /**\r\n         * Abitrary data storage per cell, useful for any game specific data\r\n         */\r\n        this.data = new Map();\r\n        if (xOrConfig && typeof xOrConfig === 'object') {\r\n            const config = xOrConfig;\r\n            xOrConfig = config.x;\r\n            y = config.y;\r\n            width = config.width;\r\n            height = config.height;\r\n            index = config.index;\r\n            solid = config.solid;\r\n            graphics = config.sprites;\r\n        }\r\n        this.x = xOrConfig;\r\n        this.y = y;\r\n        this.width = width;\r\n        this.height = height;\r\n        this.index = index;\r\n        this.solid = solid;\r\n        this.graphics = graphics;\r\n        this._bounds = new BoundingBox(this.x, this.y, this.x + this.width, this.y + this.height);\r\n    }\r\n    /**\r\n     * Wether this cell should be treated as solid by the tilemap\r\n     */\r\n    get solid() {\r\n        return this._solid;\r\n    }\r\n    /**\r\n     * Wether this cell should be treated as solid by the tilemap\r\n     */\r\n    set solid(val) {\r\n        var _a;\r\n        (_a = this.map) === null || _a === void 0 ? void 0 : _a.flagDirty();\r\n        this._solid = val;\r\n    }\r\n    get bounds() {\r\n        return this._bounds;\r\n    }\r\n    get center() {\r\n        return new Vector(this.x + this.width / 2, this.y + this.height / 2);\r\n    }\r\n    /**\r\n     * Add another [[Sprite]] to this cell\r\n     * @deprecated Use addSprite, will be removed in v0.26.0\r\n     */\r\n    pushSprite(sprite) {\r\n        this.addGraphic(sprite);\r\n    }\r\n    /**\r\n     * Add another [[Graphic]] to this TileMap cell\r\n     * @param graphic\r\n     */\r\n    addGraphic(graphic) {\r\n        if (graphic instanceof Sprite_Sprite) {\r\n            this.graphics.push(Sprite.fromLegacySprite(graphic));\r\n        }\r\n        else {\r\n            this.graphics.push(graphic);\r\n        }\r\n    }\r\n    /**\r\n     * Remove an instance of a [[Graphic]] from this cell\r\n     */\r\n    removeGraphic(graphic) {\r\n        removeItemFromArray(graphic, this.graphics);\r\n    }\r\n    /**\r\n     * Clear all graphis from this cell\r\n     */\r\n    clearGraphics() {\r\n        this.graphics.length = 0;\r\n    }\r\n}\r\nTileMap_decorate([\r\n    obsolete({ message: 'Will be removed in v0.26.0', alternateMethod: 'addSprite' })\r\n], CellImpl.prototype, \"pushSprite\", null);\r\n/**\r\n * TileMap Cell\r\n *\r\n * A light-weight object that occupies a space in a collision map. Generally\r\n * created by a [[TileMap]].\r\n *\r\n * Cells can draw multiple sprites. Note that the order of drawing is the order\r\n * of the sprites in the array so the last one will be drawn on top. You can\r\n * use transparency to create layers this way.\r\n */\r\nclass Cell extends Configurable(CellImpl) {\r\n    constructor(xOrConfig, y, width, height, index, solid, sprites) {\r\n        super(xOrConfig, y, width, height, index, solid, sprites);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Camera.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Container to house convenience strategy methods\r\n * @internal\r\n */\r\nclass StrategyContainer {\r\n    constructor(camera) {\r\n        this.camera = camera;\r\n    }\r\n    /**\r\n     * Creates and adds the [[LockCameraToActorStrategy]] on the current camera.\r\n     * @param actor The actor to lock the camera to\r\n     */\r\n    lockToActor(actor) {\r\n        this.camera.addStrategy(new LockCameraToActorStrategy(actor));\r\n    }\r\n    /**\r\n     * Creates and adds the [[LockCameraToActorAxisStrategy]] on the current camera\r\n     * @param actor The actor to lock the camera to\r\n     * @param axis The axis to follow the actor on\r\n     */\r\n    lockToActorAxis(actor, axis) {\r\n        this.camera.addStrategy(new LockCameraToActorAxisStrategy(actor, axis));\r\n    }\r\n    /**\r\n     * Creates and adds the [[ElasticToActorStrategy]] on the current camera\r\n     * If cameraElasticity < cameraFriction < 1.0, the behavior will be a dampened spring that will slowly end at the target without bouncing\r\n     * If cameraFriction < cameraElasticity < 1.0, the behavior will be an oscillating spring that will over\r\n     * correct and bounce around the target\r\n     *\r\n     * @param actor Target actor to elastically follow\r\n     * @param cameraElasticity [0 - 1.0] The higher the elasticity the more force that will drive the camera towards the target\r\n     * @param cameraFriction [0 - 1.0] The higher the friction the more that the camera will resist motion towards the target\r\n     */\r\n    elasticToActor(actor, cameraElasticity, cameraFriction) {\r\n        this.camera.addStrategy(new ElasticToActorStrategy(actor, cameraElasticity, cameraFriction));\r\n    }\r\n    /**\r\n     * Creates and adds the [[RadiusAroundActorStrategy]] on the current camera\r\n     * @param actor Target actor to follow when it is \"radius\" pixels away\r\n     * @param radius Number of pixels away before the camera will follow\r\n     */\r\n    radiusAroundActor(actor, radius) {\r\n        this.camera.addStrategy(new RadiusAroundActorStrategy(actor, radius));\r\n    }\r\n    /**\r\n     * Creates and adds the [[LimitCameraBoundsStrategy]] on the current camera\r\n     * @param box The bounding box to limit the camera to.\r\n     */\r\n    limitCameraBounds(box) {\r\n        this.camera.addStrategy(new LimitCameraBoundsStrategy(box));\r\n    }\r\n}\r\n/**\r\n * Camera axis enum\r\n */\r\nvar Axis;\r\n(function (Axis) {\r\n    Axis[Axis[\"X\"] = 0] = \"X\";\r\n    Axis[Axis[\"Y\"] = 1] = \"Y\";\r\n})(Axis || (Axis = {}));\r\n/**\r\n * Lock a camera to the exact x/y position of an actor.\r\n */\r\nclass LockCameraToActorStrategy {\r\n    constructor(target) {\r\n        this.target = target;\r\n        this.action = (target, _cam, _eng, _delta) => {\r\n            const center = target.center;\r\n            return center;\r\n        };\r\n    }\r\n}\r\n/**\r\n * Lock a camera to a specific axis around an actor.\r\n */\r\nclass LockCameraToActorAxisStrategy {\r\n    constructor(target, axis) {\r\n        this.target = target;\r\n        this.axis = axis;\r\n        this.action = (target, cam, _eng, _delta) => {\r\n            const center = target.center;\r\n            const currentFocus = cam.getFocus();\r\n            if (this.axis === Axis.X) {\r\n                return new Vector(center.x, currentFocus.y);\r\n            }\r\n            else {\r\n                return new Vector(currentFocus.x, center.y);\r\n            }\r\n        };\r\n    }\r\n}\r\n/**\r\n * Using [Hook's law](https://en.wikipedia.org/wiki/Hooke's_law), elastically move the camera towards the target actor.\r\n */\r\nclass ElasticToActorStrategy {\r\n    /**\r\n     * If cameraElasticity < cameraFriction < 1.0, the behavior will be a dampened spring that will slowly end at the target without bouncing\r\n     * If cameraFriction < cameraElasticity < 1.0, the behavior will be an oscillating spring that will over\r\n     * correct and bounce around the target\r\n     *\r\n     * @param target Target actor to elastically follow\r\n     * @param cameraElasticity [0 - 1.0] The higher the elasticity the more force that will drive the camera towards the target\r\n     * @param cameraFriction [0 - 1.0] The higher the friction the more that the camera will resist motion towards the target\r\n     */\r\n    constructor(target, cameraElasticity, cameraFriction) {\r\n        this.target = target;\r\n        this.cameraElasticity = cameraElasticity;\r\n        this.cameraFriction = cameraFriction;\r\n        this.action = (target, cam, _eng, _delta) => {\r\n            const position = target.center;\r\n            let focus = cam.getFocus();\r\n            let cameraVel = cam.vel.clone();\r\n            // Calculate the stretch vector, using the spring equation\r\n            // F = kX\r\n            // https://en.wikipedia.org/wiki/Hooke's_law\r\n            // Apply to the current camera velocity\r\n            const stretch = position.sub(focus).scale(this.cameraElasticity); // stretch is X\r\n            cameraVel = cameraVel.add(stretch);\r\n            // Calculate the friction (-1 to apply a force in the opposition of motion)\r\n            // Apply to the current camera velocity\r\n            const friction = cameraVel.scale(-1).scale(this.cameraFriction);\r\n            cameraVel = cameraVel.add(friction);\r\n            // Update position by velocity deltas\r\n            focus = focus.add(cameraVel);\r\n            return focus;\r\n        };\r\n    }\r\n}\r\nclass RadiusAroundActorStrategy {\r\n    /**\r\n     *\r\n     * @param target Target actor to follow when it is \"radius\" pixels away\r\n     * @param radius Number of pixels away before the camera will follow\r\n     */\r\n    constructor(target, radius) {\r\n        this.target = target;\r\n        this.radius = radius;\r\n        this.action = (target, cam, _eng, _delta) => {\r\n            const position = target.center;\r\n            const focus = cam.getFocus();\r\n            const direction = position.sub(focus);\r\n            const distance = direction.size;\r\n            if (distance >= this.radius) {\r\n                const offset = distance - this.radius;\r\n                return focus.add(direction.normalize().scale(offset));\r\n            }\r\n            return focus;\r\n        };\r\n    }\r\n}\r\n/**\r\n * Prevent a camera from going beyond the given camera dimensions.\r\n */\r\nclass LimitCameraBoundsStrategy {\r\n    constructor(target) {\r\n        this.target = target;\r\n        /**\r\n         * Useful for limiting the camera to a [[TileMap]]'s dimensions, or a specific area inside the map.\r\n         *\r\n         * Note that this strategy does not perform any movement by itself.\r\n         * It only sets the camera position to within the given bounds when the camera has gone beyond them.\r\n         * Thus, it is a good idea to combine it with other camera strategies and set this strategy as the last one.\r\n         *\r\n         * Make sure that the camera bounds are at least as large as the viewport size.\r\n         *\r\n         * @param target The bounding box to limit the camera to\r\n         */\r\n        this.boundSizeChecked = false; // Check and warn only once\r\n        this.action = (target, cam, _eng, _delta) => {\r\n            const focus = cam.getFocus();\r\n            if (!this.boundSizeChecked) {\r\n                if (target.bottom - target.top < _eng.drawHeight || target.right - target.left < _eng.drawWidth) {\r\n                    Logger.getInstance().warn('Camera bounds should not be smaller than the engine viewport');\r\n                }\r\n                this.boundSizeChecked = true;\r\n            }\r\n            let focusX = focus.x;\r\n            let focusY = focus.y;\r\n            if (focus.x < target.left + _eng.halfDrawWidth) {\r\n                focusX = target.left + _eng.halfDrawWidth;\r\n            }\r\n            else if (focus.x > target.right - _eng.halfDrawWidth) {\r\n                focusX = target.right - _eng.halfDrawWidth;\r\n            }\r\n            if (focus.y < target.top + _eng.halfDrawHeight) {\r\n                focusY = target.top + _eng.halfDrawHeight;\r\n            }\r\n            else if (focus.y > target.bottom - _eng.halfDrawHeight) {\r\n                focusY = target.bottom - _eng.halfDrawHeight;\r\n            }\r\n            return vec(focusX, focusY);\r\n        };\r\n    }\r\n}\r\n/**\r\n * Cameras\r\n *\r\n * [[Camera]] is the base class for all Excalibur cameras. Cameras are used\r\n * to move around your game and set focus. They are used to determine\r\n * what is \"off screen\" and can be used to scale the game.\r\n *\r\n */\r\nclass Camera extends Class {\r\n    constructor() {\r\n        super(...arguments);\r\n        this._cameraStrategies = [];\r\n        this.strategy = new StrategyContainer(this);\r\n        /**\r\n         * Get or set current zoom of the camera, defaults to 1\r\n         */\r\n        this._z = 1;\r\n        /**\r\n         * Get or set rate of change in zoom, defaults to 0\r\n         */\r\n        this.dz = 0;\r\n        /**\r\n         * Get or set zoom acceleration\r\n         */\r\n        this.az = 0;\r\n        /**\r\n         * Current rotation of the camera\r\n         */\r\n        this.rotation = 0;\r\n        /**\r\n         * Current angular velocity\r\n         */\r\n        this.rx = 0;\r\n        /**\r\n         * Get or set the camera's position\r\n         */\r\n        this._posChanged = false;\r\n        this._pos = watchAny(Vector.Zero, () => (this._posChanged = true));\r\n        /**\r\n         * Get or set the camera's velocity\r\n         */\r\n        this.vel = Vector.Zero;\r\n        /**\r\n         * GEt or set the camera's acceleration\r\n         */\r\n        this.acc = Vector.Zero;\r\n        this._cameraMoving = false;\r\n        this._currentLerpTime = 0;\r\n        this._lerpDuration = 1000; // 1 second\r\n        this._lerpStart = null;\r\n        this._lerpEnd = null;\r\n        //camera effects\r\n        this._isShaking = false;\r\n        this._shakeMagnitudeX = 0;\r\n        this._shakeMagnitudeY = 0;\r\n        this._shakeDuration = 0;\r\n        this._elapsedShakeTime = 0;\r\n        this._xShake = 0;\r\n        this._yShake = 0;\r\n        this._isZooming = false;\r\n        this._zoomStart = 1;\r\n        this._zoomEnd = 1;\r\n        this._currentZoomTime = 0;\r\n        this._zoomDuration = 0;\r\n        this._zoomEasing = EasingFunctions.EaseInOutCubic;\r\n        this._easing = EasingFunctions.EaseInOutCubic;\r\n        this._halfWidth = 0;\r\n        this._halfHeight = 0;\r\n        this._viewport = null;\r\n        this._isInitialized = false;\r\n    }\r\n    get zoom() {\r\n        return this._z;\r\n    }\r\n    set zoom(val) {\r\n        this._z = val;\r\n        if (this._engine) {\r\n            this._halfWidth = this._engine.halfDrawWidth;\r\n            this._halfHeight = this._engine.halfDrawHeight;\r\n        }\r\n    }\r\n    /**\r\n     * Get or set the camera's angular velocity\r\n     */\r\n    get angularVelocity() {\r\n        return this.rx;\r\n    }\r\n    set angularVelocity(value) {\r\n        this.rx = value;\r\n    }\r\n    get pos() {\r\n        return this._pos;\r\n    }\r\n    set pos(vec) {\r\n        this._pos = watchAny(vec, () => (this._posChanged = true));\r\n        this._posChanged = true;\r\n    }\r\n    /**\r\n     * Get the camera's x position\r\n     */\r\n    get x() {\r\n        return this.pos.x;\r\n    }\r\n    /**\r\n     * Set the camera's x position (cannot be set when following an [[Actor]] or when moving)\r\n     */\r\n    set x(value) {\r\n        if (!this._follow && !this._cameraMoving) {\r\n            this.pos = vec(value, this.pos.y);\r\n        }\r\n    }\r\n    /**\r\n     * Get the camera's y position\r\n     */\r\n    get y() {\r\n        return this.pos.y;\r\n    }\r\n    /**\r\n     * Set the camera's y position (cannot be set when following an [[Actor]] or when moving)\r\n     */\r\n    set y(value) {\r\n        if (!this._follow && !this._cameraMoving) {\r\n            this.pos = vec(this.pos.x, value);\r\n        }\r\n    }\r\n    /**\r\n     * Get or set the camera's x velocity\r\n     */\r\n    get dx() {\r\n        return this.vel.x;\r\n    }\r\n    set dx(value) {\r\n        this.vel = vec(value, this.vel.y);\r\n    }\r\n    /**\r\n     * Get or set the camera's y velocity\r\n     */\r\n    get dy() {\r\n        return this.vel.y;\r\n    }\r\n    set dy(value) {\r\n        this.vel = vec(this.vel.x, value);\r\n    }\r\n    /**\r\n     * Get or set the camera's x acceleration\r\n     */\r\n    get ax() {\r\n        return this.acc.x;\r\n    }\r\n    set ax(value) {\r\n        this.acc = vec(value, this.acc.y);\r\n    }\r\n    /**\r\n     * Get or set the camera's y acceleration\r\n     */\r\n    get ay() {\r\n        return this.acc.y;\r\n    }\r\n    set ay(value) {\r\n        this.acc = vec(this.acc.x, value);\r\n    }\r\n    /**\r\n     * Returns the focal point of the camera, a new point giving the x and y position of the camera\r\n     */\r\n    getFocus() {\r\n        return this.pos;\r\n    }\r\n    /**\r\n     * This moves the camera focal point to the specified position using specified easing function. Cannot move when following an Actor.\r\n     *\r\n     * @param pos The target position to move to\r\n     * @param duration The duration in milliseconds the move should last\r\n     * @param [easingFn] An optional easing function ([[ex.EasingFunctions.EaseInOutCubic]] by default)\r\n     * @returns A [[Promise]] that resolves when movement is finished, including if it's interrupted.\r\n     *          The [[Promise]] value is the [[Vector]] of the target position. It will be rejected if a move cannot be made.\r\n     */\r\n    move(pos, duration, easingFn = EasingFunctions.EaseInOutCubic) {\r\n        if (typeof easingFn !== 'function') {\r\n            throw 'Please specify an EasingFunction';\r\n        }\r\n        // cannot move when following an actor\r\n        if (this._follow) {\r\n            return Promise.reject(pos);\r\n        }\r\n        // resolve existing promise, if any\r\n        if (this._lerpPromise && this._lerpResolve) {\r\n            this._lerpResolve(pos);\r\n        }\r\n        this._lerpPromise = new Promise((resolve) => {\r\n            this._lerpResolve = resolve;\r\n        });\r\n        this._lerpStart = this.getFocus().clone();\r\n        this._lerpDuration = duration;\r\n        this._lerpEnd = pos;\r\n        this._currentLerpTime = 0;\r\n        this._cameraMoving = true;\r\n        this._easing = easingFn;\r\n        return this._lerpPromise;\r\n    }\r\n    /**\r\n     * Sets the camera to shake at the specified magnitudes for the specified duration\r\n     * @param magnitudeX  The x magnitude of the shake\r\n     * @param magnitudeY  The y magnitude of the shake\r\n     * @param duration    The duration of the shake in milliseconds\r\n     */\r\n    shake(magnitudeX, magnitudeY, duration) {\r\n        this._isShaking = true;\r\n        this._shakeMagnitudeX = magnitudeX;\r\n        this._shakeMagnitudeY = magnitudeY;\r\n        this._shakeDuration = duration;\r\n    }\r\n    /**\r\n     * Zooms the camera in or out by the specified scale over the specified duration.\r\n     * If no duration is specified, it take effect immediately.\r\n     * @param scale    The scale of the zoom\r\n     * @param duration The duration of the zoom in milliseconds\r\n     */\r\n    zoomOverTime(scale, duration = 0, easingFn = EasingFunctions.EaseInOutCubic) {\r\n        this._zoomPromise = new Promise((resolve) => {\r\n            this._zoomResolve = resolve;\r\n        });\r\n        if (duration) {\r\n            this._isZooming = true;\r\n            this._zoomEasing = easingFn;\r\n            this._currentZoomTime = 0;\r\n            this._zoomDuration = duration;\r\n            this._zoomStart = this.zoom;\r\n            this._zoomEnd = scale;\r\n        }\r\n        else {\r\n            this._isZooming = false;\r\n            this.zoom = scale;\r\n            return Promise.resolve(true);\r\n        }\r\n        return this._zoomPromise;\r\n    }\r\n    /**\r\n     * Gets the bounding box of the viewport of this camera in world coordinates\r\n     */\r\n    get viewport() {\r\n        if (this._viewport) {\r\n            return this._viewport;\r\n        }\r\n        return new BoundingBox(0, 0, 0, 0);\r\n    }\r\n    /**\r\n     * Adds a new camera strategy to this camera\r\n     * @param cameraStrategy Instance of an [[CameraStrategy]]\r\n     */\r\n    addStrategy(cameraStrategy) {\r\n        this._cameraStrategies.push(cameraStrategy);\r\n    }\r\n    /**\r\n     * Removes a camera strategy by reference\r\n     * @param cameraStrategy Instance of an [[CameraStrategy]]\r\n     */\r\n    removeStrategy(cameraStrategy) {\r\n        removeItemFromArray(cameraStrategy, this._cameraStrategies);\r\n    }\r\n    /**\r\n     * Clears all camera strategies from the camera\r\n     */\r\n    clearAllStrategies() {\r\n        this._cameraStrategies.length = 0;\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPreUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _preupdate(engine, delta) {\r\n        this.emit('preupdate', new PreUpdateEvent(engine, delta, this));\r\n        this.onPreUpdate(engine, delta);\r\n    }\r\n    /**\r\n     * Safe to override onPreUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPreUpdate` is called directly before a scene is updated.\r\n     */\r\n    onPreUpdate(_engine, _delta) {\r\n        // Overridable\r\n    }\r\n    /**\r\n     *  It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPostUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _postupdate(engine, delta) {\r\n        this.emit('postupdate', new PostUpdateEvent(engine, delta, this));\r\n        this.onPostUpdate(engine, delta);\r\n    }\r\n    /**\r\n     * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPostUpdate` is called directly after a scene is updated.\r\n     */\r\n    onPostUpdate(_engine, _delta) {\r\n        // Overridable\r\n    }\r\n    get isInitialized() {\r\n        return this._isInitialized;\r\n    }\r\n    _initialize(_engine) {\r\n        if (!this.isInitialized) {\r\n            this._engine = _engine;\r\n            const currentRes = this._engine.screen.resolution;\r\n            let center = vec(currentRes.width / 2, currentRes.height / 2);\r\n            if (!this._engine.loadingComplete) {\r\n                // If there was a loading screen, we peek the configured resolution\r\n                const res = this._engine.screen.peekResolution();\r\n                if (res) {\r\n                    center = vec(res.width / 2, res.height / 2);\r\n                }\r\n            }\r\n            this._halfWidth = center.x;\r\n            this._halfHeight = center.x;\r\n            // If the user has not set the camera pos, apply default center screen position\r\n            if (!this._posChanged) {\r\n                this.pos = center;\r\n            }\r\n            this.onInitialize(_engine);\r\n            super.emit('initialize', new InitializeEvent(_engine, this));\r\n            this._isInitialized = true;\r\n        }\r\n    }\r\n    /**\r\n     * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPostUpdate` is called directly after a scene is updated.\r\n     */\r\n    onInitialize(_engine) {\r\n        // Overridable\r\n    }\r\n    on(eventName, handler) {\r\n        super.on(eventName, handler);\r\n    }\r\n    off(eventName, handler) {\r\n        super.off(eventName, handler);\r\n    }\r\n    once(eventName, handler) {\r\n        super.once(eventName, handler);\r\n    }\r\n    update(_engine, delta) {\r\n        this._initialize(_engine);\r\n        this._preupdate(_engine, delta);\r\n        // Update placements based on linear algebra\r\n        this.pos = this.pos.add(this.vel.scale(delta / 1000));\r\n        this.zoom += (this.dz * delta) / 1000;\r\n        this.vel = this.vel.add(this.acc.scale(delta / 1000));\r\n        this.dz += (this.az * delta) / 1000;\r\n        this.rotation += (this.angularVelocity * delta) / 1000;\r\n        if (this._isZooming) {\r\n            if (this._currentZoomTime < this._zoomDuration) {\r\n                const zoomEasing = this._zoomEasing;\r\n                const newZoom = zoomEasing(this._currentZoomTime, this._zoomStart, this._zoomEnd, this._zoomDuration);\r\n                this.zoom = newZoom;\r\n                this._currentZoomTime += delta;\r\n            }\r\n            else {\r\n                this._isZooming = false;\r\n                this.zoom = this._zoomEnd;\r\n                this._currentZoomTime = 0;\r\n                this._zoomResolve(true);\r\n            }\r\n        }\r\n        if (this._cameraMoving) {\r\n            if (this._currentLerpTime < this._lerpDuration) {\r\n                const moveEasing = EasingFunctions.CreateVectorEasingFunction(this._easing);\r\n                const lerpPoint = moveEasing(this._currentLerpTime, this._lerpStart, this._lerpEnd, this._lerpDuration);\r\n                this.pos = lerpPoint;\r\n                this._currentLerpTime += delta;\r\n            }\r\n            else {\r\n                this.pos = this._lerpEnd;\r\n                const end = this._lerpEnd.clone();\r\n                this._lerpStart = null;\r\n                this._lerpEnd = null;\r\n                this._currentLerpTime = 0;\r\n                this._cameraMoving = false;\r\n                // Order matters here, resolve should be last so any chain promises have a clean slate\r\n                this._lerpResolve(end);\r\n            }\r\n        }\r\n        if (this._isDoneShaking()) {\r\n            this._isShaking = false;\r\n            this._elapsedShakeTime = 0;\r\n            this._shakeMagnitudeX = 0;\r\n            this._shakeMagnitudeY = 0;\r\n            this._shakeDuration = 0;\r\n            this._xShake = 0;\r\n            this._yShake = 0;\r\n        }\r\n        else {\r\n            this._elapsedShakeTime += delta;\r\n            this._xShake = ((Math.random() * this._shakeMagnitudeX) | 0) + 1;\r\n            this._yShake = ((Math.random() * this._shakeMagnitudeY) | 0) + 1;\r\n        }\r\n        for (const s of this._cameraStrategies) {\r\n            this.pos = s.action.call(s, s.target, this, _engine, delta);\r\n        }\r\n        this._viewport = new BoundingBox(this.x - this._halfWidth, this.y - this._halfHeight, this.x + this._halfWidth, this.y + this._halfHeight);\r\n        this._postupdate(_engine, delta);\r\n    }\r\n    draw(ctx) {\r\n        let canvasWidth = 0;\r\n        let canvasHeight = 0;\r\n        if (ctx instanceof CanvasRenderingContext2D) {\r\n            canvasWidth = ctx.canvas.width;\r\n            canvasHeight = ctx.canvas.height;\r\n        }\r\n        else {\r\n            canvasWidth = ctx.width;\r\n            canvasHeight = ctx.height;\r\n        }\r\n        const focus = this.getFocus();\r\n        const pixelRatio = this._engine ? this._engine.pixelRatio : 1;\r\n        const zoom = this.zoom;\r\n        const newCanvasWidth = canvasWidth / zoom / pixelRatio;\r\n        const newCanvasHeight = canvasHeight / zoom / pixelRatio;\r\n        ctx.scale(zoom, zoom);\r\n        ctx.translate(-focus.x + newCanvasWidth / 2 + this._xShake, -focus.y + newCanvasHeight / 2 + this._yShake);\r\n    }\r\n    /* istanbul ignore next */\r\n    debugDraw(_ctx) {\r\n        // pass\r\n    }\r\n    _isDoneShaking() {\r\n        return !this._isShaking || this._elapsedShakeTime >= this._shakeDuration;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Actors.ts\n\r\n\r\n\r\n/**\r\n * Type guard to detect if something is an actor\r\n * @deprecated Will be removed in v0.26.0\r\n * @param actor\r\n */\r\nfunction isVanillaActor(actor) {\r\n    return !(actor instanceof ScreenElement) && !(actor instanceof Trigger) && !(actor instanceof Label);\r\n}\r\n/**\r\n * Type guard to detect a screen element\r\n * @todo move to ScreenElement\r\n */\r\nfunction isScreenElement(actor) {\r\n    return actor instanceof ScreenElement_ScreenElement;\r\n}\r\n\n;// CONCATENATED MODULE: ./Trigger.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst triggerDefaults = {\r\n    pos: Vector.Zero,\r\n    width: 10,\r\n    height: 10,\r\n    visible: false,\r\n    action: () => {\r\n        return;\r\n    },\r\n    filter: () => true,\r\n    repeat: -1\r\n};\r\n/**\r\n * Triggers are a method of firing arbitrary code on collision. These are useful\r\n * as 'buttons', 'switches', or to trigger effects in a game. By default triggers\r\n * are invisible, and can only be seen when [[Trigger.visible]] is set to `true`.\r\n */\r\nclass Trigger_Trigger extends Actor {\r\n    /**\r\n     *\r\n     * @param opts Trigger options\r\n     */\r\n    constructor(opts) {\r\n        super({ x: opts.pos.x, y: opts.pos.y, width: opts.width, height: opts.height });\r\n        /**\r\n         * Action to fire when triggered by collision\r\n         */\r\n        this.action = () => {\r\n            return;\r\n        };\r\n        /**\r\n         * Filter to add additional granularity to action dispatch, if a filter is specified the action will only fire when\r\n         * filter return true for the collided actor.\r\n         */\r\n        this.filter = () => true;\r\n        /**\r\n         * Number of times to repeat before killing the trigger,\r\n         */\r\n        this.repeat = -1;\r\n        opts = extend({}, triggerDefaults, opts);\r\n        this.filter = opts.filter || this.filter;\r\n        this.repeat = opts.repeat || this.repeat;\r\n        this.action = opts.action || this.action;\r\n        if (opts.target) {\r\n            this.target = opts.target;\r\n        }\r\n        this.graphics.visible = opts.visible;\r\n        this.body.collisionType = CollisionType.Passive;\r\n        this.eventDispatcher = new EventDispatcher(this);\r\n        this.events.on('collisionstart', (evt) => {\r\n            if (this.filter(evt.other)) {\r\n                this.emit('enter', new EnterTriggerEvent(this, evt.other));\r\n                this._dispatchAction();\r\n                // remove trigger if its done, -1 repeat forever\r\n                if (this.repeat === 0) {\r\n                    this.kill();\r\n                }\r\n            }\r\n        });\r\n        this.events.on('collisionend', (evt) => {\r\n            if (this.filter(evt.other)) {\r\n                this.emit('exit', new ExitTriggerEvent(this, evt.other));\r\n            }\r\n        });\r\n    }\r\n    set target(target) {\r\n        this._target = target;\r\n        this.filter = (actor) => actor === target;\r\n    }\r\n    get target() {\r\n        return this._target;\r\n    }\r\n    _initialize(engine) {\r\n        super._initialize(engine);\r\n    }\r\n    _dispatchAction() {\r\n        if (this.repeat !== 0) {\r\n            this.action.call(this);\r\n            this.repeat--;\r\n        }\r\n    }\r\n    /* istanbul ignore next */\r\n    debugDraw(ctx) {\r\n        super.debugDraw(ctx);\r\n        // Meant to draw debug information about actors\r\n        ctx.save();\r\n        ctx.translate(this.pos.x, this.pos.y);\r\n        const bb = this.collider.bounds;\r\n        const wp = this.getGlobalPos();\r\n        bb.left = bb.left - wp.x;\r\n        bb.right = bb.right - wp.x;\r\n        bb.top = bb.top - wp.y;\r\n        bb.bottom = bb.bottom - wp.y;\r\n        ctx.fillStyle = Color.Violet.toString();\r\n        ctx.strokeStyle = Color.Violet.toString();\r\n        ctx.fillText('Trigger', 10, 10);\r\n        bb.debugDraw(ctx);\r\n        ctx.restore();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/System.ts\n/**\r\n * Enum that determines whether to run the system in the update or draw phase\r\n */\r\nvar SystemType;\r\n(function (SystemType) {\r\n    SystemType[\"Update\"] = \"update\";\r\n    SystemType[\"Draw\"] = \"draw\";\r\n})(SystemType || (SystemType = {}));\r\n/**\r\n * An Excalibur [[System]] that updates entities of certain types.\r\n * Systems are scene specific\r\n *\r\n * Excalibur Systems currently require at least 1 Component type to operated\r\n *\r\n * Multiple types are declared as a type union\r\n * For example:\r\n *\r\n * ```typescript\r\n * class MySystem extends System<ComponentA | ComponentB> {\r\n *   public readonly types = ['a', 'b'] as const;\r\n *   public readonly systemType = SystemType.Update;\r\n *   public update(entities: Entity<ComponentA | ComponentB>) {\r\n *      ...\r\n *   }\r\n * }\r\n * ```\r\n */\r\nclass System {\r\n    constructor() {\r\n        /**\r\n         * System can execute in priority order, by default all systems are priority 0. Lower values indicated higher priority.\r\n         * For a system to execute before all other a lower priority value (-1 for example) must be set.\r\n         * For a system to exectue after all other a higher priority value (10 for example) must be set.\r\n         */\r\n        this.priority = 0;\r\n    }\r\n    /**\r\n     * Systems observe when entities match their types or no longer match their types, override\r\n     * @param _entityAddedOrRemoved\r\n     */\r\n    notify(_entityAddedOrRemoved) {\r\n        // Override me\r\n    }\r\n}\r\n/**\r\n * An [[Entity]] with [[Component]] types that matches a [[System]] types exists in the current scene.\r\n */\r\nclass AddedEntity {\r\n    constructor(data) {\r\n        this.data = data;\r\n        this.type = 'Entity Added';\r\n    }\r\n}\r\n/**\r\n * Type guard to check for AddedEntity messages\r\n * @param x\r\n */\r\nfunction isAddedSystemEntity(x) {\r\n    return !!x && x.type === 'Entity Added';\r\n}\r\n/**\r\n * An [[Entity]] with [[Component]] types that no longer matches a [[System]] types exists in the current scene.\r\n */\r\nclass RemovedEntity {\r\n    constructor(data) {\r\n        this.data = data;\r\n        this.type = 'Entity Removed';\r\n    }\r\n}\r\n/**\r\n * type guard to check for the RemovedEntity message\r\n */\r\nfunction isRemoveSystemEntity(x) {\r\n    return !!x && x.type === 'Entity Removed';\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/EntityManager.ts\n\r\n\r\n// Add/Remove entitys and components\r\nclass EntityManager {\r\n    constructor(_world) {\r\n        this._world = _world;\r\n        this.entities = [];\r\n        this._entityIndex = {};\r\n        this._entitiesToRemove = [];\r\n    }\r\n    /**\r\n     * Runs the entity lifecycle\r\n     * @param _context\r\n     */\r\n    updateEntities(_context, elapsed) {\r\n        for (const entity of this.entities) {\r\n            // TODO is this right?\r\n            entity.update(_context.engine, elapsed);\r\n            if (!entity.active) {\r\n                this.removeEntity(entity);\r\n            }\r\n        }\r\n    }\r\n    findEntitiesForRemoval() {\r\n        for (const entity of this.entities) {\r\n            if (!entity.active) {\r\n                this.removeEntity(entity);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * EntityManager observes changes on entities\r\n     * @param message\r\n     */\r\n    notify(message) {\r\n        if (isAddedComponent(message)) {\r\n            // we don't need the component, it's already on the entity\r\n            this._world.queryManager.addEntity(message.data.entity);\r\n        }\r\n        if (isRemovedComponent(message)) {\r\n            this._world.queryManager.removeComponent(message.data.entity, message.data.component);\r\n        }\r\n    }\r\n    /**\r\n     * Adds an entity to be tracked by the EntityManager\r\n     * @param entity\r\n     */\r\n    addEntity(entity) {\r\n        entity.active = true;\r\n        if (entity && !this._entityIndex[entity.id]) {\r\n            this._entityIndex[entity.id] = entity;\r\n            this.entities.push(entity);\r\n            this._world.queryManager.addEntity(entity);\r\n            entity.componentAdded$.register(this);\r\n            entity.componentRemoved$.register(this);\r\n            // if entity has children\r\n            entity.children.forEach((c) => this.addEntity(c));\r\n            entity.childrenAdded$.register({\r\n                notify: (e) => {\r\n                    this.addEntity(e);\r\n                }\r\n            });\r\n            entity.childrenRemoved$.register({\r\n                notify: (e) => {\r\n                    this.removeEntity(e, false);\r\n                }\r\n            });\r\n        }\r\n    }\r\n    removeEntity(idOrEntity, deferred = true) {\r\n        var _a;\r\n        let id = 0;\r\n        if (idOrEntity instanceof Entity) {\r\n            id = idOrEntity.id;\r\n        }\r\n        else {\r\n            id = idOrEntity;\r\n        }\r\n        const entity = this._entityIndex[id];\r\n        if (entity && entity.active) {\r\n            entity.kill();\r\n        }\r\n        if (entity && deferred) {\r\n            this._entitiesToRemove.push(entity);\r\n            return;\r\n        }\r\n        delete this._entityIndex[id];\r\n        if (entity) {\r\n            removeItemFromArray(entity, this.entities);\r\n            this._world.queryManager.removeEntity(entity);\r\n            entity.componentAdded$.unregister(this);\r\n            entity.componentRemoved$.unregister(this);\r\n            // if entity has children\r\n            entity.children.forEach((c) => this.removeEntity(c, deferred));\r\n            entity.childrenAdded$.clear();\r\n            entity.childrenRemoved$.clear();\r\n            // stats\r\n            if ((_a = this._world.context) === null || _a === void 0 ? void 0 : _a.engine) {\r\n                this._world.context.engine.stats.currFrame.actors.killed++;\r\n            }\r\n        }\r\n    }\r\n    processEntityRemovals() {\r\n        for (const entity of this._entitiesToRemove) {\r\n            if (entity.active) {\r\n                continue;\r\n            }\r\n            this.removeEntity(entity, false);\r\n        }\r\n    }\r\n    processComponentRemovals() {\r\n        for (const entity of this.entities) {\r\n            entity.processComponentRemoval();\r\n        }\r\n    }\r\n    getById(id) {\r\n        return this._entityIndex[id];\r\n    }\r\n    getByName(name) {\r\n        return this.entities.filter(e => e.name === name);\r\n    }\r\n    clear() {\r\n        for (const entity of this.entities) {\r\n            this.removeEntity(entity);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/Util.ts\nconst buildTypeKey = (types) => {\r\n    const key = [...types].sort((a, b) => a.localeCompare(b)).join('+');\r\n    return key;\r\n};\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/Query.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Represents query for entities that match a list of types that is cached and observable\r\n *\r\n * Queries can be strongly typed by supplying a type union in the optional type parameter\r\n * ```typescript\r\n * const queryAB = new ex.Query<ComponentTypeA | ComponentTypeB>(['A', 'B']);\r\n * ```\r\n */\r\nclass Query extends Observable {\r\n    constructor(types) {\r\n        super();\r\n        this._entities = [];\r\n        if (types[0] instanceof Function) {\r\n            this.types = types.map(T => (new T).type);\r\n        }\r\n        else {\r\n            this.types = types;\r\n        }\r\n    }\r\n    get key() {\r\n        if (this._key) {\r\n            return this._key;\r\n        }\r\n        return (this._key = buildTypeKey(this.types));\r\n    }\r\n    /**\r\n     * Returns a list of entities that match the query\r\n     *\r\n     * @param sort Optional sorting function to sort entities returned from the query\r\n     */\r\n    getEntities(sort) {\r\n        if (sort) {\r\n            this._entities.sort(sort);\r\n        }\r\n        return this._entities;\r\n    }\r\n    /**\r\n     * Add an entity to the query, will only be added if the entity matches the query types\r\n     * @param entity\r\n     */\r\n    addEntity(entity) {\r\n        if (!contains(this._entities, entity) && this.matches(entity)) {\r\n            this._entities.push(entity);\r\n            this.notifyAll(new AddedEntity(entity));\r\n        }\r\n    }\r\n    /**\r\n     * If the entity is part of the query it will be removed regardless of types\r\n     * @param entity\r\n     */\r\n    removeEntity(entity) {\r\n        if (removeItemFromArray(entity, this._entities)) {\r\n            this.notifyAll(new RemovedEntity(entity));\r\n        }\r\n    }\r\n    /**\r\n     * Removes all entities and observers from the query\r\n     */\r\n    clear() {\r\n        this._entities.length = 0;\r\n        for (const observer of this.observers) {\r\n            this.unregister(observer);\r\n        }\r\n    }\r\n    matches(typesOrEntity) {\r\n        let types = [];\r\n        if (typesOrEntity instanceof Entity) {\r\n            types = typesOrEntity.types;\r\n        }\r\n        else {\r\n            types = typesOrEntity;\r\n        }\r\n        let matches = true;\r\n        for (const type of this.types) {\r\n            matches = matches && types.indexOf(type) > -1;\r\n            if (!matches) {\r\n                return false;\r\n            }\r\n        }\r\n        return matches;\r\n    }\r\n    contain(type) {\r\n        return this.types.indexOf(type) > -1;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/QueryManager.ts\n\r\n\r\n/**\r\n * The query manager is responsible for updating all queries when entities/components change\r\n */\r\nclass QueryManager {\r\n    constructor(_world) {\r\n        this._world = _world;\r\n        this._queries = {};\r\n    }\r\n    /**\r\n     * Adds a query to the manager and populates with any entities that match\r\n     * @param query\r\n     */\r\n    _addQuery(query) {\r\n        this._queries[buildTypeKey(query.types)] = query;\r\n        for (const entity of this._world.entityManager.entities) {\r\n            query.addEntity(entity);\r\n        }\r\n    }\r\n    /**\r\n     * Removes the query if there are no observers left\r\n     * @param query\r\n     */\r\n    maybeRemoveQuery(query) {\r\n        if (query.observers.length === 0) {\r\n            query.clear();\r\n            delete this._queries[buildTypeKey(query.types)];\r\n        }\r\n    }\r\n    /**\r\n     * Adds the entity to any matching query in the query manage\r\n     * @param entity\r\n     */\r\n    addEntity(entity) {\r\n        for (const queryType in this._queries) {\r\n            if (this._queries[queryType]) {\r\n                this._queries[queryType].addEntity(entity);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Removes an entity from queries if the removed component disqualifies it\r\n     * @param entity\r\n     * @param component\r\n     */\r\n    removeComponent(entity, component) {\r\n        for (const queryType in this._queries) {\r\n            // If the component being removed from an entity is a part of a query,\r\n            // it is now disqualified from that query, remove it\r\n            if (this._queries[queryType].contain(component.type)) {\r\n                this._queries[queryType].removeEntity(entity);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Removes an entity from all queries it is currently a part of\r\n     * @param entity\r\n     */\r\n    removeEntity(entity) {\r\n        for (const queryType in this._queries) {\r\n            this._queries[queryType].removeEntity(entity);\r\n        }\r\n    }\r\n    /**\r\n     * Creates a populated query and returns, if the query already exists that will be returned instead of a new instance\r\n     * @param types\r\n     */\r\n    createQuery(types) {\r\n        const maybeExistingQuery = this.getQuery(types);\r\n        if (maybeExistingQuery) {\r\n            return maybeExistingQuery;\r\n        }\r\n        const query = new Query(types);\r\n        this._addQuery(query);\r\n        return query;\r\n    }\r\n    /**\r\n     * Retrieves an existing query by types if it exists otherwise returns null\r\n     * @param types\r\n     */\r\n    getQuery(types) {\r\n        const key = buildTypeKey(types);\r\n        if (this._queries[key]) {\r\n            return this._queries[key];\r\n        }\r\n        return null;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/SystemManager.ts\n\r\n/**\r\n * The SystemManager is responsible for keeping track of all systems in a scene.\r\n * Systems are scene specific\r\n */\r\nclass SystemManager {\r\n    constructor(_world) {\r\n        this._world = _world;\r\n        /**\r\n         * List of systems, to add a new system call [[SystemManager.addSystem]]\r\n         */\r\n        this.systems = [];\r\n        this.initialized = false;\r\n    }\r\n    /**\r\n     * Get a system registered in the manager by type\r\n     * @param systemType\r\n     * @returns\r\n     */\r\n    get(systemType) {\r\n        return this.systems.find((s) => s instanceof systemType);\r\n    }\r\n    /**\r\n     * Adds a system to the manager, it will now be updated every frame\r\n     * @param system\r\n     */\r\n    addSystem(system) {\r\n        // validate system has types\r\n        if (!system.types || system.types.length === 0) {\r\n            throw new Error(`Attempted to add a System without any types`);\r\n        }\r\n        const query = this._world.queryManager.createQuery(system.types);\r\n        this.systems.push(system);\r\n        this.systems.sort((a, b) => a.priority - b.priority);\r\n        query.register(system);\r\n        if (this.initialized && system.initialize) {\r\n            system.initialize(this._world.context);\r\n        }\r\n    }\r\n    /**\r\n     * Removes a system from the manager, it will no longer be updated\r\n     * @param system\r\n     */\r\n    removeSystem(system) {\r\n        removeItemFromArray(system, this.systems);\r\n        const query = this._world.queryManager.getQuery(system.types);\r\n        if (query) {\r\n            query.unregister(system);\r\n            this._world.queryManager.maybeRemoveQuery(query);\r\n        }\r\n    }\r\n    /**\r\n     * Updates all systems\r\n     * @param type whether this is an update or draw system\r\n     * @param context context reference\r\n     * @param delta time in milliseconds\r\n     */\r\n    updateSystems(type, context, delta) {\r\n        if (!this.initialized) {\r\n            this.initialized = true;\r\n            for (const s of this.systems) {\r\n                if (s.initialize) {\r\n                    s.initialize(this._world.context);\r\n                }\r\n            }\r\n        }\r\n        const systems = this.systems.filter((s) => s.systemType === type);\r\n        for (const s of systems) {\r\n            if (s.preupdate) {\r\n                s.preupdate(context, delta);\r\n            }\r\n        }\r\n        for (const s of systems) {\r\n            // Get entities that match the system types, pre-sort\r\n            const entities = this._world.queryManager.getQuery(s.types).getEntities(s.sort);\r\n            // Initialize entities if needed\r\n            if (context instanceof Scene) {\r\n                for (const entity of entities) {\r\n                    entity._initialize(context === null || context === void 0 ? void 0 : context.engine);\r\n                }\r\n            }\r\n            s.update(entities, delta);\r\n        }\r\n        for (const s of systems) {\r\n            if (s.postupdate) {\r\n                s.postupdate(context, delta);\r\n            }\r\n        }\r\n    }\r\n    clear() {\r\n        for (const system of this.systems) {\r\n            this.removeSystem(system);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/World.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * The World is a self-contained entity component system for a particular context.\r\n */\r\nclass World {\r\n    /**\r\n     * The context type is passed to the system updates\r\n     * @param context\r\n     */\r\n    constructor(context) {\r\n        this.context = context;\r\n        this.queryManager = new QueryManager(this);\r\n        this.entityManager = new EntityManager(this);\r\n        this.systemManager = new SystemManager(this);\r\n    }\r\n    /**\r\n     * Update systems by type and time elapsed in milliseconds\r\n     */\r\n    update(type, delta) {\r\n        if (type === SystemType.Update) {\r\n            this.entityManager.updateEntities(this.context, delta);\r\n        }\r\n        this.systemManager.updateSystems(type, this.context, delta);\r\n        this.entityManager.findEntitiesForRemoval();\r\n        this.entityManager.processComponentRemovals();\r\n        this.entityManager.processEntityRemovals();\r\n    }\r\n    add(entityOrSystem) {\r\n        if (entityOrSystem instanceof Entity) {\r\n            this.entityManager.addEntity(entityOrSystem);\r\n        }\r\n        if (entityOrSystem instanceof System) {\r\n            this.systemManager.addSystem(entityOrSystem);\r\n        }\r\n    }\r\n    remove(entityOrSystem, deferred = true) {\r\n        if (entityOrSystem instanceof Entity) {\r\n            this.entityManager.removeEntity(entityOrSystem, deferred);\r\n        }\r\n        if (entityOrSystem instanceof System) {\r\n            this.systemManager.removeSystem(entityOrSystem);\r\n        }\r\n    }\r\n    clearEntities() {\r\n        this.entityManager.clear();\r\n    }\r\n    clearSystems() {\r\n        this.systemManager.clear();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Integrator.ts\nclass EulerIntegrator {\r\n    static integrate(transform, motion, totalAcc, elapsedMs) {\r\n        const seconds = elapsedMs / 1000;\r\n        motion.vel.addEqual(totalAcc.scale(seconds));\r\n        transform.pos.addEqual(motion.vel.scale(seconds)).addEqual(totalAcc.scale(0.5 * seconds * seconds));\r\n        motion.angularVelocity += motion.torque * (1.0 / motion.inertia) * seconds;\r\n        transform.rotation += motion.angularVelocity * seconds;\r\n        transform.scale.addEqual(motion.scaleFactor.scale(seconds));\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/MotionSystem.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass MotionSystem extends System {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.types = ['ex.transform', 'ex.motion'];\r\n        this.systemType = SystemType.Update;\r\n        this.priority = -1;\r\n    }\r\n    update(_entities, elapsedMs) {\r\n        let transform;\r\n        let motion;\r\n        for (const entity of _entities) {\r\n            transform = entity.get(TransformComponent);\r\n            motion = entity.get(MotionComponent);\r\n            const optionalBody = entity.get(BodyComponent);\r\n            if (optionalBody === null || optionalBody === void 0 ? void 0 : optionalBody.sleeping) {\r\n                continue;\r\n            }\r\n            const totalAcc = motion.acc.clone();\r\n            if ((optionalBody === null || optionalBody === void 0 ? void 0 : optionalBody.collisionType) === CollisionType.Active && (optionalBody === null || optionalBody === void 0 ? void 0 : optionalBody.useGravity)) {\r\n                totalAcc.addEqual(Physics.gravity);\r\n            }\r\n            optionalBody === null || optionalBody === void 0 ? void 0 : optionalBody.captureOldTransform();\r\n            // Update transform and motion based on Euler linear algebra\r\n            EulerIntegrator.integrate(transform, motion, totalAcc, elapsedMs);\r\n        }\r\n    }\r\n    debugDraw(_ctx) {\r\n        // pass\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Solver/Solver.ts\n/**\r\n * A collision solver figures out how to position colliders such that they are no longer overlapping\r\n *\r\n * Solvers are executed in the order\r\n *\r\n * 1. preSolve\r\n * 2. solveVelocity\r\n * 3. solvePosition\r\n * 4. postSolve\r\n * @inheritdoc\r\n */\r\nclass CollisionSolver {\r\n    /**\r\n     * Solves overlapping contact in\r\n     *\r\n     * Solvers are executed in the order\r\n     * 1. preSolve\r\n     * 2. solveVelocity\r\n     * 3. solvePosition\r\n     * 4. postSolve\r\n     * @param contacts\r\n     */\r\n    solve(contacts) {\r\n        // Events and init\r\n        this.preSolve(contacts);\r\n        // Remove any canceled contacts\r\n        contacts = contacts.filter(c => !c.isCanceled());\r\n        // Solve velocity first\r\n        this.solveVelocity(contacts);\r\n        // Solve position last because non-overlap is the most important\r\n        this.solvePosition(contacts);\r\n        // Events and any contact house-keeping the solver needs\r\n        this.postSolve(contacts);\r\n        return contacts;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Solver/ArcadeSolver.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * ArcadeSolver is the default in Excalibur. It solves collisions so that there is no overlap between contacts,\r\n * and negates velocity along the collision normal.\r\n *\r\n * This is usually the type of collisions used for 2D games that don't need a more realistic collision simulation.\r\n *\r\n */\r\nclass ArcadeSolver extends CollisionSolver {\r\n    preSolve(contacts) {\r\n        for (const contact of contacts) {\r\n            const side = Side.fromDirection(contact.mtv);\r\n            const mtv = contact.mtv.negate();\r\n            // Publish collision events on both participants\r\n            contact.colliderA.events.emit('precollision', new PreCollisionEvent(contact.colliderA, contact.colliderB, side, mtv));\r\n            contact.colliderB.events.emit('precollision', new PreCollisionEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), mtv.negate()));\r\n        }\r\n    }\r\n    postSolve(contacts) {\r\n        var _a, _b;\r\n        for (const contact of contacts) {\r\n            const colliderA = contact.colliderA;\r\n            const colliderB = contact.colliderB;\r\n            const bodyA = (_a = colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n            const bodyB = (_b = colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n            if (bodyA && bodyB) {\r\n                if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\r\n                    continue;\r\n                }\r\n            }\r\n            const side = Side.fromDirection(contact.mtv);\r\n            const mtv = contact.mtv.negate();\r\n            // Publish collision events on both participants\r\n            contact.colliderA.events.emit('postcollision', new PostCollisionEvent(contact.colliderA, contact.colliderB, side, mtv));\r\n            contact.colliderB.events.emit('postcollision', new PostCollisionEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), mtv.negate()));\r\n        }\r\n    }\r\n    solvePosition(contacts) {\r\n        var _a, _b;\r\n        for (const contact of contacts) {\r\n            let mtv = contact.mtv;\r\n            const colliderA = contact.colliderA;\r\n            const colliderB = contact.colliderB;\r\n            const bodyA = (_a = colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n            const bodyB = (_b = colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n            if (bodyA && bodyB) {\r\n                if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\r\n                    continue;\r\n                }\r\n                if (bodyA.collisionType === CollisionType.Active && bodyB.collisionType === CollisionType.Active) {\r\n                    // split overlaps if both are Active\r\n                    mtv = mtv.scale(0.5);\r\n                }\r\n                // Resolve overlaps\r\n                if (bodyA.collisionType === CollisionType.Active) {\r\n                    bodyA.pos.x -= mtv.x;\r\n                    bodyA.pos.y -= mtv.y;\r\n                }\r\n                if (bodyB.collisionType === CollisionType.Active) {\r\n                    bodyB.pos.x += mtv.x;\r\n                    bodyB.pos.y += mtv.y;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    solveVelocity(contacts) {\r\n        var _a, _b;\r\n        for (const contact of contacts) {\r\n            const colliderA = contact.colliderA;\r\n            const colliderB = contact.colliderB;\r\n            const bodyA = (_a = colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n            const bodyB = (_b = colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n            if (bodyA && bodyB) {\r\n                if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\r\n                    continue;\r\n                }\r\n                const normal = contact.normal;\r\n                const opposite = normal.negate();\r\n                // Cancel out velocity opposite direction of collision normal\r\n                if (bodyA.collisionType === CollisionType.Active) {\r\n                    const velAdj = normal.scale(normal.dot(bodyA.vel.negate()));\r\n                    bodyA.vel = bodyA.vel.add(velAdj);\r\n                }\r\n                if (bodyB.collisionType === CollisionType.Active) {\r\n                    const velAdj = opposite.scale(opposite.dot(bodyB.vel.negate()));\r\n                    bodyB.vel = bodyB.vel.add(velAdj);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Solver/ContactConstraintPoint.ts\n\r\n\r\n/**\r\n * Holds information about contact points, meant to be reused over multiple frames of contact\r\n */\r\nclass ContactConstraintPoint {\r\n    constructor(point, local, contact) {\r\n        this.point = point;\r\n        this.local = local;\r\n        this.contact = contact;\r\n        /**\r\n         * Impulse accumulated over time in normal direction\r\n         */\r\n        this.normalImpulse = 0;\r\n        /**\r\n         * Impulse accumulated over time in the tangent direction\r\n         */\r\n        this.tangentImpulse = 0;\r\n        /**\r\n         * Effective mass seen in the normal direction\r\n         */\r\n        this.normalMass = 0;\r\n        /**\r\n         * Effective mass seen in the tangent direction\r\n         */\r\n        this.tangentMass = 0;\r\n        /**\r\n         * Direction from center of mass of bodyA to contact point\r\n         */\r\n        this.aToContact = new Vector(0, 0);\r\n        /**\r\n         * Direction from center of mass of bodyB to contact point\r\n         */\r\n        this.bToContact = new Vector(0, 0);\r\n        this.update();\r\n    }\r\n    /**\r\n     * Updates the contact information\r\n     */\r\n    update() {\r\n        var _a, _b;\r\n        const bodyA = (_a = this.contact.colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n        const bodyB = (_b = this.contact.colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n        if (bodyA && bodyB) {\r\n            const normal = this.contact.normal;\r\n            const tangent = this.contact.tangent;\r\n            this.aToContact = this.point.sub(bodyA.pos);\r\n            this.bToContact = this.point.sub(bodyB.pos);\r\n            const aToContactNormal = this.aToContact.cross(normal);\r\n            const bToContactNormal = this.bToContact.cross(normal);\r\n            this.normalMass =\r\n                bodyA.inverseMass +\r\n                    bodyB.inverseMass +\r\n                    bodyA.inverseInertia * aToContactNormal * aToContactNormal +\r\n                    bodyB.inverseInertia * bToContactNormal * bToContactNormal;\r\n            const aToContactTangent = this.aToContact.cross(tangent);\r\n            const bToContactTangent = this.bToContact.cross(tangent);\r\n            this.tangentMass =\r\n                bodyA.inverseMass +\r\n                    bodyB.inverseMass +\r\n                    bodyA.inverseInertia * aToContactTangent * aToContactTangent +\r\n                    bodyB.inverseInertia * bToContactTangent * bToContactTangent;\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Returns the relative velocity betwen bodyA and bodyB\r\n     */\r\n    getRelativeVelocity() {\r\n        var _a, _b;\r\n        const bodyA = (_a = this.contact.colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n        const bodyB = (_b = this.contact.colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n        if (bodyA && bodyB) {\r\n            // Relative velocity in linear terms\r\n            // Angular to linear velocity formula -> omega = velocity/radius so omega x radius = velocity\r\n            const velA = bodyA.vel.add(Vector.cross(bodyA.angularVelocity, this.aToContact));\r\n            const velB = bodyB.vel.add(Vector.cross(bodyB.angularVelocity, this.bToContact));\r\n            return velB.sub(velA);\r\n        }\r\n        return Vector.Zero;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Solver/RealisticSolver.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass RealisticSolver extends CollisionSolver {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.lastFrameContacts = new Map();\r\n        // map contact id to contact points\r\n        this.idToContactConstraint = new Map();\r\n    }\r\n    getContactConstraints(id) {\r\n        var _a;\r\n        return (_a = this.idToContactConstraint.get(id)) !== null && _a !== void 0 ? _a : [];\r\n    }\r\n    preSolve(contacts) {\r\n        var _a, _b, _c;\r\n        for (const contact of contacts) {\r\n            // Publish collision events on both participants\r\n            const side = Side.fromDirection(contact.mtv);\r\n            contact.colliderA.events.emit('precollision', new PreCollisionEvent(contact.colliderA, contact.colliderB, side, contact.mtv));\r\n            contact.colliderA.events.emit('beforecollisionresolve', new CollisionPreSolveEvent(contact.colliderA, contact.colliderB, side, contact.mtv, contact));\r\n            contact.colliderB.events.emit('precollision', new PreCollisionEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), contact.mtv.negate()));\r\n            contact.colliderB.events.emit('beforecollisionresolve', new CollisionPreSolveEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), contact.mtv.negate(), contact));\r\n            // Match awake state for sleeping\r\n            contact.matchAwake();\r\n        }\r\n        // Keep track of contacts that done\r\n        const finishedContactIds = Array.from(this.idToContactConstraint.keys());\r\n        for (const contact of contacts) {\r\n            // Remove all current contacts that are not done\r\n            const index = finishedContactIds.indexOf(contact.id);\r\n            if (index > -1) {\r\n                finishedContactIds.splice(index, 1);\r\n            }\r\n            const contactPoints = (_a = this.idToContactConstraint.get(contact.id)) !== null && _a !== void 0 ? _a : [];\r\n            let pointIndex = 0;\r\n            const bodyA = contact.colliderA.owner.get(BodyComponent);\r\n            const bodyB = contact.colliderB.owner.get(BodyComponent);\r\n            if (bodyA && bodyB) {\r\n                for (const point of contact.points) {\r\n                    const normal = contact.normal;\r\n                    const tangent = contact.tangent;\r\n                    const aToContact = point.sub(bodyA.pos);\r\n                    const bToContact = point.sub(bodyB.pos);\r\n                    const aToContactNormal = aToContact.cross(normal);\r\n                    const bToContactNormal = bToContact.cross(normal);\r\n                    const normalMass = bodyA.inverseMass +\r\n                        bodyB.inverseMass +\r\n                        bodyA.inverseInertia * aToContactNormal * aToContactNormal +\r\n                        bodyB.inverseInertia * bToContactNormal * bToContactNormal;\r\n                    const aToContactTangent = aToContact.cross(tangent);\r\n                    const bToContactTangent = bToContact.cross(tangent);\r\n                    const tangentMass = bodyA.inverseMass +\r\n                        bodyB.inverseMass +\r\n                        bodyA.inverseInertia * aToContactTangent * aToContactTangent +\r\n                        bodyB.inverseInertia * bToContactTangent * bToContactTangent;\r\n                    // Preserve normal/tangent impulse by re-using the contact point if it's close\r\n                    if (contactPoints[pointIndex] && ((_c = (_b = contactPoints[pointIndex]) === null || _b === void 0 ? void 0 : _b.point) === null || _c === void 0 ? void 0 : _c.squareDistance(point)) < 4) {\r\n                        contactPoints[pointIndex].point = point;\r\n                        contactPoints[pointIndex].local = contact.localPoints[pointIndex];\r\n                    }\r\n                    else {\r\n                        // new contact if it's not close or doesn't exist\r\n                        contactPoints[pointIndex] = new ContactConstraintPoint(point, contact.localPoints[pointIndex], contact);\r\n                    }\r\n                    // Update contact point calculations\r\n                    contactPoints[pointIndex].aToContact = aToContact;\r\n                    contactPoints[pointIndex].bToContact = bToContact;\r\n                    contactPoints[pointIndex].normalMass = normalMass;\r\n                    contactPoints[pointIndex].tangentMass = tangentMass;\r\n                    pointIndex++;\r\n                }\r\n            }\r\n            this.idToContactConstraint.set(contact.id, contactPoints);\r\n        }\r\n        // Clean up any contacts that did not occur last frame\r\n        for (const id of finishedContactIds) {\r\n            this.idToContactConstraint.delete(id);\r\n        }\r\n        // Warm contacts with accumulated impulse\r\n        // Useful for tall stacks\r\n        if (Physics.warmStart) {\r\n            this.warmStart(contacts);\r\n        }\r\n        else {\r\n            for (const contact of contacts) {\r\n                const contactPoints = this.getContactConstraints(contact.id);\r\n                for (const point of contactPoints) {\r\n                    point.normalImpulse = 0;\r\n                    point.tangentImpulse = 0;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    postSolve(contacts) {\r\n        for (const contact of contacts) {\r\n            const bodyA = contact.colliderA.owner.get(BodyComponent);\r\n            const bodyB = contact.colliderB.owner.get(BodyComponent);\r\n            if (bodyA && bodyB) {\r\n                // Skip post solve for active+passive collisions\r\n                if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\r\n                    continue;\r\n                }\r\n                // Update motion values for sleeping\r\n                bodyA.updateMotion();\r\n                bodyB.updateMotion();\r\n            }\r\n            // Publish collision events on both participants\r\n            const side = Side.fromDirection(contact.mtv);\r\n            contact.colliderA.events.emit('postcollision', new PostCollisionEvent(contact.colliderA, contact.colliderB, side, contact.mtv));\r\n            contact.colliderA.events.emit('aftercollisionresolve', new CollisionPostSolveEvent(contact.colliderA, contact.colliderB, side, contact.mtv, contact));\r\n            contact.colliderB.events.emit('postcollision', new PostCollisionEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), contact.mtv.negate()));\r\n            contact.colliderB.events.emit('aftercollisionresolve', new CollisionPostSolveEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), contact.mtv.negate(), contact));\r\n        }\r\n        // Store contacts\r\n        this.lastFrameContacts.clear();\r\n        for (const c of contacts) {\r\n            this.lastFrameContacts.set(c.id, c);\r\n        }\r\n    }\r\n    /**\r\n     * Warm up body's based on previous frame contact points\r\n     * @param contacts\r\n     */\r\n    warmStart(contacts) {\r\n        var _a, _b, _c;\r\n        for (const contact of contacts) {\r\n            const bodyA = (_a = contact.colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n            const bodyB = (_b = contact.colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n            if (bodyA && bodyB) {\r\n                const contactPoints = (_c = this.idToContactConstraint.get(contact.id)) !== null && _c !== void 0 ? _c : [];\r\n                for (const point of contactPoints) {\r\n                    if (Physics.warmStart) {\r\n                        const normalImpulse = contact.normal.scale(point.normalImpulse);\r\n                        const tangentImpulse = contact.tangent.scale(point.tangentImpulse);\r\n                        const impulse = normalImpulse.add(tangentImpulse);\r\n                        bodyA.applyImpulse(point.point, impulse.negate());\r\n                        bodyB.applyImpulse(point.point, impulse);\r\n                    }\r\n                    else {\r\n                        point.normalImpulse = 0;\r\n                        point.tangentImpulse = 0;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Iteratively solve the position overlap constraint\r\n     * @param contacts\r\n     */\r\n    solvePosition(contacts) {\r\n        var _a, _b, _c;\r\n        for (let i = 0; i < Physics.positionIterations; i++) {\r\n            for (const contact of contacts) {\r\n                const bodyA = (_a = contact.colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n                const bodyB = (_b = contact.colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n                if (bodyA && bodyB) {\r\n                    // Skip solving active+passive\r\n                    if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\r\n                        continue;\r\n                    }\r\n                    const constraints = (_c = this.idToContactConstraint.get(contact.id)) !== null && _c !== void 0 ? _c : [];\r\n                    for (const point of constraints) {\r\n                        const normal = contact.normal;\r\n                        const separation = CollisionJumpTable.FindContactSeparation(contact, point.local);\r\n                        const steeringConstant = Physics.steeringFactor; //0.2;\r\n                        const maxCorrection = -5;\r\n                        const slop = Physics.slop; //1;\r\n                        // Clamp to avoid over-correction\r\n                        // Remember that we are shooting for 0 overlap in the end\r\n                        const steeringForce = clamp(steeringConstant * (separation + slop), maxCorrection, 0);\r\n                        const impulse = normal.scale(-steeringForce / point.normalMass);\r\n                        // This is a pseudo impulse, meaning we aren't doing a real impulse calculation\r\n                        // We adjust position and rotation instead of doing the velocity\r\n                        if (bodyA.collisionType === CollisionType.Active) {\r\n                            bodyA.pos = bodyA.pos.add(impulse.negate().scale(bodyA.inverseMass));\r\n                            bodyA.rotation -= point.aToContact.cross(impulse) * bodyA.inverseInertia;\r\n                        }\r\n                        if (bodyB.collisionType === CollisionType.Active) {\r\n                            bodyB.pos = bodyB.pos.add(impulse.scale(bodyB.inverseMass));\r\n                            bodyB.rotation += point.bToContact.cross(impulse) * bodyB.inverseInertia;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    solveVelocity(contacts) {\r\n        var _a, _b, _c;\r\n        for (let i = 0; i < Physics.velocityIterations; i++) {\r\n            for (const contact of contacts) {\r\n                const bodyA = (_a = contact.colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n                const bodyB = (_b = contact.colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n                if (bodyA && bodyB) {\r\n                    // Skip solving active+passive\r\n                    if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\r\n                        continue;\r\n                    }\r\n                    const restitution = bodyA.bounciness * bodyB.bounciness;\r\n                    const friction = Math.min(bodyA.friction, bodyB.friction);\r\n                    const constraints = (_c = this.idToContactConstraint.get(contact.id)) !== null && _c !== void 0 ? _c : [];\r\n                    for (const point of constraints) {\r\n                        const relativeVelocity = point.getRelativeVelocity();\r\n                        // Negate velocity in tangent direction to simulate friction\r\n                        const tangentVelocity = -relativeVelocity.dot(contact.tangent);\r\n                        let impulseDelta = tangentVelocity / point.tangentMass;\r\n                        // Clamping based in Erin Catto's GDC 2006 talk\r\n                        // Correct clamping https://github.com/erincatto/box2d-lite/blob/master/docs/GDC2006_Catto_Erin_PhysicsTutorial.pdf\r\n                        // Accumulated fiction impulse is always between -uMaxFriction < dT < uMaxFriction\r\n                        // But deltas can vary\r\n                        const maxFriction = friction * point.normalImpulse;\r\n                        const newImpulse = clamp(point.tangentImpulse + impulseDelta, -maxFriction, maxFriction);\r\n                        impulseDelta = newImpulse - point.tangentImpulse;\r\n                        point.tangentImpulse = newImpulse;\r\n                        const impulse = contact.tangent.scale(impulseDelta);\r\n                        bodyA.applyImpulse(point.point, impulse.negate());\r\n                        bodyB.applyImpulse(point.point, impulse);\r\n                    }\r\n                    for (const point of constraints) {\r\n                        // Need to recalc relative velocity because the previous step could have changed vel\r\n                        const relativeVelocity = point.getRelativeVelocity();\r\n                        // Compute impulse in normal direction\r\n                        const normalVelocity = relativeVelocity.dot(contact.normal);\r\n                        // See https://en.wikipedia.org/wiki/Collision_response\r\n                        let impulseDelta = (-(1 + restitution) * normalVelocity) / point.normalMass;\r\n                        // Clamping based in Erin Catto's GDC 2014 talk\r\n                        // Accumulated impulse stored in the contact is always positive (dV > 0)\r\n                        // But deltas can be negative\r\n                        const newImpulse = Math.max(point.normalImpulse + impulseDelta, 0);\r\n                        impulseDelta = newImpulse - point.normalImpulse;\r\n                        point.normalImpulse = newImpulse;\r\n                        const impulse = contact.normal.scale(impulseDelta);\r\n                        bodyA.applyImpulse(point.point, impulse.negate());\r\n                        bodyB.applyImpulse(point.point, impulse);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/CollisionSystem.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass CollisionSystem extends System {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.types = ['ex.transform', 'ex.motion', 'ex.collider'];\r\n        this.systemType = SystemType.Update;\r\n        this.priority = -1;\r\n        this._realisticSolver = new RealisticSolver();\r\n        this._arcadeSolver = new ArcadeSolver();\r\n        this._processor = new DynamicTreeCollisionProcessor();\r\n        this._lastFrameContacts = new Map();\r\n        this._currentFrameContacts = new Map();\r\n        this._trackCollider = (c) => this._processor.track(c);\r\n        this._untrackCollider = (c) => this._processor.untrack(c);\r\n    }\r\n    notify(message) {\r\n        if (isAddedSystemEntity(message)) {\r\n            const colliderComponent = message.data.get(ColliderComponent);\r\n            colliderComponent.$colliderAdded.subscribe(this._trackCollider);\r\n            colliderComponent.$colliderRemoved.subscribe(this._untrackCollider);\r\n            const collider = colliderComponent.get();\r\n            if (collider) {\r\n                this._processor.track(collider);\r\n            }\r\n        }\r\n        else {\r\n            const colliderComponent = message.data.get(ColliderComponent);\r\n            const collider = colliderComponent.get();\r\n            if (colliderComponent && collider) {\r\n                this._processor.untrack(collider);\r\n            }\r\n        }\r\n    }\r\n    initialize(scene) {\r\n        this._engine = scene.engine;\r\n    }\r\n    update(_entities, elapsedMs) {\r\n        var _a;\r\n        if (!Physics.enabled) {\r\n            return;\r\n        }\r\n        // Collect up all the colliders\r\n        let colliders = [];\r\n        for (const entity of _entities) {\r\n            const colliderComp = entity.get(ColliderComponent);\r\n            const collider = colliderComp === null || colliderComp === void 0 ? void 0 : colliderComp.get();\r\n            if (colliderComp && ((_a = colliderComp.owner) === null || _a === void 0 ? void 0 : _a.active) && collider) {\r\n                colliderComp.update();\r\n                if (collider instanceof CompositeCollider) {\r\n                    colliders = colliders.concat(collider.getColliders());\r\n                }\r\n                else {\r\n                    colliders.push(collider);\r\n                }\r\n            }\r\n        }\r\n        // Update the spatial partitioning data structures\r\n        // TODO if collider invalid it will break the processor\r\n        // TODO rename \"update\" to something more specific\r\n        this._processor.update(colliders);\r\n        // Run broadphase on all colliders and locates potential collisions\r\n        const pairs = this._processor.broadphase(colliders, elapsedMs);\r\n        this._currentFrameContacts.clear();\r\n        // Given possible pairs find actual contacts\r\n        let contacts = this._processor.narrowphase(pairs, this._engine.debug.stats.currFrame);\r\n        const solver = this.getSolver();\r\n        // Solve, this resolves the position/velocity so entities arent overlapping\r\n        contacts = solver.solve(contacts);\r\n        // Record contacts\r\n        contacts.forEach((c) => this._currentFrameContacts.set(c.id, c));\r\n        // Emit contact start/end events\r\n        this.runContactStartEnd();\r\n        // reset the last frame cache\r\n        this._lastFrameContacts.clear();\r\n        // Keep track of collisions contacts that have started or ended\r\n        this._lastFrameContacts = new Map(this._currentFrameContacts);\r\n    }\r\n    getSolver() {\r\n        return Physics.collisionResolutionStrategy === CollisionResolutionStrategy.Realistic ? this._realisticSolver : this._arcadeSolver;\r\n    }\r\n    debug(ex) {\r\n        this._processor.debug(ex);\r\n    }\r\n    runContactStartEnd() {\r\n        for (const [id, c] of this._currentFrameContacts) {\r\n            // find all new contacts\r\n            if (!this._lastFrameContacts.has(id)) {\r\n                const colliderA = c.colliderA;\r\n                const colliderB = c.colliderB;\r\n                colliderA.events.emit('collisionstart', new CollisionStartEvent(colliderA, colliderB, c));\r\n                colliderA.events.emit('contactstart', new ContactStartEvent(colliderA, colliderB, c));\r\n                colliderB.events.emit('collisionstart', new CollisionStartEvent(colliderB, colliderA, c));\r\n                colliderB.events.emit('contactstart', new ContactStartEvent(colliderB, colliderA, c));\r\n            }\r\n        }\r\n        // find all contacts taht have ceased\r\n        for (const [id, c] of this._lastFrameContacts) {\r\n            if (!this._currentFrameContacts.has(id)) {\r\n                const colliderA = c.colliderA;\r\n                const colliderB = c.colliderB;\r\n                colliderA.events.emit('collisionend', new CollisionEndEvent(colliderA, colliderB));\r\n                colliderA.events.emit('contactend', new ContactEndEvent(colliderA, colliderB));\r\n                colliderB.events.emit('collisionend', new CollisionEndEvent(colliderB, colliderA));\r\n                colliderB.events.emit('contactend', new ContactEndEvent(colliderB, colliderA));\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Animation.ts\n\r\n\r\n\r\n\r\n\r\n\r\nvar AnimationDirection;\r\n(function (AnimationDirection) {\r\n    /**\r\n     * Animation is playing forwards\r\n     */\r\n    AnimationDirection[\"Forward\"] = \"forward\";\r\n    /**\r\n     * Animation is play backwards\r\n     */\r\n    AnimationDirection[\"Backward\"] = \"backward\";\r\n})(AnimationDirection || (AnimationDirection = {}));\r\nvar AnimationStrategy;\r\n(function (AnimationStrategy) {\r\n    /**\r\n     * Animation ends without displaying anything\r\n     */\r\n    AnimationStrategy[\"End\"] = \"end\";\r\n    /**\r\n     * Animation loops to the first frame after the last frame\r\n     */\r\n    AnimationStrategy[\"Loop\"] = \"loop\";\r\n    /**\r\n     * Animation plays to the last frame, then backwards to the first frame, then repeats\r\n     */\r\n    AnimationStrategy[\"PingPong\"] = \"pingpong\";\r\n    /**\r\n     * Animation ends stopping on the last frame\r\n     */\r\n    AnimationStrategy[\"Freeze\"] = \"freeze\";\r\n})(AnimationStrategy || (AnimationStrategy = {}));\r\n/**\r\n * Create an Animation given a list of [[Frame|frames]] in [[AnimationOptions]]\r\n *\r\n * To create an Animation from a [[SpriteSheet]], use [[Animation.fromSpriteSheet]]\r\n */\r\nclass Animation extends Graphic {\r\n    constructor(options) {\r\n        var _a, _b;\r\n        super(options);\r\n        this.events = new EventDispatcher(this); // TODO replace with new Emitter\r\n        this.frames = [];\r\n        this.strategy = AnimationStrategy.Loop;\r\n        this.frameDuration = 100;\r\n        this.timeScale = 1;\r\n        this._idempotencyToken = -1;\r\n        this._firstTick = true;\r\n        this._currentFrame = 0;\r\n        this._timeLeftInFrame = 0;\r\n        this._direction = 1; // TODO only used in ping-pong\r\n        this._done = false;\r\n        this._playing = true;\r\n        this._reversed = false;\r\n        this.frames = options.frames;\r\n        this.strategy = (_a = options.strategy) !== null && _a !== void 0 ? _a : this.strategy;\r\n        this.frameDuration = options.totalDuration ? options.totalDuration / this.frames.length : (_b = options.frameDuration) !== null && _b !== void 0 ? _b : this.frameDuration;\r\n        if (options.reverse) {\r\n            this.reverse();\r\n        }\r\n        this.goToFrame(0);\r\n    }\r\n    clone() {\r\n        return new Animation(Object.assign({ frames: this.frames.map((f) => (Object.assign({}, f))), frameDuration: this.frameDuration, reverse: this._reversed, strategy: this.strategy }, this.cloneGraphicOptions()));\r\n    }\r\n    /**\r\n     * Create an Animation from a [[SpriteSheet]], a list of indices into the sprite sheet, a duration per frame\r\n     * and optional [[AnimationStrategy]]\r\n     *\r\n     * Example:\r\n     * ```typescript\r\n     * const spriteSheet = SpriteSheet.fromImageSource({...});\r\n     *\r\n     * const anim = Animation.fromSpriteSheet(spriteSheet, range(0, 5), 200, AnimationStrategy.Loop);\r\n     * ```\r\n     *\r\n     * @param spriteSheet\r\n     * @param frameIndices\r\n     * @param durationPerFrameMs\r\n     * @param strategy\r\n     */\r\n    static fromSpriteSheet(spriteSheet, frameIndices, durationPerFrameMs, strategy = AnimationStrategy.Loop) {\r\n        const maxIndex = spriteSheet.sprites.length - 1;\r\n        const invalidIndices = frameIndices.filter((index) => index < 0 || index > maxIndex);\r\n        if (invalidIndices.length) {\r\n            Animation._LOGGER.warn(`Indices into SpriteSheet were provided that don\\'t exist: ${invalidIndices.join(',')} no frame will be shown`);\r\n        }\r\n        return new Animation({\r\n            frames: spriteSheet.sprites\r\n                .filter((_, index) => frameIndices.indexOf(index) > -1)\r\n                .map((f) => ({\r\n                graphic: f,\r\n                duration: durationPerFrameMs\r\n            })),\r\n            strategy: strategy\r\n        });\r\n    }\r\n    /**\r\n     * Converts an animation to a legacy animation\r\n     * @deprecated\r\n     * @param engine\r\n     * @param animation\r\n     * @returns LegacyDrawing.Animation\r\n     */\r\n    static toLegacyAnimation(engine, animation) {\r\n        const legacySprites = animation.frames.map(f => Sprite.toLegacySprite(f.graphic));\r\n        return new Animation_Animation({\r\n            sprites: legacySprites,\r\n            loop: animation.strategy === AnimationStrategy.Loop,\r\n            freezeFrame: animation.strategy === AnimationStrategy.Freeze ? legacySprites.length - 1 : undefined,\r\n            speed: animation.frameDuration,\r\n            engine: engine\r\n        });\r\n    }\r\n    /**\r\n     * Returns the current Frame of the animation\r\n     */\r\n    get currentFrame() {\r\n        if (this._currentFrame >= 0 && this._currentFrame < this.frames.length) {\r\n            return this.frames[this._currentFrame];\r\n        }\r\n        return null;\r\n    }\r\n    /**\r\n     * Returns the current frame index of the animation\r\n     */\r\n    get currentFrameIndex() {\r\n        return this._currentFrame;\r\n    }\r\n    /**\r\n     * Returns `true` if the animation is playing\r\n     */\r\n    get isPlaying() {\r\n        return this._playing;\r\n    }\r\n    /**\r\n     * Reverses the play direction of the Animation, this preserves the current frame\r\n     */\r\n    reverse() {\r\n        // Don't mutate with the original frame list, create a copy\r\n        this.frames = this.frames.slice().reverse();\r\n        this._reversed = !this._reversed;\r\n    }\r\n    /**\r\n     * Returns the current play direction of the animation\r\n     */\r\n    get direction() {\r\n        // Keep logically consistent with ping-pong direction\r\n        // If ping-pong is forward = 1 and reversed is true then we are logically reversed\r\n        const reversed = (this._reversed && this._direction === 1) ? true : false;\r\n        return reversed ? AnimationDirection.Backward : AnimationDirection.Forward;\r\n    }\r\n    /**\r\n     * Plays or resumes the animation from the current frame\r\n     */\r\n    play() {\r\n        this._playing = true;\r\n    }\r\n    /**\r\n     * Pauses the animation on the current frame\r\n     */\r\n    pause() {\r\n        this._playing = false;\r\n        this._firstTick = true; // firstTick must be set to emit the proper frame event\r\n    }\r\n    /**\r\n     * Reset the animation back to the beginning, including if the animation were done\r\n     */\r\n    reset() {\r\n        this._done = false;\r\n        this._firstTick = true;\r\n        this._currentFrame = 0;\r\n    }\r\n    /**\r\n     * Returns `true` if the animation can end\r\n     */\r\n    get canFinish() {\r\n        switch (this.strategy) {\r\n            case AnimationStrategy.End:\r\n            case AnimationStrategy.Freeze: {\r\n                return true;\r\n            }\r\n            default: {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Returns `true` if the animation is done, for looping type animations\r\n     * `ex.AnimationStrategy.PingPong` and `ex.AnimationStrategy.Loop` this will always return `false`\r\n     *\r\n     * See the `ex.Animation.canFinish()` method to know if an animation type can end\r\n     */\r\n    get done() {\r\n        return this._done;\r\n    }\r\n    /**\r\n     * Jump the animation immediately to a specific frame if it exists\r\n     * @param frameNumber\r\n     */\r\n    goToFrame(frameNumber) {\r\n        var _a, _b;\r\n        this._currentFrame = frameNumber;\r\n        this._timeLeftInFrame = this.frameDuration;\r\n        const maybeFrame = this.frames[this._currentFrame];\r\n        if (maybeFrame && !this._done) {\r\n            this._timeLeftInFrame = (maybeFrame === null || maybeFrame === void 0 ? void 0 : maybeFrame.duration) || this.frameDuration;\r\n            this.width = (_a = maybeFrame.graphic) === null || _a === void 0 ? void 0 : _a.width;\r\n            this.height = (_b = maybeFrame.graphic) === null || _b === void 0 ? void 0 : _b.height;\r\n            this.events.emit('frame', maybeFrame);\r\n        }\r\n    }\r\n    _nextFrame() {\r\n        const currentFrame = this._currentFrame;\r\n        if (this._done) {\r\n            return currentFrame;\r\n        }\r\n        let next = -1;\r\n        switch (this.strategy) {\r\n            case AnimationStrategy.Loop: {\r\n                next = (currentFrame + 1) % this.frames.length;\r\n                if (next === 0) {\r\n                    this.events.emit('loop', this);\r\n                }\r\n                break;\r\n            }\r\n            case AnimationStrategy.End: {\r\n                next = currentFrame + 1;\r\n                if (next >= this.frames.length) {\r\n                    this._done = true;\r\n                    this._currentFrame = this.frames.length;\r\n                    this.events.emit('end', this);\r\n                }\r\n                break;\r\n            }\r\n            case AnimationStrategy.Freeze: {\r\n                next = clamp(currentFrame + 1, 0, this.frames.length - 1);\r\n                if (next >= this.frames.length - 1) {\r\n                    this._done = true;\r\n                    this.events.emit('end', this);\r\n                }\r\n                break;\r\n            }\r\n            case AnimationStrategy.PingPong: {\r\n                if (currentFrame + this._direction >= this.frames.length) {\r\n                    this._direction = -1;\r\n                    this.events.emit('loop', this);\r\n                }\r\n                if (currentFrame + this._direction < 0) {\r\n                    this._direction = 1;\r\n                    this.events.emit('loop', this);\r\n                }\r\n                next = currentFrame + (this._direction % this.frames.length);\r\n                break;\r\n            }\r\n        }\r\n        return next;\r\n    }\r\n    /**\r\n     * Called internally by Excalibur to update the state of the animation potential update the current frame\r\n     * @param elapsedMilliseconds Milliseconds elapsed\r\n     * @param idempotencyToken Prevents double ticking in a frame by passing a unique token to the frame\r\n     */\r\n    tick(elapsedMilliseconds, idempotencyToken = 0) {\r\n        if (this._idempotencyToken === idempotencyToken) {\r\n            return;\r\n        }\r\n        this._idempotencyToken = idempotencyToken;\r\n        if (!this._playing) {\r\n            return;\r\n        }\r\n        // if it's the first frame emit frame event\r\n        if (this._firstTick) {\r\n            this._firstTick = false;\r\n            this.events.emit('frame', this.currentFrame);\r\n        }\r\n        this._timeLeftInFrame -= elapsedMilliseconds * this.timeScale;\r\n        if (this._timeLeftInFrame <= 0) {\r\n            this.goToFrame(this._nextFrame());\r\n        }\r\n        this._updateDimensions();\r\n    }\r\n    _updateDimensions() {\r\n        var _a, _b;\r\n        if (this.currentFrame) {\r\n            this.width = (_a = this.currentFrame.graphic) === null || _a === void 0 ? void 0 : _a.width;\r\n            this.height = (_b = this.currentFrame.graphic) === null || _b === void 0 ? void 0 : _b.height;\r\n        }\r\n    }\r\n    _drawImage(ctx, x, y) {\r\n        if (this.currentFrame) {\r\n            this.currentFrame.graphic.draw(ctx, x, y);\r\n        }\r\n    }\r\n}\r\nAnimation._LOGGER = Logger.getInstance();\r\n\n;// CONCATENATED MODULE: ./Graphics/GraphicsGroup.ts\n\r\n\r\n\r\nclass GraphicsGroup extends Graphic {\r\n    constructor(options) {\r\n        super(options);\r\n        this.members = [];\r\n        this.members = options.members;\r\n        this._updateDimensions();\r\n    }\r\n    clone() {\r\n        return new GraphicsGroup(Object.assign({ members: [...this.members] }, this.cloneGraphicOptions()));\r\n    }\r\n    _updateDimensions() {\r\n        let bb = new BoundingBox();\r\n        for (const { graphic, pos } of this.members) {\r\n            bb = graphic.localBounds.translate(pos).combine(bb);\r\n        }\r\n        this.width = bb.width;\r\n        this.height = bb.height;\r\n        return bb;\r\n    }\r\n    get localBounds() {\r\n        let bb = new BoundingBox();\r\n        for (const { graphic, pos } of this.members) {\r\n            bb = graphic.localBounds.translate(pos).combine(bb);\r\n        }\r\n        return bb;\r\n    }\r\n    _isAnimationOrGroup(graphic) {\r\n        return graphic instanceof Animation || graphic instanceof GraphicsGroup;\r\n    }\r\n    tick(elapsedMilliseconds, idempotencyToken) {\r\n        for (const member of this.members) {\r\n            const maybeAnimation = member.graphic;\r\n            if (this._isAnimationOrGroup(maybeAnimation)) {\r\n                maybeAnimation.tick(elapsedMilliseconds, idempotencyToken);\r\n            }\r\n        }\r\n    }\r\n    reset() {\r\n        for (const member of this.members) {\r\n            const maybeAnimation = member.graphic;\r\n            if (this._isAnimationOrGroup(maybeAnimation)) {\r\n                maybeAnimation.reset();\r\n            }\r\n        }\r\n    }\r\n    _preDraw(ex, x, y) {\r\n        this._updateDimensions();\r\n        super._preDraw(ex, x, y);\r\n    }\r\n    _drawImage(ex, x, y) {\r\n        for (const member of this.members) {\r\n            ex.save();\r\n            ex.translate(x, y);\r\n            member.graphic.draw(ex, member.pos.x, member.pos.y);\r\n            if (this.showDebug) {\r\n                /* istanbul ignore next */\r\n                ex.debug.drawRect(0, 0, this.width, this.height);\r\n            }\r\n            ex.restore();\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Particles.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * An enum that represents the types of emitter nozzles\r\n */\r\nvar EmitterType;\r\n(function (EmitterType) {\r\n    /**\r\n     * Constant for the circular emitter type\r\n     */\r\n    EmitterType[EmitterType[\"Circle\"] = 0] = \"Circle\";\r\n    /**\r\n     * Constant for the rectangular emitter type\r\n     */\r\n    EmitterType[EmitterType[\"Rectangle\"] = 1] = \"Rectangle\";\r\n})(EmitterType || (EmitterType = {}));\r\n/**\r\n * @hidden\r\n */\r\nclass ParticleImpl extends Entity {\r\n    constructor(emitterOrConfig, life, opacity, beginColor, endColor, position, velocity, acceleration, startSize, endSize) {\r\n        super();\r\n        this.position = new Vector(0, 0);\r\n        this.velocity = new Vector(0, 0);\r\n        this.acceleration = new Vector(0, 0);\r\n        this.particleRotationalVelocity = 0;\r\n        this.currentRotation = 0;\r\n        this.focus = null;\r\n        this.focusAccel = 0;\r\n        this.opacity = 1;\r\n        this.beginColor = Color.White;\r\n        this.endColor = Color.White;\r\n        // Life is counted in ms\r\n        this.life = 300;\r\n        this.fadeFlag = false;\r\n        // Color transitions\r\n        this._rRate = 1;\r\n        this._gRate = 1;\r\n        this._bRate = 1;\r\n        this._aRate = 0;\r\n        this._currentColor = Color.White;\r\n        this.emitter = null;\r\n        this.particleSize = 5;\r\n        this.particleSprite = null;\r\n        this.sizeRate = 0;\r\n        this.elapsedMultiplier = 0;\r\n        this.visible = true;\r\n        this.isOffscreen = false;\r\n        let emitter = emitterOrConfig;\r\n        if (emitter && !(emitterOrConfig instanceof ParticleEmitter)) {\r\n            const config = emitterOrConfig;\r\n            emitter = config.emitter;\r\n            life = config.life;\r\n            opacity = config.opacity;\r\n            endColor = config.endColor;\r\n            beginColor = config.beginColor;\r\n            position = config.position;\r\n            velocity = config.velocity;\r\n            acceleration = config.acceleration;\r\n            startSize = config.startSize;\r\n            endSize = config.endSize;\r\n        }\r\n        this.emitter = emitter;\r\n        this.life = life || this.life;\r\n        this.opacity = opacity || this.opacity;\r\n        this.endColor = endColor || this.endColor.clone();\r\n        this.beginColor = beginColor || this.beginColor.clone();\r\n        this._currentColor = this.beginColor.clone();\r\n        this.position = (position || this.position).add(this.emitter.pos);\r\n        this.velocity = velocity || this.velocity;\r\n        this.acceleration = acceleration || this.acceleration;\r\n        this._rRate = (this.endColor.r - this.beginColor.r) / this.life;\r\n        this._gRate = (this.endColor.g - this.beginColor.g) / this.life;\r\n        this._bRate = (this.endColor.b - this.beginColor.b) / this.life;\r\n        this._aRate = this.opacity / this.life;\r\n        this.startSize = startSize || 0;\r\n        this.endSize = endSize || 0;\r\n        if (this.endSize > 0 && this.startSize > 0) {\r\n            this.sizeRate = (this.endSize - this.startSize) / this.life;\r\n            this.particleSize = this.startSize;\r\n        }\r\n        this.addComponent((this.transform = new TransformComponent()));\r\n        this.addComponent(new CanvasDrawComponent((ctx) => this.draw(ctx)));\r\n        this.addComponent((this.graphics = new GraphicsComponent()));\r\n        this.transform.pos = this.position;\r\n        this.transform.rotation = this.currentRotation;\r\n        this.transform.scale = vec(1, 1); // TODO wut\r\n        if (this.particleSprite) {\r\n            this.graphics.opacity = this.opacity;\r\n            this.graphics.use(Sprite.fromLegacySprite(this.particleSprite));\r\n        }\r\n        else {\r\n            this.graphics.onPostDraw = (ctx) => {\r\n                ctx.save();\r\n                this.graphics.opacity = this.opacity;\r\n                const tmpColor = this._currentColor.clone();\r\n                tmpColor.a = 1;\r\n                ctx.debug.drawPoint(vec(0, 0), { color: tmpColor, size: this.particleSize });\r\n                ctx.restore();\r\n            };\r\n        }\r\n    }\r\n    kill() {\r\n        this.emitter.removeParticle(this);\r\n    }\r\n    update(_engine, delta) {\r\n        this.life = this.life - delta;\r\n        this.elapsedMultiplier = this.elapsedMultiplier + delta;\r\n        if (this.life < 0) {\r\n            this.kill();\r\n        }\r\n        if (this.fadeFlag) {\r\n            this.opacity = clamp(this._aRate * this.life, 0.0001, 1);\r\n        }\r\n        if (this.startSize > 0 && this.endSize > 0) {\r\n            this.particleSize = clamp(this.sizeRate * delta + this.particleSize, Math.min(this.startSize, this.endSize), Math.max(this.startSize, this.endSize));\r\n        }\r\n        this._currentColor.r = clamp(this._currentColor.r + this._rRate * delta, 0, 255);\r\n        this._currentColor.g = clamp(this._currentColor.g + this._gRate * delta, 0, 255);\r\n        this._currentColor.b = clamp(this._currentColor.b + this._bRate * delta, 0, 255);\r\n        this._currentColor.a = clamp(this.opacity, 0.0001, 1);\r\n        if (this.focus) {\r\n            const accel = this.focus\r\n                .sub(this.position)\r\n                .normalize()\r\n                .scale(this.focusAccel)\r\n                .scale(delta / 1000);\r\n            this.velocity = this.velocity.add(accel);\r\n        }\r\n        else {\r\n            this.velocity = this.velocity.add(this.acceleration.scale(delta / 1000));\r\n        }\r\n        this.position = this.position.add(this.velocity.scale(delta / 1000));\r\n        if (this.particleRotationalVelocity) {\r\n            this.currentRotation = (this.currentRotation + (this.particleRotationalVelocity * delta) / 1000) % (2 * Math.PI);\r\n        }\r\n        this.transform.pos = this.position;\r\n        this.transform.rotation = this.currentRotation;\r\n        this.transform.scale = vec(1, 1); // todo wut\r\n        this.graphics.opacity = this.opacity;\r\n    }\r\n    draw(ctx) {\r\n        if (this.particleSprite) {\r\n            this.particleSprite.opacity(this.opacity);\r\n            this.particleSprite.draw(ctx, 0, 0);\r\n            return;\r\n        }\r\n        ctx.save();\r\n        this._currentColor.a = clamp(this.opacity, 0.0001, 1);\r\n        ctx.fillStyle = this._currentColor.toString();\r\n        ctx.beginPath();\r\n        ctx.arc(0, 0, this.particleSize, 0, Math.PI * 2);\r\n        ctx.fill();\r\n        ctx.closePath();\r\n        ctx.restore();\r\n    }\r\n}\r\n/**\r\n * Particle is used in a [[ParticleEmitter]]\r\n */\r\nclass Particle extends Configurable(ParticleImpl) {\r\n    constructor(emitterOrConfig, life, opacity, beginColor, endColor, position, velocity, acceleration, startSize, endSize) {\r\n        super(emitterOrConfig, life, opacity, beginColor, endColor, position, velocity, acceleration, startSize, endSize);\r\n    }\r\n}\r\n/**\r\n * Using a particle emitter is a great way to create interesting effects\r\n * in your game, like smoke, fire, water, explosions, etc. `ParticleEmitter`\r\n * extend [[Actor]] allowing you to use all of the features that come with.\r\n */\r\nclass ParticleEmitter extends Actor {\r\n    /**\r\n     * @param config particle emitter options bag\r\n     */\r\n    constructor(config) {\r\n        var _a, _b;\r\n        super({ width: (_a = config.width) !== null && _a !== void 0 ? _a : 0, height: (_b = config.height) !== null && _b !== void 0 ? _b : 0 });\r\n        this._particlesToEmit = 0;\r\n        this.numParticles = 0;\r\n        /**\r\n         * Gets or sets the isEmitting flag\r\n         */\r\n        this.isEmitting = true;\r\n        /**\r\n         * Gets or sets the backing particle collection\r\n         */\r\n        this.particles = [];\r\n        /**\r\n         * Gets or sets the backing deadParticle collection\r\n         */\r\n        this.deadParticles = [];\r\n        /**\r\n         * Gets or sets the minimum particle velocity\r\n         */\r\n        this.minVel = 0;\r\n        /**\r\n         * Gets or sets the maximum particle velocity\r\n         */\r\n        this.maxVel = 0;\r\n        /**\r\n         * Gets or sets the acceleration vector for all particles\r\n         */\r\n        this.acceleration = new Vector(0, 0);\r\n        /**\r\n         * Gets or sets the minimum angle in radians\r\n         */\r\n        this.minAngle = 0;\r\n        /**\r\n         * Gets or sets the maximum angle in radians\r\n         */\r\n        this.maxAngle = 0;\r\n        /**\r\n         * Gets or sets the emission rate for particles (particles/sec)\r\n         */\r\n        this.emitRate = 1; //particles/sec\r\n        /**\r\n         * Gets or sets the life of each particle in milliseconds\r\n         */\r\n        this.particleLife = 2000;\r\n        /**\r\n         * Gets or sets the fade flag which causes particles to gradually fade out over the course of their life.\r\n         */\r\n        this.fadeFlag = false;\r\n        /**\r\n         * Gets or sets the optional focus where all particles should accelerate towards\r\n         */\r\n        this.focus = null;\r\n        /**\r\n         * Gets or sets the acceleration for focusing particles if a focus has been specified\r\n         */\r\n        this.focusAccel = null;\r\n        /**\r\n         * Gets or sets the optional starting size for the particles\r\n         */\r\n        this.startSize = null;\r\n        /**\r\n         * Gets or sets the optional ending size for the particles\r\n         */\r\n        this.endSize = null;\r\n        /**\r\n         * Gets or sets the minimum size of all particles\r\n         */\r\n        this.minSize = 5;\r\n        /**\r\n         * Gets or sets the maximum size of all particles\r\n         */\r\n        this.maxSize = 5;\r\n        /**\r\n         * Gets or sets the beginning color of all particles\r\n         */\r\n        this.beginColor = Color.White;\r\n        /**\r\n         * Gets or sets the ending color of all particles\r\n         */\r\n        this.endColor = Color.White;\r\n        this._og = null;\r\n        this._sprite = null;\r\n        /**\r\n         * Gets or sets the emitter type for the particle emitter\r\n         */\r\n        this.emitterType = EmitterType.Rectangle;\r\n        /**\r\n         * Gets or sets the emitter radius, only takes effect when the [[emitterType]] is [[EmitterType.Circle]]\r\n         */\r\n        this.radius = 0;\r\n        /**\r\n         * Gets or sets the particle rotational speed velocity\r\n         */\r\n        this.particleRotationalVelocity = 0;\r\n        /**\r\n         * Indicates whether particles should start with a random rotation\r\n         */\r\n        this.randomRotation = false;\r\n        const { x, y, pos, isEmitting, minVel, maxVel, acceleration, minAngle, maxAngle, emitRate, particleLife, opacity, fadeFlag, focus, focusAccel, startSize, endSize, minSize, maxSize, beginColor, endColor, particleSprite, emitterType, radius, particleRotationalVelocity, randomRotation, random } = Object.assign({}, config);\r\n        this.pos = pos !== null && pos !== void 0 ? pos : vec(x !== null && x !== void 0 ? x : 0, y !== null && y !== void 0 ? y : 0);\r\n        this.isEmitting = isEmitting !== null && isEmitting !== void 0 ? isEmitting : this.isEmitting;\r\n        this.minVel = minVel !== null && minVel !== void 0 ? minVel : this.minVel;\r\n        this.maxVel = maxVel !== null && maxVel !== void 0 ? maxVel : this.maxVel;\r\n        this.acceleration = acceleration !== null && acceleration !== void 0 ? acceleration : this.acceleration;\r\n        this.minAngle = minAngle !== null && minAngle !== void 0 ? minAngle : this.minAngle;\r\n        this.maxAngle = maxAngle !== null && maxAngle !== void 0 ? maxAngle : this.maxAngle;\r\n        this.emitRate = emitRate !== null && emitRate !== void 0 ? emitRate : this.emitRate;\r\n        this.particleLife = particleLife !== null && particleLife !== void 0 ? particleLife : this.particleLife;\r\n        this.opacity = opacity !== null && opacity !== void 0 ? opacity : this.opacity;\r\n        this.fadeFlag = fadeFlag !== null && fadeFlag !== void 0 ? fadeFlag : this.fadeFlag;\r\n        this.focus = focus !== null && focus !== void 0 ? focus : this.focus;\r\n        this.focusAccel = focusAccel !== null && focusAccel !== void 0 ? focusAccel : this.focusAccel;\r\n        this.startSize = startSize !== null && startSize !== void 0 ? startSize : this.startSize;\r\n        this.endSize = endSize !== null && endSize !== void 0 ? endSize : this.endSize;\r\n        this.minSize = minSize !== null && minSize !== void 0 ? minSize : this.minSize;\r\n        this.maxSize = maxSize !== null && maxSize !== void 0 ? maxSize : this.maxSize;\r\n        this.beginColor = beginColor !== null && beginColor !== void 0 ? beginColor : this.beginColor;\r\n        this.endColor = endColor !== null && endColor !== void 0 ? endColor : this.endColor;\r\n        this.particleSprite = particleSprite !== null && particleSprite !== void 0 ? particleSprite : this.particleSprite;\r\n        this.emitterType = emitterType !== null && emitterType !== void 0 ? emitterType : this.emitterType;\r\n        this.radius = radius !== null && radius !== void 0 ? radius : this.radius;\r\n        this.particleRotationalVelocity = particleRotationalVelocity !== null && particleRotationalVelocity !== void 0 ? particleRotationalVelocity : this.particleRotationalVelocity;\r\n        this.randomRotation = randomRotation !== null && randomRotation !== void 0 ? randomRotation : this.randomRotation;\r\n        this.body.collisionType = CollisionType.PreventCollision;\r\n        this.random = random !== null && random !== void 0 ? random : new Random();\r\n        // Remove offscreen culling from particle emitters\r\n        for (let i = 0; i < this.traits.length; i++) {\r\n            if (this.traits[i] instanceof OffscreenCulling) {\r\n                this.traits.splice(i, 1);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Gets the opacity of each particle from 0 to 1.0\r\n     */\r\n    get opacity() {\r\n        return super.graphics.opacity;\r\n    }\r\n    /**\r\n     * Gets the opacity of each particle from 0 to 1.0\r\n     */\r\n    set opacity(opacity) {\r\n        super.graphics.opacity = opacity;\r\n    }\r\n    /**\r\n     * Gets or sets the sprite that a particle should use\r\n     */\r\n    get particleSprite() {\r\n        return this._og;\r\n    }\r\n    set particleSprite(val) {\r\n        this._og = val;\r\n        if (val) {\r\n            this._sprite = Sprite.fromLegacySprite(val);\r\n        }\r\n    }\r\n    removeParticle(particle) {\r\n        this.deadParticles.push(particle);\r\n    }\r\n    /**\r\n     * Causes the emitter to emit particles\r\n     * @param particleCount  Number of particles to emit right now\r\n     */\r\n    emitParticles(particleCount) {\r\n        var _a;\r\n        for (let i = 0; i < particleCount; i++) {\r\n            const p = this._createParticle();\r\n            this.particles.push(p);\r\n            if ((_a = this === null || this === void 0 ? void 0 : this.scene) === null || _a === void 0 ? void 0 : _a.world) {\r\n                this.scene.world.add(p);\r\n            }\r\n        }\r\n    }\r\n    clearParticles() {\r\n        this.particles.length = 0;\r\n    }\r\n    // Creates a new particle given the constraints of the emitter\r\n    _createParticle() {\r\n        // todo implement emitter constraints;\r\n        let ranX = 0;\r\n        let ranY = 0;\r\n        const angle = randomInRange(this.minAngle, this.maxAngle, this.random);\r\n        const vel = randomInRange(this.minVel, this.maxVel, this.random);\r\n        const size = this.startSize || randomInRange(this.minSize, this.maxSize, this.random);\r\n        const dx = vel * Math.cos(angle);\r\n        const dy = vel * Math.sin(angle);\r\n        if (this.emitterType === EmitterType.Rectangle) {\r\n            ranX = randomInRange(0, this.width, this.random);\r\n            ranY = randomInRange(0, this.height, this.random);\r\n        }\r\n        else if (this.emitterType === EmitterType.Circle) {\r\n            const radius = randomInRange(0, this.radius, this.random);\r\n            ranX = radius * Math.cos(angle);\r\n            ranY = radius * Math.sin(angle);\r\n        }\r\n        const p = new Particle(this, this.particleLife, this.opacity, this.beginColor, this.endColor, new Vector(ranX, ranY), new Vector(dx, dy), this.acceleration, this.startSize, this.endSize);\r\n        p.fadeFlag = this.fadeFlag;\r\n        p.particleSize = size;\r\n        if (this.particleSprite) {\r\n            p.particleSprite = this.particleSprite;\r\n            p.graphics.opacity = this.opacity;\r\n            p.graphics.use(this._sprite);\r\n        }\r\n        p.particleRotationalVelocity = this.particleRotationalVelocity;\r\n        if (this.randomRotation) {\r\n            p.currentRotation = randomInRange(0, Math.PI * 2, this.random);\r\n        }\r\n        if (this.focus) {\r\n            p.focus = this.focus.add(new Vector(this.pos.x, this.pos.y));\r\n            p.focusAccel = this.focusAccel;\r\n        }\r\n        return p;\r\n    }\r\n    update(engine, delta) {\r\n        var _a;\r\n        super.update(engine, delta);\r\n        if (this.isEmitting) {\r\n            this._particlesToEmit += this.emitRate * (delta / 1000);\r\n            if (this._particlesToEmit > 1.0) {\r\n                this.emitParticles(Math.floor(this._particlesToEmit));\r\n                this._particlesToEmit = this._particlesToEmit - Math.floor(this._particlesToEmit);\r\n            }\r\n        }\r\n        // deferred removal\r\n        for (let i = 0; i < this.deadParticles.length; i++) {\r\n            removeItemFromArray(this.deadParticles[i], this.particles);\r\n            if ((_a = this === null || this === void 0 ? void 0 : this.scene) === null || _a === void 0 ? void 0 : _a.world) {\r\n                this.scene.world.remove(this.deadParticles[i], false);\r\n            }\r\n        }\r\n        this.deadParticles.length = 0;\r\n    }\r\n    draw(ctx) {\r\n        // todo is there a more efficient to draw\r\n        // possibly use a webgl offscreen canvas and shaders to do particles?\r\n        this.particles.forEach((p) => p.draw(ctx));\r\n    }\r\n    debugDraw(ctx) {\r\n        super.debugDraw(ctx);\r\n        ctx.fillStyle = Color.Black.toString();\r\n        ctx.fillText('Particles: ' + this.particles.length, this.pos.x, this.pos.y + 20);\r\n        if (this.focus) {\r\n            ctx.fillRect(this.focus.x + this.pos.x, this.focus.y + this.pos.y, 3, 3);\r\n            line(ctx, Color.Yellow, this.focus.x + this.pos.x, this.focus.y + this.pos.y, this.center.x, this.center.y);\r\n            ctx.fillText('Focus', this.focus.x + this.pos.x, this.focus.y + this.pos.y);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/GraphicsSystem.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass GraphicsSystem extends System {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.types = ['ex.transform', 'ex.graphics'];\r\n        this.systemType = SystemType.Draw;\r\n        this.priority = 0;\r\n        this._token = 0;\r\n    }\r\n    initialize(scene) {\r\n        this._graphicsContext = scene.engine.graphicsContext;\r\n        this._camera = scene.camera;\r\n        this._engine = scene.engine;\r\n    }\r\n    sort(a, b) {\r\n        return a.get(TransformComponent).z - b.get(TransformComponent).z;\r\n    }\r\n    update(entities, delta) {\r\n        this._clearScreen();\r\n        this._token++;\r\n        let transform;\r\n        let graphics;\r\n        for (const entity of entities) {\r\n            transform = entity.get(TransformComponent);\r\n            graphics = entity.get(GraphicsComponent);\r\n            // Figure out if entities are offscreen\r\n            const entityOffscreen = this._isOffscreen(transform, graphics);\r\n            if (entityOffscreen && !entity.hasTag('offscreen')) {\r\n                entity.eventDispatcher.emit('exitviewport', new ExitViewPortEvent(entity));\r\n                entity.addComponent(new TagComponent('offscreen'));\r\n            }\r\n            if (!entityOffscreen && entity.hasTag('offscreen')) {\r\n                entity.eventDispatcher.emit('enterviewport', new EnterViewPortEvent(entity));\r\n                entity.removeComponent('offscreen');\r\n            }\r\n            // Skip entities that have graphics offscreen\r\n            if (entityOffscreen) {\r\n                continue;\r\n            }\r\n            // This optionally sets our camera based on the entity coord plan (world vs. screen)\r\n            this._pushCameraTransform(transform);\r\n            this._graphicsContext.save();\r\n            // Tick any graphics state (but only once) for animations and graphics groups\r\n            graphics.update(delta, this._token);\r\n            // Position the entity\r\n            this._applyTransform(entity);\r\n            // Optionally run the onPreDraw graphics lifecycle draw\r\n            if (graphics.onPreDraw) {\r\n                graphics.onPreDraw(this._graphicsContext, delta);\r\n            }\r\n            // TODO remove this hack on the particle redo\r\n            const particleOpacity = (entity instanceof Particle) ? entity.opacity : 1;\r\n            this._graphicsContext.opacity = graphics.opacity * particleOpacity;\r\n            // Draw the graphics component\r\n            this._drawGraphicsComponent(graphics);\r\n            // Optionally run the onPostDraw graphics lifecycle draw\r\n            if (graphics.onPostDraw) {\r\n                graphics.onPostDraw(this._graphicsContext, delta);\r\n            }\r\n            this._graphicsContext.restore();\r\n            // Reset the transform back to the original\r\n            this._popCameraTransform(transform);\r\n        }\r\n        this._graphicsContext.flush();\r\n        this._engine.stats.currFrame.graphics.drawnImages = GraphicsDiagnostics.DrawnImagesCount;\r\n        this._engine.stats.currFrame.graphics.drawCalls = GraphicsDiagnostics.DrawCallCount;\r\n    }\r\n    _clearScreen() {\r\n        this._graphicsContext.clear();\r\n    }\r\n    _isOffscreen(transform, graphics) {\r\n        if (transform.coordPlane === CoordPlane.World) {\r\n            const graphicsOffscreen = !this._camera.viewport.intersect(graphics.localBounds.transform(transform.getGlobalMatrix()));\r\n            return graphicsOffscreen;\r\n        }\r\n        else {\r\n            // TODO sceen coordinates\r\n            return false;\r\n        }\r\n    }\r\n    _drawGraphicsComponent(graphicsComponent) {\r\n        var _a, _b;\r\n        if (graphicsComponent.visible) {\r\n            // this should be moved to the graphics system\r\n            for (const layer of graphicsComponent.layers.get()) {\r\n                for (const { graphic, options } of layer.graphics) {\r\n                    let anchor = graphicsComponent.anchor;\r\n                    let offset = graphicsComponent.offset;\r\n                    if (options === null || options === void 0 ? void 0 : options.anchor) {\r\n                        anchor = options.anchor;\r\n                    }\r\n                    if (options === null || options === void 0 ? void 0 : options.offset) {\r\n                        offset = options.offset;\r\n                    }\r\n                    // See https://github.com/excaliburjs/Excalibur/pull/619 for discussion on this formula\r\n                    const offsetX = -graphic.width * anchor.x + offset.x;\r\n                    const offsetY = -graphic.height * anchor.y + offset.y;\r\n                    graphic === null || graphic === void 0 ? void 0 : graphic.draw(this._graphicsContext, offsetX + layer.offset.x, offsetY + layer.offset.y);\r\n                    if (((_a = this._engine) === null || _a === void 0 ? void 0 : _a.isDebug) && this._engine.debug.graphics.showBounds) {\r\n                        const offset = vec(offsetX + layer.offset.x, offsetY + layer.offset.y);\r\n                        if (graphic instanceof GraphicsGroup) {\r\n                            for (const g of graphic.members) {\r\n                                (_b = g.graphic) === null || _b === void 0 ? void 0 : _b.localBounds.translate(offset.add(g.pos)).draw(this._graphicsContext, this._engine.debug.graphics.boundsColor);\r\n                            }\r\n                        }\r\n                        else {\r\n                            /* istanbul ignore next */\r\n                            graphic === null || graphic === void 0 ? void 0 : graphic.localBounds.translate(offset).draw(this._graphicsContext, this._engine.debug.graphics.boundsColor);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * This applies the current entity transform to the graphics context\r\n     * @param entity\r\n     */\r\n    _applyTransform(entity) {\r\n        const ancestors = entity.getAncestors();\r\n        for (const ancestor of ancestors) {\r\n            const transform = ancestor === null || ancestor === void 0 ? void 0 : ancestor.get(TransformComponent);\r\n            if (transform) {\r\n                this._graphicsContext.translate(transform.pos.x, transform.pos.y);\r\n                this._graphicsContext.scale(transform.scale.x, transform.scale.y);\r\n                this._graphicsContext.rotate(transform.rotation);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Applies the current camera transform if in world coordinates\r\n     * @param transform\r\n     */\r\n    _pushCameraTransform(transform) {\r\n        // Establish camera offset per entity\r\n        if (transform.coordPlane === CoordPlane.World) {\r\n            this._graphicsContext.save();\r\n            if (this._camera) {\r\n                this._camera.draw(this._graphicsContext);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Resets the current camera transform if in world coordinates\r\n     * @param transform\r\n     */\r\n    _popCameraTransform(transform) {\r\n        if (transform.coordPlane === CoordPlane.World) {\r\n            // Apply camera world offset\r\n            this._graphicsContext.restore();\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Drawing/CanvasDrawingSystem.ts\n\r\n\r\n\r\n\r\n/**\r\n * Draws anything with a transform and a \"draw\" method\r\n * @deprecated Shim for canvas drawing, will be removed v0.26.0\r\n */\r\nclass CanvasDrawingSystem extends System {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.types = ['ex.transform', 'ex.canvas'];\r\n        this.systemType = SystemType.Draw;\r\n        this.priority = -1;\r\n    }\r\n    initialize(scene) {\r\n        this._ctx = scene.engine.ctx;\r\n        this._engine = scene.engine;\r\n        this._camera = scene.camera;\r\n    }\r\n    sort(a, b) {\r\n        return a.get(TransformComponent).z - b.get(TransformComponent).z;\r\n    }\r\n    update(entities, delta) {\r\n        var _a, _b, _c;\r\n        this._clearScreen();\r\n        let transform;\r\n        let canvasdraw;\r\n        const length = entities.length;\r\n        for (let i = 0; i < length; i++) {\r\n            const visible = (_c = (_b = (_a = entities[i]) === null || _a === void 0 ? void 0 : _a.graphics) === null || _b === void 0 ? void 0 : _b.visible) !== null && _c !== void 0 ? _c : true;\r\n            const offscreen = entities[i].isOffScreen;\r\n            if (visible && !offscreen) {\r\n                transform = entities[i].get(TransformComponent);\r\n                canvasdraw = entities[i].get(CanvasDrawComponent);\r\n                this._ctx.save();\r\n                this._pushCameraTransform(transform);\r\n                this._ctx.save();\r\n                this._applyTransform(entities[i]);\r\n                canvasdraw.draw(this._ctx, delta);\r\n                this._ctx.restore();\r\n                this._popCameraTransform(transform);\r\n                this._ctx.restore();\r\n            }\r\n            if (this._engine.isDebug) {\r\n                this._ctx.save();\r\n                this._pushCameraTransform(transform);\r\n                this._ctx.strokeStyle = 'yellow';\r\n                entities[i].debugDraw(this._ctx);\r\n                this._popCameraTransform(transform);\r\n                this._ctx.restore();\r\n            }\r\n        }\r\n        if (this._engine.isDebug) {\r\n            this._ctx.save();\r\n            this._camera.draw(this._ctx);\r\n            this._camera.debugDraw(this._ctx);\r\n            this._ctx.restore();\r\n        }\r\n        this._engine.stats.currFrame.graphics.drawnImages = GraphicsDiagnostics.DrawnImagesCount;\r\n        this._engine.stats.currFrame.graphics.drawCalls = GraphicsDiagnostics.DrawCallCount;\r\n    }\r\n    _applyTransform(entity) {\r\n        const ancestors = entity.getAncestors();\r\n        for (const ancestor of ancestors) {\r\n            const transform = ancestor === null || ancestor === void 0 ? void 0 : ancestor.get(TransformComponent);\r\n            if (transform) {\r\n                this._ctx.translate(transform.pos.x, transform.pos.y);\r\n                this._ctx.rotate(transform.rotation);\r\n                this._ctx.scale(transform.scale.x, transform.scale.y);\r\n            }\r\n        }\r\n    }\r\n    _clearScreen() {\r\n        this._ctx.clearRect(0, 0, this._ctx.canvas.width, this._ctx.canvas.height);\r\n        this._ctx.fillStyle = this._engine.backgroundColor.toString();\r\n        this._ctx.fillRect(0, 0, this._ctx.canvas.width, this._ctx.canvas.height);\r\n    }\r\n    _pushCameraTransform(transform) {\r\n        if (transform.coordPlane === CoordPlane.World) {\r\n            // Apply camera transform to place entity in world space\r\n            this._ctx.save();\r\n            if (this._camera) {\r\n                this._camera.draw(this._ctx);\r\n            }\r\n        }\r\n    }\r\n    _popCameraTransform(transform) {\r\n        if (transform.coordPlane === CoordPlane.World) {\r\n            // Restore back to screen space from world space if we were drawing an entity there\r\n            this._ctx.restore();\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Debug/DebugSystem.ts\n\r\n\r\n\r\n\r\n\r\n\r\nclass DebugSystem extends System {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.types = ['ex.transform'];\r\n        this.systemType = SystemType.Draw;\r\n        this.priority = 999; // lowest priority\r\n    }\r\n    initialize(scene) {\r\n        this._graphicsContext = scene.engine.graphicsContext;\r\n        this._camera = scene.camera;\r\n        this._engine = scene.engine;\r\n        this._collisionSystem = scene.world.systemManager.get(CollisionSystem);\r\n    }\r\n    update(entities, _delta) {\r\n        var _a, _b;\r\n        if (!this._engine.isDebug) {\r\n            return;\r\n        }\r\n        const filterSettings = this._engine.debug.filter;\r\n        let id;\r\n        let name;\r\n        const entitySettings = this._engine.debug.entity;\r\n        let tx;\r\n        const txSettings = this._engine.debug.transform;\r\n        let motion;\r\n        const motionSettings = this._engine.debug.motion;\r\n        let colliderComp;\r\n        const colliderSettings = this._engine.debug.collider;\r\n        const physicsSettings = this._engine.debug.physics;\r\n        let graphics;\r\n        const graphicsSettings = this._engine.debug.graphics;\r\n        let body;\r\n        const bodySettings = this._engine.debug.body;\r\n        const cameraSettings = this._engine.debug.camera;\r\n        for (const entity of entities) {\r\n            if (entity.hasTag('offscreen')) {\r\n                // skip offscreen entities\r\n                continue;\r\n            }\r\n            if (entity instanceof Particle) {\r\n                // Particles crush the renderer :(\r\n                continue;\r\n            }\r\n            if (filterSettings.useFilter) {\r\n                const allIds = filterSettings.ids.length === 0;\r\n                const idMatch = allIds || filterSettings.ids.includes(entity.id);\r\n                if (!idMatch) {\r\n                    continue;\r\n                }\r\n                const allNames = filterSettings.nameQuery === '';\r\n                const nameMatch = allNames || entity.name.includes(filterSettings.nameQuery);\r\n                if (!nameMatch) {\r\n                    continue;\r\n                }\r\n            }\r\n            let cursor = Vector.Zero;\r\n            const lineHeight = vec(0, 16);\r\n            id = entity.id;\r\n            name = entity.name;\r\n            tx = entity.get(TransformComponent);\r\n            // This optionally sets our camera based on the entity coord plan (world vs. screen)\r\n            this._pushCameraTransform(tx);\r\n            this._graphicsContext.save();\r\n            this._applyTransform(entity);\r\n            if (tx) {\r\n                if (txSettings.showAll || txSettings.showPosition) {\r\n                    this._graphicsContext.debug.drawPoint(Vector.Zero, { size: 2, color: txSettings.positionColor });\r\n                    this._graphicsContext.debug.drawText(`pos${tx.pos.toString(2)}`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (entitySettings.showAll || entitySettings.showId) {\r\n                    this._graphicsContext.debug.drawText(`id(${id}) ${tx.parent ? 'child of id(' + ((_b = (_a = tx.parent) === null || _a === void 0 ? void 0 : _a.owner) === null || _b === void 0 ? void 0 : _b.id) + ')' : ''}`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (entitySettings.showAll || entitySettings.showName) {\r\n                    this._graphicsContext.debug.drawText(`name(${name})`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (txSettings.showAll || txSettings.showRotation) {\r\n                    this._graphicsContext.drawLine(Vector.Zero, Vector.fromAngle(tx.rotation).scale(50).add(Vector.Zero), txSettings.rotationColor, 2);\r\n                    this._graphicsContext.debug.drawText(`rot deg(${toDegrees(tx.rotation).toFixed(2)})`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (txSettings.showAll || txSettings.showScale) {\r\n                    this._graphicsContext.drawLine(Vector.Zero, tx.scale.add(Vector.Zero), txSettings.scaleColor, 2);\r\n                }\r\n            }\r\n            graphics = entity.get(GraphicsComponent);\r\n            if (graphics) {\r\n                if (graphicsSettings.showAll || graphicsSettings.showBounds) {\r\n                    const bounds = graphics.localBounds;\r\n                    bounds.draw(this._graphicsContext, graphicsSettings.boundsColor);\r\n                }\r\n            }\r\n            body = entity.get(BodyComponent);\r\n            if (body) {\r\n                if (bodySettings.showAll || bodySettings.showCollisionGroup) {\r\n                    this._graphicsContext.debug.drawText(`collision group(${body.group.name})`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (bodySettings.showAll || bodySettings.showCollisionType) {\r\n                    this._graphicsContext.debug.drawText(`collision type(${body.collisionType})`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (bodySettings.showAll || bodySettings.showMass) {\r\n                    this._graphicsContext.debug.drawText(`mass(${body.mass})`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (bodySettings.showAll || bodySettings.showMotion) {\r\n                    this._graphicsContext.debug.drawText(`motion(${body.sleepMotion})`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (bodySettings.showAll || bodySettings.showSleeping) {\r\n                    this._graphicsContext.debug.drawText(`sleeping(${body.canSleep ? body.sleeping : 'cant sleep'})`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n            }\r\n            this._graphicsContext.restore();\r\n            motion = entity.get(MotionComponent);\r\n            if (motion) {\r\n                if (motionSettings.showAll || motionSettings.showVelocity) {\r\n                    this._graphicsContext.debug.drawText(`vel${motion.vel.toString(2)}`, cursor.add(tx.globalPos));\r\n                    this._graphicsContext.drawLine(tx.globalPos, tx.globalPos.add(motion.vel), motionSettings.velocityColor, 2);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (motionSettings.showAll || motionSettings.showAcceleration) {\r\n                    this._graphicsContext.drawLine(tx.globalPos, tx.globalPos.add(motion.acc), motionSettings.accelerationColor, 2);\r\n                }\r\n            }\r\n            // Colliders live in world space already so after the restore()\r\n            colliderComp = entity.get(ColliderComponent);\r\n            if (colliderComp) {\r\n                const collider = colliderComp.get();\r\n                if ((colliderSettings.showAll || colliderSettings.showGeometry) && collider) {\r\n                    collider.debug(this._graphicsContext, colliderSettings.geometryColor);\r\n                }\r\n                if (colliderSettings.showAll || colliderSettings.showBounds) {\r\n                    if (collider instanceof CompositeCollider) {\r\n                        const colliders = collider.getColliders();\r\n                        for (const collider of colliders) {\r\n                            const bounds = collider.bounds;\r\n                            const pos = vec(bounds.left, bounds.top);\r\n                            this._graphicsContext.debug.drawRect(pos.x, pos.y, bounds.width, bounds.height, { color: colliderSettings.boundsColor });\r\n                            if (colliderSettings.showAll || colliderSettings.showOwner) {\r\n                                this._graphicsContext.debug.drawText(`owner id(${collider.owner.id})`, pos);\r\n                            }\r\n                        }\r\n                        colliderComp.bounds.draw(this._graphicsContext, colliderSettings.boundsColor);\r\n                    }\r\n                    else if (collider) {\r\n                        const bounds = colliderComp.bounds;\r\n                        const pos = vec(bounds.left, bounds.top);\r\n                        this._graphicsContext.debug.drawRect(pos.x, pos.y, bounds.width, bounds.height, { color: colliderSettings.boundsColor });\r\n                        if (colliderSettings.showAll || colliderSettings.showOwner) {\r\n                            this._graphicsContext.debug.drawText(`owner id(${colliderComp.owner.id})`, pos);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            this._popCameraTransform(tx);\r\n        }\r\n        this._graphicsContext.save();\r\n        this._camera.draw(this._graphicsContext);\r\n        if (physicsSettings.showAll || physicsSettings.showBroadphaseSpacePartitionDebug) {\r\n            this._collisionSystem.debug(this._graphicsContext);\r\n        }\r\n        if (physicsSettings.showAll || physicsSettings.showCollisionContacts || physicsSettings.showCollisionNormals) {\r\n            for (const [_, contact] of this._engine.debug.stats.currFrame.physics.contacts) {\r\n                if (physicsSettings.showAll || physicsSettings.showCollisionContacts) {\r\n                    for (const point of contact.points) {\r\n                        this._graphicsContext.debug.drawPoint(point, { size: 5, color: physicsSettings.collisionContactColor });\r\n                    }\r\n                }\r\n                if (physicsSettings.showAll || physicsSettings.showCollisionNormals) {\r\n                    for (const point of contact.points) {\r\n                        this._graphicsContext.debug.drawLine(point, contact.normal.scale(30).add(point), {\r\n                            color: physicsSettings.collisionNormalColor\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        this._graphicsContext.restore();\r\n        if (cameraSettings) {\r\n            this._graphicsContext.save();\r\n            this._camera.draw(this._graphicsContext);\r\n            if (cameraSettings.showAll || cameraSettings.showFocus) {\r\n                this._graphicsContext.drawCircle(this._camera.pos, 4, cameraSettings.focusColor);\r\n            }\r\n            if (cameraSettings.showAll || cameraSettings.showZoom) {\r\n                this._graphicsContext.debug.drawText(`zoom(${this._camera.zoom})`, this._camera.pos);\r\n            }\r\n            this._graphicsContext.restore();\r\n        }\r\n        this._graphicsContext.flush();\r\n    }\r\n    /**\r\n     * This applies the current entity transform to the graphics context\r\n     * @param entity\r\n     */\r\n    _applyTransform(entity) {\r\n        const ancestors = entity.getAncestors();\r\n        for (const ancestor of ancestors) {\r\n            const transform = ancestor === null || ancestor === void 0 ? void 0 : ancestor.get(TransformComponent);\r\n            if (transform) {\r\n                this._graphicsContext.translate(transform.pos.x, transform.pos.y);\r\n                this._graphicsContext.scale(transform.scale.x, transform.scale.y);\r\n                this._graphicsContext.rotate(transform.rotation);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Applies the current camera transform if in world coordinates\r\n     * @param transform\r\n     */\r\n    _pushCameraTransform(transform) {\r\n        // Establish camera offset per entity\r\n        if (transform.coordPlane === CoordPlane.World) {\r\n            this._graphicsContext.save();\r\n            if (this._camera) {\r\n                this._camera.draw(this._graphicsContext);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Resets the current camera transform if in world coordinates\r\n     * @param transform\r\n     */\r\n    _popCameraTransform(transform) {\r\n        if (transform.coordPlane === CoordPlane.World) {\r\n            // Apply camera world offset\r\n            this._graphicsContext.restore();\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/ActionsSystem.ts\n\r\n\r\nclass ActionsSystem extends System {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.types = ['ex.actions'];\r\n        this.systemType = SystemType.Update;\r\n        this.priority = -1;\r\n    }\r\n    update(entities, delta) {\r\n        let actions;\r\n        for (const entity of entities) {\r\n            actions = entity.get(ActionsComponent);\r\n            actions.update(delta);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Scene.ts\nvar Scene_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * [[Actor|Actors]] are composed together into groupings called Scenes in\r\n * Excalibur. The metaphor models the same idea behind real world\r\n * actors in a scene. Only actors in scenes will be updated and drawn.\r\n *\r\n * Typical usages of a scene include: levels, menus, loading screens, etc.\r\n */\r\nclass Scene extends Class {\r\n    constructor() {\r\n        super();\r\n        this._logger = Logger.getInstance();\r\n        /**\r\n         * Gets or sets the current camera for the scene\r\n         */\r\n        this.camera = new Camera();\r\n        /**\r\n         * The ECS world for the scene\r\n         */\r\n        this.world = new World(this);\r\n        this._isInitialized = false;\r\n        this._timers = [];\r\n        this._cancelQueue = [];\r\n        // TODO how to people do there own systems\r\n        // Initialize systems\r\n        this.world.add(new ActionsSystem());\r\n        this.world.add(new MotionSystem());\r\n        this.world.add(new CollisionSystem());\r\n        if (Flags.isEnabled(Legacy.LegacyDrawing)) {\r\n            this.world.add(new CanvasDrawingSystem());\r\n        }\r\n        else {\r\n            this.world.add(new GraphicsSystem());\r\n        }\r\n        this.world.add(new DebugSystem());\r\n    }\r\n    /**\r\n     * The actors in the current scene\r\n     */\r\n    get actors() {\r\n        return this.world.entityManager.entities.filter((e) => {\r\n            return e instanceof Actor;\r\n        });\r\n    }\r\n    /**\r\n     * The entities in the current scene\r\n     */\r\n    get entities() {\r\n        return this.world.entityManager.entities;\r\n    }\r\n    /**\r\n     * The triggers in the current scene\r\n     */\r\n    get triggers() {\r\n        return this.world.entityManager.entities.filter((e) => {\r\n            return e instanceof Trigger_Trigger;\r\n        });\r\n    }\r\n    /**\r\n     * The [[TileMap]]s in the scene, if any\r\n     */\r\n    get tileMaps() {\r\n        return this.world.entityManager.entities.filter((e) => {\r\n            return e instanceof TileMap;\r\n        });\r\n    }\r\n    /**\r\n     * The [[ScreenElement]]s in a scene, if any; these are drawn last\r\n     * @deprecated Use [[Scene.actors]]\r\n     */\r\n    get screenElements() {\r\n        return this.actors.filter((a) => a instanceof ScreenElement_ScreenElement);\r\n    }\r\n    on(eventName, handler) {\r\n        super.on(eventName, handler);\r\n    }\r\n    once(eventName, handler) {\r\n        super.once(eventName, handler);\r\n    }\r\n    off(eventName, handler) {\r\n        super.off(eventName, handler);\r\n    }\r\n    /**\r\n     * This is called before the first update of the [[Scene]]. Initializes scene members like the camera. This method is meant to be\r\n     * overridden. This is where initialization of child actors should take place.\r\n     */\r\n    onInitialize(_engine) {\r\n        // will be overridden\r\n    }\r\n    /**\r\n     * This is called when the scene is made active and started. It is meant to be overridden,\r\n     * this is where you should setup any DOM UI or event handlers needed for the scene.\r\n     */\r\n    onActivate(_oldScene, _newScene) {\r\n        // will be overridden\r\n    }\r\n    /**\r\n     * This is called when the scene is made transitioned away from and stopped. It is meant to be overridden,\r\n     * this is where you should cleanup any DOM UI or event handlers needed for the scene.\r\n     */\r\n    onDeactivate(_oldScene, _newScene) {\r\n        // will be overridden\r\n    }\r\n    /**\r\n     * Safe to override onPreUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPreUpdate` is called directly before a scene is updated.\r\n     */\r\n    onPreUpdate(_engine, _delta) {\r\n        // will be overridden\r\n    }\r\n    /**\r\n     * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPostUpdate` is called directly after a scene is updated.\r\n     */\r\n    onPostUpdate(_engine, _delta) {\r\n        // will be overridden\r\n    }\r\n    /**\r\n     * Safe to override onPreDraw lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPreDraw` is called directly before a scene is drawn.\r\n     */\r\n    onPreDraw(_ctx, _delta) {\r\n        // will be overridden\r\n    }\r\n    /**\r\n     * Safe to override onPostDraw lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPostDraw` is called directly after a scene is drawn.\r\n     */\r\n    onPostDraw(_ctx, _delta) {\r\n        // will be overridden\r\n    }\r\n    /**\r\n     * Initializes actors in the scene\r\n     */\r\n    _initializeChildren() {\r\n        for (const child of this.entities) {\r\n            child._initialize(this.engine);\r\n        }\r\n    }\r\n    /**\r\n     * Gets whether or not the [[Scene]] has been initialized\r\n     */\r\n    get isInitialized() {\r\n        return this._isInitialized;\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Initializes the scene before the first update, meant to be called by engine not by users of\r\n     * Excalibur\r\n     * @internal\r\n     */\r\n    _initialize(engine) {\r\n        if (!this.isInitialized) {\r\n            this.engine = engine;\r\n            // Initialize camera first\r\n            this.camera._initialize(engine);\r\n            // This order is important! we want to be sure any custom init that add actors\r\n            // fire before the actor init\r\n            this.onInitialize.call(this, engine);\r\n            this._initializeChildren();\r\n            this._logger.debug('Scene.onInitialize', this, engine);\r\n            this.eventDispatcher.emit('initialize', new InitializeEvent(engine, this));\r\n            this._isInitialized = true;\r\n        }\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Activates the scene with the base behavior, then calls the overridable `onActivate` implementation.\r\n     * @internal\r\n     */\r\n    _activate(oldScene, newScene) {\r\n        this._logger.debug('Scene.onActivate', this);\r\n        this.onActivate(oldScene, newScene);\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Deactivates the scene with the base behavior, then calls the overridable `onDeactivate` implementation.\r\n     * @internal\r\n     */\r\n    _deactivate(oldScene, newScene) {\r\n        this._logger.debug('Scene.onDeactivate', this);\r\n        this.onDeactivate(oldScene, newScene);\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPreUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _preupdate(_engine, delta) {\r\n        this.emit('preupdate', new PreUpdateEvent(_engine, delta, this));\r\n        this.onPreUpdate(_engine, delta);\r\n    }\r\n    /**\r\n     *  It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPostUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _postupdate(_engine, delta) {\r\n        this.emit('postupdate', new PostUpdateEvent(_engine, delta, this));\r\n        this.onPostUpdate(_engine, delta);\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _predraw handler for [[onPreDraw]] lifecycle event\r\n     *\r\n     * @internal\r\n     */\r\n    _predraw(_ctx, _delta) {\r\n        this.emit('predraw', new PreDrawEvent(_ctx, _delta, this));\r\n        this.onPreDraw(_ctx, _delta);\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _postdraw handler for [[onPostDraw]] lifecycle event\r\n     *\r\n     * @internal\r\n     */\r\n    _postdraw(_ctx, _delta) {\r\n        this.emit('postdraw', new PostDrawEvent(_ctx, _delta, this));\r\n        this.onPostDraw(_ctx, _delta);\r\n    }\r\n    /**\r\n     * Updates all the actors and timers in the scene. Called by the [[Engine]].\r\n     * @param engine  Reference to the current Engine\r\n     * @param delta   The number of milliseconds since the last update\r\n     */\r\n    update(engine, delta) {\r\n        this._preupdate(engine, delta);\r\n        if (this.camera) {\r\n            this.camera.update(engine, delta);\r\n        }\r\n        // TODO differed entity removal for timers\r\n        let i, len;\r\n        // Remove timers in the cancel queue before updating them\r\n        for (i = 0, len = this._cancelQueue.length; i < len; i++) {\r\n            this.removeTimer(this._cancelQueue[i]);\r\n        }\r\n        this._cancelQueue.length = 0;\r\n        // Cycle through timers updating timers\r\n        for (const timer of this._timers) {\r\n            timer.update(delta);\r\n        }\r\n        this.world.update(SystemType.Update, delta);\r\n        this._collectActorStats(engine);\r\n        engine.input.pointers.dispatchPointerEvents();\r\n        this._postupdate(engine, delta);\r\n    }\r\n    /**\r\n     * Draws all the actors in the Scene. Called by the [[Engine]].\r\n     * @param ctx    The current rendering context\r\n     * @param delta  The number of milliseconds since the last draw\r\n     */\r\n    draw(ctx, delta) {\r\n        var _a;\r\n        this._predraw(ctx, delta);\r\n        this.world.update(SystemType.Draw, delta);\r\n        if ((_a = this.engine) === null || _a === void 0 ? void 0 : _a.isDebug) {\r\n            this.debugDraw(ctx);\r\n        }\r\n        this._postdraw(ctx, delta);\r\n    }\r\n    /**\r\n     * Draws all the actors' debug information in the Scene. Called by the [[Engine]].\r\n     * @param ctx  The current rendering context\r\n     * @deprecated\r\n     */\r\n    /* istanbul ignore next */\r\n    debugDraw(ctx) {\r\n        this.emit('predebugdraw', new PreDebugDrawEvent(ctx, this));\r\n        // pass\r\n        this.emit('postdebugdraw', new PostDebugDrawEvent(ctx, this));\r\n    }\r\n    /**\r\n     * Checks whether an actor is contained in this scene or not\r\n     */\r\n    contains(actor) {\r\n        return this.actors.indexOf(actor) > -1;\r\n    }\r\n    add(entity) {\r\n        this.emit('entityadded', { target: entity });\r\n        this.world.add(entity);\r\n        entity.scene = this;\r\n        if (entity instanceof Timer) {\r\n            if (!contains(this._timers, entity)) {\r\n                this.addTimer(entity);\r\n            }\r\n            return;\r\n        }\r\n    }\r\n    remove(entity) {\r\n        if (entity instanceof Entity) {\r\n            this.emit('entityremoved', { target: entity });\r\n            this.world.remove(entity);\r\n        }\r\n        if (entity instanceof Timer) {\r\n            this.removeTimer(entity);\r\n        }\r\n    }\r\n    /**\r\n     * Adds (any) actor to act as a piece of UI, meaning it is always positioned\r\n     * in screen coordinates. UI actors do not participate in collisions.\r\n     * @todo Should this be `ScreenElement` only?\r\n     * @deprecated Use [[Scene.add]]\r\n     */\r\n    addScreenElement(actor) {\r\n        this.add(actor);\r\n    }\r\n    /**\r\n     * Removes an actor as a piece of UI\r\n     * @deprecated Use [[Scene.remove]]\r\n     */\r\n    removeScreenElement(actor) {\r\n        this.remove(actor);\r\n    }\r\n    /**\r\n     * Adds a [[TileMap]] to the scene, once this is done the TileMap will be drawn and updated.\r\n     * @deprecated Use [[Scene.add]]\r\n     */\r\n    addTileMap(tileMap) {\r\n        this.world.add(tileMap);\r\n    }\r\n    /**\r\n     * Removes a [[TileMap]] from the scene, it will no longer be drawn or updated.\r\n     * @deprecated Use [[Scene.remove]]\r\n     */\r\n    removeTileMap(tileMap) {\r\n        this.world.remove(tileMap);\r\n    }\r\n    /**\r\n     * Adds a [[Timer]] to the scene\r\n     * @param timer  The timer to add\r\n     */\r\n    addTimer(timer) {\r\n        this._timers.push(timer);\r\n        timer.scene = this;\r\n        return timer;\r\n    }\r\n    /**\r\n     * Removes a [[Timer]] from the scene.\r\n     * @warning Can be dangerous, use [[cancelTimer]] instead\r\n     * @param timer  The timer to remove\r\n     */\r\n    removeTimer(timer) {\r\n        const i = this._timers.indexOf(timer);\r\n        if (i !== -1) {\r\n            this._timers.splice(i, 1);\r\n        }\r\n        return timer;\r\n    }\r\n    /**\r\n     * Cancels a [[Timer]], removing it from the scene nicely\r\n     * @param timer  The timer to cancel\r\n     */\r\n    cancelTimer(timer) {\r\n        this._cancelQueue.push(timer);\r\n        return timer;\r\n    }\r\n    /**\r\n     * Tests whether a [[Timer]] is active in the scene\r\n     */\r\n    isTimerActive(timer) {\r\n        return this._timers.indexOf(timer) > -1 && !timer.complete;\r\n    }\r\n    isCurrentScene() {\r\n        if (this.engine) {\r\n            return this.engine.currentScene === this;\r\n        }\r\n        return false;\r\n    }\r\n    _collectActorStats(engine) {\r\n        const screenElements = this.actors.filter((a) => a instanceof ScreenElement_ScreenElement);\r\n        for (const _ui of screenElements) {\r\n            engine.stats.currFrame.actors.ui++;\r\n        }\r\n        for (const actor of this.actors) {\r\n            engine.stats.currFrame.actors.alive++;\r\n            for (const child of actor.children) {\r\n                if (isScreenElement(child)) {\r\n                    // TODO not true\r\n                    engine.stats.currFrame.actors.ui++;\r\n                }\r\n                else {\r\n                    engine.stats.currFrame.actors.alive++;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\nScene_decorate([\r\n    obsolete({\r\n        message: 'Will be removed in excalibur v0.26.0',\r\n        alternateMethod: 'ScreenElements now are normal actors with a Transform Coordinate Plane of Screen'\r\n    })\r\n], Scene.prototype, \"screenElements\", null);\r\nScene_decorate([\r\n    obsolete({ message: 'Will be removed in excalibur v0.26.0', alternateMethod: 'Use Scene.add' })\r\n], Scene.prototype, \"addScreenElement\", null);\r\nScene_decorate([\r\n    obsolete({ message: 'Will be removed in excalibur v0.26.0', alternateMethod: 'Use Scene.remove' })\r\n], Scene.prototype, \"removeScreenElement\", null);\r\nScene_decorate([\r\n    obsolete({ message: 'Will be removed in excalibur v0.26.0', alternateMethod: 'Use Scene.add' })\r\n], Scene.prototype, \"addTileMap\", null);\r\nScene_decorate([\r\n    obsolete({ message: 'Will be removed in excalibur v0.26.0', alternateMethod: 'Use Scene.remove' })\r\n], Scene.prototype, \"removeTileMap\", null);\r\n\n;// CONCATENATED MODULE: ./PostProcessing/ColorBlindCorrector.ts\n\r\nvar ColorBlindness;\r\n(function (ColorBlindness) {\r\n    ColorBlindness[ColorBlindness[\"Protanope\"] = 0] = \"Protanope\";\r\n    ColorBlindness[ColorBlindness[\"Deuteranope\"] = 1] = \"Deuteranope\";\r\n    ColorBlindness[ColorBlindness[\"Tritanope\"] = 2] = \"Tritanope\";\r\n})(ColorBlindness || (ColorBlindness = {}));\r\n/**\r\n * This post processor can correct colors and simulate color blindness.\r\n * It is possible to use this on every game, but the game's performance\r\n * will suffer measurably. It's better to use it as a helpful tool while developing your game.\r\n * Remember, the best practice is to design with color blindness in mind.\r\n */\r\nclass ColorBlindCorrector {\r\n    constructor(engine, simulate = false, colorMode = ColorBlindness.Protanope) {\r\n        this.engine = engine;\r\n        this.simulate = simulate;\r\n        this.colorMode = colorMode;\r\n        /*eslint-disable */\r\n        this._vertexShader = '' +\r\n            'attribute vec2 a_position;' +\r\n            'attribute vec2 a_texCoord;' +\r\n            'uniform vec2 u_resolution;' +\r\n            'varying vec2 v_texCoord;' +\r\n            'void main() {' +\r\n            // convert the rectangle from pixels to 0.0 to 1.0\r\n            'vec2 zeroToOne = a_position / u_resolution;' +\r\n            // convert from 0->1 to 0->2\r\n            'vec2 zeroToTwo = zeroToOne * 2.0;' +\r\n            // convert from 0->2 to -1->+1 (clipspace)\r\n            'vec2 clipSpace = zeroToTwo - 1.0;' +\r\n            'gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);' +\r\n            // pass the texCoord to the fragment shader\r\n            // The GPU will interpolate this value between points.\r\n            'v_texCoord = a_texCoord;' +\r\n            '}';\r\n        this._fragmentShader = 'precision mediump float;' +\r\n            // our texture\r\n            'uniform sampler2D u_image;' +\r\n            // the texCoords passed in from the vertex shader.\r\n            'varying vec2 v_texCoord;' +\r\n            // Color blind conversions\r\n            /*'mat3 m[9] =' +\r\n           '{' +\r\n              'mat3(1.0, 0.0, 0.0,  0.0, 1.0, 0.0,  0.0, 0.0, 1.0  ),' + // normal\r\n              'mat3(0.567, 0.433, 0.0,  0.558, 0.442, 0.0,  0.0, 0.242, 0.758),' + // protanopia\r\n              'mat3(0.817, 0.183, 0.0,  0.333, 0.667, 0.0,  0.0, 0.125,0.875),' + // protanomaly\r\n              'mat3(0.625, 0.375, 0.0,  0.7, 0.3, 0.0,  0.0, 0.3,0.7  ),' + // deuteranopia\r\n              'mat3(0.8, 0.2, 0.0,  0.258, 0.742, 0.0,  0.0, 0.142,0.858),' + // deuteranomaly\r\n              'mat3(0.95, 0.05, 0.0,  0.0, 0.433, 0.567,  0.0, 0.475,0.525),' + // tritanopia\r\n              'mat3(0.967, 0.033, 0.0,  0.0, 0.733, 0.267,  0.0, 0.183,0.817),' + // tritanomaly\r\n              'mat3(0.299, 0.587, 0.114,  0.299, 0.587, 0.114,  0.299, 0.587,0.114),' + // achromatopsia\r\n              'mat3(0.618, 0.320, 0.062,  0.163, 0.775, 0.062,  0.163, 0.320,0.516)' +  // achromatomaly\r\n           '};' +*/\r\n            'void main() {' +\r\n            'vec4 o =  texture2D(u_image, v_texCoord);' +\r\n            // RGB to LMS matrix conversion\r\n            'float L = (17.8824 * o.r) + (43.5161 * o.g) + (4.11935 * o.b);' +\r\n            'float M = (3.45565 * o.r) + (27.1554 * o.g) + (3.86714 * o.b);' +\r\n            'float S = (0.0299566 * o.r) + (0.184309 * o.g) + (1.46709 * o.b);' +\r\n            // Simulate color blindness\r\n            '//MODE CODE//' +\r\n            /* Deuteranope for testing\r\n              'float l = 1.0 * L + 0.0 * M + 0.0 * S;' +\r\n                    'float m = 0.494207 * L + 0.0 * M + 1.24827 * S;' +\r\n                    'float s = 0.0 * L + 0.0 * M + 1.0 * S;' +*/\r\n            // LMS to RGB matrix conversion\r\n            'vec4 error;' +\r\n            'error.r = (0.0809444479 * l) + (-0.130504409 * m) + (0.116721066 * s);' +\r\n            'error.g = (-0.0102485335 * l) + (0.0540193266 * m) + (-0.113614708 * s);' +\r\n            'error.b = (-0.000365296938 * l) + (-0.00412161469 * m) + (0.693511405 * s);' +\r\n            'error.a = 1.0;' +\r\n            'vec4 diff = o - error;' +\r\n            'vec4 correction;' +\r\n            'correction.r = 0.0;' +\r\n            'correction.g =  (diff.r * 0.7) + (diff.g * 1.0);' +\r\n            'correction.b =  (diff.r * 0.7) + (diff.b * 1.0);' +\r\n            'correction = o + correction;' +\r\n            'correction.a = o.a;' +\r\n            '//SIMULATE//' +\r\n            '}';\r\n        this._internalCanvas = document.createElement('canvas');\r\n        this._internalCanvas.width = engine.drawWidth;\r\n        this._internalCanvas.height = engine.drawHeight;\r\n        // eslint-disable-next-line\r\n        this._gl = this._internalCanvas.getContext('webgl', { preserveDrawingBuffer: true });\r\n        this._program = this._gl.createProgram();\r\n        const fragmentShader = this._getShader('Fragment', this._getFragmentShaderByMode(colorMode));\r\n        const vertextShader = this._getShader('Vertex', this._vertexShader);\r\n        this._gl.attachShader(this._program, vertextShader);\r\n        this._gl.attachShader(this._program, fragmentShader);\r\n        this._gl.linkProgram(this._program);\r\n        if (!this._gl.getProgramParameter(this._program, this._gl.LINK_STATUS)) {\r\n            Logger.getInstance().error('Unable to link shader program!');\r\n        }\r\n        this._gl.useProgram(this._program);\r\n    }\r\n    _getFragmentShaderByMode(colorMode) {\r\n        let code = '';\r\n        if (colorMode === ColorBlindness.Protanope) {\r\n            code =\r\n                'float l = 0.0 * L + 2.02344 * M + -2.52581 * S;' +\r\n                    'float m = 0.0 * L + 1.0 * M + 0.0 * S;' +\r\n                    'float s = 0.0 * L + 0.0 * M + 1.0 * S;';\r\n        }\r\n        else if (colorMode === ColorBlindness.Deuteranope) {\r\n            code =\r\n                'float l = 1.0 * L + 0.0 * M + 0.0 * S;' +\r\n                    'float m = 0.494207 * L + 0.0 * M + 1.24827 * S;' +\r\n                    'float s = 0.0 * L + 0.0 * M + 1.0 * S;';\r\n        }\r\n        else if (colorMode === ColorBlindness.Tritanope) {\r\n            code =\r\n                'float l = 1.0 * L + 0.0 * M + 0.0 * S;' +\r\n                    'float m = 0.0 * L + 1.0 * M + 0.0 * S;' +\r\n                    'float s = -0.395913 * L + 0.801109 * M + 0.0 * S;';\r\n        }\r\n        if (this.simulate) {\r\n            this._fragmentShader = this._fragmentShader.replace('//SIMULATE//', 'gl_FragColor = error.rgba;');\r\n        }\r\n        else {\r\n            this._fragmentShader = this._fragmentShader.replace('//SIMULATE//', 'gl_FragColor = correction.rgba;');\r\n        }\r\n        return this._fragmentShader.replace('//MODE CODE//', code);\r\n    }\r\n    _setRectangle(x, y, width, height) {\r\n        const x1 = x;\r\n        const x2 = x + width;\r\n        const y1 = y;\r\n        const y2 = y + height;\r\n        this._gl.bufferData(this._gl.ARRAY_BUFFER, new Float32Array([x1, y1, x2, y1, x1, y2, x1, y2, x2, y1, x2, y2]), this._gl.STATIC_DRAW);\r\n    }\r\n    _getShader(type, program) {\r\n        let shader;\r\n        if (type === 'Fragment') {\r\n            shader = this._gl.createShader(this._gl.FRAGMENT_SHADER);\r\n        }\r\n        else if (type === 'Vertex') {\r\n            shader = this._gl.createShader(this._gl.VERTEX_SHADER);\r\n        }\r\n        else {\r\n            Logger.getInstance().error('Error unknown shader type', type);\r\n        }\r\n        this._gl.shaderSource(shader, program);\r\n        this._gl.compileShader(shader);\r\n        if (!this._gl.getShaderParameter(shader, this._gl.COMPILE_STATUS)) {\r\n            Logger.getInstance().error('Unable to compile shader!', this._gl.getShaderInfoLog(shader));\r\n            return null;\r\n        }\r\n        return shader;\r\n    }\r\n    process(image, out) {\r\n        // look up where the vertex data needs to go.\r\n        const positionLocation = this._gl.getAttribLocation(this._program, 'a_position');\r\n        const texCoordLocation = this._gl.getAttribLocation(this._program, 'a_texCoord');\r\n        const texCoordBuffer = this._gl.createBuffer();\r\n        this._gl.bindBuffer(this._gl.ARRAY_BUFFER, texCoordBuffer);\r\n        this._gl.bufferData(this._gl.ARRAY_BUFFER, new Float32Array([0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 1.0, 1.0]), this._gl.STATIC_DRAW);\r\n        this._gl.enableVertexAttribArray(texCoordLocation);\r\n        this._gl.vertexAttribPointer(texCoordLocation, 2, this._gl.FLOAT, false, 0, 0);\r\n        // Create a texture.\r\n        const texture = this._gl.createTexture();\r\n        this._gl.bindTexture(this._gl.TEXTURE_2D, texture);\r\n        // Set the parameters so we can render any size image.\r\n        this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_WRAP_S, this._gl.CLAMP_TO_EDGE);\r\n        this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_WRAP_T, this._gl.CLAMP_TO_EDGE);\r\n        this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_MIN_FILTER, this._gl.NEAREST);\r\n        this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_MAG_FILTER, this._gl.NEAREST);\r\n        // Flip the texture when unpacking into the gl context, gl reads textures in the opposite order as everything else :/\r\n        this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL, 1);\r\n        // Upload the image into the texture.\r\n        this._gl.texImage2D(this._gl.TEXTURE_2D, 0, this._gl.RGBA, this._gl.RGBA, this._gl.UNSIGNED_BYTE, image);\r\n        // lookup uniforms\r\n        const resolutionLocation = this._gl.getUniformLocation(this._program, 'u_resolution');\r\n        // set the resolution\r\n        this._gl.uniform2f(resolutionLocation, this._internalCanvas.width, this._internalCanvas.height);\r\n        // Create a buffer for the position of the rectangle corners.\r\n        const positionBuffer = this._gl.createBuffer();\r\n        this._gl.bindBuffer(this._gl.ARRAY_BUFFER, positionBuffer);\r\n        this._gl.enableVertexAttribArray(positionLocation);\r\n        this._gl.vertexAttribPointer(positionLocation, 2, this._gl.FLOAT, false, 0, 0);\r\n        // Set a rectangle the same size as the image.\r\n        this._setRectangle(0, 0, image.width, image.height);\r\n        // Draw the rectangle.\r\n        this._gl.drawArrays(this._gl.TRIANGLES, 0, 6);\r\n        // Grab transformed image from internal canvas\r\n        const pixelData = new Uint8Array(image.width * image.height * 4);\r\n        this._gl.readPixels(0, 0, image.width, image.height, this._gl.RGBA, this._gl.UNSIGNED_BYTE, pixelData);\r\n        image.data.set(pixelData);\r\n        out.putImageData(image, 0, 0);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Debug/DebugFlags.ts\n\r\nclass ColorBlindFlags {\r\n    constructor(engine) {\r\n        this._engine = engine;\r\n    }\r\n    correct(colorBlindness) {\r\n        this._engine.postProcessors.push(new ColorBlindCorrector(this._engine, false, colorBlindness));\r\n    }\r\n    simulate(colorBlindness) {\r\n        this._engine.postProcessors.push(new ColorBlindCorrector(this._engine, true, colorBlindness));\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Debug/Debug.ts\n\r\n\r\n/**\r\n * Debug statistics and flags for Excalibur. If polling these values, it would be\r\n * best to do so on the `postupdate` event for [[Engine]], after all values have been\r\n * updated during a frame.\r\n */\r\nclass Debug {\r\n    constructor(engine) {\r\n        /**\r\n         * Performance statistics\r\n         */\r\n        this.stats = {\r\n            /**\r\n             * Current frame statistics. Engine reuses this instance, use [[FrameStats.clone]] to copy frame stats.\r\n             * Best accessed on [[postframe]] event. See [[FrameStats]]\r\n             */\r\n            currFrame: new FrameStats(),\r\n            /**\r\n             * Previous frame statistics. Engine reuses this instance, use [[FrameStats.clone]] to copy frame stats.\r\n             * Best accessed on [[preframe]] event. Best inspected on engine event `preframe`. See [[FrameStats]]\r\n             */\r\n            prevFrame: new FrameStats()\r\n        };\r\n        /**\r\n         * Filter debug context to named entities or entity ids\r\n         */\r\n        this.filter = {\r\n            /**\r\n             * Toggle filter on or off (default off) must be on for DebugDraw to use filters\r\n             */\r\n            useFilter: false,\r\n            /**\r\n             * Query for entities by name, if the entity name contains `nameQuery` it will be included\r\n             */\r\n            nameQuery: '',\r\n            /**\r\n             * Query for Entity ids, if the id matches it will be included\r\n             */\r\n            ids: []\r\n        };\r\n        /**\r\n         * Entity debug settings\r\n         */\r\n        this.entity = {\r\n            showAll: false,\r\n            showId: true,\r\n            showName: false\r\n        };\r\n        /**\r\n         * Transform component debug settings\r\n         */\r\n        this.transform = {\r\n            showAll: false,\r\n            showPosition: false,\r\n            positionColor: Color.Yellow,\r\n            showScale: false,\r\n            scaleColor: Color.Green,\r\n            showRotation: false,\r\n            rotationColor: Color.Blue\r\n        };\r\n        /**\r\n         * Graphics component debug settings\r\n         */\r\n        this.graphics = {\r\n            showAll: false,\r\n            showBounds: true,\r\n            boundsColor: Color.Yellow\r\n        };\r\n        /**\r\n         * Collider component debug settings\r\n         */\r\n        this.collider = {\r\n            showAll: false,\r\n            showBounds: true,\r\n            boundsColor: Color.Blue,\r\n            showOwner: false,\r\n            showGeometry: true,\r\n            geometryColor: Color.Green\r\n        };\r\n        /**\r\n         * Physics simulation debug settings\r\n         */\r\n        this.physics = {\r\n            showAll: false,\r\n            showBroadphaseSpacePartitionDebug: false,\r\n            showCollisionNormals: false,\r\n            collisionNormalColor: Color.Cyan,\r\n            showCollisionContacts: true,\r\n            collisionContactColor: Color.Red\r\n        };\r\n        /**\r\n         * Motion component debug settings\r\n         */\r\n        this.motion = {\r\n            showAll: false,\r\n            showVelocity: false,\r\n            velocityColor: Color.Yellow,\r\n            showAcceleration: false,\r\n            accelerationColor: Color.Red\r\n        };\r\n        /**\r\n         * Body component debug settings\r\n         */\r\n        this.body = {\r\n            showAll: false,\r\n            showCollisionGroup: false,\r\n            showCollisionType: false,\r\n            showSleeping: false,\r\n            showMotion: false,\r\n            showMass: false\r\n        };\r\n        /**\r\n         * Camera debug settings\r\n         */\r\n        this.camera = {\r\n            showAll: false,\r\n            showFocus: false,\r\n            focusColor: Color.Red,\r\n            showZoom: false\r\n        };\r\n        this._engine = engine;\r\n        this.colorBlindMode = new ColorBlindFlags(this._engine);\r\n    }\r\n}\r\n/**\r\n * Implementation of a frame's stats. Meant to have values copied via [[FrameStats.reset]], avoid\r\n * creating instances of this every frame.\r\n */\r\nclass FrameStats {\r\n    constructor() {\r\n        this._id = 0;\r\n        this._delta = 0;\r\n        this._fps = 0;\r\n        this._actorStats = {\r\n            alive: 0,\r\n            killed: 0,\r\n            ui: 0,\r\n            get remaining() {\r\n                return this.alive - this.killed;\r\n            },\r\n            get total() {\r\n                return this.remaining + this.ui;\r\n            }\r\n        };\r\n        this._durationStats = {\r\n            update: 0,\r\n            draw: 0,\r\n            get total() {\r\n                return this.update + this.draw;\r\n            }\r\n        };\r\n        this._physicsStats = new PhysicsStats();\r\n        this._graphicsStats = {\r\n            drawCalls: 0,\r\n            drawnImages: 0\r\n        };\r\n    }\r\n    /**\r\n     * Zero out values or clone other IFrameStat stats. Allows instance reuse.\r\n     *\r\n     * @param [otherStats] Optional stats to clone\r\n     */\r\n    reset(otherStats) {\r\n        if (otherStats) {\r\n            this.id = otherStats.id;\r\n            this.delta = otherStats.delta;\r\n            this.fps = otherStats.fps;\r\n            this.actors.alive = otherStats.actors.alive;\r\n            this.actors.killed = otherStats.actors.killed;\r\n            this.actors.ui = otherStats.actors.ui;\r\n            this.duration.update = otherStats.duration.update;\r\n            this.duration.draw = otherStats.duration.draw;\r\n            this._physicsStats.reset(otherStats.physics);\r\n            this.graphics.drawCalls = otherStats.graphics.drawCalls;\r\n            this.graphics.drawnImages = otherStats.graphics.drawnImages;\r\n        }\r\n        else {\r\n            this.id = this.delta = this.fps = 0;\r\n            this.actors.alive = this.actors.killed = this.actors.ui = 0;\r\n            this.duration.update = this.duration.draw = 0;\r\n            this._physicsStats.reset();\r\n            this.graphics.drawnImages = this.graphics.drawCalls = 0;\r\n        }\r\n    }\r\n    /**\r\n     * Provides a clone of this instance.\r\n     */\r\n    clone() {\r\n        const fs = new FrameStats();\r\n        fs.reset(this);\r\n        return fs;\r\n    }\r\n    /**\r\n     * Gets the frame's id\r\n     */\r\n    get id() {\r\n        return this._id;\r\n    }\r\n    /**\r\n     * Sets the frame's id\r\n     */\r\n    set id(value) {\r\n        this._id = value;\r\n    }\r\n    /**\r\n     * Gets the frame's delta (time since last frame)\r\n     */\r\n    get delta() {\r\n        return this._delta;\r\n    }\r\n    /**\r\n     * Sets the frame's delta (time since last frame). Internal use only.\r\n     * @internal\r\n     */\r\n    set delta(value) {\r\n        this._delta = value;\r\n    }\r\n    /**\r\n     * Gets the frame's frames-per-second (FPS)\r\n     */\r\n    get fps() {\r\n        return this._fps;\r\n    }\r\n    /**\r\n     * Sets the frame's frames-per-second (FPS). Internal use only.\r\n     * @internal\r\n     */\r\n    set fps(value) {\r\n        this._fps = value;\r\n    }\r\n    /**\r\n     * Gets the frame's actor statistics\r\n     */\r\n    get actors() {\r\n        return this._actorStats;\r\n    }\r\n    /**\r\n     * Gets the frame's duration statistics\r\n     */\r\n    get duration() {\r\n        return this._durationStats;\r\n    }\r\n    /**\r\n     * Gets the frame's physics statistics\r\n     */\r\n    get physics() {\r\n        return this._physicsStats;\r\n    }\r\n    /**\r\n     * Gets the frame's graphics statistics\r\n     */\r\n    get graphics() {\r\n        return this._graphicsStats;\r\n    }\r\n}\r\nclass PhysicsStats {\r\n    constructor() {\r\n        this._pairs = 0;\r\n        this._collisions = 0;\r\n        this._contacts = new Map();\r\n        this._fastBodies = 0;\r\n        this._fastBodyCollisions = 0;\r\n        this._broadphase = 0;\r\n        this._narrowphase = 0;\r\n    }\r\n    /**\r\n     * Zero out values or clone other IPhysicsStats stats. Allows instance reuse.\r\n     *\r\n     * @param [otherStats] Optional stats to clone\r\n     */\r\n    reset(otherStats) {\r\n        if (otherStats) {\r\n            this.pairs = otherStats.pairs;\r\n            this.collisions = otherStats.collisions;\r\n            this.contacts = otherStats.contacts;\r\n            this.fastBodies = otherStats.fastBodies;\r\n            this.fastBodyCollisions = otherStats.fastBodyCollisions;\r\n            this.broadphase = otherStats.broadphase;\r\n            this.narrowphase = otherStats.narrowphase;\r\n        }\r\n        else {\r\n            this.pairs = this.collisions = this.fastBodies = 0;\r\n            this.fastBodyCollisions = this.broadphase = this.narrowphase = 0;\r\n            this.contacts.clear();\r\n        }\r\n    }\r\n    /**\r\n     * Provides a clone of this instance.\r\n     */\r\n    clone() {\r\n        const ps = new PhysicsStats();\r\n        ps.reset(this);\r\n        return ps;\r\n    }\r\n    get pairs() {\r\n        return this._pairs;\r\n    }\r\n    set pairs(value) {\r\n        this._pairs = value;\r\n    }\r\n    get collisions() {\r\n        return this._collisions;\r\n    }\r\n    set collisions(value) {\r\n        this._collisions = value;\r\n    }\r\n    get contacts() {\r\n        return this._contacts;\r\n    }\r\n    set contacts(contacts) {\r\n        this._contacts = contacts;\r\n    }\r\n    get fastBodies() {\r\n        return this._fastBodies;\r\n    }\r\n    set fastBodies(value) {\r\n        this._fastBodies = value;\r\n    }\r\n    get fastBodyCollisions() {\r\n        return this._fastBodyCollisions;\r\n    }\r\n    set fastBodyCollisions(value) {\r\n        this._fastBodyCollisions = value;\r\n    }\r\n    get broadphase() {\r\n        return this._broadphase;\r\n    }\r\n    set broadphase(value) {\r\n        this._broadphase = value;\r\n    }\r\n    get narrowphase() {\r\n        return this._narrowphase;\r\n    }\r\n    set narrowphase(value) {\r\n        this._narrowphase = value;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Input/Keyboard.ts\n\r\n\r\n\r\n/**\r\n * Enum representing physical input key codes\r\n */\r\nvar Keys;\r\n(function (Keys) {\r\n    // NUMPAD\r\n    Keys[\"Num0\"] = \"Numpad0\";\r\n    Keys[\"Num1\"] = \"Numpad1\";\r\n    Keys[\"Num2\"] = \"Numpad2\";\r\n    Keys[\"Num3\"] = \"Numpad3\";\r\n    Keys[\"Num4\"] = \"Numpad4\";\r\n    Keys[\"Num5\"] = \"Numpad5\";\r\n    Keys[\"Num6\"] = \"Numpad6\";\r\n    Keys[\"Num7\"] = \"Numpad7\";\r\n    Keys[\"Num8\"] = \"Numpad8\";\r\n    Keys[\"Num9\"] = \"Numpad9\";\r\n    Keys[\"NumAdd\"] = \"NumpadAdd\";\r\n    Keys[\"NumSubtract\"] = \"NumpadSubtract\";\r\n    Keys[\"NumMultiply\"] = \"NumpadMultiply\";\r\n    Keys[\"NumDivide\"] = \"NumpadDivide\";\r\n    // NumComma = 'NumpadComma', // not x-browser\r\n    Keys[\"NumDecimal\"] = \"NumpadDecimal\";\r\n    Keys[\"Numpad0\"] = \"Numpad0\";\r\n    Keys[\"Numpad1\"] = \"Numpad1\";\r\n    Keys[\"Numpad2\"] = \"Numpad2\";\r\n    Keys[\"Numpad3\"] = \"Numpad3\";\r\n    Keys[\"Numpad4\"] = \"Numpad4\";\r\n    Keys[\"Numpad5\"] = \"Numpad5\";\r\n    Keys[\"Numpad6\"] = \"Numpad6\";\r\n    Keys[\"Numpad7\"] = \"Numpad7\";\r\n    Keys[\"Numpad8\"] = \"Numpad8\";\r\n    Keys[\"Numpad9\"] = \"Numpad9\";\r\n    Keys[\"NumpadAdd\"] = \"NumpadAdd\";\r\n    Keys[\"NumpadSubtract\"] = \"NumpadSubtract\";\r\n    Keys[\"NumpadMultiply\"] = \"NumpadMultiply\";\r\n    Keys[\"NumpadDivide\"] = \"NumpadDivide\";\r\n    // NumpadComma = 'NumpadComma', // not x-browser\r\n    Keys[\"NumpadDecimal\"] = \"NumpadDecimal\";\r\n    // MODIFIERS\r\n    Keys[\"NumLock\"] = \"NumLock\";\r\n    Keys[\"ShiftLeft\"] = \"ShiftLeft\";\r\n    Keys[\"ShiftRight\"] = \"ShiftRight\";\r\n    Keys[\"AltLeft\"] = \"AltLeft\";\r\n    Keys[\"AltRight\"] = \"AltRight\";\r\n    // NUMBERS\r\n    Keys[\"Key0\"] = \"Digit0\";\r\n    Keys[\"Key1\"] = \"Digit1\";\r\n    Keys[\"Key2\"] = \"Digit2\";\r\n    Keys[\"Key3\"] = \"Digit3\";\r\n    Keys[\"Key4\"] = \"Digit4\";\r\n    Keys[\"Key5\"] = \"Digit5\";\r\n    Keys[\"Key6\"] = \"Digit6\";\r\n    Keys[\"Key7\"] = \"Digit7\";\r\n    Keys[\"Key8\"] = \"Digit8\";\r\n    Keys[\"Key9\"] = \"Digit9\";\r\n    Keys[\"Digit0\"] = \"Digit0\";\r\n    Keys[\"Digit1\"] = \"Digit1\";\r\n    Keys[\"Digit2\"] = \"Digit2\";\r\n    Keys[\"Digit3\"] = \"Digit3\";\r\n    Keys[\"Digit4\"] = \"Digit4\";\r\n    Keys[\"Digit5\"] = \"Digit5\";\r\n    Keys[\"Digit6\"] = \"Digit6\";\r\n    Keys[\"Digit7\"] = \"Digit7\";\r\n    Keys[\"Digit8\"] = \"Digit8\";\r\n    Keys[\"Digit9\"] = \"Digit9\";\r\n    // LETTERS\r\n    Keys[\"A\"] = \"KeyA\";\r\n    Keys[\"B\"] = \"KeyB\";\r\n    Keys[\"C\"] = \"KeyC\";\r\n    Keys[\"D\"] = \"KeyD\";\r\n    Keys[\"E\"] = \"KeyE\";\r\n    Keys[\"F\"] = \"KeyF\";\r\n    Keys[\"G\"] = \"KeyG\";\r\n    Keys[\"H\"] = \"KeyH\";\r\n    Keys[\"I\"] = \"KeyI\";\r\n    Keys[\"J\"] = \"KeyJ\";\r\n    Keys[\"K\"] = \"KeyK\";\r\n    Keys[\"L\"] = \"KeyL\";\r\n    Keys[\"M\"] = \"KeyM\";\r\n    Keys[\"N\"] = \"KeyN\";\r\n    Keys[\"O\"] = \"KeyO\";\r\n    Keys[\"P\"] = \"KeyP\";\r\n    Keys[\"Q\"] = \"KeyQ\";\r\n    Keys[\"R\"] = \"KeyR\";\r\n    Keys[\"S\"] = \"KeyS\";\r\n    Keys[\"T\"] = \"KeyT\";\r\n    Keys[\"U\"] = \"KeyU\";\r\n    Keys[\"V\"] = \"KeyV\";\r\n    Keys[\"W\"] = \"KeyW\";\r\n    Keys[\"X\"] = \"KeyX\";\r\n    Keys[\"Y\"] = \"KeyY\";\r\n    Keys[\"Z\"] = \"KeyZ\";\r\n    Keys[\"KeyA\"] = \"KeyA\";\r\n    Keys[\"KeyB\"] = \"KeyB\";\r\n    Keys[\"KeyC\"] = \"KeyC\";\r\n    Keys[\"KeyD\"] = \"KeyD\";\r\n    Keys[\"KeyE\"] = \"KeyE\";\r\n    Keys[\"KeyF\"] = \"KeyF\";\r\n    Keys[\"KeyG\"] = \"KeyG\";\r\n    Keys[\"KeyH\"] = \"KeyH\";\r\n    Keys[\"KeyI\"] = \"KeyI\";\r\n    Keys[\"KeyJ\"] = \"KeyJ\";\r\n    Keys[\"KeyK\"] = \"KeyK\";\r\n    Keys[\"KeyL\"] = \"KeyL\";\r\n    Keys[\"KeyM\"] = \"KeyM\";\r\n    Keys[\"KeyN\"] = \"KeyN\";\r\n    Keys[\"KeyO\"] = \"KeyO\";\r\n    Keys[\"KeyP\"] = \"KeyP\";\r\n    Keys[\"KeyQ\"] = \"KeyQ\";\r\n    Keys[\"KeyR\"] = \"KeyR\";\r\n    Keys[\"KeyS\"] = \"KeyS\";\r\n    Keys[\"KeyT\"] = \"KeyT\";\r\n    Keys[\"KeyU\"] = \"KeyU\";\r\n    Keys[\"KeyV\"] = \"KeyV\";\r\n    Keys[\"KeyW\"] = \"KeyW\";\r\n    Keys[\"KeyX\"] = \"KeyX\";\r\n    Keys[\"KeyY\"] = \"KeyY\";\r\n    Keys[\"KeyZ\"] = \"KeyZ\";\r\n    // SYMBOLS\r\n    Keys[\"Semicolon\"] = \"Semicolon\";\r\n    Keys[\"Quote\"] = \"Quote\";\r\n    Keys[\"Comma\"] = \"Comma\";\r\n    Keys[\"Minus\"] = \"Minus\";\r\n    Keys[\"Period\"] = \"Period\";\r\n    Keys[\"Slash\"] = \"Slash\";\r\n    Keys[\"Equal\"] = \"Equal\";\r\n    Keys[\"BracketLeft\"] = \"BracketLeft\";\r\n    Keys[\"Backslash\"] = \"Backslash\";\r\n    Keys[\"BracketRight\"] = \"BracketRight\";\r\n    Keys[\"Backquote\"] = \"Backquote\";\r\n    // DIRECTIONS\r\n    Keys[\"Up\"] = \"ArrowUp\";\r\n    Keys[\"Down\"] = \"ArrowDown\";\r\n    Keys[\"Left\"] = \"ArrowLeft\";\r\n    Keys[\"Right\"] = \"ArrowRight\";\r\n    Keys[\"ArrowUp\"] = \"ArrowUp\";\r\n    Keys[\"ArrowDown\"] = \"ArrowDown\";\r\n    Keys[\"ArrowLeft\"] = \"ArrowLeft\";\r\n    Keys[\"ArrowRight\"] = \"ArrowRight\";\r\n    // OTHER\r\n    Keys[\"Space\"] = \"Space\";\r\n    Keys[\"Esc\"] = \"Escape\";\r\n    Keys[\"Escape\"] = \"Escape\";\r\n})(Keys || (Keys = {}));\r\n/**\r\n * Event thrown on a game object for a key event\r\n */\r\nclass KeyEvent extends GameEvent {\r\n    /**\r\n     * @param key  The key responsible for throwing the event\r\n     * @param value The key's typed value the browser detected\r\n     * @param originalEvent The original keyboard event that Excalibur handled\r\n     */\r\n    constructor(key, value, originalEvent) {\r\n        super();\r\n        this.key = key;\r\n        this.value = value;\r\n        this.originalEvent = originalEvent;\r\n    }\r\n}\r\n/**\r\n * Provides keyboard support for Excalibur.\r\n */\r\nclass Keyboard extends Class {\r\n    constructor() {\r\n        super();\r\n        this._keys = [];\r\n        this._keysUp = [];\r\n        this._keysDown = [];\r\n    }\r\n    on(eventName, handler) {\r\n        super.on(eventName, handler);\r\n    }\r\n    /**\r\n     * Initialize Keyboard event listeners\r\n     */\r\n    init(global) {\r\n        if (!global) {\r\n            try {\r\n                // Try and listen to events on top window frame if within an iframe.\r\n                //\r\n                // See https://github.com/excaliburjs/Excalibur/issues/1294\r\n                //\r\n                // Attempt to add an event listener, which triggers a DOMException on\r\n                // cross-origin iframes\r\n                const noop = () => {\r\n                    return;\r\n                };\r\n                window.top.addEventListener('blur', noop);\r\n                window.top.removeEventListener('blur', noop);\r\n                // this will be the same as window if not embedded within an iframe\r\n                global = window.top;\r\n            }\r\n            catch (_a) {\r\n                // fallback to current frame\r\n                global = window;\r\n                Logger.getInstance().warn('Failed to bind to keyboard events to top frame. ' +\r\n                    'If you are trying to embed Excalibur in a cross-origin iframe, keyboard events will not fire.');\r\n            }\r\n        }\r\n        global.addEventListener('blur', () => {\r\n            this._keys.length = 0; // empties array efficiently\r\n        });\r\n        // key up is on window because canvas cannot have focus\r\n        global.addEventListener('keyup', (ev) => {\r\n            const code = ev.code;\r\n            const key = this._keys.indexOf(code);\r\n            this._keys.splice(key, 1);\r\n            this._keysUp.push(code);\r\n            const keyEvent = new KeyEvent(code, ev.key, ev);\r\n            // alias the old api, we may want to deprecate this in the future\r\n            this.eventDispatcher.emit('up', keyEvent);\r\n            this.eventDispatcher.emit('release', keyEvent);\r\n        });\r\n        // key down is on window because canvas cannot have focus\r\n        global.addEventListener('keydown', (ev) => {\r\n            const code = ev.code;\r\n            if (this._keys.indexOf(code) === -1) {\r\n                this._keys.push(code);\r\n                this._keysDown.push(code);\r\n                const keyEvent = new KeyEvent(code, ev.key, ev);\r\n                this.eventDispatcher.emit('down', keyEvent);\r\n                this.eventDispatcher.emit('press', keyEvent);\r\n            }\r\n        });\r\n    }\r\n    update() {\r\n        // Reset keysDown and keysUp after update is complete\r\n        this._keysDown.length = 0;\r\n        this._keysUp.length = 0;\r\n        // Emit synthetic \"hold\" event\r\n        for (let i = 0; i < this._keys.length; i++) {\r\n            this.eventDispatcher.emit('hold', new KeyEvent(this._keys[i]));\r\n        }\r\n    }\r\n    /**\r\n     * Gets list of keys being pressed down\r\n     */\r\n    getKeys() {\r\n        return this._keys;\r\n    }\r\n    /**\r\n     * Tests if a certain key was just pressed this frame. This is cleared at the end of the update frame.\r\n     * @param key Test whether a key was just pressed\r\n     */\r\n    wasPressed(key) {\r\n        return this._keysDown.indexOf(key) > -1;\r\n    }\r\n    /**\r\n     * Tests if a certain key is held down. This is persisted between frames.\r\n     * @param key  Test whether a key is held down\r\n     */\r\n    isHeld(key) {\r\n        return this._keys.indexOf(key) > -1;\r\n    }\r\n    /**\r\n     * Tests if a certain key was just released this frame. This is cleared at the end of the update frame.\r\n     * @param key  Test whether a key was just released\r\n     */\r\n    wasReleased(key) {\r\n        return this._keysUp.indexOf(key) > -1;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Input/Pointer.ts\n\r\n\r\n\r\n\r\n/**\r\n * The type of pointer for a [[PointerEvent]].\r\n */\r\nvar PointerType;\r\n(function (PointerType) {\r\n    PointerType[\"Touch\"] = \"Touch\";\r\n    PointerType[\"Mouse\"] = \"Mouse\";\r\n    PointerType[\"Pen\"] = \"Pen\";\r\n    PointerType[\"Unknown\"] = \"Unknown\";\r\n})(PointerType || (PointerType = {}));\r\n/**\r\n * Determines the scope of handling mouse/touch events. See [[Pointers]] for more information.\r\n */\r\nvar PointerScope;\r\n(function (PointerScope) {\r\n    /**\r\n     * Handle events on the `canvas` element only. Events originating outside the\r\n     * `canvas` will not be handled.\r\n     */\r\n    PointerScope[\"Canvas\"] = \"Canvas\";\r\n    /**\r\n     * Handles events on the entire document. All events will be handled by Excalibur.\r\n     */\r\n    PointerScope[\"Document\"] = \"Document\";\r\n})(PointerScope || (PointerScope = {}));\r\n/**\r\n * Captures and dispatches PointerEvents\r\n */\r\nclass Pointer extends Class {\r\n    constructor() {\r\n        super();\r\n        this.id = Pointer._MAX_ID++;\r\n        this._isDown = false;\r\n        this._wasDown = false;\r\n        this._actorsUnderPointer = { length: 0 };\r\n        this._actors = [];\r\n        this._actorsLastFrame = [];\r\n        this._actorsNoLongerUnderPointer = [];\r\n        this._actorSortingFcn = (a, b) => {\r\n            if (a.z === b.z) {\r\n                return b.id - a.id;\r\n            }\r\n            return b.z - a.z;\r\n        };\r\n        /**\r\n         * The last position on the document this pointer was at. Can be `null` if pointer was never active.\r\n         */\r\n        this.lastPagePos = null;\r\n        /**\r\n         * The last position on the screen this pointer was at. Can be `null` if pointer was never active.\r\n         */\r\n        this.lastScreenPos = null;\r\n        /**\r\n         * The last position in the game world coordinates this pointer was at. Can be `null` if pointer was never active.\r\n         */\r\n        this.lastWorldPos = null;\r\n        /**\r\n         * Returns the currently dragging target or null if it isn't exist\r\n         */\r\n        this.dragTarget = null;\r\n        this.on('move', this._onPointerMove);\r\n        this.on('down', this._onPointerDown);\r\n        this.on('up', this._onPointerUp);\r\n    }\r\n    /**\r\n     * Whether the Pointer is currently dragging.\r\n     */\r\n    get isDragging() {\r\n        return this._isDown;\r\n    }\r\n    /**\r\n     * Whether the Pointer just started dragging.\r\n     */\r\n    get isDragStart() {\r\n        return !this._wasDown && this._isDown;\r\n    }\r\n    /**\r\n     * Whether the Pointer just ended dragging.\r\n     */\r\n    get isDragEnd() {\r\n        return this._wasDown && !this._isDown;\r\n    }\r\n    /**\r\n     * Returns true if pointer has any actors under\r\n     */\r\n    get hasActorsUnderPointer() {\r\n        return !!this._actorsUnderPointer.length;\r\n    }\r\n    on(event, handler) {\r\n        super.on(event, handler);\r\n    }\r\n    once(event, handler) {\r\n        super.once(event, handler);\r\n    }\r\n    off(event, handler) {\r\n        super.off(event, handler);\r\n    }\r\n    /**\r\n     * Update the state of current pointer, meant to be called a the end of frame\r\n     */\r\n    update() {\r\n        if (this._wasDown && !this._isDown) {\r\n            this._wasDown = false;\r\n        }\r\n        else if (!this._wasDown && this._isDown) {\r\n            this._wasDown = true;\r\n        }\r\n        this._actorsLastFrame = [...this._actors];\r\n        this._actorsNoLongerUnderPointer = [];\r\n    }\r\n    /**\r\n     * Adds an Actor to actorsUnderPointer object.\r\n     * @param actor An Actor to be added;\r\n     */\r\n    addActorUnderPointer(actor) {\r\n        if (!this.isActorAliveUnderPointer(actor)) {\r\n            this._actorsUnderPointer[actor.id] = actor;\r\n            this._actorsUnderPointer.length += 1;\r\n            this._actors.push(actor);\r\n        }\r\n        // Actors are processed in z-order highest z to lowest\r\n        // ties are broken by id highest id (newest) to lowest id (oldest)\r\n        this._actors.sort(this._actorSortingFcn);\r\n    }\r\n    /**\r\n     * Removes an Actor from actorsUnderPointer object.\r\n     * @param actor An Actor to be removed;\r\n     */\r\n    removeActorUnderPointer(actor) {\r\n        if (this.isActorAliveUnderPointer(actor)) {\r\n            delete this._actorsUnderPointer[actor.id];\r\n            this._actorsUnderPointer.length -= 1;\r\n            removeItemFromArray(actor, this._actors);\r\n            this._actorsNoLongerUnderPointer.push(actor);\r\n        }\r\n    }\r\n    /**\r\n     * Returns all actors under this pointer this frame\r\n     */\r\n    getActorsUnderPointer() {\r\n        return this._actors;\r\n    }\r\n    /**\r\n     * Returns all actors that are no longer under the pointer this frame\r\n     */\r\n    getActorsUnderPointerLastFrame() {\r\n        return this._actorsLastFrame;\r\n    }\r\n    /**\r\n     * Returns all actors relevant for events to pointer this frame\r\n     */\r\n    getActorsForEvents() {\r\n        return this._actors\r\n            .concat(this._actorsLastFrame)\r\n            .filter((actor, i, self) => {\r\n            return self.indexOf(actor) === i; // de-dup\r\n        })\r\n            .sort(this._actorSortingFcn); // sort by z\r\n    }\r\n    /**\r\n     * Checks if Pointer location has a specific Actor bounds contained underneath.\r\n     * @param actor An Actor for check;\r\n     */\r\n    checkActorUnderPointer(actor) {\r\n        if (this.lastWorldPos) {\r\n            return actor.contains(this.lastWorldPos.x, this.lastWorldPos.y, !isScreenElement(actor));\r\n        }\r\n        return false;\r\n    }\r\n    /**\r\n     * Checks if an actor was under the pointer last frame\r\n     * @param actor\r\n     */\r\n    wasActorUnderPointer(actor) {\r\n        return this._actorsLastFrame.indexOf(actor) > -1;\r\n    }\r\n    /**\r\n     * Checks if Pointer has a specific Actor in ActorsUnderPointer list.\r\n     * @param actor An Actor for check;\r\n     */\r\n    isActorAliveUnderPointer(actor) {\r\n        return !!(!actor.isKilled() && actor.scene && this._actorsUnderPointer.hasOwnProperty(actor.id.toString()));\r\n    }\r\n    _onPointerMove(ev) {\r\n        this.lastPagePos = new Vector(ev.pagePos.x, ev.pagePos.y);\r\n        this.lastScreenPos = new Vector(ev.screenPos.x, ev.screenPos.y);\r\n        this.lastWorldPos = new Vector(ev.worldPos.x, ev.worldPos.y);\r\n    }\r\n    _onPointerDown(ev) {\r\n        this.lastPagePos = new Vector(ev.pagePos.x, ev.pagePos.y);\r\n        this.lastScreenPos = new Vector(ev.screenPos.x, ev.screenPos.y);\r\n        this.lastWorldPos = new Vector(ev.worldPos.x, ev.worldPos.y);\r\n        this._isDown = true;\r\n    }\r\n    _onPointerUp(_ev) {\r\n        this._isDown = false;\r\n        this.dragTarget = null;\r\n    }\r\n}\r\nPointer._MAX_ID = 0;\r\n\n;// CONCATENATED MODULE: ./Input/PointerEvents.ts\n\r\n/**\r\n * Native browser button enumeration\r\n */\r\nvar NativePointerButton;\r\n(function (NativePointerButton) {\r\n    NativePointerButton[NativePointerButton[\"NoButton\"] = -1] = \"NoButton\";\r\n    NativePointerButton[NativePointerButton[\"Left\"] = 0] = \"Left\";\r\n    NativePointerButton[NativePointerButton[\"Middle\"] = 1] = \"Middle\";\r\n    NativePointerButton[NativePointerButton[\"Right\"] = 2] = \"Right\";\r\n    NativePointerButton[NativePointerButton[\"Unknown\"] = 3] = \"Unknown\";\r\n})(NativePointerButton || (NativePointerButton = {}));\r\n/**\r\n * The mouse button being pressed.\r\n */\r\nvar PointerButton;\r\n(function (PointerButton) {\r\n    PointerButton[\"Left\"] = \"Left\";\r\n    PointerButton[\"Middle\"] = \"Middle\";\r\n    PointerButton[\"Right\"] = \"Right\";\r\n    PointerButton[\"Unknown\"] = \"Unknown\";\r\n    PointerButton[\"NoButton\"] = \"NoButton\";\r\n})(PointerButton || (PointerButton = {}));\r\nvar WheelDeltaMode;\r\n(function (WheelDeltaMode) {\r\n    WheelDeltaMode[\"Pixel\"] = \"Pixel\";\r\n    WheelDeltaMode[\"Line\"] = \"Line\";\r\n    WheelDeltaMode[\"Page\"] = \"Page\";\r\n})(WheelDeltaMode || (WheelDeltaMode = {}));\r\n/**\r\n * Pointer events\r\n *\r\n * Represents a mouse, touch, or stylus event. See [[Pointers]] for more information on\r\n * handling pointer input.\r\n *\r\n * For mouse-based events, you can inspect [[PointerEvent.button]] to see what button was pressed.\r\n */\r\nclass PointerEvent extends GameEvent {\r\n    /**\r\n     * @param coordinates         The [[GlobalCoordinates]] of the event\r\n     * @param pointer             The [[Pointer]] of the event\r\n     * @param index               The index of the pointer (zero-based)\r\n     * @param pointerType         The type of pointer\r\n     * @param button              The button pressed (if [[PointerType.Mouse]])\r\n     * @param ev                  The raw DOM event being handled\r\n     */\r\n    constructor(coordinates, pointer, index, pointerType, button, ev) {\r\n        super();\r\n        this.coordinates = coordinates;\r\n        this.pointer = pointer;\r\n        this.index = index;\r\n        this.pointerType = pointerType;\r\n        this.button = button;\r\n        this.ev = ev;\r\n        this._canceled = false;\r\n    }\r\n    get name() {\r\n        return this._name;\r\n    }\r\n    /** The world coordinates of the event. */\r\n    get worldPos() {\r\n        return this.coordinates.worldPos.clone();\r\n    }\r\n    /** The page coordinates of the event. */\r\n    get pagePos() {\r\n        return this.coordinates.pagePos.clone();\r\n    }\r\n    /** The screen coordinates of the event. */\r\n    get screenPos() {\r\n        return this.coordinates.screenPos.clone();\r\n    }\r\n    get pos() {\r\n        return this.coordinates.worldPos.clone();\r\n    }\r\n    /**\r\n     * Cancels pointer event propogation, event will not be transmitted to any other actors\r\n     */\r\n    cancel() {\r\n        this._canceled = true;\r\n    }\r\n    /**\r\n     *\r\n     * @returns If the event is canceled it will no longer be transmitted to any other actors\r\n     */\r\n    isCanceled() {\r\n        return this._canceled;\r\n    }\r\n    propagate(actor) {\r\n        this.doAction(actor);\r\n        if (this.bubbles && !this.isCanceled() && actor.parent) {\r\n            this.propagate(actor.parent); // TODO not true\r\n        }\r\n    }\r\n    /**\r\n     * Action, that calls when event happens\r\n     */\r\n    doAction(actor) {\r\n        if (actor) {\r\n            this._onActionStart(actor);\r\n            actor.emit(this._name, this);\r\n            this._onActionEnd(actor);\r\n        }\r\n    }\r\n    _onActionStart(_actor) {\r\n        // to be rewritten\r\n    }\r\n    _onActionEnd(_actor) {\r\n        // to be rewritten\r\n    }\r\n}\r\nclass PointerEventFactory {\r\n    constructor(_pointerEventType) {\r\n        this._pointerEventType = _pointerEventType;\r\n    }\r\n    /**\r\n     * Create specific PointerEvent\r\n     */\r\n    create(coordinates, pointer, index, pointerType, button, ev) {\r\n        return new this._pointerEventType(coordinates, pointer, index, pointerType, button, ev);\r\n    }\r\n}\r\nclass PointerDragEvent extends PointerEvent {\r\n}\r\nclass PointerUpEvent extends PointerEvent {\r\n    constructor() {\r\n        super(...arguments);\r\n        this._name = 'pointerup';\r\n    }\r\n    _onActionEnd(actor) {\r\n        const pointer = this.pointer;\r\n        if (pointer.isDragEnd && actor.capturePointer.captureDragEvents) {\r\n            actor.eventDispatcher.emit('pointerdragend', this);\r\n        }\r\n    }\r\n}\r\nclass PointerDownEvent extends PointerEvent {\r\n    constructor() {\r\n        super(...arguments);\r\n        this._name = 'pointerdown';\r\n    }\r\n    _onActionEnd(actor) {\r\n        if (this.pointer.isDragStart && actor.capturePointer.captureDragEvents) {\r\n            actor.eventDispatcher.emit('pointerdragstart', this);\r\n        }\r\n    }\r\n}\r\nclass PointerMoveEvent extends PointerEvent {\r\n    constructor() {\r\n        super(...arguments);\r\n        this._name = 'pointermove';\r\n        // private _onActorEnter(actor: Actor) {\r\n        //   const pe = createPointerEventByName('enter', this.coordinates, this.pointer, this.index, this.pointerType, this.button, this.ev);\r\n        //   pe.propagate(actor);\r\n        //   this.pointer.addActorUnderPointer(actor);\r\n        //   if (this.pointer.isDragging) {\r\n        //     this.pointer.dragTarget = actor;\r\n        //   }\r\n        // }\r\n        // private _onActorLeave(actor: Actor) {\r\n        //   const pe = createPointerEventByName('leave', this.coordinates, this.pointer, this.index, this.pointerType, this.button, this.ev);\r\n        //   pe.propagate(actor);\r\n        //   this.pointer.removeActorUnderPointer(actor);\r\n        // }\r\n    }\r\n    propagate(actor) {\r\n        // If the actor was under the pointer last frame, but not this one it left\r\n        // if (this.pointer.wasActorUnderPointer(actor) && !this.pointer.isActorUnderPointer(actor)) {\r\n        //   this._onActorLeave(actor);\r\n        //   return;\r\n        // }\r\n        if (this.pointer.isActorAliveUnderPointer(actor)) {\r\n            this.doAction(actor);\r\n            if (this.bubbles && !this.isCanceled() && actor.parent) {\r\n                this.propagate(actor.parent); // TODO not true\r\n            }\r\n        }\r\n    }\r\n    _onActionStart(actor) {\r\n        if (!actor.capturePointer.captureMoveEvents) {\r\n            return;\r\n        }\r\n        // In the case this is new\r\n        // if (this.pointer.checkActorUnderPointer(actor) && !this.pointer.wasActorUnderPointer(actor)) {\r\n        //   this._onActorEnter(actor);\r\n        // }\r\n        if (this.pointer.isDragging && actor.capturePointer.captureDragEvents) {\r\n            actor.eventDispatcher.emit('pointerdragmove', this);\r\n        }\r\n    }\r\n}\r\nclass PointerEnterEvent extends PointerEvent {\r\n    constructor() {\r\n        super(...arguments);\r\n        this._name = 'pointerenter';\r\n    }\r\n    _onActionStart(actor) {\r\n        if (!actor.capturePointer.captureMoveEvents) {\r\n            return;\r\n        }\r\n    }\r\n    _onActionEnd(actor) {\r\n        const pointer = this.pointer;\r\n        if (pointer.isDragging && actor.capturePointer.captureDragEvents) {\r\n            actor.eventDispatcher.emit('pointerdragenter', this);\r\n        }\r\n    }\r\n}\r\nclass PointerLeaveEvent extends PointerEvent {\r\n    constructor() {\r\n        super(...arguments);\r\n        this._name = 'pointerleave';\r\n    }\r\n    _onActionStart(actor) {\r\n        if (!actor.capturePointer.captureMoveEvents) {\r\n            return;\r\n        }\r\n    }\r\n    _onActionEnd(actor) {\r\n        const pointer = this.pointer;\r\n        if (pointer.isDragging && actor.capturePointer.captureDragEvents) {\r\n            actor.eventDispatcher.emit('pointerdragleave', this);\r\n        }\r\n    }\r\n}\r\nclass PointerCancelEvent extends PointerEvent {\r\n    constructor() {\r\n        super(...arguments);\r\n        this._name = 'pointercancel';\r\n    }\r\n}\r\n/**\r\n * Wheel Events\r\n *\r\n * Represents a mouse wheel event. See [[Pointers]] for more information on\r\n * handling point input.\r\n */\r\nclass WheelEvent extends GameEvent {\r\n    /**\r\n     * @param x            The `x` coordinate of the event (in world coordinates)\r\n     * @param y            The `y` coordinate of the event (in world coordinates)\r\n     * @param pageX        The `x` coordinate of the event (in document coordinates)\r\n     * @param pageY        The `y` coordinate of the event (in document coordinates)\r\n     * @param screenX      The `x` coordinate of the event (in screen coordinates)\r\n     * @param screenY      The `y` coordinate of the event (in screen coordinates)\r\n     * @param index        The index of the pointer (zero-based)\r\n     * @param deltaX       The type of pointer\r\n     * @param deltaY       The type of pointer\r\n     * @param deltaZ       The type of pointer\r\n     * @param deltaMode    The type of movement [[WheelDeltaMode]]\r\n     * @param ev           The raw DOM event being handled\r\n     */\r\n    constructor(x, y, pageX, pageY, screenX, screenY, index, deltaX, deltaY, deltaZ, deltaMode, ev) {\r\n        super();\r\n        this.x = x;\r\n        this.y = y;\r\n        this.pageX = pageX;\r\n        this.pageY = pageY;\r\n        this.screenX = screenX;\r\n        this.screenY = screenY;\r\n        this.index = index;\r\n        this.deltaX = deltaX;\r\n        this.deltaY = deltaY;\r\n        this.deltaZ = deltaZ;\r\n        this.deltaMode = deltaMode;\r\n        this.ev = ev;\r\n        this._isCanceled = false;\r\n    }\r\n    /**\r\n     * Cancels pointer event propogation, event will not be transmitted to any other actors\r\n     */\r\n    cancel() {\r\n        this._isCanceled = true;\r\n    }\r\n    /**\r\n     *\r\n     * @returns If the event is canceled it will no longer be transmitted to any other actors\r\n     */\r\n    isCanceled() {\r\n        return this._isCanceled;\r\n    }\r\n}\r\n/**\r\n *\r\n */\r\nfunction createPointerEventByName(eventName, coordinates, pointer, index, pointerType, button, ev) {\r\n    let factory;\r\n    switch (eventName) {\r\n        case 'up':\r\n            factory = new PointerEventFactory(PointerUpEvent);\r\n            break;\r\n        case 'down':\r\n            factory = new PointerEventFactory(PointerDownEvent);\r\n            break;\r\n        case 'move':\r\n            factory = new PointerEventFactory(PointerMoveEvent);\r\n            break;\r\n        case 'cancel':\r\n            factory = new PointerEventFactory(PointerCancelEvent);\r\n            break;\r\n        case 'enter':\r\n            factory = new PointerEventFactory(PointerEnterEvent);\r\n            break;\r\n        case 'leave':\r\n            factory = new PointerEventFactory(PointerLeaveEvent);\r\n            break;\r\n    }\r\n    return factory.create(coordinates, pointer, index, pointerType, button, ev);\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/global-coordinates.ts\n\r\nclass GlobalCoordinates {\r\n    constructor(worldPos, pagePos, screenPos) {\r\n        this.worldPos = worldPos;\r\n        this.pagePos = pagePos;\r\n        this.screenPos = screenPos;\r\n    }\r\n    static fromPagePosition(xOrPos, yOrEngine, engineOrUndefined) {\r\n        let pageX;\r\n        let pageY;\r\n        let pagePos;\r\n        let engine;\r\n        if (arguments.length === 3) {\r\n            pageX = xOrPos;\r\n            pageY = yOrEngine;\r\n            pagePos = new Vector(pageX, pageY);\r\n            engine = engineOrUndefined;\r\n        }\r\n        else {\r\n            pagePos = xOrPos;\r\n            pageX = pagePos.x;\r\n            pageY = pagePos.y;\r\n            engine = yOrEngine;\r\n        }\r\n        const screenPos = engine.screen.pageToScreenCoordinates(pagePos);\r\n        const worldPos = engine.screen.screenToWorldCoordinates(screenPos);\r\n        return new GlobalCoordinates(worldPos, pagePos, screenPos);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Input/Pointers.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * A constant used to normalize wheel events across different browsers\r\n *\r\n * This normalization factor is pulled from https://developer.mozilla.org/en-US/docs/Web/Events/wheel#Listening_to_this_event_across_browser\r\n */\r\nconst ScrollWheelNormalizationFactor = -1 / 40;\r\n/**\r\n * Handles pointer events (mouse, touch, stylus, etc.) and normalizes to\r\n * [W3C Pointer Events](http://www.w3.org/TR/pointerevents/).\r\n */\r\nclass Pointers extends Class {\r\n    constructor(engine) {\r\n        super();\r\n        this._pointerDown = [];\r\n        this._pointerUp = [];\r\n        this._pointerMove = [];\r\n        this._pointerCancel = [];\r\n        this._wheel = [];\r\n        this._pointers = [];\r\n        this._activePointers = [];\r\n        this._engine = engine;\r\n        this._pointers.push(new Pointer());\r\n        this._activePointers = [-1];\r\n        this.primary = this._pointers[0];\r\n    }\r\n    on(eventName, handler) {\r\n        super.on(eventName, handler);\r\n    }\r\n    /**\r\n     * Initializes pointer event listeners\r\n     */\r\n    init(target) {\r\n        target = target || this._engine.canvas;\r\n        // Touch Events\r\n        target.addEventListener('touchstart', this._handleTouchEvent('down', this._pointerDown));\r\n        target.addEventListener('touchend', this._handleTouchEvent('up', this._pointerUp));\r\n        target.addEventListener('touchmove', this._handleTouchEvent('move', this._pointerMove));\r\n        target.addEventListener('touchcancel', this._handleTouchEvent('cancel', this._pointerCancel));\r\n        // W3C Pointer Events\r\n        // Current: IE11, IE10\r\n        if (window.PointerEvent) {\r\n            // IE11\r\n            this._engine.canvas.style.touchAction = 'none';\r\n            target.addEventListener('pointerdown', this._handlePointerEvent('down', this._pointerDown));\r\n            target.addEventListener('pointerup', this._handlePointerEvent('up', this._pointerUp));\r\n            target.addEventListener('pointermove', this._handlePointerEvent('move', this._pointerMove));\r\n            target.addEventListener('pointercancel', this._handlePointerEvent('cancel', this._pointerCancel));\r\n        }\r\n        else if (window.MSPointerEvent) {\r\n            // IE10\r\n            this._engine.canvas.style.msTouchAction = 'none';\r\n            target.addEventListener('MSPointerDown', this._handlePointerEvent('down', this._pointerDown));\r\n            target.addEventListener('MSPointerUp', this._handlePointerEvent('up', this._pointerUp));\r\n            target.addEventListener('MSPointerMove', this._handlePointerEvent('move', this._pointerMove));\r\n            target.addEventListener('MSPointerCancel', this._handlePointerEvent('cancel', this._pointerCancel));\r\n        }\r\n        else {\r\n            // Mouse Events\r\n            target.addEventListener('mousedown', this._handleMouseEvent('down', this._pointerDown));\r\n            target.addEventListener('mouseup', this._handleMouseEvent('up', this._pointerUp));\r\n            target.addEventListener('mousemove', this._handleMouseEvent('move', this._pointerMove));\r\n        }\r\n        // MDN MouseWheelEvent\r\n        const wheelOptions = {\r\n            passive: !(this._engine.pageScrollPreventionMode === ScrollPreventionMode.All ||\r\n                this._engine.pageScrollPreventionMode === ScrollPreventionMode.Canvas)\r\n        };\r\n        if ('onwheel' in document.createElement('div')) {\r\n            // Modern Browsers\r\n            target.addEventListener('wheel', this._handleWheelEvent('wheel', this._wheel), wheelOptions);\r\n        }\r\n        else if (document.onmousewheel !== undefined) {\r\n            // Webkit and IE\r\n            target.addEventListener('mousewheel', this._handleWheelEvent('wheel', this._wheel), wheelOptions);\r\n        }\r\n        else {\r\n            // Remaining browser and older Firefox\r\n            target.addEventListener('MozMousePixelScroll', this._handleWheelEvent('wheel', this._wheel), wheelOptions);\r\n        }\r\n    }\r\n    /**\r\n     * Synthesize a pointer event that looks like a real browser event to excalibur\r\n     * @param eventName\r\n     * @param pos\r\n     */\r\n    triggerEvent(eventName, pos, button = NativePointerButton.Left, pointerType = 'mouse', pointerId = 0) {\r\n        let x = 0;\r\n        let y = 0;\r\n        let coords;\r\n        if (pos instanceof GlobalCoordinates) {\r\n            x = pos.pagePos.x;\r\n            y = pos.pagePos.y;\r\n            coords = pos;\r\n        }\r\n        else {\r\n            x = pos.x;\r\n            y = pos.y;\r\n            coords = new GlobalCoordinates(pos.clone(), pos.clone(), pos.clone());\r\n        }\r\n        const eventish = {\r\n            pageX: x,\r\n            pageY: y,\r\n            pointerId: pointerId,\r\n            pointerType: pointerType,\r\n            button: button,\r\n            preventDefault: () => {\r\n                /* do nothing */\r\n            }\r\n        };\r\n        switch (eventName) {\r\n            case 'move':\r\n                this._handlePointerEvent(eventName, this._pointerMove, coords)(eventish);\r\n                break;\r\n            case 'down':\r\n                this._handlePointerEvent(eventName, this._pointerDown, coords)(eventish);\r\n                break;\r\n            case 'up':\r\n                this._handlePointerEvent(eventName, this._pointerUp, coords)(eventish);\r\n                break;\r\n            case 'cancel':\r\n                this._handlePointerEvent(eventName, this._pointerCancel, coords)(eventish);\r\n                break;\r\n        }\r\n        for (const actor of this._engine.currentScene.actors) {\r\n            const capturePointer = actor.traits.filter((t) => t instanceof CapturePointer)[0];\r\n            if (capturePointer) {\r\n                capturePointer.update(actor, this._engine, 1);\r\n            }\r\n        }\r\n        this.dispatchPointerEvents();\r\n        this.update();\r\n    }\r\n    /**\r\n     * Update all pointer events and pointers, meant to be called at the end of frame\r\n     */\r\n    update() {\r\n        this._pointerUp.length = 0;\r\n        this._pointerDown.length = 0;\r\n        this._pointerMove.length = 0;\r\n        this._pointerCancel.length = 0;\r\n        this._wheel.length = 0;\r\n        for (let i = 0; i < this._pointers.length; i++) {\r\n            this._pointers[i].update();\r\n        }\r\n    }\r\n    /**\r\n     * Safely gets a Pointer at a specific index and initializes one if it doesn't yet exist\r\n     * @param index  The pointer index to retrieve\r\n     */\r\n    at(index) {\r\n        if (index >= this._pointers.length) {\r\n            // Ensure there is a pointer to retrieve\r\n            for (let i = this._pointers.length - 1, max = index; i < max; i++) {\r\n                this._pointers.push(new Pointer());\r\n                this._activePointers.push(-1);\r\n            }\r\n        }\r\n        return this._pointers[index];\r\n    }\r\n    /**\r\n     * Get number of pointers being watched\r\n     */\r\n    count() {\r\n        return this._pointers.length;\r\n    }\r\n    checkAndUpdateActorUnderPointer(actor) {\r\n        for (const pointer of this._pointers) {\r\n            if (pointer.checkActorUnderPointer(actor)) {\r\n                pointer.addActorUnderPointer(actor);\r\n            }\r\n            else {\r\n                pointer.removeActorUnderPointer(actor);\r\n            }\r\n        }\r\n    }\r\n    _dispatchWithBubble(events) {\r\n        for (const evt of events) {\r\n            for (const actor of evt.pointer.getActorsForEvents()) {\r\n                if (!evt.isCanceled()) {\r\n                    evt.propagate(actor);\r\n                }\r\n                if (!evt.bubbles || evt.isCanceled()) {\r\n                    // if the event stops bubbling part way stop processing\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    _dispatchPointerLeaveEvents() {\r\n        const lastMoveEventPerPointerPerActor = {};\r\n        const pointerLeave = [];\r\n        for (const evt of this._pointerMove) {\r\n            for (const actor of evt.pointer.getActorsForEvents()) {\r\n                // If the actor was under the pointer last frame, but not this this frame, pointer left\r\n                if (!lastMoveEventPerPointerPerActor[evt.pointer.id + '+' + actor.id] &&\r\n                    evt.pointer.wasActorUnderPointer(actor) &&\r\n                    !evt.pointer.isActorAliveUnderPointer(actor) &&\r\n                    !evt.isCanceled()) {\r\n                    lastMoveEventPerPointerPerActor[evt.pointer.id + '+' + actor.id] = evt;\r\n                    const pe = createPointerEventByName('leave', new GlobalCoordinates(evt.worldPos, evt.pagePos, evt.screenPos), evt.pointer, evt.index, evt.pointerType, evt.button, evt.ev);\r\n                    pe.propagate(actor);\r\n                    pointerLeave.push(pe);\r\n                }\r\n            }\r\n        }\r\n        return pointerLeave;\r\n    }\r\n    _dispatchPointerEnterEvents() {\r\n        const lastMoveEventPerPointer = {};\r\n        const pointerEnter = [];\r\n        for (const evt of this._pointerMove) {\r\n            for (const actor of evt.pointer.getActorsForEvents()) {\r\n                // If the actor was not under the pointer last frame, but it is this frame, pointer entered\r\n                if (!lastMoveEventPerPointer[evt.pointer.id] &&\r\n                    !evt.pointer.wasActorUnderPointer(actor) &&\r\n                    evt.pointer.isActorAliveUnderPointer(actor) &&\r\n                    !evt.isCanceled()) {\r\n                    lastMoveEventPerPointer[evt.pointer.id] = evt;\r\n                    const pe = createPointerEventByName('enter', new GlobalCoordinates(evt.worldPos, evt.pagePos, evt.screenPos), evt.pointer, evt.index, evt.pointerType, evt.button, evt.ev);\r\n                    pe.propagate(actor);\r\n                    pointerEnter.push(pe);\r\n                    // if pointer is dragging set the drag target\r\n                    if (evt.pointer.isDragging) {\r\n                        evt.pointer.dragTarget = actor;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return pointerEnter;\r\n    }\r\n    dispatchPointerEvents() {\r\n        this._dispatchWithBubble(this._pointerDown);\r\n        this._dispatchWithBubble(this._pointerUp);\r\n        this._dispatchWithBubble(this._pointerMove);\r\n        this._dispatchPointerLeaveEvents();\r\n        this._dispatchPointerEnterEvents();\r\n        this._dispatchWithBubble(this._pointerCancel);\r\n        // TODO some duplication here\r\n        for (const evt of this._wheel) {\r\n            for (const actor of this._pointers[evt.index].getActorsUnderPointer()) {\r\n                this._propagateWheelPointerEvent(actor, evt);\r\n                if (!evt.bubbles || evt.isCanceled()) {\r\n                    // if the event stops bubbling part way stop processing\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    _propagateWheelPointerEvent(actor, wheelEvent) {\r\n        actor.emit('pointerwheel', wheelEvent);\r\n        // Recurse and propagate\r\n        if (wheelEvent.bubbles && !wheelEvent.isCanceled() && actor.parent) {\r\n            this._propagateWheelPointerEvent(actor.parent, wheelEvent); // TODO not true\r\n        }\r\n    }\r\n    _handleMouseEvent(eventName, eventArr) {\r\n        return (e) => {\r\n            e.preventDefault();\r\n            const pointer = this.at(0);\r\n            const coordinates = GlobalCoordinates.fromPagePosition(e.pageX, e.pageY, this._engine);\r\n            const pe = createPointerEventByName(eventName, coordinates, pointer, 0, PointerType.Mouse, this._nativeButtonToPointerButton(e.button), e);\r\n            eventArr.push(pe);\r\n            pointer.eventDispatcher.emit(eventName, pe);\r\n        };\r\n    }\r\n    _handleTouchEvent(eventName, eventArr) {\r\n        return (e) => {\r\n            e.preventDefault();\r\n            for (let i = 0, len = e.changedTouches.length; i < len; i++) {\r\n                const index = this._pointers.length > 1 ? this._getPointerIndex(e.changedTouches[i].identifier) : 0;\r\n                if (index === -1) {\r\n                    continue;\r\n                }\r\n                const pointer = this.at(index);\r\n                const coordinates = GlobalCoordinates.fromPagePosition(e.changedTouches[i].pageX, e.changedTouches[i].pageY, this._engine);\r\n                const pe = createPointerEventByName(eventName, coordinates, pointer, index, PointerType.Touch, PointerButton.Unknown, e);\r\n                eventArr.push(pe);\r\n                pointer.eventDispatcher.emit(eventName, pe);\r\n                this.emit(eventName, pe);\r\n                // only with multi-pointer\r\n                if (this._pointers.length > 1) {\r\n                    if (eventName === 'up') {\r\n                        // remove pointer ID from pool when pointer is lifted\r\n                        this._activePointers[index] = -1;\r\n                    }\r\n                    else if (eventName === 'down') {\r\n                        // set pointer ID to given index\r\n                        this._activePointers[index] = e.changedTouches[i].identifier;\r\n                    }\r\n                }\r\n            }\r\n        };\r\n    }\r\n    _handlePointerEvent(eventName, eventArr, coords) {\r\n        return (e) => {\r\n            e.preventDefault();\r\n            // get the index for this pointer ID if multi-pointer is asked for\r\n            const index = this._pointers.length > 1 ? this._getPointerIndex(e.pointerId) : 0;\r\n            if (index === -1) {\r\n                return;\r\n            }\r\n            const pointer = this.at(index);\r\n            const coordinates = coords || GlobalCoordinates.fromPagePosition(e.pageX, e.pageY, this._engine);\r\n            const pe = createPointerEventByName(eventName, coordinates, pointer, index, this._stringToPointerType(e.pointerType), this._nativeButtonToPointerButton(e.button), e);\r\n            eventArr.push(pe);\r\n            pointer.eventDispatcher.emit(eventName, pe);\r\n            this.emit(eventName, pe);\r\n            // only with multi-pointer\r\n            if (this._pointers.length > 1) {\r\n                if (eventName === 'up') {\r\n                    // remove pointer ID from pool when pointer is lifted\r\n                    this._activePointers[index] = -1;\r\n                }\r\n                else if (eventName === 'down') {\r\n                    // set pointer ID to given index\r\n                    this._activePointers[index] = e.pointerId;\r\n                }\r\n            }\r\n        };\r\n    }\r\n    _handleWheelEvent(eventName, eventArr) {\r\n        return (e) => {\r\n            // Should we prevent page scroll because of this event\r\n            if (this._engine.pageScrollPreventionMode === ScrollPreventionMode.All ||\r\n                (this._engine.pageScrollPreventionMode === ScrollPreventionMode.Canvas && e.target === this._engine.canvas)) {\r\n                e.preventDefault();\r\n            }\r\n            const screen = this._engine.screen.pageToScreenCoordinates(vec(e.pageX, e.pageY));\r\n            const world = this._engine.screen.screenToWorldCoordinates(screen);\r\n            // deltaX, deltaY, and deltaZ are the standard modern properties\r\n            // wheelDeltaX, wheelDeltaY, are legacy properties in webkit browsers and older IE\r\n            // e.detail is only used in opera\r\n            const deltaX = e.deltaX || e.wheelDeltaX * ScrollWheelNormalizationFactor || 0;\r\n            const deltaY = e.deltaY || e.wheelDeltaY * ScrollWheelNormalizationFactor || e.wheelDelta * ScrollWheelNormalizationFactor || e.detail || 0;\r\n            const deltaZ = e.deltaZ || 0;\r\n            let deltaMode = WheelDeltaMode.Pixel;\r\n            if (e.deltaMode) {\r\n                if (e.deltaMode === 1) {\r\n                    deltaMode = WheelDeltaMode.Line;\r\n                }\r\n                else if (e.deltaMode === 2) {\r\n                    deltaMode = WheelDeltaMode.Page;\r\n                }\r\n            }\r\n            const we = new WheelEvent(world.x, world.y, e.pageX, e.pageY, screen.x, screen.y, 0, deltaX, deltaY, deltaZ, deltaMode, e);\r\n            eventArr.push(we);\r\n            this.at(0).eventDispatcher.emit(eventName, we);\r\n            this.emit(eventName, we);\r\n        };\r\n    }\r\n    /**\r\n     * Gets the index of the pointer specified for the given pointer ID or finds the next empty pointer slot available.\r\n     * This is required because IE10/11 uses incrementing pointer IDs so we need to store a mapping of ID => idx\r\n     */\r\n    _getPointerIndex(pointerId) {\r\n        let idx;\r\n        if ((idx = this._activePointers.indexOf(pointerId)) > -1) {\r\n            return idx;\r\n        }\r\n        for (let i = 0; i < this._activePointers.length; i++) {\r\n            if (this._activePointers[i] === -1) {\r\n                return i;\r\n            }\r\n        }\r\n        // ignore pointer because game isn't watching\r\n        return -1;\r\n    }\r\n    _nativeButtonToPointerButton(s) {\r\n        switch (s) {\r\n            case NativePointerButton.NoButton:\r\n                return PointerButton.NoButton;\r\n            case NativePointerButton.Left:\r\n                return PointerButton.Left;\r\n            case NativePointerButton.Middle:\r\n                return PointerButton.Middle;\r\n            case NativePointerButton.Right:\r\n                return PointerButton.Right;\r\n            case NativePointerButton.Unknown:\r\n                return PointerButton.Unknown;\r\n            default:\r\n                return fail(s);\r\n        }\r\n    }\r\n    _stringToPointerType(s) {\r\n        switch (s) {\r\n            case 'touch':\r\n                return PointerType.Touch;\r\n            case 'mouse':\r\n                return PointerType.Mouse;\r\n            case 'pen':\r\n                return PointerType.Pen;\r\n            default:\r\n                return PointerType.Unknown;\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Input/Gamepad.ts\n\r\n\r\n/**\r\n * Excalibur leverages the HTML5 Gamepad API [where it is supported](http://caniuse.com/#feat=gamepad)\r\n * to provide controller support for your games.\r\n */\r\nclass Gamepads extends Class {\r\n    constructor() {\r\n        super();\r\n        /**\r\n         * Whether or not to poll for Gamepad input (default: `false`)\r\n         */\r\n        this.enabled = false;\r\n        /**\r\n         * Whether or not Gamepad API is supported\r\n         */\r\n        this.supported = !!navigator.getGamepads;\r\n        this._gamePadTimeStamps = [0, 0, 0, 0];\r\n        this._oldPads = [];\r\n        this._pads = [];\r\n        this._initSuccess = false;\r\n        this._navigator = navigator;\r\n        this._minimumConfiguration = null;\r\n    }\r\n    init() {\r\n        if (!this.supported) {\r\n            return;\r\n        }\r\n        if (this._initSuccess) {\r\n            return;\r\n        }\r\n        // In Chrome, this will return 4 undefined items until a button is pressed\r\n        // In FF, this will not return any items until a button is pressed\r\n        this._oldPads = this._clonePads(this._navigator.getGamepads());\r\n        if (this._oldPads.length && this._oldPads[0]) {\r\n            this._initSuccess = true;\r\n        }\r\n    }\r\n    /**\r\n     * Sets the minimum gamepad configuration, for example {axis: 4, buttons: 4} means\r\n     * this game requires at minimum 4 axis inputs and 4 buttons, this is not restrictive\r\n     * all other controllers with more axis or buttons are valid as well. If no minimum\r\n     * configuration is set all pads are valid.\r\n     */\r\n    setMinimumGamepadConfiguration(config) {\r\n        this._enableAndUpdate(); // if config is used, implicitly enable\r\n        this._minimumConfiguration = config;\r\n    }\r\n    /**\r\n     * When implicitly enabled, set the enabled flag and run an update so information is updated\r\n     */\r\n    _enableAndUpdate() {\r\n        if (!this.enabled) {\r\n            this.enabled = true;\r\n            this.update();\r\n        }\r\n    }\r\n    /**\r\n     * Checks a navigator gamepad against the minimum configuration if present.\r\n     */\r\n    _isGamepadValid(pad) {\r\n        if (!this._minimumConfiguration) {\r\n            return true;\r\n        }\r\n        if (!pad) {\r\n            return false;\r\n        }\r\n        const axesLength = pad.axes.filter((value) => {\r\n            return typeof value !== undefined;\r\n        }).length;\r\n        const buttonLength = pad.buttons.filter((value) => {\r\n            return typeof value !== undefined;\r\n        }).length;\r\n        return axesLength >= this._minimumConfiguration.axis && buttonLength >= this._minimumConfiguration.buttons && pad.connected;\r\n    }\r\n    on(eventName, handler) {\r\n        this._enableAndUpdate(); // implicitly enable\r\n        super.on(eventName, handler);\r\n    }\r\n    off(eventName, handler) {\r\n        this._enableAndUpdate(); // implicitly enable\r\n        super.off(eventName, handler);\r\n    }\r\n    /**\r\n     * Updates Gamepad state and publishes Gamepad events\r\n     */\r\n    update() {\r\n        if (!this.enabled || !this.supported) {\r\n            return;\r\n        }\r\n        this.init();\r\n        const gamepads = this._navigator.getGamepads();\r\n        for (let i = 0; i < gamepads.length; i++) {\r\n            if (!gamepads[i]) {\r\n                const gamepad = this.at(i);\r\n                // If was connected, but now isn't emit the disconnect event\r\n                if (gamepad.connected) {\r\n                    this.eventDispatcher.emit('disconnect', new GamepadDisconnectEvent(i, gamepad));\r\n                }\r\n                // Reset connection status\r\n                gamepad.connected = false;\r\n                continue;\r\n            }\r\n            else {\r\n                if (!this.at(i).connected && this._isGamepadValid(gamepads[i])) {\r\n                    this.eventDispatcher.emit('connect', new GamepadConnectEvent(i, this.at(i)));\r\n                }\r\n                // Set connection status\r\n                this.at(i).connected = true;\r\n            }\r\n            // Only supported in Chrome\r\n            if (gamepads[i].timestamp && gamepads[i].timestamp === this._gamePadTimeStamps[i]) {\r\n                continue;\r\n            }\r\n            this._gamePadTimeStamps[i] = gamepads[i].timestamp;\r\n            // Add reference to navigator gamepad\r\n            this.at(i).navigatorGamepad = gamepads[i];\r\n            // Buttons\r\n            let b, bi, a, ai, value;\r\n            for (b in Buttons) {\r\n                bi = Buttons[b];\r\n                if (typeof bi === 'number') {\r\n                    if (gamepads[i].buttons[bi]) {\r\n                        value = gamepads[i].buttons[bi].value;\r\n                        if (value !== this._oldPads[i].getButton(bi)) {\r\n                            if (gamepads[i].buttons[bi].pressed) {\r\n                                this.at(i).updateButton(bi, value);\r\n                                this.at(i).eventDispatcher.emit('button', new GamepadButtonEvent(bi, value, this.at(i)));\r\n                            }\r\n                            else {\r\n                                this.at(i).updateButton(bi, 0);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            // Axes\r\n            for (a in Axes) {\r\n                ai = Axes[a];\r\n                if (typeof ai === 'number') {\r\n                    value = gamepads[i].axes[ai];\r\n                    if (value !== this._oldPads[i].getAxes(ai)) {\r\n                        this.at(i).updateAxes(ai, value);\r\n                        this.at(i).eventDispatcher.emit('axis', new GamepadAxisEvent(ai, value, this.at(i)));\r\n                    }\r\n                }\r\n            }\r\n            this._oldPads[i] = this._clonePad(gamepads[i]);\r\n        }\r\n    }\r\n    /**\r\n     * Safely retrieves a Gamepad at a specific index and creates one if it doesn't yet exist\r\n     */\r\n    at(index) {\r\n        this._enableAndUpdate(); // implicitly enable gamepads when at() is called\r\n        if (index >= this._pads.length) {\r\n            // Ensure there is a pad to retrieve\r\n            for (let i = this._pads.length - 1, max = index; i < max; i++) {\r\n                this._pads.push(new Gamepad());\r\n                this._oldPads.push(new Gamepad());\r\n            }\r\n        }\r\n        return this._pads[index];\r\n    }\r\n    /**\r\n     * Returns a list of all valid gamepads that meet the minimum configuration requirement.\r\n     */\r\n    getValidGamepads() {\r\n        this._enableAndUpdate();\r\n        const result = [];\r\n        for (let i = 0; i < this._pads.length; i++) {\r\n            if (this._isGamepadValid(this.at(i).navigatorGamepad) && this.at(i).connected) {\r\n                result.push(this.at(i));\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Gets the number of connected gamepads\r\n     */\r\n    count() {\r\n        return this._pads.filter((p) => p.connected).length;\r\n    }\r\n    _clonePads(pads) {\r\n        const arr = [];\r\n        for (let i = 0, len = pads.length; i < len; i++) {\r\n            arr.push(this._clonePad(pads[i]));\r\n        }\r\n        return arr;\r\n    }\r\n    /**\r\n     * Fastest way to clone a known object is to do it yourself\r\n     */\r\n    _clonePad(pad) {\r\n        let i, len;\r\n        const clonedPad = new Gamepad();\r\n        if (!pad) {\r\n            return clonedPad;\r\n        }\r\n        for (i = 0, len = pad.buttons.length; i < len; i++) {\r\n            if (pad.buttons[i]) {\r\n                clonedPad.updateButton(i, pad.buttons[i].value);\r\n            }\r\n        }\r\n        for (i = 0, len = pad.axes.length; i < len; i++) {\r\n            clonedPad.updateAxes(i, pad.axes[i]);\r\n        }\r\n        return clonedPad;\r\n    }\r\n}\r\n/**\r\n * The minimum value an axis has to move before considering it a change\r\n */\r\nGamepads.MinAxisMoveThreshold = 0.05;\r\n/**\r\n * Gamepad holds state information for a connected controller. See [[Gamepads]]\r\n * for more information on handling controller input.\r\n */\r\nclass Gamepad extends Class {\r\n    constructor() {\r\n        super();\r\n        this.connected = false;\r\n        this._buttons = new Array(16);\r\n        this._axes = new Array(4);\r\n        for (let i = 0; i < this._buttons.length; i++) {\r\n            this._buttons[i] = 0;\r\n        }\r\n        for (let i = 0; i < this._axes.length; i++) {\r\n            this._axes[i] = 0;\r\n        }\r\n    }\r\n    /**\r\n     * Whether or not the given button is pressed\r\n     * @param button     The button to query\r\n     * @param threshold  The threshold over which the button is considered to be pressed\r\n     */\r\n    isButtonPressed(button, threshold = 1) {\r\n        return this._buttons[button] >= threshold;\r\n    }\r\n    /**\r\n     * Gets the given button value between 0 and 1\r\n     */\r\n    getButton(button) {\r\n        return this._buttons[button];\r\n    }\r\n    /**\r\n     * Gets the given axis value between -1 and 1. Values below\r\n     * [[MinAxisMoveThreshold]] are considered 0.\r\n     */\r\n    getAxes(axes) {\r\n        const value = this._axes[axes];\r\n        if (Math.abs(value) < Gamepads.MinAxisMoveThreshold) {\r\n            return 0;\r\n        }\r\n        else {\r\n            return value;\r\n        }\r\n    }\r\n    updateButton(buttonIndex, value) {\r\n        this._buttons[buttonIndex] = value;\r\n    }\r\n    updateAxes(axesIndex, value) {\r\n        this._axes[axesIndex] = value;\r\n    }\r\n}\r\n/**\r\n * Gamepad Buttons enumeration\r\n */\r\nvar Buttons;\r\n(function (Buttons) {\r\n    /**\r\n     * Face 1 button (e.g. A)\r\n     */\r\n    Buttons[Buttons[\"Face1\"] = 0] = \"Face1\";\r\n    /**\r\n     * Face 2 button (e.g. B)\r\n     */\r\n    Buttons[Buttons[\"Face2\"] = 1] = \"Face2\";\r\n    /**\r\n     * Face 3 button (e.g. X)\r\n     */\r\n    Buttons[Buttons[\"Face3\"] = 2] = \"Face3\";\r\n    /**\r\n     * Face 4 button (e.g. Y)\r\n     */\r\n    Buttons[Buttons[\"Face4\"] = 3] = \"Face4\";\r\n    /**\r\n     * Left bumper button\r\n     */\r\n    Buttons[Buttons[\"LeftBumper\"] = 4] = \"LeftBumper\";\r\n    /**\r\n     * Right bumper button\r\n     */\r\n    Buttons[Buttons[\"RightBumper\"] = 5] = \"RightBumper\";\r\n    /**\r\n     * Left trigger button\r\n     */\r\n    Buttons[Buttons[\"LeftTrigger\"] = 6] = \"LeftTrigger\";\r\n    /**\r\n     * Right trigger button\r\n     */\r\n    Buttons[Buttons[\"RightTrigger\"] = 7] = \"RightTrigger\";\r\n    /**\r\n     * Select button\r\n     */\r\n    Buttons[Buttons[\"Select\"] = 8] = \"Select\";\r\n    /**\r\n     * Start button\r\n     */\r\n    Buttons[Buttons[\"Start\"] = 9] = \"Start\";\r\n    /**\r\n     * Left analog stick press (e.g. L3)\r\n     */\r\n    Buttons[Buttons[\"LeftStick\"] = 10] = \"LeftStick\";\r\n    /**\r\n     * Right analog stick press (e.g. R3)\r\n     */\r\n    Buttons[Buttons[\"RightStick\"] = 11] = \"RightStick\";\r\n    /**\r\n     * D-pad up\r\n     */\r\n    Buttons[Buttons[\"DpadUp\"] = 12] = \"DpadUp\";\r\n    /**\r\n     * D-pad down\r\n     */\r\n    Buttons[Buttons[\"DpadDown\"] = 13] = \"DpadDown\";\r\n    /**\r\n     * D-pad left\r\n     */\r\n    Buttons[Buttons[\"DpadLeft\"] = 14] = \"DpadLeft\";\r\n    /**\r\n     * D-pad right\r\n     */\r\n    Buttons[Buttons[\"DpadRight\"] = 15] = \"DpadRight\";\r\n})(Buttons || (Buttons = {}));\r\n/**\r\n * Gamepad Axes enumeration\r\n */\r\nvar Axes;\r\n(function (Axes) {\r\n    /**\r\n     * Left analogue stick X direction\r\n     */\r\n    Axes[Axes[\"LeftStickX\"] = 0] = \"LeftStickX\";\r\n    /**\r\n     * Left analogue stick Y direction\r\n     */\r\n    Axes[Axes[\"LeftStickY\"] = 1] = \"LeftStickY\";\r\n    /**\r\n     * Right analogue stick X direction\r\n     */\r\n    Axes[Axes[\"RightStickX\"] = 2] = \"RightStickX\";\r\n    /**\r\n     * Right analogue stick Y direction\r\n     */\r\n    Axes[Axes[\"RightStickY\"] = 3] = \"RightStickY\";\r\n})(Axes || (Axes = {}));\r\n\n;// CONCATENATED MODULE: ./Util/Browser.ts\nclass BrowserComponent {\r\n    constructor(nativeComponent) {\r\n        this.nativeComponent = nativeComponent;\r\n        this._paused = false;\r\n        this._nativeHandlers = {};\r\n    }\r\n    on(eventName, handler) {\r\n        if (this._nativeHandlers[eventName]) {\r\n            this.off(eventName, this._nativeHandlers[eventName]);\r\n        }\r\n        this._nativeHandlers[eventName] = this._decorate(handler);\r\n        this.nativeComponent.addEventListener(eventName, this._nativeHandlers[eventName]);\r\n    }\r\n    off(eventName, handler) {\r\n        if (!handler) {\r\n            handler = this._nativeHandlers[eventName];\r\n        }\r\n        this.nativeComponent.removeEventListener(eventName, handler);\r\n        this._nativeHandlers[eventName] = null;\r\n    }\r\n    _decorate(handler) {\r\n        return (evt) => {\r\n            if (!this._paused) {\r\n                handler(evt);\r\n            }\r\n        };\r\n    }\r\n    pause() {\r\n        this._paused = true;\r\n    }\r\n    resume() {\r\n        this._paused = false;\r\n    }\r\n    clear() {\r\n        for (const event in this._nativeHandlers) {\r\n            this.off(event);\r\n        }\r\n    }\r\n}\r\nclass BrowserEvents {\r\n    constructor(_windowGlobal, _documentGlobal) {\r\n        this._windowGlobal = _windowGlobal;\r\n        this._documentGlobal = _documentGlobal;\r\n        this._windowComponent = new BrowserComponent(this._windowGlobal);\r\n        this._documentComponent = new BrowserComponent(this._documentGlobal);\r\n    }\r\n    get window() {\r\n        return this._windowComponent;\r\n    }\r\n    get document() {\r\n        return this._documentComponent;\r\n    }\r\n    pause() {\r\n        this.window.pause();\r\n        this.document.pause();\r\n    }\r\n    resume() {\r\n        this.window.resume();\r\n        this.document.resume();\r\n    }\r\n    clear() {\r\n        this.window.clear();\r\n        this.document.clear();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/ExcaliburGraphicsContext2DCanvas.ts\n\r\n\r\n\r\n\r\nclass ExcaliburGraphicsContext2DCanvasDebug {\r\n    constructor(_ex) {\r\n        this._ex = _ex;\r\n        this._debugText = new DebugText();\r\n    }\r\n    /**\r\n     * Draw a debug rectangle to the context\r\n     * @param x\r\n     * @param y\r\n     * @param width\r\n     * @param height\r\n     */\r\n    drawRect(x, y, width, height) {\r\n        this._ex.__ctx.save();\r\n        this._ex.__ctx.strokeStyle = 'red';\r\n        this._ex.__ctx.strokeRect(this._ex.snapToPixel ? ~~x : x, this._ex.snapToPixel ? ~~y : y, this._ex.snapToPixel ? ~~width : width, this._ex.snapToPixel ? ~~height : height);\r\n        this._ex.__ctx.restore();\r\n    }\r\n    drawLine(start, end, lineOptions = { color: Color.Black }) {\r\n        this._ex.__ctx.save();\r\n        this._ex.__ctx.beginPath();\r\n        this._ex.__ctx.strokeStyle = lineOptions.color.toString();\r\n        this._ex.__ctx.moveTo(this._ex.snapToPixel ? ~~start.x : start.x, this._ex.snapToPixel ? ~~start.y : start.y);\r\n        this._ex.__ctx.lineTo(this._ex.snapToPixel ? ~~end.x : end.x, this._ex.snapToPixel ? ~~end.y : end.y);\r\n        this._ex.__ctx.lineWidth = 2;\r\n        this._ex.__ctx.stroke();\r\n        this._ex.__ctx.closePath();\r\n        this._ex.__ctx.restore();\r\n    }\r\n    drawPoint(point, pointOptions = { color: Color.Black, size: 5 }) {\r\n        this._ex.__ctx.save();\r\n        this._ex.__ctx.beginPath();\r\n        this._ex.__ctx.fillStyle = pointOptions.color.toString();\r\n        this._ex.__ctx.arc(this._ex.snapToPixel ? ~~point.x : point.x, this._ex.snapToPixel ? ~~point.y : point.y, pointOptions.size, 0, Math.PI * 2);\r\n        this._ex.__ctx.fill();\r\n        this._ex.__ctx.closePath();\r\n        this._ex.__ctx.restore();\r\n    }\r\n    drawText(text, pos) {\r\n        this._debugText.write(this._ex, text, pos);\r\n    }\r\n}\r\nclass ExcaliburGraphicsContext2DCanvas {\r\n    constructor(options) {\r\n        this.backgroundColor = Color.ExcaliburBlue;\r\n        this._state = new StateStack();\r\n        this.snapToPixel = true;\r\n        this.debug = new ExcaliburGraphicsContext2DCanvasDebug(this);\r\n        const { canvasElement, enableTransparency, snapToPixel, smoothing, backgroundColor } = options;\r\n        this.__ctx = canvasElement.getContext('2d', {\r\n            alpha: enableTransparency !== null && enableTransparency !== void 0 ? enableTransparency : true\r\n        });\r\n        this.backgroundColor = backgroundColor !== null && backgroundColor !== void 0 ? backgroundColor : this.backgroundColor;\r\n        this.snapToPixel = snapToPixel !== null && snapToPixel !== void 0 ? snapToPixel : this.snapToPixel;\r\n        this.smoothing = smoothing !== null && smoothing !== void 0 ? smoothing : this.smoothing;\r\n    }\r\n    get width() {\r\n        return this.__ctx.canvas.width;\r\n    }\r\n    get height() {\r\n        return this.__ctx.canvas.height;\r\n    }\r\n    get opacity() {\r\n        return this._state.current.opacity;\r\n    }\r\n    set opacity(value) {\r\n        this._state.current.opacity = value;\r\n    }\r\n    get smoothing() {\r\n        return this.__ctx.imageSmoothingEnabled;\r\n    }\r\n    set smoothing(value) {\r\n        this.__ctx.imageSmoothingEnabled = value;\r\n    }\r\n    resetTransform() {\r\n        this.__ctx.resetTransform();\r\n    }\r\n    updateViewport() {\r\n        // pass\r\n    }\r\n    drawImage(image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight) {\r\n        if (swidth === 0 || sheight === 0) {\r\n            return; // zero dimension dest exit early\r\n        }\r\n        else if (dwidth === 0 || dheight === 0) {\r\n            return; // zero dimension dest exit early\r\n        }\r\n        else if (image.width === 0 || image.height === 0) {\r\n            return; // zero dimension source exit early\r\n        }\r\n        this.__ctx.globalAlpha = this.opacity;\r\n        const args = [image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight]\r\n            .filter((a) => a !== undefined)\r\n            .map((a) => (typeof a === 'number' && this.snapToPixel ? ~~a : a));\r\n        this.__ctx.drawImage.apply(this.__ctx, args);\r\n        GraphicsDiagnostics.DrawCallCount++;\r\n        GraphicsDiagnostics.DrawnImagesCount = 1;\r\n    }\r\n    drawLine(start, end, color, thickness = 1) {\r\n        this.__ctx.save();\r\n        this.__ctx.beginPath();\r\n        this.__ctx.strokeStyle = color.toString();\r\n        this.__ctx.moveTo(this.snapToPixel ? ~~start.x : start.x, this.snapToPixel ? ~~start.y : start.y);\r\n        this.__ctx.lineTo(this.snapToPixel ? ~~end.x : end.x, this.snapToPixel ? ~~end.y : end.y);\r\n        this.__ctx.lineWidth = thickness;\r\n        this.__ctx.stroke();\r\n        this.__ctx.closePath();\r\n        this.__ctx.restore();\r\n    }\r\n    drawRectangle(pos, width, height, color) {\r\n        this.__ctx.save();\r\n        this.__ctx.fillStyle = color.toString();\r\n        this.__ctx.fillRect(this.snapToPixel ? ~~pos.x : pos.x, this.snapToPixel ? ~~pos.y : pos.y, this.snapToPixel ? ~~width : width, this.snapToPixel ? ~~height : height);\r\n        this.__ctx.restore();\r\n    }\r\n    drawCircle(pos, radius, color) {\r\n        this.__ctx.save();\r\n        this.__ctx.beginPath();\r\n        this.__ctx.fillStyle = color.toString();\r\n        this.__ctx.arc(this.snapToPixel ? ~~pos.x : pos.x, this.snapToPixel ? ~~pos.y : pos.y, radius, 0, Math.PI * 2);\r\n        this.__ctx.fill();\r\n        this.__ctx.closePath();\r\n        this.__ctx.restore();\r\n    }\r\n    /**\r\n     * Save the current state of the canvas to the stack (transforms and opacity)\r\n     */\r\n    save() {\r\n        this.__ctx.save();\r\n    }\r\n    /**\r\n     * Restore the state of the canvas from the stack\r\n     */\r\n    restore() {\r\n        this.__ctx.restore();\r\n    }\r\n    /**\r\n     * Translate the origin of the context by an x and y\r\n     * @param x\r\n     * @param y\r\n     */\r\n    translate(x, y) {\r\n        this.__ctx.translate(this.snapToPixel ? ~~x : x, this.snapToPixel ? ~~y : y);\r\n    }\r\n    /**\r\n     * Rotate the context about the current origin\r\n     */\r\n    rotate(angle) {\r\n        this.__ctx.rotate(angle);\r\n    }\r\n    /**\r\n     * Scale the context by an x and y factor\r\n     * @param x\r\n     * @param y\r\n     */\r\n    scale(x, y) {\r\n        this.__ctx.scale(x, y);\r\n    }\r\n    clear() {\r\n        // Clear frame\r\n        this.__ctx.clearRect(0, 0, this.width, this.height);\r\n        this.__ctx.fillStyle = this.backgroundColor.toString();\r\n        this.__ctx.fillRect(0, 0, this.width, this.height);\r\n        GraphicsDiagnostics.clear();\r\n    }\r\n    /**\r\n     * Flushes the batched draw calls to the screen\r\n     */\r\n    flush() {\r\n        // pass\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Engine.ts\nvar Engine_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\n\r\n\r\npolyfill();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Enum representing the different mousewheel event bubble prevention\r\n */\r\nvar ScrollPreventionMode;\r\n(function (ScrollPreventionMode) {\r\n    /**\r\n     * Do not prevent any page scrolling\r\n     */\r\n    ScrollPreventionMode[ScrollPreventionMode[\"None\"] = 0] = \"None\";\r\n    /**\r\n     * Prevent page scroll if mouse is over the game canvas\r\n     */\r\n    ScrollPreventionMode[ScrollPreventionMode[\"Canvas\"] = 1] = \"Canvas\";\r\n    /**\r\n     * Prevent all page scrolling via mouse wheel\r\n     */\r\n    ScrollPreventionMode[ScrollPreventionMode[\"All\"] = 2] = \"All\";\r\n})(ScrollPreventionMode || (ScrollPreventionMode = {}));\r\n/**\r\n * The Excalibur Engine\r\n *\r\n * The [[Engine]] is the main driver for a game. It is responsible for\r\n * starting/stopping the game, maintaining state, transmitting events,\r\n * loading resources, and managing the scene.\r\n */\r\nclass Engine extends Class {\r\n    /**\r\n     * Creates a new game using the given [[EngineOptions]]. By default, if no options are provided,\r\n     * the game will be rendered full screen (taking up all available browser window space).\r\n     * You can customize the game rendering through [[EngineOptions]].\r\n     *\r\n     * Example:\r\n     *\r\n     * ```js\r\n     * var game = new ex.Engine({\r\n     *   width: 0, // the width of the canvas\r\n     *   height: 0, // the height of the canvas\r\n     *   enableCanvasTransparency: true, // the transparencySection of the canvas\r\n     *   canvasElementId: '', // the DOM canvas element ID, if you are providing your own\r\n     *   displayMode: ex.DisplayMode.FullScreen, // the display mode\r\n     *   pointerScope: ex.Input.PointerScope.Document, // the scope of capturing pointer (mouse/touch) events\r\n     *   backgroundColor: ex.Color.fromHex('#2185d0') // background color of the engine\r\n     * });\r\n     *\r\n     * // call game.start, which is a Promise\r\n     * game.start().then(function () {\r\n     *   // ready, set, go!\r\n     * });\r\n     * ```\r\n     */\r\n    constructor(options) {\r\n        var _a, _b, _c;\r\n        super();\r\n        this._hasStarted = false;\r\n        /**\r\n         * Gets or sets the list of post processors to apply at the end of drawing a frame (such as [[ColorBlindCorrector]])\r\n         */\r\n        this.postProcessors = [];\r\n        /**\r\n         * Contains all the scenes currently registered with Excalibur\r\n         */\r\n        this.scenes = {};\r\n        /**\r\n         * @hidden\r\n         * @deprecated\r\n         */\r\n        this._animations = [];\r\n        this._suppressPlayButton = false;\r\n        /**\r\n         * Indicates whether audio should be paused when the game is no longer visible.\r\n         */\r\n        this.pauseAudioWhenHidden = true;\r\n        /**\r\n         * Indicates whether the engine should draw with debug information\r\n         */\r\n        this._isDebug = false;\r\n        this.debugColor = new Color(255, 255, 255);\r\n        /**\r\n         * Sets the Transparency for the engine.\r\n         */\r\n        this.enableCanvasTransparency = true;\r\n        /**\r\n         * The action to take when a fatal exception is thrown\r\n         */\r\n        this.onFatalException = (e) => {\r\n            Logger.getInstance().fatal(e);\r\n        };\r\n        this._timescale = 1.0;\r\n        this._isLoading = false;\r\n        this._isInitialized = false;\r\n        this._deferredGoTo = null;\r\n        this._loadingComplete = false;\r\n        options = Object.assign(Object.assign({}, Engine._DEFAULT_ENGINE_OPTIONS), options);\r\n        Flags.freeze();\r\n        // Initialize browser events facade\r\n        this.browser = new BrowserEvents(window, document);\r\n        // Check compatibility\r\n        const detector = new Detector();\r\n        if (!options.suppressMinimumBrowserFeatureDetection && !(this._compatible = detector.test())) {\r\n            const message = document.createElement('div');\r\n            message.innerText = 'Sorry, your browser does not support all the features needed for Excalibur';\r\n            document.body.appendChild(message);\r\n            detector.failedTests.forEach(function (test) {\r\n                const testMessage = document.createElement('div');\r\n                testMessage.innerText = 'Browser feature missing ' + test;\r\n                document.body.appendChild(testMessage);\r\n            });\r\n            if (options.canvasElementId) {\r\n                const canvas = document.getElementById(options.canvasElementId);\r\n                if (canvas) {\r\n                    canvas.parentElement.removeChild(canvas);\r\n                }\r\n            }\r\n            return;\r\n        }\r\n        else {\r\n            this._compatible = true;\r\n        }\r\n        // Use native console API for color fun\r\n        // eslint-disable-next-line no-console\r\n        if (console.log && !options.suppressConsoleBootMessage) {\r\n            // eslint-disable-next-line no-console\r\n            console.log(`%cPowered by Excalibur.js (v${EX_VERSION})`, 'background: #176BAA; color: white; border-radius: 5px; padding: 15px; font-size: 1.5em; line-height: 80px;');\r\n            // eslint-disable-next-line no-console\r\n            console.log('\\n\\\r\n      /| ________________\\n\\\r\nO|===|* >________________>\\n\\\r\n      \\\\|');\r\n            // eslint-disable-next-line no-console\r\n            console.log('Visit', 'http://excaliburjs.com', 'for more information');\r\n        }\r\n        // Suppress play button\r\n        if (options.suppressPlayButton) {\r\n            this._suppressPlayButton = true;\r\n        }\r\n        this._logger = Logger.getInstance();\r\n        // If debug is enabled, let's log browser features to the console.\r\n        if (this._logger.defaultLevel === LogLevel.Debug) {\r\n            detector.logBrowserFeatures();\r\n        }\r\n        this._logger.debug('Building engine...');\r\n        this.canvasElementId = options.canvasElementId;\r\n        if (options.canvasElementId) {\r\n            this._logger.debug('Using Canvas element specified: ' + options.canvasElementId);\r\n            this.canvas = document.getElementById(options.canvasElementId);\r\n        }\r\n        else if (options.canvasElement) {\r\n            this._logger.debug('Using Canvas element specified:', options.canvasElement);\r\n            this.canvas = options.canvasElement;\r\n        }\r\n        else {\r\n            this._logger.debug('Using generated canvas element');\r\n            this.canvas = document.createElement('canvas');\r\n        }\r\n        let displayMode = (_a = options.displayMode) !== null && _a !== void 0 ? _a : DisplayMode.Fixed;\r\n        if ((options.width && options.height) || options.viewport) {\r\n            if (options.displayMode === undefined) {\r\n                displayMode = DisplayMode.Fixed;\r\n            }\r\n            this._logger.debug('Engine viewport is size ' + options.width + ' x ' + options.height);\r\n        }\r\n        else if (!options.displayMode) {\r\n            this._logger.debug('Engine viewport is fit');\r\n            displayMode = DisplayMode.FitScreen;\r\n        }\r\n        if (Flags.isEnabled(Legacy.Canvas)) {\r\n            const ex2dCtx = new ExcaliburGraphicsContext2DCanvas({\r\n                canvasElement: this.canvas,\r\n                enableTransparency: this.enableCanvasTransparency,\r\n                smoothing: options.antialiasing,\r\n                backgroundColor: options.backgroundColor,\r\n                snapToPixel: options.snapToPixel\r\n            });\r\n            this.graphicsContext = ex2dCtx;\r\n            this.ctx = ex2dCtx.__ctx;\r\n        }\r\n        else {\r\n            const exWebglCtx = new ExcaliburGraphicsContextWebGL({\r\n                canvasElement: this.canvas,\r\n                enableTransparency: this.enableCanvasTransparency,\r\n                smoothing: options.antialiasing,\r\n                backgroundColor: options.backgroundColor,\r\n                snapToPixel: options.snapToPixel\r\n            });\r\n            this.graphicsContext = exWebglCtx;\r\n            this.ctx = exWebglCtx.__ctx;\r\n        }\r\n        this.screen = new Screen({\r\n            canvas: this.canvas,\r\n            context: this.graphicsContext,\r\n            antialiasing: (_b = options.antialiasing) !== null && _b !== void 0 ? _b : true,\r\n            browser: this.browser,\r\n            viewport: (_c = options.viewport) !== null && _c !== void 0 ? _c : (options.width && options.height ? { width: options.width, height: options.height } : Resolution.SVGA),\r\n            resolution: options.resolution,\r\n            displayMode,\r\n            position: options.position,\r\n            pixelRatio: options.suppressHiDPIScaling ? 1 : null\r\n        });\r\n        if (options.backgroundColor) {\r\n            this.backgroundColor = options.backgroundColor.clone();\r\n        }\r\n        this.enableCanvasTransparency = options.enableCanvasTransparency;\r\n        this._loader = new Loader();\r\n        this.debug = new Debug(this);\r\n        this._initialize(options);\r\n        this.rootScene = this.currentScene = new Scene();\r\n        this.addScene('root', this.rootScene);\r\n    }\r\n    /**\r\n     * The width of the game canvas in pixels (physical width component of the\r\n     * resolution of the canvas element)\r\n     */\r\n    get canvasWidth() {\r\n        return this.screen.canvasWidth;\r\n    }\r\n    /**\r\n     * Returns half width of the game canvas in pixels (half physical width component)\r\n     */\r\n    get halfCanvasWidth() {\r\n        return this.screen.halfCanvasWidth;\r\n    }\r\n    /**\r\n     * The height of the game canvas in pixels, (physical height component of\r\n     * the resolution of the canvas element)\r\n     */\r\n    get canvasHeight() {\r\n        return this.screen.canvasHeight;\r\n    }\r\n    /**\r\n     * Returns half height of the game canvas in pixels (half physical height component)\r\n     */\r\n    get halfCanvasHeight() {\r\n        return this.screen.halfCanvasHeight;\r\n    }\r\n    /**\r\n     * Returns the width of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get drawWidth() {\r\n        return this.screen.drawWidth;\r\n    }\r\n    /**\r\n     * Returns half the width of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get halfDrawWidth() {\r\n        return this.screen.halfDrawWidth;\r\n    }\r\n    /**\r\n     * Returns the height of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get drawHeight() {\r\n        return this.screen.drawHeight;\r\n    }\r\n    /**\r\n     * Returns half the height of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get halfDrawHeight() {\r\n        return this.screen.halfDrawHeight;\r\n    }\r\n    /**\r\n     * Returns whether excalibur detects the current screen to be HiDPI\r\n     */\r\n    get isHiDpi() {\r\n        return this.screen.isHiDpi;\r\n    }\r\n    /**\r\n     * Access [[stats]] that holds frame statistics.\r\n     */\r\n    get stats() {\r\n        return this.debug.stats;\r\n    }\r\n    /**\r\n     * Indicates whether the engine is set to fullscreen or not\r\n     */\r\n    get isFullscreen() {\r\n        return this.screen.isFullScreen;\r\n    }\r\n    /**\r\n     * Indicates the current [[DisplayMode]] of the engine.\r\n     */\r\n    get displayMode() {\r\n        return this.screen.displayMode;\r\n    }\r\n    /**\r\n     * Returns the calculated pixel ration for use in rendering\r\n     */\r\n    get pixelRatio() {\r\n        return this.screen.pixelRatio;\r\n    }\r\n    get isDebug() {\r\n        return this._isDebug;\r\n    }\r\n    on(eventName, handler) {\r\n        super.on(eventName, handler);\r\n    }\r\n    once(eventName, handler) {\r\n        super.once(eventName, handler);\r\n    }\r\n    off(eventName, handler) {\r\n        super.off(eventName, handler);\r\n    }\r\n    /**\r\n     * Returns a BoundingBox of the top left corner of the screen\r\n     * and the bottom right corner of the screen.\r\n     */\r\n    getWorldBounds() {\r\n        return this.screen.getWorldBounds();\r\n    }\r\n    /**\r\n     * Gets the current engine timescale factor (default is 1.0 which is 1:1 time)\r\n     */\r\n    get timescale() {\r\n        return this._timescale;\r\n    }\r\n    /**\r\n     * Sets the current engine timescale factor. Useful for creating slow-motion effects or fast-forward effects\r\n     * when using time-based movement.\r\n     */\r\n    set timescale(value) {\r\n        if (value <= 0) {\r\n            Logger.getInstance().error('Cannot set engine.timescale to a value of 0 or less than 0.');\r\n            return;\r\n        }\r\n        this._timescale = value;\r\n    }\r\n    /**\r\n     * Plays a sprite animation on the screen at the specified `x` and `y`\r\n     * (in game coordinates, not screen pixels). These animations play\r\n     * independent of actors, and will be cleaned up internally as soon\r\n     * as they are complete. Note animations that loop will never be\r\n     * cleaned up.\r\n     *\r\n     * @param animation  Animation to play\r\n     * @param x          x game coordinate to play the animation\r\n     * @param y          y game coordinate to play the animation\r\n     * @deprecated\r\n     */\r\n    playAnimation(animation, x, y) {\r\n        this._animations.push(new AnimationNode(animation, x, y));\r\n    }\r\n    /**\r\n     * Adds a [[TileMap]] to the [[currentScene]], once this is done the TileMap\r\n     * will be drawn and updated.\r\n     */\r\n    addTileMap(tileMap) {\r\n        this.currentScene.addTileMap(tileMap);\r\n    }\r\n    /**\r\n     * Removes a [[TileMap]] from the [[currentScene]], it will no longer be drawn or updated.\r\n     */\r\n    removeTileMap(tileMap) {\r\n        this.currentScene.removeTileMap(tileMap);\r\n    }\r\n    /**\r\n     * Adds a [[Timer]] to the [[currentScene]].\r\n     * @param timer  The timer to add to the [[currentScene]].\r\n     */\r\n    addTimer(timer) {\r\n        return this.currentScene.addTimer(timer);\r\n    }\r\n    /**\r\n     * Removes a [[Timer]] from the [[currentScene]].\r\n     * @param timer  The timer to remove to the [[currentScene]].\r\n     */\r\n    removeTimer(timer) {\r\n        return this.currentScene.removeTimer(timer);\r\n    }\r\n    /**\r\n     * Adds a [[Scene]] to the engine, think of scenes in Excalibur as you\r\n     * would levels or menus.\r\n     *\r\n     * @param key  The name of the scene, must be unique\r\n     * @param scene The scene to add to the engine\r\n     */\r\n    addScene(key, scene) {\r\n        if (this.scenes[key]) {\r\n            this._logger.warn('Scene', key, 'already exists overwriting');\r\n        }\r\n        this.scenes[key] = scene;\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    removeScene(entity) {\r\n        if (entity instanceof Scene) {\r\n            // remove scene\r\n            for (const key in this.scenes) {\r\n                if (this.scenes.hasOwnProperty(key)) {\r\n                    if (this.scenes[key] === entity) {\r\n                        delete this.scenes[key];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (typeof entity === 'string') {\r\n            // remove scene\r\n            delete this.scenes[entity];\r\n        }\r\n    }\r\n    add(entity) {\r\n        if (arguments.length === 2) {\r\n            this.addScene(arguments[0], arguments[1]);\r\n            return;\r\n        }\r\n        if (this._deferredGoTo && this.scenes[this._deferredGoTo]) {\r\n            this.scenes[this._deferredGoTo].add(entity);\r\n        }\r\n        else {\r\n            this.currentScene.add(entity);\r\n        }\r\n    }\r\n    remove(entity) {\r\n        if (entity instanceof Entity) {\r\n            this.currentScene.remove(entity);\r\n        }\r\n        if (entity instanceof Scene) {\r\n            this.removeScene(entity);\r\n        }\r\n        if (typeof entity === 'string') {\r\n            this.removeScene(entity);\r\n        }\r\n    }\r\n    /**\r\n     * Changes the currently updating and drawing scene to a different,\r\n     * named scene. Calls the [[Scene]] lifecycle events.\r\n     * @param key  The key of the scene to transition to.\r\n     */\r\n    goToScene(key) {\r\n        // if not yet initialized defer goToScene\r\n        if (!this.isInitialized) {\r\n            this._deferredGoTo = key;\r\n            return;\r\n        }\r\n        if (this.scenes[key]) {\r\n            const oldScene = this.currentScene;\r\n            const newScene = this.scenes[key];\r\n            this._logger.debug('Going to scene:', key);\r\n            // only deactivate when initialized\r\n            if (this.currentScene.isInitialized) {\r\n                this.currentScene._deactivate.apply(this.currentScene, [oldScene, newScene]);\r\n                this.currentScene.eventDispatcher.emit('deactivate', new DeactivateEvent(newScene, this.currentScene));\r\n            }\r\n            // set current scene to new one\r\n            this.currentScene = newScene;\r\n            this.screen.setCurrentCamera(newScene.camera);\r\n            // initialize the current scene if has not been already\r\n            this.currentScene._initialize(this);\r\n            this.currentScene._activate.apply(this.currentScene, [oldScene, newScene]);\r\n            this.currentScene.eventDispatcher.emit('activate', new ActivateEvent(oldScene, this.currentScene));\r\n        }\r\n        else {\r\n            this._logger.error('Scene', key, 'does not exist!');\r\n        }\r\n    }\r\n    /**\r\n     * Transforms the current x, y from screen coordinates to world coordinates\r\n     * @param point  Screen coordinate to convert\r\n     */\r\n    screenToWorldCoordinates(point) {\r\n        return this.screen.screenToWorldCoordinates(point);\r\n    }\r\n    /**\r\n     * Transforms a world coordinate, to a screen coordinate\r\n     * @param point  World coordinate to convert\r\n     */\r\n    worldToScreenCoordinates(point) {\r\n        return this.screen.worldToScreenCoordinates(point);\r\n    }\r\n    /**\r\n     * Initializes the internal canvas, rendering context, display mode, and native event listeners\r\n     */\r\n    _initialize(options) {\r\n        this.pageScrollPreventionMode = options.scrollPreventionMode;\r\n        // initialize inputs\r\n        this.input = {\r\n            keyboard: new Keyboard(),\r\n            pointers: new Pointers(this),\r\n            gamepads: new Gamepads()\r\n        };\r\n        this.input.keyboard.init();\r\n        this.input.pointers.init(options && options.pointerScope === PointerScope.Document ? document : this.canvas);\r\n        this.input.gamepads.init();\r\n        // Issue #385 make use of the visibility api\r\n        // https://developer.mozilla.org/en-US/docs/Web/Guide/User_experience/Using_the_Page_Visibility_API\r\n        let hidden, visibilityChange;\r\n        if (typeof document.hidden !== 'undefined') {\r\n            // Opera 12.10 and Firefox 18 and later support\r\n            hidden = 'hidden';\r\n            visibilityChange = 'visibilitychange';\r\n        }\r\n        else if ('msHidden' in document) {\r\n            hidden = 'msHidden';\r\n            visibilityChange = 'msvisibilitychange';\r\n        }\r\n        else if ('webkitHidden' in document) {\r\n            hidden = 'webkitHidden';\r\n            visibilityChange = 'webkitvisibilitychange';\r\n        }\r\n        this.browser.document.on(visibilityChange, () => {\r\n            if (document[hidden]) {\r\n                this.eventDispatcher.emit('hidden', new HiddenEvent(this));\r\n                this._logger.debug('Window hidden');\r\n            }\r\n            else {\r\n                this.eventDispatcher.emit('visible', new VisibleEvent(this));\r\n                this._logger.debug('Window visible');\r\n            }\r\n        });\r\n        if (!this.canvasElementId && !options.canvasElement) {\r\n            document.body.appendChild(this.canvas);\r\n        }\r\n    }\r\n    onInitialize(_engine) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * If supported by the browser, this will set the antialiasing flag on the\r\n     * canvas. Set this to `false` if you want a 'jagged' pixel art look to your\r\n     * image resources.\r\n     * @param isSmooth  Set smoothing to true or false\r\n     */\r\n    setAntialiasing(isSmooth) {\r\n        this.screen.antialiasing = isSmooth;\r\n    }\r\n    /**\r\n     * Return the current smoothing status of the canvas\r\n     */\r\n    getAntialiasing() {\r\n        return this.screen.antialiasing;\r\n    }\r\n    /**\r\n     * Gets whether the actor is Initialized\r\n     */\r\n    get isInitialized() {\r\n        return this._isInitialized;\r\n    }\r\n    _overrideInitialize(engine) {\r\n        if (!this.isInitialized) {\r\n            this.onInitialize(engine);\r\n            super.emit('initialize', new InitializeEvent(engine, this));\r\n            this._isInitialized = true;\r\n            if (this._deferredGoTo) {\r\n                this.goToScene(this._deferredGoTo);\r\n            }\r\n            else {\r\n                this.goToScene('root');\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Updates the entire state of the game\r\n     * @param delta  Number of milliseconds elapsed since the last update.\r\n     */\r\n    _update(delta) {\r\n        if (this._isLoading) {\r\n            // suspend updates until loading is finished\r\n            this._loader.update(this, delta);\r\n            // Update input listeners\r\n            this.input.keyboard.update();\r\n            this.input.pointers.update();\r\n            this.input.gamepads.update();\r\n            return;\r\n        }\r\n        this._overrideInitialize(this);\r\n        // Publish preupdate events\r\n        this._preupdate(delta);\r\n        // process engine level events\r\n        this.currentScene.update(this, delta);\r\n        // update animations\r\n        // TODO remove\r\n        this._animations = this._animations.filter(function (a) {\r\n            return !a.animation.isDone();\r\n        });\r\n        // Update input listeners\r\n        this.input.keyboard.update();\r\n        this.input.pointers.update();\r\n        this.input.gamepads.update();\r\n        // Publish update event\r\n        this._postupdate(delta);\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    _preupdate(delta) {\r\n        this.emit('preupdate', new PreUpdateEvent(this, delta, this));\r\n        this.onPreUpdate(this, delta);\r\n    }\r\n    onPreUpdate(_engine, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    _postupdate(delta) {\r\n        this.emit('postupdate', new PostUpdateEvent(this, delta, this));\r\n        this.onPostUpdate(this, delta);\r\n    }\r\n    onPostUpdate(_engine, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * Draws the entire game\r\n     * @param delta  Number of milliseconds elapsed since the last draw.\r\n     */\r\n    _draw(delta) {\r\n        const ctx = this.ctx;\r\n        this._predraw(ctx, delta);\r\n        if (this._isLoading) {\r\n            this._loader.canvas.draw(this.graphicsContext, 0, 0);\r\n            this.graphicsContext.flush();\r\n            // Drawing nothing else while loading\r\n            return;\r\n        }\r\n        // TODO move to graphics systems?\r\n        this.graphicsContext.backgroundColor = this.backgroundColor;\r\n        this.currentScene.draw(this.ctx, delta);\r\n        // todo needs to be a better way of doing this\r\n        let a = 0;\r\n        const len = this._animations.length;\r\n        for (a; a < len; a++) {\r\n            this._animations[a].animation.draw(ctx, this._animations[a].x, this._animations[a].y);\r\n        }\r\n        // Draw debug information\r\n        // TODO don't access ctx directly\r\n        if (this.isDebug) {\r\n            this.ctx.font = 'Consolas';\r\n            this.ctx.fillStyle = this.debugColor.toString();\r\n            const keys = this.input.keyboard.getKeys();\r\n            for (let j = 0; j < keys.length; j++) {\r\n                this.ctx.fillText(keys[j].toString() + ' : ' + (Keys[keys[j]] ? Keys[keys[j]] : 'Not Mapped'), 100, 10 * j + 10);\r\n            }\r\n            this.ctx.fillText('FPS:' + this.stats.currFrame.fps.toFixed(2).toString(), 10, 10);\r\n        }\r\n        // Post processing\r\n        for (let i = 0; i < this.postProcessors.length; i++) {\r\n            this.postProcessors[i].process(this.ctx.getImageData(0, 0, this.canvasWidth, this.canvasHeight), this.ctx);\r\n        }\r\n        this._postdraw(ctx, delta);\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    _predraw(_ctx, delta) {\r\n        this.emit('predraw', new PreDrawEvent(_ctx, delta, this));\r\n        this.onPreDraw(_ctx, delta);\r\n    }\r\n    onPreDraw(_ctx, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    _postdraw(_ctx, delta) {\r\n        this.emit('postdraw', new PostDrawEvent(_ctx, delta, this));\r\n        this.onPostDraw(_ctx, delta);\r\n    }\r\n    onPostDraw(_ctx, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * Enable or disable Excalibur debugging functionality.\r\n     * @param toggle a value that debug drawing will be changed to\r\n     */\r\n    showDebug(toggle) {\r\n        this._isDebug = toggle;\r\n    }\r\n    /**\r\n     * Toggle Excalibur debugging functionality.\r\n     */\r\n    toggleDebug() {\r\n        this._isDebug = !this._isDebug;\r\n        return this._isDebug;\r\n    }\r\n    /**\r\n     * Returns true when loading is totally complete and the player has clicked start\r\n     */\r\n    get loadingComplete() {\r\n        return this._loadingComplete;\r\n    }\r\n    /**\r\n     * Starts the internal game loop for Excalibur after loading\r\n     * any provided assets.\r\n     * @param loader  Optional [[Loader]] to use to load resources. The default loader is [[Loader]], override to provide your own\r\n     * custom loader.\r\n     */\r\n    start(loader) {\r\n        if (!this._compatible) {\r\n            return Promise.reject('Excalibur is incompatible with your browser');\r\n        }\r\n        let loadingComplete;\r\n        // Push the current user entered resolution/viewport\r\n        this.screen.pushResolutionAndViewport();\r\n        // Configure resolution for loader\r\n        this.screen.resolution = this.screen.viewport;\r\n        this.screen.applyResolutionAndViewport();\r\n        this.graphicsContext.updateViewport();\r\n        if (loader) {\r\n            this._loader = loader;\r\n            this._loader.suppressPlayButton = this._suppressPlayButton || this._loader.suppressPlayButton;\r\n            this._loader.wireEngine(this);\r\n            loadingComplete = this.load(this._loader);\r\n        }\r\n        else {\r\n            loadingComplete = Promise.resolve();\r\n        }\r\n        loadingComplete.then(() => {\r\n            this.screen.popResolutionAndViewport();\r\n            this.screen.applyResolutionAndViewport();\r\n            this.graphicsContext.updateViewport();\r\n            this.emit('start', new GameStartEvent(this));\r\n            this._loadingComplete = true;\r\n        });\r\n        if (!this._hasStarted) {\r\n            // has started is a slight misnomer, it's really mainloop started\r\n            this._hasStarted = true;\r\n            this._logger.debug('Starting game...');\r\n            this.browser.resume();\r\n            Engine.createMainLoop(this, window.requestAnimationFrame, Date.now)();\r\n            this._logger.debug('Game started');\r\n        }\r\n        else {\r\n            // Game already started;\r\n        }\r\n        return loadingComplete;\r\n    }\r\n    static createMainLoop(game, raf, nowFn) {\r\n        let lastTime = nowFn();\r\n        return function mainloop() {\r\n            if (!game._hasStarted) {\r\n                return;\r\n            }\r\n            try {\r\n                game._requestId = raf(mainloop);\r\n                game.emit('preframe', new PreFrameEvent(game, game.stats.prevFrame));\r\n                // Get the time to calculate time-elapsed\r\n                const now = nowFn();\r\n                let elapsed = Math.floor(now - lastTime) || 1;\r\n                // Resolves issue #138 if the game has been paused, or blurred for\r\n                // more than a 200 milliseconds, reset elapsed time to 1. This improves reliability\r\n                // and provides more expected behavior when the engine comes back\r\n                // into focus\r\n                if (elapsed > 200) {\r\n                    elapsed = 1;\r\n                }\r\n                const delta = elapsed * game.timescale;\r\n                // reset frame stats (reuse existing instances)\r\n                const frameId = game.stats.prevFrame.id + 1;\r\n                game.stats.currFrame.reset();\r\n                game.stats.currFrame.id = frameId;\r\n                game.stats.currFrame.delta = delta;\r\n                game.stats.currFrame.fps = 1.0 / (delta / 1000);\r\n                const beforeUpdate = nowFn();\r\n                game._update(delta);\r\n                const afterUpdate = nowFn();\r\n                game._draw(delta);\r\n                const afterDraw = nowFn();\r\n                game.stats.currFrame.duration.update = afterUpdate - beforeUpdate;\r\n                game.stats.currFrame.duration.draw = afterDraw - afterUpdate;\r\n                lastTime = now;\r\n                game.emit('postframe', new PostFrameEvent(game, game.stats.currFrame));\r\n                game.stats.prevFrame.reset(game.stats.currFrame);\r\n            }\r\n            catch (e) {\r\n                window.cancelAnimationFrame(game._requestId);\r\n                game.stop();\r\n                game.onFatalException(e);\r\n            }\r\n        };\r\n    }\r\n    /**\r\n     * Stops Excalibur's main loop, useful for pausing the game.\r\n     */\r\n    stop() {\r\n        if (this._hasStarted) {\r\n            this.emit('stop', new GameStopEvent(this));\r\n            this.browser.pause();\r\n            this._hasStarted = false;\r\n            this._logger.debug('Game stopped');\r\n        }\r\n    }\r\n    /**\r\n     * Returns the Engine's Running status, Useful for checking whether engine is running or paused.\r\n     */\r\n    isPaused() {\r\n        return !this._hasStarted;\r\n    }\r\n    /**\r\n     * Takes a screen shot of the current viewport and returns it as an\r\n     * HTML Image Element.\r\n     */\r\n    screenshot() {\r\n        const result = new Image();\r\n        const raw = this.canvas.toDataURL('image/png');\r\n        result.src = raw;\r\n        return result;\r\n    }\r\n    /**\r\n     * Another option available to you to load resources into the game.\r\n     * Immediately after calling this the game will pause and the loading screen\r\n     * will appear.\r\n     * @param loader  Some [[Loadable]] such as a [[Loader]] collection, [[Sound]], or [[Texture]].\r\n     */\r\n    load(loader) {\r\n        const complete = new Promise((resolve) => {\r\n            this._isLoading = true;\r\n            loader.load().then(() => {\r\n                if (this._suppressPlayButton) {\r\n                    setTimeout(() => {\r\n                        this._isLoading = false;\r\n                        resolve();\r\n                        // Delay is to give the logo a chance to show, otherwise don't delay\r\n                    }, 500);\r\n                }\r\n                else {\r\n                    this._isLoading = false;\r\n                    resolve();\r\n                }\r\n            });\r\n        });\r\n        return complete;\r\n    }\r\n}\r\n/**\r\n * Default [[EngineOptions]]\r\n */\r\nEngine._DEFAULT_ENGINE_OPTIONS = {\r\n    width: 0,\r\n    height: 0,\r\n    enableCanvasTransparency: true,\r\n    canvasElementId: '',\r\n    canvasElement: undefined,\r\n    snapToPixel: false,\r\n    pointerScope: PointerScope.Canvas,\r\n    suppressConsoleBootMessage: null,\r\n    suppressMinimumBrowserFeatureDetection: null,\r\n    suppressHiDPIScaling: null,\r\n    suppressPlayButton: null,\r\n    scrollPreventionMode: ScrollPreventionMode.Canvas,\r\n    backgroundColor: Color.fromHex('#2185d0') // Excalibur blue\r\n};\r\nEngine_decorate([\r\n    obsolete({ message: 'Will be removed in excalibur v0.26.0', alternateMethod: 'Use Actor.graphics' })\r\n], Engine.prototype, \"playAnimation\", null);\r\n/**\r\n * @internal\r\n * @deprecated\r\n */\r\nlet AnimationNode = class AnimationNode {\r\n    constructor(animation, x, y) {\r\n        this.animation = animation;\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n};\r\nAnimationNode = Engine_decorate([\r\n    obsolete({ message: 'Will be removed in excalibur v0.26.0' })\r\n], AnimationNode);\r\n\n;// CONCATENATED MODULE: ./Math/Index.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Debug/index.ts\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Events/MediaEvents.ts\n\r\nclass MediaEvent extends GameEvent {\r\n    constructor(target, _name = 'MediaEvent') {\r\n        super();\r\n        this.target = target;\r\n        this._name = _name;\r\n    }\r\n    /**\r\n     * Media event cannot bubble\r\n     */\r\n    set bubbles(_value) {\r\n        // stubbed\r\n    }\r\n    /**\r\n     * Media event cannot bubble\r\n     */\r\n    get bubbles() {\r\n        return false;\r\n    }\r\n    /**\r\n     * Media event cannot bubble, so they have no path\r\n     */\r\n    get _path() {\r\n        return null;\r\n    }\r\n    /**\r\n     * Media event cannot bubble, so they have no path\r\n     */\r\n    set _path(_val) {\r\n        // stubbed\r\n    }\r\n    /**\r\n     * Prevents event from bubbling\r\n     */\r\n    stopPropagation() {\r\n        /**\r\n         * Stub\r\n         */\r\n    }\r\n    /**\r\n     * Action, that calls when event happens\r\n     */\r\n    action() {\r\n        /**\r\n         * Stub\r\n         */\r\n    }\r\n    /**\r\n     * Propagate event further through event path\r\n     */\r\n    propagate() {\r\n        /**\r\n         * Stub\r\n         */\r\n    }\r\n    layPath(_actor) {\r\n        /**\r\n         * Stub\r\n         */\r\n    }\r\n}\r\nclass NativeSoundEvent extends MediaEvent {\r\n    constructor(target, track) {\r\n        super(target, 'NativeSoundEvent');\r\n        this.track = track;\r\n    }\r\n}\r\nclass NativeSoundProcessedEvent extends MediaEvent {\r\n    constructor(target, _processedData) {\r\n        super(target, 'NativeSoundProcessedEvent');\r\n        this._processedData = _processedData;\r\n        this.data = this._processedData;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Font.ts\n\r\n\r\n\r\n\r\n\r\nclass Font extends Raster {\r\n    constructor(options = {}) {\r\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m;\r\n        super(options);\r\n        /**\r\n         * Font quality determines the size of the underlying rastered text, higher quality means less jagged edges.\r\n         * If quality is set to 1, then just enough raster bitmap is generated to render the text.\r\n         *\r\n         * You can think of quality as how zoomed in to the text you can get before seeing jagged edges.\r\n         *\r\n         * (Default 4)\r\n         */\r\n        this.quality = 2;\r\n        this.family = 'sans-serif';\r\n        this.style = FontStyle.Normal;\r\n        this.bold = false;\r\n        this.unit = FontUnit.Px;\r\n        this.textAlign = TextAlign.Left;\r\n        this.baseAlign = BaseAlign.Alphabetic;\r\n        this.direction = Direction.LeftToRight;\r\n        this.size = 10;\r\n        this.shadow = null;\r\n        this._textBounds = new BoundingBox();\r\n        this._textWidth = 0;\r\n        this._textHeight = 0;\r\n        this.family = (_a = options === null || options === void 0 ? void 0 : options.family) !== null && _a !== void 0 ? _a : this.family;\r\n        this.style = (_b = options === null || options === void 0 ? void 0 : options.style) !== null && _b !== void 0 ? _b : this.style;\r\n        this.bold = (_c = options === null || options === void 0 ? void 0 : options.bold) !== null && _c !== void 0 ? _c : this.bold;\r\n        this.size = (_d = options === null || options === void 0 ? void 0 : options.size) !== null && _d !== void 0 ? _d : this.size;\r\n        this.unit = (_e = options === null || options === void 0 ? void 0 : options.unit) !== null && _e !== void 0 ? _e : this.unit;\r\n        this.textAlign = (_f = options === null || options === void 0 ? void 0 : options.textAlign) !== null && _f !== void 0 ? _f : this.textAlign;\r\n        this.baseAlign = (_g = options === null || options === void 0 ? void 0 : options.baseAlign) !== null && _g !== void 0 ? _g : this.baseAlign;\r\n        this.direction = (_h = options === null || options === void 0 ? void 0 : options.direction) !== null && _h !== void 0 ? _h : this.direction;\r\n        this.quality = (_j = options === null || options === void 0 ? void 0 : options.quality) !== null && _j !== void 0 ? _j : this.quality;\r\n        if (options === null || options === void 0 ? void 0 : options.shadow) {\r\n            this.shadow = {};\r\n            this.shadow.blur = (_k = options.shadow.blur) !== null && _k !== void 0 ? _k : this.shadow.blur;\r\n            this.shadow.offset = (_l = options.shadow.offset) !== null && _l !== void 0 ? _l : this.shadow.offset;\r\n            this.shadow.color = (_m = options.shadow.color) !== null && _m !== void 0 ? _m : this.shadow.color;\r\n        }\r\n        this.flagDirty();\r\n    }\r\n    clone() {\r\n        return new Font(Object.assign(Object.assign(Object.assign({}, this.cloneGraphicOptions()), this.cloneRasterOptions()), { size: this.size, unit: this.unit, family: this.family, style: this.style, bold: this.bold, textAlign: this.textAlign, baseAlign: this.baseAlign, direction: this.direction, shadow: this.shadow\r\n                ? {\r\n                    blur: this.shadow.blur,\r\n                    offset: this.shadow.offset,\r\n                    color: this.shadow.color\r\n                }\r\n                : null }));\r\n    }\r\n    get fontString() {\r\n        return `${this.style} ${this.bold ? 'bold' : ''} ${this.size}${this.unit} ${this.family}`;\r\n    }\r\n    get width() {\r\n        return this._textWidth;\r\n    }\r\n    set width(value) {\r\n        this._textWidth = value;\r\n    }\r\n    get height() {\r\n        var _a, _b;\r\n        const numLines = (_b = (_a = this._lines) === null || _a === void 0 ? void 0 : _a.length) !== null && _b !== void 0 ? _b : 1;\r\n        return this._textHeight * numLines;\r\n    }\r\n    set height(value) {\r\n        var _a, _b;\r\n        const numLines = (_b = (_a = this._lines) === null || _a === void 0 ? void 0 : _a.length) !== null && _b !== void 0 ? _b : 1;\r\n        this._textHeight = value / numLines;\r\n    }\r\n    get _rasterWidth() {\r\n        return this._bitmap.width;\r\n    }\r\n    get _rasterHeight() {\r\n        return this._bitmap.height;\r\n    }\r\n    get _halfRasterWidth() {\r\n        return Math.floor(this._bitmap.width / 2);\r\n    }\r\n    get _halfRasterHeight() {\r\n        return Math.floor(this._bitmap.height / 2);\r\n    }\r\n    get localBounds() {\r\n        return this._textBounds;\r\n    }\r\n    _drawImage(ex, x, y) {\r\n        if (this.dirty) {\r\n            this.rasterize();\r\n        }\r\n        ex.drawImage(this._bitmap, 0, 0, this._rasterWidth, this._rasterHeight, x - this._rasterWidth / this.quality / 2, y - this._rasterHeight / this.quality / 2, this._rasterWidth / this.quality, this._rasterHeight / this.quality);\r\n    }\r\n    _rotate(ex) {\r\n        var _a;\r\n        // TODO this needs to change depending on the bounding box...\r\n        const origin = (_a = this.origin) !== null && _a !== void 0 ? _a : this._textBounds.center;\r\n        ex.translate(origin.x, origin.y);\r\n        ex.rotate(this.rotation);\r\n        ex.translate(-origin.x, -origin.y);\r\n    }\r\n    _flip(ex) {\r\n        if (this.flipHorizontal) {\r\n            ex.translate(this._textBounds.width / this.scale.x, 0);\r\n            ex.scale(-1, 1);\r\n        }\r\n        if (this.flipVertical) {\r\n            ex.translate(0, -this._textBounds.height / 2 / this.scale.y);\r\n            ex.scale(1, -1);\r\n        }\r\n    }\r\n    updateText(text) {\r\n        if (this._text !== text) {\r\n            this._text = text;\r\n            this._lines = this._text.split('\\n');\r\n            this._updateDimensions();\r\n            this.flagDirty();\r\n        }\r\n    }\r\n    _updateDimensions() {\r\n        if (this._text) {\r\n            this._applyFont(this._ctx);\r\n            const maxWidthLine = this._lines.reduce((a, b) => {\r\n                return a.length > b.length ? a : b;\r\n            });\r\n            const metrics = this._ctx.measureText(maxWidthLine);\r\n            this._textWidth = Math.abs(metrics.actualBoundingBoxLeft) + Math.abs(metrics.actualBoundingBoxRight);\r\n            this._textHeight = Math.abs(metrics.actualBoundingBoxAscent) + Math.abs(metrics.actualBoundingBoxDescent);\r\n            // TODO lineheight makes the text bounds wonky\r\n            const lineAdjustedHeight = this._textHeight * this._lines.length;\r\n            // this._textHeight = lineAdjustedHeight;\r\n            // Changing the width and height clears the context properties\r\n            // We double the bitmap width to account for alignment\r\n            // We scale by \"quality\" so we render text without jaggies\r\n            this._bitmap.width = (this._textWidth + this.padding * 2) * 2 * this.quality;\r\n            this._bitmap.height = (lineAdjustedHeight + this.padding * 2) * 2 * this.quality;\r\n            // These bounds exist in raster bitmap space where the top left corner is the corder of the bitmap\r\n            const x = 0;\r\n            const y = 0;\r\n            const bottomBounds = lineAdjustedHeight - Math.abs(metrics.actualBoundingBoxAscent);\r\n            this._textBounds = new BoundingBox({\r\n                left: x - Math.abs(metrics.actualBoundingBoxLeft) - this.padding,\r\n                top: y - Math.abs(metrics.actualBoundingBoxAscent) - this.padding,\r\n                bottom: y + bottomBounds + this.padding,\r\n                right: x + Math.abs(metrics.actualBoundingBoxRight) + this.padding\r\n            });\r\n        }\r\n    }\r\n    _preDraw(ex, x, y) {\r\n        if (this.dirty) {\r\n            this._updateDimensions();\r\n        }\r\n        super._preDraw(ex, x, y);\r\n    }\r\n    _postDraw(ex) {\r\n        if (this.showDebug) {\r\n            /* istanbul ignore next */\r\n            ex.debug.drawRect(-this._halfRasterWidth, -this._halfRasterHeight, this._rasterWidth, this._rasterHeight);\r\n        }\r\n        ex.restore();\r\n    }\r\n    _applyFont(ctx) {\r\n        ctx.translate(this.padding + this._halfRasterWidth, this.padding + this._halfRasterHeight);\r\n        ctx.scale(this.quality, this.quality);\r\n        ctx.textAlign = this.textAlign;\r\n        ctx.textBaseline = this.baseAlign;\r\n        ctx.font = this.fontString;\r\n        ctx.direction = this.direction;\r\n        if (this.shadow) {\r\n            ctx.shadowColor = this.shadow.color.toString();\r\n            ctx.shadowBlur = this.shadow.blur;\r\n            ctx.shadowOffsetX = this.shadow.offset.x;\r\n            ctx.shadowOffsetY = this.shadow.offset.y;\r\n        }\r\n    }\r\n    execute(ctx) {\r\n        if (this._text) {\r\n            // The reason we need to re-apply the font is setting raster properties (like width/height) can reset the context props\r\n            this._applyRasterProperites(ctx);\r\n            this._applyFont(ctx);\r\n            const lineHeight = this._textHeight; // TODO user specified line height\r\n            for (let i = 0; i < this._lines.length; i++) {\r\n                const line = this._lines[i];\r\n                if (this.color) {\r\n                    ctx.fillText(line, 0, i * lineHeight);\r\n                }\r\n                if (this.strokeColor) {\r\n                    ctx.strokeText(line, 0, i * lineHeight);\r\n                }\r\n            }\r\n            if (this.showDebug) {\r\n                // Horizontal line\r\n                /* istanbul ignore next */\r\n                line(ctx, Color.Red, -this._halfRasterWidth, 0, this._halfRasterWidth, 0, 2);\r\n                // Vertical line\r\n                /* istanbul ignore next */\r\n                line(ctx, Color.Red, 0, -this._halfRasterHeight, 0, this._halfRasterHeight, 2);\r\n            }\r\n        }\r\n    }\r\n    render(ex, text, x, y) {\r\n        this.updateText(text);\r\n        this.draw(ex, x, y);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Text.ts\n\r\n\r\n\r\n\r\nclass Text extends Graphic {\r\n    constructor(options) {\r\n        var _a, _b;\r\n        super(options);\r\n        this._text = '';\r\n        // This order is important font, color, then text\r\n        this.font = (_a = options.font) !== null && _a !== void 0 ? _a : new Font();\r\n        this.color = (_b = options.color) !== null && _b !== void 0 ? _b : this.color;\r\n        this.text = options.text;\r\n    }\r\n    clone() {\r\n        return new Text({\r\n            text: this.text.slice(),\r\n            color: this.color.clone(),\r\n            font: this.font.clone()\r\n        });\r\n    }\r\n    get text() {\r\n        return this._text;\r\n    }\r\n    set text(value) {\r\n        this._text = value;\r\n        this.font.updateText(value);\r\n    }\r\n    // TODO SpriteFont doesn't support a color yet :(\r\n    get color() {\r\n        if (this.font instanceof Font) {\r\n            return this.font.color;\r\n        }\r\n        return Color.Black;\r\n    }\r\n    set color(color) {\r\n        if (this.font instanceof Font) {\r\n            this.font.color = color;\r\n        }\r\n    }\r\n    get font() {\r\n        return this._font;\r\n    }\r\n    set font(font) {\r\n        if (font instanceof Font) {\r\n            this._font = watch(font, (font) => font.flagDirty());\r\n        }\r\n        else {\r\n            this._font = font;\r\n        }\r\n    }\r\n    get width() {\r\n        return this.font.width;\r\n    }\r\n    get height() {\r\n        return this.font.height;\r\n    }\r\n    get localBounds() {\r\n        return this.font.localBounds;\r\n    }\r\n    _rotate(_ex) {\r\n        // None this is delegated to font\r\n        // This override erases the default behavior\r\n    }\r\n    _flip(_ex) {\r\n        // None this is delegated to font\r\n        // This override erases the default behavior\r\n    }\r\n    _drawImage(ex, x, y) {\r\n        if (this.font instanceof Font) {\r\n            this.font.color = this.color;\r\n        }\r\n        this.font.flipHorizontal = this.flipHorizontal;\r\n        this.font.flipVertical = this.flipVertical;\r\n        this.font.scale = this.scale;\r\n        this.font.rotation = this.rotation;\r\n        this.font.origin = this.origin;\r\n        this.font.opacity = this.opacity;\r\n        this.font.render(ex, this._text, x, y);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Label.ts\nvar Label_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Labels are the way to draw small amounts of text to the screen. They are\r\n * actors and inherit all of the benefits and capabilities.\r\n */\r\nclass Label_Label extends Actor {\r\n    /**\r\n     * Build a new label\r\n     * @param options\r\n     */\r\n    constructor(options) {\r\n        super(options);\r\n        this.font = new Font();\r\n        this._text = new Text({ text: '', font: this.font });\r\n        /**\r\n         * Gets or sets the letter spacing on a Label. Only supported with Sprite Fonts.\r\n         * @deprecated Use [[SpriteFont.spacing]]\r\n         */\r\n        this.letterSpacing = 0; //px\r\n        /**\r\n         * Whether or not the [[SpriteFont]] will be case-sensitive when matching characters.\r\n         * @deprecated Use Graphics.SpriteFont.caseInsensitve\r\n         */\r\n        this.caseInsensitive = true;\r\n        const { text, pos, x, y, spriteFont, font, color } = options;\r\n        this.pos = pos !== null && pos !== void 0 ? pos : (x && y ? vec(x, y) : this.pos);\r\n        this.text = text !== null && text !== void 0 ? text : this.text;\r\n        this.spriteFont = spriteFont !== null && spriteFont !== void 0 ? spriteFont : this.spriteFont;\r\n        this.font = font !== null && font !== void 0 ? font : this.font;\r\n        this.color = color !== null && color !== void 0 ? color : this.color;\r\n        const gfx = this.get(GraphicsComponent);\r\n        gfx.anchor = Vector.Zero;\r\n        gfx.use(this._text);\r\n    }\r\n    /**\r\n     * The text to draw.\r\n     */\r\n    get text() {\r\n        return this._text.text;\r\n    }\r\n    set text(text) {\r\n        this._text.text = text;\r\n    }\r\n    get color() {\r\n        return this._text.color;\r\n    }\r\n    set color(color) {\r\n        this._text.color = color;\r\n    }\r\n    get opacity() {\r\n        return this._text.opacity;\r\n    }\r\n    set opacity(opacity) {\r\n        this._text.opacity = opacity;\r\n    }\r\n    /**\r\n     * Sets or gets the bold property of the label's text, by default it's false\r\n     * @deprecated Use [[Font.bold|Label.font.bold]]\r\n     */\r\n    get bold() {\r\n        return this.font.bold;\r\n    }\r\n    set bold(isBold) {\r\n        this.font.bold = isBold;\r\n    }\r\n    /**\r\n     * The CSS font family string (e.g. `sans-serif`, `Droid Sans Pro`). Web fonts\r\n     * are supported, same as in CSS.\r\n     * @deprecated Use [[Font.family|Label.font.family]]\r\n     */\r\n    get fontFamily() {\r\n        return this.font.family;\r\n    }\r\n    set fontFamily(family) {\r\n        this.font.family = family;\r\n    }\r\n    /**\r\n     * The font size in the selected units, default is 10 (default units is pixel)\r\n     * @deprecated Use [[Font.size|Label.font.size]]\r\n     */\r\n    get fontSize() {\r\n        return this.font.size;\r\n    }\r\n    set fontSize(sizeInUnit) {\r\n        this.font.size = sizeInUnit;\r\n    }\r\n    /**\r\n     * The font style for this label, the default is [[FontStyle.Normal]]\r\n     * @deprecated Use [[Font.style|Label.font.style]]\r\n     */\r\n    get fontStyle() {\r\n        return this.font.style;\r\n    }\r\n    set fontStyle(style) {\r\n        this.font.style = style;\r\n    }\r\n    /**\r\n     * The css units for a font size such as px, pt, em (SpriteFont only support px), by default is 'px';\r\n     * @deprecated Use [[Font.unit|Label.font.unit]]\r\n     */\r\n    get fontUnit() {\r\n        return this.font.unit;\r\n    }\r\n    set fontUnit(unit) {\r\n        this.font.unit = unit;\r\n    }\r\n    /**\r\n     * Gets or sets the horizontal text alignment property for the label.\r\n     * @deprecated Use [[Font.textAlign|Label.font.textAlign]]\r\n     */\r\n    get textAlign() {\r\n        return this.font.textAlign;\r\n    }\r\n    set textAlign(align) {\r\n        this.font.textAlign = align;\r\n    }\r\n    /**\r\n     * Gets or sets the baseline alignment property for the label.\r\n     * @deprecated Use [[Font.baseAlign|Label.font.baseAlign]]\r\n     */\r\n    get baseAlign() {\r\n        return this.font.baseAlign;\r\n    }\r\n    set baseAlign(align) {\r\n        this.font.baseAlign = align;\r\n    }\r\n    /**\r\n     * The [[LegacyDrawing.SpriteFont]] to use, if any. Overrides [[fontFamily]] if present.\r\n     * @deprecated Use [[SpriteFont]]\r\n     */\r\n    get spriteFont() {\r\n        return this._legacySpriteFont;\r\n    }\r\n    set spriteFont(sf) {\r\n        if (sf) {\r\n            if (sf instanceof SpriteFont) {\r\n                this._legacySpriteFont = sf;\r\n                this._spriteFont = SpriteFont_SpriteFont.fromLegacySpriteFont(sf);\r\n                this._text.font = this._spriteFont;\r\n                return;\r\n            }\r\n            this._spriteFont = sf;\r\n            this._text.font = this._spriteFont;\r\n        }\r\n    }\r\n    _initialize(engine) {\r\n        super._initialize(engine);\r\n        this._graphicsContext = engine.graphicsContext;\r\n    }\r\n    /**\r\n     * Returns the width of the text in the label (in pixels);\r\n     */\r\n    getTextWidth() {\r\n        return this._text.width;\r\n    }\r\n    /**\r\n     * Sets the text shadow for sprite fonts\r\n     * @param offsetX      The x offset in pixels to place the shadow\r\n     * @param offsetY      The y offset in pixels to place the shadow\r\n     * @param shadowColor  The color of the text shadow\r\n     * @deprecated Use [[Font.shadow|Label.font.shadow]]\r\n     */\r\n    setTextShadow(offsetX, offsetY, shadowColor) {\r\n        this.font.shadow = { offset: vec(offsetX, offsetY), blur: 2, color: shadowColor };\r\n    }\r\n    /**\r\n     * Toggles text shadows on or off, only applies when using sprite fonts\r\n     * @deprecated Use [[Font.shadow|Label.font.shadow]]\r\n     */\r\n    useTextShadow(on) {\r\n        if (this.spriteFont) {\r\n            this.spriteFont.useTextShadow(on);\r\n        }\r\n    }\r\n    /**\r\n     * Clears the current text shadow\r\n     * @deprecated Use [[Font.shadow|Label.font.shadow]]\r\n     */\r\n    clearTextShadow() {\r\n        this.font.shadow = null;\r\n    }\r\n    draw(_ctx, _delta) {\r\n        const exctx = this._graphicsContext;\r\n        this._text.draw(exctx, 0, 0);\r\n    }\r\n}\r\nLabel_decorate([\r\n    obsolete({\r\n        message: 'Label.bold will be removed in v0.26.0',\r\n        alternateMethod: 'Use Label.font.bold'\r\n    })\r\n], Label_Label.prototype, \"bold\", null);\r\nLabel_decorate([\r\n    obsolete({\r\n        message: 'Label.fontFamily will be removed in v0.26.0',\r\n        alternateMethod: 'Use Label.font.family'\r\n    })\r\n], Label_Label.prototype, \"fontFamily\", null);\r\nLabel_decorate([\r\n    obsolete({\r\n        message: 'Label.fontSize will be removed in v0.26.0',\r\n        alternateMethod: 'Use Label.font.size'\r\n    })\r\n], Label_Label.prototype, \"fontSize\", null);\r\nLabel_decorate([\r\n    obsolete({\r\n        message: 'Label.fontStyle will be removed in v0.26.0',\r\n        alternateMethod: 'Use Lable.font.style'\r\n    })\r\n], Label_Label.prototype, \"fontStyle\", null);\r\nLabel_decorate([\r\n    obsolete({\r\n        message: 'Label.fontUnit will be removed in v0.26.0',\r\n        alternateMethod: 'Use Label.font.unit'\r\n    })\r\n], Label_Label.prototype, \"fontUnit\", null);\r\nLabel_decorate([\r\n    obsolete({\r\n        message: 'Label.textAlign will be removed in v0.26.0',\r\n        alternateMethod: 'Use Label.font.textAlign'\r\n    })\r\n], Label_Label.prototype, \"textAlign\", null);\r\nLabel_decorate([\r\n    obsolete({\r\n        message: 'Label.baseAlign will be removed in v0.26.0',\r\n        alternateMethod: 'Use Label.font.baseAlign'\r\n    })\r\n], Label_Label.prototype, \"baseAlign\", null);\r\nLabel_decorate([\r\n    obsolete()\r\n], Label_Label.prototype, \"spriteFont\", null);\r\nLabel_decorate([\r\n    obsolete({\r\n        message: 'Label.setTextShadow will be removed in v0.26.0',\r\n        alternateMethod: 'Use Label.font.shadow'\r\n    })\r\n], Label_Label.prototype, \"setTextShadow\", null);\r\nLabel_decorate([\r\n    obsolete({\r\n        message: 'Label.useTextShadow will be removed in v0.26.0',\r\n        alternateMethod: 'Use Label.font.shadow'\r\n    })\r\n], Label_Label.prototype, \"useTextShadow\", null);\r\nLabel_decorate([\r\n    obsolete({\r\n        message: 'Label.clearTextShadow will be removed in v0.26.0',\r\n        alternateMethod: 'Use Label.font.shadow'\r\n    })\r\n], Label_Label.prototype, \"clearTextShadow\", null);\r\n\n;// CONCATENATED MODULE: ./Actions/Index.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Collision/Group/CollisionGroupManager.ts\n\r\n/**\r\n * Static class for managing collision groups in excalibur, there is a maximum of 32 collision groups possible in excalibur\r\n */\r\nclass CollisionGroupManager {\r\n    /**\r\n     * Create a new named collision group up to a max of 32.\r\n     * @param name Name for the collision group\r\n     * @param mask Optionally provide your own 32-bit mask, if none is provide the manager will generate one\r\n     */\r\n    static create(name, mask) {\r\n        if (this._CURRENT_GROUP > this._MAX_GROUPS) {\r\n            throw new Error(`Cannot have more than ${this._MAX_GROUPS} collision groups`);\r\n        }\r\n        if (this._GROUPS.get(name)) {\r\n            throw new Error(`Collision group ${name} already exists`);\r\n        }\r\n        const group = new CollisionGroup(name, this._CURRENT_BIT, mask !== undefined ? mask : ~this._CURRENT_BIT);\r\n        this._CURRENT_BIT = (this._CURRENT_BIT << 1) | 0;\r\n        this._CURRENT_GROUP++;\r\n        this._GROUPS.set(name, group);\r\n        return group;\r\n    }\r\n    /**\r\n     * Get all collision groups currently tracked by excalibur\r\n     */\r\n    static get groups() {\r\n        return Array.from(this._GROUPS.values());\r\n    }\r\n    /**\r\n     * Get a collision group by it's name\r\n     * @param name\r\n     */\r\n    static groupByName(name) {\r\n        return this._GROUPS.get(name);\r\n    }\r\n    /**\r\n     * Resets the managers internal group management state\r\n     */\r\n    static reset() {\r\n        this._GROUPS = new Map();\r\n        this._CURRENT_BIT = this._STARTING_BIT;\r\n        this._CURRENT_GROUP = 1;\r\n    }\r\n}\r\n// using bitmasking the maximum number of groups is 32, because that is the highest 32bit integer that JS can present.\r\nCollisionGroupManager._STARTING_BIT = 0b1 | 0;\r\nCollisionGroupManager._MAX_GROUPS = 32;\r\nCollisionGroupManager._CURRENT_GROUP = 1;\r\nCollisionGroupManager._CURRENT_BIT = CollisionGroupManager._STARTING_BIT;\r\nCollisionGroupManager._GROUPS = new Map();\r\n\n;// CONCATENATED MODULE: ./Collision/Index.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Drawing/Polygon.ts\nvar Polygon_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\n\r\n/**\r\n * Creates a closed polygon drawing given a list of [[Vector]]s.\r\n *\r\n * @deprecated Use [[Polygon]]\r\n * @warning Use sparingly as Polygons are performance intensive\r\n */\r\nlet Polygon = class Polygon {\r\n    /**\r\n     * @param points  The vectors to use to build the polygon in order\r\n     */\r\n    constructor(points) {\r\n        /**\r\n         * The width of the lines of the polygon\r\n         */\r\n        this.lineWidth = 5;\r\n        /**\r\n         * Indicates whether the polygon is filled or not.\r\n         */\r\n        this.filled = false;\r\n        this._points = [];\r\n        this.anchor = Vector.Zero;\r\n        this.offset = Vector.Zero;\r\n        this.rotation = 0;\r\n        this.scale = Vector.One;\r\n        this.opacity = 1;\r\n        this._points = points;\r\n        const minX = this._points.reduce((prev, curr) => {\r\n            return Math.min(prev, curr.x);\r\n        }, 0);\r\n        const maxX = this._points.reduce((prev, curr) => {\r\n            return Math.max(prev, curr.x);\r\n        }, 0);\r\n        this.drawWidth = maxX - minX;\r\n        const minY = this._points.reduce((prev, curr) => {\r\n            return Math.min(prev, curr.y);\r\n        }, 0);\r\n        const maxY = this._points.reduce((prev, curr) => {\r\n            return Math.max(prev, curr.y);\r\n        }, 0);\r\n        this.drawHeight = maxY - minY;\r\n        this.height = this.drawHeight;\r\n        this.width = this.drawWidth;\r\n    }\r\n    /**\r\n     * @notimplemented Effects are not supported on `Polygon`\r\n     */\r\n    addEffect() {\r\n        // not supported on polygons\r\n    }\r\n    /**\r\n     * @notimplemented Effects are not supported on `Polygon`\r\n     */\r\n    removeEffect() {\r\n        // not supported on polygons\r\n    }\r\n    /**\r\n     * @notimplemented Effects are not supported on `Polygon`\r\n     */\r\n    clearEffects() {\r\n        // not supported on polygons\r\n    }\r\n    reset() {\r\n        //pass\r\n    }\r\n    draw(ctxOrOptions, x, y) {\r\n        if (ctxOrOptions instanceof CanvasRenderingContext2D) {\r\n            this._drawWithOptions({ ctx: ctxOrOptions, x, y });\r\n        }\r\n        else {\r\n            this._drawWithOptions(ctxOrOptions);\r\n        }\r\n    }\r\n    _drawWithOptions(options) {\r\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j;\r\n        const { ctx, x, y, rotation, drawWidth, drawHeight, anchor, offset, opacity, flipHorizontal, flipVertical } = Object.assign(Object.assign({}, options), { rotation: (_a = options.rotation) !== null && _a !== void 0 ? _a : this.rotation, drawWidth: (_b = options.drawWidth) !== null && _b !== void 0 ? _b : this.drawWidth, drawHeight: (_c = options.drawHeight) !== null && _c !== void 0 ? _c : this.drawHeight, flipHorizontal: (_d = options.flipHorizontal) !== null && _d !== void 0 ? _d : this.flipHorizontal, flipVertical: (_e = options.flipVertical) !== null && _e !== void 0 ? _e : this.flipVertical, anchor: (_f = options.anchor) !== null && _f !== void 0 ? _f : this.anchor, offset: (_g = options.offset) !== null && _g !== void 0 ? _g : this.offset, opacity: ((_h = options.opacity) !== null && _h !== void 0 ? _h : 1) * ((_j = this.opacity) !== null && _j !== void 0 ? _j : 1) });\r\n        const xpoint = drawWidth * anchor.x + offset.x + x;\r\n        const ypoint = drawHeight * anchor.y + offset.y + y;\r\n        ctx.save();\r\n        ctx.translate(xpoint, ypoint);\r\n        ctx.scale(this.scale.x, this.scale.y);\r\n        ctx.rotate(rotation);\r\n        ctx.beginPath();\r\n        ctx.lineWidth = this.lineWidth;\r\n        // Iterate through the supplied points and construct a 'polygon'\r\n        const firstPoint = this._points[0];\r\n        ctx.moveTo(firstPoint.x, firstPoint.y);\r\n        let i = 0;\r\n        const len = this._points.length;\r\n        for (i; i < len; i++) {\r\n            ctx.lineTo(this._points[i].x, this._points[i].y);\r\n        }\r\n        ctx.lineTo(firstPoint.x, firstPoint.y);\r\n        ctx.closePath();\r\n        if (this.filled) {\r\n            ctx.fillStyle = this.fillColor.toString();\r\n            ctx.fill();\r\n        }\r\n        ctx.strokeStyle = this.lineColor.toString();\r\n        if (flipHorizontal) {\r\n            ctx.translate(drawWidth, 0);\r\n            ctx.scale(-1, 1);\r\n        }\r\n        if (flipVertical) {\r\n            ctx.translate(0, drawHeight);\r\n            ctx.scale(1, -1);\r\n        }\r\n        const oldAlpha = ctx.globalAlpha;\r\n        ctx.globalAlpha = opacity;\r\n        ctx.stroke();\r\n        ctx.globalAlpha = oldAlpha;\r\n        ctx.restore();\r\n    }\r\n};\r\nPolygon = Polygon_decorate([\r\n    obsolete({\r\n        message: 'Polygon will be removed in v0.26.0',\r\n        alternateMethod: 'Use Graphics.Polygon'\r\n    })\r\n], Polygon);\r\n\r\n\n;// CONCATENATED MODULE: ./Drawing/Index.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Interfaces/AudioImplementation.ts\nclass ExResponse {\r\n}\r\nExResponse.type = {\r\n    any: '',\r\n    blob: 'blob',\r\n    json: 'json',\r\n    text: 'text',\r\n    document: 'document',\r\n    arraybuffer: 'arraybuffer'\r\n};\r\n\n;// CONCATENATED MODULE: ./Interfaces/LifecycleEvents.ts\n/**\r\n * Type guard checking for internal initialize method\r\n * @internal\r\n * @param a\r\n */\r\nfunction has_initialize(a) {\r\n    return !!a._initialize;\r\n}\r\n/**\r\n *\r\n */\r\nfunction hasOnInitialize(a) {\r\n    return !!a.onInitialize;\r\n}\r\n/**\r\n *\r\n */\r\nfunction has_preupdate(a) {\r\n    return !!a._preupdate;\r\n}\r\n/**\r\n *\r\n */\r\nfunction hasOnPreUpdate(a) {\r\n    return !!a.onPreUpdate;\r\n}\r\n/**\r\n *\r\n */\r\nfunction has_postupdate(a) {\r\n    return !!a.onPostUpdate;\r\n}\r\n/**\r\n *\r\n */\r\nfunction hasOnPostUpdate(a) {\r\n    return !!a.onPostUpdate;\r\n}\r\n/**\r\n *\r\n */\r\nfunction hasPreDraw(a) {\r\n    return !!a.onPreDraw;\r\n}\r\n/**\r\n *\r\n */\r\nfunction hasPostDraw(a) {\r\n    return !!a.onPostDraw;\r\n}\r\n\n;// CONCATENATED MODULE: ./Interfaces/Index.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./PostProcessing/Index.ts\n\r\n\r\n\n;// CONCATENATED MODULE: ./Resources/Sound/WebAudioInstance.ts\n\r\n\r\n/**\r\n * Internal class representing a Web Audio AudioBufferSourceNode instance\r\n * @see https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API\r\n */\r\nclass WebAudioInstance {\r\n    constructor(_src) {\r\n        this._src = _src;\r\n        this._volume = 1;\r\n        this._duration = undefined;\r\n        this._loop = false;\r\n        this._isPlaying = false;\r\n        this._isPaused = false;\r\n        this._audioContext = AudioContextFactory.create();\r\n        this._volumeNode = this._audioContext.createGain();\r\n        /**\r\n         * Current playback offset (in seconds)\r\n         */\r\n        this._currentOffset = 0;\r\n        this._createNewBufferSource();\r\n    }\r\n    set loop(value) {\r\n        this._loop = value;\r\n        if (this._instance) {\r\n            this._instance.loop = value;\r\n            this._wireUpOnEnded();\r\n        }\r\n    }\r\n    get loop() {\r\n        return this._loop;\r\n    }\r\n    set volume(value) {\r\n        value = clamp(value, 0, 1.0);\r\n        this._volume = value;\r\n        if (this._isPlaying && this._volumeNode.gain.setTargetAtTime) {\r\n            // https://developer.mozilla.org/en-US/docs/Web/API/AudioParam/setTargetAtTime\r\n            // After each .1 seconds timestep, the target value will ~63.2% closer to the target value.\r\n            // This exponential ramp provides a more pleasant transition in gain\r\n            this._volumeNode.gain.setTargetAtTime(value, this._audioContext.currentTime, 0.1);\r\n        }\r\n        else {\r\n            this._volumeNode.gain.value = value;\r\n        }\r\n    }\r\n    get volume() {\r\n        return this._volume;\r\n    }\r\n    set duration(value) {\r\n        this._duration = value;\r\n    }\r\n    /**\r\n     * Duration of the sound, in seconds.\r\n     */\r\n    get duration() {\r\n        return this._duration;\r\n    }\r\n    get _playbackRate() {\r\n        return this._instance ? 1 / (this._instance.playbackRate.value || 1.0) : null;\r\n    }\r\n    isPlaying() {\r\n        return this._isPlaying;\r\n    }\r\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\r\n    play(playStarted = () => { }) {\r\n        if (this._isPaused) {\r\n            this._resumePlayBack();\r\n            playStarted();\r\n        }\r\n        if (!this._isPlaying) {\r\n            this._startPlayBack();\r\n            playStarted();\r\n        }\r\n        return this._playingPromise;\r\n    }\r\n    pause() {\r\n        if (!this._isPlaying) {\r\n            return;\r\n        }\r\n        this._isPaused = true;\r\n        this._isPlaying = false;\r\n        this._instance.stop(0);\r\n        // Playback rate will be a scale factor of how fast/slow the audio is being played\r\n        // default is 1.0\r\n        // we need to invert it to get the time scale\r\n        this._setPauseOffset();\r\n    }\r\n    stop() {\r\n        if (!this._isPlaying) {\r\n            return;\r\n        }\r\n        this._isPlaying = false;\r\n        this._isPaused = false;\r\n        this._currentOffset = 0;\r\n        this._instance.stop(0);\r\n        // handler will not be wired up if we were looping\r\n        if (!this._instance.onended) {\r\n            this._handleOnEnded();\r\n        }\r\n    }\r\n    _startPlayBack() {\r\n        this._isPlaying = true;\r\n        this._isPaused = false;\r\n        this._playingPromise = new Promise((resolve) => {\r\n            this._playingResolve = resolve;\r\n        });\r\n        if (!this._instance) {\r\n            this._createNewBufferSource();\r\n        }\r\n        this._rememberStartTime();\r\n        this._volumeNode.connect(this._audioContext.destination);\r\n        this._instance.start(0, 0);\r\n        this._currentOffset = 0;\r\n        this._wireUpOnEnded();\r\n    }\r\n    _resumePlayBack() {\r\n        if (!this._isPaused) {\r\n            return;\r\n        }\r\n        this._isPaused = false;\r\n        this._isPlaying = true;\r\n        // a buffer source can only be started once\r\n        // so we need to dispose of the previous instance before\r\n        // \"resuming\" the next one\r\n        this._instance.onended = null; // dispose of any previous event handler\r\n        this._createNewBufferSource();\r\n        const duration = this._playbackRate * this._src.duration;\r\n        const restartTime = this._currentOffset % duration;\r\n        this._rememberStartTime(restartTime * -1000);\r\n        this._instance.start(0, restartTime);\r\n        this._wireUpOnEnded();\r\n    }\r\n    _wireUpOnEnded() {\r\n        if (!this.loop) {\r\n            this._instance.onended = () => this._handleOnEnded();\r\n        }\r\n    }\r\n    _handleOnEnded() {\r\n        // pausing calls stop(0) which triggers onended event\r\n        // so we don't \"resolve\" yet (when we resume we'll try again)\r\n        if (!this._isPaused) {\r\n            this._isPlaying = false;\r\n            this._playingResolve(true);\r\n        }\r\n    }\r\n    _rememberStartTime(amend) {\r\n        this._startTime = new Date().getTime() + (amend | 0);\r\n    }\r\n    _setPauseOffset() {\r\n        this._currentOffset = ((new Date().getTime() - this._startTime) * this._playbackRate) / 1000; // in seconds\r\n    }\r\n    _createNewBufferSource() {\r\n        this._instance = this._audioContext.createBufferSource();\r\n        this._instance.buffer = this._src;\r\n        this._instance.loop = this.loop;\r\n        this._instance.playbackRate.setValueAtTime(1.0, 0);\r\n        this._instance.connect(this._volumeNode);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Sound.ts\n\r\n/**\r\n * Whether or not the browser can play this file as HTML5 Audio\r\n */\r\nfunction canPlayFile(file) {\r\n    try {\r\n        const a = new Audio();\r\n        const filetype = /.*\\.([A-Za-z0-9]+)$/;\r\n        const type = file.match(filetype)[1];\r\n        if (a.canPlayType('audio/' + type)) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    catch (e) {\r\n        Logger.getInstance().warn('Cannot determine audio support, assuming no support for the Audio Tag', e);\r\n        return false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Resources/Sound/Sound.ts\nvar Sound_awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * The [[Sound]] object allows games built in Excalibur to load audio\r\n * components, from soundtracks to sound effects. [[Sound]] is an [[Loadable]]\r\n * which means it can be passed to a [[Loader]] to pre-load before a game or level.\r\n */\r\nclass Sound extends Class {\r\n    /**\r\n     * @param paths A list of audio sources (clip.wav, clip.mp3, clip.ogg) for this audio clip. This is done for browser compatibility.\r\n     */\r\n    constructor(...paths) {\r\n        super();\r\n        this.logger = Logger.getInstance();\r\n        this._loop = false;\r\n        this._volume = 1;\r\n        this._duration = undefined;\r\n        this._isStopped = false;\r\n        this._isPaused = false;\r\n        this._tracks = [];\r\n        this._wasPlayingOnHidden = false;\r\n        this._audioContext = AudioContextFactory.create();\r\n        this._resource = new Resource('', ExResponse.type.arraybuffer);\r\n        /**\r\n         * Chrome : MP3, WAV, Ogg\r\n         * Firefox : WAV, Ogg,\r\n         * IE : MP3, WAV coming soon\r\n         * Safari MP3, WAV, Ogg\r\n         */\r\n        for (const path of paths) {\r\n            if (canPlayFile(path)) {\r\n                this.path = path;\r\n                break;\r\n            }\r\n        }\r\n        if (!this.path) {\r\n            this.logger.warn('This browser does not support any of the audio files specified:', paths.join(', '));\r\n            this.logger.warn('Attempting to use', paths[0]);\r\n            this.path = paths[0]; // select the first specified\r\n        }\r\n    }\r\n    /**\r\n     * Indicates whether the clip should loop when complete\r\n     * @param value  Set the looping flag\r\n     */\r\n    set loop(value) {\r\n        this._loop = value;\r\n        for (const track of this._tracks) {\r\n            track.loop = this._loop;\r\n        }\r\n        this.logger.debug('Set loop for all instances of sound', this.path, 'to', this._loop);\r\n    }\r\n    get loop() {\r\n        return this._loop;\r\n    }\r\n    set volume(value) {\r\n        this._volume = value;\r\n        for (const track of this._tracks) {\r\n            track.volume = this._volume;\r\n        }\r\n        this.emit('volumechange', new NativeSoundEvent(this));\r\n        this.logger.debug('Set loop for all instances of sound', this.path, 'to', this._volume);\r\n    }\r\n    get volume() {\r\n        return this._volume;\r\n    }\r\n    get duration() {\r\n        return this._duration;\r\n    }\r\n    /**\r\n     * Return array of Current AudioInstances playing or being paused\r\n     */\r\n    get instances() {\r\n        return this._tracks;\r\n    }\r\n    get path() {\r\n        return this._resource.path;\r\n    }\r\n    set path(val) {\r\n        this._resource.path = val;\r\n    }\r\n    isLoaded() {\r\n        return !!this.data;\r\n    }\r\n    load() {\r\n        return Sound_awaiter(this, void 0, void 0, function* () {\r\n            if (this.data) {\r\n                return this.data;\r\n            }\r\n            const arraybuffer = yield this._resource.load();\r\n            const audiobuffer = yield this.decodeAudio(arraybuffer.slice(0));\r\n            this._duration = typeof audiobuffer === 'object' ? audiobuffer.duration : undefined;\r\n            this.emit('processed', new NativeSoundProcessedEvent(this, audiobuffer));\r\n            return this.data = audiobuffer;\r\n        });\r\n    }\r\n    decodeAudio(data) {\r\n        return Sound_awaiter(this, void 0, void 0, function* () {\r\n            try {\r\n                return yield this._audioContext.decodeAudioData(data.slice(0));\r\n            }\r\n            catch (e) {\r\n                this.logger.error('Unable to decode ' +\r\n                    ' this browser may not fully support this format, or the file may be corrupt, ' +\r\n                    'if this is an mp3 try removing id3 tags and album art from the file.');\r\n                return yield Promise.reject();\r\n            }\r\n        });\r\n    }\r\n    wireEngine(engine) {\r\n        if (engine) {\r\n            this._engine = engine;\r\n            this._engine.on('hidden', () => {\r\n                if (engine.pauseAudioWhenHidden && this.isPlaying()) {\r\n                    this._wasPlayingOnHidden = true;\r\n                    this.pause();\r\n                }\r\n            });\r\n            this._engine.on('visible', () => {\r\n                if (engine.pauseAudioWhenHidden && this._wasPlayingOnHidden) {\r\n                    this.play();\r\n                    this._wasPlayingOnHidden = false;\r\n                }\r\n            });\r\n            this._engine.on('start', () => {\r\n                this._isStopped = false;\r\n            });\r\n            this._engine.on('stop', () => {\r\n                this.stop();\r\n                this._isStopped = true;\r\n            });\r\n        }\r\n    }\r\n    /**\r\n     * Returns how many instances of the sound are currently playing\r\n     */\r\n    instanceCount() {\r\n        return this._tracks.length;\r\n    }\r\n    /**\r\n     * Whether or not the sound is playing right now\r\n     */\r\n    isPlaying() {\r\n        return this._tracks.some((t) => t.isPlaying());\r\n    }\r\n    /**\r\n     * Play the sound, returns a promise that resolves when the sound is done playing\r\n     * An optional volume argument can be passed in to play the sound. Max volume is 1.0\r\n     */\r\n    play(volume) {\r\n        if (!this.isLoaded()) {\r\n            this.logger.warn('Cannot start playing. Resource', this.path, 'is not loaded yet');\r\n            return Promise.resolve(true);\r\n        }\r\n        if (this._isStopped) {\r\n            this.logger.warn('Cannot start playing. Engine is in a stopped state.');\r\n            return Promise.resolve(false);\r\n        }\r\n        this.volume = volume || this.volume;\r\n        if (this._isPaused) {\r\n            return this._resumePlayback();\r\n        }\r\n        else {\r\n            return this._startPlayback();\r\n        }\r\n    }\r\n    /**\r\n     * Stop the sound, and do not rewind\r\n     */\r\n    pause() {\r\n        if (!this.isPlaying()) {\r\n            return;\r\n        }\r\n        for (const track of this._tracks) {\r\n            track.pause();\r\n        }\r\n        this._isPaused = true;\r\n        this.emit('pause', new NativeSoundEvent(this));\r\n        this.logger.debug('Paused all instances of sound', this.path);\r\n    }\r\n    /**\r\n     * Stop the sound if it is currently playing and rewind the track. If the sound is not playing, rewinds the track.\r\n     */\r\n    stop() {\r\n        for (const track of this._tracks) {\r\n            track.stop();\r\n        }\r\n        this.emit('stop', new NativeSoundEvent(this));\r\n        this._isPaused = false;\r\n        this._tracks.length = 0;\r\n        this.logger.debug('Stopped all instances of sound', this.path);\r\n    }\r\n    /**\r\n     * Get Id of provided AudioInstance in current trackList\r\n     * @param track [[Audio]] which Id is to be given\r\n     */\r\n    getTrackId(track) {\r\n        return this._tracks.indexOf(track);\r\n    }\r\n    _resumePlayback() {\r\n        return Sound_awaiter(this, void 0, void 0, function* () {\r\n            if (this._isPaused) {\r\n                const resumed = [];\r\n                // ensure we resume *current* tracks (if paused)\r\n                for (const track of this._tracks) {\r\n                    resumed.push(track.play());\r\n                }\r\n                this._isPaused = false;\r\n                this.emit('resume', new NativeSoundEvent(this));\r\n                this.logger.debug('Resuming paused instances for sound', this.path, this._tracks);\r\n                // resolve when resumed tracks are done\r\n                yield Promise.all(resumed);\r\n            }\r\n            return true;\r\n        });\r\n    }\r\n    /**\r\n     * Starts playback, returns a promise that resolves when playback is complete\r\n     */\r\n    _startPlayback() {\r\n        return Sound_awaiter(this, void 0, void 0, function* () {\r\n            const track = yield this._getTrackInstance(this.data);\r\n            const complete = yield track.play(() => {\r\n                this.emit('playbackstart', new NativeSoundEvent(this, track));\r\n                this.logger.debug('Playing new instance for sound', this.path);\r\n            });\r\n            // when done, remove track\r\n            this.emit('playbackend', new NativeSoundEvent(this, track));\r\n            this._tracks.splice(this.getTrackId(track), 1);\r\n            return complete;\r\n        });\r\n    }\r\n    _getTrackInstance(data) {\r\n        const newTrack = new WebAudioInstance(data);\r\n        newTrack.loop = this.loop;\r\n        newTrack.volume = this.volume;\r\n        newTrack.duration = this.duration;\r\n        this._tracks.push(newTrack);\r\n        return newTrack;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Resources/Sound/Index.ts\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Resources/Gif.ts\nvar Gif_awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * The [[Texture]] object allows games built in Excalibur to load image resources.\r\n * [[Texture]] is an [[Loadable]] which means it can be passed to a [[Loader]]\r\n * to pre-load before starting a level or game.\r\n */\r\nclass Gif {\r\n    /**\r\n     * @param path       Path to the image resource\r\n     * @param color      Optionally set the color to treat as transparent the gif, by default [[Color.Magenta]]\r\n     * @param bustCache  Optionally load texture with cache busting\r\n     */\r\n    constructor(path, color = Color.Magenta, bustCache = true) {\r\n        this.path = path;\r\n        this.color = color;\r\n        this.bustCache = bustCache;\r\n        this._stream = null;\r\n        this._gif = null;\r\n        this._textures = [];\r\n        this._animation = null;\r\n        this._transparentColor = null;\r\n        this._resource = new Resource(path, 'arraybuffer', bustCache);\r\n        this._transparentColor = color;\r\n    }\r\n    /**\r\n     * Begins loading the texture and returns a promise to be resolved on completion\r\n     */\r\n    load() {\r\n        return Gif_awaiter(this, void 0, void 0, function* () {\r\n            const arraybuffer = yield this._resource.load();\r\n            this._stream = new Stream(arraybuffer);\r\n            this._gif = new ParseGif(this._stream, this._transparentColor);\r\n            const images = this._gif.images.map(i => new ImageSource(i.src, false));\r\n            // Load all textures\r\n            yield Promise.all(images.map(t => t.load()));\r\n            return this.data = this._textures = images;\r\n        });\r\n    }\r\n    isLoaded() {\r\n        return !!this.data;\r\n    }\r\n    /**\r\n     * Return a frame of the gif as a legacy sprite by index\r\n     * @deprecated\r\n     */\r\n    toLegacySprite(id = 0) {\r\n        return Sprite.toLegacySprite(this.toSprite(id));\r\n    }\r\n    /**\r\n     * Return the gif as a legacy spritesheet\r\n     * @deprecated\r\n     * @returns\r\n     */\r\n    toLegacySpriteSheet() {\r\n        return SpriteSheet.toLegacySpriteSheet(this.toSpriteSheet());\r\n    }\r\n    /**\r\n     * Return the gif as a legacy animation\r\n     * @deprecated\r\n     * @param speed\r\n     */\r\n    toLegacyAnimation(engine, speed) {\r\n        return Animation.toLegacyAnimation(engine, this.toAnimation(speed));\r\n    }\r\n    /**\r\n     * Return a frame of the gif as a sprite by id\r\n     * @param id\r\n     */\r\n    toSprite(id = 0) {\r\n        const sprite = this._textures[id].toSprite();\r\n        return sprite;\r\n    }\r\n    /**\r\n     * Return the gif as a spritesheet\r\n     */\r\n    toSpriteSheet() {\r\n        const sprites = this._textures.map((image) => {\r\n            return image.toSprite();\r\n        });\r\n        return new SpriteSheet({ sprites });\r\n    }\r\n    /**\r\n     * Transform the GIF into an animation with duration per frame\r\n     */\r\n    toAnimation(durationPerFrameMs) {\r\n        const spriteSheet = this.toSpriteSheet();\r\n        const length = spriteSheet.sprites.length;\r\n        this._animation = Animation.fromSpriteSheet(spriteSheet, range(0, length), durationPerFrameMs);\r\n        return this._animation;\r\n    }\r\n    get readCheckBytes() {\r\n        return this._gif.checkBytes;\r\n    }\r\n}\r\nconst bitsToNum = (ba) => {\r\n    return ba.reduce(function (s, n) {\r\n        return s * 2 + n;\r\n    }, 0);\r\n};\r\nconst byteToBitArr = (bite) => {\r\n    const a = [];\r\n    for (let i = 7; i >= 0; i--) {\r\n        a.push(!!(bite & (1 << i)));\r\n    }\r\n    return a;\r\n};\r\nclass Stream {\r\n    constructor(dataArray) {\r\n        this.data = null;\r\n        this.len = 0;\r\n        this.position = 0;\r\n        this.readByte = () => {\r\n            if (this.position >= this.data.byteLength) {\r\n                throw new Error('Attempted to read past end of stream.');\r\n            }\r\n            return this.data[this.position++];\r\n        };\r\n        this.readBytes = (n) => {\r\n            const bytes = [];\r\n            for (let i = 0; i < n; i++) {\r\n                bytes.push(this.readByte());\r\n            }\r\n            return bytes;\r\n        };\r\n        this.read = (n) => {\r\n            let s = '';\r\n            for (let i = 0; i < n; i++) {\r\n                s += String.fromCharCode(this.readByte());\r\n            }\r\n            return s;\r\n        };\r\n        this.readUnsigned = () => {\r\n            // Little-endian.\r\n            const a = this.readBytes(2);\r\n            return (a[1] << 8) + a[0];\r\n        };\r\n        this.data = new Uint8Array(dataArray);\r\n        this.len = this.data.byteLength;\r\n        if (this.len === 0) {\r\n            throw new Error('No data loaded from file');\r\n        }\r\n    }\r\n}\r\nconst lzwDecode = function (minCodeSize, data) {\r\n    // TODO: Now that the GIF parser is a bit different, maybe this should get an array of bytes instead of a String?\r\n    let pos = 0; // Maybe this streaming thing should be merged with the Stream?\r\n    const readCode = function (size) {\r\n        let code = 0;\r\n        for (let i = 0; i < size; i++) {\r\n            if (data.charCodeAt(pos >> 3) & (1 << (pos & 7))) {\r\n                code |= 1 << i;\r\n            }\r\n            pos++;\r\n        }\r\n        return code;\r\n    };\r\n    const output = [];\r\n    const clearCode = 1 << minCodeSize;\r\n    const eoiCode = clearCode + 1;\r\n    let codeSize = minCodeSize + 1;\r\n    let dict = [];\r\n    const clear = function () {\r\n        dict = [];\r\n        codeSize = minCodeSize + 1;\r\n        for (let i = 0; i < clearCode; i++) {\r\n            dict[i] = [i];\r\n        }\r\n        dict[clearCode] = [];\r\n        dict[eoiCode] = null;\r\n    };\r\n    let code;\r\n    let last;\r\n    while (true) {\r\n        last = code;\r\n        code = readCode(codeSize);\r\n        if (code === clearCode) {\r\n            clear();\r\n            continue;\r\n        }\r\n        if (code === eoiCode) {\r\n            break;\r\n        }\r\n        if (code < dict.length) {\r\n            if (last !== clearCode) {\r\n                dict.push(dict[last].concat(dict[code][0]));\r\n            }\r\n        }\r\n        else {\r\n            if (code !== dict.length) {\r\n                throw new Error('Invalid LZW code.');\r\n            }\r\n            dict.push(dict[last].concat(dict[last][0]));\r\n        }\r\n        output.push.apply(output, dict[code]);\r\n        if (dict.length === 1 << codeSize && codeSize < 12) {\r\n            // If we're at the last code and codeSize is 12, the next code will be a clearCode, and it'll be 12 bits long.\r\n            codeSize++;\r\n        }\r\n    }\r\n    // I don't know if this is technically an error, but some GIFs do it.\r\n    //if (Math.ceil(pos / 8) !== data.length) throw new Error('Extraneous LZW bytes.');\r\n    return output;\r\n};\r\n// The actual parsing; returns an object with properties.\r\nclass ParseGif {\r\n    constructor(stream, color = Color.Magenta) {\r\n        this._st = null;\r\n        this._handler = {};\r\n        this._transparentColor = null;\r\n        this.frames = [];\r\n        this.images = [];\r\n        this.globalColorTable = [];\r\n        this.checkBytes = [];\r\n        // LZW (GIF-specific)\r\n        this.parseColorTable = (entries) => {\r\n            // Each entry is 3 bytes, for RGB.\r\n            const ct = [];\r\n            for (let i = 0; i < entries; i++) {\r\n                const rgb = this._st.readBytes(3);\r\n                const rgba = '#' +\r\n                    rgb\r\n                        .map((x) => {\r\n                        const hex = x.toString(16);\r\n                        return hex.length === 1 ? '0' + hex : hex;\r\n                    })\r\n                        .join('');\r\n                ct.push(rgba);\r\n            }\r\n            return ct;\r\n        };\r\n        this.readSubBlocks = () => {\r\n            let size, data;\r\n            data = '';\r\n            do {\r\n                size = this._st.readByte();\r\n                data += this._st.read(size);\r\n            } while (size !== 0);\r\n            return data;\r\n        };\r\n        this.parseHeader = () => {\r\n            const hdr = {\r\n                sig: null,\r\n                ver: null,\r\n                width: null,\r\n                height: null,\r\n                colorRes: null,\r\n                globalColorTableSize: null,\r\n                gctFlag: null,\r\n                sorted: null,\r\n                globalColorTable: [],\r\n                bgColor: null,\r\n                pixelAspectRatio: null // if not 0, aspectRatio = (pixelAspectRatio + 15) / 64\r\n            };\r\n            hdr.sig = this._st.read(3);\r\n            hdr.ver = this._st.read(3);\r\n            if (hdr.sig !== 'GIF') {\r\n                throw new Error('Not a GIF file.'); // XXX: This should probably be handled more nicely.\r\n            }\r\n            hdr.width = this._st.readUnsigned();\r\n            hdr.height = this._st.readUnsigned();\r\n            const bits = byteToBitArr(this._st.readByte());\r\n            hdr.gctFlag = bits.shift();\r\n            hdr.colorRes = bitsToNum(bits.splice(0, 3));\r\n            hdr.sorted = bits.shift();\r\n            hdr.globalColorTableSize = bitsToNum(bits.splice(0, 3));\r\n            hdr.bgColor = this._st.readByte();\r\n            hdr.pixelAspectRatio = this._st.readByte(); // if not 0, aspectRatio = (pixelAspectRatio + 15) / 64\r\n            if (hdr.gctFlag) {\r\n                hdr.globalColorTable = this.parseColorTable(1 << (hdr.globalColorTableSize + 1));\r\n                this.globalColorTable = hdr.globalColorTable;\r\n            }\r\n            if (this._handler.hdr && this._handler.hdr(hdr)) {\r\n                this.checkBytes.push(this._handler.hdr);\r\n            }\r\n        };\r\n        this.parseExt = (block) => {\r\n            const parseGCExt = (block) => {\r\n                this.checkBytes.push(this._st.readByte()); // Always 4\r\n                const bits = byteToBitArr(this._st.readByte());\r\n                block.reserved = bits.splice(0, 3); // Reserved; should be 000.\r\n                block.disposalMethod = bitsToNum(bits.splice(0, 3));\r\n                block.userInput = bits.shift();\r\n                block.transparencyGiven = bits.shift();\r\n                block.delayTime = this._st.readUnsigned();\r\n                block.transparencyIndex = this._st.readByte();\r\n                block.terminator = this._st.readByte();\r\n                if (this._handler.gce && this._handler.gce(block)) {\r\n                    this.checkBytes.push(this._handler.gce);\r\n                }\r\n            };\r\n            const parseComExt = (block) => {\r\n                block.comment = this.readSubBlocks();\r\n                if (this._handler.com && this._handler.com(block)) {\r\n                    this.checkBytes.push(this._handler.com);\r\n                }\r\n            };\r\n            const parsePTExt = (block) => {\r\n                this.checkBytes.push(this._st.readByte()); // Always 12\r\n                block.ptHeader = this._st.readBytes(12);\r\n                block.ptData = this.readSubBlocks();\r\n                if (this._handler.pte && this._handler.pte(block)) {\r\n                    this.checkBytes.push(this._handler.pte);\r\n                }\r\n            };\r\n            const parseAppExt = (block) => {\r\n                const parseNetscapeExt = (block) => {\r\n                    this.checkBytes.push(this._st.readByte()); // Always 3\r\n                    block.unknown = this._st.readByte(); // Q: Always 1? What is this?\r\n                    block.iterations = this._st.readUnsigned();\r\n                    block.terminator = this._st.readByte();\r\n                    if (this._handler.app && this._handler.app.NETSCAPE && this._handler.app.NETSCAPE(block)) {\r\n                        this.checkBytes.push(this._handler.app);\r\n                    }\r\n                };\r\n                const parseUnknownAppExt = (block) => {\r\n                    block.appData = this.readSubBlocks();\r\n                    // FIXME: This won't work if a handler wants to match on any identifier.\r\n                    if (this._handler.app && this._handler.app[block.identifier] && this._handler.app[block.identifier](block)) {\r\n                        this.checkBytes.push(this._handler.app[block.identifier]);\r\n                    }\r\n                };\r\n                this.checkBytes.push(this._st.readByte()); // Always 11\r\n                block.identifier = this._st.read(8);\r\n                block.authCode = this._st.read(3);\r\n                switch (block.identifier) {\r\n                    case 'NETSCAPE':\r\n                        parseNetscapeExt(block);\r\n                        break;\r\n                    default:\r\n                        parseUnknownAppExt(block);\r\n                        break;\r\n                }\r\n            };\r\n            const parseUnknownExt = (block) => {\r\n                block.data = this.readSubBlocks();\r\n                if (this._handler.unknown && this._handler.unknown(block)) {\r\n                    this.checkBytes.push(this._handler.unknown);\r\n                }\r\n            };\r\n            block.label = this._st.readByte();\r\n            switch (block.label) {\r\n                case 0xf9:\r\n                    block.extType = 'gce';\r\n                    parseGCExt(block);\r\n                    break;\r\n                case 0xfe:\r\n                    block.extType = 'com';\r\n                    parseComExt(block);\r\n                    break;\r\n                case 0x01:\r\n                    block.extType = 'pte';\r\n                    parsePTExt(block);\r\n                    break;\r\n                case 0xff:\r\n                    block.extType = 'app';\r\n                    parseAppExt(block);\r\n                    break;\r\n                default:\r\n                    block.extType = 'unknown';\r\n                    parseUnknownExt(block);\r\n                    break;\r\n            }\r\n        };\r\n        this.parseImg = (img) => {\r\n            const deinterlace = (pixels, width) => {\r\n                // Of course this defeats the purpose of interlacing. And it's *probably*\r\n                // the least efficient way it's ever been implemented. But nevertheless...\r\n                const newPixels = new Array(pixels.length);\r\n                const rows = pixels.length / width;\r\n                const cpRow = (toRow, fromRow) => {\r\n                    const fromPixels = pixels.slice(fromRow * width, (fromRow + 1) * width);\r\n                    newPixels.splice.apply(newPixels, [toRow * width, width].concat(fromPixels));\r\n                };\r\n                const offsets = [0, 4, 2, 1];\r\n                const steps = [8, 8, 4, 2];\r\n                let fromRow = 0;\r\n                for (let pass = 0; pass < 4; pass++) {\r\n                    for (let toRow = offsets[pass]; toRow < rows; toRow += steps[pass]) {\r\n                        cpRow(toRow, fromRow);\r\n                        fromRow++;\r\n                    }\r\n                }\r\n                return newPixels;\r\n            };\r\n            img.leftPos = this._st.readUnsigned();\r\n            img.topPos = this._st.readUnsigned();\r\n            img.width = this._st.readUnsigned();\r\n            img.height = this._st.readUnsigned();\r\n            const bits = byteToBitArr(this._st.readByte());\r\n            img.lctFlag = bits.shift();\r\n            img.interlaced = bits.shift();\r\n            img.sorted = bits.shift();\r\n            img.reserved = bits.splice(0, 2);\r\n            img.lctSize = bitsToNum(bits.splice(0, 3));\r\n            if (img.lctFlag) {\r\n                img.lct = this.parseColorTable(1 << (img.lctSize + 1));\r\n            }\r\n            img.lzwMinCodeSize = this._st.readByte();\r\n            const lzwData = this.readSubBlocks();\r\n            img.pixels = lzwDecode(img.lzwMinCodeSize, lzwData);\r\n            if (img.interlaced) {\r\n                // Move\r\n                img.pixels = deinterlace(img.pixels, img.width);\r\n            }\r\n            this.frames.push(img);\r\n            this.arrayToImage(img);\r\n            if (this._handler.img && this._handler.img(img)) {\r\n                this.checkBytes.push(this._handler);\r\n            }\r\n        };\r\n        this.parseBlock = () => {\r\n            const block = {\r\n                sentinel: this._st.readByte(),\r\n                type: ''\r\n            };\r\n            const blockChar = String.fromCharCode(block.sentinel);\r\n            switch (blockChar) {\r\n                case '!':\r\n                    block.type = 'ext';\r\n                    this.parseExt(block);\r\n                    break;\r\n                case ',':\r\n                    block.type = 'img';\r\n                    this.parseImg(block);\r\n                    break;\r\n                case ';':\r\n                    block.type = 'eof';\r\n                    if (this._handler.eof && this._handler.eof(block)) {\r\n                        this.checkBytes.push(this._handler.eof);\r\n                    }\r\n                    break;\r\n                default:\r\n                    throw new Error('Unknown block: 0x' + block.sentinel.toString(16));\r\n            }\r\n            if (block.type !== 'eof') {\r\n                this.parseBlock();\r\n            }\r\n        };\r\n        this.arrayToImage = (frame) => {\r\n            let count = 0;\r\n            const c = document.createElement('canvas');\r\n            c.id = count.toString();\r\n            c.width = frame.width;\r\n            c.height = frame.height;\r\n            count++;\r\n            const context = c.getContext('2d');\r\n            const pixSize = 1;\r\n            let y = 0;\r\n            let x = 0;\r\n            for (let i = 0; i < frame.pixels.length; i++) {\r\n                if (x % frame.width === 0) {\r\n                    y++;\r\n                    x = 0;\r\n                }\r\n                if (this.globalColorTable[frame.pixels[i]] === this._transparentColor.toHex()) {\r\n                    context.fillStyle = `rgba(0, 0, 0, 0)`;\r\n                }\r\n                else {\r\n                    context.fillStyle = this.globalColorTable[frame.pixels[i]];\r\n                }\r\n                context.fillRect(x, y, pixSize, pixSize);\r\n                x++;\r\n            }\r\n            const img = new Image();\r\n            img.src = c.toDataURL();\r\n            this.images.push(img);\r\n        };\r\n        this._st = stream;\r\n        this._handler = {};\r\n        this._transparentColor = color;\r\n        this.parseHeader();\r\n        this.parseBlock();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Resources/Index.ts\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/index.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Graphics/Polygon.ts\n\r\n\r\n/**\r\n * A polygon [[Graphic]] for drawing arbitrary polygons to the [[ExcaliburGraphicsContext]]\r\n */\r\nclass Polygon_Polygon extends Raster {\r\n    constructor(options) {\r\n        super(options);\r\n        this.points = options.points;\r\n        this.rasterize();\r\n    }\r\n    get points() {\r\n        return this._points;\r\n    }\r\n    set points(points) {\r\n        this._points = points;\r\n        const min = this.minPoint;\r\n        this.width = this._points.reduce((max, p) => Math.max(p.x, max), 0) - min.x;\r\n        this.height = this._points.reduce((max, p) => Math.max(p.y, max), 0) - min.y;\r\n        this.flagDirty();\r\n    }\r\n    get minPoint() {\r\n        const minX = this._points.reduce((min, p) => Math.min(p.x, min), Infinity);\r\n        const minY = this._points.reduce((min, p) => Math.min(p.y, min), Infinity);\r\n        return vec(minX, minY);\r\n    }\r\n    clone() {\r\n        return new Polygon_Polygon(Object.assign(Object.assign({ points: this.points.map((p) => p.clone()) }, this.cloneGraphicOptions()), this.cloneRasterOptions()));\r\n    }\r\n    execute(ctx) {\r\n        if (this.points && this.points.length) {\r\n            ctx.beginPath();\r\n            // Iterate through the supplied points and construct a 'polygon'\r\n            const min = this.minPoint.negate();\r\n            const firstPoint = this.points[0].add(min);\r\n            ctx.moveTo(firstPoint.x, firstPoint.y);\r\n            this.points.forEach((point) => {\r\n                ctx.lineTo(point.x + min.x, point.y + min.y);\r\n            });\r\n            ctx.lineTo(firstPoint.x, firstPoint.y);\r\n            ctx.closePath();\r\n            if (this.color) {\r\n                ctx.fill();\r\n            }\r\n            if (this.strokeColor) {\r\n                ctx.stroke();\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/index.ts\n// Graphics\r\n\r\n\r\n\r\n\r\n\r\n\r\n// Graphics ECS\r\n\r\n\r\n// Raster graphics\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Input/Index.ts\n/**\r\n * @module\r\n * Provides support for mice, keyboards, and controllers.\r\n */\r\n/**\r\n * @typedoc\r\n */\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Traits/Index.ts\n/**\r\n * @module\r\n */\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Util/Index.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Util/SortedList.ts\nvar SortedList_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\n/**\r\n * A sorted list implementation. NOTE: this implementation is not self-balancing\r\n * @deprecated WIll be removed in v0.26.0 Use built in JS array.sort\r\n */\r\nlet SortedList = class SortedList {\r\n    constructor(getComparable) {\r\n        this._getComparable = getComparable;\r\n    }\r\n    find(element) {\r\n        return this._find(this._root, element);\r\n    }\r\n    _find(node, element) {\r\n        if (node == null) {\r\n            return false;\r\n        }\r\n        else if (this._getComparable(element) === node.getKey()) {\r\n            if (node.getData().indexOf(element) > -1) {\r\n                return true;\r\n            }\r\n            else {\r\n                return false;\r\n            }\r\n        }\r\n        else if (this._getComparable(element) < node.getKey()) {\r\n            return this._find(node.getLeft(), element);\r\n        }\r\n        else {\r\n            return this._find(node.getRight(), element);\r\n        }\r\n    }\r\n    // returns the array of elements at a specific key value\r\n    get(key) {\r\n        return this._get(this._root, key);\r\n    }\r\n    _get(node, key) {\r\n        if (node == null) {\r\n            return [];\r\n        }\r\n        else if (key === node.getKey()) {\r\n            return node.getData();\r\n        }\r\n        else if (key < node.getKey()) {\r\n            return this._get(node.getLeft(), key);\r\n        }\r\n        else {\r\n            return this._get(node.getRight(), key);\r\n        }\r\n    }\r\n    add(element) {\r\n        if (this._root == null) {\r\n            this._root = new BinaryTreeNode(this._getComparable(element), [element], null, null);\r\n            return true;\r\n        }\r\n        else {\r\n            return this._insert(this._root, element);\r\n        }\r\n    }\r\n    _insert(node, element) {\r\n        if (node != null) {\r\n            if (this._getComparable(element) === node.getKey()) {\r\n                if (node.getData().indexOf(element) > -1) {\r\n                    return false; // the element we're trying to insert already exists\r\n                }\r\n                else {\r\n                    node.getData().push(element);\r\n                    return true;\r\n                }\r\n            }\r\n            else if (this._getComparable(element) < node.getKey()) {\r\n                if (node.getLeft() == null) {\r\n                    node.setLeft(new BinaryTreeNode(this._getComparable(element), [element], null, null));\r\n                    return true;\r\n                }\r\n                else {\r\n                    return this._insert(node.getLeft(), element);\r\n                }\r\n            }\r\n            else {\r\n                if (node.getRight() == null) {\r\n                    node.setRight(new BinaryTreeNode(this._getComparable(element), [element], null, null));\r\n                    return true;\r\n                }\r\n                else {\r\n                    return this._insert(node.getRight(), element);\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    removeByComparable(element) {\r\n        this._root = this._remove(this._root, element);\r\n    }\r\n    _remove(node, element) {\r\n        if (node == null) {\r\n            return null;\r\n        }\r\n        else if (this._getComparable(element) === node.getKey()) {\r\n            const elementIndex = node.getData().indexOf(element);\r\n            // if the node contains the element, remove the element\r\n            if (elementIndex > -1) {\r\n                node.getData().splice(elementIndex, 1);\r\n                // if we have removed the last element at this node, remove the node\r\n                if (node.getData().length === 0) {\r\n                    // if the node is a leaf\r\n                    if (node.getLeft() == null && node.getRight() == null) {\r\n                        return null;\r\n                    }\r\n                    else if (node.getLeft() == null) {\r\n                        return node.getRight();\r\n                    }\r\n                    else if (node.getRight() == null) {\r\n                        return node.getLeft();\r\n                    }\r\n                    // if node has 2 children\r\n                    const temp = this._findMinNode(node.getRight());\r\n                    node.setKey(temp.getKey());\r\n                    node.setData(temp.getData());\r\n                    node.setRight(this._cleanup(node.getRight(), temp)); //\"cleanup nodes\" (move them up recursively)\r\n                    return node;\r\n                }\r\n                else {\r\n                    // this prevents the node from being removed since it still contains elements\r\n                    return node;\r\n                }\r\n            }\r\n        }\r\n        else if (this._getComparable(element) < node.getKey()) {\r\n            node.setLeft(this._remove(node.getLeft(), element));\r\n            return node;\r\n        }\r\n        else {\r\n            node.setRight(this._remove(node.getRight(), element));\r\n            return node;\r\n        }\r\n        return null;\r\n    }\r\n    // called once we have successfully removed the element we wanted, recursively corrects the part of the tree below the removed node\r\n    _cleanup(node, element) {\r\n        const comparable = element.getKey();\r\n        if (node == null) {\r\n            return null;\r\n        }\r\n        else if (comparable === node.getKey()) {\r\n            // if the node is a leaf\r\n            if (node.getLeft() == null && node.getRight() == null) {\r\n                return null;\r\n            }\r\n            else if (node.getLeft() == null) {\r\n                return node.getRight();\r\n            }\r\n            else if (node.getRight() == null) {\r\n                return node.getLeft();\r\n            }\r\n            // if node has 2 children\r\n            const temp = this._findMinNode(node.getRight());\r\n            node.setKey(temp.getKey());\r\n            node.setData(temp.getData());\r\n            node.setRight(this._cleanup(node.getRight(), temp));\r\n            return node;\r\n        }\r\n        else if (element.getKey() < node.getKey()) {\r\n            node.setLeft(this._cleanup(node.getLeft(), element));\r\n            return node;\r\n        }\r\n        else {\r\n            node.setRight(this._cleanup(node.getRight(), element));\r\n            return node;\r\n        }\r\n    }\r\n    _findMinNode(node) {\r\n        let current = node;\r\n        while (current.getLeft() != null) {\r\n            current = current.getLeft();\r\n        }\r\n        return current;\r\n    }\r\n    list() {\r\n        const results = new Array();\r\n        this._list(this._root, results);\r\n        return results;\r\n    }\r\n    _list(treeNode, results) {\r\n        if (treeNode != null) {\r\n            this._list(treeNode.getLeft(), results);\r\n            treeNode.getData().forEach((element) => {\r\n                results.push(element);\r\n            });\r\n            this._list(treeNode.getRight(), results);\r\n        }\r\n    }\r\n};\r\nSortedList = SortedList_decorate([\r\n    obsolete({ message: 'Will be removed in excalibur v0.26.0', alternateMethod: 'Use built in JS array.sort' })\r\n], SortedList);\r\n\r\n/**\r\n * A tree node part of [[SortedList]]\r\n * @deprecated Will be removed in v0.26.0\r\n */\r\nlet BinaryTreeNode = class BinaryTreeNode {\r\n    constructor(key, data, left, right) {\r\n        this._key = key;\r\n        this._data = data;\r\n        this._left = left;\r\n        this._right = right;\r\n    }\r\n    getKey() {\r\n        return this._key;\r\n    }\r\n    setKey(key) {\r\n        this._key = key;\r\n    }\r\n    getData() {\r\n        return this._data;\r\n    }\r\n    setData(data) {\r\n        this._data = data;\r\n    }\r\n    getLeft() {\r\n        return this._left;\r\n    }\r\n    setLeft(left) {\r\n        this._left = left;\r\n    }\r\n    getRight() {\r\n        return this._right;\r\n    }\r\n    setRight(right) {\r\n        this._right = right;\r\n    }\r\n};\r\nBinaryTreeNode = SortedList_decorate([\r\n    obsolete({ message: 'Will be removed in excalibur v0.26.0' })\r\n], BinaryTreeNode);\r\n\r\n/**\r\n * Mock element for testing\r\n *\r\n * @internal\r\n * @deprecated Will be removed in v0.26.0\r\n */\r\nclass MockedElement {\r\n    constructor(key) {\r\n        this._key = 0;\r\n        this._key = key;\r\n    }\r\n    getTheKey() {\r\n        return this._key;\r\n    }\r\n    setKey(key) {\r\n        this._key = key;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Promises.ts\n// Promises/A+ Spec http://promises-aplus.github.io/promises-spec/\r\nvar Promises_decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\nvar Promise_1;\r\n\r\n/**\r\n * Valid states for a promise to be in\r\n * @deprecated Will be removed in v0.26.0\r\n */\r\nvar PromiseState;\r\n(function (PromiseState) {\r\n    PromiseState[PromiseState[\"Resolved\"] = 0] = \"Resolved\";\r\n    PromiseState[PromiseState[\"Rejected\"] = 1] = \"Rejected\";\r\n    PromiseState[PromiseState[\"Pending\"] = 2] = \"Pending\";\r\n})(PromiseState || (PromiseState = {}));\r\n/**\r\n * Promises are used to do asynchronous work and they are useful for\r\n * creating a chain of actions. In Excalibur they are used for loading,\r\n * sounds, animation, actions, and more.\r\n * @deprecated Will be removed in v0.26.0\r\n */\r\nlet Promises_Promise = Promise_1 = class Promise {\r\n    constructor() {\r\n        this._state = PromiseState.Pending;\r\n        this._successCallbacks = [];\r\n        this._rejectCallback = () => {\r\n            return;\r\n        };\r\n    }\r\n    /**\r\n     * Create and resolve a Promise with an optional value\r\n     * @param value  An optional value to wrap in a resolved promise\r\n     * @deprecated Use browser native promises\r\n     */\r\n    static resolve(value) {\r\n        const promise = new Promise_1().resolve(value);\r\n        return promise;\r\n    }\r\n    /**\r\n     * Create and reject a Promise with an optional value\r\n     * @param value  An optional value to wrap in a rejected promise\r\n     * @deprecated Use browser native promises\r\n     */\r\n    static reject(value) {\r\n        const promise = new Promise_1().reject(value);\r\n        return promise;\r\n    }\r\n    static join() {\r\n        let promises = [];\r\n        if (arguments.length > 0 && !Array.isArray(arguments[0])) {\r\n            for (let _i = 0; _i < arguments.length; _i++) {\r\n                promises[_i - 0] = arguments[_i];\r\n            }\r\n        }\r\n        else if (arguments.length === 1 && Array.isArray(arguments[0])) {\r\n            promises = arguments[0];\r\n        }\r\n        const joinedPromise = new Promise_1();\r\n        if (!promises || !promises.length) {\r\n            return joinedPromise.resolve();\r\n        }\r\n        const total = promises.length;\r\n        let successes = 0;\r\n        let rejects = 0;\r\n        const errors = [];\r\n        promises.forEach((p) => {\r\n            p.then(() => {\r\n                successes += 1;\r\n                if (successes === total) {\r\n                    joinedPromise.resolve();\r\n                }\r\n                else if (successes + rejects + errors.length === total) {\r\n                    joinedPromise.reject(errors);\r\n                }\r\n            }, () => {\r\n                rejects += 1;\r\n                if (successes + rejects + errors.length === total) {\r\n                    joinedPromise.reject(errors);\r\n                }\r\n            }).error((e) => {\r\n                errors.push(e);\r\n                if (errors.length + successes + rejects === total) {\r\n                    joinedPromise.reject(errors);\r\n                }\r\n            });\r\n        });\r\n        return joinedPromise;\r\n    }\r\n    /**\r\n     * Chain success and reject callbacks after the promise is resolved\r\n     * @param successCallback  Call on resolution of promise\r\n     * @param rejectCallback   Call on rejection of promise\r\n     * @deprecated Use browser native promises\r\n     */\r\n    then(successCallback, rejectCallback) {\r\n        if (successCallback) {\r\n            this._successCallbacks.push(successCallback);\r\n            // If the promise is already resolved call immediately\r\n            if (this.state() === PromiseState.Resolved) {\r\n                try {\r\n                    successCallback.call(this, this._value);\r\n                }\r\n                catch (e) {\r\n                    this._handleError(e);\r\n                }\r\n            }\r\n        }\r\n        if (rejectCallback) {\r\n            this._rejectCallback = rejectCallback;\r\n            // If the promise is already rejected call immediately\r\n            if (this.state() === PromiseState.Rejected) {\r\n                try {\r\n                    rejectCallback.call(this, this._value);\r\n                }\r\n                catch (e) {\r\n                    this._handleError(e);\r\n                }\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Add an error callback to the promise\r\n     * @param errorCallback  Call if there was an error in a callback\r\n     * @deprecated Use browser native promises\r\n     */\r\n    error(errorCallback) {\r\n        if (errorCallback) {\r\n            this._errorCallback = errorCallback;\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Resolve the promise and pass an option value to the success callbacks\r\n     * @param value  Value to pass to the success callbacks\r\n     * @deprecated Use browser native promises\r\n     */\r\n    resolve(value) {\r\n        if (this._state === PromiseState.Pending) {\r\n            this._value = value;\r\n            try {\r\n                this._state = PromiseState.Resolved;\r\n                this._successCallbacks.forEach((cb) => {\r\n                    cb.call(this, this._value);\r\n                });\r\n            }\r\n            catch (e) {\r\n                this._handleError(e);\r\n            }\r\n        }\r\n        else {\r\n            throw new Error('Cannot resolve a promise that is not in a pending state!');\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Reject the promise and pass an option value to the reject callbacks\r\n     * @param value  Value to pass to the reject callbacks\r\n     * @deprecated Use browser native promises\r\n     */\r\n    reject(value) {\r\n        if (this._state === PromiseState.Pending) {\r\n            this._value = value;\r\n            try {\r\n                this._state = PromiseState.Rejected;\r\n                this._rejectCallback.call(this, this._value);\r\n            }\r\n            catch (e) {\r\n                this._handleError(e);\r\n            }\r\n        }\r\n        else {\r\n            throw new Error('Cannot reject a promise that is not in a pending state!');\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Inspect the current state of a promise\r\n     * @deprecated Use browser native promises\r\n     */\r\n    state() {\r\n        return this._state;\r\n    }\r\n    _handleError(e) {\r\n        if (this._errorCallback) {\r\n            this._errorCallback.call(this, e);\r\n        }\r\n        else {\r\n            // rethrow error\r\n            throw e;\r\n        }\r\n    }\r\n};\r\nPromises_Promise = Promise_1 = Promises_decorate([\r\n    obsolete({\r\n        message: 'ex.Promises are being replaced by native browser promises in v0.26.0',\r\n        alternateMethod: 'Use browser native promises'\r\n    })\r\n], Promises_Promise);\r\n\r\n\n;// CONCATENATED MODULE: ./index.ts\n/**\r\n * The current Excalibur version string\r\n * @description `process.env.__EX_VERSION` gets replaced by Webpack on build\r\n */\r\nconst EX_VERSION = \"0.25.1\";\r\n\r\npolyfill();\r\n// This file is used as the bundle entry point and exports everything\r\n// that will be exposed as the `ex` global variable.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// ex.LegacyDrawing namespace\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// ex.Events namespace\r\n\r\n\r\n// ex.Input namespace\r\n\r\n\r\n// ex.Traits namespace\r\n\r\n\r\n// ex.Util namespaces\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// ex.Deprecated\r\n\r\n// import * as deprecated from './Deprecated';\r\n// export { deprecated as Deprecated };\r\n// export * from './Deprecated';\r\n\n})();\n\nvar __webpack_exports__ActionContext = __webpack_exports__.fWn;\nvar __webpack_exports__ActionQueue = __webpack_exports__.Ia8;\nvar __webpack_exports__ActionsComponent = __webpack_exports__.hLI;\nvar __webpack_exports__ActionsSystem = __webpack_exports__.yyv;\nvar __webpack_exports__ActivateEvent = __webpack_exports__.tX5;\nvar __webpack_exports__Actor = __webpack_exports__.vtX;\nvar __webpack_exports__AddedComponent = __webpack_exports__.r7K;\nvar __webpack_exports__AddedEntity = __webpack_exports__.lCh;\nvar __webpack_exports__Animation = __webpack_exports__.fwF;\nvar __webpack_exports__AnimationDirection = __webpack_exports__.sce;\nvar __webpack_exports__AnimationStrategy = __webpack_exports__._c7;\nvar __webpack_exports__ArcadeSolver = __webpack_exports__.KUs;\nvar __webpack_exports__AudioContextFactory = __webpack_exports__.Ajp;\nvar __webpack_exports__Axis = __webpack_exports__.RDh;\nvar __webpack_exports__BaseAlign = __webpack_exports__._H9;\nvar __webpack_exports__BinaryTreeNode = __webpack_exports__.Ulf;\nvar __webpack_exports__Blink = __webpack_exports__.mxs;\nvar __webpack_exports__BodyComponent = __webpack_exports__.OmD;\nvar __webpack_exports__BoundingBox = __webpack_exports__.kBf;\nvar __webpack_exports__BroadphaseStrategy = __webpack_exports__.C4F;\nvar __webpack_exports__BrowserComponent = __webpack_exports__.NQt;\nvar __webpack_exports__BrowserEvents = __webpack_exports__.JjN;\nvar __webpack_exports__Camera = __webpack_exports__.V1s;\nvar __webpack_exports__Canvas = __webpack_exports__.Xz7;\nvar __webpack_exports__Cell = __webpack_exports__.bLd;\nvar __webpack_exports__Circle = __webpack_exports__.Cdc;\nvar __webpack_exports__CircleCollider = __webpack_exports__.FKn;\nvar __webpack_exports__Class = __webpack_exports__.wTW;\nvar __webpack_exports__ClosestLine = __webpack_exports__.ab2;\nvar __webpack_exports__ClosestLineJumpTable = __webpack_exports__.GfZ;\nvar __webpack_exports__Collider = __webpack_exports__.YMS;\nvar __webpack_exports__ColliderComponent = __webpack_exports__.oyv;\nvar __webpack_exports__CollisionContact = __webpack_exports__.aUb;\nvar __webpack_exports__CollisionEndEvent = __webpack_exports__.SdD;\nvar __webpack_exports__CollisionGroup = __webpack_exports__.JUv;\nvar __webpack_exports__CollisionGroupManager = __webpack_exports__.jEj;\nvar __webpack_exports__CollisionJumpTable = __webpack_exports__.TFq;\nvar __webpack_exports__CollisionPostSolveEvent = __webpack_exports__.HDU;\nvar __webpack_exports__CollisionPreSolveEvent = __webpack_exports__.R_y;\nvar __webpack_exports__CollisionResolutionStrategy = __webpack_exports__.ydN;\nvar __webpack_exports__CollisionSolver = __webpack_exports__._N2;\nvar __webpack_exports__CollisionStartEvent = __webpack_exports__.t50;\nvar __webpack_exports__CollisionSystem = __webpack_exports__.s$$;\nvar __webpack_exports__CollisionType = __webpack_exports__.v2G;\nvar __webpack_exports__Color = __webpack_exports__.Ilk;\nvar __webpack_exports__ColorBlindCorrector = __webpack_exports__.H_9;\nvar __webpack_exports__ColorBlindFlags = __webpack_exports__.s9i;\nvar __webpack_exports__ColorBlindness = __webpack_exports__.ksl;\nvar __webpack_exports__Component = __webpack_exports__.wA2;\nvar __webpack_exports__CompositeCollider = __webpack_exports__.R_p;\nvar __webpack_exports__Configurable = __webpack_exports__.IQ$;\nvar __webpack_exports__ConsoleAppender = __webpack_exports__.I5F;\nvar __webpack_exports__ContactConstraintPoint = __webpack_exports__.X8$;\nvar __webpack_exports__ContactEndEvent = __webpack_exports__.FR6;\nvar __webpack_exports__ContactStartEvent = __webpack_exports__.U8o;\nvar __webpack_exports__CoordPlane = __webpack_exports__.kbG;\nvar __webpack_exports__CullingBox = __webpack_exports__.oeJ;\nvar __webpack_exports__DeactivateEvent = __webpack_exports__.iS_;\nvar __webpack_exports__Debug = __webpack_exports__.cGG;\nvar __webpack_exports__DebugSystem = __webpack_exports__.skb;\nvar __webpack_exports__DebugText = __webpack_exports__.SLU;\nvar __webpack_exports__DegreeOfFreedom = __webpack_exports__.RdJ;\nvar __webpack_exports__Detector = __webpack_exports__.gU7;\nvar __webpack_exports__Die = __webpack_exports__.LSk;\nvar __webpack_exports__Direction = __webpack_exports__.Nmp;\nvar __webpack_exports__DisplayMode = __webpack_exports__.d1Y;\nvar __webpack_exports__DynamicTree = __webpack_exports__.xrL;\nvar __webpack_exports__DynamicTreeCollisionProcessor = __webpack_exports__.sRW;\nvar __webpack_exports__EX_VERSION = __webpack_exports__.cmV;\nvar __webpack_exports__EaseTo = __webpack_exports__.N0Q;\nvar __webpack_exports__EasingFunctions = __webpack_exports__.q8b;\nvar __webpack_exports__EdgeCollider = __webpack_exports__.ynB;\nvar __webpack_exports__ElasticToActorStrategy = __webpack_exports__.jT9;\nvar __webpack_exports__EmitterType = __webpack_exports__.wAz;\nvar __webpack_exports__Engine = __webpack_exports__.D4V;\nvar __webpack_exports__EnterTriggerEvent = __webpack_exports__.N6H;\nvar __webpack_exports__EnterViewPortEvent = __webpack_exports__.W1A;\nvar __webpack_exports__Entity = __webpack_exports__.JHW;\nvar __webpack_exports__EntityManager = __webpack_exports__.v2K;\nvar __webpack_exports__EventDispatcher = __webpack_exports__.pBf;\nvar __webpack_exports__EventTypes = __webpack_exports__.GMl;\nvar __webpack_exports__Events = __webpack_exports__.zW2;\nvar __webpack_exports__ExResponse = __webpack_exports__.B0K;\nvar __webpack_exports__ExcaliburGraphicsContext2DCanvas = __webpack_exports__.Nv7;\nvar __webpack_exports__ExcaliburGraphicsContextWebGL = __webpack_exports__.C_p;\nvar __webpack_exports__ExitTriggerEvent = __webpack_exports__.MUA;\nvar __webpack_exports__ExitViewPortEvent = __webpack_exports__.xqU;\nvar __webpack_exports__Experiments = __webpack_exports__.peG;\nvar __webpack_exports__Fade = __webpack_exports__.pTp;\nvar __webpack_exports__Flags = __webpack_exports__.vUK;\nvar __webpack_exports__Follow = __webpack_exports__.j9l;\nvar __webpack_exports__Font = __webpack_exports__.Zxw;\nvar __webpack_exports__FontStyle = __webpack_exports__.Hdx;\nvar __webpack_exports__FontUnit = __webpack_exports__.Z$d;\nvar __webpack_exports__FrameStats = __webpack_exports__.o$7;\nvar __webpack_exports__GameEvent = __webpack_exports__.Zm$;\nvar __webpack_exports__GameStartEvent = __webpack_exports__.$QH;\nvar __webpack_exports__GameStopEvent = __webpack_exports__.i78;\nvar __webpack_exports__GamepadAxisEvent = __webpack_exports__.h6u;\nvar __webpack_exports__GamepadButtonEvent = __webpack_exports__.hts;\nvar __webpack_exports__GamepadConnectEvent = __webpack_exports__.j88;\nvar __webpack_exports__GamepadDisconnectEvent = __webpack_exports__.VME;\nvar __webpack_exports__Gif = __webpack_exports__.nt;\nvar __webpack_exports__GlobalCoordinates = __webpack_exports__.Ukr;\nvar __webpack_exports__Graphic = __webpack_exports__.zsu;\nvar __webpack_exports__GraphicsComponent = __webpack_exports__.oA6;\nvar __webpack_exports__GraphicsGroup = __webpack_exports__.TVh;\nvar __webpack_exports__GraphicsLayer = __webpack_exports__.TwZ;\nvar __webpack_exports__GraphicsLayers = __webpack_exports__.GTT;\nvar __webpack_exports__GraphicsSystem = __webpack_exports__.xxj;\nvar __webpack_exports__HiddenEvent = __webpack_exports__.XdK;\nvar __webpack_exports__ImageSource = __webpack_exports__.cXo;\nvar __webpack_exports__InitializeEvent = __webpack_exports__.Dm5;\nvar __webpack_exports__Input = __webpack_exports__.IIB;\nvar __webpack_exports__Integrator = __webpack_exports__.zI0;\nvar __webpack_exports__KillEvent = __webpack_exports__.SKZ;\nvar __webpack_exports__Label = __webpack_exports__.__J;\nvar __webpack_exports__Legacy = __webpack_exports__.Dvr;\nvar __webpack_exports__LegacyDrawing = __webpack_exports__.Tf9;\nvar __webpack_exports__LimitCameraBoundsStrategy = __webpack_exports__.RI$;\nvar __webpack_exports__Line = __webpack_exports__.x12;\nvar __webpack_exports__Loader = __webpack_exports__.aNw;\nvar __webpack_exports__LockCameraToActorAxisStrategy = __webpack_exports__.xwn;\nvar __webpack_exports__LockCameraToActorStrategy = __webpack_exports__.dNK;\nvar __webpack_exports__LogLevel = __webpack_exports__.ini;\nvar __webpack_exports__Logger = __webpack_exports__.YdH;\nvar __webpack_exports__Matrix = __webpack_exports__.y3G;\nvar __webpack_exports__MatrixLocations = __webpack_exports__.l57;\nvar __webpack_exports__MediaEvent = __webpack_exports__.xn0;\nvar __webpack_exports__Meet = __webpack_exports__.t2V;\nvar __webpack_exports__MockedElement = __webpack_exports__.ZyS;\nvar __webpack_exports__MotionComponent = __webpack_exports__.uxB;\nvar __webpack_exports__MotionSystem = __webpack_exports__.cpd;\nvar __webpack_exports__MoveBy = __webpack_exports__.fiy;\nvar __webpack_exports__MoveTo = __webpack_exports__.$XZ;\nvar __webpack_exports__NativeSoundEvent = __webpack_exports__.uqK;\nvar __webpack_exports__NativeSoundProcessedEvent = __webpack_exports__.STE;\nvar __webpack_exports__Observable = __webpack_exports__.y$z;\nvar __webpack_exports__Pair = __webpack_exports__.sOq;\nvar __webpack_exports__ParseGif = __webpack_exports__.Sqs;\nvar __webpack_exports__Particle = __webpack_exports__.hpZ;\nvar __webpack_exports__ParticleEmitter = __webpack_exports__.Vol;\nvar __webpack_exports__Physics = __webpack_exports__.wIZ;\nvar __webpack_exports__PhysicsStats = __webpack_exports__.cBi;\nvar __webpack_exports__Polygon = __webpack_exports__.mgq;\nvar __webpack_exports__PolygonCollider = __webpack_exports__.YVA;\nvar __webpack_exports__Pool = __webpack_exports__.Kgp;\nvar __webpack_exports__PostCollisionEvent = __webpack_exports__.HH$;\nvar __webpack_exports__PostDebugDrawEvent = __webpack_exports__.M_d;\nvar __webpack_exports__PostDrawEvent = __webpack_exports__.rgh;\nvar __webpack_exports__PostFrameEvent = __webpack_exports__.Ra6;\nvar __webpack_exports__PostKillEvent = __webpack_exports__.KhR;\nvar __webpack_exports__PostUpdateEvent = __webpack_exports__.BS5;\nvar __webpack_exports__PreCollisionEvent = __webpack_exports__.xhz;\nvar __webpack_exports__PreDebugDrawEvent = __webpack_exports__.xOq;\nvar __webpack_exports__PreDrawEvent = __webpack_exports__.a9j;\nvar __webpack_exports__PreFrameEvent = __webpack_exports__.bHk;\nvar __webpack_exports__PreKillEvent = __webpack_exports__.CgK;\nvar __webpack_exports__PreUpdateEvent = __webpack_exports__.cuY;\nvar __webpack_exports__Projection = __webpack_exports__.kvE;\nvar __webpack_exports__Promise = __webpack_exports__.JDb;\nvar __webpack_exports__PromiseState = __webpack_exports__.Cbi;\nvar __webpack_exports__Query = __webpack_exports__.AE_;\nvar __webpack_exports__QueryManager = __webpack_exports__.ctO;\nvar __webpack_exports__RadiusAroundActorStrategy = __webpack_exports__.OLH;\nvar __webpack_exports__Random = __webpack_exports__.kky;\nvar __webpack_exports__Raster = __webpack_exports__.nSF;\nvar __webpack_exports__Ray = __webpack_exports__.zHn;\nvar __webpack_exports__RealisticSolver = __webpack_exports__.zwx;\nvar __webpack_exports__Rectangle = __webpack_exports__.AeJ;\nvar __webpack_exports__RemovedComponent = __webpack_exports__.hLz;\nvar __webpack_exports__RemovedEntity = __webpack_exports__.D9g;\nvar __webpack_exports__Repeat = __webpack_exports__.wA;\nvar __webpack_exports__RepeatForever = __webpack_exports__.jhr;\nvar __webpack_exports__Resolution = __webpack_exports__.GVs;\nvar __webpack_exports__Resource = __webpack_exports__._zO;\nvar __webpack_exports__RotateBy = __webpack_exports__.w6$;\nvar __webpack_exports__RotateTo = __webpack_exports__.mhV;\nvar __webpack_exports__RotationType = __webpack_exports__.MOD;\nvar __webpack_exports__ScaleBy = __webpack_exports__.kwd;\nvar __webpack_exports__ScaleTo = __webpack_exports__.Lmr;\nvar __webpack_exports__Scene = __webpack_exports__.xsS;\nvar __webpack_exports__Screen = __webpack_exports__.lLr;\nvar __webpack_exports__ScreenAppender = __webpack_exports__.Z$r;\nvar __webpack_exports__ScreenElement = __webpack_exports__.IXb;\nvar __webpack_exports__ScrollPreventionMode = __webpack_exports__.SMj;\nvar __webpack_exports__Shape = __webpack_exports__.bnF;\nvar __webpack_exports__Side = __webpack_exports__.MFA;\nvar __webpack_exports__SortedList = __webpack_exports__.$XC;\nvar __webpack_exports__Sound = __webpack_exports__.$uU;\nvar __webpack_exports__Sprite = __webpack_exports__.jyi;\nvar __webpack_exports__SpriteFont = __webpack_exports__.E03;\nvar __webpack_exports__SpriteSheet = __webpack_exports__.V6q;\nvar __webpack_exports__StrategyContainer = __webpack_exports__.nVo;\nvar __webpack_exports__Stream = __webpack_exports__.F6N;\nvar __webpack_exports__SubscribeEvent = __webpack_exports__.ad3;\nvar __webpack_exports__System = __webpack_exports__.xP7;\nvar __webpack_exports__SystemManager = __webpack_exports__.Odq;\nvar __webpack_exports__SystemType = __webpack_exports__.Zif;\nvar __webpack_exports__TagComponent = __webpack_exports__.ZGJ;\nvar __webpack_exports__Text = __webpack_exports__.xvT;\nvar __webpack_exports__TextAlign = __webpack_exports__.PHM;\nvar __webpack_exports__TileMap = __webpack_exports__.KwO;\nvar __webpack_exports__Timer = __webpack_exports__.B7y;\nvar __webpack_exports__Traits = __webpack_exports__.SFp;\nvar __webpack_exports__TransformComponent = __webpack_exports__.Uvn;\nvar __webpack_exports__TreeNode = __webpack_exports__.OFT;\nvar __webpack_exports__Trigger = __webpack_exports__.xzN;\nvar __webpack_exports__UnsubscribeEvent = __webpack_exports__.H6j;\nvar __webpack_exports__Util = __webpack_exports__.ZrN;\nvar __webpack_exports__Vector = __webpack_exports__.OWs;\nvar __webpack_exports__VectorView = __webpack_exports__.dF9;\nvar __webpack_exports__VisibleEvent = __webpack_exports__.VHo;\nvar __webpack_exports__WebAudioInstance = __webpack_exports__.R$E;\nvar __webpack_exports__World = __webpack_exports__.q3I;\nvar __webpack_exports__canonicalizeAngle = __webpack_exports__.Pab;\nvar __webpack_exports__clamp = __webpack_exports__.uZ5;\nvar __webpack_exports__createId = __webpack_exports__.McK;\nvar __webpack_exports__hasGraphicsTick = __webpack_exports__.k0b;\nvar __webpack_exports__hasOnInitialize = __webpack_exports__.hnT;\nvar __webpack_exports__hasOnPostUpdate = __webpack_exports__.RSJ;\nvar __webpack_exports__hasOnPreUpdate = __webpack_exports__.Mku;\nvar __webpack_exports__hasPostDraw = __webpack_exports__.h90;\nvar __webpack_exports__hasPreDraw = __webpack_exports__.rms;\nvar __webpack_exports__has_initialize = __webpack_exports__.ErP;\nvar __webpack_exports__has_postupdate = __webpack_exports__.aVg;\nvar __webpack_exports__has_preupdate = __webpack_exports__.lPc;\nvar __webpack_exports__isAddedComponent = __webpack_exports__.Z8E;\nvar __webpack_exports__isAddedSystemEntity = __webpack_exports__.NNA;\nvar __webpack_exports__isRemoveSystemEntity = __webpack_exports__.yFn;\nvar __webpack_exports__isRemovedComponent = __webpack_exports__.lNv;\nvar __webpack_exports__maxMessages = __webpack_exports__.MZQ;\nvar __webpack_exports__obsolete = __webpack_exports__.FUM;\nvar __webpack_exports__randomInRange = __webpack_exports__.vdf;\nvar __webpack_exports__randomIntInRange = __webpack_exports__.iaL;\nvar __webpack_exports__range = __webpack_exports__.w6H;\nvar __webpack_exports__resetObsoleteCounter = __webpack_exports__.Q4c;\nvar __webpack_exports__toDegrees = __webpack_exports__.Uxb;\nvar __webpack_exports__toRadians = __webpack_exports__.Yr5;\nvar __webpack_exports__vec = __webpack_exports__.Bhw;\nexport { __webpack_exports__ActionContext as ActionContext, __webpack_exports__ActionQueue as ActionQueue, __webpack_exports__ActionsComponent as ActionsComponent, __webpack_exports__ActionsSystem as ActionsSystem, __webpack_exports__ActivateEvent as ActivateEvent, __webpack_exports__Actor as Actor, __webpack_exports__AddedComponent as AddedComponent, __webpack_exports__AddedEntity as AddedEntity, __webpack_exports__Animation as Animation, __webpack_exports__AnimationDirection as AnimationDirection, __webpack_exports__AnimationStrategy as AnimationStrategy, __webpack_exports__ArcadeSolver as ArcadeSolver, __webpack_exports__AudioContextFactory as AudioContextFactory, __webpack_exports__Axis as Axis, __webpack_exports__BaseAlign as BaseAlign, __webpack_exports__BinaryTreeNode as BinaryTreeNode, __webpack_exports__Blink as Blink, __webpack_exports__BodyComponent as BodyComponent, __webpack_exports__BoundingBox as BoundingBox, __webpack_exports__BroadphaseStrategy as BroadphaseStrategy, __webpack_exports__BrowserComponent as BrowserComponent, __webpack_exports__BrowserEvents as BrowserEvents, __webpack_exports__Camera as Camera, __webpack_exports__Canvas as Canvas, __webpack_exports__Cell as Cell, __webpack_exports__Circle as Circle, __webpack_exports__CircleCollider as CircleCollider, __webpack_exports__Class as Class, __webpack_exports__ClosestLine as ClosestLine, __webpack_exports__ClosestLineJumpTable as ClosestLineJumpTable, __webpack_exports__Collider as Collider, __webpack_exports__ColliderComponent as ColliderComponent, __webpack_exports__CollisionContact as CollisionContact, __webpack_exports__CollisionEndEvent as CollisionEndEvent, __webpack_exports__CollisionGroup as CollisionGroup, __webpack_exports__CollisionGroupManager as CollisionGroupManager, __webpack_exports__CollisionJumpTable as CollisionJumpTable, __webpack_exports__CollisionPostSolveEvent as CollisionPostSolveEvent, __webpack_exports__CollisionPreSolveEvent as CollisionPreSolveEvent, __webpack_exports__CollisionResolutionStrategy as CollisionResolutionStrategy, __webpack_exports__CollisionSolver as CollisionSolver, __webpack_exports__CollisionStartEvent as CollisionStartEvent, __webpack_exports__CollisionSystem as CollisionSystem, __webpack_exports__CollisionType as CollisionType, __webpack_exports__Color as Color, __webpack_exports__ColorBlindCorrector as ColorBlindCorrector, __webpack_exports__ColorBlindFlags as ColorBlindFlags, __webpack_exports__ColorBlindness as ColorBlindness, __webpack_exports__Component as Component, __webpack_exports__CompositeCollider as CompositeCollider, __webpack_exports__Configurable as Configurable, __webpack_exports__ConsoleAppender as ConsoleAppender, __webpack_exports__ContactConstraintPoint as ContactConstraintPoint, __webpack_exports__ContactEndEvent as ContactEndEvent, __webpack_exports__ContactStartEvent as ContactStartEvent, __webpack_exports__CoordPlane as CoordPlane, __webpack_exports__CullingBox as CullingBox, __webpack_exports__DeactivateEvent as DeactivateEvent, __webpack_exports__Debug as Debug, __webpack_exports__DebugSystem as DebugSystem, __webpack_exports__DebugText as DebugText, __webpack_exports__DegreeOfFreedom as DegreeOfFreedom, __webpack_exports__Detector as Detector, __webpack_exports__Die as Die, __webpack_exports__Direction as Direction, __webpack_exports__DisplayMode as DisplayMode, __webpack_exports__DynamicTree as DynamicTree, __webpack_exports__DynamicTreeCollisionProcessor as DynamicTreeCollisionProcessor, __webpack_exports__EX_VERSION as EX_VERSION, __webpack_exports__EaseTo as EaseTo, __webpack_exports__EasingFunctions as EasingFunctions, __webpack_exports__EdgeCollider as EdgeCollider, __webpack_exports__ElasticToActorStrategy as ElasticToActorStrategy, __webpack_exports__EmitterType as EmitterType, __webpack_exports__Engine as Engine, __webpack_exports__EnterTriggerEvent as EnterTriggerEvent, __webpack_exports__EnterViewPortEvent as EnterViewPortEvent, __webpack_exports__Entity as Entity, __webpack_exports__EntityManager as EntityManager, __webpack_exports__EventDispatcher as EventDispatcher, __webpack_exports__EventTypes as EventTypes, __webpack_exports__Events as Events, __webpack_exports__ExResponse as ExResponse, __webpack_exports__ExcaliburGraphicsContext2DCanvas as ExcaliburGraphicsContext2DCanvas, __webpack_exports__ExcaliburGraphicsContextWebGL as ExcaliburGraphicsContextWebGL, __webpack_exports__ExitTriggerEvent as ExitTriggerEvent, __webpack_exports__ExitViewPortEvent as ExitViewPortEvent, __webpack_exports__Experiments as Experiments, __webpack_exports__Fade as Fade, __webpack_exports__Flags as Flags, __webpack_exports__Follow as Follow, __webpack_exports__Font as Font, __webpack_exports__FontStyle as FontStyle, __webpack_exports__FontUnit as FontUnit, __webpack_exports__FrameStats as FrameStats, __webpack_exports__GameEvent as GameEvent, __webpack_exports__GameStartEvent as GameStartEvent, __webpack_exports__GameStopEvent as GameStopEvent, __webpack_exports__GamepadAxisEvent as GamepadAxisEvent, __webpack_exports__GamepadButtonEvent as GamepadButtonEvent, __webpack_exports__GamepadConnectEvent as GamepadConnectEvent, __webpack_exports__GamepadDisconnectEvent as GamepadDisconnectEvent, __webpack_exports__Gif as Gif, __webpack_exports__GlobalCoordinates as GlobalCoordinates, __webpack_exports__Graphic as Graphic, __webpack_exports__GraphicsComponent as GraphicsComponent, __webpack_exports__GraphicsGroup as GraphicsGroup, __webpack_exports__GraphicsLayer as GraphicsLayer, __webpack_exports__GraphicsLayers as GraphicsLayers, __webpack_exports__GraphicsSystem as GraphicsSystem, __webpack_exports__HiddenEvent as HiddenEvent, __webpack_exports__ImageSource as ImageSource, __webpack_exports__InitializeEvent as InitializeEvent, __webpack_exports__Input as Input, __webpack_exports__Integrator as Integrator, __webpack_exports__KillEvent as KillEvent, __webpack_exports__Label as Label, __webpack_exports__Legacy as Legacy, __webpack_exports__LegacyDrawing as LegacyDrawing, __webpack_exports__LimitCameraBoundsStrategy as LimitCameraBoundsStrategy, __webpack_exports__Line as Line, __webpack_exports__Loader as Loader, __webpack_exports__LockCameraToActorAxisStrategy as LockCameraToActorAxisStrategy, __webpack_exports__LockCameraToActorStrategy as LockCameraToActorStrategy, __webpack_exports__LogLevel as LogLevel, __webpack_exports__Logger as Logger, __webpack_exports__Matrix as Matrix, __webpack_exports__MatrixLocations as MatrixLocations, __webpack_exports__MediaEvent as MediaEvent, __webpack_exports__Meet as Meet, __webpack_exports__MockedElement as MockedElement, __webpack_exports__MotionComponent as MotionComponent, __webpack_exports__MotionSystem as MotionSystem, __webpack_exports__MoveBy as MoveBy, __webpack_exports__MoveTo as MoveTo, __webpack_exports__NativeSoundEvent as NativeSoundEvent, __webpack_exports__NativeSoundProcessedEvent as NativeSoundProcessedEvent, __webpack_exports__Observable as Observable, __webpack_exports__Pair as Pair, __webpack_exports__ParseGif as ParseGif, __webpack_exports__Particle as Particle, __webpack_exports__ParticleEmitter as ParticleEmitter, __webpack_exports__Physics as Physics, __webpack_exports__PhysicsStats as PhysicsStats, __webpack_exports__Polygon as Polygon, __webpack_exports__PolygonCollider as PolygonCollider, __webpack_exports__Pool as Pool, __webpack_exports__PostCollisionEvent as PostCollisionEvent, __webpack_exports__PostDebugDrawEvent as PostDebugDrawEvent, __webpack_exports__PostDrawEvent as PostDrawEvent, __webpack_exports__PostFrameEvent as PostFrameEvent, __webpack_exports__PostKillEvent as PostKillEvent, __webpack_exports__PostUpdateEvent as PostUpdateEvent, __webpack_exports__PreCollisionEvent as PreCollisionEvent, __webpack_exports__PreDebugDrawEvent as PreDebugDrawEvent, __webpack_exports__PreDrawEvent as PreDrawEvent, __webpack_exports__PreFrameEvent as PreFrameEvent, __webpack_exports__PreKillEvent as PreKillEvent, __webpack_exports__PreUpdateEvent as PreUpdateEvent, __webpack_exports__Projection as Projection, __webpack_exports__Promise as Promise, __webpack_exports__PromiseState as PromiseState, __webpack_exports__Query as Query, __webpack_exports__QueryManager as QueryManager, __webpack_exports__RadiusAroundActorStrategy as RadiusAroundActorStrategy, __webpack_exports__Random as Random, __webpack_exports__Raster as Raster, __webpack_exports__Ray as Ray, __webpack_exports__RealisticSolver as RealisticSolver, __webpack_exports__Rectangle as Rectangle, __webpack_exports__RemovedComponent as RemovedComponent, __webpack_exports__RemovedEntity as RemovedEntity, __webpack_exports__Repeat as Repeat, __webpack_exports__RepeatForever as RepeatForever, __webpack_exports__Resolution as Resolution, __webpack_exports__Resource as Resource, __webpack_exports__RotateBy as RotateBy, __webpack_exports__RotateTo as RotateTo, __webpack_exports__RotationType as RotationType, __webpack_exports__ScaleBy as ScaleBy, __webpack_exports__ScaleTo as ScaleTo, __webpack_exports__Scene as Scene, __webpack_exports__Screen as Screen, __webpack_exports__ScreenAppender as ScreenAppender, __webpack_exports__ScreenElement as ScreenElement, __webpack_exports__ScrollPreventionMode as ScrollPreventionMode, __webpack_exports__Shape as Shape, __webpack_exports__Side as Side, __webpack_exports__SortedList as SortedList, __webpack_exports__Sound as Sound, __webpack_exports__Sprite as Sprite, __webpack_exports__SpriteFont as SpriteFont, __webpack_exports__SpriteSheet as SpriteSheet, __webpack_exports__StrategyContainer as StrategyContainer, __webpack_exports__Stream as Stream, __webpack_exports__SubscribeEvent as SubscribeEvent, __webpack_exports__System as System, __webpack_exports__SystemManager as SystemManager, __webpack_exports__SystemType as SystemType, __webpack_exports__TagComponent as TagComponent, __webpack_exports__Text as Text, __webpack_exports__TextAlign as TextAlign, __webpack_exports__TileMap as TileMap, __webpack_exports__Timer as Timer, __webpack_exports__Traits as Traits, __webpack_exports__TransformComponent as TransformComponent, __webpack_exports__TreeNode as TreeNode, __webpack_exports__Trigger as Trigger, __webpack_exports__UnsubscribeEvent as UnsubscribeEvent, __webpack_exports__Util as Util, __webpack_exports__Vector as Vector, __webpack_exports__VectorView as VectorView, __webpack_exports__VisibleEvent as VisibleEvent, __webpack_exports__WebAudioInstance as WebAudioInstance, __webpack_exports__World as World, __webpack_exports__canonicalizeAngle as canonicalizeAngle, __webpack_exports__clamp as clamp, __webpack_exports__createId as createId, __webpack_exports__hasGraphicsTick as hasGraphicsTick, __webpack_exports__hasOnInitialize as hasOnInitialize, __webpack_exports__hasOnPostUpdate as hasOnPostUpdate, __webpack_exports__hasOnPreUpdate as hasOnPreUpdate, __webpack_exports__hasPostDraw as hasPostDraw, __webpack_exports__hasPreDraw as hasPreDraw, __webpack_exports__has_initialize as has_initialize, __webpack_exports__has_postupdate as has_postupdate, __webpack_exports__has_preupdate as has_preupdate, __webpack_exports__isAddedComponent as isAddedComponent, __webpack_exports__isAddedSystemEntity as isAddedSystemEntity, __webpack_exports__isRemoveSystemEntity as isRemoveSystemEntity, __webpack_exports__isRemovedComponent as isRemovedComponent, __webpack_exports__maxMessages as maxMessages, __webpack_exports__obsolete as obsolete, __webpack_exports__randomInRange as randomInRange, __webpack_exports__randomIntInRange as randomIntInRange, __webpack_exports__range as range, __webpack_exports__resetObsoleteCounter as resetObsoleteCounter, __webpack_exports__toDegrees as toDegrees, __webpack_exports__toRadians as toRadians, __webpack_exports__vec as vec };\n\n//# sourceMappingURL=excalibur.js.map","module.exports = __webpack_public_path__ + \"cf46998813a16deda5b1df84e8ba4a58.png\";","module.exports = __webpack_public_path__ + \"5f7dc58022982b36f3e7f336df2e1fe3.png\";","module.exports = __webpack_public_path__ + \"bd99eb41ea5cc3d44e26b5d2809fce41.png\";","module.exports = __webpack_public_path__ + \"9b8606ea9f0f4b78b4cd7ce817564074.png\";","module.exports = __webpack_public_path__ + \"81bc95ba9d9e1dca2626111d8282fc01.wav\";","module.exports = __webpack_public_path__ + \"d292f5f80075fd4216d6da8d459f64c5.wav\";","module.exports = __webpack_public_path__ + \"8934b41ac754a9dbdf0fdfffa1807d52.wav\";","module.exports = __webpack_public_path__ + \"61977b58651acbc9a3245a94f185238b.png\";","import * as ex from 'excalibur';\nimport { baddieSpriteSheet, Resources } from \"./resources\";\nimport { Bot } from './bot';\n\nexport class Baddie extends ex.Actor {\n    constructor(x: number, y: number, public dir: number) {\n        super({\n            name: 'Baddie',\n            pos: new ex.Vector(x, y),\n            collisionGroup: ex.CollisionGroupManager.groupByName(\"enemy\"),\n            collisionType: ex.CollisionType.Active,\n            collider: ex.Shape.Box(32, 50, ex.Vector.Half, ex.vec(0, -1)) \n        });\n    }\n\n    // OnInitialize is called before the 1st actor update\n    onInitialize(engine: ex.Engine) {\n        // Initialize actor\n\n        // Setup visuals\n        const left = ex.Animation.fromSpriteSheet(baddieSpriteSheet, [2, 3, 4, 5], 100);\n        left.scale = new ex.Vector(2, 2);\n        const right = ex.Animation.fromSpriteSheet(baddieSpriteSheet, [2, 3, 4, 5], 100);\n        right.scale = new ex.Vector(2, 2);\n        right.flipHorizontal = true;\n\n        // Register animation\n        this.graphics.add(\"left\", left)\n        this.graphics.add(\"right\", right);\n        this.graphics.use(\"left\");\n\n        if ((window as any).__TESTING) {\n            left.pause();\n        }\n\n        // Setup patroling behavior\n\n        // For the test harness to be predicable\n        if (!(window as any).__TESTING) {\n            this.actions.delay(1000)\n                        .repeatForever(ctx => ctx\n                            .moveBy(400 * this.dir, 0, 100)\n                            .moveBy(-400 * this.dir, 0, 100));\n        }\n\n        // Handle being stomped by the player\n        this.on('postcollision', this.onPostCollision);\n    }\n\n    onPostCollision(evt: ex.PostCollisionEvent) {\n        if (evt.other instanceof Bot && evt.side === ex.Side.Top) {\n            Resources.gotEm.play(.1);\n            // Clear patrolling\n            this.actions.clearActions();\n            // Remove ability to collide\n            this.body.collisionType = ex.CollisionType.PreventCollision;\n\n            // Launch into air with rotation\n            this.vel = new ex.Vector(0, -300);\n            this.acc = ex.Physics.acc;\n            this.angularVelocity = 2;\n        }\n    }\n\n    // Change animation based on velocity \n    onPostUpdate() {\n        if (this.vel.x < 0) {\n            this.graphics.use(\"left\");\n        } else if (this.vel.x > 0) {\n            this.graphics.use(\"right\");\n        }\n    }\n    \n}","import * as ex from 'excalibur';\nimport { botSpriteSheet, Resources } from './resources';\nimport { Baddie } from './baddie';\n\nexport class Bot extends ex.Actor {\n    public onGround = true;\n    public jumped = false;\n    public hurt = false;\n    public hurtTime: number = 0;\n    constructor(x: number, y: number) {\n        super({\n            name: 'Bot',\n            pos: new ex.Vector(x, y),\n            collisionType: ex.CollisionType.Active,\n            collisionGroup: ex.CollisionGroupManager.groupByName(\"player\"),\n            collider: ex.Shape.Box(32, 50, ex.Vector.Half, ex.vec(0, 3))\n        });\n    }\n\n    // OnInitialize is called before the 1st actor update\n    onInitialize(engine: ex.Engine) {\n        // Initialize actor\n\n        // Setup visuals\n        const hurtleft = ex.Animation.fromSpriteSheet(botSpriteSheet, [0, 1, 0, 1, 0, 1], 150);\n        hurtleft.scale = new ex.Vector(2, 2);\n\n        const hurtright = ex.Animation.fromSpriteSheet(botSpriteSheet, [0, 1, 0, 1, 0, 1], 150);\n        hurtright.scale = new ex.Vector(2, 2);\n        hurtright.flipHorizontal = true;\n\n        const idle = ex.Animation.fromSpriteSheet(botSpriteSheet, [2, 3], 800);\n        idle.scale = new ex.Vector(2, 2);\n\n        const left = ex.Animation.fromSpriteSheet(botSpriteSheet, [3, 4, 5, 6, 7], 100);\n        left.scale = new ex.Vector(2, 2);\n\n        const right = ex.Animation.fromSpriteSheet(botSpriteSheet, [3, 4, 5, 6, 7], 100);\n        right.scale = new ex.Vector(2, 2);\n        right.flipHorizontal = true;;\n\n        // Register animations with actor\n        this.graphics.add(\"hurtleft\", hurtleft);\n        this.graphics.add(\"hurtright\", hurtright);\n        this.graphics.add(\"idle\", idle);\n        this.graphics.add(\"left\", left);\n        this.graphics.add(\"right\", right);\n\n        // onPostCollision is an event, not a lifecycle meaning it can be subscribed to by other things\n        this.on('postcollision', this.onPostCollision);\n    }\n\n    onPostCollision(evt: ex.PostCollisionEvent) {\n        // Bot has collided with it's Top of another collider\n        console.log(evt.other.name);\n        if (evt.side === ex.Side.Bottom) {\n            this.onGround = true;\n        }\n\n        // Bot has collided on the side, display hurt animation\n        if ((evt.side === ex.Side.Left ||\n             evt.side === ex.Side.Right) &&\n            evt.other instanceof Baddie) {\n            if (this.vel.x < 0 && !this.hurt) {\n                this.graphics.use(\"hurtleft\");\n            } \n            if (this.vel.x >= 0 && !this.hurt) {\n                this.graphics.use(\"hurtright\");\n            }\n            this.hurt = true;\n            this.hurtTime = 1000;\n            Resources.hit.play(.1);\n        }\n    }\n\n    // After main update, once per frame execute this code\n    onPreUpdate(engine: ex.Engine, delta: number) {\n        // If hurt, count down\n        if (this.hurtTime >= 0 && this.hurt) {\n            this.hurtTime -= delta;\n            if (this.hurtTime < 0) {\n                this.hurt = false;\n            }\n        }\n\n        // Reset x velocity\n        this.vel.x = 0;\n\n        // Player input\n        if(engine.input.keyboard.isHeld(ex.Input.Keys.Left)) {\n            this.vel.x = -150;\n        }\n\n        if(engine.input.keyboard.isHeld(ex.Input.Keys.Right)) {\n            this.vel.x = 150;\n        }\n\n        if(engine.input.keyboard.isHeld(ex.Input.Keys.Up) && this.onGround) {\n            this.vel.y = -400;\n            this.onGround = false;\n            Resources.jump.play(.1);\n        }\n\n        // Change animation based on velocity\n        if (this.vel.x < 0 && !this.hurt) {\n            this.graphics.use(\"left\");\n        } \n        if (this.vel.x > 0 && !this.hurt) {\n            this.graphics.use(\"right\");\n        }\n        if (this.vel.x === 0 && !this.hurt){\n            this.graphics.use(\"idle\")\n        }\n    }\n}","import * as ex from 'excalibur';\nimport { ExcaliburGraphicsContext } from 'excalibur';\nimport { blockSprite } from './resources';\n\nexport class Floor extends ex.Actor {\n    constructor(x: number, y: number, public cols: number, public rows: number) {\n        super({\n            name: 'Floor',\n            pos: new ex.Vector(x, y),\n            scale: new ex.Vector(2, 2),\n            anchor: ex.Vector.Zero,\n            collider: ex.Shape.Box(20 * cols, 15 * rows, ex.Vector.Zero),\n            collisionType: ex.CollisionType.Fixed,\n            collisionGroup: ex.CollisionGroupManager.groupByName(\"floor\"),\n        });\n\n        for (let i = 0; i < this.cols; i++) {\n            for (let j = 0; j < this.rows; j++) {\n                this.graphics.show(blockSprite, { \n                    anchor: ex.Vector.Zero,\n                    offset: ex.vec(i * blockSprite.width, j * blockSprite.height)\n                })\n            }\n        }\n    }\n}\n","import * as ex from 'excalibur';\nimport { Baddie } from './baddie';\nimport { Bot } from './bot';\nimport { Floor } from './floor';\nimport { NPC } from './npc';\n\nexport class Level extends ex.Scene {\n    constructor() {\n        super();\n    }\n\n    onInitialize(engine: ex.Engine) {\n\n        // Create collision groups for the game\n        ex.CollisionGroupManager.create(\"player\");\n        ex.CollisionGroupManager.create(\"enemy\");\n        ex.CollisionGroupManager.create(\"floor\");\n\n        // Compose actors in scene\n        const actor = new Bot(engine.halfDrawWidth + 100, engine.halfDrawHeight - 100);\n\n        const baddie = new Baddie(engine.halfDrawWidth - 200, 300 - 30, 1);\n        const baddie2 = new Baddie(engine.halfDrawWidth + 200, 300 - 30, -1);\n\n        const npc = new NPC(400, 170);\n        \n        const floor = new Floor(0, 300, 15, 1);\n        const otherFloor = new Floor(engine.halfDrawWidth + 50, 200, 5, 1);\n\n        engine.add(actor);\n        engine.add(npc);\n        engine.add(baddie);\n        engine.add(baddie2);\n        engine.add(floor);\n        engine.add(otherFloor);\n\n        // For the test harness to be predicable\n        if (!(window as any).__TESTING) {\n            // Create camera strategy\n            this.camera.clearAllStrategies();\n            this.camera.strategy.elasticToActor(actor, 0.05, 0.1);\n        }\n    }\n}","import * as ex from 'excalibur';\nimport { loader } from './resources';\nimport { Level } from './level';\n\nconst engine = new ex.Engine({\n    backgroundColor: ex.Color.fromHex('#5fcde4'),\n    width: 600,\n    height: 400,\n    // Turn off anti-aliasing for pixel art graphics\n    antialiasing: false\n});\n\n// Set global gravity, 800 pixels/sec^2\nex.Physics.acc = new ex.Vector(0, 800);\n\n// Setup first level as a custom scene\nconst level = new Level();\nengine.add('level', level);\nengine.goToScene('level');\n\n// Game events to handle\nengine.on('hidden', () => {\n    console.log('pause');\n    engine.stop();\n});\nengine.on('visible', () => {\n    console.log('start');\n    engine.start();\n});\n\n// Start the engine\nengine.start(loader).then(() => {\n    console.log('game start');\n});\n\n// For test hook\n(window as any).engine = engine;\n(window as any).level = level;","import * as ex from 'excalibur';\nimport { botRedSpriteSheet, Resources, npcSprite } from './resources';\n\nexport class NPC extends ex.Actor {\n    public onGround = true;\n    public hurt = false;\n    public hurtTime: number = 0;\n    constructor(x: number, y: number) {\n        super({\n            pos: new ex.Vector(x, y),\n            collisionType: ex.CollisionType.Active,\n            collisionGroup: ex.CollisionGroupManager.groupByName(\"player\"),\n            collider: ex.Shape.Box(32, 50, ex.Vector.Half, ex.vec(0, 3))\n        });\n    }\n\n    // OnInitialize is called before the 1st actor update\n    onInitialize(engine: ex.Engine) {\n        // Initialize actor\n\n        // Set the z-index to be behind everything\n        this.z = -1;\n\n        // Setup visuals\n        const hurtleft = ex.Animation.fromSpriteSheet(botRedSpriteSheet, [0, 1, 0, 1, 0, 1], 150);\n        hurtleft.scale = new ex.Vector(2, 2);\n\n        const hurtright = ex.Animation.fromSpriteSheet(botRedSpriteSheet, [0, 1, 0, 1, 0, 1], 150);\n        hurtright.scale = new ex.Vector(2, 2);\n        hurtright.flipHorizontal = true;\n\n        const idle = ex.Animation.fromSpriteSheet(botRedSpriteSheet, [2, 3], 800);\n        idle.scale = new ex.Vector(2, 2);\n\n        const left = ex.Animation.fromSpriteSheet(botRedSpriteSheet, [3, 4, 5, 6, 7], 100);\n        left.scale = new ex.Vector(2, 2);\n\n        const right = ex.Animation.fromSpriteSheet(botRedSpriteSheet, [3, 4, 5, 6, 7], 100);\n        right.scale = new ex.Vector(2, 2);\n        right.flipHorizontal = true;\n\n        // Register drawings\n        this.graphics.add(\"hurtleft\", hurtleft);\n        this.graphics.add(\"hurtright\", hurtright);\n        this.graphics.add(\"idle\", idle);\n        this.graphics.add(\"left\", left);\n        this.graphics.add(\"right\", right);\n\n        // Setup patroling behavior\n\n        // For the test harness to be predicable\n        if (!(window as any).__TESTING) {\n            this.actions.delay(1000)\n                        .repeatForever(ctx => ctx\n                            .moveBy(100, 0, 20)\n                            .moveBy(-100, 0, 20));\n        }\n\n\n        // Custom draw after local tranform, draws word bubble\n        this.graphics.onPostDraw = (ctx) => {\n            npcSprite.draw(ctx, -10, -100);\n        }\n\n    }\n\n    onPostUpdate(engine: ex.Engine, delta: number) {\n        if (this.vel.x < 0) {\n            this.graphics.use(\"left\");\n        }\n        if (this.vel.x > 0) {\n            this.graphics.use(\"right\");\n        }\n        if (this.vel.x === 0) {\n            this.graphics.use(\"idle\")\n        }\n    }\n}","import * as ex from 'excalibur';\n\nconst botFile = require('../res/excalibot.png');\nconst botRedFile = require('../res/excalibot-red.png');\nconst baddieFile = require('../res/baddie.png');\nconst blockFile = require('../res/block.png');\nconst npcFile = require('../res/npc.png');\nconst jumpSound = require('../res/jump.wav');\nconst hitSound = require('../res/hurt.wav');\nconst gotEmSound = require('../res/gottem.wav');\n\nconst Resources = {\n    bot: new ex.ImageSource(botFile),\n    botRed: new ex.ImageSource(botRedFile),\n    baddie: new ex.ImageSource(baddieFile),\n    block: new ex.ImageSource(blockFile),\n    npc: new ex.ImageSource(npcFile),\n    jump: new ex.Sound(jumpSound),\n    hit: new ex.Sound(hitSound),\n    gotEm: new ex.Sound(gotEmSound)\n}\n\nconst loader = new ex.Loader();\n\nconst botSpriteSheet = ex.SpriteSheet.fromImageSource({\n    image:Resources.bot, \n    grid: { \n        columns: 8,\n        rows: 1, \n        spriteWidth: 32,\n        spriteHeight: 32\n    }\n});\nconst botRedSpriteSheet = ex.SpriteSheet.fromImageSource({\n    image: Resources.botRed,\n    grid: {\n        columns: 8, \n        rows: 1,\n        spriteWidth: 32,\n        spriteHeight: 32\n    }\n});\nconst baddieSpriteSheet = ex.SpriteSheet.fromImageSource({\n    image: Resources.baddie,\n    grid: {\n        columns: 6, \n        rows: 1,\n        spriteWidth: 32,\n        spriteHeight: 32\n    }\n});\nconst blockSprite = Resources.block.toSprite();\nconst npcSprite = Resources.npc.toSprite();\n\nfor (const res in Resources) {\n    loader.addResource((Resources as any)[res]);\n}\n\nexport { Resources, loader, botSpriteSheet, botRedSpriteSheet, baddieSpriteSheet, blockSprite, npcSprite }","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) scriptUrl = scripts[scripts.length - 1].src\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(519);\n"],"names":["__webpack_modules__","module","__unused_webpack_exports","entryUnbind","exports","path","Object","keys","isCallable","tryToString","argument","TypeError","isObject","String","toIndexedObject","toLength","toAbsoluteIndex","createMethod","IS_INCLUDES","$this","el","fromIndex","value","O","length","index","includes","indexOf","fails","METHOD_NAME","method","call","floor","Math","mergeSort","array","comparefn","middle","insertionSort","merge","slice","element","j","i","left","right","llength","rlength","lindex","rindex","result","push","toString","it","TO_STRING_TAG_SUPPORT","classofRaw","TO_STRING_TAG","wellKnownSymbol","CORRECT_ARGUMENTS","arguments","tag","undefined","key","error","tryGet","callee","has","ownKeys","getOwnPropertyDescriptorModule","definePropertyModule","target","source","defineProperty","f","getOwnPropertyDescriptor","DESCRIPTORS","createPropertyDescriptor","object","bitmap","enumerable","configurable","writable","get","global","document","EXISTS","createElement","firefox","match","UA","test","getBuiltIn","version","userAgent","process","Deno","versions","v8","split","webkit","bind","Function","CONSTRUCTOR","METHOD","prototype","createNonEnumerableProperty","redefine","setGlobal","copyConstructorProperties","isForced","options","targetProperty","sourceProperty","descriptor","TARGET","GLOBAL","STATIC","stat","noTargetGet","forced","sham","exec","aCallable","fn","that","a","b","c","apply","FunctionPrototype","getDescriptor","PROPER","name","CONFIGURABLE","aFunction","namespace","V","P","func","check","globalThis","window","self","g","this","toObject","hasOwnProperty","hasOwn","classof","propertyIsEnumerable","store","functionToString","inspectSource","set","NATIVE_WEAK_MAP","objectHas","shared","sharedKey","hiddenKeys","OBJECT_ALREADY_INITIALIZED","WeakMap","state","wmget","wmhas","wmset","metadata","facade","STATE","enforce","getterFor","TYPE","type","replacement","feature","detection","data","normalize","POLYFILL","NATIVE","string","replace","toLowerCase","USE_SYMBOL_AS_UID","$Symbol","V8_VERSION","getOwnPropertySymbols","symbol","Symbol","__unused_webpack_module","IE8_DOM_DEFINE","anObject","toPropertyKey","$defineProperty","Attributes","propertyIsEnumerableModule","$getOwnPropertyDescriptor","internalObjectKeys","concat","getOwnPropertyNames","names","enumBugKeys","$propertyIsEnumerable","NASHORN_BUG","input","pref","val","valueOf","getOwnPropertyNamesModule","getOwnPropertySymbolsModule","InternalStateModule","CONFIGURABLE_FUNCTION_NAME","getInternalState","enforceInternalState","TEMPLATE","unsafe","simple","join","uid","SHARED","IS_PURE","mode","copyright","toInteger","max","min","integer","IndexedObject","requireObjectCoercible","ceil","isNaN","isSymbol","getMethod","ordinaryToPrimitive","TO_PRIMITIVE","exoticToPrim","toPrimitive","id","postfix","random","NATIVE_SYMBOL","iterator","WellKnownSymbolsStore","createWellKnownSymbol","withoutSetter","$","internalSort","arrayMethodIsStrict","FF","IE_OR_EDGE","V8","WEBKIT","nativeSort","sort","FAILS_ON_UNDEFINED","FAILS_ON_NULL","STRICT_METHOD","STABLE_SORT","code","chr","fromCharCode","k","v","charAt","proto","itemsLength","items","arrayLength","x","y","getSortCompare","nativeKeys","__webpack_exports__","d","_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__","_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default","n","_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__","___CSS_LOADER_EXPORT___","_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default","__WEBPACK_DEFAULT_EXPORT__","cssWithMappingToString","list","map","item","content","needLayer","modules","media","dedupe","supports","layer","alreadyImportedModules","_i","_i2","cssMapping","btoa","base64","unescape","encodeURIComponent","JSON","stringify","sourceMapping","sourceURLs","sources","sourceRoot","__webpack_module_cache__","moduleId","cachedModule","getter","__esModule","definition","o","e","obj","prop","r","toStringTag","Events_namespaceObject","SpriteEffects_namespaceObject","DrawUtil_namespaceObject","Drawing_Index_namespaceObject","Input_Index_namespaceObject","Traits_Index_namespaceObject","Experiments","Legacy","LogLevel","Util_Index_namespaceObject","polyfill","audioContext","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","callback","setInterval","cancelAnimationFrame","webkitCancelAnimationFrame","mozCancelAnimationFrame","AudioContext","webkitAudioContext","replaceMe","decodeAudioData","arrayBuffer","Promise","resolve","reject","mozAudioContext","msAudioContext","oAudioContext","devicePixelRatio","Flags","static","_FROZEN","_FLAGS","enable","WebGL","Canvas","LegacyDrawing","flagName","Error","createId","Logger","constructor","_appenders","defaultLevel","Info","_INSTANCE","addAppender","ConsoleAppender","appender","clearAppenders","_log","level","args","len","log","debug","Debug","info","warn","Warn","fatal","Fatal","console","consoleArgs","unshift","ScreenAppender","width","height","_messages","_canvas","innerWidth","innerHeight","style","position","_ctx","getContext","body","appendChild","message","clearRect","pos","opacity","fillStyle","toFixed","fillText","BITMASK32","Random","seed","_lowerMask","_upperMask","_w","_n","_m","_a","_u","_s","_b","_t","_c","_l","_f","_mt","Array","Date","now","s","_index","_twist","mag01","nextInt","next","floating","bool","likelihood","pickOne","pickSet","numPicks","allowDuplicates","_pickSetWithDuplicates","_pickSetWithoutDuplicates","currentPick","tempArray","splice","shuffle","swap","randomIndex","range","d4","d6","d8","d10","d12","d20","Side","getOpposite","side","Top","Bottom","Left","Right","None","fromDirection","direction","directions","Vector","Up","Down","directionEnum","Number","MAX_VALUE","maxIndex","dot","TwoPI","PI","extend","extended","deep","assignExists","assign","base64Encode","inputStr","b64","outputStr","byte1","charCodeAt","byte2","byte3","enc1","enc2","enc3","enc4","nullish","nullishVal","defaultVal","clamp","randomInRange","randomIntInRange","round","canonicalizeAngle","angle","tmpAngle","toDegrees","radians","toRadians","degrees","getPosition","oLeft","oTop","calcOffsetLeft","parent","offsetLeft","offsetParent","calcOffsetTop","offsetTop","addItemToArray","removeItemFromArray","contains","getOppositeSide","getSideFromDirection","Collection","initialSize","DefaultSize","_internalArray","_endPointer","_resize","newSize","newArray","count","pop","clear","internalSize","elementAt","insert","remove","removed","removeElement","toArray","forEach","fail","from","to","_x","delay","milliseconds","setTimeout","maxMessages","obsoleteMessage","resetObsoleteCounter","logMessage","suppressObsoleteMessages","isEnabled","getInstance","trace","showStackTrace","obsolete","alternateMethod","showStackTrack","property","SyntaxError","DecoratedClass","super","_y","Zero","One","Half","cos","sin","vec","Infinity","vec1","vec2","sqrt","pow","setTo","equals","vector","tolerance","abs","distance","squareDistance","magnitude","size","newLength","scale","average","add","sizeOrScale","sub","addEqual","subEqual","scaleEqual","cross","num","perpendicular","normal","negate","toAngle","atan2","rotate","anchor","sinAngle","cosAngle","clone","fixed","decorators","desc","Reflect","decorate","__decorate","MatrixLocations","Color_decorate","Color","parseInt","parseFloat","hex","h","l","HSLColor","toRGBA","lighten","factor","temp","fromRGBA","darken","saturate","desaturate","multiply","color","newR","newG","newB","newA","mulitiply","screen","color1","invert","color2","equal","format","toHSLA","toHex","_componentToHex","Black","fromHex","White","Gray","LightGray","DarkGray","Yellow","Orange","Red","Vermilion","Vermillion","Rose","Magenta","Violet","Blue","Azure","Cyan","Viridian","Green","Chartreuse","Transparent","ExcaliburBlue","p","q","t","hue2rgb","BoundingBox","leftOrOptions","top","bottom","intersection","points","minX","minY","maxX","maxY","hasZeroDimensions","center","translate","point","getPoints","fromPoints","shifted","transform","matrix","multv","getPerimeter","results","rayCast","ray","farClipDistance","tmin","tmax","xinv","dir","yinv","tx1","tx2","ty1","ty2","rayCastTime","combine","other","dimensions","intersect","totalBoundingBox","overlapX","overlapY","intersectWithSide","bb","getSideFromIntersection","debugDraw","ctx","strokeStyle","strokeRect","draw","ex","drawRect","sign","Matrix","Float32Array","_scaleSignX","_scaleSignY","near","far","mat","identity","sx","sy","angleRadians","multm","dest","a11","a21","a31","a41","a12","a22","a32","a42","a13","a23","a33","a43","a14","a24","a34","a44","b11","b21","b31","b41","b12","b22","b32","b42","b13","b23","b33","b43","b14","b24","b34","b44","getScale","setPosition","sine","cosine","setRotation","currentScale","getRotation","getScaleY","getScaleX","xscale","yscale","setScaleX","setScaleY","setScale","getBasisDeterminant","getAffineInverse","inverseDet","m","tx","ty","isIdentity","TransformStack","_transforms","_currentTransform","save","restore","current","StateStack","_states","_currentState","_getDefaultState","_cloneState","Shader","_gl","_vertexSource","_fragmentSource","program","uniforms","attributes","layout","compile","_createProgram","gl","vertexShader","fragmentShader","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","_compileShader","shader","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","VERTEX_SHADER","FRAGMENT_SHADER","addUniformMatrix","location","getUniformLocation","addUniformIntegerArray","addAttribute","glType","normalized","getAttribLocation","vertexAttributeSize","vertexSize","vert","totalVertexSizeBytes","typeSize","FLOAT","getAttributeSize","use","useProgram","offset","vertexAttribPointer","enableVertexAttribArray","uniform","uniformMatrix4fv","uniform1iv","BatchCommand","_pool","commands","isFull","canAdd","cmd","dispose","GraphicsDiagnostics","DrawCallCount","DrawnImagesCount","Pool","builder","recycler","maxObjects","totalAllocations","objects","_logger","using","context","done","borrow","poolIndex","BatchRenderer","priority","_buffer","_maxCommandsPerBatch","_batches","command","_verticesPerCommand","verticesPerCommand","maxCommandsPerBatch","batchFactory","_batchPool","init","buildShader","_vertices","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","DYNAMIC_DRAW","addCommand","lastBatch","newBatch","render","drawCallCount","drawnImagesCount","batch","vertexCount","buildBatchVertices","bufferSubData","renderBatch","DrawLine","start","end","LineRenderer","_contextInfo","addLine","vertexBuffer","_batch","drawArrays","LINES","DrawCommandType","EventTypes","DrawImageCommand","image","swidth","sheight","dx","dy","dwidth","dheight","snapToPixel","Image","view","_geom","initRect","Rectangle","initLine","thickness","Line","halfThick","startTop","startBottom","endTop","endBottom","initCircle","radius","Circle","topLeft","topRight","bottomRight","bottomLeft","applyTransform","geometry","isPowerOfTwo","ensurePowerOfTwo","nextHighestPowerOfTwo","TextureLoader","_GL","_TEXTURE_MAP","forceUpdate","tex","bindTexture","TEXTURE_2D","toPowerOfTwoImage","texImage2D","RGBA","UNSIGNED_BYTE","createTexture","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","NEAREST","TEXTURE_MAG_FILTER","potCanvas","_POT_CANVAS","potCtx","_POT_CTX","imageSmoothingEnabled","drawImage","Map","BatchImage","maxDraws","maxTextures","textures","_graphicMap","_isCommandFull","_isTextureFull","_wouldAddTexture","maybeAdd","texture","load","bindTextures","activeTexture","TEXTURE0","getBatchTextureId","ImageRenderer","getParameter","MAX_TEXTURE_IMAGE_UNITS","registerContext","maxGPUTextures","_transformFragmentSource","_","newSource","texturePickerBuilder","addCircle","addRectangle","addImage","graphic","TRIANGLES","vertIndex","sw","sh","potWidth","potHeight","textureId","commandColor","uvx0","uvy0","uvx1","uvy1","DrawPoint","PointRenderer","getExtension","addPoint","POINTS","Graphic","_d","_e","_ID","showDebug","flipHorizontal","flipVertical","rotation","origin","_width","_height","cloneGraphicOptions","localBounds","fromDimension","_preDraw","_drawImage","_postDraw","_rotate","_flip","scaleDirX","scaleDirY","watch","change","__isProxy","Proxy","watchAny","Raster","_g","_dirty","_smoothing","_color","flagDirty","_lineWidth","_lineDash","_padding","strokeColor","smoothing","lineWidth","lineDash","padding","_bitmap","bitmapWidth","bitmapHeight","maybeCtx","cloneRasterOptions","dirty","_getTotalWidth","_originalWidth","_getTotalHeight","_originalHeight","_strokeColor","rasterize","_applyRasterProperites","execute","setLineDash","getLineDash","_options","cache","GameEvent","_bubbles","bubbles","stopPropagation","KillEvent","PreKillEvent","PostKillEvent","GameStartEvent","GameStopEvent","PreDrawEvent","delta","PostDrawEvent","PreDebugDrawEvent","PostDebugDrawEvent","PreUpdateEvent","engine","PostUpdateEvent","PreFrameEvent","prevStats","PostFrameEvent","stats","GamepadConnectEvent","gamepad","GamepadDisconnectEvent","GamepadButtonEvent","button","GamepadAxisEvent","axis","SubscribeEvent","topic","handler","UnsubscribeEvent","VisibleEvent","HiddenEvent","PreCollisionEvent","actor","PostCollisionEvent","ContactStartEvent","contact","ContactEndEvent","CollisionPreSolveEvent","CollisionPostSolveEvent","CollisionStartEvent","CollisionEndEvent","InitializeEvent","ActivateEvent","oldScene","DeactivateEvent","newScene","ExitViewPortEvent","EnterViewPortEvent","EnterTriggerEvent","ExitTriggerEvent","EventDispatcher","_handlers","_wiredEventDispatchers","_target","emit","eventName","event","on","off","eventHandlers","once","ev","wire","eventDispatcher","unwire","Resource","responseType","bustCache","logger","events","isLoaded","_cacheBust","uri","request","XMLHttpRequest","open","addEventListener","status","response","statusText","send","SpriteEffects_decorate","Grayscale","updatePixel","imageData","firstPixel","pixel","avg","Invert","Opacity","Colorize","Lighten","fromRGB","Darken","Saturate","Desaturate","Fill","Texture","_sprite","loaded","_loadedResolve","_resource","Sprite_Sprite","thisArg","_arguments","generator","url","blob","URL","createObjectURL","src","decode","naturalWidth","naturalHeight","fulfilled","step","rejected","then","asSprite","Configurable","base","props","filter","SpriteImpl","imageOrConfig","drawAroundAnchor","effects","_spriteCanvas","_spriteCtx","_pixelData","_pixelsLoaded","_dirtyEffect","_opacity","_initPixelsFromTexture","drawWidth","drawHeight","_loadPixels","_flushTexture","grayscale","addEffect","fill","colorize","effect","_applyEffects","removeEffect","param","indexToRemove","getImageData","putImageData","clearEffects","reset","xpoint","ypoint","ctxOrOptions","CanvasRenderingContext2D","_drawWithOptions","_h","_j","anchorX","anchorY","oldAlpha","globalAlpha","Sprite_decorate","Sprite","sourceView","destSize","_updateSpriteDimensions","ready","nativeWidth","nativeHeight","sprite","ImageSource","fromLegacyTexture","endsWith","toSprite","unload","AnimationImpl","engineOrConfig","sprites","speed","loop","currentFrame","_timeLeftInFrame","_idempotencyToken","freezeFrame","Engine","config","_engine","_setAnchor","_setRotation","_setScale","isDone","tick","elapsed","idempotencyToken","_updateValues","skip","frames","animOptions","currSprite","play","playAnimation","Animation_Animation","images","FontUnit","TextAlign","BaseAlign","FontStyle","Direction","Animation_decorate","SpriteSheet_SpriteSheet","imageOrConfigOrSprites","columns","rows","spWidth","spHeight","spacing","_sprites","_image","_columns","_rows","_spWidth","_spHeight","_spacing","loadFromImage","isWidthError","isHeightError","RangeError","getSpacingDimensions","row","col","margin","getAnimationByIndices","indices","getAnimationBetween","beginIndex","endIndex","getAnimationForAll","getSprite","getAnimationByCoords","spriteCoordinates","maxWidth","maxHeight","coord","anim","SpriteFont","alphabet","caseInsensitive","_currentColor","_currentOpacity","_spriteRecord","_textShadowOn","_textShadowDirty","_textShadowColor","_textShadowSprites","_shadowOffsetX","_shadowOffsetY","getTextSprites","lookup","char","setTextShadow","offsetX","offsetY","shadowColor","character","useTextShadow","text","_parseOptions","characterShadow","fontSize","letterSpacing","currX","textAlign","Start","End","Center","currY","baseAlign","Hanging","Ideographic","Alphabetic","Middle","charSprite","SpriteSheet_decorate","SpriteSheet","spriteIndex","legacySpriteSheet","oldSprite","fromLegacySprite","spriteSheet","toLegacySprite","grid","cols","spriteWidth","spriteHeight","originOffset","offsetDefaults","marginDefaults","SpriteFont_SpriteFont","_text","shadow","_updateDimensions","spriteFont","_getCharacterSprites","textToRender","toLocaleLowerCase","letterIndex","letter","letterSprite","updateText","cursor","DebugText","fontSheet","_imageSource","_spriteSheet","fromImageSource","_spriteFont","write","ExcaliburGraphicsContextWebGLDebug","_webglCtx","_debugText","rectOptions","drawLine","lineOptions","__lineRenderer","drawPoint","pointOptions","__pointRenderer","drawText","ExcaliburGraphicsContextWebGL","_transform","_state","backgroundColor","canvasElement","enableTransparency","__gl","antialias","premultipliedAlpha","alpha","depth","powerPreference","_init","canvas","checkIfResolutionSupported","dim","maxDim","MAX_TEXTURE_SIZE","supported","_ortho","ortho","viewport","clearColor","COLOR_BUFFER_BIT","BLEND","blendFunc","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","__imageRenderer","__ctx","resetTransform","updateViewport","drawRectangle","drawCircle","flush","DisplayMode","Resolution","SVGA","Standard","Atari2600","GameBoy","GameBoyAdvance","NintendoDS","NES","SNES","Screen","_antialiasing","_resolutionStack","_viewportStack","_pixelRatioOverride","_isFullScreen","_isDisposed","_fullscreenChangeHandler","_pixelRatioChangeHandler","_devicePixelRatio","_calculateDevicePixelRatio","applyResolutionAndViewport","_resizeHandler","_setResolutionAndViewportByDisplayMode","_alreadyWarned","resolution","_displayMode","displayMode","Fixed","antialiasing","_browser","browser","_position","pixelRatio","_applyDisplayMode","_mediaQueryList","nativeComponent","matchMedia","_resizeObserver","disconnect","removeEventListener","isHiDpi","FillContainer","FitContainer","parentElement","_resolution","_viewport","aspectRatio","scaledWidth","scaledHeight","setCurrentCamera","camera","_camera","pushResolutionAndViewport","peekViewport","peekResolution","popResolutionAndViewport","imageRendering","isSmooth","isFullScreen","goFullScreen","requestFullscreen","exitFullScreen","exitFullscreen","pageToScreenCoordinates","newX","newY","screenHeight","screenWidth","screenToPageCoordinates","screenMarginY","screenMarginX","screenToWorldCoordinates","halfDrawWidth","halfDrawHeight","worldToScreenCoordinates","screenX","screenY","pageToWorldCoordinates","worldToPageCoordinates","getWorldBounds","canvasWidth","halfCanvasWidth","canvasHeight","halfCanvasHeight","zoom","_computeFit","overflow","aspect","adjustedWidth","adjustedHeight","_computeFitContainer","clientWidth","clientHeight","Position","_initializeDisplayModePosition","Window","ResizeObserver","observe","FillScreen","FitScreen","display","specifiedPosition","marginTop","marginLeft","AudioContextFactory","WebAudio","_UNLOCKED","create","unlockTimeoutTimer","resume","buffer","createBufferSource","ended","connect","destination","onended","playbackState","isLegacyWebAudioSource","currentTime","PLAYING_STATE","FINISHED_STATE","clearTimeout","Class","eventObject","line","x1","y1","x2","y2","cap","beginPath","lineCap","moveTo","lineTo","closePath","stroke","arc","roundRect","br","tl","tr","bl","defaultRadius","quadraticCurveTo","circle","Loader_0","Loader","loadables","_resourceList","_playButtonShown","_resourceCount","_numLoaded","_progressCounts","_totalCounts","logo","logoWidth","logoHeight","loadingBarColor","suppressPlayButton","_playButtonStyles","Z","playButtonText","startButtonFactory","buttonElement","getElementById","textContent","addResources","_imageElement","playButtonRootElement","_playButtonRootElement","playButtonElement","_playButtonElement","_playButton","existingRoot","_styleBlock","head","wireEngine","addResource","loadable","showPlayButton","hidePlayButton","resizeHandler","_positionPlayButton","evt","click","promise","startButtonHandler","removeChild","update","_delta","all","finally","unlock","markResourceComplete","progress","buttonWidth","buttonHeight","playButtonPosition","fillRect","logoY","logoX","logoPosition","imageHeight","oldAntialias","getAntialiasing","setAntialiasing","loadingX","loadingY","loadingBarPosition","progressWidth","REPORTED_FEATURES","webgl","webaudio","gamepadapi","Detector","_features","failedTests","_criticalTests","canvasSupport","elem","arrayBufferSupport","xhr","dataUrlSupport","toDataURL","objectUrlSupport","rgbaSupport","cssText","_warningTest","webAudioSupport","webglSupport","_loadBrowserFeatures","getBrowserFeatures","logBrowserFeatures","msg","arraybuffer","dataurl","objecturl","rgba","navigator","getGamepads","failedCritical","warning","CollisionType","CollisionResolutionStrategy","BroadphaseStrategy","Integrator","CoordPlane","Physics","gravity","acc","collisionResolutionStrategy","Arcade","Realistic","dynamicTreeVelocityMultiplyer","dynamicTreeVelocityMultiplier","enabled","broadphaseStrategy","DynamicAABBTree","defaultMass","integrator","Euler","boundsPadding","positionIterations","velocityIterations","slop","steeringFactor","warmStart","bodiesCanSleepByDefault","surfaceEpsilon","sleepEpsilon","wakeThreshold","sleepBias","checkForFastBodies","disableMinimumSpeedForFastBody","Physics_decorate","VectorView","_getX","getX","_getY","getY","_setX","setX","_setY","setY","Component","owner","newComponent","TagComponent","TransformComponent","X","Y","createPosView","_rotation","_scale","createScaleView","coordPlane","World","z","_recalculate","getGlobalMatrix","getGlobalTransform","globalPos","globalScale","globalRotation","parentTransform","globalScaleX","globalScaleY","applyInverse","MotionComponent","vel","scaleFactor","angularVelocity","torque","inertia","CollisionGroup","category","mask","_name","_category","_mask","canCollide","collisionGroups","combinedName","combinedCategory","reduce","All","Observable","observers","subscriptions","register","observer","subscribe","unregister","unsubscribe","notifyAll","notify","cb","Pair","colliderA","colliderB","calculatePairHash","bodyA","BodyComponent","bodyB","group","collisionType","PreventCollision","active","collide","hasCollider","collider","idA","idB","Projection","overlaps","projection","getOverlap","TreeNode","bounds","isLeaf","DynamicTree","worldBounds","root","nodes","_insert","leaf","leafAABB","currentRoot","area","combinedArea","cost","inheritanceCost","leftCost","leftCombined","newArea","oldArea","rightCost","rightCombined","oldParent","newParent","currentNode","_balance","_remove","grandParent","sibling","trackCollider","node","updateCollider","untrackCollider","multdx","multdy","balance","getHeight","query","helper","rayCastQuery","getNodes","Ray","numerator","begin","getSlope","divisor","u","getLength","intersectPoint","time","getPoint","DynamicTreeCollisionProcessor","_dynamicCollisionTree","_collisions","Set","_collisionPairCache","_colliders","getColliders","track","CompositeCollider","colliders","untrack","_shouldGenerateCollisionPair","hash","broadphase","targets","seconds","potentialColliders","pair","physics","pairs","Active","updateDistance","minDimension","fastBodies","updateVec","oldPos","centerPoint","furthestPoint","getFurthestPoint","minCollider","minTranslate","hitPoint","isValid","shift","fastBodyCollisions","narrowphase","contacts","newContacts","collisions","updated","Collider","touching","_collisionProcessor","_dynamicAABBTree","addCollider","clearColliders","removeCollider","worldPos","axes","furthestPoints","bestPoint","maxDistance","getInertia","mass","totalInertia","otherColliders","potentialCollider","getClosestLineBetween","lines","maybeLine","minLength","minLine","minPoint","minDistance","project","projs","proj","newProjection","slope","intercept","getEdge","midpoint","flip","below","clip","sideVector","clipTime","distanceToPoint","signed","x0","y0","findVectorToPoint","aMinusP","findPoint","hasPoint","currPoint","threshold","dxc","dyc","dx1","dy1","ClosestLine","p0","q0","w0","denom","sDenom","tDenom","tClosestParallel","sClosest","tClosest","ClosestLineJumpTable","PolygonPolygonClosestLine","polygonA","polygonB","otherWorldPos","otherDirection","thisDirection","rayTowardsOther","rayTowardsThis","thisPoint","otherPoint","thisFace","getClosestFace","otherFace","face","PolygonEdgeClosestLine","polygon","edge","edgeLine","asLine","PolygonCircleClosestLine","circlex","circley","CircleCircleClosestLine","circleA","circleB","CircleEdgeClosestLine","circleWorlPos","EdgeEdgeClosestLine","edgeA","edgeB","edgeLineA","edgeLineB","CircleCollider","orig","discriminant","toi","toi1","toi2","positiveToi","mintoi","shape","PolygonCollider","EdgeCollider","CollisionJumpTable","CollideCircleCircle","CollideCirclePolygon","CollideCircleEdge","getFurthestLocalPoint","bodyPos","scalars","dotProduct","newPos","CollisionContact","mtv","tangent","localPoints","_canceled","matchAwake","sleeping","sleepMotion","setSleeping","isCanceled","cancel","SeparatingAxis","polyA","polyB","bestSeparation","bestSide","bestAxis","bestSideIndex","bestOtherPoint","sides","getSides","localSides","getLocalSides","vertB","vertSeparation","separation","localSide","sideId","localPoint","polyDir","closestPointOnPoly","minOverlap","minAxis","minIndex","proj1","proj2","overlap","circleAPos","circleBPos","combinedRadius","mvt","local","findCirclePolygonSeparation","samedir","findSide","findLocalSide","cc","edgeWorld","asLocalLine","da","dda","db","ddb","den","pointOnEdge","dd","CollideEdgeEdge","CollidePolygonEdge","pc","linePoly","CollidePolygonPolygon","separationA","findPolygonPolygonSeparation","separationB","incident","reference","refDir","clipRight","clipLeft","xf","FindContactSeparation","shapeA","txA","shapeB","txB","worldPoint","circlePoint","dist","_getBodyPos","_getTransformedBegin","_getTransformedEnd","transformedBegin","transformedEnd","_boundsFromBeginEnd","edgeNormal","_transformedPoints","_axes","_sides","_localSides","winding","clockwiseWinding","reverse","_calculateTransformation","getTransformedPoints","currentSide","mostDirection","testRay","accum","pts","POSITIVE_INFINITY","faceIndex","denominator","iplusone","crossTerm","minContactTime","contactIndex","contactTime","scalar","effectiveOffset","firstPoint","Shape","Box","ColliderComponent","$colliderAdded","$colliderRemoved","_collider","flipped","onAdd","entity","precollision","postcollision","onRemove","useBoxCollider","usePolygonCollider","poly","Polygon","useCircleCollider","useEdgeCollider","Edge","useCompositeCollider","DegreeOfFreedom","dependencies","canSleep","_sleeping","bounciness","friction","useGravity","limitDegreeOfFreedom","oldVel","oldAcc","oldRotation","oldScale","inverseMass","updateMotion","currentMotion","bias","inverseInertia","motion","xFactor","yFactor","rx","applyImpulse","impulse","finalImpulse","Rotation","distanceFromCenter","applyLinearImpulse","applyAngularImpulse","captureOldTransform","CullingBox","_topLeft","_topRight","_bottomLeft","_bottomRight","isSpriteOffScreen","drawingWidth","currentDrawing","drawingHeight","getGlobalPos","topLeftScreen","topRightScreen","bottomLeftScreen","bottomRightScreen","_xCoords","_yCoords","_xMin","_yMin","_xMax","_yMax","minWorld","maxWorld","_xMinWorld","_yMinWorld","_xMaxWorld","_yMaxWorld","boundingPoints","rect","OffscreenCulling","cullingBox","actorBoundsOffscreen","currentScene","isOffScreen","removeComponent","addComponent","CapturePointer","enableCapturePointer","isKilled","pointers","checkAndUpdateActorUnderPointer","AddedComponent","isAddedComponent","RemovedComponent","isRemovedComponent","Entity","components","_componentsToRemove","_componentTypeToInstance","_componentStringToInstance","_tagsMemo","_typesMemo","componentAdded$","componentRemoved$","_parent","childrenAdded$","childrenRemoved$","_children","_isInitialized","_setName","component","kill","tags","hasTag","addTag","removeTag","force","types","_rebuildMemos","values","getComponents","_notifyAddComponent","added","_notifyRemoveComponent","children","unparent","addChild","getAncestors","removeAllChildren","getDescendants","queue","curr","newEntity","child","addTemplate","templateEntity","ctor","constuctorType","componentOrType","_removeComponentByType","delete","processComponentRemoval","isInitialized","_initialize","onInitialize","_preupdate","onPreUpdate","_postupdate","onPostUpdate","CanvasDrawComponent","hasGraphicsTick","GraphicsLayer","_graphics","graphics","hide","nameOrGraphic","gfx","getGraphic","show","copyGraphics","getNames","order","currentKeys","GraphicsLayers","_component","_layers","_layerMap","default","_maybeAddLayer","_getLayer","graphicsLayerKeys","GraphicsComponent","visible","_bounds","onPreDraw","onPostDraw","layers","graphicToSet","_radius","RotationType","EasingFunctions","easing","duration","CreateReversibleEasingFunction","Linear","startValue","endValue","EaseInQuad","EaseOutQuad","EaseInOutQuad","EaseInCubic","EaseOutCubic","EaseInOutCubic","EasingFunctions_decorate","ActionQueue","_actions","_completedActions","_entity","action","clearActions","_currentAction","stop","getActions","hasNext","isComplete","elapsedMs","Repeat","repeatBuilder","repeat","_stopped","_repeatBuilder","_repeatContext","ActionContext","_actionQueue","getQueue","_repeat","_originalRepeat","RepeatForever","MoveBy","_started","_tx","_motion","_speed","_offset","_start","_end","_distance","_dir","MoveTo","destx","desty","RotateTo","rotationType","_rotationType","ShortestPath","_currentNonCannonAngle","distance1","distance2","_shortDistance","_longDistance","_shortestPathIsPositive","_direction","LongestPath","Clockwise","CounterClockwise","distanceTravelled","RotateBy","angleRadiansOffset","ScaleTo","scaleX","scaleY","speedX","speedY","_endX","_endY","_speedX","_speedY","_startX","_startY","_distanceX","_distanceY","directionX","directionY","ScaleBy","scaleOffsetX","scaleOffsetY","_startScale","_endScale","_directionX","_directionY","CallMethod","_method","_hasBeenCalled","EaseTo","easingFcn","_currentLerpTime","_lerpDuration","_lerpStart","_lerpEnd","_initialized","Blink","timeVisible","timeNotVisible","numBlinks","_timeVisible","_timeNotVisible","_elapsedTime","_totalTime","_duration","Fade","endOpacity","_multiplier","_endOpacity","Delay","_delay","Die","ActionsComponent","Follow","entityToFollow","followDistance","_followTx","_followMotion","_current","_maximumDistance","_distanceBetween","actorToFollowSpeed","Meet","actorToMeet","_speedWasSpecified","_meetTx","_meetMotion","actorToMeetSpeed","_queue","easeTo","xOrPos","yOrSpeed","speedOrUndefined","moveBy","xOffsetOrVector","yOffsetOrSpeed","xOffset","yOffset","rotateTo","rotateBy","scaleTo","sizeXOrVector","sizeYOrSpeed","speedXOrUndefined","speedYOrUndefined","sizeX","sizeY","scaleBy","sizeOffsetXOrVector","sizeOffsetYOrSpeed","sizeOffsetX","sizeOffsetY","blink","fade","die","callMethod","times","repeatForever","follow","meet","asPromise","toPromise","Actor_decorate","Actor","_anchor","_handleAnchorChange","scene","_draggable","_dragging","_pointerDragStartHandler","_pointerDragEndHandler","_pointerDragMoveHandler","pe","pointer","lastWorldPos","_pointerDragLeaveHandler","traits","capturePointer","captureMoveEvents","captureDragEvents","_capturePointerEvents","_captureMoveEvents","_captureDragEvents","collisionGroup","defaults","Passive","actions","thePos","theVel","theAcc","theAngle","isVisible","draggable","isDraggable","_checkForPointerOptIn","_prekill","_scene","onPreKill","_postkill","onPostKill","unkill","setDrawing","addDrawing","getZIndex","newZ","setZIndex","newIndex","getGlobalScale","getGlobalRotation","recurse","geom","containment","some","within","otherCollider","me","drawing","currFrame","trait","_predraw","_postdraw","ScreenElement_ScreenElement","useWorld","coords","Timer","fcn","interval","repeats","numberOfRepeats","_totalTimeAlive","_running","_numberOfTicks","maxNumberOfRepeats","_complete","_MAX_ID","_callbacks","complete","newInterval","newNumberOfRepeats","timesRepeated","getTimeRunning","timeToNextAction","timeElapsedTowardNextAction","isRunning","pause","unpause","cancelTimer","Timer_decorate","Axis","TileMap_decorate","TileMapImpl","xOrConfig","cellWidth","cellHeight","_token","_onScreenXStart","_onScreenXEnd","_onScreenYStart","_onScreenYEnd","_spriteSheets","_legacySpriteMap","_cols","isOffscreen","_composite","currentCol","cd","Cell","registerSpriteSheet","fromLegacySpriteSheet","_updateColliders","tile","solid","prev","getCellByIndex","getCell","getCellByPoint","cell","getRows","getColumns","worldCoordsUpperLeft","worldCoordsLowerRight","xEnd","yEnd","graphicsIndex","graphicsLen","TileMap","CellImpl","_solid","pushSprite","addGraphic","removeGraphic","clearGraphics","StrategyContainer","lockToActor","addStrategy","LockCameraToActorStrategy","lockToActorAxis","LockCameraToActorAxisStrategy","elasticToActor","cameraElasticity","cameraFriction","ElasticToActorStrategy","radiusAroundActor","RadiusAroundActorStrategy","limitCameraBounds","box","LimitCameraBoundsStrategy","_cam","_eng","cam","currentFocus","getFocus","focus","cameraVel","stretch","boundSizeChecked","focusX","focusY","Camera","_cameraStrategies","strategy","_z","dz","az","_posChanged","_pos","_cameraMoving","_isShaking","_shakeMagnitudeX","_shakeMagnitudeY","_shakeDuration","_elapsedShakeTime","_xShake","_yShake","_isZooming","_zoomStart","_zoomEnd","_currentZoomTime","_zoomDuration","_zoomEasing","_easing","_halfWidth","_halfHeight","_follow","ax","ay","move","easingFn","_lerpPromise","_lerpResolve","shake","magnitudeX","magnitudeY","zoomOverTime","_zoomPromise","_zoomResolve","cameraStrategy","removeStrategy","clearAllStrategies","currentRes","loadingComplete","res","newZoom","zoomEasing","lerpPoint","CreateVectorEasingFunction","moveEasing","_isDoneShaking","newCanvasWidth","newCanvasHeight","isScreenElement","triggerDefaults","Trigger_Trigger","opts","_dispatchAction","wp","SystemType","System","_entityAddedOrRemoved","AddedEntity","isAddedSystemEntity","RemovedEntity","isRemoveSystemEntity","EntityManager","_world","entities","_entityIndex","_entitiesToRemove","updateEntities","_context","removeEntity","findEntitiesForRemoval","queryManager","addEntity","idOrEntity","deferred","actors","killed","processEntityRemovals","processComponentRemovals","getById","getByName","buildTypeKey","localeCompare","Query","_entities","T","_key","getEntities","matches","typesOrEntity","contain","QueryManager","_queries","_addQuery","entityManager","maybeRemoveQuery","queryType","createQuery","maybeExistingQuery","getQuery","SystemManager","systems","initialized","systemType","find","addSystem","system","initialize","removeSystem","updateSystems","preupdate","Scene","postupdate","systemManager","Update","entityOrSystem","clearEntities","clearSystems","EulerIntegrator","totalAcc","MotionSystem","optionalBody","integrate","CollisionSolver","solve","preSolve","solveVelocity","solvePosition","postSolve","ArcadeSolver","opposite","velAdj","ContactConstraintPoint","normalImpulse","tangentImpulse","normalMass","tangentMass","aToContact","bToContact","aToContactNormal","bToContactNormal","aToContactTangent","bToContactTangent","getRelativeVelocity","velA","RealisticSolver","lastFrameContacts","idToContactConstraint","getContactConstraints","finishedContactIds","contactPoints","pointIndex","constraints","maxCorrection","steeringForce","restitution","impulseDelta","maxFriction","newImpulse","CollisionSystem","_realisticSolver","_arcadeSolver","_processor","_lastFrameContacts","_currentFrameContacts","_trackCollider","_untrackCollider","colliderComponent","colliderComp","getSolver","runContactStartEnd","AnimationDirection","AnimationStrategy","EmitterType","Animation","Loop","frameDuration","timeScale","_firstTick","_currentFrame","_done","_playing","_reversed","totalDuration","goToFrame","frameIndices","durationPerFrameMs","invalidIndices","_LOGGER","animation","legacySprites","Freeze","currentFrameIndex","isPlaying","Backward","Forward","canFinish","frameNumber","maybeFrame","_nextFrame","PingPong","elapsedMilliseconds","GraphicsGroup","members","_isAnimationOrGroup","member","maybeAnimation","ParticleImpl","emitterOrConfig","life","beginColor","endColor","velocity","acceleration","startSize","endSize","particleRotationalVelocity","currentRotation","focusAccel","fadeFlag","_rRate","_gRate","_bRate","_aRate","emitter","particleSize","particleSprite","sizeRate","elapsedMultiplier","ParticleEmitter","tmpColor","removeParticle","accel","Particle","_particlesToEmit","numParticles","isEmitting","particles","deadParticles","minVel","maxVel","minAngle","maxAngle","emitRate","particleLife","minSize","maxSize","_og","emitterType","randomRotation","particle","emitParticles","particleCount","_createParticle","world","clearParticles","ranX","ranY","GraphicsSystem","Draw","_graphicsContext","graphicsContext","_clearScreen","entityOffscreen","_isOffscreen","_pushCameraTransform","_applyTransform","particleOpacity","_drawGraphicsComponent","_popCameraTransform","drawnImages","drawCalls","graphicsComponent","isDebug","showBounds","boundsColor","ancestors","ancestor","CanvasDrawingSystem","canvasdraw","offscreen","DebugSystem","_collisionSystem","filterSettings","entitySettings","txSettings","motionSettings","colliderSettings","physicsSettings","graphicsSettings","bodySettings","cameraSettings","useFilter","ids","nameQuery","lineHeight","showAll","showPosition","positionColor","showId","showName","showRotation","fromAngle","rotationColor","showScale","scaleColor","showCollisionGroup","showCollisionType","showMass","showMotion","showSleeping","showVelocity","velocityColor","showAcceleration","accelerationColor","showGeometry","geometryColor","showOwner","showBroadphaseSpacePartitionDebug","showCollisionContacts","showCollisionNormals","collisionContactColor","collisionNormalColor","showFocus","focusColor","showZoom","ActionsSystem","ColorBlindness","Keys","PointerType","PointerScope","NativePointerButton","PointerButton","WheelDeltaMode","Scene_decorate","_timers","_cancelQueue","triggers","tileMaps","screenElements","onActivate","_oldScene","_newScene","onDeactivate","_initializeChildren","_activate","_deactivate","removeTimer","timer","_collectActorStats","dispatchPointerEvents","addTimer","addScreenElement","removeScreenElement","addTileMap","tileMap","removeTileMap","isTimerActive","isCurrentScene","_ui","ui","alive","ColorBlindCorrector","simulate","colorMode","Protanope","_vertexShader","_fragmentShader","_internalCanvas","preserveDrawingBuffer","_program","_getShader","_getFragmentShaderByMode","vertextShader","Deuteranope","Tritanope","_setRectangle","STATIC_DRAW","out","positionLocation","texCoordLocation","texCoordBuffer","pixelStorei","UNPACK_FLIP_Y_WEBGL","resolutionLocation","uniform2f","positionBuffer","pixelData","Uint8Array","readPixels","ColorBlindFlags","correct","colorBlindness","postProcessors","FrameStats","prevFrame","colorBlindMode","_id","_fps","_actorStats","remaining","total","_durationStats","_physicsStats","PhysicsStats","_graphicsStats","otherStats","fps","fs","_pairs","_contacts","_fastBodies","_fastBodyCollisions","_broadphase","_narrowphase","ps","KeyEvent","originalEvent","Keyboard","_keys","_keysUp","_keysDown","noop","keyEvent","getKeys","wasPressed","isHeld","wasReleased","Pointer","_isDown","_wasDown","_actorsUnderPointer","_actors","_actorsLastFrame","_actorsNoLongerUnderPointer","_actorSortingFcn","lastPagePos","lastScreenPos","dragTarget","_onPointerMove","_onPointerDown","_onPointerUp","isDragging","isDragStart","isDragEnd","hasActorsUnderPointer","addActorUnderPointer","isActorAliveUnderPointer","removeActorUnderPointer","getActorsUnderPointer","getActorsUnderPointerLastFrame","getActorsForEvents","checkActorUnderPointer","wasActorUnderPointer","pagePos","screenPos","_ev","PointerEvent","coordinates","pointerType","propagate","doAction","_onActionStart","_onActionEnd","_actor","PointerEventFactory","_pointerEventType","PointerDragEvent","PointerUpEvent","PointerDownEvent","PointerMoveEvent","PointerEnterEvent","PointerLeaveEvent","PointerCancelEvent","WheelEvent","pageX","pageY","deltaX","deltaY","deltaZ","deltaMode","_isCanceled","createPointerEventByName","factory","GlobalCoordinates","yOrEngine","engineOrUndefined","ScrollWheelNormalizationFactor","Pointers","_pointerDown","_pointerUp","_pointerMove","_pointerCancel","_wheel","_pointers","_activePointers","primary","_handleTouchEvent","touchAction","_handlePointerEvent","MSPointerEvent","msTouchAction","_handleMouseEvent","wheelOptions","passive","pageScrollPreventionMode","ScrollPreventionMode","_handleWheelEvent","onmousewheel","triggerEvent","pointerId","eventish","preventDefault","at","_dispatchWithBubble","_dispatchPointerLeaveEvents","lastMoveEventPerPointerPerActor","pointerLeave","_dispatchPointerEnterEvents","lastMoveEventPerPointer","pointerEnter","_propagateWheelPointerEvent","wheelEvent","eventArr","fromPagePosition","Mouse","_nativeButtonToPointerButton","changedTouches","_getPointerIndex","identifier","Touch","Unknown","_stringToPointerType","wheelDeltaX","wheelDeltaY","wheelDelta","detail","Pixel","Page","we","idx","NoButton","Pen","Gamepads","_gamePadTimeStamps","_oldPads","_pads","_initSuccess","_navigator","_minimumConfiguration","_clonePads","setMinimumGamepadConfiguration","_enableAndUpdate","_isGamepadValid","pad","axesLength","buttonLength","buttons","connected","gamepads","timestamp","bi","ai","navigatorGamepad","Buttons","getButton","pressed","updateButton","Axes","getAxes","updateAxes","_clonePad","Gamepad","getValidGamepads","pads","arr","clonedPad","MinAxisMoveThreshold","_buttons","isButtonPressed","buttonIndex","axesIndex","BrowserComponent","_paused","_nativeHandlers","_decorate","BrowserEvents","_windowGlobal","_documentGlobal","_windowComponent","_documentComponent","ExcaliburGraphicsContext2DCanvasDebug","_ex","ExcaliburGraphicsContext2DCanvas","Engine_decorate","_hasStarted","scenes","_animations","_suppressPlayButton","pauseAudioWhenHidden","_isDebug","debugColor","enableCanvasTransparency","onFatalException","_timescale","_isLoading","_deferredGoTo","_loadingComplete","_DEFAULT_ENGINE_OPTIONS","freeze","detector","suppressMinimumBrowserFeatureDetection","_compatible","innerText","testMessage","canvasElementId","suppressConsoleBootMessage","EX_VERSION","ex2dCtx","exWebglCtx","suppressHiDPIScaling","_loader","rootScene","addScene","isFullscreen","timescale","AnimationNode","removeScene","goToScene","hidden","visibilityChange","scrollPreventionMode","keyboard","pointerScope","Document","_overrideInitialize","_update","_draw","font","toggle","toggleDebug","loader","createMainLoop","game","raf","nowFn","lastTime","mainloop","_requestId","frameId","beforeUpdate","afterUpdate","afterDraw","isPaused","screenshot","raw","MediaEvent","_value","_path","_val","layPath","NativeSoundEvent","NativeSoundProcessedEvent","_processedData","Font","_k","quality","family","Normal","bold","unit","Px","LeftToRight","_textBounds","_textWidth","_textHeight","blur","fontString","numLines","_lines","_rasterWidth","_rasterHeight","_halfRasterWidth","_halfRasterHeight","_applyFont","maxWidthLine","metrics","measureText","actualBoundingBoxLeft","actualBoundingBoxRight","actualBoundingBoxAscent","actualBoundingBoxDescent","lineAdjustedHeight","bottomBounds","textBaseline","shadowBlur","shadowOffsetX","shadowOffsetY","strokeText","Text","_font","Label_decorate","Label_Label","isBold","fontFamily","sizeInUnit","fontStyle","fontUnit","align","_legacySpriteFont","sf","fromLegacySpriteFont","getTextWidth","clearTextShadow","exctx","CollisionGroupManager","_CURRENT_GROUP","_MAX_GROUPS","_GROUPS","_CURRENT_BIT","groups","_STARTING_BIT","filled","_points","fillColor","lineColor","Polygon_decorate","ExResponse","has_initialize","hasOnInitialize","has_preupdate","hasOnPreUpdate","has_postupdate","hasOnPostUpdate","hasPreDraw","hasPostDraw","any","json","WebAudioInstance","_src","_volume","_loop","_isPlaying","_isPaused","_audioContext","_volumeNode","createGain","_currentOffset","_createNewBufferSource","_instance","_wireUpOnEnded","volume","gain","setTargetAtTime","_playbackRate","playbackRate","playStarted","_resumePlayBack","_startPlayBack","_playingPromise","_setPauseOffset","_handleOnEnded","_playingResolve","_rememberStartTime","restartTime","amend","_startTime","getTime","setValueAtTime","canPlayFile","file","Audio","filetype","canPlayType","Sound_awaiter","Sound","paths","_isStopped","_tracks","_wasPlayingOnHidden","instances","audiobuffer","decodeAudio","instanceCount","_resumePlayback","_startPlayback","getTrackId","resumed","_getTrackInstance","newTrack","Gif","_stream","_gif","_textures","_animation","_transparentColor","Stream","ParseGif","toLegacySpriteSheet","toSpriteSheet","toLegacyAnimation","toAnimation","fromSpriteSheet","readCheckBytes","checkBytes","bitsToNum","ba","byteToBitArr","bite","dataArray","readByte","byteLength","readBytes","bytes","read","readUnsigned","stream","_st","_handler","globalColorTable","parseColorTable","entries","ct","readSubBlocks","parseHeader","hdr","sig","ver","colorRes","globalColorTableSize","gctFlag","sorted","bgColor","pixelAspectRatio","bits","parseExt","block","parseGCExt","reserved","disposalMethod","userInput","transparencyGiven","delayTime","transparencyIndex","terminator","gce","parseComExt","comment","com","parsePTExt","ptHeader","ptData","pte","parseAppExt","authCode","unknown","iterations","app","NETSCAPE","parseNetscapeExt","appData","parseUnknownAppExt","parseUnknownExt","label","extType","parseImg","img","leftPos","topPos","lctFlag","interlaced","lctSize","lct","lzwMinCodeSize","lzwData","pixels","minCodeSize","readCode","output","clearCode","eoiCode","codeSize","dict","last","lzwDecode","newPixels","cpRow","toRow","fromRow","fromPixels","offsets","steps","pass","deinterlace","arrayToImage","parseBlock","sentinel","eof","frame","Polygon_Polygon","SortedList_decorate","SortedList","getComparable","_getComparable","_find","_root","getKey","getData","getLeft","getRight","_get","BinaryTreeNode","setLeft","setRight","removeByComparable","elementIndex","_findMinNode","setKey","setData","_cleanup","comparable","_list","treeNode","_data","_left","_right","MockedElement","getTheKey","Promise_1","PromiseState","Promises_Promise","Pending","_successCallbacks","_rejectCallback","promises","isArray","joinedPromise","successes","rejects","errors","successCallback","rejectCallback","Resolved","_handleError","Rejected","errorCallback","_errorCallback","Promises_decorate","__webpack_exports__ActionContext","fWn","__webpack_exports__ActionQueue","Ia8","__webpack_exports__ActionsComponent","hLI","__webpack_exports__ActionsSystem","yyv","__webpack_exports__ActivateEvent","tX5","__webpack_exports__Actor","vtX","__webpack_exports__AddedComponent","r7K","__webpack_exports__AddedEntity","lCh","__webpack_exports__Animation","fwF","__webpack_exports__AnimationDirection","sce","__webpack_exports__AnimationStrategy","_c7","__webpack_exports__ArcadeSolver","KUs","__webpack_exports__AudioContextFactory","Ajp","__webpack_exports__Axis","RDh","__webpack_exports__BaseAlign","_H9","__webpack_exports__BinaryTreeNode","Ulf","__webpack_exports__Blink","mxs","__webpack_exports__BodyComponent","OmD","__webpack_exports__BoundingBox","kBf","__webpack_exports__BroadphaseStrategy","C4F","__webpack_exports__BrowserComponent","NQt","__webpack_exports__BrowserEvents","JjN","__webpack_exports__Camera","V1s","__webpack_exports__Canvas","Xz7","__webpack_exports__Cell","bLd","__webpack_exports__Circle","Cdc","__webpack_exports__CircleCollider","FKn","__webpack_exports__Class","wTW","__webpack_exports__ClosestLine","ab2","__webpack_exports__ClosestLineJumpTable","GfZ","__webpack_exports__Collider","YMS","__webpack_exports__ColliderComponent","oyv","__webpack_exports__CollisionContact","aUb","__webpack_exports__CollisionEndEvent","SdD","__webpack_exports__CollisionGroup","JUv","__webpack_exports__CollisionGroupManager","jEj","__webpack_exports__CollisionJumpTable","TFq","__webpack_exports__CollisionPostSolveEvent","HDU","__webpack_exports__CollisionPreSolveEvent","R_y","__webpack_exports__CollisionResolutionStrategy","ydN","__webpack_exports__CollisionSolver","_N2","__webpack_exports__CollisionStartEvent","t50","__webpack_exports__CollisionSystem","s$$","__webpack_exports__CollisionType","v2G","__webpack_exports__Color","Ilk","__webpack_exports__ColorBlindCorrector","H_9","__webpack_exports__ColorBlindFlags","s9i","__webpack_exports__ColorBlindness","ksl","__webpack_exports__Component","wA2","__webpack_exports__CompositeCollider","R_p","__webpack_exports__Configurable","IQ$","__webpack_exports__ConsoleAppender","I5F","__webpack_exports__ContactConstraintPoint","X8$","__webpack_exports__ContactEndEvent","FR6","__webpack_exports__ContactStartEvent","U8o","__webpack_exports__CoordPlane","kbG","__webpack_exports__CullingBox","oeJ","__webpack_exports__DeactivateEvent","iS_","__webpack_exports__Debug","cGG","__webpack_exports__DebugSystem","skb","__webpack_exports__DebugText","SLU","__webpack_exports__DegreeOfFreedom","RdJ","__webpack_exports__Detector","gU7","__webpack_exports__Die","LSk","__webpack_exports__Direction","Nmp","__webpack_exports__DisplayMode","d1Y","__webpack_exports__DynamicTree","xrL","__webpack_exports__DynamicTreeCollisionProcessor","sRW","__webpack_exports__EX_VERSION","cmV","__webpack_exports__EaseTo","N0Q","__webpack_exports__EasingFunctions","q8b","__webpack_exports__EdgeCollider","ynB","__webpack_exports__ElasticToActorStrategy","jT9","__webpack_exports__EmitterType","wAz","__webpack_exports__Engine","D4V","__webpack_exports__EnterTriggerEvent","N6H","__webpack_exports__EnterViewPortEvent","W1A","__webpack_exports__Entity","JHW","__webpack_exports__EntityManager","v2K","__webpack_exports__EventDispatcher","pBf","__webpack_exports__EventTypes","GMl","__webpack_exports__Events","zW2","__webpack_exports__ExResponse","B0K","__webpack_exports__ExcaliburGraphicsContext2DCanvas","Nv7","__webpack_exports__ExcaliburGraphicsContextWebGL","C_p","__webpack_exports__ExitTriggerEvent","MUA","__webpack_exports__ExitViewPortEvent","xqU","__webpack_exports__Experiments","peG","__webpack_exports__Fade","pTp","__webpack_exports__Flags","vUK","__webpack_exports__Follow","j9l","__webpack_exports__Font","Zxw","__webpack_exports__FontStyle","Hdx","__webpack_exports__FontUnit","Z$d","__webpack_exports__FrameStats","o$7","__webpack_exports__GameEvent","Zm$","__webpack_exports__GameStartEvent","$QH","__webpack_exports__GameStopEvent","i78","__webpack_exports__GamepadAxisEvent","h6u","__webpack_exports__GamepadButtonEvent","hts","__webpack_exports__GamepadConnectEvent","j88","__webpack_exports__GamepadDisconnectEvent","VME","__webpack_exports__Gif","nt","__webpack_exports__GlobalCoordinates","Ukr","__webpack_exports__Graphic","zsu","__webpack_exports__GraphicsComponent","oA6","__webpack_exports__GraphicsGroup","TVh","__webpack_exports__GraphicsLayer","TwZ","__webpack_exports__GraphicsLayers","GTT","__webpack_exports__GraphicsSystem","xxj","__webpack_exports__HiddenEvent","XdK","__webpack_exports__ImageSource","cXo","__webpack_exports__InitializeEvent","Dm5","__webpack_exports__Input","IIB","__webpack_exports__Integrator","zI0","__webpack_exports__KillEvent","SKZ","__webpack_exports__Label","__J","__webpack_exports__Legacy","Dvr","__webpack_exports__LegacyDrawing","Tf9","__webpack_exports__LimitCameraBoundsStrategy","RI$","__webpack_exports__Line","x12","__webpack_exports__Loader","aNw","__webpack_exports__LockCameraToActorAxisStrategy","xwn","__webpack_exports__LockCameraToActorStrategy","dNK","__webpack_exports__LogLevel","ini","__webpack_exports__Logger","YdH","__webpack_exports__Matrix","y3G","__webpack_exports__MatrixLocations","l57","__webpack_exports__MediaEvent","xn0","__webpack_exports__Meet","t2V","__webpack_exports__MockedElement","ZyS","__webpack_exports__MotionComponent","uxB","__webpack_exports__MotionSystem","cpd","__webpack_exports__MoveBy","fiy","__webpack_exports__MoveTo","$XZ","__webpack_exports__NativeSoundEvent","uqK","__webpack_exports__NativeSoundProcessedEvent","STE","__webpack_exports__Observable","y$z","__webpack_exports__Pair","sOq","__webpack_exports__ParseGif","Sqs","__webpack_exports__Particle","hpZ","__webpack_exports__ParticleEmitter","Vol","__webpack_exports__Physics","wIZ","__webpack_exports__PhysicsStats","cBi","__webpack_exports__Polygon","mgq","__webpack_exports__PolygonCollider","YVA","__webpack_exports__Pool","Kgp","__webpack_exports__PostCollisionEvent","HH$","__webpack_exports__PostDebugDrawEvent","M_d","__webpack_exports__PostDrawEvent","rgh","__webpack_exports__PostFrameEvent","Ra6","__webpack_exports__PostKillEvent","KhR","__webpack_exports__PostUpdateEvent","BS5","__webpack_exports__PreCollisionEvent","xhz","__webpack_exports__PreDebugDrawEvent","xOq","__webpack_exports__PreDrawEvent","a9j","__webpack_exports__PreFrameEvent","bHk","__webpack_exports__PreKillEvent","CgK","__webpack_exports__PreUpdateEvent","cuY","__webpack_exports__Projection","kvE","__webpack_exports__Promise","JDb","__webpack_exports__PromiseState","Cbi","__webpack_exports__Query","AE_","__webpack_exports__QueryManager","ctO","__webpack_exports__RadiusAroundActorStrategy","OLH","__webpack_exports__Random","kky","__webpack_exports__Raster","nSF","__webpack_exports__Ray","zHn","__webpack_exports__RealisticSolver","zwx","__webpack_exports__Rectangle","AeJ","__webpack_exports__RemovedComponent","hLz","__webpack_exports__RemovedEntity","D9g","__webpack_exports__Repeat","wA","__webpack_exports__RepeatForever","jhr","__webpack_exports__Resolution","GVs","__webpack_exports__Resource","_zO","__webpack_exports__RotateBy","w6$","__webpack_exports__RotateTo","mhV","__webpack_exports__RotationType","MOD","__webpack_exports__ScaleBy","kwd","__webpack_exports__ScaleTo","Lmr","__webpack_exports__Scene","xsS","__webpack_exports__Screen","lLr","__webpack_exports__ScreenAppender","Z$r","__webpack_exports__ScreenElement","IXb","__webpack_exports__ScrollPreventionMode","SMj","__webpack_exports__Shape","bnF","__webpack_exports__Side","MFA","__webpack_exports__SortedList","$XC","__webpack_exports__Sound","$uU","__webpack_exports__Sprite","jyi","__webpack_exports__SpriteFont","E03","__webpack_exports__SpriteSheet","V6q","__webpack_exports__StrategyContainer","nVo","__webpack_exports__Stream","F6N","__webpack_exports__SubscribeEvent","ad3","__webpack_exports__System","xP7","__webpack_exports__SystemManager","Odq","__webpack_exports__SystemType","Zif","__webpack_exports__TagComponent","ZGJ","__webpack_exports__Text","xvT","__webpack_exports__TextAlign","PHM","__webpack_exports__TileMap","KwO","__webpack_exports__Timer","B7y","__webpack_exports__Traits","SFp","__webpack_exports__TransformComponent","Uvn","__webpack_exports__TreeNode","OFT","__webpack_exports__Trigger","xzN","__webpack_exports__UnsubscribeEvent","H6j","__webpack_exports__Util","ZrN","__webpack_exports__Vector","OWs","__webpack_exports__VectorView","dF9","__webpack_exports__VisibleEvent","VHo","__webpack_exports__WebAudioInstance","R$E","__webpack_exports__World","q3I","__webpack_exports__canonicalizeAngle","Pab","__webpack_exports__clamp","uZ5","__webpack_exports__createId","McK","__webpack_exports__hasGraphicsTick","k0b","__webpack_exports__hasOnInitialize","hnT","__webpack_exports__hasOnPostUpdate","RSJ","__webpack_exports__hasOnPreUpdate","Mku","__webpack_exports__hasPostDraw","h90","__webpack_exports__hasPreDraw","rms","__webpack_exports__has_initialize","ErP","__webpack_exports__has_postupdate","aVg","__webpack_exports__has_preupdate","lPc","__webpack_exports__isAddedComponent","Z8E","__webpack_exports__isAddedSystemEntity","NNA","__webpack_exports__isRemoveSystemEntity","yFn","__webpack_exports__isRemovedComponent","lNv","__webpack_exports__maxMessages","MZQ","__webpack_exports__obsolete","FUM","__webpack_exports__randomInRange","vdf","__webpack_exports__randomIntInRange","iaL","__webpack_exports__range","w6H","__webpack_exports__resetObsoleteCounter","Q4c","__webpack_exports__toDegrees","Uxb","__webpack_exports__toRadians","Yr5","__webpack_exports__vec","Bhw","Baddie","groupByName","baddieSpriteSheet","__TESTING","onPostCollision","Bot","Resources","gotEm","onGround","jumped","hurt","hurtTime","hurtleft","botSpriteSheet","hurtright","idle","hit","Input","jump","Floor","blockSprite","Level","baddie","baddie2","npc","NPC","otherFloor","botRedSpriteSheet","npcSprite","botFile","botRedFile","baddieFile","blockFile","npcFile","jumpSound","hitSound","gotEmSound","bot","botRed","__webpack_require__","scriptUrl","importScripts","currentScript","scripts","getElementsByTagName"],"sourceRoot":""}