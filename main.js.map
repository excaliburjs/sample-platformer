{"version":3,"file":"main.js","mappings":"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M,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,GAAI,IAAM,GACVC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,GAAI,IAAM,GACVC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,GACXC,IAAK,IAAM,EACXC,IAAK,IAAM,GACXC,IAAK,IAA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","sources":["webpack://sample-platformer/./node_modules/excalibur/build/esm/excalibur.js","webpack://sample-platformer/./src/baddie.ts","webpack://sample-platformer/./src/bot.ts","webpack://sample-platformer/./src/floor.ts","webpack://sample-platformer/./src/level.ts","webpack://sample-platformer/./src/main.ts","webpack://sample-platformer/./src/npc.ts","webpack://sample-platformer/./src/resources.ts","webpack://sample-platformer/webpack/bootstrap","webpack://sample-platformer/webpack/runtime/define property getters","webpack://sample-platformer/webpack/runtime/global","webpack://sample-platformer/webpack/runtime/hasOwnProperty shorthand","webpack://sample-platformer/webpack/runtime/make namespace object","webpack://sample-platformer/webpack/runtime/publicPath","webpack://sample-platformer/webpack/startup"],"sourcesContent":["/*!\n * excalibur - 0.28.0 - 2023-8-10\n * https://github.com/excaliburjs/Excalibur\n * Copyright (c) 2023 Excalibur.js <https://github.com/excaliburjs/Excalibur/graphs/contributors>\n * Licensed BSD-2-Clause\n * @preserve\n */\n/******/ var __webpack_modules__ = ({\n\n/***/ 4662:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\n__webpack_require__(3430);\nvar entryUnbind = __webpack_require__(8791);\n\nmodule.exports = entryUnbind('Array', 'sort');\n\n\n/***/ }),\n\n/***/ 8343:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\n__webpack_require__(4769);\nvar path = __webpack_require__(9276);\n\nmodule.exports = path.Object.keys;\n\n\n/***/ }),\n\n/***/ 7111:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar isCallable = __webpack_require__(6733);\nvar tryToString = __webpack_require__(9821);\n\nvar $TypeError = TypeError;\n\n// `Assert: IsCallable(argument) is true`\nmodule.exports = function (argument) {\n  if (isCallable(argument)) return argument;\n  throw $TypeError(tryToString(argument) + ' is not a function');\n};\n\n\n/***/ }),\n\n/***/ 1176:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar isObject = __webpack_require__(5052);\n\nvar $String = String;\nvar $TypeError = TypeError;\n\n// `Assert: Type(argument) is Object`\nmodule.exports = function (argument) {\n  if (isObject(argument)) return argument;\n  throw $TypeError($String(argument) + ' is not an object');\n};\n\n\n/***/ }),\n\n/***/ 9540:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar toIndexedObject = __webpack_require__(905);\nvar toAbsoluteIndex = __webpack_require__(3231);\nvar lengthOfArrayLike = __webpack_require__(9646);\n\n// `Array.prototype.{ indexOf, includes }` methods implementation\nvar createMethod = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIndexedObject($this);\n    var length = lengthOfArrayLike(O);\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare -- NaN check\n    if (IS_INCLUDES && el != el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare -- NaN check\n      if (value != value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) {\n      if ((IS_INCLUDES || index in O) && O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.includes` method\n  // https://tc39.es/ecma262/#sec-array.prototype.includes\n  includes: createMethod(true),\n  // `Array.prototype.indexOf` method\n  // https://tc39.es/ecma262/#sec-array.prototype.indexof\n  indexOf: createMethod(false)\n};\n\n\n/***/ }),\n\n/***/ 6038:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar fails = __webpack_require__(4229);\n\nmodule.exports = function (METHOD_NAME, argument) {\n  var method = [][METHOD_NAME];\n  return !!method && fails(function () {\n    // eslint-disable-next-line no-useless-call -- required for testing\n    method.call(null, argument || function () { return 1; }, 1);\n  });\n};\n\n\n/***/ }),\n\n/***/ 9794:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar toAbsoluteIndex = __webpack_require__(3231);\nvar lengthOfArrayLike = __webpack_require__(9646);\nvar createProperty = __webpack_require__(2324);\n\nvar $Array = Array;\nvar max = Math.max;\n\nmodule.exports = function (O, start, end) {\n  var length = lengthOfArrayLike(O);\n  var k = toAbsoluteIndex(start, length);\n  var fin = toAbsoluteIndex(end === undefined ? length : end, length);\n  var result = $Array(max(fin - k, 0));\n  for (var n = 0; k < fin; k++, n++) createProperty(result, n, O[k]);\n  result.length = n;\n  return result;\n};\n\n\n/***/ }),\n\n/***/ 3867:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar arraySlice = __webpack_require__(9794);\n\nvar floor = Math.floor;\n\nvar mergeSort = function (array, comparefn) {\n  var length = array.length;\n  var middle = floor(length / 2);\n  return length < 8 ? insertionSort(array, comparefn) : merge(\n    array,\n    mergeSort(arraySlice(array, 0, middle), comparefn),\n    mergeSort(arraySlice(array, middle), comparefn),\n    comparefn\n  );\n};\n\nvar insertionSort = function (array, comparefn) {\n  var length = array.length;\n  var i = 1;\n  var element, j;\n\n  while (i < length) {\n    j = i;\n    element = array[i];\n    while (j && comparefn(array[j - 1], element) > 0) {\n      array[j] = array[--j];\n    }\n    if (j !== i++) array[j] = element;\n  } return array;\n};\n\nvar merge = function (array, left, right, comparefn) {\n  var llength = left.length;\n  var rlength = right.length;\n  var lindex = 0;\n  var rindex = 0;\n\n  while (lindex < llength || rindex < rlength) {\n    array[lindex + rindex] = (lindex < llength && rindex < rlength)\n      ? comparefn(left[lindex], right[rindex]) <= 0 ? left[lindex++] : right[rindex++]\n      : lindex < llength ? left[lindex++] : right[rindex++];\n  } return array;\n};\n\nmodule.exports = mergeSort;\n\n\n/***/ }),\n\n/***/ 7079:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar uncurryThis = __webpack_require__(5968);\n\nvar toString = uncurryThis({}.toString);\nvar stringSlice = uncurryThis(''.slice);\n\nmodule.exports = function (it) {\n  return stringSlice(toString(it), 8, -1);\n};\n\n\n/***/ }),\n\n/***/ 1589:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar TO_STRING_TAG_SUPPORT = __webpack_require__(1601);\nvar isCallable = __webpack_require__(6733);\nvar classofRaw = __webpack_require__(7079);\nvar wellKnownSymbol = __webpack_require__(95);\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar $Object = Object;\n\n// ES3 wrong here\nvar CORRECT_ARGUMENTS = classofRaw(function () { return arguments; }()) == 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (error) { /* empty */ }\n};\n\n// getting tag from ES6+ `Object.prototype.toString`\nmodule.exports = TO_STRING_TAG_SUPPORT ? classofRaw : function (it) {\n  var O, tag, result;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (tag = tryGet(O = $Object(it), TO_STRING_TAG)) == 'string' ? tag\n    // builtinTag case\n    : CORRECT_ARGUMENTS ? classofRaw(O)\n    // ES3 arguments fallback\n    : (result = classofRaw(O)) == 'Object' && isCallable(O.callee) ? 'Arguments' : result;\n};\n\n\n/***/ }),\n\n/***/ 7081:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar hasOwn = __webpack_require__(8270);\nvar ownKeys = __webpack_require__(4826);\nvar getOwnPropertyDescriptorModule = __webpack_require__(7933);\nvar definePropertyModule = __webpack_require__(1787);\n\nmodule.exports = function (target, source, exceptions) {\n  var keys = ownKeys(source);\n  var defineProperty = definePropertyModule.f;\n  var getOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    if (!hasOwn(target, key) && !(exceptions && hasOwn(exceptions, key))) {\n      defineProperty(target, key, getOwnPropertyDescriptor(source, key));\n    }\n  }\n};\n\n\n/***/ }),\n\n/***/ 5762:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar DESCRIPTORS = __webpack_require__(7400);\nvar definePropertyModule = __webpack_require__(1787);\nvar createPropertyDescriptor = __webpack_require__(5358);\n\nmodule.exports = DESCRIPTORS ? function (object, key, value) {\n  return definePropertyModule.f(object, key, createPropertyDescriptor(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n\n\n/***/ }),\n\n/***/ 5358:\n/***/ ((module) => {\n\n\nmodule.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n\n\n/***/ }),\n\n/***/ 2324:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar toPropertyKey = __webpack_require__(9310);\nvar definePropertyModule = __webpack_require__(1787);\nvar createPropertyDescriptor = __webpack_require__(5358);\n\nmodule.exports = function (object, key, value) {\n  var propertyKey = toPropertyKey(key);\n  if (propertyKey in object) definePropertyModule.f(object, propertyKey, createPropertyDescriptor(0, value));\n  else object[propertyKey] = value;\n};\n\n\n/***/ }),\n\n/***/ 4768:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar isCallable = __webpack_require__(6733);\nvar definePropertyModule = __webpack_require__(1787);\nvar makeBuiltIn = __webpack_require__(6039);\nvar defineGlobalProperty = __webpack_require__(8400);\n\nmodule.exports = function (O, key, value, options) {\n  if (!options) options = {};\n  var simple = options.enumerable;\n  var name = options.name !== undefined ? options.name : key;\n  if (isCallable(value)) makeBuiltIn(value, name, options);\n  if (options.global) {\n    if (simple) O[key] = value;\n    else defineGlobalProperty(key, value);\n  } else {\n    try {\n      if (!options.unsafe) delete O[key];\n      else if (O[key]) simple = true;\n    } catch (error) { /* empty */ }\n    if (simple) O[key] = value;\n    else definePropertyModule.f(O, key, {\n      value: value,\n      enumerable: false,\n      configurable: !options.nonConfigurable,\n      writable: !options.nonWritable\n    });\n  } return O;\n};\n\n\n/***/ }),\n\n/***/ 8400:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar global = __webpack_require__(9859);\n\n// eslint-disable-next-line es/no-object-defineproperty -- safe\nvar defineProperty = Object.defineProperty;\n\nmodule.exports = function (key, value) {\n  try {\n    defineProperty(global, key, { value: value, configurable: true, writable: true });\n  } catch (error) {\n    global[key] = value;\n  } return value;\n};\n\n\n/***/ }),\n\n/***/ 9563:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar tryToString = __webpack_require__(9821);\n\nvar $TypeError = TypeError;\n\nmodule.exports = function (O, P) {\n  if (!delete O[P]) throw $TypeError('Cannot delete property ' + tryToString(P) + ' of ' + tryToString(O));\n};\n\n\n/***/ }),\n\n/***/ 7400:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar fails = __webpack_require__(4229);\n\n// Detect IE8's incomplete defineProperty implementation\nmodule.exports = !fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- required for testing\n  return Object.defineProperty({}, 1, { get: function () { return 7; } })[1] != 7;\n});\n\n\n/***/ }),\n\n/***/ 3777:\n/***/ ((module) => {\n\n\nvar documentAll = typeof document == 'object' && document.all;\n\n// https://tc39.es/ecma262/#sec-IsHTMLDDA-internal-slot\n// eslint-disable-next-line unicorn/no-typeof-undefined -- required for testing\nvar IS_HTMLDDA = typeof documentAll == 'undefined' && documentAll !== undefined;\n\nmodule.exports = {\n  all: documentAll,\n  IS_HTMLDDA: IS_HTMLDDA\n};\n\n\n/***/ }),\n\n/***/ 2635:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar global = __webpack_require__(9859);\nvar isObject = __webpack_require__(5052);\n\nvar document = global.document;\n// typeof document.createElement is 'object' in old IE\nvar EXISTS = isObject(document) && isObject(document.createElement);\n\nmodule.exports = function (it) {\n  return EXISTS ? document.createElement(it) : {};\n};\n\n\n/***/ }),\n\n/***/ 2671:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar userAgent = __webpack_require__(598);\n\nvar firefox = userAgent.match(/firefox\\/(\\d+)/i);\n\nmodule.exports = !!firefox && +firefox[1];\n\n\n/***/ }),\n\n/***/ 8506:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar UA = __webpack_require__(598);\n\nmodule.exports = /MSIE|Trident/.test(UA);\n\n\n/***/ }),\n\n/***/ 598:\n/***/ ((module) => {\n\n\nmodule.exports = typeof navigator != 'undefined' && String(navigator.userAgent) || '';\n\n\n/***/ }),\n\n/***/ 5884:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar global = __webpack_require__(9859);\nvar userAgent = __webpack_require__(598);\n\nvar process = global.process;\nvar Deno = global.Deno;\nvar versions = process && process.versions || Deno && Deno.version;\nvar v8 = versions && versions.v8;\nvar match, version;\n\nif (v8) {\n  match = v8.split('.');\n  // in old Chrome, versions of V8 isn't V8 = Chrome / 10\n  // but their correct versions are not interesting for us\n  version = match[0] > 0 && match[0] < 4 ? 1 : +(match[0] + match[1]);\n}\n\n// BrowserFS NodeJS `process` polyfill incorrectly set `.v8` to `0.0`\n// so check `userAgent` even if `.v8` exists, but 0\nif (!version && userAgent) {\n  match = userAgent.match(/Edge\\/(\\d+)/);\n  if (!match || match[1] >= 74) {\n    match = userAgent.match(/Chrome\\/(\\d+)/);\n    if (match) version = +match[1];\n  }\n}\n\nmodule.exports = version;\n\n\n/***/ }),\n\n/***/ 9811:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar userAgent = __webpack_require__(598);\n\nvar webkit = userAgent.match(/AppleWebKit\\/(\\d+)\\./);\n\nmodule.exports = !!webkit && +webkit[1];\n\n\n/***/ }),\n\n/***/ 8791:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar global = __webpack_require__(9859);\nvar uncurryThis = __webpack_require__(5968);\n\nmodule.exports = function (CONSTRUCTOR, METHOD) {\n  return uncurryThis(global[CONSTRUCTOR].prototype[METHOD]);\n};\n\n\n/***/ }),\n\n/***/ 3837:\n/***/ ((module) => {\n\n\n// IE8- don't enum bug keys\nmodule.exports = [\n  'constructor',\n  'hasOwnProperty',\n  'isPrototypeOf',\n  'propertyIsEnumerable',\n  'toLocaleString',\n  'toString',\n  'valueOf'\n];\n\n\n/***/ }),\n\n/***/ 3103:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar global = __webpack_require__(9859);\nvar getOwnPropertyDescriptor = (__webpack_require__(7933).f);\nvar createNonEnumerableProperty = __webpack_require__(5762);\nvar defineBuiltIn = __webpack_require__(4768);\nvar defineGlobalProperty = __webpack_require__(8400);\nvar copyConstructorProperties = __webpack_require__(7081);\nvar isForced = __webpack_require__(6541);\n\n/*\n  options.target         - name of the target object\n  options.global         - target is the global object\n  options.stat           - export as static methods of target\n  options.proto          - export as prototype methods of target\n  options.real           - real prototype method for the `pure` version\n  options.forced         - export even if the native feature is available\n  options.bind           - bind methods to the target, required for the `pure` version\n  options.wrap           - wrap constructors to preventing global pollution, required for the `pure` version\n  options.unsafe         - use the simple assignment of property instead of delete + defineProperty\n  options.sham           - add a flag to not completely full polyfills\n  options.enumerable     - export as enumerable property\n  options.dontCallGetSet - prevent calling a getter on target\n  options.name           - the .name of the function if it does not match the key\n*/\nmodule.exports = function (options, source) {\n  var TARGET = options.target;\n  var GLOBAL = options.global;\n  var STATIC = options.stat;\n  var FORCED, target, key, targetProperty, sourceProperty, descriptor;\n  if (GLOBAL) {\n    target = global;\n  } else if (STATIC) {\n    target = global[TARGET] || defineGlobalProperty(TARGET, {});\n  } else {\n    target = (global[TARGET] || {}).prototype;\n  }\n  if (target) for (key in source) {\n    sourceProperty = source[key];\n    if (options.dontCallGetSet) {\n      descriptor = getOwnPropertyDescriptor(target, key);\n      targetProperty = descriptor && descriptor.value;\n    } else targetProperty = target[key];\n    FORCED = isForced(GLOBAL ? key : TARGET + (STATIC ? '.' : '#') + key, options.forced);\n    // contained in target\n    if (!FORCED && targetProperty !== undefined) {\n      if (typeof sourceProperty == typeof targetProperty) continue;\n      copyConstructorProperties(sourceProperty, targetProperty);\n    }\n    // add a flag to not completely full polyfills\n    if (options.sham || (targetProperty && targetProperty.sham)) {\n      createNonEnumerableProperty(sourceProperty, 'sham', true);\n    }\n    defineBuiltIn(target, key, sourceProperty, options);\n  }\n};\n\n\n/***/ }),\n\n/***/ 4229:\n/***/ ((module) => {\n\n\nmodule.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (error) {\n    return true;\n  }\n};\n\n\n/***/ }),\n\n/***/ 7188:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar fails = __webpack_require__(4229);\n\nmodule.exports = !fails(function () {\n  // eslint-disable-next-line es/no-function-prototype-bind -- safe\n  var test = (function () { /* empty */ }).bind();\n  // eslint-disable-next-line no-prototype-builtins -- safe\n  return typeof test != 'function' || test.hasOwnProperty('prototype');\n});\n\n\n/***/ }),\n\n/***/ 266:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar NATIVE_BIND = __webpack_require__(7188);\n\nvar call = Function.prototype.call;\n\nmodule.exports = NATIVE_BIND ? call.bind(call) : function () {\n  return call.apply(call, arguments);\n};\n\n\n/***/ }),\n\n/***/ 1805:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar DESCRIPTORS = __webpack_require__(7400);\nvar hasOwn = __webpack_require__(8270);\n\nvar FunctionPrototype = Function.prototype;\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar getDescriptor = DESCRIPTORS && Object.getOwnPropertyDescriptor;\n\nvar EXISTS = hasOwn(FunctionPrototype, 'name');\n// additional protection from minified / mangled / dropped function names\nvar PROPER = EXISTS && (function something() { /* empty */ }).name === 'something';\nvar CONFIGURABLE = EXISTS && (!DESCRIPTORS || (DESCRIPTORS && getDescriptor(FunctionPrototype, 'name').configurable));\n\nmodule.exports = {\n  EXISTS: EXISTS,\n  PROPER: PROPER,\n  CONFIGURABLE: CONFIGURABLE\n};\n\n\n/***/ }),\n\n/***/ 5968:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar NATIVE_BIND = __webpack_require__(7188);\n\nvar FunctionPrototype = Function.prototype;\nvar call = FunctionPrototype.call;\nvar uncurryThisWithBind = NATIVE_BIND && FunctionPrototype.bind.bind(call, call);\n\nmodule.exports = NATIVE_BIND ? uncurryThisWithBind : function (fn) {\n  return function () {\n    return call.apply(fn, arguments);\n  };\n};\n\n\n/***/ }),\n\n/***/ 1333:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar global = __webpack_require__(9859);\nvar isCallable = __webpack_require__(6733);\n\nvar aFunction = function (argument) {\n  return isCallable(argument) ? argument : undefined;\n};\n\nmodule.exports = function (namespace, method) {\n  return arguments.length < 2 ? aFunction(global[namespace]) : global[namespace] && global[namespace][method];\n};\n\n\n/***/ }),\n\n/***/ 5300:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar aCallable = __webpack_require__(7111);\nvar isNullOrUndefined = __webpack_require__(9650);\n\n// `GetMethod` abstract operation\n// https://tc39.es/ecma262/#sec-getmethod\nmodule.exports = function (V, P) {\n  var func = V[P];\n  return isNullOrUndefined(func) ? undefined : aCallable(func);\n};\n\n\n/***/ }),\n\n/***/ 9859:\n/***/ (function(module, __unused_webpack_exports, __webpack_require__) {\n\n\nvar check = function (it) {\n  return it && it.Math == Math && it;\n};\n\n// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nmodule.exports =\n  // eslint-disable-next-line es/no-global-this -- safe\n  check(typeof globalThis == 'object' && globalThis) ||\n  check(typeof window == 'object' && window) ||\n  // eslint-disable-next-line no-restricted-globals -- safe\n  check(typeof self == 'object' && self) ||\n  check(typeof __webpack_require__.g == 'object' && __webpack_require__.g) ||\n  // eslint-disable-next-line no-new-func -- fallback\n  (function () { return this; })() || this || Function('return this')();\n\n\n/***/ }),\n\n/***/ 8270:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar uncurryThis = __webpack_require__(5968);\nvar toObject = __webpack_require__(2991);\n\nvar hasOwnProperty = uncurryThis({}.hasOwnProperty);\n\n// `HasOwnProperty` abstract operation\n// https://tc39.es/ecma262/#sec-hasownproperty\n// eslint-disable-next-line es/no-object-hasown -- safe\nmodule.exports = Object.hasOwn || function hasOwn(it, key) {\n  return hasOwnProperty(toObject(it), key);\n};\n\n\n/***/ }),\n\n/***/ 5977:\n/***/ ((module) => {\n\n\nmodule.exports = {};\n\n\n/***/ }),\n\n/***/ 4394:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar DESCRIPTORS = __webpack_require__(7400);\nvar fails = __webpack_require__(4229);\nvar createElement = __webpack_require__(2635);\n\n// Thanks to IE8 for its funny defineProperty\nmodule.exports = !DESCRIPTORS && !fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- required for testing\n  return Object.defineProperty(createElement('div'), 'a', {\n    get: function () { return 7; }\n  }).a != 7;\n});\n\n\n/***/ }),\n\n/***/ 9337:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar uncurryThis = __webpack_require__(5968);\nvar fails = __webpack_require__(4229);\nvar classof = __webpack_require__(7079);\n\nvar $Object = Object;\nvar split = uncurryThis(''.split);\n\n// fallback for non-array-like ES3 and non-enumerable old V8 strings\nmodule.exports = fails(function () {\n  // throws an error in rhino, see https://github.com/mozilla/rhino/issues/346\n  // eslint-disable-next-line no-prototype-builtins -- safe\n  return !$Object('z').propertyIsEnumerable(0);\n}) ? function (it) {\n  return classof(it) == 'String' ? split(it, '') : $Object(it);\n} : $Object;\n\n\n/***/ }),\n\n/***/ 8511:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar uncurryThis = __webpack_require__(5968);\nvar isCallable = __webpack_require__(6733);\nvar store = __webpack_require__(5353);\n\nvar functionToString = uncurryThis(Function.toString);\n\n// this helper broken in `core-js@3.4.1-3.4.4`, so we can't use `shared` helper\nif (!isCallable(store.inspectSource)) {\n  store.inspectSource = function (it) {\n    return functionToString(it);\n  };\n}\n\nmodule.exports = store.inspectSource;\n\n\n/***/ }),\n\n/***/ 6407:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar NATIVE_WEAK_MAP = __webpack_require__(1180);\nvar global = __webpack_require__(9859);\nvar isObject = __webpack_require__(5052);\nvar createNonEnumerableProperty = __webpack_require__(5762);\nvar hasOwn = __webpack_require__(8270);\nvar shared = __webpack_require__(5353);\nvar sharedKey = __webpack_require__(4399);\nvar hiddenKeys = __webpack_require__(5977);\n\nvar OBJECT_ALREADY_INITIALIZED = 'Object already initialized';\nvar TypeError = global.TypeError;\nvar WeakMap = global.WeakMap;\nvar set, get, has;\n\nvar enforce = function (it) {\n  return has(it) ? get(it) : set(it, {});\n};\n\nvar getterFor = function (TYPE) {\n  return function (it) {\n    var state;\n    if (!isObject(it) || (state = get(it)).type !== TYPE) {\n      throw TypeError('Incompatible receiver, ' + TYPE + ' required');\n    } return state;\n  };\n};\n\nif (NATIVE_WEAK_MAP || shared.state) {\n  var store = shared.state || (shared.state = new WeakMap());\n  /* eslint-disable no-self-assign -- prototype methods protection */\n  store.get = store.get;\n  store.has = store.has;\n  store.set = store.set;\n  /* eslint-enable no-self-assign -- prototype methods protection */\n  set = function (it, metadata) {\n    if (store.has(it)) throw TypeError(OBJECT_ALREADY_INITIALIZED);\n    metadata.facade = it;\n    store.set(it, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return store.get(it) || {};\n  };\n  has = function (it) {\n    return store.has(it);\n  };\n} else {\n  var STATE = sharedKey('state');\n  hiddenKeys[STATE] = true;\n  set = function (it, metadata) {\n    if (hasOwn(it, STATE)) throw TypeError(OBJECT_ALREADY_INITIALIZED);\n    metadata.facade = it;\n    createNonEnumerableProperty(it, STATE, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return hasOwn(it, STATE) ? it[STATE] : {};\n  };\n  has = function (it) {\n    return hasOwn(it, STATE);\n  };\n}\n\nmodule.exports = {\n  set: set,\n  get: get,\n  has: has,\n  enforce: enforce,\n  getterFor: getterFor\n};\n\n\n/***/ }),\n\n/***/ 6733:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar $documentAll = __webpack_require__(3777);\n\nvar documentAll = $documentAll.all;\n\n// `IsCallable` abstract operation\n// https://tc39.es/ecma262/#sec-iscallable\nmodule.exports = $documentAll.IS_HTMLDDA ? function (argument) {\n  return typeof argument == 'function' || argument === documentAll;\n} : function (argument) {\n  return typeof argument == 'function';\n};\n\n\n/***/ }),\n\n/***/ 6541:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar fails = __webpack_require__(4229);\nvar isCallable = __webpack_require__(6733);\n\nvar replacement = /#|\\.prototype\\./;\n\nvar isForced = function (feature, detection) {\n  var value = data[normalize(feature)];\n  return value == POLYFILL ? true\n    : value == NATIVE ? false\n    : isCallable(detection) ? fails(detection)\n    : !!detection;\n};\n\nvar normalize = isForced.normalize = function (string) {\n  return String(string).replace(replacement, '.').toLowerCase();\n};\n\nvar data = isForced.data = {};\nvar NATIVE = isForced.NATIVE = 'N';\nvar POLYFILL = isForced.POLYFILL = 'P';\n\nmodule.exports = isForced;\n\n\n/***/ }),\n\n/***/ 9650:\n/***/ ((module) => {\n\n\n// we can't use just `it == null` since of `document.all` special case\n// https://tc39.es/ecma262/#sec-IsHTMLDDA-internal-slot-aec\nmodule.exports = function (it) {\n  return it === null || it === undefined;\n};\n\n\n/***/ }),\n\n/***/ 5052:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar isCallable = __webpack_require__(6733);\nvar $documentAll = __webpack_require__(3777);\n\nvar documentAll = $documentAll.all;\n\nmodule.exports = $documentAll.IS_HTMLDDA ? function (it) {\n  return typeof it == 'object' ? it !== null : isCallable(it) || it === documentAll;\n} : function (it) {\n  return typeof it == 'object' ? it !== null : isCallable(it);\n};\n\n\n/***/ }),\n\n/***/ 4231:\n/***/ ((module) => {\n\n\nmodule.exports = false;\n\n\n/***/ }),\n\n/***/ 9395:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar getBuiltIn = __webpack_require__(1333);\nvar isCallable = __webpack_require__(6733);\nvar isPrototypeOf = __webpack_require__(1321);\nvar USE_SYMBOL_AS_UID = __webpack_require__(6969);\n\nvar $Object = Object;\n\nmodule.exports = USE_SYMBOL_AS_UID ? function (it) {\n  return typeof it == 'symbol';\n} : function (it) {\n  var $Symbol = getBuiltIn('Symbol');\n  return isCallable($Symbol) && isPrototypeOf($Symbol.prototype, $Object(it));\n};\n\n\n/***/ }),\n\n/***/ 9646:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar toLength = __webpack_require__(4237);\n\n// `LengthOfArrayLike` abstract operation\n// https://tc39.es/ecma262/#sec-lengthofarraylike\nmodule.exports = function (obj) {\n  return toLength(obj.length);\n};\n\n\n/***/ }),\n\n/***/ 6039:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar uncurryThis = __webpack_require__(5968);\nvar fails = __webpack_require__(4229);\nvar isCallable = __webpack_require__(6733);\nvar hasOwn = __webpack_require__(8270);\nvar DESCRIPTORS = __webpack_require__(7400);\nvar CONFIGURABLE_FUNCTION_NAME = (__webpack_require__(1805).CONFIGURABLE);\nvar inspectSource = __webpack_require__(8511);\nvar InternalStateModule = __webpack_require__(6407);\n\nvar enforceInternalState = InternalStateModule.enforce;\nvar getInternalState = InternalStateModule.get;\nvar $String = String;\n// eslint-disable-next-line es/no-object-defineproperty -- safe\nvar defineProperty = Object.defineProperty;\nvar stringSlice = uncurryThis(''.slice);\nvar replace = uncurryThis(''.replace);\nvar join = uncurryThis([].join);\n\nvar CONFIGURABLE_LENGTH = DESCRIPTORS && !fails(function () {\n  return defineProperty(function () { /* empty */ }, 'length', { value: 8 }).length !== 8;\n});\n\nvar TEMPLATE = String(String).split('String');\n\nvar makeBuiltIn = module.exports = function (value, name, options) {\n  if (stringSlice($String(name), 0, 7) === 'Symbol(') {\n    name = '[' + replace($String(name), /^Symbol\\(([^)]*)\\)/, '$1') + ']';\n  }\n  if (options && options.getter) name = 'get ' + name;\n  if (options && options.setter) name = 'set ' + name;\n  if (!hasOwn(value, 'name') || (CONFIGURABLE_FUNCTION_NAME && value.name !== name)) {\n    if (DESCRIPTORS) defineProperty(value, 'name', { value: name, configurable: true });\n    else value.name = name;\n  }\n  if (CONFIGURABLE_LENGTH && options && hasOwn(options, 'arity') && value.length !== options.arity) {\n    defineProperty(value, 'length', { value: options.arity });\n  }\n  try {\n    if (options && hasOwn(options, 'constructor') && options.constructor) {\n      if (DESCRIPTORS) defineProperty(value, 'prototype', { writable: false });\n    // in V8 ~ Chrome 53, prototypes of some methods, like `Array.prototype.values`, are non-writable\n    } else if (value.prototype) value.prototype = undefined;\n  } catch (error) { /* empty */ }\n  var state = enforceInternalState(value);\n  if (!hasOwn(state, 'source')) {\n    state.source = join(TEMPLATE, typeof name == 'string' ? name : '');\n  } return value;\n};\n\n// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative\n// eslint-disable-next-line no-extend-native -- required\nFunction.prototype.toString = makeBuiltIn(function toString() {\n  return isCallable(this) && getInternalState(this).source || inspectSource(this);\n}, 'toString');\n\n\n/***/ }),\n\n/***/ 917:\n/***/ ((module) => {\n\n\nvar ceil = Math.ceil;\nvar floor = Math.floor;\n\n// `Math.trunc` method\n// https://tc39.es/ecma262/#sec-math.trunc\n// eslint-disable-next-line es/no-math-trunc -- safe\nmodule.exports = Math.trunc || function trunc(x) {\n  var n = +x;\n  return (n > 0 ? floor : ceil)(n);\n};\n\n\n/***/ }),\n\n/***/ 1787:\n/***/ ((__unused_webpack_module, exports, __webpack_require__) => {\n\n\nvar DESCRIPTORS = __webpack_require__(7400);\nvar IE8_DOM_DEFINE = __webpack_require__(4394);\nvar V8_PROTOTYPE_DEFINE_BUG = __webpack_require__(7137);\nvar anObject = __webpack_require__(1176);\nvar toPropertyKey = __webpack_require__(9310);\n\nvar $TypeError = TypeError;\n// eslint-disable-next-line es/no-object-defineproperty -- safe\nvar $defineProperty = Object.defineProperty;\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar $getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\nvar ENUMERABLE = 'enumerable';\nvar CONFIGURABLE = 'configurable';\nvar WRITABLE = 'writable';\n\n// `Object.defineProperty` method\n// https://tc39.es/ecma262/#sec-object.defineproperty\nexports.f = DESCRIPTORS ? V8_PROTOTYPE_DEFINE_BUG ? function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPropertyKey(P);\n  anObject(Attributes);\n  if (typeof O === 'function' && P === 'prototype' && 'value' in Attributes && WRITABLE in Attributes && !Attributes[WRITABLE]) {\n    var current = $getOwnPropertyDescriptor(O, P);\n    if (current && current[WRITABLE]) {\n      O[P] = Attributes.value;\n      Attributes = {\n        configurable: CONFIGURABLE in Attributes ? Attributes[CONFIGURABLE] : current[CONFIGURABLE],\n        enumerable: ENUMERABLE in Attributes ? Attributes[ENUMERABLE] : current[ENUMERABLE],\n        writable: false\n      };\n    }\n  } return $defineProperty(O, P, Attributes);\n} : $defineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPropertyKey(P);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return $defineProperty(O, P, Attributes);\n  } catch (error) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw $TypeError('Accessors not supported');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n\n\n/***/ }),\n\n/***/ 7933:\n/***/ ((__unused_webpack_module, exports, __webpack_require__) => {\n\n\nvar DESCRIPTORS = __webpack_require__(7400);\nvar call = __webpack_require__(266);\nvar propertyIsEnumerableModule = __webpack_require__(9195);\nvar createPropertyDescriptor = __webpack_require__(5358);\nvar toIndexedObject = __webpack_require__(905);\nvar toPropertyKey = __webpack_require__(9310);\nvar hasOwn = __webpack_require__(8270);\nvar IE8_DOM_DEFINE = __webpack_require__(4394);\n\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar $getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// `Object.getOwnPropertyDescriptor` method\n// https://tc39.es/ecma262/#sec-object.getownpropertydescriptor\nexports.f = DESCRIPTORS ? $getOwnPropertyDescriptor : function getOwnPropertyDescriptor(O, P) {\n  O = toIndexedObject(O);\n  P = toPropertyKey(P);\n  if (IE8_DOM_DEFINE) try {\n    return $getOwnPropertyDescriptor(O, P);\n  } catch (error) { /* empty */ }\n  if (hasOwn(O, P)) return createPropertyDescriptor(!call(propertyIsEnumerableModule.f, O, P), O[P]);\n};\n\n\n/***/ }),\n\n/***/ 8151:\n/***/ ((__unused_webpack_module, exports, __webpack_require__) => {\n\n\nvar internalObjectKeys = __webpack_require__(140);\nvar enumBugKeys = __webpack_require__(3837);\n\nvar hiddenKeys = enumBugKeys.concat('length', 'prototype');\n\n// `Object.getOwnPropertyNames` method\n// https://tc39.es/ecma262/#sec-object.getownpropertynames\n// eslint-disable-next-line es/no-object-getownpropertynames -- safe\nexports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {\n  return internalObjectKeys(O, hiddenKeys);\n};\n\n\n/***/ }),\n\n/***/ 894:\n/***/ ((__unused_webpack_module, exports) => {\n\n\n// eslint-disable-next-line es/no-object-getownpropertysymbols -- safe\nexports.f = Object.getOwnPropertySymbols;\n\n\n/***/ }),\n\n/***/ 1321:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar uncurryThis = __webpack_require__(5968);\n\nmodule.exports = uncurryThis({}.isPrototypeOf);\n\n\n/***/ }),\n\n/***/ 140:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar uncurryThis = __webpack_require__(5968);\nvar hasOwn = __webpack_require__(8270);\nvar toIndexedObject = __webpack_require__(905);\nvar indexOf = (__webpack_require__(9540).indexOf);\nvar hiddenKeys = __webpack_require__(5977);\n\nvar push = uncurryThis([].push);\n\nmodule.exports = function (object, names) {\n  var O = toIndexedObject(object);\n  var i = 0;\n  var result = [];\n  var key;\n  for (key in O) !hasOwn(hiddenKeys, key) && hasOwn(O, key) && push(result, key);\n  // Don't enum bug & hidden keys\n  while (names.length > i) if (hasOwn(O, key = names[i++])) {\n    ~indexOf(result, key) || push(result, key);\n  }\n  return result;\n};\n\n\n/***/ }),\n\n/***/ 5632:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar internalObjectKeys = __webpack_require__(140);\nvar enumBugKeys = __webpack_require__(3837);\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n// eslint-disable-next-line es/no-object-keys -- safe\nmodule.exports = Object.keys || function keys(O) {\n  return internalObjectKeys(O, enumBugKeys);\n};\n\n\n/***/ }),\n\n/***/ 9195:\n/***/ ((__unused_webpack_module, exports) => {\n\n\nvar $propertyIsEnumerable = {}.propertyIsEnumerable;\n// eslint-disable-next-line es/no-object-getownpropertydescriptor -- safe\nvar getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// Nashorn ~ JDK8 bug\nvar NASHORN_BUG = getOwnPropertyDescriptor && !$propertyIsEnumerable.call({ 1: 2 }, 1);\n\n// `Object.prototype.propertyIsEnumerable` method implementation\n// https://tc39.es/ecma262/#sec-object.prototype.propertyisenumerable\nexports.f = NASHORN_BUG ? function propertyIsEnumerable(V) {\n  var descriptor = getOwnPropertyDescriptor(this, V);\n  return !!descriptor && descriptor.enumerable;\n} : $propertyIsEnumerable;\n\n\n/***/ }),\n\n/***/ 2914:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar call = __webpack_require__(266);\nvar isCallable = __webpack_require__(6733);\nvar isObject = __webpack_require__(5052);\n\nvar $TypeError = TypeError;\n\n// `OrdinaryToPrimitive` abstract operation\n// https://tc39.es/ecma262/#sec-ordinarytoprimitive\nmodule.exports = function (input, pref) {\n  var fn, val;\n  if (pref === 'string' && isCallable(fn = input.toString) && !isObject(val = call(fn, input))) return val;\n  if (isCallable(fn = input.valueOf) && !isObject(val = call(fn, input))) return val;\n  if (pref !== 'string' && isCallable(fn = input.toString) && !isObject(val = call(fn, input))) return val;\n  throw $TypeError(\"Can't convert object to primitive value\");\n};\n\n\n/***/ }),\n\n/***/ 4826:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar getBuiltIn = __webpack_require__(1333);\nvar uncurryThis = __webpack_require__(5968);\nvar getOwnPropertyNamesModule = __webpack_require__(8151);\nvar getOwnPropertySymbolsModule = __webpack_require__(894);\nvar anObject = __webpack_require__(1176);\n\nvar concat = uncurryThis([].concat);\n\n// all object keys, includes non-enumerable and symbols\nmodule.exports = getBuiltIn('Reflect', 'ownKeys') || function ownKeys(it) {\n  var keys = getOwnPropertyNamesModule.f(anObject(it));\n  var getOwnPropertySymbols = getOwnPropertySymbolsModule.f;\n  return getOwnPropertySymbols ? concat(keys, getOwnPropertySymbols(it)) : keys;\n};\n\n\n/***/ }),\n\n/***/ 9276:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar global = __webpack_require__(9859);\n\nmodule.exports = global;\n\n\n/***/ }),\n\n/***/ 8885:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar isNullOrUndefined = __webpack_require__(9650);\n\nvar $TypeError = TypeError;\n\n// `RequireObjectCoercible` abstract operation\n// https://tc39.es/ecma262/#sec-requireobjectcoercible\nmodule.exports = function (it) {\n  if (isNullOrUndefined(it)) throw $TypeError(\"Can't call method on \" + it);\n  return it;\n};\n\n\n/***/ }),\n\n/***/ 4399:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar shared = __webpack_require__(3036);\nvar uid = __webpack_require__(1441);\n\nvar keys = shared('keys');\n\nmodule.exports = function (key) {\n  return keys[key] || (keys[key] = uid(key));\n};\n\n\n/***/ }),\n\n/***/ 5353:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar global = __webpack_require__(9859);\nvar defineGlobalProperty = __webpack_require__(8400);\n\nvar SHARED = '__core-js_shared__';\nvar store = global[SHARED] || defineGlobalProperty(SHARED, {});\n\nmodule.exports = store;\n\n\n/***/ }),\n\n/***/ 3036:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar IS_PURE = __webpack_require__(4231);\nvar store = __webpack_require__(5353);\n\n(module.exports = function (key, value) {\n  return store[key] || (store[key] = value !== undefined ? value : {});\n})('versions', []).push({\n  version: '3.32.0',\n  mode: IS_PURE ? 'pure' : 'global',\n  copyright: '© 2014-2023 Denis Pushkarev (zloirock.ru)',\n  license: 'https://github.com/zloirock/core-js/blob/v3.32.0/LICENSE',\n  source: 'https://github.com/zloirock/core-js'\n});\n\n\n/***/ }),\n\n/***/ 4860:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\n/* eslint-disable es/no-symbol -- required for testing */\nvar V8_VERSION = __webpack_require__(5884);\nvar fails = __webpack_require__(4229);\nvar global = __webpack_require__(9859);\n\nvar $String = global.String;\n\n// eslint-disable-next-line es/no-object-getownpropertysymbols -- required for testing\nmodule.exports = !!Object.getOwnPropertySymbols && !fails(function () {\n  var symbol = Symbol();\n  // Chrome 38 Symbol has incorrect toString conversion\n  // `get-own-property-symbols` polyfill symbols converted to object are not Symbol instances\n  // nb: Do not call `String` directly to avoid this being optimized out to `symbol+''` which will,\n  // of course, fail.\n  return !$String(symbol) || !(Object(symbol) instanceof Symbol) ||\n    // Chrome 38-40 symbols are not inherited from DOM collections prototypes to instances\n    !Symbol.sham && V8_VERSION && V8_VERSION < 41;\n});\n\n\n/***/ }),\n\n/***/ 3231:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar toIntegerOrInfinity = __webpack_require__(3329);\n\nvar max = Math.max;\nvar min = Math.min;\n\n// Helper for a popular repeating case of the spec:\n// Let integer be ? ToInteger(index).\n// If integer < 0, let result be max((length + integer), 0); else let result be min(integer, length).\nmodule.exports = function (index, length) {\n  var integer = toIntegerOrInfinity(index);\n  return integer < 0 ? max(integer + length, 0) : min(integer, length);\n};\n\n\n/***/ }),\n\n/***/ 905:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\n// toObject with fallback for non-array-like ES3 strings\nvar IndexedObject = __webpack_require__(9337);\nvar requireObjectCoercible = __webpack_require__(8885);\n\nmodule.exports = function (it) {\n  return IndexedObject(requireObjectCoercible(it));\n};\n\n\n/***/ }),\n\n/***/ 3329:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar trunc = __webpack_require__(917);\n\n// `ToIntegerOrInfinity` abstract operation\n// https://tc39.es/ecma262/#sec-tointegerorinfinity\nmodule.exports = function (argument) {\n  var number = +argument;\n  // eslint-disable-next-line no-self-compare -- NaN check\n  return number !== number || number === 0 ? 0 : trunc(number);\n};\n\n\n/***/ }),\n\n/***/ 4237:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar toIntegerOrInfinity = __webpack_require__(3329);\n\nvar min = Math.min;\n\n// `ToLength` abstract operation\n// https://tc39.es/ecma262/#sec-tolength\nmodule.exports = function (argument) {\n  return argument > 0 ? min(toIntegerOrInfinity(argument), 0x1FFFFFFFFFFFFF) : 0; // 2 ** 53 - 1 == 9007199254740991\n};\n\n\n/***/ }),\n\n/***/ 2991:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar requireObjectCoercible = __webpack_require__(8885);\n\nvar $Object = Object;\n\n// `ToObject` abstract operation\n// https://tc39.es/ecma262/#sec-toobject\nmodule.exports = function (argument) {\n  return $Object(requireObjectCoercible(argument));\n};\n\n\n/***/ }),\n\n/***/ 2066:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar call = __webpack_require__(266);\nvar isObject = __webpack_require__(5052);\nvar isSymbol = __webpack_require__(9395);\nvar getMethod = __webpack_require__(5300);\nvar ordinaryToPrimitive = __webpack_require__(2914);\nvar wellKnownSymbol = __webpack_require__(95);\n\nvar $TypeError = TypeError;\nvar TO_PRIMITIVE = wellKnownSymbol('toPrimitive');\n\n// `ToPrimitive` abstract operation\n// https://tc39.es/ecma262/#sec-toprimitive\nmodule.exports = function (input, pref) {\n  if (!isObject(input) || isSymbol(input)) return input;\n  var exoticToPrim = getMethod(input, TO_PRIMITIVE);\n  var result;\n  if (exoticToPrim) {\n    if (pref === undefined) pref = 'default';\n    result = call(exoticToPrim, input, pref);\n    if (!isObject(result) || isSymbol(result)) return result;\n    throw $TypeError(\"Can't convert object to primitive value\");\n  }\n  if (pref === undefined) pref = 'number';\n  return ordinaryToPrimitive(input, pref);\n};\n\n\n/***/ }),\n\n/***/ 9310:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar toPrimitive = __webpack_require__(2066);\nvar isSymbol = __webpack_require__(9395);\n\n// `ToPropertyKey` abstract operation\n// https://tc39.es/ecma262/#sec-topropertykey\nmodule.exports = function (argument) {\n  var key = toPrimitive(argument, 'string');\n  return isSymbol(key) ? key : key + '';\n};\n\n\n/***/ }),\n\n/***/ 1601:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar wellKnownSymbol = __webpack_require__(95);\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar test = {};\n\ntest[TO_STRING_TAG] = 'z';\n\nmodule.exports = String(test) === '[object z]';\n\n\n/***/ }),\n\n/***/ 3326:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar classof = __webpack_require__(1589);\n\nvar $String = String;\n\nmodule.exports = function (argument) {\n  if (classof(argument) === 'Symbol') throw TypeError('Cannot convert a Symbol value to a string');\n  return $String(argument);\n};\n\n\n/***/ }),\n\n/***/ 9821:\n/***/ ((module) => {\n\n\nvar $String = String;\n\nmodule.exports = function (argument) {\n  try {\n    return $String(argument);\n  } catch (error) {\n    return 'Object';\n  }\n};\n\n\n/***/ }),\n\n/***/ 1441:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar uncurryThis = __webpack_require__(5968);\n\nvar id = 0;\nvar postfix = Math.random();\nvar toString = uncurryThis(1.0.toString);\n\nmodule.exports = function (key) {\n  return 'Symbol(' + (key === undefined ? '' : key) + ')_' + toString(++id + postfix, 36);\n};\n\n\n/***/ }),\n\n/***/ 6969:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\n/* eslint-disable es/no-symbol -- required for testing */\nvar NATIVE_SYMBOL = __webpack_require__(4860);\n\nmodule.exports = NATIVE_SYMBOL\n  && !Symbol.sham\n  && typeof Symbol.iterator == 'symbol';\n\n\n/***/ }),\n\n/***/ 7137:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar DESCRIPTORS = __webpack_require__(7400);\nvar fails = __webpack_require__(4229);\n\n// V8 ~ Chrome 36-\n// https://bugs.chromium.org/p/v8/issues/detail?id=3334\nmodule.exports = DESCRIPTORS && fails(function () {\n  // eslint-disable-next-line es/no-object-defineproperty -- required for testing\n  return Object.defineProperty(function () { /* empty */ }, 'prototype', {\n    value: 42,\n    writable: false\n  }).prototype != 42;\n});\n\n\n/***/ }),\n\n/***/ 1180:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar global = __webpack_require__(9859);\nvar isCallable = __webpack_require__(6733);\n\nvar WeakMap = global.WeakMap;\n\nmodule.exports = isCallable(WeakMap) && /native code/.test(String(WeakMap));\n\n\n/***/ }),\n\n/***/ 95:\n/***/ ((module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar global = __webpack_require__(9859);\nvar shared = __webpack_require__(3036);\nvar hasOwn = __webpack_require__(8270);\nvar uid = __webpack_require__(1441);\nvar NATIVE_SYMBOL = __webpack_require__(4860);\nvar USE_SYMBOL_AS_UID = __webpack_require__(6969);\n\nvar Symbol = global.Symbol;\nvar WellKnownSymbolsStore = shared('wks');\nvar createWellKnownSymbol = USE_SYMBOL_AS_UID ? Symbol['for'] || Symbol : Symbol && Symbol.withoutSetter || uid;\n\nmodule.exports = function (name) {\n  if (!hasOwn(WellKnownSymbolsStore, name)) {\n    WellKnownSymbolsStore[name] = NATIVE_SYMBOL && hasOwn(Symbol, name)\n      ? Symbol[name]\n      : createWellKnownSymbol('Symbol.' + name);\n  } return WellKnownSymbolsStore[name];\n};\n\n\n/***/ }),\n\n/***/ 3430:\n/***/ ((__unused_webpack_module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar $ = __webpack_require__(3103);\nvar uncurryThis = __webpack_require__(5968);\nvar aCallable = __webpack_require__(7111);\nvar toObject = __webpack_require__(2991);\nvar lengthOfArrayLike = __webpack_require__(9646);\nvar deletePropertyOrThrow = __webpack_require__(9563);\nvar toString = __webpack_require__(3326);\nvar fails = __webpack_require__(4229);\nvar internalSort = __webpack_require__(3867);\nvar arrayMethodIsStrict = __webpack_require__(6038);\nvar FF = __webpack_require__(2671);\nvar IE_OR_EDGE = __webpack_require__(8506);\nvar V8 = __webpack_require__(5884);\nvar WEBKIT = __webpack_require__(9811);\n\nvar test = [];\nvar nativeSort = uncurryThis(test.sort);\nvar push = uncurryThis(test.push);\n\n// IE8-\nvar FAILS_ON_UNDEFINED = fails(function () {\n  test.sort(undefined);\n});\n// V8 bug\nvar FAILS_ON_NULL = fails(function () {\n  test.sort(null);\n});\n// Old WebKit\nvar STRICT_METHOD = arrayMethodIsStrict('sort');\n\nvar STABLE_SORT = !fails(function () {\n  // feature detection can be too slow, so check engines versions\n  if (V8) return V8 < 70;\n  if (FF && FF > 3) return;\n  if (IE_OR_EDGE) return true;\n  if (WEBKIT) return WEBKIT < 603;\n\n  var result = '';\n  var code, chr, value, index;\n\n  // generate an array with more 512 elements (Chakra and old V8 fails only in this case)\n  for (code = 65; code < 76; code++) {\n    chr = String.fromCharCode(code);\n\n    switch (code) {\n      case 66: case 69: case 70: case 72: value = 3; break;\n      case 68: case 71: value = 4; break;\n      default: value = 2;\n    }\n\n    for (index = 0; index < 47; index++) {\n      test.push({ k: chr + index, v: value });\n    }\n  }\n\n  test.sort(function (a, b) { return b.v - a.v; });\n\n  for (index = 0; index < test.length; index++) {\n    chr = test[index].k.charAt(0);\n    if (result.charAt(result.length - 1) !== chr) result += chr;\n  }\n\n  return result !== 'DGBEFHACIJK';\n});\n\nvar FORCED = FAILS_ON_UNDEFINED || !FAILS_ON_NULL || !STRICT_METHOD || !STABLE_SORT;\n\nvar getSortCompare = function (comparefn) {\n  return function (x, y) {\n    if (y === undefined) return -1;\n    if (x === undefined) return 1;\n    if (comparefn !== undefined) return +comparefn(x, y) || 0;\n    return toString(x) > toString(y) ? 1 : -1;\n  };\n};\n\n// `Array.prototype.sort` method\n// https://tc39.es/ecma262/#sec-array.prototype.sort\n$({ target: 'Array', proto: true, forced: FORCED }, {\n  sort: function sort(comparefn) {\n    if (comparefn !== undefined) aCallable(comparefn);\n\n    var array = toObject(this);\n\n    if (STABLE_SORT) return comparefn === undefined ? nativeSort(array) : nativeSort(array, comparefn);\n\n    var items = [];\n    var arrayLength = lengthOfArrayLike(array);\n    var itemsLength, index;\n\n    for (index = 0; index < arrayLength; index++) {\n      if (index in array) push(items, array[index]);\n    }\n\n    internalSort(items, getSortCompare(comparefn));\n\n    itemsLength = lengthOfArrayLike(items);\n    index = 0;\n\n    while (index < itemsLength) array[index] = items[index++];\n    while (index < arrayLength) deletePropertyOrThrow(array, index++);\n\n    return array;\n  }\n});\n\n\n/***/ }),\n\n/***/ 4769:\n/***/ ((__unused_webpack_module, __unused_webpack_exports, __webpack_require__) => {\n\n\nvar $ = __webpack_require__(3103);\nvar toObject = __webpack_require__(2991);\nvar nativeKeys = __webpack_require__(5632);\nvar fails = __webpack_require__(4229);\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeKeys(1); });\n\n// `Object.keys` method\n// https://tc39.es/ecma262/#sec-object.keys\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES }, {\n  keys: function keys(it) {\n    return nativeKeys(toObject(it));\n  }\n});\n\n\n/***/ }),\n\n/***/ 1388:\n/***/ ((module, __webpack_exports__, __webpack_require__) => {\n\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Z: () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(272);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(2609);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__);\n// Imports\n\n\nvar ___CSS_LOADER_EXPORT___ = _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default()((_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default()));\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/* Buttons styles start */\r\n\r\nbutton#excalibur-play {\r\n  display: inline-block;\r\n  position: relative;\r\n  z-index: 999;\r\n  border-radius: 6px;\r\n  border: none;\r\n  /*border: 3px solid;\r\n    border-color: white;\r\n    box-shadow: 0 0 10px #ccc;*/\r\n  padding: 1rem 1.5rem 1rem 4rem;\r\n  margin: 0;\r\n  text-decoration: none;\r\n  background: #00b233;\r\n  color: #ffffff;\r\n  font-family: sans-serif;\r\n  font-size: 2rem;\r\n  white-space: nowrap;\r\n  line-height: 1;\r\n  cursor: pointer;\r\n  text-align: center;\r\n  transition: background 250ms ease-in-out, transform 150ms ease;\r\n  -webkit-appearance: none;\r\n  -moz-appearance: none;\r\n\r\n  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\r\n  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\r\n  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\r\n  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\r\n  animation: excalibur-button-fadein 200ms;\r\n}\r\n\r\n/*\r\nbutton#excalibur-play {\r\n  display: none;\r\n}*/\r\n\r\nbutton#excalibur-play:after {\r\n  position: absolute;\r\n  content: '';\r\n  border: 8px solid;\r\n  border-color: transparent transparent transparent white;\r\n  left: 35px;\r\n  top: 24px;\r\n  width: 0;\r\n  height: 0;\r\n}\r\n\r\nbutton#excalibur-play:before {\r\n  position: absolute;\r\n  content: '';\r\n  border: 3px solid;\r\n  left: 19px;\r\n  top: 14px;\r\n  border-radius: 20px;\r\n  width: 30px;\r\n  height: 30px;\r\n}\r\n\r\nbutton#excalibur-play:hover,\r\nbutton#excalibur-play:focus {\r\n  background: #00982c;\r\n}\r\n\r\nbutton#excalibur-play:focus {\r\n  outline: 1px solid #fff;\r\n  outline-offset: -4px;\r\n}\r\n\r\nbutton#excalibur-play:active {\r\n  transform: scale(0.99);\r\n}\r\n\r\n@keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Firefox < 16 */\r\n@-moz-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Safari, Chrome and Opera > 12.1 */\r\n@-webkit-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Internet Explorer */\r\n@-ms-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n\r\n/* Opera < 12.1 */\r\n@-o-keyframes excalibur-button-fadein {\r\n  from {\r\n    opacity: 0;\r\n  }\r\n  to {\r\n    opacity: 1;\r\n  }\r\n}\r\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./Loader.css\"],\"names\":[],\"mappings\":\"AAAA,yBAAyB;;AAEzB;EACE,qBAAqB;EACrB,kBAAkB;EAClB,YAAY;EACZ,kBAAkB;EAClB,YAAY;EACZ;;+BAE6B;EAC7B,8BAA8B;EAC9B,SAAS;EACT,qBAAqB;EACrB,mBAAmB;EACnB,cAAc;EACd,uBAAuB;EACvB,eAAe;EACf,mBAAmB;EACnB,cAAc;EACd,eAAe;EACf,kBAAkB;EAClB,8DAA8D;EAC9D,wBAAwB;EACxB,qBAAqB;;EAErB,gDAAgD,EAAE,oCAAoC;EACtF,6CAA6C,EAAE,iBAAiB;EAChE,4CAA4C,EAAE,sBAAsB;EACpE,2CAA2C,EAAE,iBAAiB;EAC9D,wCAAwC;AAC1C;;AAEA;;;EAGE;;AAEF;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,uDAAuD;EACvD,UAAU;EACV,SAAS;EACT,QAAQ;EACR,SAAS;AACX;;AAEA;EACE,kBAAkB;EAClB,WAAW;EACX,iBAAiB;EACjB,UAAU;EACV,SAAS;EACT,mBAAmB;EACnB,WAAW;EACX,YAAY;AACd;;AAEA;;EAEE,mBAAmB;AACrB;;AAEA;EACE,uBAAuB;EACvB,oBAAoB;AACtB;;AAEA;EACE,sBAAsB;AACxB;;AAEA;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,oCAAoC;AACpC;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,sBAAsB;AACtB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF;;AAEA,iBAAiB;AACjB;EACE;IACE,UAAU;EACZ;EACA;IACE,UAAU;EACZ;AACF\",\"sourcesContent\":[\"/* Buttons styles start */\\r\\n\\r\\nbutton#excalibur-play {\\r\\n  display: inline-block;\\r\\n  position: relative;\\r\\n  z-index: 999;\\r\\n  border-radius: 6px;\\r\\n  border: none;\\r\\n  /*border: 3px solid;\\r\\n    border-color: white;\\r\\n    box-shadow: 0 0 10px #ccc;*/\\r\\n  padding: 1rem 1.5rem 1rem 4rem;\\r\\n  margin: 0;\\r\\n  text-decoration: none;\\r\\n  background: #00b233;\\r\\n  color: #ffffff;\\r\\n  font-family: sans-serif;\\r\\n  font-size: 2rem;\\r\\n  white-space: nowrap;\\r\\n  line-height: 1;\\r\\n  cursor: pointer;\\r\\n  text-align: center;\\r\\n  transition: background 250ms ease-in-out, transform 150ms ease;\\r\\n  -webkit-appearance: none;\\r\\n  -moz-appearance: none;\\r\\n\\r\\n  -webkit-animation: excalibur-button-fadein 200ms; /* Safari, Chrome and Opera > 12.1 */\\r\\n  -moz-animation: excalibur-button-fadein 200ms; /* Firefox < 16 */\\r\\n  -ms-animation: excalibur-button-fadein 200ms; /* Internet Explorer */\\r\\n  -o-animation: excalibur-button-fadein 200ms; /* Opera < 12.1 */\\r\\n  animation: excalibur-button-fadein 200ms;\\r\\n}\\r\\n\\r\\n/*\\r\\nbutton#excalibur-play {\\r\\n  display: none;\\r\\n}*/\\r\\n\\r\\nbutton#excalibur-play:after {\\r\\n  position: absolute;\\r\\n  content: '';\\r\\n  border: 8px solid;\\r\\n  border-color: transparent transparent transparent white;\\r\\n  left: 35px;\\r\\n  top: 24px;\\r\\n  width: 0;\\r\\n  height: 0;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:before {\\r\\n  position: absolute;\\r\\n  content: '';\\r\\n  border: 3px solid;\\r\\n  left: 19px;\\r\\n  top: 14px;\\r\\n  border-radius: 20px;\\r\\n  width: 30px;\\r\\n  height: 30px;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:hover,\\r\\nbutton#excalibur-play:focus {\\r\\n  background: #00982c;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:focus {\\r\\n  outline: 1px solid #fff;\\r\\n  outline-offset: -4px;\\r\\n}\\r\\n\\r\\nbutton#excalibur-play:active {\\r\\n  transform: scale(0.99);\\r\\n}\\r\\n\\r\\n@keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Firefox < 16 */\\r\\n@-moz-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Safari, Chrome and Opera > 12.1 */\\r\\n@-webkit-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Internet Explorer */\\r\\n@-ms-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\\r\\n/* Opera < 12.1 */\\r\\n@-o-keyframes excalibur-button-fadein {\\r\\n  from {\\r\\n    opacity: 0;\\r\\n  }\\r\\n  to {\\r\\n    opacity: 1;\\r\\n  }\\r\\n}\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (___CSS_LOADER_EXPORT___);\n\n\n/***/ }),\n\n/***/ 7379:\n/***/ ((module, __webpack_exports__, __webpack_require__) => {\n\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Z: () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(272);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(2609);\n/* harmony import */ var _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__);\n// Imports\n\n\nvar ___CSS_LOADER_EXPORT___ = _node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default()((_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default()));\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `\r\n#ex-toast-container {\r\n  position: absolute;\r\n  height: 0;\r\n  min-width: 50%;\r\n  left: 50%;\r\n  top: 0;\r\n}\r\n\r\n.ex-toast-message {\r\n  left: -50%;\r\n  position: relative;\r\n  display: flex;\r\n  justify-content: space-between;\r\n\r\n\r\n  padding: 10px;\r\n  margin-top: 5px;\r\n  font-size: 18px;\r\n  font-family: sans-serif;\r\n  border-radius: 6px;\r\n  border: 3px solid #b7b779;\r\n  background-color: rgb(253, 253, 192);\r\n}\r\n\r\n\r\n.ex-toast-message button {\r\n  align-self: flex-start;\r\n}`, \"\",{\"version\":3,\"sources\":[\"webpack://./Util/Toaster.css\"],\"names\":[],\"mappings\":\";AACA;EACE,kBAAkB;EAClB,SAAS;EACT,cAAc;EACd,SAAS;EACT,MAAM;AACR;;AAEA;EACE,UAAU;EACV,kBAAkB;EAClB,aAAa;EACb,8BAA8B;;;EAG9B,aAAa;EACb,eAAe;EACf,eAAe;EACf,uBAAuB;EACvB,kBAAkB;EAClB,yBAAyB;EACzB,oCAAoC;AACtC;;;AAGA;EACE,sBAAsB;AACxB\",\"sourcesContent\":[\"\\r\\n#ex-toast-container {\\r\\n  position: absolute;\\r\\n  height: 0;\\r\\n  min-width: 50%;\\r\\n  left: 50%;\\r\\n  top: 0;\\r\\n}\\r\\n\\r\\n.ex-toast-message {\\r\\n  left: -50%;\\r\\n  position: relative;\\r\\n  display: flex;\\r\\n  justify-content: space-between;\\r\\n\\r\\n\\r\\n  padding: 10px;\\r\\n  margin-top: 5px;\\r\\n  font-size: 18px;\\r\\n  font-family: sans-serif;\\r\\n  border-radius: 6px;\\r\\n  border: 3px solid #b7b779;\\r\\n  background-color: rgb(253, 253, 192);\\r\\n}\\r\\n\\r\\n\\r\\n.ex-toast-message button {\\r\\n  align-self: flex-start;\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (___CSS_LOADER_EXPORT___);\n\n\n/***/ }),\n\n/***/ 2609:\n/***/ ((module) => {\n\n\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\nmodule.exports = function (cssWithMappingToString) {\n  var list = [];\n\n  // return the list of modules as css string\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = \"\";\n      var needLayer = typeof item[5] !== \"undefined\";\n      if (item[4]) {\n        content += \"@supports (\".concat(item[4], \") {\");\n      }\n      if (item[2]) {\n        content += \"@media \".concat(item[2], \" {\");\n      }\n      if (needLayer) {\n        content += \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\");\n      }\n      content += cssWithMappingToString(item);\n      if (needLayer) {\n        content += \"}\";\n      }\n      if (item[2]) {\n        content += \"}\";\n      }\n      if (item[4]) {\n        content += \"}\";\n      }\n      return content;\n    }).join(\"\");\n  };\n\n  // import a list of modules into the list\n  list.i = function i(modules, media, dedupe, supports, layer) {\n    if (typeof modules === \"string\") {\n      modules = [[null, modules, undefined]];\n    }\n    var alreadyImportedModules = {};\n    if (dedupe) {\n      for (var k = 0; k < this.length; k++) {\n        var id = this[k][0];\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n    for (var _k = 0; _k < modules.length; _k++) {\n      var item = [].concat(modules[_k]);\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        continue;\n      }\n      if (typeof layer !== \"undefined\") {\n        if (typeof item[5] === \"undefined\") {\n          item[5] = layer;\n        } else {\n          item[1] = \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\").concat(item[1], \"}\");\n          item[5] = layer;\n        }\n      }\n      if (media) {\n        if (!item[2]) {\n          item[2] = media;\n        } else {\n          item[1] = \"@media \".concat(item[2], \" {\").concat(item[1], \"}\");\n          item[2] = media;\n        }\n      }\n      if (supports) {\n        if (!item[4]) {\n          item[4] = \"\".concat(supports);\n        } else {\n          item[1] = \"@supports (\".concat(item[4], \") {\").concat(item[1], \"}\");\n          item[4] = supports;\n        }\n      }\n      list.push(item);\n    }\n  };\n  return list;\n};\n\n/***/ }),\n\n/***/ 272:\n/***/ ((module) => {\n\n\n\nmodule.exports = function (item) {\n  var content = item[1];\n  var cssMapping = item[3];\n  if (!cssMapping) {\n    return content;\n  }\n  if (typeof btoa === \"function\") {\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    return [content].concat([sourceMapping]).join(\"\\n\");\n  }\n  return [content].join(\"\\n\");\n};\n\n/***/ })\n\n/******/ });\n/************************************************************************/\n/******/ // The module cache\n/******/ var __webpack_module_cache__ = {};\n/******/ \n/******/ // The require function\n/******/ function __webpack_require__(moduleId) {\n/******/ \t// Check if module is in cache\n/******/ \tvar cachedModule = __webpack_module_cache__[moduleId];\n/******/ \tif (cachedModule !== undefined) {\n/******/ \t\treturn cachedModule.exports;\n/******/ \t}\n/******/ \t// Create a new module (and put it into the cache)\n/******/ \tvar module = __webpack_module_cache__[moduleId] = {\n/******/ \t\tid: moduleId,\n/******/ \t\t// no module.loaded needed\n/******/ \t\texports: {}\n/******/ \t};\n/******/ \n/******/ \t// Execute the module function\n/******/ \t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/ \n/******/ \t// Return the exports of the module\n/******/ \treturn module.exports;\n/******/ }\n/******/ \n/************************************************************************/\n/******/ /* webpack/runtime/compat get default export */\n/******/ (() => {\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = (module) => {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\t() => (module['default']) :\n/******/ \t\t\t() => (module);\n/******/ \t\t__webpack_require__.d(getter, { a: getter });\n/******/ \t\treturn getter;\n/******/ \t};\n/******/ })();\n/******/ \n/******/ /* webpack/runtime/define property getters */\n/******/ (() => {\n/******/ \t// define getter functions for harmony exports\n/******/ \t__webpack_require__.d = (exports, definition) => {\n/******/ \t\tfor(var key in definition) {\n/******/ \t\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n/******/ \t\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n/******/ \t\t\t}\n/******/ \t\t}\n/******/ \t};\n/******/ })();\n/******/ \n/******/ /* webpack/runtime/global */\n/******/ (() => {\n/******/ \t__webpack_require__.g = (function() {\n/******/ \t\tif (typeof globalThis === 'object') return globalThis;\n/******/ \t\ttry {\n/******/ \t\t\treturn this || new Function('return this')();\n/******/ \t\t} catch (e) {\n/******/ \t\t\tif (typeof window === 'object') return window;\n/******/ \t\t}\n/******/ \t})();\n/******/ })();\n/******/ \n/******/ /* webpack/runtime/hasOwnProperty shorthand */\n/******/ (() => {\n/******/ \t__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))\n/******/ })();\n/******/ \n/******/ /* webpack/runtime/make namespace object */\n/******/ (() => {\n/******/ \t// define __esModule on exports\n/******/ \t__webpack_require__.r = (exports) => {\n/******/ \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n/******/ \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n/******/ \t\t}\n/******/ \t\tObject.defineProperty(exports, '__esModule', { value: true });\n/******/ \t};\n/******/ })();\n/******/ \n/************************************************************************/\nvar __webpack_exports__ = {};\n// This entry need to be wrapped in an IIFE because it need to be isolated against other modules in the chunk.\n(() => {\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, {\n  fWn: () => (/* reexport */ ActionContext),\n  Ia8: () => (/* reexport */ ActionQueue),\n  rqv: () => (/* reexport */ ActionSequence),\n  hLI: () => (/* reexport */ ActionsComponent),\n  yyv: () => (/* reexport */ ActionsSystem),\n  tX5: () => (/* reexport */ ActivateEvent),\n  vtX: () => (/* reexport */ Actor),\n  r7K: () => (/* reexport */ AddedComponent),\n  lCh: () => (/* reexport */ AddedEntity),\n  cE4: () => (/* reexport */ AffineMatrix),\n  fwF: () => (/* reexport */ Animation),\n  sce: () => (/* reexport */ AnimationDirection),\n  AQ6: () => (/* reexport */ AnimationEvents),\n  _c7: () => (/* reexport */ AnimationStrategy),\n  KUs: () => (/* reexport */ ArcadeSolver),\n  Ajp: () => (/* reexport */ AudioContextFactory),\n  dkO: () => (/* reexport */ Axes),\n  RDh: () => (/* reexport */ Axis),\n  _H9: () => (/* reexport */ BaseAlign),\n  mxs: () => (/* reexport */ Blink),\n  OmD: () => (/* reexport */ BodyComponent),\n  kBf: () => (/* reexport */ BoundingBox),\n  C4F: () => (/* reexport */ BroadphaseStrategy),\n  NQt: () => (/* reexport */ BrowserComponent),\n  JjN: () => (/* reexport */ BrowserEvents),\n  EK_: () => (/* reexport */ Buttons),\n  V1s: () => (/* reexport */ Camera),\n  xHm: () => (/* reexport */ CameraEvents),\n  Xz7: () => (/* reexport */ Canvas),\n  Cdc: () => (/* reexport */ Circle),\n  FKn: () => (/* reexport */ CircleCollider),\n  SUY: () => (/* reexport */ Clock),\n  ab2: () => (/* reexport */ ClosestLine),\n  GfZ: () => (/* reexport */ ClosestLineJumpTable),\n  YMS: () => (/* reexport */ Collider),\n  oyv: () => (/* reexport */ ColliderComponent),\n  aUb: () => (/* reexport */ CollisionContact),\n  SdD: () => (/* reexport */ CollisionEndEvent),\n  JUv: () => (/* reexport */ CollisionGroup),\n  jEj: () => (/* reexport */ CollisionGroupManager),\n  TFq: () => (/* reexport */ CollisionJumpTable),\n  HDU: () => (/* reexport */ CollisionPostSolveEvent),\n  R_y: () => (/* reexport */ CollisionPreSolveEvent),\n  ydN: () => (/* reexport */ CollisionResolutionStrategy),\n  t50: () => (/* reexport */ CollisionStartEvent),\n  s$$: () => (/* reexport */ CollisionSystem),\n  v2G: () => (/* reexport */ CollisionType),\n  Ilk: () => (/* reexport */ Color),\n  s9i: () => (/* reexport */ ColorBlindFlags),\n  dxL: () => (/* reexport */ ColorBlindnessMode),\n  LLX: () => (/* reexport */ ColorBlindnessPostProcessor),\n  wA2: () => (/* reexport */ Component),\n  R_p: () => (/* reexport */ CompositeCollider),\n  IQ$: () => (/* reexport */ Configurable),\n  I5F: () => (/* reexport */ ConsoleAppender),\n  X8$: () => (/* reexport */ ContactConstraintPoint),\n  FR6: () => (/* reexport */ ContactEndEvent),\n  U8o: () => (/* reexport */ ContactStartEvent),\n  kbG: () => (/* reexport */ CoordPlane),\n  iS_: () => (/* reexport */ DeactivateEvent),\n  cGG: () => (/* reexport */ Debug),\n  RPN: () => (/* reexport */ DebugGraphicsComponent),\n  skb: () => (/* reexport */ DebugSystem),\n  SLU: () => (/* reexport */ DebugText),\n  RdJ: () => (/* reexport */ DegreeOfFreedom),\n  cNu: () => (/* reexport */ Delay),\n  gU7: () => (/* reexport */ Detector),\n  LSk: () => (/* reexport */ Die),\n  Nmp: () => (/* reexport */ Direction),\n  d1Y: () => (/* reexport */ DisplayMode),\n  xrL: () => (/* reexport */ DynamicTree),\n  sRW: () => (/* reexport */ DynamicTreeCollisionProcessor),\n  cmV: () => (/* binding */ EX_VERSION),\n  qWz: () => (/* reexport */ EaseBy),\n  N0Q: () => (/* reexport */ EaseTo),\n  q8b: () => (/* reexport */ EasingFunctions),\n  ynB: () => (/* reexport */ EdgeCollider),\n  jT9: () => (/* reexport */ ElasticToActorStrategy),\n  wAz: () => (/* reexport */ EmitterType),\n  D4V: () => (/* reexport */ Engine),\n  NLr: () => (/* reexport */ EngineEvents),\n  N6H: () => (/* reexport */ EnterTriggerEvent),\n  W1A: () => (/* reexport */ EnterViewPortEvent),\n  JHW: () => (/* reexport */ Entity),\n  ZZ$: () => (/* reexport */ EntityEvents),\n  v2K: () => (/* reexport */ EntityManager),\n  pBf: () => (/* reexport */ EventDispatcher),\n  vpe: () => (/* reexport */ EventEmitter),\n  GMl: () => (/* reexport */ EventTypes),\n  zW2: () => (/* reexport */ Events_namespaceObject),\n  B0K: () => (/* reexport */ ExResponse),\n  Nv7: () => (/* reexport */ ExcaliburGraphicsContext2DCanvas),\n  C_p: () => (/* reexport */ ExcaliburGraphicsContextWebGL),\n  MUA: () => (/* reexport */ ExitTriggerEvent),\n  xqU: () => (/* reexport */ ExitViewPortEvent),\n  pTp: () => (/* reexport */ Fade),\n  vUK: () => (/* reexport */ Flags),\n  j9l: () => (/* reexport */ Follow),\n  Zxw: () => (/* reexport */ Font),\n  v51: () => (/* reexport */ FontCache),\n  Hdx: () => (/* reexport */ FontStyle),\n  Z$d: () => (/* reexport */ FontUnit),\n  iqV: () => (/* reexport */ FpsSampler),\n  o$7: () => (/* reexport */ FrameStats),\n  olM: () => (/* reexport */ Future),\n  Zm$: () => (/* reexport */ GameEvent),\n  $QH: () => (/* reexport */ GameStartEvent),\n  i78: () => (/* reexport */ GameStopEvent),\n  nJg: () => (/* reexport */ Gamepad),\n  h6u: () => (/* reexport */ GamepadAxisEvent),\n  hts: () => (/* reexport */ GamepadButtonEvent),\n  j88: () => (/* reexport */ GamepadConnectEvent),\n  VME: () => (/* reexport */ GamepadDisconnectEvent),\n  fy2: () => (/* reexport */ Gamepads),\n  nt: () => (/* reexport */ Gif),\n  Ukr: () => (/* reexport */ GlobalCoordinates),\n  zsu: () => (/* reexport */ Graphic),\n  oA6: () => (/* reexport */ GraphicsComponent),\n  TVh: () => (/* reexport */ GraphicsGroup),\n  TwZ: () => (/* reexport */ GraphicsLayer),\n  GTT: () => (/* reexport */ GraphicsLayers),\n  xxj: () => (/* reexport */ GraphicsSystem),\n  XdK: () => (/* reexport */ HiddenEvent),\n  Jmb: () => (/* reexport */ ImageFiltering),\n  cXo: () => (/* reexport */ ImageSource),\n  Dm5: () => (/* reexport */ InitializeEvent),\n  IIB: () => (/* reexport */ Input_Index_namespaceObject),\n  ebW: () => (/* reexport */ InputMapper),\n  zI0: () => (/* reexport */ Integrator),\n  LYD: () => (/* reexport */ IsometricEntityComponent),\n  cEG: () => (/* reexport */ IsometricEntitySystem),\n  SEl: () => (/* reexport */ IsometricMap),\n  t9V: () => (/* reexport */ IsometricTile),\n  ez5: () => (/* reexport */ KeyEvent),\n  N1d: () => (/* reexport */ Keyboard),\n  R8U: () => (/* reexport */ Keys),\n  SKZ: () => (/* reexport */ KillEvent),\n  __J: () => (/* reexport */ Label),\n  RI$: () => (/* reexport */ LimitCameraBoundsStrategy),\n  x12: () => (/* reexport */ Line),\n  ccz: () => (/* reexport */ LineSegment),\n  aNw: () => (/* reexport */ Loader),\n  XrL: () => (/* reexport */ LoaderEvents),\n  xwn: () => (/* reexport */ LockCameraToActorAxisStrategy),\n  dNK: () => (/* reexport */ LockCameraToActorStrategy),\n  ini: () => (/* reexport */ LogLevel),\n  YdH: () => (/* reexport */ Logger),\n  F5T: () => (/* reexport */ Material),\n  y3G: () => (/* reexport */ Matrix),\n  l57: () => (/* reexport */ MatrixLocations),\n  xn0: () => (/* reexport */ MediaEvent),\n  t2V: () => (/* reexport */ Meet),\n  uxB: () => (/* reexport */ MotionComponent),\n  cpd: () => (/* reexport */ MotionSystem),\n  fiy: () => (/* reexport */ MoveBy),\n  $XZ: () => (/* reexport */ MoveTo),\n  UG6: () => (/* reexport */ NativePointerButton),\n  uqK: () => (/* reexport */ NativeSoundEvent),\n  STE: () => (/* reexport */ NativeSoundProcessedEvent),\n  y$z: () => (/* reexport */ Observable),\n  mAD: () => (/* reexport */ OffscreenSystem),\n  sOq: () => (/* reexport */ Pair),\n  hUw: () => (/* reexport */ ParallaxComponent),\n  _0G: () => (/* reexport */ ParallelActions),\n  Sqs: () => (/* reexport */ ParseGif),\n  hpZ: () => (/* reexport */ Particle),\n  Vol: () => (/* reexport */ ParticleEmitter),\n  vYX: () => (/* reexport */ ParticleTransform),\n  wIZ: () => (/* reexport */ Physics),\n  cBi: () => (/* reexport */ PhysicsStats),\n  c30: () => (/* reexport */ PhysicsWorld),\n  MPV: () => (/* reexport */ PointerButton),\n  RFv: () => (/* reexport */ PointerComponent),\n  Ux6: () => (/* reexport */ PointerEvent),\n  rxy: () => (/* reexport */ PointerEventReceiver),\n  I$c: () => (/* reexport */ PointerScope),\n  kfC: () => (/* reexport */ PointerSystem),\n  VjY: () => (/* reexport */ PointerType),\n  mgq: () => (/* reexport */ Polygon),\n  YVA: () => (/* reexport */ PolygonCollider),\n  Kgp: () => (/* reexport */ Pool),\n  HH$: () => (/* reexport */ PostCollisionEvent),\n  M_d: () => (/* reexport */ PostDebugDrawEvent),\n  rgh: () => (/* reexport */ PostDrawEvent),\n  Ra6: () => (/* reexport */ PostFrameEvent),\n  KhR: () => (/* reexport */ PostKillEvent),\n  BS5: () => (/* reexport */ PostUpdateEvent),\n  xhz: () => (/* reexport */ PreCollisionEvent),\n  xOq: () => (/* reexport */ PreDebugDrawEvent),\n  a9j: () => (/* reexport */ PreDrawEvent),\n  bHk: () => (/* reexport */ PreFrameEvent),\n  CgK: () => (/* reexport */ PreKillEvent),\n  cuY: () => (/* reexport */ PreUpdateEvent),\n  kvE: () => (/* reexport */ Projection),\n  SBu: () => (/* reexport */ QuadIndexBuffer),\n  AE_: () => (/* reexport */ Query),\n  ctO: () => (/* reexport */ QueryManager),\n  OLH: () => (/* reexport */ RadiusAroundActorStrategy),\n  kky: () => (/* reexport */ Random),\n  nSF: () => (/* reexport */ Raster),\n  zHn: () => (/* reexport */ Ray),\n  zwx: () => (/* reexport */ RealisticSolver),\n  AeJ: () => (/* reexport */ Rectangle),\n  hLz: () => (/* reexport */ RemovedComponent),\n  D9g: () => (/* reexport */ RemovedEntity),\n  wA: () => (/* reexport */ Repeat),\n  jhr: () => (/* reexport */ RepeatForever),\n  GVs: () => (/* reexport */ Resolution),\n  _zO: () => (/* reexport */ Resource),\n  LXZ: () => (/* reexport */ ResourceEvents),\n  w6$: () => (/* reexport */ RotateBy),\n  mhV: () => (/* reexport */ RotateTo),\n  MOD: () => (/* reexport */ RotationType),\n  kwd: () => (/* reexport */ ScaleBy),\n  Lmr: () => (/* reexport */ ScaleTo),\n  xsS: () => (/* reexport */ Scene),\n  K5l: () => (/* reexport */ SceneEvents),\n  lLr: () => (/* reexport */ Screen),\n  Z$r: () => (/* reexport */ ScreenAppender),\n  IXb: () => (/* reexport */ ScreenElement),\n  SGH: () => (/* reexport */ ScreenShader),\n  SMj: () => (/* reexport */ ScrollPreventionMode),\n  L34: () => (/* reexport */ Semaphore),\n  exe: () => (/* reexport */ Shader),\n  bnF: () => (/* reexport */ Shape),\n  MFA: () => (/* reexport */ Side),\n  $uU: () => (/* reexport */ Sound),\n  Sap: () => (/* reexport */ SoundEvents),\n  jyi: () => (/* reexport */ Sprite),\n  E03: () => (/* reexport */ SpriteFont),\n  V6q: () => (/* reexport */ SpriteSheet),\n  rg2: () => (/* reexport */ StandardClock),\n  DVW: () => (/* reexport */ StateMachine),\n  nVo: () => (/* reexport */ StrategyContainer),\n  F6N: () => (/* reexport */ Stream),\n  xP7: () => (/* reexport */ System),\n  Odq: () => (/* reexport */ SystemManager),\n  Zif: () => (/* reexport */ SystemType),\n  ZGJ: () => (/* reexport */ TagComponent),\n  MJk: () => (/* reexport */ TestClock),\n  xvT: () => (/* reexport */ Text),\n  PHM: () => (/* reexport */ TextAlign),\n  dpR: () => (/* reexport */ TextureLoader),\n  n9L: () => (/* reexport */ Tile),\n  KwO: () => (/* reexport */ TileMap),\n  SxM: () => (/* reexport */ TileMapEvents),\n  B7y: () => (/* reexport */ Timer),\n  x7r: () => (/* reexport */ Toaster),\n  wx7: () => (/* reexport */ Transform),\n  Uvn: () => (/* reexport */ TransformComponent),\n  OFT: () => (/* reexport */ TreeNode),\n  xzN: () => (/* reexport */ Trigger),\n  CcZ: () => (/* reexport */ TriggerEvents),\n  M5Z: () => (/* reexport */ TwoPI),\n  ZrN: () => (/* reexport */ Util_Index_namespaceObject),\n  OWs: () => (/* reexport */ Vector),\n  dF9: () => (/* reexport */ VectorView),\n  oZy: () => (/* reexport */ VertexBuffer),\n  rD2: () => (/* reexport */ VertexLayout),\n  VHo: () => (/* reexport */ VisibleEvent),\n  ohE: () => (/* reexport */ WebAudio),\n  R$E: () => (/* reexport */ WebAudioInstance),\n  xQN: () => (/* reexport */ WheelDeltaMode),\n  AdJ: () => (/* reexport */ WheelEvent),\n  q3I: () => (/* reexport */ World),\n  Pab: () => (/* reexport */ canonicalizeAngle),\n  uZ5: () => (/* reexport */ clamp),\n  McK: () => (/* reexport */ createId),\n  F9c: () => (/* reexport */ frac),\n  k0b: () => (/* reexport */ hasGraphicsTick),\n  hnT: () => (/* reexport */ hasOnInitialize),\n  RSJ: () => (/* reexport */ hasOnPostUpdate),\n  Mku: () => (/* reexport */ hasOnPreUpdate),\n  h90: () => (/* reexport */ hasPostDraw),\n  rms: () => (/* reexport */ hasPreDraw),\n  ErP: () => (/* reexport */ has_initialize),\n  aVg: () => (/* reexport */ has_postupdate),\n  lPc: () => (/* reexport */ has_preupdate),\n  Z8E: () => (/* reexport */ isAddedComponent),\n  _N2: () => (/* reexport */ isAddedSystemEntity),\n  yFn: () => (/* reexport */ isRemoveSystemEntity),\n  lNv: () => (/* reexport */ isRemovedComponent),\n  cu9: () => (/* reexport */ isScreenElement),\n  MZQ: () => (/* reexport */ maxMessages),\n  FUM: () => (/* reexport */ obsolete),\n  BxR: () => (/* reexport */ pixelSnapEpsilon),\n  vdf: () => (/* reexport */ randomInRange),\n  iaL: () => (/* reexport */ randomIntInRange),\n  w6H: () => (/* reexport */ range),\n  Q4c: () => (/* reexport */ resetObsoleteCounter),\n  Xxe: () => (/* reexport */ sign),\n  Uxb: () => (/* reexport */ toDegrees),\n  Yr5: () => (/* reexport */ toRadians),\n  Bhw: () => (/* reexport */ vec),\n  yOA: () => (/* reexport */ webgl_util_namespaceObject)\n});\n\n// NAMESPACE OBJECT: ./Events.ts\nvar Events_namespaceObject = {};\n__webpack_require__.r(Events_namespaceObject);\n__webpack_require__.d(Events_namespaceObject, {\n  ActivateEvent: () => (ActivateEvent),\n  CollisionEndEvent: () => (CollisionEndEvent),\n  CollisionPostSolveEvent: () => (CollisionPostSolveEvent),\n  CollisionPreSolveEvent: () => (CollisionPreSolveEvent),\n  CollisionStartEvent: () => (CollisionStartEvent),\n  ContactEndEvent: () => (ContactEndEvent),\n  ContactStartEvent: () => (ContactStartEvent),\n  DeactivateEvent: () => (DeactivateEvent),\n  EnterTriggerEvent: () => (EnterTriggerEvent),\n  EnterViewPortEvent: () => (EnterViewPortEvent),\n  EventTypes: () => (EventTypes),\n  ExitTriggerEvent: () => (ExitTriggerEvent),\n  ExitViewPortEvent: () => (ExitViewPortEvent),\n  GameEvent: () => (GameEvent),\n  GameStartEvent: () => (GameStartEvent),\n  GameStopEvent: () => (GameStopEvent),\n  GamepadAxisEvent: () => (GamepadAxisEvent),\n  GamepadButtonEvent: () => (GamepadButtonEvent),\n  GamepadConnectEvent: () => (GamepadConnectEvent),\n  GamepadDisconnectEvent: () => (GamepadDisconnectEvent),\n  HiddenEvent: () => (HiddenEvent),\n  InitializeEvent: () => (InitializeEvent),\n  KillEvent: () => (KillEvent),\n  PostCollisionEvent: () => (PostCollisionEvent),\n  PostDebugDrawEvent: () => (PostDebugDrawEvent),\n  PostDrawEvent: () => (PostDrawEvent),\n  PostFrameEvent: () => (PostFrameEvent),\n  PostKillEvent: () => (PostKillEvent),\n  PostUpdateEvent: () => (PostUpdateEvent),\n  PreCollisionEvent: () => (PreCollisionEvent),\n  PreDebugDrawEvent: () => (PreDebugDrawEvent),\n  PreDrawEvent: () => (PreDrawEvent),\n  PreFrameEvent: () => (PreFrameEvent),\n  PreKillEvent: () => (PreKillEvent),\n  PreUpdateEvent: () => (PreUpdateEvent),\n  VisibleEvent: () => (VisibleEvent)\n});\n\n// NAMESPACE OBJECT: ./Graphics/Context/webgl-util.ts\nvar webgl_util_namespaceObject = {};\n__webpack_require__.r(webgl_util_namespaceObject);\n__webpack_require__.d(webgl_util_namespaceObject, {\n  getAttributeComponentSize: () => (getAttributeComponentSize),\n  getAttributePointerType: () => (getAttributePointerType),\n  getGlTypeSizeBytes: () => (getGlTypeSizeBytes)\n});\n\n// NAMESPACE OBJECT: ./Util/DrawUtil.ts\nvar DrawUtil_namespaceObject = {};\n__webpack_require__.r(DrawUtil_namespaceObject);\n__webpack_require__.d(DrawUtil_namespaceObject, {\n  circle: () => (circle),\n  line: () => (line),\n  point: () => (point),\n  roundRect: () => (roundRect),\n  vector: () => (vector)\n});\n\n// NAMESPACE OBJECT: ./Input/Index.ts\nvar Input_Index_namespaceObject = {};\n__webpack_require__.r(Input_Index_namespaceObject);\n__webpack_require__.d(Input_Index_namespaceObject, {\n  Axes: () => (Axes),\n  Buttons: () => (Buttons),\n  Gamepad: () => (Gamepad),\n  Gamepads: () => (Gamepads),\n  KeyEvent: () => (KeyEvent),\n  Keyboard: () => (Keyboard),\n  Keys: () => (Keys),\n  NativePointerButton: () => (NativePointerButton),\n  PointerButton: () => (PointerButton),\n  PointerComponent: () => (PointerComponent),\n  PointerEvent: () => (PointerEvent),\n  PointerEventReceiver: () => (PointerEventReceiver),\n  PointerScope: () => (PointerScope),\n  PointerSystem: () => (PointerSystem),\n  PointerType: () => (PointerType),\n  WheelDeltaMode: () => (WheelDeltaMode),\n  WheelEvent: () => (WheelEvent)\n});\n\n// NAMESPACE OBJECT: ./Util/Index.ts\nvar Util_Index_namespaceObject = {};\n__webpack_require__.r(Util_Index_namespaceObject);\n__webpack_require__.d(Util_Index_namespaceObject, {\n  ConsoleAppender: () => (ConsoleAppender),\n  DrawUtil: () => (DrawUtil_namespaceObject),\n  EasingFunctions: () => (EasingFunctions),\n  LogLevel: () => (LogLevel),\n  Logger: () => (Logger),\n  Observable: () => (Observable),\n  ScreenAppender: () => (ScreenAppender),\n  addItemToArray: () => (addItemToArray),\n  contains: () => (contains),\n  delay: () => (delay),\n  fail: () => (fail),\n  getPosition: () => (getPosition),\n  removeItemFromArray: () => (removeItemFromArray)\n});\n\n// EXTERNAL MODULE: ../../node_modules/core-js/es/array/sort.js\nvar sort = __webpack_require__(4662);\n// EXTERNAL MODULE: ../../node_modules/core-js/es/object/keys.js\nvar keys = __webpack_require__(8343);\n;// CONCATENATED MODULE: ./Polyfill.ts\n\r\n\r\n/**\r\n * Polyfill adding function\r\n */\r\nfunction polyfill() {\r\n    /* istanbul ignore next */\r\n    if (typeof window === 'undefined') {\r\n        window = {\r\n            audioContext: function () {\r\n                return;\r\n            }\r\n        };\r\n    }\r\n    /* istanbul ignore next */\r\n    if (typeof window !== 'undefined' && !window.requestAnimationFrame) {\r\n        window.requestAnimationFrame =\r\n            window.webkitRequestAnimationFrame ||\r\n                window.mozRequestAnimationFrame ||\r\n                function (callback) {\r\n                    window.setInterval(callback, 1000 / 60);\r\n                };\r\n    }\r\n    /* istanbul ignore next */\r\n    if (typeof window !== 'undefined' && !window.cancelAnimationFrame) {\r\n        window.cancelAnimationFrame =\r\n            window.webkitCancelAnimationFrame ||\r\n                window.mozCancelAnimationFrame ||\r\n                function () {\r\n                    return;\r\n                };\r\n    }\r\n    /* istanbul ignore next */\r\n    if (typeof window !== 'undefined' && !window.AudioContext) {\r\n        if (window.webkitAudioContext) {\r\n            const ctx = window.webkitAudioContext;\r\n            const replaceMe = ctx.prototype.decodeAudioData;\r\n            window.webkitAudioContext.prototype.decodeAudioData = function (arrayBuffer) {\r\n                return new Promise((resolve, reject) => {\r\n                    replaceMe.call(this, arrayBuffer, resolve, reject);\r\n                });\r\n            };\r\n        }\r\n        window.AudioContext =\r\n            window.AudioContext ||\r\n                window.webkitAudioContext ||\r\n                window.mozAudioContext ||\r\n                window.msAudioContext ||\r\n                window.oAudioContext;\r\n    }\r\n    /* istanbul ignore next */\r\n    if (typeof window !== 'undefined' && !window.devicePixelRatio) {\r\n        window.devicePixelRatio = window.devicePixelRatio || 1;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Flags.ts\n/**\r\n * Flags is a feature flag implementation for Excalibur. They can only be operated **before [[Engine]] construction**\r\n * after which they are frozen and are read-only.\r\n *\r\n * Flags are used to enable experimental or preview features in Excalibur.\r\n */\r\nclass Flags {\r\n    /**\r\n     * Force excalibur to load the Canvas 2D graphics context fallback\r\n     *\r\n     * @warning not all features of excalibur are supported in the Canvas 2D fallback\r\n     */\r\n    static useCanvasGraphicsContext() {\r\n        Flags.enable('use-canvas-context');\r\n    }\r\n    /**\r\n     * Freeze all flag modifications making them readonly\r\n     */\r\n    static freeze() {\r\n        Flags._FROZEN = true;\r\n    }\r\n    /**\r\n     * Resets internal flag state, not meant to be called by users. Only used for testing.\r\n     *\r\n     * Calling this in your game is UNSUPPORTED\r\n     * @internal\r\n     */\r\n    static _reset() {\r\n        Flags._FROZEN = false;\r\n        Flags._FLAGS = {};\r\n    }\r\n    /**\r\n     * Enable a specific feature flag by name. **Note: can only be set before [[Engine]] constructor time**\r\n     * @param flagName\r\n     */\r\n    static enable(flagName) {\r\n        if (this._FROZEN) {\r\n            throw Error('Feature flags can only be enabled before Engine constructor time');\r\n        }\r\n        Flags._FLAGS[flagName] = true;\r\n    }\r\n    /**\r\n     * Disable a specific feature flag by name. **Note: can only be set before [[Engine]] constructor time**\r\n     * @param flagName\r\n     */\r\n    static disable(flagName) {\r\n        if (this._FROZEN) {\r\n            throw Error('Feature flags can only be disabled before Engine constructor time');\r\n        }\r\n        Flags._FLAGS[flagName] = false;\r\n    }\r\n    /**\r\n     * Check if a flag is enabled. If the flag is disabled or does not exist `false` is returned\r\n     * @param flagName\r\n     */\r\n    static isEnabled(flagName) {\r\n        return !!Flags._FLAGS[flagName];\r\n    }\r\n    /**\r\n     * Show a list of currently known flags\r\n     */\r\n    static show() {\r\n        return Object.keys(Flags._FLAGS);\r\n    }\r\n}\r\nFlags._FROZEN = false;\r\nFlags._FLAGS = {};\r\n\n;// CONCATENATED MODULE: ./Id.ts\n/**\r\n * Create a branded ID type from a number\r\n */\r\nfunction createId(type, value) {\r\n    return { type, value };\r\n}\r\n;\r\n\n;// CONCATENATED MODULE: ./EventEmitter.ts\n/**\r\n * Excalibur's typed event emitter, this allows events to be sent with any string to Type mapping\r\n */\r\nclass EventEmitter {\r\n    constructor() {\r\n        this._paused = false;\r\n        this._listeners = {};\r\n        this._listenersOnce = {};\r\n        this._pipes = [];\r\n    }\r\n    clear() {\r\n        this._listeners = {};\r\n        this._listenersOnce = {};\r\n        this._pipes.length = 0;\r\n    }\r\n    on(eventName, handler) {\r\n        var _a;\r\n        this._listeners[eventName] = (_a = this._listeners[eventName]) !== null && _a !== void 0 ? _a : [];\r\n        this._listeners[eventName].push(handler);\r\n        return {\r\n            close: () => this.off(eventName, handler)\r\n        };\r\n    }\r\n    once(eventName, handler) {\r\n        var _a;\r\n        this._listenersOnce[eventName] = (_a = this._listenersOnce[eventName]) !== null && _a !== void 0 ? _a : [];\r\n        this._listenersOnce[eventName].push(handler);\r\n        return {\r\n            close: () => this.off(eventName, handler)\r\n        };\r\n    }\r\n    off(eventName, handler) {\r\n        var _a, _b, _c, _d;\r\n        if (handler) {\r\n            const listenerIndex = (_a = this._listeners[eventName]) === null || _a === void 0 ? void 0 : _a.indexOf(handler);\r\n            if (listenerIndex > -1) {\r\n                (_b = this._listeners[eventName]) === null || _b === void 0 ? void 0 : _b.splice(listenerIndex, 1);\r\n            }\r\n            const onceIndex = (_c = this._listenersOnce[eventName]) === null || _c === void 0 ? void 0 : _c.indexOf(handler);\r\n            if (onceIndex > -1) {\r\n                (_d = this._listenersOnce[eventName]) === null || _d === void 0 ? void 0 : _d.splice(onceIndex, 1);\r\n            }\r\n        }\r\n        else {\r\n            delete this._listeners[eventName];\r\n        }\r\n    }\r\n    emit(eventName, event) {\r\n        var _a;\r\n        if (this._paused) {\r\n            return;\r\n        }\r\n        (_a = this._listeners[eventName]) === null || _a === void 0 ? void 0 : _a.forEach((fn) => fn(event));\r\n        const onces = this._listenersOnce[eventName];\r\n        this._listenersOnce[eventName] = [];\r\n        if (onces) {\r\n            onces.forEach((fn) => fn(event));\r\n        }\r\n        this._pipes.forEach((pipe) => {\r\n            pipe.emit(eventName, event);\r\n        });\r\n    }\r\n    pipe(emitter) {\r\n        if (this === emitter) {\r\n            throw Error('Cannot pipe to self');\r\n        }\r\n        this._pipes.push(emitter);\r\n        return {\r\n            close: () => {\r\n                const i = this._pipes.indexOf(emitter);\r\n                if (i > -1) {\r\n                    this._pipes.splice(i, 1);\r\n                }\r\n            }\r\n        };\r\n    }\r\n    unpipe(emitter) {\r\n        const i = this._pipes.indexOf(emitter);\r\n        if (i > -1) {\r\n            this._pipes.splice(i, 1);\r\n        }\r\n    }\r\n    pause() {\r\n        this._paused = true;\r\n    }\r\n    unpause() {\r\n        this._paused = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Events.ts\nvar EventTypes;\r\n(function (EventTypes) {\r\n    EventTypes[\"Kill\"] = \"kill\";\r\n    EventTypes[\"PreKill\"] = \"prekill\";\r\n    EventTypes[\"PostKill\"] = \"postkill\";\r\n    EventTypes[\"PreDraw\"] = \"predraw\";\r\n    EventTypes[\"PostDraw\"] = \"postdraw\";\r\n    EventTypes[\"PreDebugDraw\"] = \"predebugdraw\";\r\n    EventTypes[\"PostDebugDraw\"] = \"postdebugdraw\";\r\n    EventTypes[\"PreUpdate\"] = \"preupdate\";\r\n    EventTypes[\"PostUpdate\"] = \"postupdate\";\r\n    EventTypes[\"PreFrame\"] = \"preframe\";\r\n    EventTypes[\"PostFrame\"] = \"postframe\";\r\n    EventTypes[\"PreCollision\"] = \"precollision\";\r\n    EventTypes[\"CollisionStart\"] = \"collisionstart\";\r\n    EventTypes[\"CollisionEnd\"] = \"collisionend\";\r\n    EventTypes[\"PostCollision\"] = \"postcollision\";\r\n    EventTypes[\"Initialize\"] = \"initialize\";\r\n    EventTypes[\"Activate\"] = \"activate\";\r\n    EventTypes[\"Deactivate\"] = \"deactivate\";\r\n    EventTypes[\"ExitViewport\"] = \"exitviewport\";\r\n    EventTypes[\"EnterViewport\"] = \"enterviewport\";\r\n    EventTypes[\"ExitTrigger\"] = \"exit\";\r\n    EventTypes[\"EnterTrigger\"] = \"enter\";\r\n    EventTypes[\"Connect\"] = \"connect\";\r\n    EventTypes[\"Disconnect\"] = \"disconnect\";\r\n    EventTypes[\"Button\"] = \"button\";\r\n    EventTypes[\"Axis\"] = \"axis\";\r\n    EventTypes[\"Visible\"] = \"visible\";\r\n    EventTypes[\"Hidden\"] = \"hidden\";\r\n    EventTypes[\"Start\"] = \"start\";\r\n    EventTypes[\"Stop\"] = \"stop\";\r\n    EventTypes[\"PointerUp\"] = \"pointerup\";\r\n    EventTypes[\"PointerDown\"] = \"pointerdown\";\r\n    EventTypes[\"PointerMove\"] = \"pointermove\";\r\n    EventTypes[\"PointerEnter\"] = \"pointerenter\";\r\n    EventTypes[\"PointerLeave\"] = \"pointerleave\";\r\n    EventTypes[\"PointerCancel\"] = \"pointercancel\";\r\n    EventTypes[\"PointerWheel\"] = \"pointerwheel\";\r\n    EventTypes[\"Up\"] = \"up\";\r\n    EventTypes[\"Down\"] = \"down\";\r\n    EventTypes[\"Move\"] = \"move\";\r\n    EventTypes[\"Enter\"] = \"enter\";\r\n    EventTypes[\"Leave\"] = \"leave\";\r\n    EventTypes[\"Cancel\"] = \"cancel\";\r\n    EventTypes[\"Wheel\"] = \"wheel\";\r\n    EventTypes[\"Press\"] = \"press\";\r\n    EventTypes[\"Release\"] = \"release\";\r\n    EventTypes[\"Hold\"] = \"hold\";\r\n    EventTypes[\"PointerDragStart\"] = \"pointerdragstart\";\r\n    EventTypes[\"PointerDragEnd\"] = \"pointerdragend\";\r\n    EventTypes[\"PointerDragEnter\"] = \"pointerdragenter\";\r\n    EventTypes[\"PointerDragLeave\"] = \"pointerdragleave\";\r\n    EventTypes[\"PointerDragMove\"] = \"pointerdragmove\";\r\n})(EventTypes || (EventTypes = {}));\r\n/**\r\n * Base event type in Excalibur that all other event types derive from. Not all event types are thrown on all Excalibur game objects,\r\n * some events are unique to a type, others are not.\r\n *\r\n */\r\nclass GameEvent {\r\n    constructor() {\r\n        this._bubbles = true;\r\n    }\r\n    /**\r\n     * If set to false, prevents event from propagating to other actors. If true it will be propagated\r\n     * to all actors that apply.\r\n     */\r\n    get bubbles() {\r\n        return this._bubbles;\r\n    }\r\n    set bubbles(value) {\r\n        this._bubbles = value;\r\n    }\r\n    /**\r\n     * Prevents event from bubbling\r\n     */\r\n    stopPropagation() {\r\n        this.bubbles = false;\r\n    }\r\n}\r\n/**\r\n * The 'kill' event is emitted on actors when it is killed. The target is the actor that was killed.\r\n */\r\nclass KillEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'prekill' event is emitted directly before an actor is killed.\r\n */\r\nclass PreKillEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'postkill' event is emitted directly after the actor is killed.\r\n */\r\nclass PostKillEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'start' event is emitted on engine when has started and is ready for interaction.\r\n */\r\nclass GameStartEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'stop' event is emitted on engine when has been stopped and will no longer take input, update or draw.\r\n */\r\nclass GameStopEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'predraw' event is emitted on actors, scenes, and engine before drawing starts. Actors' predraw happens inside their graphics\r\n * transform so that all drawing takes place with the actor as the origin.\r\n *\r\n */\r\nclass PreDrawEvent extends GameEvent {\r\n    constructor(ctx, delta, target) {\r\n        super();\r\n        this.ctx = ctx;\r\n        this.delta = delta;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'postdraw' event is emitted on actors, scenes, and engine after drawing finishes. Actors' postdraw happens inside their graphics\r\n * transform so that all drawing takes place with the actor as the origin.\r\n *\r\n */\r\nclass PostDrawEvent extends GameEvent {\r\n    constructor(ctx, delta, target) {\r\n        super();\r\n        this.ctx = ctx;\r\n        this.delta = delta;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'predebugdraw' event is emitted on actors, scenes, and engine before debug drawing starts.\r\n */\r\nclass PreDebugDrawEvent extends GameEvent {\r\n    constructor(ctx, target) {\r\n        super();\r\n        this.ctx = ctx;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'postdebugdraw' event is emitted on actors, scenes, and engine after debug drawing starts.\r\n */\r\nclass PostDebugDrawEvent extends GameEvent {\r\n    constructor(ctx, target) {\r\n        super();\r\n        this.ctx = ctx;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'preupdate' event is emitted on actors, scenes, camera, and engine before the update starts.\r\n */\r\nclass PreUpdateEvent extends GameEvent {\r\n    constructor(engine, delta, target) {\r\n        super();\r\n        this.engine = engine;\r\n        this.delta = delta;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'postupdate' event is emitted on actors, scenes, camera, and engine after the update ends.\r\n */\r\nclass PostUpdateEvent extends GameEvent {\r\n    constructor(engine, delta, target) {\r\n        super();\r\n        this.engine = engine;\r\n        this.delta = delta;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * The 'preframe' event is emitted on the engine, before the frame begins.\r\n */\r\nclass PreFrameEvent extends GameEvent {\r\n    constructor(engine, prevStats) {\r\n        super();\r\n        this.engine = engine;\r\n        this.prevStats = prevStats;\r\n        this.target = engine;\r\n    }\r\n}\r\n/**\r\n * The 'postframe' event is emitted on the engine, after a frame ends.\r\n */\r\nclass PostFrameEvent extends GameEvent {\r\n    constructor(engine, stats) {\r\n        super();\r\n        this.engine = engine;\r\n        this.stats = stats;\r\n        this.target = engine;\r\n    }\r\n}\r\n/**\r\n * Event received when a gamepad is connected to Excalibur. [[Gamepads]] receives this event.\r\n */\r\nclass GamepadConnectEvent extends GameEvent {\r\n    constructor(index, gamepad) {\r\n        super();\r\n        this.index = index;\r\n        this.gamepad = gamepad;\r\n        this.target = gamepad;\r\n    }\r\n}\r\n/**\r\n * Event received when a gamepad is disconnected from Excalibur. [[Gamepads]] receives this event.\r\n */\r\nclass GamepadDisconnectEvent extends GameEvent {\r\n    constructor(index, gamepad) {\r\n        super();\r\n        this.index = index;\r\n        this.gamepad = gamepad;\r\n        this.target = gamepad;\r\n    }\r\n}\r\n/**\r\n * Gamepad button event. See [[Gamepads]] for information on responding to controller input. [[Gamepad]] instances receive this event;\r\n */\r\nclass GamepadButtonEvent extends GameEvent {\r\n    /**\r\n     * @param button  The Gamepad button\r\n     * @param value   A numeric value between 0 and 1\r\n     */\r\n    constructor(button, value, target) {\r\n        super();\r\n        this.button = button;\r\n        this.value = value;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Gamepad axis event. See [[Gamepads]] for information on responding to controller input. [[Gamepad]] instances receive this event;\r\n */\r\nclass GamepadAxisEvent extends GameEvent {\r\n    /**\r\n     * @param axis  The Gamepad axis\r\n     * @param value A numeric value between -1 and 1\r\n     */\r\n    constructor(axis, value, target) {\r\n        super();\r\n        this.axis = axis;\r\n        this.value = value;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Event received by the [[Engine]] when the browser window is visible on a screen.\r\n */\r\nclass VisibleEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Event received by the [[Engine]] when the browser window is hidden from all screens.\r\n */\r\nclass HiddenEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Event thrown on an [[Actor|actor]] when a collision will occur this frame if it resolves\r\n */\r\nclass PreCollisionEvent extends GameEvent {\r\n    /**\r\n     * @param actor         The actor the event was thrown on\r\n     * @param other         The actor that will collided with the current actor\r\n     * @param side          The side that will be collided with the current actor\r\n     * @param intersection  Intersection vector\r\n     */\r\n    constructor(actor, other, side, intersection) {\r\n        super();\r\n        this.other = other;\r\n        this.side = side;\r\n        this.intersection = intersection;\r\n        this.target = actor;\r\n    }\r\n}\r\n/**\r\n * Event thrown on an [[Actor|actor]] when a collision has been resolved (body reacted) this frame\r\n */\r\nclass PostCollisionEvent extends GameEvent {\r\n    /**\r\n     * @param actor         The actor the event was thrown on\r\n     * @param other         The actor that did collide with the current actor\r\n     * @param side          The side that did collide with the current actor\r\n     * @param intersection  Intersection vector\r\n     */\r\n    constructor(actor, other, side, intersection) {\r\n        super();\r\n        this.other = other;\r\n        this.side = side;\r\n        this.intersection = intersection;\r\n        this.target = actor;\r\n    }\r\n    get actor() {\r\n        return this.target;\r\n    }\r\n    set actor(actor) {\r\n        this.target = actor;\r\n    }\r\n}\r\nclass ContactStartEvent {\r\n    constructor(target, other, contact) {\r\n        this.target = target;\r\n        this.other = other;\r\n        this.contact = contact;\r\n    }\r\n}\r\nclass ContactEndEvent {\r\n    constructor(target, other) {\r\n        this.target = target;\r\n        this.other = other;\r\n    }\r\n}\r\nclass CollisionPreSolveEvent {\r\n    constructor(target, other, side, intersection, contact) {\r\n        this.target = target;\r\n        this.other = other;\r\n        this.side = side;\r\n        this.intersection = intersection;\r\n        this.contact = contact;\r\n    }\r\n}\r\nclass CollisionPostSolveEvent {\r\n    constructor(target, other, side, intersection, contact) {\r\n        this.target = target;\r\n        this.other = other;\r\n        this.side = side;\r\n        this.intersection = intersection;\r\n        this.contact = contact;\r\n    }\r\n}\r\n/**\r\n * Event thrown the first time an [[Actor|actor]] collides with another, after an actor is in contact normal collision events are fired.\r\n */\r\nclass CollisionStartEvent extends GameEvent {\r\n    /**\r\n     *\r\n     * @param actor\r\n     * @param other\r\n     * @param contact\r\n     */\r\n    constructor(actor, other, contact) {\r\n        super();\r\n        this.other = other;\r\n        this.contact = contact;\r\n        this.target = actor;\r\n    }\r\n    get actor() {\r\n        return this.target;\r\n    }\r\n    set actor(actor) {\r\n        this.target = actor;\r\n    }\r\n}\r\n/**\r\n * Event thrown when the [[Actor|actor]] is no longer colliding with another\r\n */\r\nclass CollisionEndEvent extends GameEvent {\r\n    /**\r\n     *\r\n     */\r\n    constructor(actor, other) {\r\n        super();\r\n        this.other = other;\r\n        this.target = actor;\r\n    }\r\n    get actor() {\r\n        return this.target;\r\n    }\r\n    set actor(actor) {\r\n        this.target = actor;\r\n    }\r\n}\r\n/**\r\n * Event thrown on an [[Actor]], [[Scene]], and [[Engine]] only once before the first update call\r\n */\r\nclass InitializeEvent extends GameEvent {\r\n    /**\r\n     * @param engine  The reference to the current engine\r\n     */\r\n    constructor(engine, target) {\r\n        super();\r\n        this.engine = engine;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Event thrown on a [[Scene]] on activation\r\n */\r\nclass ActivateEvent extends GameEvent {\r\n    /**\r\n     * @param context  The context for the scene activation\r\n     */\r\n    constructor(context, target) {\r\n        super();\r\n        this.context = context;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Event thrown on a [[Scene]] on deactivation\r\n */\r\nclass DeactivateEvent extends GameEvent {\r\n    /**\r\n     * @param context  The context for the scene deactivation\r\n     */\r\n    constructor(context, target) {\r\n        super();\r\n        this.context = context;\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Event thrown on an [[Actor]] when it completely leaves the screen.\r\n */\r\nclass ExitViewPortEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\n/**\r\n * Event thrown on an [[Actor]] when it completely leaves the screen.\r\n */\r\nclass EnterViewPortEvent extends GameEvent {\r\n    constructor(target) {\r\n        super();\r\n        this.target = target;\r\n    }\r\n}\r\nclass EnterTriggerEvent extends GameEvent {\r\n    constructor(target, actor) {\r\n        super();\r\n        this.target = target;\r\n        this.actor = actor;\r\n    }\r\n}\r\nclass ExitTriggerEvent extends GameEvent {\r\n    constructor(target, actor) {\r\n        super();\r\n        this.target = target;\r\n        this.actor = actor;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Input/Gamepad.ts\n\r\n\r\nconst GamepadEvents = {\r\n    GamepadConnect: 'connect',\r\n    GamepadDisconnect: 'disconnect',\r\n    GamepadButton: 'button',\r\n    GamepadAxis: 'axis'\r\n};\r\n/**\r\n * Excalibur leverages the HTML5 Gamepad API [where it is supported](http://caniuse.com/#feat=gamepad)\r\n * to provide controller support for your games.\r\n */\r\nclass Gamepads {\r\n    constructor() {\r\n        this.events = new EventEmitter();\r\n        /**\r\n         * Whether or not to poll for Gamepad input (default: `false`)\r\n         */\r\n        this.enabled = false;\r\n        /**\r\n         * Whether or not Gamepad API is supported\r\n         */\r\n        this.supported = !!navigator.getGamepads;\r\n        this._gamePadTimeStamps = [0, 0, 0, 0];\r\n        this._oldPads = [];\r\n        this._pads = [];\r\n        this._initSuccess = false;\r\n        this._navigator = navigator;\r\n        this._minimumConfiguration = null;\r\n    }\r\n    init() {\r\n        if (!this.supported) {\r\n            return;\r\n        }\r\n        if (this._initSuccess) {\r\n            return;\r\n        }\r\n        // In Chrome, this will return 4 undefined items until a button is pressed\r\n        // In FF, this will not return any items until a button is pressed\r\n        this._oldPads = this._clonePads(this._navigator.getGamepads());\r\n        if (this._oldPads.length && this._oldPads[0]) {\r\n            this._initSuccess = true;\r\n        }\r\n    }\r\n    /**\r\n     * Sets the minimum gamepad configuration, for example {axis: 4, buttons: 4} means\r\n     * this game requires at minimum 4 axis inputs and 4 buttons, this is not restrictive\r\n     * all other controllers with more axis or buttons are valid as well. If no minimum\r\n     * configuration is set all pads are valid.\r\n     */\r\n    setMinimumGamepadConfiguration(config) {\r\n        this._enableAndUpdate(); // if config is used, implicitly enable\r\n        this._minimumConfiguration = config;\r\n    }\r\n    /**\r\n     * When implicitly enabled, set the enabled flag and run an update so information is updated\r\n     */\r\n    _enableAndUpdate() {\r\n        if (!this.enabled) {\r\n            this.enabled = true;\r\n            this.update();\r\n        }\r\n    }\r\n    /**\r\n     * Checks a navigator gamepad against the minimum configuration if present.\r\n     */\r\n    _isGamepadValid(pad) {\r\n        if (!this._minimumConfiguration) {\r\n            return true;\r\n        }\r\n        if (!pad) {\r\n            return false;\r\n        }\r\n        const axesLength = pad.axes.filter((value) => {\r\n            return typeof value !== undefined;\r\n        }).length;\r\n        const buttonLength = pad.buttons.filter((value) => {\r\n            return typeof value !== undefined;\r\n        }).length;\r\n        return axesLength >= this._minimumConfiguration.axis && buttonLength >= this._minimumConfiguration.buttons && pad.connected;\r\n    }\r\n    emit(eventName, event) {\r\n        this.events.emit(eventName, event);\r\n    }\r\n    on(eventName, handler) {\r\n        this._enableAndUpdate(); // implicitly enable\r\n        return this.events.on(eventName, handler);\r\n    }\r\n    once(eventName, handler) {\r\n        return this.events.once(eventName, handler);\r\n    }\r\n    off(eventName, handler) {\r\n        this._enableAndUpdate(); // implicitly enable\r\n        this.events.off(eventName, handler);\r\n    }\r\n    /**\r\n     * Updates Gamepad state and publishes Gamepad events\r\n     */\r\n    update() {\r\n        if (!this.enabled || !this.supported) {\r\n            return;\r\n        }\r\n        this.init();\r\n        const gamepads = this._navigator.getGamepads();\r\n        for (let i = 0; i < gamepads.length; i++) {\r\n            if (!gamepads[i]) {\r\n                const gamepad = this.at(i);\r\n                // If was connected, but now isn't emit the disconnect event\r\n                if (gamepad.connected) {\r\n                    this.events.emit('disconnect', new GamepadDisconnectEvent(i, gamepad));\r\n                }\r\n                // Reset connection status\r\n                gamepad.connected = false;\r\n                continue;\r\n            }\r\n            else {\r\n                if (!this.at(i).connected && this._isGamepadValid(gamepads[i])) {\r\n                    this.events.emit('connect', new GamepadConnectEvent(i, this.at(i)));\r\n                }\r\n                // Set connection status\r\n                this.at(i).connected = true;\r\n            }\r\n            this.at(i).update();\r\n            // Only supported in Chrome\r\n            if (gamepads[i].timestamp && gamepads[i].timestamp === this._gamePadTimeStamps[i]) {\r\n                continue;\r\n            }\r\n            this._gamePadTimeStamps[i] = gamepads[i].timestamp;\r\n            // Add reference to navigator gamepad\r\n            this.at(i).navigatorGamepad = gamepads[i];\r\n            // Buttons\r\n            let b, bi, a, ai, value;\r\n            for (b in Buttons) {\r\n                bi = Buttons[b];\r\n                if (typeof bi === 'number') {\r\n                    if (gamepads[i].buttons[bi]) {\r\n                        value = gamepads[i].buttons[bi].value;\r\n                        if (value !== this._oldPads[i].getButton(bi)) {\r\n                            if (gamepads[i].buttons[bi].pressed) {\r\n                                this.at(i).updateButton(bi, value);\r\n                                this.at(i).events.emit('button', new GamepadButtonEvent(bi, value, this.at(i)));\r\n                            }\r\n                            else {\r\n                                this.at(i).updateButton(bi, 0);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            // Axes\r\n            for (a in Axes) {\r\n                ai = Axes[a];\r\n                if (typeof ai === 'number') {\r\n                    value = gamepads[i].axes[ai];\r\n                    if (value !== this._oldPads[i].getAxes(ai)) {\r\n                        this.at(i).updateAxes(ai, value);\r\n                        this.at(i).events.emit('axis', new GamepadAxisEvent(ai, value, this.at(i)));\r\n                    }\r\n                }\r\n            }\r\n            this._oldPads[i] = this._clonePad(gamepads[i]);\r\n        }\r\n    }\r\n    /**\r\n     * Safely retrieves a Gamepad at a specific index and creates one if it doesn't yet exist\r\n     */\r\n    at(index) {\r\n        this._enableAndUpdate(); // implicitly enable gamepads when at() is called\r\n        if (index >= this._pads.length) {\r\n            // Ensure there is a pad to retrieve\r\n            for (let i = this._pads.length - 1, max = index; i < max; i++) {\r\n                this._pads.push(new Gamepad());\r\n                this._oldPads.push(new Gamepad());\r\n            }\r\n        }\r\n        return this._pads[index];\r\n    }\r\n    /**\r\n     * Returns a list of all valid gamepads that meet the minimum configuration requirement.\r\n     */\r\n    getValidGamepads() {\r\n        this._enableAndUpdate();\r\n        const result = [];\r\n        for (let i = 0; i < this._pads.length; i++) {\r\n            if (this._isGamepadValid(this.at(i).navigatorGamepad) && this.at(i).connected) {\r\n                result.push(this.at(i));\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Gets the number of connected gamepads\r\n     */\r\n    count() {\r\n        return this._pads.filter((p) => p.connected).length;\r\n    }\r\n    _clonePads(pads) {\r\n        const arr = [];\r\n        for (let i = 0, len = pads.length; i < len; i++) {\r\n            arr.push(this._clonePad(pads[i]));\r\n        }\r\n        return arr;\r\n    }\r\n    /**\r\n     * Fastest way to clone a known object is to do it yourself\r\n     */\r\n    _clonePad(pad) {\r\n        let i, len;\r\n        const clonedPad = new Gamepad();\r\n        if (!pad) {\r\n            return clonedPad;\r\n        }\r\n        for (i = 0, len = pad.buttons.length; i < len; i++) {\r\n            if (pad.buttons[i]) {\r\n                clonedPad.updateButton(i, pad.buttons[i].value);\r\n            }\r\n        }\r\n        for (i = 0, len = pad.axes.length; i < len; i++) {\r\n            clonedPad.updateAxes(i, pad.axes[i]);\r\n        }\r\n        return clonedPad;\r\n    }\r\n}\r\n/**\r\n * The minimum value an axis has to move before considering it a change\r\n */\r\nGamepads.MinAxisMoveThreshold = 0.05;\r\n/**\r\n * Gamepad holds state information for a connected controller. See [[Gamepads]]\r\n * for more information on handling controller input.\r\n */\r\nclass Gamepad {\r\n    constructor() {\r\n        this.events = new EventEmitter();\r\n        this.connected = false;\r\n        this._axes = new Array(4);\r\n        this._buttons = new Array(16);\r\n        this._buttonsUp = new Array(16);\r\n        this._buttonsDown = new Array(16);\r\n        for (let i = 0; i < this._buttons.length; i++) {\r\n            this._buttons[i] = 0;\r\n        }\r\n        for (let i = 0; i < this._axes.length; i++) {\r\n            this._axes[i] = 0;\r\n        }\r\n    }\r\n    update() {\r\n        // Reset buttonsDown and buttonsUp after update is complete\r\n        this._buttonsDown = new Array(16);\r\n        this._buttonsUp = new Array(16);\r\n    }\r\n    /**\r\n     * Whether or not the given button is pressed\r\n     *\r\n     * @deprecated will be removed in v0.28.0. Use isButtonHeld instead\r\n     * @param button     The button to query\r\n     * @param threshold  The threshold over which the button is considered to be pressed\r\n     */\r\n    isButtonPressed(button, threshold = 1) {\r\n        return this._buttons[button] >= threshold;\r\n    }\r\n    /**\r\n     * Tests if a certain button is held down. This is persisted between frames.\r\n     *\r\n     * @param button     The button to query\r\n     * @param threshold  The threshold over which the button is considered to be pressed\r\n     */\r\n    isButtonHeld(button, threshold = 1) {\r\n        return this._buttons[button] >= threshold;\r\n    }\r\n    /**\r\n     * Tests if a certain button was just pressed this frame. This is cleared at the end of the update frame.\r\n     *\r\n     * @param button Test whether a button was just pressed\r\n     * @param threshold  The threshold over which the button is considered to be pressed\r\n     */\r\n    wasButtonPressed(button, threshold = 1) {\r\n        return this._buttonsDown[button] >= threshold;\r\n    }\r\n    /**\r\n     * Tests if a certain button was just released this frame. This is cleared at the end of the update frame.\r\n     *\r\n     * @param button  Test whether a button was just released\r\n     */\r\n    wasButtonReleased(button) {\r\n        return Boolean(this._buttonsUp[button]);\r\n    }\r\n    /**\r\n     * Gets the given button value between 0 and 1\r\n     */\r\n    getButton(button) {\r\n        return this._buttons[button];\r\n    }\r\n    /**\r\n     * Gets the given axis value between -1 and 1. Values below\r\n     * [[MinAxisMoveThreshold]] are considered 0.\r\n     */\r\n    getAxes(axes) {\r\n        const value = this._axes[axes];\r\n        if (Math.abs(value) < Gamepads.MinAxisMoveThreshold) {\r\n            return 0;\r\n        }\r\n        else {\r\n            return value;\r\n        }\r\n    }\r\n    updateButton(buttonIndex, value) {\r\n        // button was just released\r\n        if (value === 0 && this._buttons[buttonIndex]) {\r\n            this._buttonsUp[buttonIndex] = 1;\r\n            // button was just pressed\r\n        }\r\n        else {\r\n            this._buttonsDown[buttonIndex] = value;\r\n        }\r\n        this._buttons[buttonIndex] = value;\r\n    }\r\n    updateAxes(axesIndex, value) {\r\n        this._axes[axesIndex] = value;\r\n    }\r\n    emit(eventName, event) {\r\n        this.events.emit(eventName, event);\r\n    }\r\n    on(eventName, handler) {\r\n        return this.events.on(eventName, handler);\r\n    }\r\n    once(eventName, handler) {\r\n        return this.events.once(eventName, handler);\r\n    }\r\n    off(eventName, handler) {\r\n        this.events.off(eventName, handler);\r\n    }\r\n}\r\n/**\r\n * Gamepad Buttons enumeration\r\n */\r\nvar Buttons;\r\n(function (Buttons) {\r\n    /**\r\n     * Face 1 button (e.g. A)\r\n     */\r\n    Buttons[Buttons[\"Face1\"] = 0] = \"Face1\";\r\n    /**\r\n     * Face 2 button (e.g. B)\r\n     */\r\n    Buttons[Buttons[\"Face2\"] = 1] = \"Face2\";\r\n    /**\r\n     * Face 3 button (e.g. X)\r\n     */\r\n    Buttons[Buttons[\"Face3\"] = 2] = \"Face3\";\r\n    /**\r\n     * Face 4 button (e.g. Y)\r\n     */\r\n    Buttons[Buttons[\"Face4\"] = 3] = \"Face4\";\r\n    /**\r\n     * Left bumper button\r\n     */\r\n    Buttons[Buttons[\"LeftBumper\"] = 4] = \"LeftBumper\";\r\n    /**\r\n     * Right bumper button\r\n     */\r\n    Buttons[Buttons[\"RightBumper\"] = 5] = \"RightBumper\";\r\n    /**\r\n     * Left trigger button\r\n     */\r\n    Buttons[Buttons[\"LeftTrigger\"] = 6] = \"LeftTrigger\";\r\n    /**\r\n     * Right trigger button\r\n     */\r\n    Buttons[Buttons[\"RightTrigger\"] = 7] = \"RightTrigger\";\r\n    /**\r\n     * Select button\r\n     */\r\n    Buttons[Buttons[\"Select\"] = 8] = \"Select\";\r\n    /**\r\n     * Start button\r\n     */\r\n    Buttons[Buttons[\"Start\"] = 9] = \"Start\";\r\n    /**\r\n     * Left analog stick press (e.g. L3)\r\n     */\r\n    Buttons[Buttons[\"LeftStick\"] = 10] = \"LeftStick\";\r\n    /**\r\n     * Right analog stick press (e.g. R3)\r\n     */\r\n    Buttons[Buttons[\"RightStick\"] = 11] = \"RightStick\";\r\n    /**\r\n     * D-pad up\r\n     */\r\n    Buttons[Buttons[\"DpadUp\"] = 12] = \"DpadUp\";\r\n    /**\r\n     * D-pad down\r\n     */\r\n    Buttons[Buttons[\"DpadDown\"] = 13] = \"DpadDown\";\r\n    /**\r\n     * D-pad left\r\n     */\r\n    Buttons[Buttons[\"DpadLeft\"] = 14] = \"DpadLeft\";\r\n    /**\r\n     * D-pad right\r\n     */\r\n    Buttons[Buttons[\"DpadRight\"] = 15] = \"DpadRight\";\r\n})(Buttons || (Buttons = {}));\r\n/**\r\n * Gamepad Axes enumeration\r\n */\r\nvar Axes;\r\n(function (Axes) {\r\n    /**\r\n     * Left analogue stick X direction\r\n     */\r\n    Axes[Axes[\"LeftStickX\"] = 0] = \"LeftStickX\";\r\n    /**\r\n     * Left analogue stick Y direction\r\n     */\r\n    Axes[Axes[\"LeftStickY\"] = 1] = \"LeftStickY\";\r\n    /**\r\n     * Right analogue stick X direction\r\n     */\r\n    Axes[Axes[\"RightStickX\"] = 2] = \"RightStickX\";\r\n    /**\r\n     * Right analogue stick Y direction\r\n     */\r\n    Axes[Axes[\"RightStickY\"] = 3] = \"RightStickY\";\r\n})(Axes || (Axes = {}));\r\n\n;// CONCATENATED MODULE: ./Util/Log.ts\n/* eslint-disable no-console */\r\n/**\r\n * Logging level that Excalibur will tag\r\n */\r\nvar LogLevel;\r\n(function (LogLevel) {\r\n    LogLevel[LogLevel[\"Debug\"] = 0] = \"Debug\";\r\n    LogLevel[LogLevel[\"Info\"] = 1] = \"Info\";\r\n    LogLevel[LogLevel[\"Warn\"] = 2] = \"Warn\";\r\n    LogLevel[LogLevel[\"Error\"] = 3] = \"Error\";\r\n    LogLevel[LogLevel[\"Fatal\"] = 4] = \"Fatal\";\r\n})(LogLevel || (LogLevel = {}));\r\n/**\r\n * Static singleton that represents the logging facility for Excalibur.\r\n * Excalibur comes built-in with a [[ConsoleAppender]] and [[ScreenAppender]].\r\n * Derive from [[Appender]] to create your own logging appenders.\r\n */\r\nclass Logger {\r\n    constructor() {\r\n        this._appenders = [];\r\n        /**\r\n         * Gets or sets the default logging level. Excalibur will only log\r\n         * messages if equal to or above this level. Default: [[LogLevel.Info]]\r\n         */\r\n        this.defaultLevel = LogLevel.Info;\r\n        if (Logger._INSTANCE) {\r\n            throw new Error('Logger is a singleton');\r\n        }\r\n        Logger._INSTANCE = this;\r\n        // Default console appender\r\n        Logger._INSTANCE.addAppender(new ConsoleAppender());\r\n        return Logger._INSTANCE;\r\n    }\r\n    /**\r\n     * Gets the current static instance of Logger\r\n     */\r\n    static getInstance() {\r\n        if (Logger._INSTANCE == null) {\r\n            Logger._INSTANCE = new Logger();\r\n        }\r\n        return Logger._INSTANCE;\r\n    }\r\n    /**\r\n     * Adds a new [[Appender]] to the list of appenders to write to\r\n     */\r\n    addAppender(appender) {\r\n        this._appenders.push(appender);\r\n    }\r\n    /**\r\n     * Clears all appenders from the logger\r\n     */\r\n    clearAppenders() {\r\n        this._appenders.length = 0;\r\n    }\r\n    /**\r\n     * Logs a message at a given LogLevel\r\n     * @param level  The LogLevel`to log the message at\r\n     * @param args   An array of arguments to write to an appender\r\n     */\r\n    _log(level, args) {\r\n        if (level == null) {\r\n            level = this.defaultLevel;\r\n        }\r\n        const len = this._appenders.length;\r\n        for (let i = 0; i < len; i++) {\r\n            if (level >= this.defaultLevel) {\r\n                this._appenders[i].log(level, args);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Writes a log message at the [[LogLevel.Debug]] level\r\n     * @param args  Accepts any number of arguments\r\n     */\r\n    debug(...args) {\r\n        this._log(LogLevel.Debug, args);\r\n    }\r\n    /**\r\n     * Writes a log message at the [[LogLevel.Info]] level\r\n     * @param args  Accepts any number of arguments\r\n     */\r\n    info(...args) {\r\n        this._log(LogLevel.Info, args);\r\n    }\r\n    /**\r\n     * Writes a log message at the [[LogLevel.Warn]] level\r\n     * @param args  Accepts any number of arguments\r\n     */\r\n    warn(...args) {\r\n        this._log(LogLevel.Warn, args);\r\n    }\r\n    /**\r\n     * Writes a log message at the [[LogLevel.Error]] level\r\n     * @param args  Accepts any number of arguments\r\n     */\r\n    error(...args) {\r\n        this._log(LogLevel.Error, args);\r\n    }\r\n    /**\r\n     * Writes a log message at the [[LogLevel.Fatal]] level\r\n     * @param args  Accepts any number of arguments\r\n     */\r\n    fatal(...args) {\r\n        this._log(LogLevel.Fatal, args);\r\n    }\r\n}\r\nLogger._INSTANCE = null;\r\n/**\r\n * Console appender for browsers (i.e. `console.log`)\r\n */\r\nclass ConsoleAppender {\r\n    /**\r\n     * Logs a message at the given [[LogLevel]]\r\n     * @param level  Level to log at\r\n     * @param args   Arguments to log\r\n     */\r\n    log(level, args) {\r\n        // Check for console support\r\n        if (!console && !console.log && console.warn && console.error) {\r\n            // todo maybe do something better than nothing\r\n            return;\r\n        }\r\n        // Create a new console args array\r\n        const consoleArgs = [];\r\n        consoleArgs.unshift.apply(consoleArgs, args);\r\n        consoleArgs.unshift('[' + LogLevel[level] + '] : ');\r\n        if (level < LogLevel.Warn) {\r\n            // Call .log for Debug/Info\r\n            if (console.log.apply) {\r\n                // this is required on some older browsers that don't support apply on console.log :(\r\n                console.log.apply(console, consoleArgs);\r\n            }\r\n            else {\r\n                console.log(consoleArgs.join(' '));\r\n            }\r\n        }\r\n        else if (level < LogLevel.Error) {\r\n            // Call .warn for Warn\r\n            if (console.warn.apply) {\r\n                console.warn.apply(console, consoleArgs);\r\n            }\r\n            else {\r\n                console.warn(consoleArgs.join(' '));\r\n            }\r\n        }\r\n        else {\r\n            // Call .error for Error/Fatal\r\n            if (console.error.apply) {\r\n                console.error.apply(console, consoleArgs);\r\n            }\r\n            else {\r\n                console.error(consoleArgs.join(' '));\r\n            }\r\n        }\r\n    }\r\n}\r\n/**\r\n * On-screen (canvas) appender\r\n */\r\nclass ScreenAppender {\r\n    /**\r\n     * @param width   Width of the screen appender in pixels\r\n     * @param height  Height of the screen appender in pixels\r\n     */\r\n    constructor(width, height) {\r\n        // @todo Clean this up\r\n        this._messages = [];\r\n        this._canvas = document.createElement('canvas');\r\n        this._canvas.width = width || window.innerWidth;\r\n        this._canvas.height = height || window.innerHeight;\r\n        this._canvas.style.position = 'absolute';\r\n        // eslint-disable-next-line\r\n        this._ctx = this._canvas.getContext('2d'); // eslint-disable-line\r\n        document.body.appendChild(this._canvas);\r\n    }\r\n    /**\r\n     * Logs a message at the given [[LogLevel]]\r\n     * @param level  Level to log at\r\n     * @param args   Arguments to log\r\n     */\r\n    log(level, args) {\r\n        const message = args.join(',');\r\n        this._ctx.clearRect(0, 0, this._canvas.width, this._canvas.height);\r\n        this._messages.unshift('[' + LogLevel[level] + '] : ' + message);\r\n        let pos = 10;\r\n        let opacity = 1.0;\r\n        for (let i = 0; i < this._messages.length; i++) {\r\n            this._ctx.fillStyle = 'rgba(255,255,255,' + opacity.toFixed(2) + ')';\r\n            this._ctx.fillText(this._messages[i], 200, pos);\r\n            pos += 10;\r\n            opacity = opacity > 0 ? opacity - 0.05 : 0;\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/IFrame.ts\n/**\r\n * Checks if excalibur is in a x-origin iframe\r\n */\r\nfunction isCrossOriginIframe() {\r\n    try {\r\n        // Try and listen to events on top window frame if within an iframe.\r\n        //\r\n        // See https://github.com/excaliburjs/Excalibur/issues/1294\r\n        //\r\n        // Attempt to add an event listener, which triggers a DOMException on\r\n        // cross-origin iframes\r\n        const noop = () => {\r\n            return;\r\n        };\r\n        window.top.addEventListener('blur', noop);\r\n        window.top.removeEventListener('blur', noop);\r\n    }\r\n    catch (_a) {\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n\n;// CONCATENATED MODULE: ./Input/Keyboard.ts\n\r\n\r\n\r\n\r\n/**\r\n * Enum representing physical input key codes\r\n */\r\nvar Keys;\r\n(function (Keys) {\r\n    // NUMPAD\r\n    Keys[\"Num0\"] = \"Numpad0\";\r\n    Keys[\"Num1\"] = \"Numpad1\";\r\n    Keys[\"Num2\"] = \"Numpad2\";\r\n    Keys[\"Num3\"] = \"Numpad3\";\r\n    Keys[\"Num4\"] = \"Numpad4\";\r\n    Keys[\"Num5\"] = \"Numpad5\";\r\n    Keys[\"Num6\"] = \"Numpad6\";\r\n    Keys[\"Num7\"] = \"Numpad7\";\r\n    Keys[\"Num8\"] = \"Numpad8\";\r\n    Keys[\"Num9\"] = \"Numpad9\";\r\n    Keys[\"NumAdd\"] = \"NumpadAdd\";\r\n    Keys[\"NumSubtract\"] = \"NumpadSubtract\";\r\n    Keys[\"NumMultiply\"] = \"NumpadMultiply\";\r\n    Keys[\"NumDivide\"] = \"NumpadDivide\";\r\n    // NumComma = 'NumpadComma', // not x-browser\r\n    Keys[\"NumDecimal\"] = \"NumpadDecimal\";\r\n    Keys[\"Numpad0\"] = \"Numpad0\";\r\n    Keys[\"Numpad1\"] = \"Numpad1\";\r\n    Keys[\"Numpad2\"] = \"Numpad2\";\r\n    Keys[\"Numpad3\"] = \"Numpad3\";\r\n    Keys[\"Numpad4\"] = \"Numpad4\";\r\n    Keys[\"Numpad5\"] = \"Numpad5\";\r\n    Keys[\"Numpad6\"] = \"Numpad6\";\r\n    Keys[\"Numpad7\"] = \"Numpad7\";\r\n    Keys[\"Numpad8\"] = \"Numpad8\";\r\n    Keys[\"Numpad9\"] = \"Numpad9\";\r\n    Keys[\"NumpadAdd\"] = \"NumpadAdd\";\r\n    Keys[\"NumpadSubtract\"] = \"NumpadSubtract\";\r\n    Keys[\"NumpadMultiply\"] = \"NumpadMultiply\";\r\n    Keys[\"NumpadDivide\"] = \"NumpadDivide\";\r\n    // NumpadComma = 'NumpadComma', // not x-browser\r\n    Keys[\"NumpadDecimal\"] = \"NumpadDecimal\";\r\n    // MODIFIERS\r\n    Keys[\"NumLock\"] = \"NumLock\";\r\n    Keys[\"ShiftLeft\"] = \"ShiftLeft\";\r\n    Keys[\"ShiftRight\"] = \"ShiftRight\";\r\n    Keys[\"AltLeft\"] = \"AltLeft\";\r\n    Keys[\"AltRight\"] = \"AltRight\";\r\n    Keys[\"ControlLeft\"] = \"ControlLeft\";\r\n    Keys[\"ControlRight\"] = \"ControlRight\";\r\n    Keys[\"MetaLeft\"] = \"MetaLeft\";\r\n    Keys[\"MetaRight\"] = \"MetaRight\";\r\n    // NUMBERS\r\n    Keys[\"Key0\"] = \"Digit0\";\r\n    Keys[\"Key1\"] = \"Digit1\";\r\n    Keys[\"Key2\"] = \"Digit2\";\r\n    Keys[\"Key3\"] = \"Digit3\";\r\n    Keys[\"Key4\"] = \"Digit4\";\r\n    Keys[\"Key5\"] = \"Digit5\";\r\n    Keys[\"Key6\"] = \"Digit6\";\r\n    Keys[\"Key7\"] = \"Digit7\";\r\n    Keys[\"Key8\"] = \"Digit8\";\r\n    Keys[\"Key9\"] = \"Digit9\";\r\n    Keys[\"Digit0\"] = \"Digit0\";\r\n    Keys[\"Digit1\"] = \"Digit1\";\r\n    Keys[\"Digit2\"] = \"Digit2\";\r\n    Keys[\"Digit3\"] = \"Digit3\";\r\n    Keys[\"Digit4\"] = \"Digit4\";\r\n    Keys[\"Digit5\"] = \"Digit5\";\r\n    Keys[\"Digit6\"] = \"Digit6\";\r\n    Keys[\"Digit7\"] = \"Digit7\";\r\n    Keys[\"Digit8\"] = \"Digit8\";\r\n    Keys[\"Digit9\"] = \"Digit9\";\r\n    // FUNCTION KEYS\r\n    Keys[\"F1\"] = \"F1\";\r\n    Keys[\"F2\"] = \"F2\";\r\n    Keys[\"F3\"] = \"F3\";\r\n    Keys[\"F4\"] = \"F4\";\r\n    Keys[\"F5\"] = \"F5\";\r\n    Keys[\"F6\"] = \"F6\";\r\n    Keys[\"F7\"] = \"F7\";\r\n    Keys[\"F8\"] = \"F8\";\r\n    Keys[\"F9\"] = \"F9\";\r\n    Keys[\"F10\"] = \"F10\";\r\n    Keys[\"F11\"] = \"F11\";\r\n    Keys[\"F12\"] = \"F12\";\r\n    // LETTERS\r\n    Keys[\"A\"] = \"KeyA\";\r\n    Keys[\"B\"] = \"KeyB\";\r\n    Keys[\"C\"] = \"KeyC\";\r\n    Keys[\"D\"] = \"KeyD\";\r\n    Keys[\"E\"] = \"KeyE\";\r\n    Keys[\"F\"] = \"KeyF\";\r\n    Keys[\"G\"] = \"KeyG\";\r\n    Keys[\"H\"] = \"KeyH\";\r\n    Keys[\"I\"] = \"KeyI\";\r\n    Keys[\"J\"] = \"KeyJ\";\r\n    Keys[\"K\"] = \"KeyK\";\r\n    Keys[\"L\"] = \"KeyL\";\r\n    Keys[\"M\"] = \"KeyM\";\r\n    Keys[\"N\"] = \"KeyN\";\r\n    Keys[\"O\"] = \"KeyO\";\r\n    Keys[\"P\"] = \"KeyP\";\r\n    Keys[\"Q\"] = \"KeyQ\";\r\n    Keys[\"R\"] = \"KeyR\";\r\n    Keys[\"S\"] = \"KeyS\";\r\n    Keys[\"T\"] = \"KeyT\";\r\n    Keys[\"U\"] = \"KeyU\";\r\n    Keys[\"V\"] = \"KeyV\";\r\n    Keys[\"W\"] = \"KeyW\";\r\n    Keys[\"X\"] = \"KeyX\";\r\n    Keys[\"Y\"] = \"KeyY\";\r\n    Keys[\"Z\"] = \"KeyZ\";\r\n    Keys[\"KeyA\"] = \"KeyA\";\r\n    Keys[\"KeyB\"] = \"KeyB\";\r\n    Keys[\"KeyC\"] = \"KeyC\";\r\n    Keys[\"KeyD\"] = \"KeyD\";\r\n    Keys[\"KeyE\"] = \"KeyE\";\r\n    Keys[\"KeyF\"] = \"KeyF\";\r\n    Keys[\"KeyG\"] = \"KeyG\";\r\n    Keys[\"KeyH\"] = \"KeyH\";\r\n    Keys[\"KeyI\"] = \"KeyI\";\r\n    Keys[\"KeyJ\"] = \"KeyJ\";\r\n    Keys[\"KeyK\"] = \"KeyK\";\r\n    Keys[\"KeyL\"] = \"KeyL\";\r\n    Keys[\"KeyM\"] = \"KeyM\";\r\n    Keys[\"KeyN\"] = \"KeyN\";\r\n    Keys[\"KeyO\"] = \"KeyO\";\r\n    Keys[\"KeyP\"] = \"KeyP\";\r\n    Keys[\"KeyQ\"] = \"KeyQ\";\r\n    Keys[\"KeyR\"] = \"KeyR\";\r\n    Keys[\"KeyS\"] = \"KeyS\";\r\n    Keys[\"KeyT\"] = \"KeyT\";\r\n    Keys[\"KeyU\"] = \"KeyU\";\r\n    Keys[\"KeyV\"] = \"KeyV\";\r\n    Keys[\"KeyW\"] = \"KeyW\";\r\n    Keys[\"KeyX\"] = \"KeyX\";\r\n    Keys[\"KeyY\"] = \"KeyY\";\r\n    Keys[\"KeyZ\"] = \"KeyZ\";\r\n    // SYMBOLS\r\n    Keys[\"Semicolon\"] = \"Semicolon\";\r\n    Keys[\"Quote\"] = \"Quote\";\r\n    Keys[\"Comma\"] = \"Comma\";\r\n    Keys[\"Minus\"] = \"Minus\";\r\n    Keys[\"Period\"] = \"Period\";\r\n    Keys[\"Slash\"] = \"Slash\";\r\n    Keys[\"Equal\"] = \"Equal\";\r\n    Keys[\"BracketLeft\"] = \"BracketLeft\";\r\n    Keys[\"Backslash\"] = \"Backslash\";\r\n    Keys[\"BracketRight\"] = \"BracketRight\";\r\n    Keys[\"Backquote\"] = \"Backquote\";\r\n    // DIRECTIONS\r\n    Keys[\"Up\"] = \"ArrowUp\";\r\n    Keys[\"Down\"] = \"ArrowDown\";\r\n    Keys[\"Left\"] = \"ArrowLeft\";\r\n    Keys[\"Right\"] = \"ArrowRight\";\r\n    Keys[\"ArrowUp\"] = \"ArrowUp\";\r\n    Keys[\"ArrowDown\"] = \"ArrowDown\";\r\n    Keys[\"ArrowLeft\"] = \"ArrowLeft\";\r\n    Keys[\"ArrowRight\"] = \"ArrowRight\";\r\n    // OTHER\r\n    Keys[\"Space\"] = \"Space\";\r\n    Keys[\"Backspace\"] = \"Backspace\";\r\n    Keys[\"Delete\"] = \"Delete\";\r\n    Keys[\"Esc\"] = \"Escape\";\r\n    Keys[\"Escape\"] = \"Escape\";\r\n    Keys[\"Enter\"] = \"Enter\";\r\n    Keys[\"NumpadEnter\"] = \"NumpadEnter\";\r\n    Keys[\"ContextMenu\"] = \"ContextMenu\";\r\n})(Keys || (Keys = {}));\r\n/**\r\n * Event thrown on a game object for a key event\r\n */\r\nclass KeyEvent extends GameEvent {\r\n    /**\r\n     * @param key  The key responsible for throwing the event\r\n     * @param value The key's typed value the browser detected\r\n     * @param originalEvent The original keyboard event that Excalibur handled\r\n     */\r\n    constructor(key, value, originalEvent) {\r\n        super();\r\n        this.key = key;\r\n        this.value = value;\r\n        this.originalEvent = originalEvent;\r\n    }\r\n}\r\nconst KeyEvents = {\r\n    Press: 'press',\r\n    Hold: 'hold',\r\n    Release: 'release'\r\n};\r\n/**\r\n * Provides keyboard support for Excalibur.\r\n */\r\nclass Keyboard {\r\n    constructor() {\r\n        this.events = new EventEmitter();\r\n        /**\r\n         * Keys that are currently held down\r\n         */\r\n        this._keys = [];\r\n        /**\r\n         * Keys up in the current frame\r\n         */\r\n        this._keysUp = [];\r\n        /**\r\n         * Keys down in the current frame\r\n         */\r\n        this._keysDown = [];\r\n        this._releaseAllKeys = (ev) => {\r\n            for (const code of this._keys) {\r\n                const keyEvent = new KeyEvent(code, ev.key, ev);\r\n                this.events.emit('up', keyEvent);\r\n                this.events.emit('release', keyEvent);\r\n            }\r\n            this._keysUp = Array.from((new Set(this._keys.concat(this._keysUp))));\r\n            this._keys.length = 0;\r\n        };\r\n        this._handleKeyDown = (ev) => {\r\n            // handle macos meta key issue\r\n            // https://github.com/excaliburjs/Excalibur/issues/2608\r\n            if (!ev.metaKey && (this._keys.includes(Keys.MetaLeft) || this._keys.includes(Keys.MetaRight))) {\r\n                this._releaseAllKeys(ev);\r\n            }\r\n            const code = ev.code;\r\n            if (this._keys.indexOf(code) === -1) {\r\n                this._keys.push(code);\r\n                this._keysDown.push(code);\r\n                const keyEvent = new KeyEvent(code, ev.key, ev);\r\n                this.events.emit('down', keyEvent);\r\n                this.events.emit('press', keyEvent);\r\n            }\r\n        };\r\n        this._handleKeyUp = (ev) => {\r\n            const code = ev.code;\r\n            const key = this._keys.indexOf(code);\r\n            this._keys.splice(key, 1);\r\n            this._keysUp.push(code);\r\n            const keyEvent = new KeyEvent(code, ev.key, ev);\r\n            // alias the old api, we may want to deprecate this in the future\r\n            this.events.emit('up', keyEvent);\r\n            this.events.emit('release', keyEvent);\r\n            // handle macos meta key issue\r\n            // https://github.com/excaliburjs/Excalibur/issues/2608\r\n            if (ev.key === 'Meta') {\r\n                this._releaseAllKeys(ev);\r\n            }\r\n        };\r\n    }\r\n    emit(eventName, event) {\r\n        this.events.emit(eventName, event);\r\n    }\r\n    on(eventName, handler) {\r\n        return this.events.on(eventName, handler);\r\n    }\r\n    once(eventName, handler) {\r\n        return this.events.once(eventName, handler);\r\n    }\r\n    off(eventName, handler) {\r\n        this.events.off(eventName, handler);\r\n    }\r\n    /**\r\n     * Initialize Keyboard event listeners\r\n     */\r\n    init(keyboardOptions) {\r\n        let { global } = keyboardOptions;\r\n        const { grabWindowFocus } = keyboardOptions;\r\n        if (!global) {\r\n            if (isCrossOriginIframe()) {\r\n                global = window;\r\n                // Workaround for iframes like for itch.io or codesandbox\r\n                // https://www.reddit.com/r/gamemaker/comments/kfs5cs/keyboard_inputs_no_longer_working_in_html5_game/\r\n                // https://forum.gamemaker.io/index.php?threads/solved-keyboard-issue-on-itch-io.87336/\r\n                if (grabWindowFocus) {\r\n                    window.focus();\r\n                }\r\n                Logger.getInstance().warn('Excalibur might be in a cross-origin iframe, in order to receive keyboard events it must be in focus');\r\n            }\r\n            else {\r\n                global = window.top;\r\n            }\r\n        }\r\n        global.addEventListener('blur', () => {\r\n            this._keys.length = 0; // empties array efficiently\r\n        });\r\n        // key up is on window because canvas cannot have focus\r\n        global.addEventListener('keyup', this._handleKeyUp);\r\n        // key down is on window because canvas cannot have focus\r\n        global.addEventListener('keydown', this._handleKeyDown);\r\n    }\r\n    update() {\r\n        // Reset keysDown and keysUp after update is complete\r\n        this._keysDown.length = 0;\r\n        this._keysUp.length = 0;\r\n        // Emit synthetic \"hold\" event\r\n        for (let i = 0; i < this._keys.length; i++) {\r\n            this.events.emit('hold', new KeyEvent(this._keys[i]));\r\n        }\r\n    }\r\n    /**\r\n     * Gets list of keys being pressed down\r\n     */\r\n    getKeys() {\r\n        return this._keys;\r\n    }\r\n    /**\r\n     * Tests if a certain key was just pressed this frame. This is cleared at the end of the update frame.\r\n     * @param key Test whether a key was just pressed\r\n     */\r\n    wasPressed(key) {\r\n        return this._keysDown.indexOf(key) > -1;\r\n    }\r\n    /**\r\n     * Tests if a certain key is held down. This is persisted between frames.\r\n     * @param key  Test whether a key is held down\r\n     */\r\n    isHeld(key) {\r\n        return this._keys.indexOf(key) > -1;\r\n    }\r\n    /**\r\n     * Tests if a certain key was just released this frame. This is cleared at the end of the update frame.\r\n     * @param key  Test whether a key was just released\r\n     */\r\n    wasReleased(key) {\r\n        return this._keysUp.indexOf(key) > -1;\r\n    }\r\n    /**\r\n     * Trigger a manual key event\r\n     * @param type\r\n     * @param key\r\n     * @param character\r\n     */\r\n    triggerEvent(type, key, character) {\r\n        if (type === 'down') {\r\n            this._handleKeyDown(new KeyboardEvent('keydown', {\r\n                code: key,\r\n                key: character !== null && character !== void 0 ? character : null\r\n            }));\r\n        }\r\n        if (type === 'up') {\r\n            this._handleKeyUp(new KeyboardEvent('keyup', {\r\n                code: key,\r\n                key: character !== null && character !== void 0 ? character : null\r\n            }));\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Input/PointerScope.ts\n/**\r\n * Determines the scope of handling mouse/touch events.\r\n */\r\nvar PointerScope;\r\n(function (PointerScope) {\r\n    /**\r\n     * Handle events on the `canvas` element only. Events originating outside the\r\n     * `canvas` will not be handled.\r\n     */\r\n    PointerScope[\"Canvas\"] = \"Canvas\";\r\n    /**\r\n     * Handles events on the entire document. All events will be handled by Excalibur.\r\n     */\r\n    PointerScope[\"Document\"] = \"Document\";\r\n})(PointerScope || (PointerScope = {}));\r\n\n;// CONCATENATED MODULE: ./Math/Random.ts\n/**\r\n * @module\r\n * Pseudo-Random Utility\r\n *\r\n * A pseudo-random utility to add seeded random support for help in\r\n * generating things like terrain or reproducible randomness. Uses the\r\n * [Mersenne Twister](https://en.wikipedia.org/wiki/Mersenne_Twister) algorithm.\r\n */\r\n/**\r\n * 32-bit mask\r\n */\r\nconst BITMASK32 = 0xffffffff;\r\n/**\r\n * Pseudo-random number generator following the Mersenne_Twister algorithm. Given a seed this generator will produce the same sequence\r\n * of numbers each time it is called.\r\n * See https://en.wikipedia.org/wiki/Mersenne_Twister for more details.\r\n * Uses the MT19937-32 (2002) implementation documented here http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/MT2002/emt19937ar.html\r\n *\r\n * Api inspired by http://chancejs.com/# https://github.com/chancejs/chancejs\r\n */\r\nclass Random {\r\n    /**\r\n     * If no seed is specified, the Date.now() is used\r\n     */\r\n    constructor(seed) {\r\n        this.seed = seed;\r\n        // Separation point of one one word, the number of bits in the lower bitmask 0 <= r <= w-1\r\n        this._lowerMask = 0x7fffffff; // 31 bits same as _r\r\n        this._upperMask = 0x80000000; // 34 high bits\r\n        // Word size, 64 bits\r\n        this._w = 32;\r\n        // Degree of recurrence\r\n        this._n = 624;\r\n        // Middle word, an offset used in the recurrence defining the series x, 1<=m<n\r\n        this._m = 397;\r\n        // coefficients of teh rational normal form twist matrix\r\n        this._a = 0x9908b0df;\r\n        // tempering bit shifts and masks\r\n        this._u = 11;\r\n        this._s = 7;\r\n        this._b = 0x9d2c5680;\r\n        this._t = 15;\r\n        this._c = 0xefc60000;\r\n        this._l = 18;\r\n        this._f = 1812433253;\r\n        this._mt = new Array(this._n);\r\n        // need to mask to support higher bit machines\r\n        this._mt[0] = (seed || Date.now()) >>> 0;\r\n        for (let i = 1; i < this._n; i++) {\r\n            const s = this._mt[i - 1] ^ (this._mt[i - 1] >>> (this._w - 2));\r\n            // numbers are bigger than the JS max safe int, add in 16-bit chunks to prevent IEEE rounding errors on high bits\r\n            this._mt[i] = (((this._f * ((s & 0xffff0000) >>> 16)) << 16) + this._f * (s & 0xffff) + i) >>> 0;\r\n        }\r\n        this._index = this._n;\r\n    }\r\n    /**\r\n     * Apply the twist\r\n     */\r\n    _twist() {\r\n        const mag01 = [0x0, this._a];\r\n        let y = 0, i = 0;\r\n        for (; i < this._n - this._m; i++) {\r\n            y = (this._mt[i] & this._upperMask) | (this._mt[i + 1] & this._lowerMask);\r\n            this._mt[i] = this._mt[i + this._m] ^ (y >>> 1) ^ (mag01[y & 0x1] & BITMASK32);\r\n        }\r\n        for (; i < this._n - 1; i++) {\r\n            y = (this._mt[i] & this._upperMask) | (this._mt[i + 1] & this._lowerMask);\r\n            this._mt[i] = this._mt[i + (this._m - this._n)] ^ (y >>> 1) ^ (mag01[y & 0x1] & BITMASK32);\r\n        }\r\n        y = (this._mt[this._n - 1] & this._upperMask) | (this._mt[0] & this._lowerMask);\r\n        this._mt[this._n - 1] = this._mt[this._m - 1] ^ (y >>> 1) ^ (mag01[y & 0x1] & BITMASK32);\r\n        this._index = 0;\r\n    }\r\n    /**\r\n     * Return next 32 bit integer number in sequence\r\n     */\r\n    nextInt() {\r\n        if (this._index >= this._n) {\r\n            this._twist();\r\n        }\r\n        let y = this._mt[this._index++];\r\n        y ^= y >>> this._u;\r\n        y ^= (y << this._s) & this._b;\r\n        y ^= (y << this._t) & this._c;\r\n        y ^= y >>> this._l;\r\n        return y >>> 0;\r\n    }\r\n    /**\r\n     * Return a random floating point number between [0, 1)\r\n     */\r\n    next() {\r\n        return this.nextInt() * (1.0 / 4294967296.0); // divided by 2^32\r\n    }\r\n    /**\r\n     * Return a random floating point in range [min, max) min is included, max is not included\r\n     */\r\n    floating(min, max) {\r\n        return (max - min) * this.next() + min;\r\n    }\r\n    /**\r\n     * Return a random integer in range [min, max] min is included, max is included.\r\n     * Implemented with rejection sampling, see https://medium.com/@betable/tifu-by-using-math-random-f1c308c4fd9d#.i13tdiu5a\r\n     */\r\n    integer(min, max) {\r\n        return Math.floor((max - min + 1) * this.next() + min);\r\n    }\r\n    /**\r\n     * Returns true or false randomly with 50/50 odds by default.\r\n     * By default the likelihood of returning a true is .5 (50%).\r\n     * @param likelihood takes values between [0, 1]\r\n     */\r\n    bool(likelihood = 0.5) {\r\n        return this.next() <= likelihood;\r\n    }\r\n    /**\r\n     * Returns one element from an array at random\r\n     */\r\n    pickOne(array) {\r\n        return array[this.integer(0, array.length - 1)];\r\n    }\r\n    /**\r\n     * Returns a new array random picking elements from the original\r\n     * @param array Original array to pick from\r\n     * @param numPicks can be any positive number\r\n     * @param allowDuplicates indicates whether the returned set is allowed duplicates (it does not mean there will always be duplicates\r\n     * just that it is possible)\r\n     */\r\n    pickSet(array, numPicks, allowDuplicates = false) {\r\n        if (allowDuplicates) {\r\n            return this._pickSetWithDuplicates(array, numPicks);\r\n        }\r\n        else {\r\n            return this._pickSetWithoutDuplicates(array, numPicks);\r\n        }\r\n    }\r\n    /**\r\n     * Returns a new array randomly picking elements in the original (not reused)\r\n     * @param array Array to pick elements out of\r\n     * @param numPicks must be less than or equal to the number of elements in the array.\r\n     */\r\n    _pickSetWithoutDuplicates(array, numPicks) {\r\n        if (numPicks > array.length || numPicks < 0) {\r\n            throw new Error('Invalid number of elements to pick, must pick a value 0 < n <= length');\r\n        }\r\n        if (numPicks === array.length) {\r\n            return array;\r\n        }\r\n        const result = new Array(numPicks);\r\n        let currentPick = 0;\r\n        const tempArray = array.slice(0);\r\n        while (currentPick < numPicks) {\r\n            const index = this.integer(0, tempArray.length - 1);\r\n            result[currentPick++] = tempArray[index];\r\n            tempArray.splice(index, 1);\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Returns a new array random picking elements from the original allowing duplicates\r\n     * @param array Array to pick elements out of\r\n     * @param numPicks can be any positive number\r\n     */\r\n    _pickSetWithDuplicates(array, numPicks) {\r\n        // Typescript numbers are all floating point, so do we add check for int? (or floor the input?)\r\n        if (numPicks < 0) {\r\n            throw new Error('Invalid number of elements to pick, must pick a value 0 <= n < MAX_INT');\r\n        }\r\n        const result = new Array(numPicks);\r\n        for (let i = 0; i < numPicks; i++) {\r\n            result[i] = this.pickOne(array);\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Returns a new array that has its elements shuffled. Using the Fisher/Yates method\r\n     * https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle\r\n     */\r\n    shuffle(array) {\r\n        const tempArray = array.slice(0);\r\n        let swap = null;\r\n        for (let i = 0; i < tempArray.length - 2; i++) {\r\n            const randomIndex = this.integer(i, tempArray.length - 1);\r\n            swap = tempArray[i];\r\n            tempArray[i] = tempArray[randomIndex];\r\n            tempArray[randomIndex] = swap;\r\n        }\r\n        return tempArray;\r\n    }\r\n    /**\r\n     * Generate a list of random integer numbers\r\n     * @param length the length of the final array\r\n     * @param min the minimum integer number to generate inclusive\r\n     * @param max the maximum integer number to generate inclusive\r\n     */\r\n    range(length, min, max) {\r\n        const result = new Array(length);\r\n        for (let i = 0; i < length; i++) {\r\n            result[i] = this.integer(min, max);\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Returns the result of a d4 dice roll\r\n     */\r\n    d4() {\r\n        return this.integer(1, 4);\r\n    }\r\n    /**\r\n     * Returns the result of a d6 dice roll\r\n     */\r\n    d6() {\r\n        return this.integer(1, 6);\r\n    }\r\n    /**\r\n     * Returns the result of a d8 dice roll\r\n     */\r\n    d8() {\r\n        return this.integer(1, 8);\r\n    }\r\n    /**\r\n     * Returns the result of a d10 dice roll\r\n     */\r\n    d10() {\r\n        return this.integer(1, 10);\r\n    }\r\n    /**\r\n     * Returns the result of a d12 dice roll\r\n     */\r\n    d12() {\r\n        return this.integer(1, 12);\r\n    }\r\n    /**\r\n     * Returns the result of a d20 dice roll\r\n     */\r\n    d20() {\r\n        return this.integer(1, 20);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/util.ts\n\r\n/**\r\n * Two PI constant\r\n */\r\nconst TwoPI = Math.PI * 2;\r\n/**\r\n * Returns the fractional part of a number\r\n * @param x\r\n */\r\nfunction frac(x) {\r\n    if (x >= 0) {\r\n        return x - Math.floor(x);\r\n    }\r\n    else {\r\n        return x - Math.ceil(x);\r\n    }\r\n}\r\n/**\r\n * Returns the sign of a number, if 0 returns 0\r\n */\r\nfunction sign(val) {\r\n    if (val === 0) {\r\n        return 0;\r\n    }\r\n    return val < 0 ? -1 : 1;\r\n}\r\n;\r\n/**\r\n * Clamps a value between a min and max inclusive\r\n */\r\nfunction clamp(val, min, max) {\r\n    return Math.min(Math.max(min, val), max);\r\n}\r\n/**\r\n * Convert an angle to be the equivalent in the range [0, 2PI]\r\n */\r\nfunction canonicalizeAngle(angle) {\r\n    let tmpAngle = angle;\r\n    if (angle > TwoPI) {\r\n        while (tmpAngle > TwoPI) {\r\n            tmpAngle -= TwoPI;\r\n        }\r\n    }\r\n    if (angle < 0) {\r\n        while (tmpAngle < 0) {\r\n            tmpAngle += TwoPI;\r\n        }\r\n    }\r\n    return tmpAngle;\r\n}\r\n/**\r\n * Convert radians to degrees\r\n */\r\nfunction toDegrees(radians) {\r\n    return (180 / Math.PI) * radians;\r\n}\r\n/**\r\n * Convert degrees to radians\r\n */\r\nfunction toRadians(degrees) {\r\n    return (degrees / 180) * Math.PI;\r\n}\r\n/**\r\n * Generate a range of numbers\r\n * For example: range(0, 5) -> [0, 1, 2, 3, 4, 5]\r\n * @param from inclusive\r\n * @param to inclusive\r\n */\r\nconst range = (from, to) => Array.from(new Array(to - from + 1), (_x, i) => i + from);\r\n/**\r\n * Find a random floating point number in range\r\n */\r\nfunction randomInRange(min, max, random = new Random()) {\r\n    return random ? random.floating(min, max) : min + Math.random() * (max - min);\r\n}\r\n/**\r\n * Find a random integer in a range\r\n */\r\nfunction randomIntInRange(min, max, random = new Random()) {\r\n    return random ? random.integer(min, max) : Math.round(randomInRange(min, max));\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/vector.ts\n\r\n/**\r\n * A 2D vector on a plane.\r\n */\r\nclass Vector {\r\n    /**\r\n     * A (0, 0) vector\r\n     */\r\n    static get Zero() {\r\n        return new Vector(0, 0);\r\n    }\r\n    /**\r\n     * A (1, 1) vector\r\n     */\r\n    static get One() {\r\n        return new Vector(1, 1);\r\n    }\r\n    /**\r\n     * A (0.5, 0.5) vector\r\n     */\r\n    static get Half() {\r\n        return new Vector(0.5, 0.5);\r\n    }\r\n    /**\r\n     * A unit vector pointing up (0, -1)\r\n     */\r\n    static get Up() {\r\n        return new Vector(0, -1);\r\n    }\r\n    /**\r\n     * A unit vector pointing down (0, 1)\r\n     */\r\n    static get Down() {\r\n        return new Vector(0, 1);\r\n    }\r\n    /**\r\n     * A unit vector pointing left (-1, 0)\r\n     */\r\n    static get Left() {\r\n        return new Vector(-1, 0);\r\n    }\r\n    /**\r\n     * A unit vector pointing right (1, 0)\r\n     */\r\n    static get Right() {\r\n        return new Vector(1, 0);\r\n    }\r\n    /**\r\n     * Returns a vector of unit length in the direction of the specified angle in Radians.\r\n     * @param angle The angle to generate the vector\r\n     */\r\n    static fromAngle(angle) {\r\n        return new Vector(Math.cos(angle), Math.sin(angle));\r\n    }\r\n    /**\r\n     * Checks if vector is not null, undefined, or if any of its components are NaN or Infinity.\r\n     */\r\n    static isValid(vec) {\r\n        if (vec === null || vec === undefined) {\r\n            return false;\r\n        }\r\n        if (isNaN(vec.x) || isNaN(vec.y)) {\r\n            return false;\r\n        }\r\n        if (vec.x === Infinity || vec.y === Infinity || vec.x === -Infinity || vec.y === -Infinity) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    /**\r\n     * Calculates distance between two Vectors\r\n     * @param vec1\r\n     * @param vec2\r\n     */\r\n    static distance(vec1, vec2) {\r\n        return Math.sqrt(Math.pow(vec1.x - vec2.x, 2) + Math.pow(vec1.y - vec2.y, 2));\r\n    }\r\n    static min(vec1, vec2) {\r\n        return new Vector(Math.min(vec1.x, vec2.x), Math.min(vec1.y, vec2.y));\r\n    }\r\n    static max(vec1, vec2) {\r\n        return new Vector(Math.max(vec1.x, vec2.x), Math.max(vec1.y, vec2.y));\r\n    }\r\n    /**\r\n     * @param x  X component of the Vector\r\n     * @param y  Y component of the Vector\r\n     */\r\n    constructor(x, y) {\r\n        this._x = 0;\r\n        this._y = 0;\r\n        this._x = x;\r\n        this._y = y;\r\n    }\r\n    /**\r\n     * Get the x component of the vector\r\n     */\r\n    get x() {\r\n        return this._x;\r\n    }\r\n    /**\r\n     * Set the x component, THIS MUTATES the current vector. It is usually better to create a new vector.\r\n     * @warning **Be very careful setting components on shared vectors, mutating shared vectors can cause hard to find bugs**\r\n     */\r\n    set x(val) {\r\n        this._x = val;\r\n    }\r\n    /**\r\n     * Get the y component of the vector\r\n     */\r\n    get y() {\r\n        return this._y;\r\n    }\r\n    /**\r\n     * Set the y component, THIS MUTATES the current vector. It is usually better to create a new vector.\r\n     * @warning **Be very careful setting components on shared vectors, mutating shared vectors can cause hard to find bugs**\r\n     */\r\n    set y(val) {\r\n        this._y = val;\r\n    }\r\n    /**\r\n     * Sets the x and y components at once, THIS MUTATES the current vector. It is usually better to create a new vector.\r\n     *\r\n     * @warning **Be very careful using this, mutating vectors can cause hard to find bugs**\r\n     */\r\n    setTo(x, y) {\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n    /**\r\n     * Compares this point against another and tests for equality\r\n     * @param vector The other point to compare to\r\n     * @param tolerance Amount of euclidean distance off we are willing to tolerate\r\n     */\r\n    equals(vector, tolerance = 0.001) {\r\n        return Math.abs(this.x - vector.x) <= tolerance && Math.abs(this.y - vector.y) <= tolerance;\r\n    }\r\n    /**\r\n     * The distance to another vector. If no other Vector is specified, this will return the [[magnitude]].\r\n     * @param v  The other vector. Leave blank to use origin vector.\r\n     */\r\n    distance(v) {\r\n        if (!v) {\r\n            return Math.sqrt(this.x * this.x + this.y * this.y);\r\n        }\r\n        const deltaX = this.x - v.x;\r\n        const deltaY = this.y - v.y;\r\n        return Math.sqrt(deltaX * deltaX + deltaY * deltaY);\r\n    }\r\n    squareDistance(v) {\r\n        if (!v) {\r\n            v = Vector.Zero;\r\n        }\r\n        const deltaX = this.x - v.x;\r\n        const deltaY = this.y - v.y;\r\n        return deltaX * deltaX + deltaY * deltaY;\r\n    }\r\n    /**\r\n     * Clamps the current vector's magnitude mutating it\r\n     * @param magnitude\r\n     */\r\n    clampMagnitude(magnitude) {\r\n        const size = this.size;\r\n        const newSize = clamp(size, 0, magnitude);\r\n        this.size = newSize;\r\n        return this;\r\n    }\r\n    /**\r\n     * The size (magnitude) of the Vector\r\n     */\r\n    get size() {\r\n        return this.distance();\r\n    }\r\n    /**\r\n     * Setting the size mutates the current vector\r\n     *\r\n     * @warning Can be used to set the size of the vector, **be very careful using this, mutating vectors can cause hard to find bugs**\r\n     */\r\n    set size(newLength) {\r\n        const v = this.normalize().scale(newLength);\r\n        this.setTo(v.x, v.y);\r\n    }\r\n    /**\r\n     * Normalizes a vector to have a magnitude of 1.\r\n     */\r\n    normalize() {\r\n        const d = this.distance();\r\n        if (d > 0) {\r\n            return new Vector(this.x / d, this.y / d);\r\n        }\r\n        else {\r\n            return new Vector(0, 1);\r\n        }\r\n    }\r\n    /**\r\n     * Returns the average (midpoint) between the current point and the specified\r\n     */\r\n    average(vec) {\r\n        return this.add(vec).scale(0.5);\r\n    }\r\n    scale(sizeOrScale, dest) {\r\n        const result = dest || new Vector(0, 0);\r\n        if (sizeOrScale instanceof Vector) {\r\n            result.x = this.x * sizeOrScale.x;\r\n            result.y = this.y * sizeOrScale.y;\r\n        }\r\n        else {\r\n            result.x = this.x * sizeOrScale;\r\n            result.y = this.y * sizeOrScale;\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Adds one vector to another\r\n     * @param v The vector to add\r\n     * @param dest Optionally copy the result into a provided vector\r\n     */\r\n    add(v, dest) {\r\n        if (dest) {\r\n            dest.x = this.x + v.x;\r\n            dest.y = this.y + v.y;\r\n            return dest;\r\n        }\r\n        return new Vector(this.x + v.x, this.y + v.y);\r\n    }\r\n    /**\r\n     * Subtracts a vector from another, if you subtract vector `B.sub(A)` the resulting vector points from A -> B\r\n     * @param v The vector to subtract\r\n     */\r\n    sub(v) {\r\n        return new Vector(this.x - v.x, this.y - v.y);\r\n    }\r\n    /**\r\n     * Adds one vector to this one modifying the original\r\n     * @param v The vector to add\r\n     * @warning Be very careful using this, mutating vectors can cause hard to find bugs\r\n     */\r\n    addEqual(v) {\r\n        this.setTo(this.x + v.x, this.y + v.y);\r\n        return this;\r\n    }\r\n    /**\r\n     * Subtracts a vector from this one modifying the original\r\n     * @param v The vector to subtract\r\n     * @warning Be very careful using this, mutating vectors can cause hard to find bugs\r\n     */\r\n    subEqual(v) {\r\n        this.setTo(this.x - v.x, this.y - v.y);\r\n        return this;\r\n    }\r\n    /**\r\n     * Scales this vector by a factor of size and modifies the original\r\n     * @warning Be very careful using this, mutating vectors can cause hard to find bugs\r\n     */\r\n    scaleEqual(size) {\r\n        this.setTo(this.x * size, this.y * size);\r\n        return this;\r\n    }\r\n    /**\r\n     * Performs a dot product with another vector\r\n     * @param v  The vector to dot\r\n     */\r\n    dot(v) {\r\n        return this.x * v.x + this.y * v.y;\r\n    }\r\n    cross(v) {\r\n        if (v instanceof Vector) {\r\n            return this.x * v.y - this.y * v.x;\r\n        }\r\n        else if (typeof v === 'number') {\r\n            return new Vector(v * this.y, -v * this.x);\r\n        }\r\n    }\r\n    static cross(num, vec) {\r\n        return new Vector(-num * vec.y, num * vec.x);\r\n    }\r\n    /**\r\n     * Returns the perpendicular vector to this one\r\n     */\r\n    perpendicular() {\r\n        return new Vector(this.y, -this.x);\r\n    }\r\n    /**\r\n     * Returns the normal vector to this one, same as the perpendicular of length 1\r\n     */\r\n    normal() {\r\n        return this.perpendicular().normalize();\r\n    }\r\n    /**\r\n     * Negate the current vector\r\n     */\r\n    negate() {\r\n        return this.scale(-1);\r\n    }\r\n    /**\r\n     * Returns the angle of this vector.\r\n     */\r\n    toAngle() {\r\n        return Math.atan2(this.y, this.x);\r\n    }\r\n    /**\r\n     * Rotates the current vector around a point by a certain number of\r\n     * degrees in radians\r\n     */\r\n    rotate(angle, anchor) {\r\n        if (!anchor) {\r\n            anchor = new Vector(0, 0);\r\n        }\r\n        const sinAngle = Math.sin(angle);\r\n        const cosAngle = Math.cos(angle);\r\n        const x = cosAngle * (this.x - anchor.x) - sinAngle * (this.y - anchor.y) + anchor.x;\r\n        const y = sinAngle * (this.x - anchor.x) + cosAngle * (this.y - anchor.y) + anchor.y;\r\n        return new Vector(x, y);\r\n    }\r\n    /**\r\n     * Creates new vector that has the same values as the previous.\r\n     */\r\n    clone(dest) {\r\n        const v = dest !== null && dest !== void 0 ? dest : new Vector(0, 0);\r\n        v.x = this.x;\r\n        v.y = this.y;\r\n        return v;\r\n    }\r\n    /**\r\n     * Returns a string representation of the vector.\r\n     */\r\n    toString(fixed) {\r\n        if (fixed) {\r\n            return `(${this.x.toFixed(fixed)}, ${this.y.toFixed(fixed)})`;\r\n        }\r\n        return `(${this.x}, ${this.y})`;\r\n    }\r\n}\r\n/**\r\n * Shorthand for creating new Vectors - returns a new Vector instance with the\r\n * provided X and Y components.\r\n *\r\n * @param x  X component of the Vector\r\n * @param y  Y component of the Vector\r\n */\r\nfunction vec(x, y) {\r\n    return new Vector(x, y);\r\n}\r\n\n;// CONCATENATED MODULE: ./Color.ts\n/**\r\n * Provides standard colors (e.g. [[Color.Black]])\r\n * but you can also create custom colors using RGB, HSL, or Hex. Also provides\r\n * useful color operations like [[Color.lighten]], [[Color.darken]], and more.\r\n */\r\nclass Color {\r\n    /**\r\n     * Creates a new instance of Color from an r, g, b, a\r\n     *\r\n     * @param r  The red component of color (0-255)\r\n     * @param g  The green component of color (0-255)\r\n     * @param b  The blue component of color (0-255)\r\n     * @param a  The alpha component of color (0-1.0)\r\n     */\r\n    constructor(r, g, b, a) {\r\n        this.r = r;\r\n        this.g = g;\r\n        this.b = b;\r\n        this.a = a != null ? a : 1;\r\n    }\r\n    /**\r\n     * Creates a new instance of Color from an r, g, b, a\r\n     *\r\n     * @param r  The red component of color (0-255)\r\n     * @param g  The green component of color (0-255)\r\n     * @param b  The blue component of color (0-255)\r\n     * @param a  The alpha component of color (0-1.0)\r\n     */\r\n    static fromRGB(r, g, b, a) {\r\n        return new Color(r, g, b, a);\r\n    }\r\n    /**\r\n     * Creates a new instance of Color from a rgb string\r\n     *\r\n     * @param string  CSS color string of the form rgba(255, 255, 255, 1) or rgb(255, 255, 255)\r\n     */\r\n    static fromRGBString(string) {\r\n        const rgbaRegEx = /^rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)(?:,\\s*(\\d+(?:\\.\\d+)?))?\\)/i;\r\n        let match = null;\r\n        if ((match = string.match(rgbaRegEx))) {\r\n            const r = parseInt(match[1], 10);\r\n            const g = parseInt(match[2], 10);\r\n            const b = parseInt(match[3], 10);\r\n            let a = 1;\r\n            if (match[4]) {\r\n                a = parseFloat(match[4]);\r\n            }\r\n            return new Color(r, g, b, a);\r\n        }\r\n        else {\r\n            throw new Error('Invalid rgb/a string: ' + string);\r\n        }\r\n    }\r\n    /**\r\n     * Creates a new instance of Color from a hex string\r\n     *\r\n     * @param hex  CSS color string of the form #ffffff, the alpha component is optional\r\n     */\r\n    static fromHex(hex) {\r\n        const hexRegEx = /^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i;\r\n        let match = null;\r\n        if ((match = hex.match(hexRegEx))) {\r\n            const r = parseInt(match[1], 16);\r\n            const g = parseInt(match[2], 16);\r\n            const b = parseInt(match[3], 16);\r\n            let a = 1;\r\n            if (match[4]) {\r\n                a = parseInt(match[4], 16) / 255;\r\n            }\r\n            return new Color(r, g, b, a);\r\n        }\r\n        else {\r\n            throw new Error('Invalid hex string: ' + hex);\r\n        }\r\n    }\r\n    /**\r\n     * Creates a new instance of Color from hsla values\r\n     *\r\n     * @param h  Hue is represented [0-1]\r\n     * @param s  Saturation is represented [0-1]\r\n     * @param l  Luminance is represented [0-1]\r\n     * @param a  Alpha is represented [0-1]\r\n     */\r\n    static fromHSL(h, s, l, a = 1.0) {\r\n        const temp = new HSLColor(h, s, l, a);\r\n        return temp.toRGBA();\r\n    }\r\n    /**\r\n     * Lightens the current color by a specified amount\r\n     *\r\n     * @param factor  The amount to lighten by [0-1]\r\n     */\r\n    lighten(factor = 0.1) {\r\n        const temp = HSLColor.fromRGBA(this.r, this.g, this.b, this.a);\r\n        temp.l += (1 - temp.l) * factor;\r\n        return temp.toRGBA();\r\n    }\r\n    /**\r\n     * Darkens the current color by a specified amount\r\n     *\r\n     * @param factor  The amount to darken by [0-1]\r\n     */\r\n    darken(factor = 0.1) {\r\n        const temp = HSLColor.fromRGBA(this.r, this.g, this.b, this.a);\r\n        temp.l -= temp.l * factor;\r\n        return temp.toRGBA();\r\n    }\r\n    /**\r\n     * Saturates the current color by a specified amount\r\n     *\r\n     * @param factor  The amount to saturate by [0-1]\r\n     */\r\n    saturate(factor = 0.1) {\r\n        const temp = HSLColor.fromRGBA(this.r, this.g, this.b, this.a);\r\n        temp.s += temp.s * factor;\r\n        return temp.toRGBA();\r\n    }\r\n    /**\r\n     * Desaturates the current color by a specified amount\r\n     *\r\n     * @param factor  The amount to desaturate by [0-1]\r\n     */\r\n    desaturate(factor = 0.1) {\r\n        const temp = HSLColor.fromRGBA(this.r, this.g, this.b, this.a);\r\n        temp.s -= temp.s * factor;\r\n        return temp.toRGBA();\r\n    }\r\n    /**\r\n     * Multiplies a color by another, results in a darker color\r\n     *\r\n     * @param color  The other color\r\n     */\r\n    multiply(color) {\r\n        const newR = (((color.r / 255) * this.r) / 255) * 255;\r\n        const newG = (((color.g / 255) * this.g) / 255) * 255;\r\n        const newB = (((color.b / 255) * this.b) / 255) * 255;\r\n        const newA = color.a * this.a;\r\n        return new Color(newR, newG, newB, newA);\r\n    }\r\n    /**\r\n     * Screens a color by another, results in a lighter color\r\n     *\r\n     * @param color  The other color\r\n     */\r\n    screen(color) {\r\n        const color1 = color.invert();\r\n        const color2 = color.invert();\r\n        return color1.multiply(color2).invert();\r\n    }\r\n    /**\r\n     * Inverts the current color\r\n     */\r\n    invert() {\r\n        return new Color(255 - this.r, 255 - this.g, 255 - this.b, 1.0 - this.a);\r\n    }\r\n    /**\r\n     * Averages the current color with another\r\n     *\r\n     * @param color  The other color\r\n     */\r\n    average(color) {\r\n        const newR = (color.r + this.r) / 2;\r\n        const newG = (color.g + this.g) / 2;\r\n        const newB = (color.b + this.b) / 2;\r\n        const newA = (color.a + this.a) / 2;\r\n        return new Color(newR, newG, newB, newA);\r\n    }\r\n    equal(color) {\r\n        return this.toString() === color.toString();\r\n    }\r\n    /**\r\n     * Returns a CSS string representation of a color.\r\n     *\r\n     * @param format Color representation, accepts: rgb, hsl, or hex\r\n     */\r\n    toString(format = 'rgb') {\r\n        switch (format) {\r\n            case 'rgb':\r\n                return this.toRGBA();\r\n            case 'hsl':\r\n                return this.toHSLA();\r\n            case 'hex':\r\n                return this.toHex();\r\n            default:\r\n                throw new Error('Invalid Color format');\r\n        }\r\n    }\r\n    /**\r\n     * Returns Hex Value of a color component\r\n     * @param c color component\r\n     * @see https://stackoverflow.com/questions/5623838/rgb-to-hex-and-hex-to-rgb\r\n     */\r\n    _componentToHex(c) {\r\n        const hex = c.toString(16);\r\n        return hex.length === 1 ? '0' + hex : hex;\r\n    }\r\n    /**\r\n     * Return Hex representation of a color.\r\n     */\r\n    toHex() {\r\n        return '#' + this._componentToHex(this.r) + this._componentToHex(this.g) + this._componentToHex(this.b);\r\n    }\r\n    /**\r\n     * Return RGBA representation of a color.\r\n     */\r\n    toRGBA() {\r\n        const result = String(this.r.toFixed(0)) + ', ' + String(this.g.toFixed(0)) + ', ' + String(this.b.toFixed(0));\r\n        if (this.a !== undefined || this.a !== null) {\r\n            return 'rgba(' + result + ', ' + String(this.a) + ')';\r\n        }\r\n        return 'rgb(' + result + ')';\r\n    }\r\n    /**\r\n     * Return HSLA representation of a color.\r\n     */\r\n    toHSLA() {\r\n        return HSLColor.fromRGBA(this.r, this.g, this.b, this.a).toString();\r\n    }\r\n    /**\r\n     * Returns a CSS string representation of a color.\r\n     */\r\n    fillStyle() {\r\n        return this.toString();\r\n    }\r\n    /**\r\n     * Returns a clone of the current color.\r\n     */\r\n    clone() {\r\n        return new Color(this.r, this.g, this.b, this.a);\r\n    }\r\n    /**\r\n     * Black (#000000)\r\n     */\r\n    static get Black() {\r\n        return Color.fromHex('#000000');\r\n    }\r\n    /**\r\n     * White (#FFFFFF)\r\n     */\r\n    static get White() {\r\n        return Color.fromHex('#FFFFFF');\r\n    }\r\n    /**\r\n     * Gray (#808080)\r\n     */\r\n    static get Gray() {\r\n        return Color.fromHex('#808080');\r\n    }\r\n    /**\r\n     * Light gray (#D3D3D3)\r\n     */\r\n    static get LightGray() {\r\n        return Color.fromHex('#D3D3D3');\r\n    }\r\n    /**\r\n     * Dark gray (#A9A9A9)\r\n     */\r\n    static get DarkGray() {\r\n        return Color.fromHex('#A9A9A9');\r\n    }\r\n    /**\r\n     * Yellow (#FFFF00)\r\n     */\r\n    static get Yellow() {\r\n        return Color.fromHex('#FFFF00');\r\n    }\r\n    /**\r\n     * Orange (#FFA500)\r\n     */\r\n    static get Orange() {\r\n        return Color.fromHex('#FFA500');\r\n    }\r\n    /**\r\n     * Red (#FF0000)\r\n     */\r\n    static get Red() {\r\n        return Color.fromHex('#FF0000');\r\n    }\r\n    /**\r\n     * Vermilion (#FF5B31)\r\n     */\r\n    static get Vermilion() {\r\n        return Color.fromHex('#FF5B31');\r\n    }\r\n    /**\r\n     * Rose (#FF007F)\r\n     */\r\n    static get Rose() {\r\n        return Color.fromHex('#FF007F');\r\n    }\r\n    /**\r\n     * Magenta (#FF00FF)\r\n     */\r\n    static get Magenta() {\r\n        return Color.fromHex('#FF00FF');\r\n    }\r\n    /**\r\n     * Violet (#7F00FF)\r\n     */\r\n    static get Violet() {\r\n        return Color.fromHex('#7F00FF');\r\n    }\r\n    /**\r\n     * Blue (#0000FF)\r\n     */\r\n    static get Blue() {\r\n        return Color.fromHex('#0000FF');\r\n    }\r\n    /**\r\n     * Azure (#007FFF)\r\n     */\r\n    static get Azure() {\r\n        return Color.fromHex('#007FFF');\r\n    }\r\n    /**\r\n     * Cyan (#00FFFF)\r\n     */\r\n    static get Cyan() {\r\n        return Color.fromHex('#00FFFF');\r\n    }\r\n    /**\r\n     * Viridian (#59978F)\r\n     */\r\n    static get Viridian() {\r\n        return Color.fromHex('#59978F');\r\n    }\r\n    /**\r\n     * Green (#00FF00)\r\n     */\r\n    static get Green() {\r\n        return Color.fromHex('#00FF00');\r\n    }\r\n    /**\r\n     * Chartreuse (#7FFF00)\r\n     */\r\n    static get Chartreuse() {\r\n        return Color.fromHex('#7FFF00');\r\n    }\r\n    /**\r\n     * Transparent (#FFFFFF00)\r\n     */\r\n    static get Transparent() {\r\n        return Color.fromHex('#FFFFFF00');\r\n    }\r\n    /**\r\n     * ExcaliburBlue (#176BAA)\r\n     */\r\n    static get ExcaliburBlue() {\r\n        return Color.fromHex('#176BAA');\r\n    }\r\n}\r\n/**\r\n * Internal HSL Color representation\r\n *\r\n * http://en.wikipedia.org/wiki/HSL_and_HSV\r\n * http://axonflux.com/handy-rgb-to-hsl-and-rgb-to-hsv-color-model-c\r\n */\r\nclass HSLColor {\r\n    constructor(h, s, l, a) {\r\n        this.h = h;\r\n        this.s = s;\r\n        this.l = l;\r\n        this.a = a;\r\n    }\r\n    static hue2rgb(p, q, t) {\r\n        if (t < 0) {\r\n            t += 1;\r\n        }\r\n        if (t > 1) {\r\n            t -= 1;\r\n        }\r\n        if (t < 1 / 6) {\r\n            return p + (q - p) * 6 * t;\r\n        }\r\n        if (t < 1 / 2) {\r\n            return q;\r\n        }\r\n        if (t < 2 / 3) {\r\n            return p + (q - p) * (2 / 3 - t) * 6;\r\n        }\r\n        return p;\r\n    }\r\n    static fromRGBA(r, g, b, a) {\r\n        r /= 255;\r\n        g /= 255;\r\n        b /= 255;\r\n        const max = Math.max(r, g, b), min = Math.min(r, g, b);\r\n        let h, s;\r\n        const l = (max + min) / 2;\r\n        if (max === min) {\r\n            h = s = 0; // achromatic\r\n        }\r\n        else {\r\n            const d = max - min;\r\n            s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\r\n            switch (max) {\r\n                case r:\r\n                    h = (g - b) / d + (g < b ? 6 : 0);\r\n                    break;\r\n                case g:\r\n                    h = (b - r) / d + 2;\r\n                    break;\r\n                case b:\r\n                    h = (r - g) / d + 4;\r\n                    break;\r\n            }\r\n            h /= 6;\r\n        }\r\n        return new HSLColor(h, s, l, a);\r\n    }\r\n    toRGBA() {\r\n        let r, g, b;\r\n        if (this.s === 0) {\r\n            r = g = b = this.l; // achromatic\r\n        }\r\n        else {\r\n            const q = this.l < 0.5 ? this.l * (1 + this.s) : this.l + this.s - this.l * this.s;\r\n            const p = 2 * this.l - q;\r\n            r = HSLColor.hue2rgb(p, q, this.h + 1 / 3);\r\n            g = HSLColor.hue2rgb(p, q, this.h);\r\n            b = HSLColor.hue2rgb(p, q, this.h - 1 / 3);\r\n        }\r\n        return new Color(r * 255, g * 255, b * 255, this.a);\r\n    }\r\n    toString() {\r\n        const h = this.h.toFixed(0), s = this.s.toFixed(0), l = this.l.toFixed(0), a = this.a.toFixed(0);\r\n        return `hsla(${h}, ${s}, ${l}, ${a})`;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Side.ts\n\r\n/**\r\n * An enum that describes the sides of an axis aligned box for collision\r\n */\r\nvar Side;\r\n(function (Side) {\r\n    Side[\"None\"] = \"None\";\r\n    Side[\"Top\"] = \"Top\";\r\n    Side[\"Bottom\"] = \"Bottom\";\r\n    Side[\"Left\"] = \"Left\";\r\n    Side[\"Right\"] = \"Right\";\r\n})(Side || (Side = {}));\r\n(function (Side) {\r\n    /**\r\n     * Returns the opposite side from the current\r\n     */\r\n    function getOpposite(side) {\r\n        if (side === Side.Top) {\r\n            return Side.Bottom;\r\n        }\r\n        if (side === Side.Bottom) {\r\n            return Side.Top;\r\n        }\r\n        if (side === Side.Left) {\r\n            return Side.Right;\r\n        }\r\n        if (side === Side.Right) {\r\n            return Side.Left;\r\n        }\r\n        return Side.None;\r\n    }\r\n    Side.getOpposite = getOpposite;\r\n    /**\r\n     * Given a vector, return the Side most in that direction (via dot product)\r\n     */\r\n    function fromDirection(direction) {\r\n        const directions = [Vector.Left, Vector.Right, Vector.Up, Vector.Down];\r\n        const directionEnum = [Side.Left, Side.Right, Side.Top, Side.Bottom];\r\n        let max = -Number.MAX_VALUE;\r\n        let maxIndex = -1;\r\n        for (let i = 0; i < directions.length; i++) {\r\n            if (directions[i].dot(direction) > max) {\r\n                max = directions[i].dot(direction);\r\n                maxIndex = i;\r\n            }\r\n        }\r\n        return directionEnum[maxIndex];\r\n    }\r\n    Side.fromDirection = fromDirection;\r\n})(Side || (Side = {}));\r\n\n;// CONCATENATED MODULE: ./Collision/BoundingBox.ts\n\r\n\r\n\r\n/**\r\n * Axis Aligned collision primitive for Excalibur.\r\n */\r\nclass BoundingBox {\r\n    /**\r\n     * Constructor allows passing of either an object with all coordinate components,\r\n     * or the coordinate components passed separately.\r\n     * @param leftOrOptions    Either x coordinate of the left edge or an options object\r\n     * containing the four coordinate components.\r\n     * @param top     y coordinate of the top edge\r\n     * @param right   x coordinate of the right edge\r\n     * @param bottom  y coordinate of the bottom edge\r\n     */\r\n    constructor(leftOrOptions = 0, top = 0, right = 0, bottom = 0) {\r\n        if (typeof leftOrOptions === 'object') {\r\n            this.left = leftOrOptions.left;\r\n            this.top = leftOrOptions.top;\r\n            this.right = leftOrOptions.right;\r\n            this.bottom = leftOrOptions.bottom;\r\n        }\r\n        else if (typeof leftOrOptions === 'number') {\r\n            this.left = leftOrOptions;\r\n            this.top = top;\r\n            this.right = right;\r\n            this.bottom = bottom;\r\n        }\r\n    }\r\n    /**\r\n     * Returns a new instance of [[BoundingBox]] that is a copy of the current instance\r\n     */\r\n    clone() {\r\n        return new BoundingBox(this.left, this.top, this.right, this.bottom);\r\n    }\r\n    /**\r\n     * Given bounding box A & B, returns the side relative to A when intersection is performed.\r\n     * @param intersection Intersection vector between 2 bounding boxes\r\n     */\r\n    static getSideFromIntersection(intersection) {\r\n        if (!intersection) {\r\n            return Side.None;\r\n        }\r\n        if (intersection) {\r\n            if (Math.abs(intersection.x) > Math.abs(intersection.y)) {\r\n                if (intersection.x < 0) {\r\n                    return Side.Right;\r\n                }\r\n                return Side.Left;\r\n            }\r\n            else {\r\n                if (intersection.y < 0) {\r\n                    return Side.Bottom;\r\n                }\r\n                return Side.Top;\r\n            }\r\n        }\r\n        return Side.None;\r\n    }\r\n    static fromPoints(points) {\r\n        let minX = Infinity;\r\n        let minY = Infinity;\r\n        let maxX = -Infinity;\r\n        let maxY = -Infinity;\r\n        for (let i = 0; i < points.length; i++) {\r\n            if (points[i].x < minX) {\r\n                minX = points[i].x;\r\n            }\r\n            if (points[i].x > maxX) {\r\n                maxX = points[i].x;\r\n            }\r\n            if (points[i].y < minY) {\r\n                minY = points[i].y;\r\n            }\r\n            if (points[i].y > maxY) {\r\n                maxY = points[i].y;\r\n            }\r\n        }\r\n        return new BoundingBox(minX, minY, maxX, maxY);\r\n    }\r\n    static fromDimension(width, height, anchor = Vector.Half, pos = Vector.Zero) {\r\n        return new BoundingBox(-width * anchor.x + pos.x, -height * anchor.y + pos.y, width - width * anchor.x + pos.x, height - height * anchor.y + pos.y);\r\n    }\r\n    /**\r\n     * Returns the calculated width of the bounding box\r\n     */\r\n    get width() {\r\n        return this.right - this.left;\r\n    }\r\n    /**\r\n     * Returns the calculated height of the bounding box\r\n     */\r\n    get height() {\r\n        return this.bottom - this.top;\r\n    }\r\n    /**\r\n     * Return whether the bounding box has zero dimensions in height,width or both\r\n     */\r\n    hasZeroDimensions() {\r\n        return this.width === 0 || this.height === 0;\r\n    }\r\n    /**\r\n     * Returns the center of the bounding box\r\n     */\r\n    get center() {\r\n        return new Vector((this.left + this.right) / 2, (this.top + this.bottom) / 2);\r\n    }\r\n    translate(pos) {\r\n        return new BoundingBox(this.left + pos.x, this.top + pos.y, this.right + pos.x, this.bottom + pos.y);\r\n    }\r\n    /**\r\n     * Rotates a bounding box by and angle and around a point, if no point is specified (0, 0) is used by default. The resulting bounding\r\n     * box is also axis-align. This is useful when a new axis-aligned bounding box is needed for rotated geometry.\r\n     */\r\n    rotate(angle, point = Vector.Zero) {\r\n        const points = this.getPoints().map((p) => p.rotate(angle, point));\r\n        return BoundingBox.fromPoints(points);\r\n    }\r\n    /**\r\n     * Scale a bounding box by a scale factor, optionally provide a point\r\n     * @param scale\r\n     * @param point\r\n     */\r\n    scale(scale, point = Vector.Zero) {\r\n        const shifted = this.translate(point);\r\n        return new BoundingBox(shifted.left * scale.x, shifted.top * scale.y, shifted.right * scale.x, shifted.bottom * scale.y);\r\n    }\r\n    /**\r\n     * Transform the axis aligned bounding box by a [[Matrix]], producing a new axis aligned bounding box\r\n     * @param matrix\r\n     */\r\n    transform(matrix) {\r\n        // inlined these calculations to not use vectors would speed it up slightly\r\n        // const matFirstColumn = vec(matrix.data[0], matrix.data[1]);\r\n        // const xa = matFirstColumn.scale(this.left);\r\n        const xa1 = matrix.data[0] * this.left;\r\n        const xa2 = matrix.data[1] * this.left;\r\n        // const xb = matFirstColumn.scale(this.right);\r\n        const xb1 = matrix.data[0] * this.right;\r\n        const xb2 = matrix.data[1] * this.right;\r\n        // const matSecondColumn = vec(matrix.data[2], matrix.data[3]);\r\n        // const ya = matSecondColumn.scale(this.top);\r\n        const ya1 = matrix.data[2] * this.top;\r\n        const ya2 = matrix.data[3] * this.top;\r\n        // const yb = matSecondColumn.scale(this.bottom);\r\n        const yb1 = matrix.data[2] * this.bottom;\r\n        const yb2 = matrix.data[3] * this.bottom;\r\n        const matrixPos = matrix.getPosition();\r\n        // const topLeft = Vector.min(xa, xb).add(Vector.min(ya, yb)).add(matrixPos);\r\n        // const bottomRight = Vector.max(xa, xb).add(Vector.max(ya, yb)).add(matrixPos);\r\n        const left = Math.min(xa1, xb1) + Math.min(ya1, yb1) + matrixPos.x;\r\n        const top = Math.min(xa2, xb2) + Math.min(ya2, yb2) + matrixPos.y;\r\n        const right = Math.max(xa1, xb1) + Math.max(ya1, yb1) + matrixPos.x;\r\n        const bottom = Math.max(xa2, xb2) + Math.max(ya2, yb2) + matrixPos.y;\r\n        return new BoundingBox({\r\n            left,\r\n            top,\r\n            right,\r\n            bottom //: bottomRight.y\r\n        });\r\n    }\r\n    /**\r\n     * Returns the perimeter of the bounding box\r\n     */\r\n    getPerimeter() {\r\n        const wx = this.width;\r\n        const wy = this.height;\r\n        return 2 * (wx + wy);\r\n    }\r\n    getPoints() {\r\n        const results = [];\r\n        results.push(new Vector(this.left, this.top));\r\n        results.push(new Vector(this.right, this.top));\r\n        results.push(new Vector(this.right, this.bottom));\r\n        results.push(new Vector(this.left, this.bottom));\r\n        return results;\r\n    }\r\n    /**\r\n     * Determines whether a ray intersects with a bounding box\r\n     */\r\n    rayCast(ray, farClipDistance = Infinity) {\r\n        // algorithm from https://tavianator.com/fast-branchless-raybounding-box-intersections/\r\n        let tmin = -Infinity;\r\n        let tmax = +Infinity;\r\n        const xinv = ray.dir.x === 0 ? Number.MAX_VALUE : 1 / ray.dir.x;\r\n        const yinv = ray.dir.y === 0 ? Number.MAX_VALUE : 1 / ray.dir.y;\r\n        const tx1 = (this.left - ray.pos.x) * xinv;\r\n        const tx2 = (this.right - ray.pos.x) * xinv;\r\n        tmin = Math.min(tx1, tx2);\r\n        tmax = Math.max(tx1, tx2);\r\n        const ty1 = (this.top - ray.pos.y) * yinv;\r\n        const ty2 = (this.bottom - ray.pos.y) * yinv;\r\n        tmin = Math.max(tmin, Math.min(ty1, ty2));\r\n        tmax = Math.min(tmax, Math.max(ty1, ty2));\r\n        return tmax >= Math.max(0, tmin) && tmin < farClipDistance;\r\n    }\r\n    rayCastTime(ray, farClipDistance = Infinity) {\r\n        // algorithm from https://tavianator.com/fast-branchless-raybounding-box-intersections/\r\n        let tmin = -Infinity;\r\n        let tmax = +Infinity;\r\n        const xinv = ray.dir.x === 0 ? Number.MAX_VALUE : 1 / ray.dir.x;\r\n        const yinv = ray.dir.y === 0 ? Number.MAX_VALUE : 1 / ray.dir.y;\r\n        const tx1 = (this.left - ray.pos.x) * xinv;\r\n        const tx2 = (this.right - ray.pos.x) * xinv;\r\n        tmin = Math.min(tx1, tx2);\r\n        tmax = Math.max(tx1, tx2);\r\n        const ty1 = (this.top - ray.pos.y) * yinv;\r\n        const ty2 = (this.bottom - ray.pos.y) * yinv;\r\n        tmin = Math.max(tmin, Math.min(ty1, ty2));\r\n        tmax = Math.min(tmax, Math.max(ty1, ty2));\r\n        if (tmax >= Math.max(0, tmin) && tmin < farClipDistance) {\r\n            return tmin;\r\n        }\r\n        return -1;\r\n    }\r\n    contains(val) {\r\n        if (val instanceof Vector) {\r\n            return this.left <= val.x && this.top <= val.y && this.bottom >= val.y && this.right >= val.x;\r\n        }\r\n        else if (val instanceof BoundingBox) {\r\n            if (this.left <= val.left && this.top <= val.top && val.bottom <= this.bottom && val.right <= this.right) {\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n        return false;\r\n    }\r\n    /**\r\n     * Combines this bounding box and another together returning a new bounding box\r\n     * @param other  The bounding box to combine\r\n     */\r\n    combine(other) {\r\n        const compositeBB = new BoundingBox(Math.min(this.left, other.left), Math.min(this.top, other.top), Math.max(this.right, other.right), Math.max(this.bottom, other.bottom));\r\n        return compositeBB;\r\n    }\r\n    get dimensions() {\r\n        return new Vector(this.width, this.height);\r\n    }\r\n    /**\r\n     * Returns true if the bounding boxes overlap.\r\n     * @param other\r\n     * @param epsilon Optionally specify a small epsilon (default 0) as amount of overlap to ignore as overlap.\r\n     * This epsilon is useful in stable collision simulations.\r\n     */\r\n    overlaps(other, epsilon) {\r\n        const e = epsilon || 0;\r\n        if (other.hasZeroDimensions()) {\r\n            return this.contains(other);\r\n        }\r\n        if (this.hasZeroDimensions()) {\r\n            return other.contains(this);\r\n        }\r\n        const totalBoundingBox = this.combine(other);\r\n        return totalBoundingBox.width + e < other.width + this.width &&\r\n            totalBoundingBox.height + e < other.height + this.height;\r\n    }\r\n    /**\r\n     * Test wether this bounding box intersects with another returning\r\n     * the intersection vector that can be used to resolve the collision. If there\r\n     * is no intersection null is returned.\r\n     *\r\n     * @param other  Other [[BoundingBox]] to test intersection with\r\n     * @returns A Vector in the direction of the current BoundingBox, this <- other\r\n     */\r\n    intersect(other) {\r\n        const totalBoundingBox = this.combine(other);\r\n        // If the total bounding box is less than or equal the sum of the 2 bounds then there is collision\r\n        if (totalBoundingBox.width < other.width + this.width &&\r\n            totalBoundingBox.height < other.height + this.height &&\r\n            !totalBoundingBox.dimensions.equals(other.dimensions) &&\r\n            !totalBoundingBox.dimensions.equals(this.dimensions)) {\r\n            // collision\r\n            let overlapX = 0;\r\n            // right edge is between the other's left and right edge\r\n            /**\r\n             *     +-this-+\r\n             *     |      |\r\n             *     |    +-other-+\r\n             *     +----|-+     |\r\n             *          |       |\r\n             *          +-------+\r\n             *         <---\r\n             *          ^ overlap\r\n             */\r\n            if (this.right >= other.left && this.right <= other.right) {\r\n                overlapX = other.left - this.right;\r\n                // right edge is past the other's right edge\r\n                /**\r\n                 *     +-other-+\r\n                 *     |       |\r\n                 *     |    +-this-+\r\n                 *     +----|--+   |\r\n                 *          |      |\r\n                 *          +------+\r\n                 *          --->\r\n                 *          ^ overlap\r\n                 */\r\n            }\r\n            else {\r\n                overlapX = other.right - this.left;\r\n            }\r\n            let overlapY = 0;\r\n            // top edge is between the other's top and bottom edge\r\n            /**\r\n             *     +-other-+\r\n             *     |       |\r\n             *     |    +-this-+   | <- overlap\r\n             *     +----|--+   |   |\r\n             *          |      |  \\ /\r\n             *          +------+   '\r\n             */\r\n            if (this.top <= other.bottom && this.top >= other.top) {\r\n                overlapY = other.bottom - this.top;\r\n                // top edge is above the other top edge\r\n                /**\r\n                 *     +-this-+         .\r\n                 *     |      |        / \\\r\n                 *     |    +-other-+   | <- overlap\r\n                 *     +----|-+     |   |\r\n                 *          |       |\r\n                 *          +-------+\r\n                 */\r\n            }\r\n            else {\r\n                overlapY = other.top - this.bottom;\r\n            }\r\n            if (Math.abs(overlapX) < Math.abs(overlapY)) {\r\n                return new Vector(overlapX, 0);\r\n            }\r\n            else {\r\n                return new Vector(0, overlapY);\r\n            }\r\n            // Case of total containment of one bounding box by another\r\n        }\r\n        else if (totalBoundingBox.dimensions.equals(other.dimensions) || totalBoundingBox.dimensions.equals(this.dimensions)) {\r\n            let overlapX = 0;\r\n            // this is wider than the other\r\n            if (this.width - other.width >= 0) {\r\n                // This right edge is closest to the others right edge\r\n                if (this.right - other.right <= other.left - this.left) {\r\n                    overlapX = other.left - this.right;\r\n                    // This left edge is closest to the others left edge\r\n                }\r\n                else {\r\n                    overlapX = other.right - this.left;\r\n                }\r\n                // other is wider than this\r\n            }\r\n            else {\r\n                // This right edge is closest to the others right edge\r\n                if (other.right - this.right <= this.left - other.left) {\r\n                    overlapX = this.left - other.right;\r\n                    // This left edge is closest to the others left edge\r\n                }\r\n                else {\r\n                    overlapX = this.right - other.left;\r\n                }\r\n            }\r\n            let overlapY = 0;\r\n            // this is taller than other\r\n            if (this.height - other.height >= 0) {\r\n                // The bottom edge is closest to the others bottom edge\r\n                if (this.bottom - other.bottom <= other.top - this.top) {\r\n                    overlapY = other.top - this.bottom;\r\n                }\r\n                else {\r\n                    overlapY = other.bottom - this.top;\r\n                }\r\n                // other is taller than this\r\n            }\r\n            else {\r\n                // The bottom edge is closest to the others bottom edge\r\n                if (other.bottom - this.bottom <= this.top - other.top) {\r\n                    overlapY = this.top - other.bottom;\r\n                }\r\n                else {\r\n                    overlapY = this.bottom - other.top;\r\n                }\r\n            }\r\n            if (Math.abs(overlapX) < Math.abs(overlapY)) {\r\n                return new Vector(overlapX, 0);\r\n            }\r\n            else {\r\n                return new Vector(0, overlapY);\r\n            }\r\n        }\r\n        else {\r\n            return null;\r\n        }\r\n    }\r\n    /**\r\n     * Test whether the bounding box has intersected with another bounding box, returns the side of the current bb that intersected.\r\n     * @param bb The other actor to test\r\n     */\r\n    intersectWithSide(bb) {\r\n        const intersect = this.intersect(bb);\r\n        return BoundingBox.getSideFromIntersection(intersect);\r\n    }\r\n    /**\r\n     * Draw a debug bounding box\r\n     * @param ex\r\n     * @param color\r\n     */\r\n    draw(ex, color = Color.Yellow) {\r\n        ex.debug.drawRect(this.left, this.top, this.width, this.height, { color });\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Future.ts\n/**\r\n * Future is a wrapper around a native browser Promise to allow resolving/rejecting at any time\r\n */\r\nclass Future {\r\n    constructor() {\r\n        this._isCompleted = false;\r\n        this.promise = new Promise((resolve, reject) => {\r\n            this._resolver = resolve;\r\n            this._rejecter = reject;\r\n        });\r\n    }\r\n    get isCompleted() {\r\n        return this._isCompleted;\r\n    }\r\n    resolve(value) {\r\n        if (this._isCompleted) {\r\n            return;\r\n        }\r\n        this._isCompleted = true;\r\n        this._resolver(value);\r\n    }\r\n    reject(error) {\r\n        if (this._isCompleted) {\r\n            return;\r\n        }\r\n        this._isCompleted = true;\r\n        this._rejecter(error);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Util.ts\n\r\n\r\n/**\r\n * Find the screen position of an HTML element\r\n */\r\nfunction getPosition(el) {\r\n    let oLeft = 0, oTop = 0;\r\n    const calcOffsetLeft = (parent) => {\r\n        oLeft += parent.offsetLeft;\r\n        if (parent.offsetParent) {\r\n            calcOffsetLeft(parent.offsetParent);\r\n        }\r\n    };\r\n    const calcOffsetTop = (parent) => {\r\n        oTop += parent.offsetTop;\r\n        if (parent.offsetParent) {\r\n            calcOffsetTop(parent.offsetParent);\r\n        }\r\n    };\r\n    calcOffsetLeft(el);\r\n    calcOffsetTop(el);\r\n    return new Vector(oLeft, oTop);\r\n}\r\n/**\r\n * Add an item to an array list if it doesn't already exist. Returns true if added, false if not and already exists in the array.\r\n * @deprecated Will be removed in v0.26.0\r\n */\r\nfunction addItemToArray(item, array) {\r\n    if (array.indexOf(item) === -1) {\r\n        array.push(item);\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * Remove an item from an list\r\n * @deprecated Will be removed in v0.26.0\r\n */\r\nfunction removeItemFromArray(item, array) {\r\n    let index = -1;\r\n    if ((index = array.indexOf(item)) > -1) {\r\n        array.splice(index, 1);\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * See if an array contains something\r\n */\r\nfunction contains(array, obj) {\r\n    for (let i = 0; i < array.length; i++) {\r\n        if (array[i] === obj) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * Used for exhaustive checks at compile time\r\n */\r\nfunction fail(message) {\r\n    throw new Error(message);\r\n}\r\n/**\r\n * Create a promise that resolves after a certain number of milliseconds\r\n *\r\n * It is strongly recommended you pass the excalibur clock so delays are bound to the\r\n * excalibur clock which would be unaffected by stop/pause.\r\n * @param milliseconds\r\n * @param clock\r\n */\r\nfunction delay(milliseconds, clock) {\r\n    var _a;\r\n    const future = new Future();\r\n    const schedule = (_a = clock === null || clock === void 0 ? void 0 : clock.schedule.bind(clock)) !== null && _a !== void 0 ? _a : setTimeout;\r\n    schedule(() => {\r\n        future.resolve();\r\n    }, milliseconds);\r\n    return future.promise;\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/matrix.ts\n\r\n\r\n\r\nvar MatrixLocations;\r\n(function (MatrixLocations) {\r\n    MatrixLocations[MatrixLocations[\"X\"] = 12] = \"X\";\r\n    MatrixLocations[MatrixLocations[\"Y\"] = 13] = \"Y\";\r\n})(MatrixLocations || (MatrixLocations = {}));\r\n/**\r\n * Excalibur Matrix helper for 4x4 matrices\r\n *\r\n * Useful for webgl 4x4 matrices\r\n */\r\nclass Matrix {\r\n    constructor() {\r\n        /**\r\n         *  4x4 matrix in column major order\r\n         *\r\n         * |         |         |          |          |\r\n         * | ------- | ------- | -------- | -------- |\r\n         * | data[0] | data[4] | data[8]  | data[12] |\r\n         * | data[1] | data[5] | data[9]  | data[13] |\r\n         * | data[2] | data[6] | data[10] | data[14] |\r\n         * | data[3] | data[7] | data[11] | data[15] |\r\n         *\r\n         */\r\n        this.data = new Float32Array(16);\r\n        this._scaleX = 1;\r\n        this._scaleSignX = 1;\r\n        this._scaleY = 1;\r\n        this._scaleSignY = 1;\r\n    }\r\n    /**\r\n     * Creates an orthographic (flat non-perspective) projection\r\n     * https://en.wikipedia.org/wiki/Orthographic_projection\r\n     * @param left\r\n     * @param right\r\n     * @param bottom\r\n     * @param top\r\n     * @param near\r\n     * @param far\r\n     */\r\n    static ortho(left, right, bottom, top, near, far) {\r\n        const mat = new Matrix();\r\n        mat.data[0] = 2 / (right - left);\r\n        mat.data[1] = 0;\r\n        mat.data[2] = 0;\r\n        mat.data[3] = 0;\r\n        mat.data[4] = 0;\r\n        mat.data[5] = 2 / (top - bottom);\r\n        mat.data[6] = 0;\r\n        mat.data[7] = 0;\r\n        mat.data[8] = 0;\r\n        mat.data[9] = 0;\r\n        mat.data[10] = -2 / (far - near);\r\n        mat.data[11] = 0;\r\n        mat.data[12] = -(right + left) / (right - left);\r\n        mat.data[13] = -(top + bottom) / (top - bottom);\r\n        mat.data[14] = -(far + near) / (far - near);\r\n        mat.data[15] = 1;\r\n        return mat;\r\n    }\r\n    /**\r\n     * Creates a new Matrix with the same data as the current 4x4\r\n     */\r\n    clone(dest) {\r\n        const mat = dest || new Matrix();\r\n        mat.data[0] = this.data[0];\r\n        mat.data[1] = this.data[1];\r\n        mat.data[2] = this.data[2];\r\n        mat.data[3] = this.data[3];\r\n        mat.data[4] = this.data[4];\r\n        mat.data[5] = this.data[5];\r\n        mat.data[6] = this.data[6];\r\n        mat.data[7] = this.data[7];\r\n        mat.data[8] = this.data[8];\r\n        mat.data[9] = this.data[9];\r\n        mat.data[10] = this.data[10];\r\n        mat.data[11] = this.data[11];\r\n        mat.data[12] = this.data[12];\r\n        mat.data[13] = this.data[13];\r\n        mat.data[14] = this.data[14];\r\n        mat.data[15] = this.data[15];\r\n        return mat;\r\n    }\r\n    /**\r\n     * Converts the current matrix into a DOMMatrix\r\n     *\r\n     * This is useful when working with the browser Canvas context\r\n     * @returns {DOMMatrix} DOMMatrix\r\n     */\r\n    toDOMMatrix() {\r\n        return new DOMMatrix([...this.data]);\r\n    }\r\n    static fromFloat32Array(data) {\r\n        const matrix = new Matrix();\r\n        matrix.data = data;\r\n        return matrix;\r\n    }\r\n    /**\r\n     * Creates a new identity matrix (a matrix that when applied does nothing)\r\n     */\r\n    static identity() {\r\n        const mat = new Matrix();\r\n        mat.data[0] = 1;\r\n        mat.data[1] = 0;\r\n        mat.data[2] = 0;\r\n        mat.data[3] = 0;\r\n        mat.data[4] = 0;\r\n        mat.data[5] = 1;\r\n        mat.data[6] = 0;\r\n        mat.data[7] = 0;\r\n        mat.data[8] = 0;\r\n        mat.data[9] = 0;\r\n        mat.data[10] = 1;\r\n        mat.data[11] = 0;\r\n        mat.data[12] = 0;\r\n        mat.data[13] = 0;\r\n        mat.data[14] = 0;\r\n        mat.data[15] = 1;\r\n        return mat;\r\n    }\r\n    /**\r\n     * Resets the current matrix to the identity matrix, mutating it\r\n     * @returns {Matrix} Current matrix as identity\r\n     */\r\n    reset() {\r\n        const mat = this;\r\n        mat.data[0] = 1;\r\n        mat.data[1] = 0;\r\n        mat.data[2] = 0;\r\n        mat.data[3] = 0;\r\n        mat.data[4] = 0;\r\n        mat.data[5] = 1;\r\n        mat.data[6] = 0;\r\n        mat.data[7] = 0;\r\n        mat.data[8] = 0;\r\n        mat.data[9] = 0;\r\n        mat.data[10] = 1;\r\n        mat.data[11] = 0;\r\n        mat.data[12] = 0;\r\n        mat.data[13] = 0;\r\n        mat.data[14] = 0;\r\n        mat.data[15] = 1;\r\n        return mat;\r\n    }\r\n    /**\r\n     * Creates a brand new translation matrix at the specified 3d point\r\n     * @param x\r\n     * @param y\r\n     */\r\n    static translation(x, y) {\r\n        const mat = Matrix.identity();\r\n        mat.data[12] = x;\r\n        mat.data[13] = y;\r\n        return mat;\r\n    }\r\n    /**\r\n     * Creates a brand new scaling matrix with the specified scaling factor\r\n     * @param sx\r\n     * @param sy\r\n     */\r\n    static scale(sx, sy) {\r\n        const mat = Matrix.identity();\r\n        mat.data[0] = sx;\r\n        mat.data[5] = sy;\r\n        mat.data[10] = 1;\r\n        mat.data[15] = 1;\r\n        return mat;\r\n    }\r\n    /**\r\n     * Creates a brand new rotation matrix with the specified angle\r\n     * @param angleRadians\r\n     */\r\n    static rotation(angleRadians) {\r\n        const mat = Matrix.identity();\r\n        mat.data[0] = Math.cos(angleRadians);\r\n        mat.data[4] = -Math.sin(angleRadians);\r\n        mat.data[1] = Math.sin(angleRadians);\r\n        mat.data[5] = Math.cos(angleRadians);\r\n        return mat;\r\n    }\r\n    multiply(vectorOrMatrix, dest) {\r\n        if (vectorOrMatrix instanceof Vector) {\r\n            const result = dest || new Vector(0, 0);\r\n            const vector = vectorOrMatrix;\r\n            // these shenanigans are to allow dest and vector to be the same instance\r\n            const resultX = vector.x * this.data[0] + vector.y * this.data[4] + this.data[12];\r\n            const resultY = vector.x * this.data[1] + vector.y * this.data[5] + this.data[13];\r\n            result.x = resultX;\r\n            result.y = resultY;\r\n            return result;\r\n        }\r\n        else {\r\n            const result = dest || new Matrix();\r\n            const other = vectorOrMatrix;\r\n            const a11 = this.data[0];\r\n            const a21 = this.data[1];\r\n            const a31 = this.data[2];\r\n            const a41 = this.data[3];\r\n            const a12 = this.data[4];\r\n            const a22 = this.data[5];\r\n            const a32 = this.data[6];\r\n            const a42 = this.data[7];\r\n            const a13 = this.data[8];\r\n            const a23 = this.data[9];\r\n            const a33 = this.data[10];\r\n            const a43 = this.data[11];\r\n            const a14 = this.data[12];\r\n            const a24 = this.data[13];\r\n            const a34 = this.data[14];\r\n            const a44 = this.data[15];\r\n            const b11 = other.data[0];\r\n            const b21 = other.data[1];\r\n            const b31 = other.data[2];\r\n            const b41 = other.data[3];\r\n            const b12 = other.data[4];\r\n            const b22 = other.data[5];\r\n            const b32 = other.data[6];\r\n            const b42 = other.data[7];\r\n            const b13 = other.data[8];\r\n            const b23 = other.data[9];\r\n            const b33 = other.data[10];\r\n            const b43 = other.data[11];\r\n            const b14 = other.data[12];\r\n            const b24 = other.data[13];\r\n            const b34 = other.data[14];\r\n            const b44 = other.data[15];\r\n            result.data[0] = a11 * b11 + a12 * b21 + a13 * b31 + a14 * b41;\r\n            result.data[1] = a21 * b11 + a22 * b21 + a23 * b31 + a24 * b41;\r\n            result.data[2] = a31 * b11 + a32 * b21 + a33 * b31 + a34 * b41;\r\n            result.data[3] = a41 * b11 + a42 * b21 + a43 * b31 + a44 * b41;\r\n            result.data[4] = a11 * b12 + a12 * b22 + a13 * b32 + a14 * b42;\r\n            result.data[5] = a21 * b12 + a22 * b22 + a23 * b32 + a24 * b42;\r\n            result.data[6] = a31 * b12 + a32 * b22 + a33 * b32 + a34 * b42;\r\n            result.data[7] = a41 * b12 + a42 * b22 + a43 * b32 + a44 * b42;\r\n            result.data[8] = a11 * b13 + a12 * b23 + a13 * b33 + a14 * b43;\r\n            result.data[9] = a21 * b13 + a22 * b23 + a23 * b33 + a24 * b43;\r\n            result.data[10] = a31 * b13 + a32 * b23 + a33 * b33 + a34 * b43;\r\n            result.data[11] = a41 * b13 + a42 * b23 + a43 * b33 + a44 * b43;\r\n            result.data[12] = a11 * b14 + a12 * b24 + a13 * b34 + a14 * b44;\r\n            result.data[13] = a21 * b14 + a22 * b24 + a23 * b34 + a24 * b44;\r\n            result.data[14] = a31 * b14 + a32 * b24 + a33 * b34 + a34 * b44;\r\n            result.data[15] = a41 * b14 + a42 * b24 + a43 * b34 + a44 * b44;\r\n            const s = this.getScale();\r\n            result._scaleSignX = sign(s.x) * sign(result._scaleSignX);\r\n            result._scaleSignY = sign(s.y) * sign(result._scaleSignY);\r\n            return result;\r\n        }\r\n    }\r\n    /**\r\n     * Applies translation to the current matrix mutating it\r\n     * @param x\r\n     * @param y\r\n     */\r\n    translate(x, y) {\r\n        const a11 = this.data[0];\r\n        const a21 = this.data[1];\r\n        const a31 = this.data[2];\r\n        const a41 = this.data[3];\r\n        const a12 = this.data[4];\r\n        const a22 = this.data[5];\r\n        const a32 = this.data[6];\r\n        const a42 = this.data[7];\r\n        const a13 = this.data[8];\r\n        const a23 = this.data[9];\r\n        const a33 = this.data[10];\r\n        const a43 = this.data[11];\r\n        const a14 = this.data[12];\r\n        const a24 = this.data[13];\r\n        const a34 = this.data[14];\r\n        const a44 = this.data[15];\r\n        // Doesn't change z\r\n        const z = 0;\r\n        const w = 1;\r\n        this.data[12] = a11 * x + a12 * y + a13 * z + a14 * w;\r\n        this.data[13] = a21 * x + a22 * y + a23 * z + a24 * w;\r\n        this.data[14] = a31 * x + a32 * y + a33 * z + a34 * w;\r\n        this.data[15] = a41 * x + a42 * y + a43 * z + a44 * w;\r\n        return this;\r\n    }\r\n    setPosition(x, y) {\r\n        this.data[12] = x;\r\n        this.data[13] = y;\r\n    }\r\n    getPosition() {\r\n        return vec(this.data[12], this.data[13]);\r\n    }\r\n    /**\r\n     * Applies rotation to the current matrix mutating it\r\n     * @param angle in Radians\r\n     */\r\n    rotate(angle) {\r\n        const a11 = this.data[0];\r\n        const a21 = this.data[1];\r\n        const a31 = this.data[2];\r\n        const a41 = this.data[3];\r\n        const a12 = this.data[4];\r\n        const a22 = this.data[5];\r\n        const a32 = this.data[6];\r\n        const a42 = this.data[7];\r\n        const sine = Math.sin(angle);\r\n        const cosine = Math.cos(angle);\r\n        this.data[0] = cosine * a11 + sine * a12;\r\n        this.data[1] = cosine * a21 + sine * a22;\r\n        this.data[2] = cosine * a31 + sine * a32;\r\n        this.data[3] = cosine * a41 + sine * a42;\r\n        this.data[4] = cosine * a12 - sine * a11;\r\n        this.data[5] = cosine * a22 - sine * a21;\r\n        this.data[6] = cosine * a32 - sine * a31;\r\n        this.data[7] = cosine * a42 - sine * a41;\r\n        return this;\r\n    }\r\n    /**\r\n     * Applies scaling to the current matrix mutating it\r\n     * @param x\r\n     * @param y\r\n     */\r\n    scale(x, y) {\r\n        const a11 = this.data[0];\r\n        const a21 = this.data[1];\r\n        const a31 = this.data[2];\r\n        const a41 = this.data[3];\r\n        const a12 = this.data[4];\r\n        const a22 = this.data[5];\r\n        const a32 = this.data[6];\r\n        const a42 = this.data[7];\r\n        this.data[0] = a11 * x;\r\n        this.data[1] = a21 * x;\r\n        this.data[2] = a31 * x;\r\n        this.data[3] = a41 * x;\r\n        this.data[4] = a12 * y;\r\n        this.data[5] = a22 * y;\r\n        this.data[6] = a32 * y;\r\n        this.data[7] = a42 * y;\r\n        return this;\r\n    }\r\n    setRotation(angle) {\r\n        const currentScale = this.getScale();\r\n        const sine = Math.sin(angle);\r\n        const cosine = Math.cos(angle);\r\n        this.data[0] = cosine * currentScale.x;\r\n        this.data[1] = sine * currentScale.y;\r\n        this.data[4] = -sine * currentScale.x;\r\n        this.data[5] = cosine * currentScale.y;\r\n    }\r\n    getRotation() {\r\n        const angle = Math.atan2(this.data[1] / this.getScaleY(), this.data[0] / this.getScaleX());\r\n        return canonicalizeAngle(angle);\r\n    }\r\n    getScaleX() {\r\n        // absolute scale of the matrix (we lose sign so need to add it back)\r\n        const xscale = vec(this.data[0], this.data[4]).size;\r\n        return this._scaleSignX * xscale;\r\n    }\r\n    getScaleY() {\r\n        // absolute scale of the matrix (we lose sign so need to add it back)\r\n        const yscale = vec(this.data[1], this.data[5]).size;\r\n        return this._scaleSignY * yscale;\r\n    }\r\n    /**\r\n     * Get the scale of the matrix\r\n     */\r\n    getScale() {\r\n        return vec(this.getScaleX(), this.getScaleY());\r\n    }\r\n    setScaleX(val) {\r\n        if (this._scaleX === val) {\r\n            return;\r\n        }\r\n        this._scaleSignX = sign(val);\r\n        // negative scale acts like a 180 rotation, so flip\r\n        const xscale = vec(this.data[0] * this._scaleSignX, this.data[4] * this._scaleSignX).normalize();\r\n        this.data[0] = xscale.x * val;\r\n        this.data[4] = xscale.y * val;\r\n        this._scaleX = val;\r\n    }\r\n    setScaleY(val) {\r\n        if (this._scaleY === val) {\r\n            return;\r\n        }\r\n        this._scaleSignY = sign(val);\r\n        // negative scale acts like a 180 rotation, so flip\r\n        const yscale = vec(this.data[1] * this._scaleSignY, this.data[5] * this._scaleSignY).normalize();\r\n        this.data[1] = yscale.x * val;\r\n        this.data[5] = yscale.y * val;\r\n        this._scaleY = val;\r\n    }\r\n    setScale(scale) {\r\n        this.setScaleX(scale.x);\r\n        this.setScaleY(scale.y);\r\n    }\r\n    /**\r\n     * Determinant of the upper left 2x2 matrix\r\n     */\r\n    getBasisDeterminant() {\r\n        return this.data[0] * this.data[5] - this.data[1] * this.data[4];\r\n    }\r\n    /**\r\n     * Return the affine inverse, optionally store it in a target matrix.\r\n     *\r\n     * It's recommended you call .reset() the target unless you know what you're doing\r\n     * @param target\r\n     */\r\n    getAffineInverse(target) {\r\n        // See http://negativeprobability.blogspot.com/2011/11/affine-transformations-and-their.html\r\n        // See https://www.mathsisfun.com/algebra/matrix-inverse.html\r\n        // Since we are actually only doing 2D transformations we can use this hack\r\n        // We don't actually use the 3rd or 4th dimension\r\n        const det = this.getBasisDeterminant();\r\n        const inverseDet = 1 / det; // todo zero check\r\n        const a = this.data[0];\r\n        const b = this.data[4];\r\n        const c = this.data[1];\r\n        const d = this.data[5];\r\n        const m = target || Matrix.identity();\r\n        // inverts rotation and scale\r\n        m.data[0] = d * inverseDet;\r\n        m.data[1] = -c * inverseDet;\r\n        m.data[4] = -b * inverseDet;\r\n        m.data[5] = a * inverseDet;\r\n        const tx = this.data[12];\r\n        const ty = this.data[13];\r\n        // invert translation\r\n        // transform translation into the matrix basis created by rot/scale\r\n        m.data[12] = -(tx * m.data[0] + ty * m.data[4]);\r\n        m.data[13] = -(tx * m.data[1] + ty * m.data[5]);\r\n        return m;\r\n    }\r\n    isIdentity() {\r\n        return (this.data[0] === 1 &&\r\n            this.data[1] === 0 &&\r\n            this.data[2] === 0 &&\r\n            this.data[3] === 0 &&\r\n            this.data[4] === 0 &&\r\n            this.data[5] === 1 &&\r\n            this.data[6] === 0 &&\r\n            this.data[7] === 0 &&\r\n            this.data[8] === 0 &&\r\n            this.data[9] === 0 &&\r\n            this.data[10] === 1 &&\r\n            this.data[11] === 0 &&\r\n            this.data[12] === 0 &&\r\n            this.data[13] === 0 &&\r\n            this.data[14] === 0 &&\r\n            this.data[15] === 1);\r\n    }\r\n    toString() {\r\n        return `\r\n[${this.data[0]} ${this.data[4]} ${this.data[8]} ${this.data[12]}]\r\n[${this.data[1]} ${this.data[5]} ${this.data[9]} ${this.data[13]}]\r\n[${this.data[2]} ${this.data[6]} ${this.data[10]} ${this.data[14]}]\r\n[${this.data[3]} ${this.data[7]} ${this.data[11]} ${this.data[15]}]\r\n`;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/affine-matrix.ts\n\r\n\r\n\r\nclass AffineMatrix {\r\n    constructor() {\r\n        /**\r\n         * |         |         |          |\r\n         * | ------- | ------- | -------- |\r\n         * | data[0] | data[2] | data[4]  |\r\n         * | data[1] | data[3] | data[5]  |\r\n         * |   0     |    0    |    1     |\r\n         */\r\n        this.data = new Float64Array(6);\r\n        this._scale = new Float64Array([1, 1]);\r\n        this._scaleSignX = 1;\r\n        this._scaleSignY = 1;\r\n    }\r\n    /**\r\n     * Converts the current matrix into a DOMMatrix\r\n     *\r\n     * This is useful when working with the browser Canvas context\r\n     * @returns {DOMMatrix} DOMMatrix\r\n     */\r\n    toDOMMatrix() {\r\n        return new DOMMatrix([...this.data]);\r\n    }\r\n    static identity() {\r\n        const mat = new AffineMatrix();\r\n        mat.data[0] = 1;\r\n        mat.data[1] = 0;\r\n        mat.data[2] = 0;\r\n        mat.data[3] = 1;\r\n        mat.data[4] = 0;\r\n        mat.data[5] = 0;\r\n        return mat;\r\n    }\r\n    /**\r\n     * Creates a brand new translation matrix at the specified 3d point\r\n     * @param x\r\n     * @param y\r\n     */\r\n    static translation(x, y) {\r\n        const mat = AffineMatrix.identity();\r\n        mat.data[4] = x;\r\n        mat.data[5] = y;\r\n        return mat;\r\n    }\r\n    /**\r\n     * Creates a brand new scaling matrix with the specified scaling factor\r\n     * @param sx\r\n     * @param sy\r\n     */\r\n    static scale(sx, sy) {\r\n        const mat = AffineMatrix.identity();\r\n        mat.data[0] = sx;\r\n        mat.data[3] = sy;\r\n        mat._scale[0] = sx;\r\n        mat._scale[1] = sy;\r\n        return mat;\r\n    }\r\n    /**\r\n     * Creates a brand new rotation matrix with the specified angle\r\n     * @param angleRadians\r\n     */\r\n    static rotation(angleRadians) {\r\n        const mat = AffineMatrix.identity();\r\n        mat.data[0] = Math.cos(angleRadians);\r\n        mat.data[1] = Math.sin(angleRadians);\r\n        mat.data[2] = -Math.sin(angleRadians);\r\n        mat.data[3] = Math.cos(angleRadians);\r\n        return mat;\r\n    }\r\n    setPosition(x, y) {\r\n        this.data[4] = x;\r\n        this.data[5] = y;\r\n    }\r\n    getPosition() {\r\n        return vec(this.data[4], this.data[5]);\r\n    }\r\n    /**\r\n     * Applies rotation to the current matrix mutating it\r\n     * @param angle in Radians\r\n     */\r\n    rotate(angle) {\r\n        const a11 = this.data[0];\r\n        const a21 = this.data[1];\r\n        const a12 = this.data[2];\r\n        const a22 = this.data[3];\r\n        const sine = Math.sin(angle);\r\n        const cosine = Math.cos(angle);\r\n        this.data[0] = cosine * a11 + sine * a12;\r\n        this.data[1] = cosine * a21 + sine * a22;\r\n        this.data[2] = cosine * a12 - sine * a11;\r\n        this.data[3] = cosine * a22 - sine * a21;\r\n        return this;\r\n    }\r\n    /**\r\n     * Applies translation to the current matrix mutating it\r\n     * @param x\r\n     * @param y\r\n     */\r\n    translate(x, y) {\r\n        const a11 = this.data[0];\r\n        const a21 = this.data[1];\r\n        // const a31 = 0;\r\n        const a12 = this.data[2];\r\n        const a22 = this.data[3];\r\n        // const a32 = 0;\r\n        const a13 = this.data[4];\r\n        const a23 = this.data[5];\r\n        // const a33 = 1;\r\n        // Doesn't change z\r\n        this.data[4] = a11 * x + a12 * y + a13;\r\n        this.data[5] = a21 * x + a22 * y + a23;\r\n        return this;\r\n    }\r\n    /**\r\n     * Applies scaling to the current matrix mutating it\r\n     * @param x\r\n     * @param y\r\n     */\r\n    scale(x, y) {\r\n        const a11 = this.data[0];\r\n        const a21 = this.data[1];\r\n        const a12 = this.data[2];\r\n        const a22 = this.data[3];\r\n        this.data[0] = a11 * x;\r\n        this.data[1] = a21 * x;\r\n        this.data[2] = a12 * y;\r\n        this.data[3] = a22 * y;\r\n        this._scale[0] = x;\r\n        this._scale[1] = y;\r\n        return this;\r\n    }\r\n    determinant() {\r\n        return this.data[0] * this.data[3] - this.data[1] * this.data[2];\r\n    }\r\n    /**\r\n     * Return the affine inverse, optionally store it in a target matrix.\r\n     *\r\n     * It's recommended you call .reset() the target unless you know what you're doing\r\n     * @param target\r\n     */\r\n    inverse(target) {\r\n        // See http://negativeprobability.blogspot.com/2011/11/affine-transformations-and-their.html\r\n        // See https://www.mathsisfun.com/algebra/matrix-inverse.html\r\n        // Since we are actually only doing 2D transformations we can use this hack\r\n        // We don't actually use the 3rd or 4th dimension\r\n        const det = this.determinant();\r\n        const inverseDet = 1 / det; // TODO zero check\r\n        const a = this.data[0];\r\n        const b = this.data[2];\r\n        const c = this.data[1];\r\n        const d = this.data[3];\r\n        const m = target || AffineMatrix.identity();\r\n        // inverts rotation and scale\r\n        m.data[0] = d * inverseDet;\r\n        m.data[1] = -c * inverseDet;\r\n        m.data[2] = -b * inverseDet;\r\n        m.data[3] = a * inverseDet;\r\n        const tx = this.data[4];\r\n        const ty = this.data[5];\r\n        // invert translation\r\n        // transform translation into the matrix basis created by rot/scale\r\n        m.data[4] = -(tx * m.data[0] + ty * m.data[2]);\r\n        m.data[5] = -(tx * m.data[1] + ty * m.data[3]);\r\n        return m;\r\n    }\r\n    multiply(vectorOrMatrix, dest) {\r\n        if (vectorOrMatrix instanceof Vector) {\r\n            const result = dest || new Vector(0, 0);\r\n            const vector = vectorOrMatrix;\r\n            // these shenanigans are to allow dest and vector to be the same instance\r\n            const resultX = vector.x * this.data[0] + vector.y * this.data[2] + this.data[4];\r\n            const resultY = vector.x * this.data[1] + vector.y * this.data[3] + this.data[5];\r\n            result.x = resultX;\r\n            result.y = resultY;\r\n            return result;\r\n        }\r\n        else {\r\n            const result = dest || new AffineMatrix();\r\n            const other = vectorOrMatrix;\r\n            const a11 = this.data[0];\r\n            const a21 = this.data[1];\r\n            //  const a31 = 0;\r\n            const a12 = this.data[2];\r\n            const a22 = this.data[3];\r\n            //  const a32 = 0;\r\n            const a13 = this.data[4];\r\n            const a23 = this.data[5];\r\n            //  const a33 = 1;\r\n            const b11 = other.data[0];\r\n            const b21 = other.data[1];\r\n            //  const b31 = 0;\r\n            const b12 = other.data[2];\r\n            const b22 = other.data[3];\r\n            //  const b32 = 0;\r\n            const b13 = other.data[4];\r\n            const b23 = other.data[5];\r\n            //  const b33 = 1;\r\n            result.data[0] = a11 * b11 + a12 * b21; // + a13 * b31; // zero\r\n            result.data[1] = a21 * b11 + a22 * b21; // + a23 * b31; // zero\r\n            result.data[2] = a11 * b12 + a12 * b22; // + a13 * b32; // zero\r\n            result.data[3] = a21 * b12 + a22 * b22; // + a23 * b32; // zero\r\n            result.data[4] = a11 * b13 + a12 * b23 + a13; // * b33; // one\r\n            result.data[5] = a21 * b13 + a22 * b23 + a23; // * b33; // one\r\n            const s = this.getScale();\r\n            result._scaleSignX = sign(s.x) * sign(result._scaleSignX);\r\n            result._scaleSignY = sign(s.y) * sign(result._scaleSignY);\r\n            return result;\r\n        }\r\n    }\r\n    to4x4() {\r\n        const mat = new Matrix();\r\n        mat.data[0] = this.data[0];\r\n        mat.data[1] = this.data[1];\r\n        mat.data[2] = 0;\r\n        mat.data[3] = 0;\r\n        mat.data[4] = this.data[2];\r\n        mat.data[5] = this.data[3];\r\n        mat.data[6] = 0;\r\n        mat.data[7] = 0;\r\n        mat.data[8] = 0;\r\n        mat.data[9] = 0;\r\n        mat.data[10] = 1;\r\n        mat.data[11] = 0;\r\n        mat.data[12] = this.data[4];\r\n        mat.data[13] = this.data[5];\r\n        mat.data[14] = 0;\r\n        mat.data[15] = 1;\r\n        return mat;\r\n    }\r\n    setRotation(angle) {\r\n        const currentScale = this.getScale();\r\n        const sine = Math.sin(angle);\r\n        const cosine = Math.cos(angle);\r\n        this.data[0] = cosine * currentScale.x;\r\n        this.data[1] = sine * currentScale.y;\r\n        this.data[2] = -sine * currentScale.x;\r\n        this.data[3] = cosine * currentScale.y;\r\n    }\r\n    getRotation() {\r\n        const angle = Math.atan2(this.data[1] / this.getScaleY(), this.data[0] / this.getScaleX());\r\n        return canonicalizeAngle(angle);\r\n    }\r\n    getScaleX() {\r\n        // absolute scale of the matrix (we lose sign so need to add it back)\r\n        const xscale = vec(this.data[0], this.data[2]).distance();\r\n        return this._scaleSignX * xscale;\r\n    }\r\n    getScaleY() {\r\n        // absolute scale of the matrix (we lose sign so need to add it back)\r\n        const yscale = vec(this.data[1], this.data[3]).distance();\r\n        return this._scaleSignY * yscale;\r\n    }\r\n    /**\r\n     * Get the scale of the matrix\r\n     */\r\n    getScale() {\r\n        return vec(this.getScaleX(), this.getScaleY());\r\n    }\r\n    setScaleX(val) {\r\n        if (val === this._scale[0]) {\r\n            return;\r\n        }\r\n        this._scaleSignX = sign(val);\r\n        // negative scale acts like a 180 rotation, so flip\r\n        const xscale = vec(this.data[0] * this._scaleSignX, this.data[2] * this._scaleSignX).normalize();\r\n        this.data[0] = xscale.x * val;\r\n        this.data[2] = xscale.y * val;\r\n        this._scale[0] = val;\r\n    }\r\n    setScaleY(val) {\r\n        if (val === this._scale[1]) {\r\n            return;\r\n        }\r\n        this._scaleSignY = sign(val);\r\n        // negative scale acts like a 180 rotation, so flip\r\n        const yscale = vec(this.data[1] * this._scaleSignY, this.data[3] * this._scaleSignY).normalize();\r\n        this.data[1] = yscale.x * val;\r\n        this.data[3] = yscale.y * val;\r\n        this._scale[1] = val;\r\n    }\r\n    setScale(scale) {\r\n        this.setScaleX(scale.x);\r\n        this.setScaleY(scale.y);\r\n    }\r\n    isIdentity() {\r\n        return (this.data[0] === 1 &&\r\n            this.data[1] === 0 &&\r\n            this.data[2] === 0 &&\r\n            this.data[3] === 1 &&\r\n            this.data[4] === 0 &&\r\n            this.data[5] === 0);\r\n    }\r\n    /**\r\n     * Resets the current matrix to the identity matrix, mutating it\r\n     * @returns {AffineMatrix} Current matrix as identity\r\n     */\r\n    reset() {\r\n        const mat = this;\r\n        mat.data[0] = 1;\r\n        mat.data[1] = 0;\r\n        mat.data[2] = 0;\r\n        mat.data[3] = 1;\r\n        mat.data[4] = 0;\r\n        mat.data[5] = 0;\r\n        return mat;\r\n    }\r\n    /**\r\n     * Creates a new Matrix with the same data as the current 4x4\r\n     */\r\n    clone(dest) {\r\n        const mat = dest || new AffineMatrix();\r\n        mat.data[0] = this.data[0];\r\n        mat.data[1] = this.data[1];\r\n        mat.data[2] = this.data[2];\r\n        mat.data[3] = this.data[3];\r\n        mat.data[4] = this.data[4];\r\n        mat.data[5] = this.data[5];\r\n        return mat;\r\n    }\r\n    toString() {\r\n        return `\r\n[${this.data[0]} ${this.data[2]} ${this.data[4]}]\r\n[${this.data[1]} ${this.data[3]} ${this.data[5]}]\r\n[0 0 1]\r\n`;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/transform-stack.ts\n\r\nclass TransformStack {\r\n    constructor() {\r\n        this._transforms = [];\r\n        this._currentTransform = AffineMatrix.identity();\r\n    }\r\n    save() {\r\n        this._transforms.push(this._currentTransform);\r\n        this._currentTransform = this._currentTransform.clone();\r\n    }\r\n    restore() {\r\n        this._currentTransform = this._transforms.pop();\r\n    }\r\n    translate(x, y) {\r\n        return this._currentTransform.translate(x, y);\r\n    }\r\n    rotate(angle) {\r\n        return this._currentTransform.rotate(angle);\r\n    }\r\n    scale(x, y) {\r\n        return this._currentTransform.scale(x, y);\r\n    }\r\n    set current(matrix) {\r\n        this._currentTransform = matrix;\r\n    }\r\n    get current() {\r\n        return this._currentTransform;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/state-stack.ts\n\r\nclass StateStack {\r\n    constructor() {\r\n        this._states = [];\r\n        this._currentState = this._getDefaultState();\r\n    }\r\n    _getDefaultState() {\r\n        return {\r\n            opacity: 1,\r\n            z: 0,\r\n            tint: Color.White,\r\n            material: null\r\n        };\r\n    }\r\n    _cloneState() {\r\n        return {\r\n            opacity: this._currentState.opacity,\r\n            z: this._currentState.z,\r\n            tint: this._currentState.tint.clone(),\r\n            material: this._currentState.material // TODO is this going to cause problems when cloning\r\n        };\r\n    }\r\n    save() {\r\n        this._states.push(this._currentState);\r\n        this._currentState = this._cloneState();\r\n    }\r\n    restore() {\r\n        this._currentState = this._states.pop();\r\n    }\r\n    get current() {\r\n        return this._currentState;\r\n    }\r\n    set current(val) {\r\n        this._currentState = val;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Resources/Resource.ts\n\r\n\r\nconst ResourceEvents = {\r\n    Complete: 'complete',\r\n    Load: 'load',\r\n    LoadStart: 'loadstart',\r\n    Progress: 'progress',\r\n    Error: 'error'\r\n};\r\n/**\r\n * The [[Resource]] type allows games built in Excalibur to load generic resources.\r\n * For any type of remote resource it is recommended to use [[Resource]] for preloading.\r\n */\r\nclass Resource {\r\n    /**\r\n     * @param path          Path to the remote resource\r\n     * @param responseType  The type to expect as a response: \"\" | \"arraybuffer\" | \"blob\" | \"document\" | \"json\" | \"text\";\r\n     * @param bustCache     Whether or not to cache-bust requests\r\n     */\r\n    constructor(path, responseType, bustCache = false) {\r\n        this.path = path;\r\n        this.responseType = responseType;\r\n        this.bustCache = bustCache;\r\n        this.data = null;\r\n        this.logger = Logger.getInstance();\r\n        this.events = new EventEmitter();\r\n    }\r\n    /**\r\n     * Returns true if the Resource is completely loaded and is ready\r\n     * to be drawn.\r\n     */\r\n    isLoaded() {\r\n        return this.data !== null;\r\n    }\r\n    _cacheBust(uri) {\r\n        const query = /\\?\\w*=\\w*/;\r\n        if (query.test(uri)) {\r\n            uri += '&__=' + Date.now();\r\n        }\r\n        else {\r\n            uri += '?__=' + Date.now();\r\n        }\r\n        return uri;\r\n    }\r\n    /**\r\n     * Begin loading the resource and returns a promise to be resolved on completion\r\n     */\r\n    load() {\r\n        return new Promise((resolve, reject) => {\r\n            // Exit early if we already have data\r\n            if (this.data !== null) {\r\n                this.logger.debug('Already have data for resource', this.path);\r\n                this.events.emit('complete', this.data);\r\n                resolve(this.data);\r\n                return;\r\n            }\r\n            const request = new XMLHttpRequest();\r\n            request.open('GET', this.bustCache ? this._cacheBust(this.path) : this.path, true);\r\n            request.responseType = this.responseType;\r\n            request.addEventListener('loadstart', (e) => this.events.emit('loadstart', e));\r\n            request.addEventListener('progress', (e) => this.events.emit('progress', e));\r\n            request.addEventListener('error', (e) => this.events.emit('error', e));\r\n            request.addEventListener('load', (e) => this.events.emit('load', e));\r\n            request.addEventListener('load', () => {\r\n                // XHR on file:// success status is 0, such as with PhantomJS\r\n                if (request.status !== 0 && request.status !== 200) {\r\n                    this.logger.error('Failed to load resource ', this.path, ' server responded with error code', request.status);\r\n                    this.events.emit('error', request.response);\r\n                    reject(new Error(request.statusText));\r\n                    return;\r\n                }\r\n                this.data = request.response;\r\n                this.events.emit('complete', this.data);\r\n                this.logger.debug('Completed loading resource', this.path);\r\n                resolve(this.data);\r\n            });\r\n            request.send();\r\n        });\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Watch.ts\n/**\r\n * Watch an object with a proxy, only fires if property value is different\r\n */\r\nfunction watch(type, change) {\r\n    if (!type) {\r\n        return type;\r\n    }\r\n    if (type.__isProxy === undefined) {\r\n        // expando hack to mark a proxy\r\n        return new Proxy(type, {\r\n            set: (obj, prop, value) => {\r\n                // The default behavior to store the value\r\n                if (obj[prop] !== value) {\r\n                    obj[prop] = value;\r\n                    // Avoid watching private junk\r\n                    if (typeof prop === 'string') {\r\n                        if (prop[0] !== '_') {\r\n                            change(obj);\r\n                        }\r\n                    }\r\n                }\r\n                // Indicate success\r\n                return true;\r\n            },\r\n            get: (obj, prop) => {\r\n                if (prop !== '__isProxy') {\r\n                    return obj[prop];\r\n                }\r\n                return true;\r\n            }\r\n        });\r\n    }\r\n    return type;\r\n}\r\n/**\r\n * Watch an object with a proxy, fires change on any property value change\r\n */\r\nfunction watchAny(type, change) {\r\n    if (!type) {\r\n        return type;\r\n    }\r\n    if (type.__isProxy === undefined) {\r\n        // expando hack to mark a proxy\r\n        return new Proxy(type, {\r\n            set: (obj, prop, value) => {\r\n                // The default behavior to store the value\r\n                obj[prop] = value;\r\n                // Avoid watching private junk\r\n                if (typeof prop === 'string') {\r\n                    if (prop[0] !== '_') {\r\n                        change(obj);\r\n                    }\r\n                }\r\n                // Indicate success\r\n                return true;\r\n            },\r\n            get: (obj, prop) => {\r\n                if (prop !== '__isProxy') {\r\n                    return obj[prop];\r\n                }\r\n                return true;\r\n            }\r\n        });\r\n    }\r\n    return type;\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Graphic.ts\n\r\n\r\n\r\n\r\n/**\r\n * A Graphic is the base Excalibur primitive for something that can be drawn to the [[ExcaliburGraphicsContext]].\r\n * [[Sprite]], [[Animation]], [[GraphicsGroup]], [[Canvas]], [[Rectangle]], [[Circle]], and [[Polygon]] all derive from the\r\n * [[Graphic]] abstract class.\r\n *\r\n * Implementors of a Graphic must override the abstract [[Graphic._drawImage]] method to render an image to the graphics context. Graphic\r\n * handles all the position, rotation, and scale transformations in [[Graphic._preDraw]] and [[Graphic._postDraw]]\r\n */\r\nclass Graphic {\r\n    isStale() {\r\n        return this._transformStale;\r\n    }\r\n    /**\r\n     * Gets or sets the flipHorizontal, which will flip the graphic horizontally (across the y axis)\r\n     */\r\n    get flipHorizontal() {\r\n        return this._flipHorizontal;\r\n    }\r\n    set flipHorizontal(value) {\r\n        this._flipHorizontal = value;\r\n        this._transformStale = true;\r\n    }\r\n    /**\r\n     * Gets or sets the flipVertical, which will flip the graphic vertically (across the x axis)\r\n     */\r\n    get flipVertical() {\r\n        return this._flipVertical;\r\n    }\r\n    set flipVertical(value) {\r\n        this._flipVertical = value;\r\n        this._transformStale = true;\r\n    }\r\n    /**\r\n     * Gets or sets the rotation of the graphic\r\n     */\r\n    get rotation() {\r\n        return this._rotation;\r\n    }\r\n    set rotation(value) {\r\n        this._rotation = value;\r\n        this._transformStale = true;\r\n    }\r\n    /**\r\n     * Gets or sets the scale of the graphic, this affects the width and\r\n     */\r\n    get scale() {\r\n        return this._scale;\r\n    }\r\n    set scale(value) {\r\n        this._scale = watch(value, () => {\r\n            this._transformStale = true;\r\n        });\r\n        this._transformStale = true;\r\n    }\r\n    /**\r\n     * Gets or sets the origin of the graphic, if not set the center of the graphic is the origin\r\n     */\r\n    get origin() {\r\n        return this._origin;\r\n    }\r\n    set origin(value) {\r\n        this._origin = watch(value, () => {\r\n            this._transformStale = true;\r\n        });\r\n        this._transformStale = true;\r\n    }\r\n    constructor(options) {\r\n        var _a, _b, _c, _d, _e, _f;\r\n        this.id = Graphic._ID++;\r\n        this.transform = AffineMatrix.identity();\r\n        this.tint = null;\r\n        this._transformStale = true;\r\n        /**\r\n         * Gets or sets wether to show debug information about the graphic\r\n         */\r\n        this.showDebug = false;\r\n        this._flipHorizontal = false;\r\n        this._flipVertical = false;\r\n        this._rotation = 0;\r\n        /**\r\n         * Gets or sets the opacity of the graphic, 0 is transparent, 1 is solid (opaque).\r\n         */\r\n        this.opacity = 1;\r\n        this._scale = Vector.One;\r\n        this._origin = null;\r\n        this._width = 0;\r\n        this._height = 0;\r\n        if (options) {\r\n            this.origin = (_a = options.origin) !== null && _a !== void 0 ? _a : this.origin;\r\n            this.flipHorizontal = (_b = options.flipHorizontal) !== null && _b !== void 0 ? _b : this.flipHorizontal;\r\n            this.flipVertical = (_c = options.flipVertical) !== null && _c !== void 0 ? _c : this.flipVertical;\r\n            this.rotation = (_d = options.rotation) !== null && _d !== void 0 ? _d : this.rotation;\r\n            this.opacity = (_e = options.opacity) !== null && _e !== void 0 ? _e : this.opacity;\r\n            this.scale = (_f = options.scale) !== null && _f !== void 0 ? _f : this.scale;\r\n        }\r\n    }\r\n    cloneGraphicOptions() {\r\n        return {\r\n            origin: this.origin ? this.origin.clone() : null,\r\n            flipHorizontal: this.flipHorizontal,\r\n            flipVertical: this.flipVertical,\r\n            rotation: this.rotation,\r\n            opacity: this.opacity,\r\n            scale: this.scale ? this.scale.clone() : null\r\n        };\r\n    }\r\n    /**\r\n     * Gets or sets the width of the graphic (always positive)\r\n     */\r\n    get width() {\r\n        return Math.abs(this._width * this.scale.x);\r\n    }\r\n    /**\r\n     * Gets or sets the height of the graphic (always positive)\r\n     */\r\n    get height() {\r\n        return Math.abs(this._height * this.scale.y);\r\n    }\r\n    set width(value) {\r\n        this._width = value;\r\n        this._transformStale = true;\r\n    }\r\n    set height(value) {\r\n        this._height = value;\r\n        this._transformStale = true;\r\n    }\r\n    /**\r\n     * Gets a copy of the bounds in pixels occupied by the graphic on the the screen. This includes scale.\r\n     */\r\n    get localBounds() {\r\n        return BoundingBox.fromDimension(this.width, this.height, Vector.Zero);\r\n    }\r\n    /**\r\n     * Draw the whole graphic to the context including transform\r\n     * @param ex The excalibur graphics context\r\n     * @param x\r\n     * @param y\r\n     */\r\n    draw(ex, x, y) {\r\n        this._preDraw(ex, x, y);\r\n        this._drawImage(ex, 0, 0);\r\n        this._postDraw(ex);\r\n    }\r\n    /**\r\n     * Apply affine transformations to the graphics context to manipulate the graphic before [[Graphic._drawImage]]\r\n     * @param ex\r\n     * @param x\r\n     * @param y\r\n     */\r\n    _preDraw(ex, x, y) {\r\n        ex.save();\r\n        ex.translate(x, y);\r\n        if (this._transformStale) {\r\n            this.transform.reset();\r\n            this.transform.scale(Math.abs(this.scale.x), Math.abs(this.scale.y));\r\n            this._rotate(this.transform);\r\n            this._flip(this.transform);\r\n            this._transformStale = false;\r\n        }\r\n        ex.multiply(this.transform);\r\n        // it is important to multiply alphas so graphics respect the current context\r\n        ex.opacity = ex.opacity * this.opacity;\r\n        if (this.tint) {\r\n            ex.tint = this.tint;\r\n        }\r\n    }\r\n    _rotate(ex) {\r\n        var _a;\r\n        const scaleDirX = this.scale.x > 0 ? 1 : -1;\r\n        const scaleDirY = this.scale.y > 0 ? 1 : -1;\r\n        const origin = (_a = this.origin) !== null && _a !== void 0 ? _a : vec(this.width / 2, this.height / 2);\r\n        ex.translate(origin.x, origin.y);\r\n        ex.rotate(this.rotation);\r\n        // This is for handling direction changes 1 or -1, that way we don't have mismatched translates()\r\n        ex.scale(scaleDirX, scaleDirY);\r\n        ex.translate(-origin.x, -origin.y);\r\n    }\r\n    _flip(ex) {\r\n        if (this.flipHorizontal) {\r\n            ex.translate(this.width / this.scale.x, 0);\r\n            ex.scale(-1, 1);\r\n        }\r\n        if (this.flipVertical) {\r\n            ex.translate(0, this.height / this.scale.y);\r\n            ex.scale(1, -1);\r\n        }\r\n    }\r\n    /**\r\n     * Apply any additional work after [[Graphic._drawImage]] and restore the context state.\r\n     * @param ex\r\n     */\r\n    _postDraw(ex) {\r\n        if (this.showDebug) {\r\n            ex.debug.drawRect(0, 0, this.width, this.height);\r\n        }\r\n        ex.restore();\r\n    }\r\n}\r\nGraphic._ID = 0;\r\n\n;// CONCATENATED MODULE: ./Graphics/Sprite.ts\n\r\n\r\nclass Sprite extends Graphic {\r\n    static from(image) {\r\n        return new Sprite({\r\n            image: image\r\n        });\r\n    }\r\n    constructor(options) {\r\n        var _a, _b;\r\n        super(options);\r\n        this._logger = Logger.getInstance();\r\n        this._dirty = true;\r\n        this._logNotLoadedWarning = false;\r\n        this.image = options.image;\r\n        const { width, height } = options;\r\n        this.sourceView = (_a = options.sourceView) !== null && _a !== void 0 ? _a : { x: 0, y: 0, width: width !== null && width !== void 0 ? width : 0, height: height !== null && height !== void 0 ? height : 0 };\r\n        this.destSize = (_b = options.destSize) !== null && _b !== void 0 ? _b : { width: width !== null && width !== void 0 ? width : 0, height: height !== null && height !== void 0 ? height : 0 };\r\n        this._updateSpriteDimensions();\r\n        this.image.ready.then(() => {\r\n            this._updateSpriteDimensions();\r\n        });\r\n    }\r\n    get width() {\r\n        return Math.abs(this.destSize.width * this.scale.x);\r\n    }\r\n    get height() {\r\n        return Math.abs(this.destSize.height * this.scale.y);\r\n    }\r\n    set width(newWidth) {\r\n        newWidth /= Math.abs(this.scale.x);\r\n        this.destSize.width = newWidth;\r\n        super.width = Math.ceil(this.destSize.width);\r\n    }\r\n    set height(newHeight) {\r\n        newHeight /= Math.abs(this.scale.y);\r\n        this.destSize.height = newHeight;\r\n        super.height = Math.ceil(this.destSize.height);\r\n    }\r\n    _updateSpriteDimensions() {\r\n        var _a, _b, _c, _d, _e, _f;\r\n        const { width: nativeWidth, height: nativeHeight } = this.image;\r\n        // This code uses || to avoid 0's\r\n        // If the source is not specified, use the native dimension\r\n        this.sourceView.width = ((_a = this.sourceView) === null || _a === void 0 ? void 0 : _a.width) || nativeWidth;\r\n        this.sourceView.height = ((_b = this.sourceView) === null || _b === void 0 ? void 0 : _b.height) || nativeHeight;\r\n        // If the destination is not specified, use the source if specified, then native\r\n        this.destSize.width = ((_c = this.destSize) === null || _c === void 0 ? void 0 : _c.width) || ((_d = this.sourceView) === null || _d === void 0 ? void 0 : _d.width) || nativeWidth;\r\n        this.destSize.height = ((_e = this.destSize) === null || _e === void 0 ? void 0 : _e.height) || ((_f = this.sourceView) === null || _f === void 0 ? void 0 : _f.height) || nativeHeight;\r\n        this.width = Math.ceil(this.destSize.width) * this.scale.x;\r\n        this.height = Math.ceil(this.destSize.height) * this.scale.y;\r\n    }\r\n    _preDraw(ex, x, y) {\r\n        if (this.image.isLoaded() && this._dirty) {\r\n            this._dirty = false;\r\n            this._updateSpriteDimensions();\r\n        }\r\n        super._preDraw(ex, x, y);\r\n    }\r\n    _drawImage(ex, x, y) {\r\n        if (this.image.isLoaded()) {\r\n            ex.drawImage(this.image.image, this.sourceView.x, this.sourceView.y, this.sourceView.width, this.sourceView.height, x, y, this.destSize.width, this.destSize.height);\r\n        }\r\n        else {\r\n            if (!this._logNotLoadedWarning) {\r\n                this._logger.warn(`ImageSource ${this.image.path}` +\r\n                    ` is not yet loaded and won't be drawn. Please call .load() or include in a Loader.\\n\\n` +\r\n                    `Read https://excaliburjs.com/docs/imagesource for more information.`);\r\n            }\r\n            this._logNotLoadedWarning = true;\r\n        }\r\n    }\r\n    clone() {\r\n        return new Sprite({\r\n            image: this.image,\r\n            sourceView: { ...this.sourceView },\r\n            destSize: { ...this.destSize },\r\n            ...this.cloneGraphicOptions()\r\n        });\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Filtering.ts\n/**\r\n * Describes the different image filtering modes\r\n */\r\nvar ImageFiltering;\r\n(function (ImageFiltering) {\r\n    /**\r\n     * Pixel is useful when you do not want smoothing aka antialiasing applied to your graphics.\r\n     *\r\n     * Useful for Pixel art aesthetics.\r\n     */\r\n    ImageFiltering[\"Pixel\"] = \"Pixel\";\r\n    /**\r\n     * Blended is useful when you have high resolution artwork and would like it blended and smoothed\r\n     */\r\n    ImageFiltering[\"Blended\"] = \"Blended\";\r\n})(ImageFiltering || (ImageFiltering = {}));\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/texture-loader.ts\n\r\n\r\n/**\r\n * Manages loading image sources into webgl textures, a unique id is associated with all sources\r\n */\r\nclass TextureLoader {\r\n    constructor(gl) {\r\n        this._textureMap = new Map();\r\n        this._gl = gl;\r\n        TextureLoader._MAX_TEXTURE_SIZE = gl.getParameter(gl.MAX_TEXTURE_SIZE);\r\n    }\r\n    /**\r\n     * Get the WebGL Texture from a source image\r\n     * @param image\r\n     */\r\n    get(image) {\r\n        return this._textureMap.get(image);\r\n    }\r\n    /**\r\n     * Returns whether a source image has been loaded as a texture\r\n     * @param image\r\n     */\r\n    has(image) {\r\n        return this._textureMap.has(image);\r\n    }\r\n    /**\r\n     * Loads a graphic into webgl and returns it's texture info, a webgl context must be previously registered\r\n     * @param image Source graphic\r\n     * @param filtering {ImageFiltering} The ImageFiltering mode to apply to the loaded texture\r\n     * @param forceUpdate Optionally force a texture to be reloaded, useful if the source graphic has changed\r\n     */\r\n    load(image, filtering, forceUpdate = false) {\r\n        // Ignore loading if webgl is not registered\r\n        const gl = this._gl;\r\n        if (!gl) {\r\n            return null;\r\n        }\r\n        let tex = null;\r\n        // If reuse the texture if it's from the same source\r\n        if (this.has(image)) {\r\n            tex = this.get(image);\r\n        }\r\n        // Update existing webgl texture and return early\r\n        if (tex) {\r\n            if (forceUpdate) {\r\n                gl.bindTexture(gl.TEXTURE_2D, tex);\r\n                gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, image);\r\n            }\r\n            return tex;\r\n        }\r\n        // No texture exists create a new one\r\n        tex = gl.createTexture();\r\n        TextureLoader.checkImageSizeSupportedAndLog(image);\r\n        gl.bindTexture(gl.TEXTURE_2D, tex);\r\n        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n        // NEAREST for pixel art, LINEAR for hi-res\r\n        const filterMode = filtering !== null && filtering !== void 0 ? filtering : TextureLoader.filtering;\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, filterMode === ImageFiltering.Pixel ? gl.NEAREST : gl.LINEAR);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, filterMode === ImageFiltering.Pixel ? gl.NEAREST : gl.LINEAR);\r\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, image);\r\n        this._textureMap.set(image, tex);\r\n        return tex;\r\n    }\r\n    delete(image) {\r\n        // Ignore loading if webgl is not registered\r\n        const gl = this._gl;\r\n        if (!gl) {\r\n            return null;\r\n        }\r\n        let tex = null;\r\n        if (this.has(image)) {\r\n            tex = this.get(image);\r\n            gl.deleteTexture(tex);\r\n        }\r\n    }\r\n    /**\r\n     * Takes an image and returns if it meets size criteria for hardware\r\n     * @param image\r\n     * @returns if the image will be supported at runtime\r\n     */\r\n    static checkImageSizeSupportedAndLog(image) {\r\n        var _a;\r\n        const originalSrc = (_a = image.dataset.originalSrc) !== null && _a !== void 0 ? _a : 'internal canvas bitmap';\r\n        if (image.width > TextureLoader._MAX_TEXTURE_SIZE || image.height > TextureLoader._MAX_TEXTURE_SIZE) {\r\n            TextureLoader._LOGGER.error(`The image [${originalSrc}] provided to Excalibur is too large for the device's maximum texture size of ` +\r\n                `(${TextureLoader._MAX_TEXTURE_SIZE}x${TextureLoader._MAX_TEXTURE_SIZE}) please resize to an image `\r\n                + `for excalibur to render properly.\\n\\nImages will likely render as black rectangles.\\n\\n` +\r\n                `Read more here: https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices#understand_system_limits`);\r\n            return false;\r\n        }\r\n        else if (image.width > 4096 || image.height > 4096) {\r\n            // https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices#understand_system_limits\r\n            TextureLoader._LOGGER.warn(`The image [${originalSrc}] provided to excalibur is too large may not work on all mobile devices, ` +\r\n                `it is recommended you resize images to a maximum (4096x4096).\\n\\n` +\r\n                `Images will likely render as black rectangles on some mobile platforms.\\n\\n` +\r\n                `Read more here: https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices#understand_system_limits`);\r\n        }\r\n        return true;\r\n    }\r\n}\r\nTextureLoader._LOGGER = Logger.getInstance();\r\n/**\r\n * Sets the default filtering for the Excalibur texture loader, default [[ImageFiltering.Blended]]\r\n */\r\nTextureLoader.filtering = ImageFiltering.Blended;\r\nTextureLoader._MAX_TEXTURE_SIZE = 4096;\r\n\n;// CONCATENATED MODULE: ./Graphics/ImageSource.ts\n\r\n\r\n\r\n\r\n\r\nclass ImageSource {\r\n    /**\r\n     * The original size of the source image in pixels\r\n     */\r\n    get width() {\r\n        return this.image.naturalWidth;\r\n    }\r\n    /**\r\n     * The original height of the source image in pixels\r\n     */\r\n    get height() {\r\n        return this.image.naturalHeight;\r\n    }\r\n    /**\r\n     * Returns true if the Texture is completely loaded and is ready\r\n     * to be drawn.\r\n     */\r\n    isLoaded() {\r\n        if (!this._src) {\r\n            // this boosts speed of access\r\n            this._src = this.data.src;\r\n        }\r\n        return !!this._src;\r\n    }\r\n    get image() {\r\n        return this.data;\r\n    }\r\n    /**\r\n     * The path to the image, can also be a data url like 'data:image/'\r\n     * @param path {string} Path to the image resource relative from the HTML document hosting the game, or absolute\r\n     * @param bustCache {boolean} Should excalibur add a cache busting querystring?\r\n     * @param filtering {ImageFiltering} Optionally override the image filtering set by [[EngineOptions.antialiasing]]\r\n     */\r\n    constructor(path, bustCache = false, filtering) {\r\n        this.path = path;\r\n        this._logger = Logger.getInstance();\r\n        /**\r\n         * Access to the underlying html image element\r\n         */\r\n        this.data = new Image();\r\n        this._readyFuture = new Future();\r\n        /**\r\n         * Promise the resolves when the image is loaded and ready for use, does not initiate loading\r\n         */\r\n        this.ready = this._readyFuture.promise;\r\n        this._resource = new Resource(path, 'blob', bustCache);\r\n        this.filtering = filtering;\r\n        if (path.endsWith('.svg') || path.endsWith('.gif')) {\r\n            this._logger.warn(`Image type is not fully supported, you may have mixed results ${path}. Fully supported: jpg, bmp, and png`);\r\n        }\r\n    }\r\n    /**\r\n     * Should excalibur add a cache busting querystring? By default false.\r\n     * Must be set before loading\r\n     */\r\n    get bustCache() {\r\n        return this._resource.bustCache;\r\n    }\r\n    set bustCache(val) {\r\n        this._resource.bustCache = val;\r\n    }\r\n    /**\r\n     * Begins loading the image and returns a promise that resolves when the image is loaded\r\n     */\r\n    async load() {\r\n        if (this.isLoaded()) {\r\n            return this.data;\r\n        }\r\n        try {\r\n            // Load base64 or blob if needed\r\n            let url;\r\n            if (!this.path.includes('data:image/')) {\r\n                const blob = await this._resource.load();\r\n                url = URL.createObjectURL(blob);\r\n            }\r\n            else {\r\n                url = this.path;\r\n            }\r\n            // Decode the image\r\n            const image = new Image();\r\n            // Use Image.onload over Image.decode()\r\n            // https://bugs.chromium.org/p/chromium/issues/detail?id=1055828#c7\r\n            // Otherwise chrome will throw still Image.decode() failures for large textures\r\n            const loadedFuture = new Future();\r\n            image.onload = () => loadedFuture.resolve();\r\n            image.src = url;\r\n            image.setAttribute('data-original-src', this.path);\r\n            await loadedFuture.promise;\r\n            // Set results\r\n            // We defer loading the texture into webgl until the first draw that way we avoid a singleton\r\n            // and for the multi-engine case the texture needs to be created in EACH webgl context to work\r\n            // See image-renderer.ts draw()\r\n            this.data = image;\r\n            // emit warning if potentially too big\r\n            TextureLoader.checkImageSizeSupportedAndLog(this.data);\r\n        }\r\n        catch (error) {\r\n            throw `Error loading ImageSource from path '${this.path}' with error [${error.message}]`;\r\n        }\r\n        // Do a bad thing to pass the filtering as an attribute\r\n        this.data.setAttribute('filtering', this.filtering);\r\n        // todo emit complete\r\n        this._readyFuture.resolve(this.data);\r\n        return this.data;\r\n    }\r\n    /**\r\n     * Build a sprite from this ImageSource\r\n     */\r\n    toSprite() {\r\n        return Sprite.from(this);\r\n    }\r\n    /**\r\n     * Unload images from memory\r\n     */\r\n    unload() {\r\n        this.data = new Image();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/SpriteSheet.ts\n\r\n\r\n/**\r\n * Represents a collection of sprites from a source image with some organization in a grid\r\n */\r\nclass SpriteSheet {\r\n    /**\r\n     * Build a new sprite sheet from a list of sprites\r\n     *\r\n     * Use [[SpriteSheet.fromImageSource]] to create a SpriteSheet from an [[ImageSource]] organized in a grid\r\n     * @param options\r\n     */\r\n    constructor(options) {\r\n        this._logger = Logger.getInstance();\r\n        this.sprites = [];\r\n        const { sprites, rows, columns } = options;\r\n        this.sprites = sprites;\r\n        this.rows = rows !== null && rows !== void 0 ? rows : 1;\r\n        this.columns = columns !== null && columns !== void 0 ? columns : this.sprites.length;\r\n    }\r\n    /**\r\n     * Find a sprite by their x/y position in the SpriteSheet, for example `getSprite(0, 0)` is the [[Sprite]] in the top-left\r\n     * @param x\r\n     * @param y\r\n     */\r\n    getSprite(x, y) {\r\n        if (x >= this.columns || x < 0) {\r\n            this._logger.warn(`No sprite exists in the SpriteSheet at (${x}, ${y}), x: ${x} should be between 0 and ${this.columns - 1}`);\r\n            return null;\r\n        }\r\n        if (y >= this.rows || y < 0) {\r\n            this._logger.warn(`No sprite exists in the SpriteSheet at (${x}, ${y}), y: ${y} should be between 0 and ${this.rows - 1}`);\r\n            return null;\r\n        }\r\n        const spriteIndex = x + y * this.columns;\r\n        return this.sprites[spriteIndex];\r\n    }\r\n    /**\r\n     * Create a sprite sheet from a sparse set of [[SourceView]] rectangles\r\n     * @param options\r\n     */\r\n    static fromImageSourceWithSourceViews(options) {\r\n        const sprites = options.sourceViews.map(sourceView => {\r\n            return new Sprite({\r\n                image: options.image,\r\n                sourceView\r\n            });\r\n        });\r\n        return new SpriteSheet({ sprites });\r\n    }\r\n    /**\r\n     * Create a SpriteSheet from an [[ImageSource]] organized in a grid\r\n     *\r\n     * Example:\r\n     * ```\r\n     * const spriteSheet = SpriteSheet.fromImageSource({\r\n     *   image: imageSource,\r\n     *   grid: {\r\n     *     rows: 5,\r\n     *     columns: 2,\r\n     *     spriteWidth: 32, // pixels\r\n     *     spriteHeight: 32 // pixels\r\n     *   },\r\n     *   // Optionally specify spacing\r\n     *   spacing: {\r\n     *     // pixels from the top left to start the sprite parsing\r\n     *     originOffset: {\r\n     *       x: 5,\r\n     *       y: 5\r\n     *     },\r\n     *     // pixels between each sprite while parsing\r\n     *     margin: {\r\n     *       x: 1,\r\n     *       y: 1\r\n     *     }\r\n     *   }\r\n     * })\r\n     * ```\r\n     *\r\n     * @param options\r\n     */\r\n    static fromImageSource(options) {\r\n        var _a;\r\n        const sprites = [];\r\n        options.spacing = (_a = options.spacing) !== null && _a !== void 0 ? _a : {};\r\n        const { image, grid: { rows, columns: cols, spriteWidth, spriteHeight }, spacing: { originOffset, margin } } = options;\r\n        const offsetDefaults = { x: 0, y: 0, ...originOffset };\r\n        const marginDefaults = { x: 0, y: 0, ...margin };\r\n        for (let x = 0; x < cols; x++) {\r\n            for (let y = 0; y < rows; y++) {\r\n                sprites[x + y * cols] = new Sprite({\r\n                    image: image,\r\n                    sourceView: {\r\n                        x: x * spriteWidth + marginDefaults.x * x + offsetDefaults.x,\r\n                        y: y * spriteHeight + marginDefaults.y * y + offsetDefaults.y,\r\n                        width: spriteWidth,\r\n                        height: spriteHeight\r\n                    },\r\n                    destSize: { height: spriteHeight, width: spriteWidth }\r\n                });\r\n            }\r\n        }\r\n        return new SpriteSheet({\r\n            sprites: sprites,\r\n            rows: rows,\r\n            columns: cols\r\n        });\r\n    }\r\n    clone() {\r\n        return new SpriteSheet({\r\n            sprites: this.sprites.map(sprite => sprite.clone()),\r\n            rows: this.rows,\r\n            columns: this.columns\r\n        });\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/SpriteFont.ts\n\r\n\r\n\r\n\r\nclass SpriteFont extends Graphic {\r\n    constructor(options) {\r\n        super(options);\r\n        this._text = '';\r\n        this.alphabet = '';\r\n        this.shadow = null;\r\n        this.caseInsensitive = false;\r\n        this.spacing = 0;\r\n        this._logger = Logger.getInstance();\r\n        this._alreadyWarnedAlphabet = false;\r\n        this._alreadyWarnedSpriteSheet = false;\r\n        const { alphabet, spriteSheet, caseInsensitive, spacing, shadow } = options;\r\n        this.alphabet = alphabet;\r\n        this.spriteSheet = spriteSheet;\r\n        this.caseInsensitive = caseInsensitive !== null && caseInsensitive !== void 0 ? caseInsensitive : this.caseInsensitive;\r\n        this.spacing = spacing !== null && spacing !== void 0 ? spacing : this.spacing;\r\n        this.shadow = shadow !== null && shadow !== void 0 ? shadow : this.shadow;\r\n    }\r\n    _getCharacterSprites(text) {\r\n        const results = [];\r\n        // handle case insensitive\r\n        const textToRender = this.caseInsensitive ? text.toLocaleLowerCase() : text;\r\n        const alphabet = this.caseInsensitive ? this.alphabet.toLocaleLowerCase() : this.alphabet;\r\n        // for each letter in text\r\n        for (let letterIndex = 0; letterIndex < textToRender.length; letterIndex++) {\r\n            // find the sprite index in alphabet , if there is an error pick the first\r\n            const letter = textToRender[letterIndex];\r\n            let spriteIndex = alphabet.indexOf(letter);\r\n            if (spriteIndex === -1) {\r\n                spriteIndex = 0;\r\n                if (!this._alreadyWarnedAlphabet) {\r\n                    this._logger.warn(`SpriteFont - Cannot find letter '${letter}' in configured alphabet '${alphabet}'.`);\r\n                    this._logger.warn('There maybe be more issues in the SpriteFont configuration. No additional warnings will be logged.');\r\n                    this._alreadyWarnedAlphabet = true;\r\n                }\r\n            }\r\n            const letterSprite = this.spriteSheet.sprites[spriteIndex];\r\n            if (letterSprite) {\r\n                results.push(letterSprite);\r\n            }\r\n            else {\r\n                if (!this._alreadyWarnedSpriteSheet) {\r\n                    this._logger.warn(`SpriteFont - Cannot find sprite for '${letter}' at index '${spriteIndex}' in configured SpriteSheet`);\r\n                    this._logger.warn('There maybe be more issues in the SpriteFont configuration. No additional warnings will be logged.');\r\n                    this._alreadyWarnedSpriteSheet = true;\r\n                }\r\n            }\r\n        }\r\n        return results;\r\n    }\r\n    measureText(text, maxWidth) {\r\n        const lines = this._getLinesFromText(text, maxWidth);\r\n        const maxWidthLine = lines.reduce((a, b) => {\r\n            return a.length > b.length ? a : b;\r\n        });\r\n        const sprites = this._getCharacterSprites(maxWidthLine);\r\n        let width = 0;\r\n        let height = 0;\r\n        for (const sprite of sprites) {\r\n            width += sprite.width + this.spacing;\r\n            height = Math.max(height, sprite.height);\r\n        }\r\n        return BoundingBox.fromDimension(width, height * lines.length, Vector.Zero);\r\n    }\r\n    _drawImage(ex, x, y, maxWidth) {\r\n        let xCursor = 0;\r\n        let yCursor = 0;\r\n        let height = 0;\r\n        const lines = this._getLinesFromText(this._text, maxWidth);\r\n        for (const line of lines) {\r\n            for (const sprite of this._getCharacterSprites(line)) {\r\n                // draw it in the right spot and increase the cursor by sprite width\r\n                sprite.draw(ex, x + xCursor, y + yCursor);\r\n                xCursor += sprite.width + this.spacing;\r\n                height = Math.max(height, sprite.height);\r\n            }\r\n            xCursor = 0;\r\n            yCursor += height;\r\n        }\r\n    }\r\n    render(ex, text, _color, x, y, maxWidth) {\r\n        // SpriteFont doesn't support _color, yet...\r\n        this._text = text;\r\n        const bounds = this.measureText(text, maxWidth);\r\n        this.width = bounds.width;\r\n        this.height = bounds.height;\r\n        if (this.shadow) {\r\n            ex.save();\r\n            ex.translate(this.shadow.offset.x, this.shadow.offset.y);\r\n            this._preDraw(ex, x, y);\r\n            this._drawImage(ex, 0, 0, maxWidth);\r\n            this._postDraw(ex);\r\n            ex.restore();\r\n        }\r\n        this._preDraw(ex, x, y);\r\n        this._drawImage(ex, 0, 0, maxWidth);\r\n        this._postDraw(ex);\r\n    }\r\n    clone() {\r\n        return new SpriteFont({\r\n            alphabet: this.alphabet,\r\n            spriteSheet: this.spriteSheet,\r\n            spacing: this.spacing\r\n        });\r\n    }\r\n    _getLinesFromText(text, maxWidth) {\r\n        if (this._cachedText === text && this._cachedRenderWidth === maxWidth) {\r\n            return this._cachedLines;\r\n        }\r\n        const lines = text.split('\\n');\r\n        if (maxWidth == null) {\r\n            return lines;\r\n        }\r\n        // If the current line goes past the maxWidth, append a new line without modifying the underlying text.\r\n        for (let i = 0; i < lines.length; i++) {\r\n            let line = lines[i];\r\n            let newLine = '';\r\n            // Note: we subtract the spacing to counter the initial padding on the left side.\r\n            if (this.measureText(line).width > maxWidth) {\r\n                while (this.measureText(line).width > maxWidth) {\r\n                    newLine = line[line.length - 1] + newLine;\r\n                    line = line.slice(0, -1); // Remove last character from line\r\n                }\r\n                // Update the array with our new values\r\n                lines[i] = line;\r\n                lines[i + 1] = newLine;\r\n            }\r\n        }\r\n        this._cachedText = text;\r\n        this._cachedLines = lines;\r\n        this._cachedRenderWidth = maxWidth;\r\n        return lines;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/debug-font.png\n/* harmony default export */ const debug_font = (\"data:image/png;base64,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\");\n;// CONCATENATED MODULE: ./Graphics/Context/debug-text.ts\n\r\n\r\n/**\r\n * Internal debugtext helper\r\n */\r\nclass DebugText {\r\n    constructor() {\r\n        /**\r\n         * base64 font\r\n         */\r\n        this.fontSheet = debug_font;\r\n        this.size = 16;\r\n        this.load();\r\n    }\r\n    load() {\r\n        this._imageSource = new ImageSource(this.fontSheet);\r\n        return this._imageSource.load().then(() => {\r\n            this._spriteSheet = SpriteSheet.fromImageSource({\r\n                image: this._imageSource,\r\n                grid: {\r\n                    rows: 3,\r\n                    columns: 16,\r\n                    spriteWidth: 16,\r\n                    spriteHeight: 16\r\n                }\r\n            });\r\n            this._spriteFont = new SpriteFont({\r\n                alphabet: '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ,!\\'&.\"?-()+ ',\r\n                caseInsensitive: true,\r\n                spriteSheet: this._spriteSheet,\r\n                spacing: -6\r\n            });\r\n        });\r\n    }\r\n    /**\r\n     * Writes debug text using the built in sprint font\r\n     * @param ctx\r\n     * @param text\r\n     * @param pos\r\n     */\r\n    write(ctx, text, pos) {\r\n        if (this._imageSource.isLoaded()) {\r\n            this._spriteFont.render(ctx, text, null, pos.x, pos.y);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/render-source.ts\nclass RenderSource {\r\n    constructor(_gl, _texture) {\r\n        this._gl = _gl;\r\n        this._texture = _texture;\r\n    }\r\n    use() {\r\n        const gl = this._gl;\r\n        gl.activeTexture(gl.TEXTURE0);\r\n        gl.bindTexture(gl.TEXTURE_2D, this._texture);\r\n    }\r\n    disable() {\r\n        const gl = this._gl;\r\n        gl.bindTexture(gl.TEXTURE_2D, null);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/render-target.ts\n\r\nclass RenderTarget {\r\n    constructor(options) {\r\n        this.width = options.width;\r\n        this.height = options.height;\r\n        this._gl = options.gl;\r\n        this._setupFramebuffer();\r\n    }\r\n    setResolution(width, height) {\r\n        const gl = this._gl;\r\n        this.width = width;\r\n        this.height = height;\r\n        gl.bindTexture(gl.TEXTURE_2D, this._frameTexture);\r\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, this.width, this.height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\r\n    }\r\n    get frameBuffer() {\r\n        return this._frameBuffer;\r\n    }\r\n    get frameTexture() {\r\n        return this._frameTexture;\r\n    }\r\n    _setupFramebuffer() {\r\n        // Allocates frame buffer\r\n        const gl = this._gl;\r\n        this._frameTexture = gl.createTexture();\r\n        gl.bindTexture(gl.TEXTURE_2D, this._frameTexture);\r\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, this.width, this.height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\r\n        // set the filtering so we don't need mips\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n        // attach the texture as the first color attachment\r\n        const attachmentPoint = gl.COLOR_ATTACHMENT0;\r\n        // After this bind all draw calls will draw to this framebuffer texture\r\n        this._frameBuffer = gl.createFramebuffer();\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, this._frameBuffer);\r\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, attachmentPoint, gl.TEXTURE_2D, this._frameTexture, 0);\r\n        // Reset after initialized\r\n        this.disable();\r\n    }\r\n    toRenderSource() {\r\n        const source = new RenderSource(this._gl, this._frameTexture);\r\n        return source;\r\n    }\r\n    /**\r\n     * When called, all drawing gets redirected to this render target\r\n     */\r\n    use() {\r\n        const gl = this._gl;\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, this._frameBuffer);\r\n        // very important to set the viewport to the size of the framebuffer texture\r\n        gl.viewport(0, 0, this.width, this.height);\r\n    }\r\n    /**\r\n     * When called, all drawing is sent back to the canvas\r\n     */\r\n    disable() {\r\n        const gl = this._gl;\r\n        // passing null switches rendering back to the canvas\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n        gl.bindTexture(gl.TEXTURE_2D, null);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/line-renderer/line-vertex.glsl\n/* harmony default export */ const line_vertex = (\"#version 300 es\\r\\nin vec2 a_position;\\r\\nin vec4 a_color;\\r\\n\\r\\nout lowp vec4 v_color;\\r\\n\\r\\nuniform mat4 u_matrix;\\r\\n\\r\\nvoid main() {\\r\\n   // Set the vertex position using the ortho transform matrix\\r\\n   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\\r\\n\\r\\n   // Passthrough the color\\r\\n   v_color = a_color;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/line-renderer/line-fragment.glsl\n/* harmony default export */ const line_fragment = (\"#version 300 es\\r\\nprecision mediump float;\\r\\n\\r\\n// Color\\r\\nin lowp vec4 v_color;\\r\\n\\r\\nout vec4 fragColor;\\r\\n\\r\\nvoid main() {\\r\\n  fragColor = v_color;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/webgl-util.ts\n/**\r\n * Return the size of the GlType in bytes\r\n * @param gl\r\n * @param type\r\n */\r\nfunction getGlTypeSizeBytes(gl, type) {\r\n    switch (type) {\r\n        case gl.FLOAT:\r\n            return 4;\r\n        case gl.SHORT:\r\n            return 2;\r\n        case gl.UNSIGNED_SHORT:\r\n            return 2;\r\n        case gl.BYTE:\r\n            return 1;\r\n        case gl.UNSIGNED_BYTE:\r\n            return 1;\r\n        default:\r\n            return 1;\r\n    }\r\n}\r\n/**\r\n * Based on the type return the number of attribute components\r\n *\r\n * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/vertexAttribPointer\r\n * @param gl\r\n * @param type\r\n */\r\nfunction getAttributeComponentSize(gl, type) {\r\n    switch (type) {\r\n        case gl.LOW_FLOAT:\r\n        case gl.HIGH_FLOAT:\r\n        case gl.FLOAT:\r\n            return 1;\r\n        case gl.FLOAT_VEC2:\r\n            return 2;\r\n        case gl.FLOAT_VEC3:\r\n            return 3;\r\n        case gl.FLOAT_VEC4:\r\n            return 4;\r\n        case gl.BYTE:\r\n            return 1;\r\n        case gl.UNSIGNED_BYTE:\r\n            return 1;\r\n        case gl.UNSIGNED_SHORT:\r\n        case gl.SHORT:\r\n            return 1;\r\n        default:\r\n            return 1;\r\n    }\r\n}\r\n/**\r\n * Based on the attribute return the corresponding supported attrib pointer type\r\n * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/vertexAttribPointer\r\n *\r\n * @param gl\r\n * @param type\r\n */\r\nfunction getAttributePointerType(gl, type) {\r\n    switch (type) {\r\n        case gl.LOW_FLOAT:\r\n        case gl.HIGH_FLOAT:\r\n        case gl.FLOAT:\r\n        case gl.FLOAT_VEC2:\r\n        case gl.FLOAT_VEC3:\r\n        case gl.FLOAT_VEC4:\r\n            return gl.FLOAT;\r\n        case gl.BYTE:\r\n            return gl.BYTE;\r\n        case gl.UNSIGNED_BYTE:\r\n            return gl.UNSIGNED_BYTE;\r\n        case gl.SHORT:\r\n            return gl.SHORT;\r\n        case gl.UNSIGNED_SHORT:\r\n            return gl.UNSIGNED_SHORT;\r\n        default:\r\n            return gl.FLOAT;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/shader.ts\n\r\n\r\nclass Shader {\r\n    get compiled() {\r\n        return this._compiled;\r\n    }\r\n    /**\r\n     * Create a shader program in excalibur\r\n     * @param options specify shader vertex and fragment source\r\n     */\r\n    constructor(options) {\r\n        this._logger = Logger.getInstance();\r\n        this.uniforms = {};\r\n        this.attributes = {};\r\n        this._compiled = false;\r\n        const { gl, vertexSource, fragmentSource } = options;\r\n        this._gl = gl;\r\n        this.vertexSource = vertexSource;\r\n        this.fragmentSource = fragmentSource;\r\n    }\r\n    /**\r\n     * Binds the shader program\r\n     */\r\n    use() {\r\n        const gl = this._gl;\r\n        gl.useProgram(this.program);\r\n        Shader._ACTIVE_SHADER_INSTANCE = this;\r\n    }\r\n    isCurrentlyBound() {\r\n        return Shader._ACTIVE_SHADER_INSTANCE === this;\r\n    }\r\n    /**\r\n     * Compile the current shader against a webgl context\r\n     */\r\n    compile() {\r\n        const gl = this._gl;\r\n        const vertexShader = this._compileShader(gl, this.vertexSource, gl.VERTEX_SHADER);\r\n        const fragmentShader = this._compileShader(gl, this.fragmentSource, gl.FRAGMENT_SHADER);\r\n        this.program = this._createProgram(gl, vertexShader, fragmentShader);\r\n        const attributes = this.getAttributes();\r\n        for (const attribute of attributes) {\r\n            this.attributes[attribute.name] = attribute;\r\n        }\r\n        const uniforms = this.getUniforms();\r\n        for (const uniform of uniforms) {\r\n            this.uniforms[uniform.name] = uniform;\r\n        }\r\n        this._compiled = true;\r\n        return this.program;\r\n    }\r\n    getUniforms() {\r\n        const gl = this._gl;\r\n        const uniformCount = gl.getProgramParameter(this.program, gl.ACTIVE_UNIFORMS);\r\n        const uniforms = [];\r\n        for (let i = 0; i < uniformCount; i++) {\r\n            const uniform = gl.getActiveUniform(this.program, i);\r\n            const uniformLocation = gl.getUniformLocation(this.program, uniform.name);\r\n            uniforms.push({\r\n                name: uniform.name,\r\n                glType: uniform.type,\r\n                location: uniformLocation\r\n            });\r\n        }\r\n        return uniforms;\r\n    }\r\n    getAttributes() {\r\n        const gl = this._gl;\r\n        const attributeCount = gl.getProgramParameter(this.program, gl.ACTIVE_ATTRIBUTES);\r\n        const attributes = [];\r\n        for (let i = 0; i < attributeCount; i++) {\r\n            const attribute = gl.getActiveAttrib(this.program, i);\r\n            const attributeLocation = gl.getAttribLocation(this.program, attribute.name);\r\n            attributes.push({\r\n                name: attribute.name,\r\n                glType: getAttributePointerType(gl, attribute.type),\r\n                size: getAttributeComponentSize(gl, attribute.type),\r\n                location: attributeLocation,\r\n                normalized: false\r\n            });\r\n        }\r\n        return attributes;\r\n    }\r\n    /**\r\n     * Set a texture in a gpu texture slot\r\n     * @param slotNumber\r\n     * @param texture\r\n     */\r\n    setTexture(slotNumber, texture) {\r\n        const gl = this._gl;\r\n        gl.activeTexture(gl.TEXTURE0 + slotNumber);\r\n        gl.bindTexture(gl.TEXTURE_2D, texture);\r\n    }\r\n    /**\r\n     * Set an integer uniform for the current shader\r\n     *\r\n     * **Important** Must call ex.Shader.use() before setting a uniform!\r\n     *\r\n     * @param name\r\n     * @param value\r\n     */\r\n    setUniformInt(name, value) {\r\n        this.setUniform('uniform1i', name, ~~value);\r\n    }\r\n    /**\r\n     * Set an integer uniform for the current shader, WILL NOT THROW on error.\r\n     *\r\n     * **Important** Must call ex.Shader.use() before setting a uniform!\r\n     *\r\n     * @param name\r\n     * @param value\r\n     */\r\n    trySetUniformInt(name, value) {\r\n        return this.trySetUniform('uniform1i', name, ~~value);\r\n    }\r\n    /**\r\n     * Set an integer array uniform for the current shader\r\n     *\r\n     * **Important** Must call ex.Shader.use() before setting a uniform!\r\n     *\r\n     * @param name\r\n     * @param value\r\n     */\r\n    setUniformIntArray(name, value) {\r\n        this.setUniform('uniform1iv', name, value);\r\n    }\r\n    /**\r\n     * Set an integer array uniform for the current shader, WILL NOT THROW on error.\r\n     *\r\n     * **Important** Must call ex.Shader.use() before setting a uniform!\r\n     *\r\n     * @param name\r\n     * @param value\r\n     */\r\n    trySetUniformIntArray(name, value) {\r\n        return this.trySetUniform('uniform1iv', name, value);\r\n    }\r\n    /**\r\n     * Set a boolean uniform for the current shader\r\n     *\r\n     * **Important** Must call ex.Shader.use() before setting a uniform!\r\n     *\r\n     * @param name\r\n     * @param value\r\n     */\r\n    setUniformBoolean(name, value) {\r\n        this.setUniform('uniform1i', name, value ? 1 : 0);\r\n    }\r\n    /**\r\n     * Set a boolean uniform for the current shader, WILL NOT THROW on error.\r\n     *\r\n     * **Important** Must call ex.Shader.use() before setting a uniform!\r\n     *\r\n     * @param name\r\n     * @param value\r\n     */\r\n    trySetUniformBoolean(name, value) {\r\n        return this.trySetUniform('uniform1i', name, value ? 1 : 0);\r\n    }\r\n    /**\r\n     * Set a float uniform for the current shader\r\n     *\r\n     * **Important** Must call ex.Shader.use() before setting a uniform!\r\n     *\r\n     * @param name\r\n     * @param value\r\n     */\r\n    setUniformFloat(name, value) {\r\n        this.setUniform('uniform1f', name, value);\r\n    }\r\n    /**\r\n     * Set a float uniform for the current shader, WILL NOT THROW on error.\r\n     *\r\n     * **Important** Must call ex.Shader.use() before setting a uniform!\r\n     *\r\n     * @param name\r\n     * @param value\r\n     */\r\n    trySetUniformFloat(name, value) {\r\n        return this.trySetUniform('uniform1f', name, value);\r\n    }\r\n    /**\r\n     * Set a float array uniform for the current shader\r\n     *\r\n     * **Important** Must call ex.Shader.use() before setting a uniform!\r\n     *\r\n     * @param name\r\n     * @param value\r\n     */\r\n    setUniformFloatArray(name, value) {\r\n        this.setUniform('uniform1fv', name, value);\r\n    }\r\n    /**\r\n     * Set a float array uniform for the current shader, WILL NOT THROW on error.\r\n     *\r\n     * **Important** Must call ex.Shader.use() before setting a uniform!\r\n     *\r\n     * @param name\r\n     * @param value\r\n     */\r\n    trySetUniformFloatArray(name, value) {\r\n        return this.trySetUniform('uniform1fv', name, value);\r\n    }\r\n    /**\r\n     * Set a [[Vector]] uniform for the current shader\r\n     *\r\n     * **Important** Must call ex.Shader.use() before setting a uniform!\r\n     *\r\n     * @param name\r\n     * @param value\r\n     */\r\n    setUniformFloatVector(name, value) {\r\n        this.setUniform('uniform2f', name, value.x, value.y);\r\n    }\r\n    /**\r\n     * Set a [[Vector]] uniform for the current shader, WILL NOT THROW on error.\r\n     *\r\n     * **Important** Must call ex.Shader.use() before setting a uniform!\r\n     *\r\n     * @param name\r\n     * @param value\r\n     */\r\n    trySetUniformFloatVector(name, value) {\r\n        return this.trySetUniform('uniform2f', name, value.x, value.y);\r\n    }\r\n    /**\r\n     * Set a [[Color]] uniform for the current shader\r\n     *\r\n     * **Important** Must call ex.Shader.use() before setting a uniform!\r\n     *\r\n     * @param name\r\n     * @param value\r\n     */\r\n    setUniformFloatColor(name, value) {\r\n        this.setUniform('uniform4f', name, value.r / 255, value.g / 255, value.b / 255, value.a);\r\n    }\r\n    /**\r\n     * Set a [[Color]] uniform for the current shader, WILL NOT THROW on error.\r\n     *\r\n     * **Important** Must call ex.Shader.use() before setting a uniform!\r\n     *\r\n     * @param name\r\n     * @param value\r\n     */\r\n    trySetUniformFloatColor(name, value) {\r\n        return this.trySetUniform('uniform4f', name, value.r / 255, value.g / 255, value.b / 255, value.a);\r\n    }\r\n    /**\r\n     * Set an [[Matrix]] uniform for the current shader\r\n     *\r\n     * **Important** Must call ex.Shader.use() before setting a uniform!\r\n     *\r\n     * @param name\r\n     * @param value\r\n     */\r\n    setUniformMatrix(name, value) {\r\n        this.setUniform('uniformMatrix4fv', name, false, value.data);\r\n    }\r\n    /**\r\n     * Set an [[Matrix]] uniform for the current shader, WILL NOT THROW on error.\r\n     *\r\n     * **Important** Must call ex.Shader.use() before setting a uniform!\r\n     *\r\n     * @param name\r\n     * @param value\r\n     */\r\n    trySetUniformMatrix(name, value) {\r\n        return this.trySetUniform('uniformMatrix4fv', name, false, value.data);\r\n    }\r\n    /**\r\n     * Set any available uniform type in webgl\r\n     *\r\n     * For example setUniform('uniformMatrix2fv', 'u_my2x2_mat`, ...);\r\n     */\r\n    setUniform(uniformType, name, ...value) {\r\n        if (!this._compiled) {\r\n            throw Error(`Must compile shader before setting a uniform ${uniformType}:${name}`);\r\n        }\r\n        if (!this.isCurrentlyBound()) {\r\n            throw Error('Currently accessed shader instance is not the current active shader in WebGL,' +\r\n                ' must call `shader.use()` before setting uniforms');\r\n        }\r\n        const gl = this._gl;\r\n        const location = gl.getUniformLocation(this.program, name);\r\n        if (location) {\r\n            const args = [location, ...value];\r\n            this._gl[uniformType].apply(this._gl, args);\r\n        }\r\n        else {\r\n            throw Error(`Uniform ${uniformType}:${name} doesn\\'t exist or is not used in the shader source code,` +\r\n                ' unused uniforms are optimized away by most browsers');\r\n        }\r\n    }\r\n    /**\r\n     * Set any available uniform type in webgl. Will try to set the uniform, will return false if the uniform didn't exist,\r\n     * true if it was set.\r\n     *\r\n     * WILL NOT THROW on error\r\n     *\r\n     * For example setUniform('uniformMatrix2fv', 'u_my2x2_mat`, ...);\r\n     *\r\n     */\r\n    trySetUniform(uniformType, name, ...value) {\r\n        if (!this._compiled) {\r\n            this._logger.warn(`Must compile shader before setting a uniform ${uniformType}:${name}`);\r\n            return false;\r\n        }\r\n        if (!this.isCurrentlyBound()) {\r\n            this._logger.warn('Currently accessed shader instance is not the current active shader in WebGL,' +\r\n                ' must call `shader.use()` before setting uniforms');\r\n            return false;\r\n        }\r\n        const gl = this._gl;\r\n        const location = gl.getUniformLocation(this.program, name);\r\n        if (location) {\r\n            const args = [location, ...value];\r\n            this._gl[uniformType].apply(this._gl, args);\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    _createProgram(gl, vertexShader, fragmentShader) {\r\n        const program = gl.createProgram();\r\n        if (program === null) {\r\n            throw Error('Could not create graphics shader program');\r\n        }\r\n        // attach the shaders.\r\n        gl.attachShader(program, vertexShader);\r\n        gl.attachShader(program, fragmentShader);\r\n        // link the program.\r\n        gl.linkProgram(program);\r\n        const success = gl.getProgramParameter(program, gl.LINK_STATUS);\r\n        if (!success) {\r\n            throw Error(`Could not link the program: [${gl.getProgramInfoLog(program)}]`);\r\n        }\r\n        return program;\r\n    }\r\n    _compileShader(gl, source, type) {\r\n        const typeName = gl.VERTEX_SHADER === type ? 'vertex' : 'fragment';\r\n        const shader = gl.createShader(type);\r\n        if (shader === null) {\r\n            throw Error(`Could not build shader: [${source}]`);\r\n        }\r\n        gl.shaderSource(shader, source);\r\n        gl.compileShader(shader);\r\n        const success = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\r\n        if (!success) {\r\n            const errorInfo = gl.getShaderInfoLog(shader);\r\n            throw Error(`Could not compile ${typeName} shader:\\n\\n${errorInfo}${this._processSourceForError(source, errorInfo)}`);\r\n        }\r\n        return shader;\r\n    }\r\n    _processSourceForError(source, errorInfo) {\r\n        const lines = source.split('\\n');\r\n        const errorLineStart = errorInfo.search(/\\d:\\d/);\r\n        const errorLineEnd = errorInfo.indexOf(' ', errorLineStart);\r\n        const [_, error2] = errorInfo.slice(errorLineStart, errorLineEnd).split(':').map(v => Number(v));\r\n        for (let i = 0; i < lines.length; i++) {\r\n            lines[i] = `${i + 1}: ${lines[i]}${error2 === (i + 1) ? ' <----- ERROR!' : ''}`;\r\n        }\r\n        return '\\n\\nSource:\\n' + lines.join('\\n');\r\n    }\r\n}\r\nShader._ACTIVE_SHADER_INSTANCE = null;\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/vertex-buffer.ts\n/**\r\n * Helper around vertex buffer to simplify creating and uploading geometry\r\n *\r\n * Under the hood uses Float32Array\r\n */\r\nclass VertexBuffer {\r\n    constructor(options) {\r\n        /**\r\n         * If the vertices never change switching 'static' can be more efficient on the gpu\r\n         *\r\n         * Default is 'dynamic'\r\n         */\r\n        this.type = 'dynamic';\r\n        const { gl, size, type, data } = options;\r\n        this._gl = gl;\r\n        this.buffer = this._gl.createBuffer();\r\n        if (!data && !size) {\r\n            throw Error('Must either provide data or a size to the VertexBuffer');\r\n        }\r\n        if (!data) {\r\n            this.bufferData = new Float32Array(size);\r\n        }\r\n        else {\r\n            this.bufferData = data;\r\n        }\r\n        this.type = type !== null && type !== void 0 ? type : this.type;\r\n        // Allocate buffer\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.buffer);\r\n        gl.bufferData(gl.ARRAY_BUFFER, this.bufferData, this.type === 'static' ? gl.STATIC_DRAW : gl.DYNAMIC_DRAW);\r\n    }\r\n    /**\r\n     * Bind this vertex buffer\r\n     */\r\n    bind() {\r\n        const gl = this._gl;\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.buffer);\r\n    }\r\n    /**\r\n     * Upload vertex buffer geometry to the GPU\r\n     */\r\n    upload(count) {\r\n        const gl = this._gl;\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.buffer);\r\n        if (count) {\r\n            gl.bufferSubData(gl.ARRAY_BUFFER, 0, this.bufferData, 0, count);\r\n        }\r\n        else {\r\n            // TODO always use bufferSubData? need to perf test it\r\n            gl.bufferData(gl.ARRAY_BUFFER, this.bufferData, this.type === 'static' ? gl.STATIC_DRAW : gl.DYNAMIC_DRAW);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/vertex-layout.ts\n\r\n\r\n/**\r\n * Helper around creating vertex attributes in a given [[VertexBuffer]], this is useful for describing\r\n * the memory layout for your vertices inside a particular buffer\r\n *\r\n * Note: This helper assumes interleaved attributes in one [[VertexBuffer]], not many.\r\n *\r\n * Working with `gl.vertexAttribPointer` can be tricky, and this attempts to double check you\r\n */\r\nclass VertexLayout {\r\n    get vertexBuffer() {\r\n        return this._vertexBuffer;\r\n    }\r\n    get attributes() {\r\n        return this._attributes;\r\n    }\r\n    constructor(options) {\r\n        this._logger = Logger.getInstance();\r\n        this._layout = [];\r\n        this._attributes = [];\r\n        this._vertexTotalSizeBytes = 0;\r\n        const { gl, shader, vertexBuffer, attributes } = options;\r\n        this._gl = gl;\r\n        this._vertexBuffer = vertexBuffer;\r\n        this._attributes = attributes;\r\n        this._shader = shader;\r\n        if (shader) {\r\n            this.initialize();\r\n        }\r\n    }\r\n    /**\r\n     * Total number of bytes that the vertex will take up\r\n     */\r\n    get totalVertexSizeBytes() {\r\n        return this._vertexTotalSizeBytes;\r\n    }\r\n    set shader(shader) {\r\n        if (shader && this._shader !== shader) {\r\n            this._shader = shader;\r\n            this.initialize();\r\n        }\r\n    }\r\n    get shader() {\r\n        return this._shader;\r\n    }\r\n    /**\r\n     * Layouts need shader locations and must be bound to a shader\r\n     */\r\n    initialize() {\r\n        if (!this._shader) {\r\n            return;\r\n        }\r\n        if (!this._shader.compiled) {\r\n            throw Error('Shader not compiled, shader must be compiled before defining a vertex layout');\r\n        }\r\n        this._layout.length = 0;\r\n        const shaderAttributes = this._shader.attributes;\r\n        for (const attribute of this._attributes) {\r\n            const attrib = shaderAttributes[attribute[0]];\r\n            if (!attrib) {\r\n                throw Error(`The attribute named: ${attribute[0]} size ${attribute[1]}` +\r\n                    ` not found in the shader source code:\\n ${this._shader.vertexSource}`);\r\n            }\r\n            if (attrib.size !== attribute[1]) {\r\n                throw Error(`VertexLayout size definition for attribute: [${attribute[0]}, ${attribute[1]}],`\r\n                    + ` doesnt match shader source size ${attrib.size}:\\n ${this._shader.vertexSource}`);\r\n            }\r\n            this._layout.push(attrib);\r\n        }\r\n        // calc size\r\n        let componentsPerVertex = 0;\r\n        for (const vertAttribute of this._layout) {\r\n            const typeSize = getGlTypeSizeBytes(this._gl, vertAttribute.glType);\r\n            this._vertexTotalSizeBytes += typeSize * vertAttribute.size;\r\n            componentsPerVertex += vertAttribute.size;\r\n        }\r\n        if (this._vertexBuffer.bufferData.length % componentsPerVertex !== 0) {\r\n            this._logger.warn(`The vertex component size (${componentsPerVertex})  does divide evenly into the specified vertex buffer`\r\n                + ` (${this._vertexBuffer.bufferData.length})`);\r\n        }\r\n    }\r\n    /**\r\n     * Bind this layout with it's associated vertex buffer\r\n     *\r\n     * @param uploadBuffer Optionally indicate you wish to upload the buffer to the GPU associated with this layout\r\n     */\r\n    use(uploadBuffer = false, count) {\r\n        if (!this._shader) {\r\n            throw Error('No shader is associated with this vertex layout, a shader must be set');\r\n        }\r\n        const gl = this._gl;\r\n        if (!this._shader.isCurrentlyBound()) {\r\n            throw Error('Shader associated with this vertex layout is not active! Call shader.use() before layout.use()');\r\n        }\r\n        this._vertexBuffer.bind();\r\n        if (uploadBuffer) {\r\n            this._vertexBuffer.upload(count);\r\n        }\r\n        let offset = 0;\r\n        // TODO switch to VAOs if the extension is\r\n        for (const vert of this._layout) {\r\n            gl.vertexAttribPointer(vert.location, vert.size, vert.glType, vert.normalized, this.totalVertexSizeBytes, offset);\r\n            gl.enableVertexAttribArray(vert.location);\r\n            offset += getGlTypeSizeBytes(gl, vert.glType) * vert.size;\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/GraphicsDiagnostics.ts\nclass GraphicsDiagnostics {\r\n    static clear() {\r\n        GraphicsDiagnostics.DrawCallCount = 0;\r\n        GraphicsDiagnostics.DrawnImagesCount = 0;\r\n    }\r\n}\r\nGraphicsDiagnostics.DrawCallCount = 0;\r\nGraphicsDiagnostics.DrawnImagesCount = 0;\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/line-renderer/line-renderer.ts\n\r\n\r\n\r\n\r\nclass LineRenderer {\r\n    constructor() {\r\n        this.type = 'ex.line';\r\n        this.priority = 0;\r\n        this._maxLines = 10922;\r\n        this._vertexIndex = 0;\r\n        this._lineCount = 0;\r\n    }\r\n    initialize(gl, context) {\r\n        this._gl = gl;\r\n        this._context = context;\r\n        this._shader = new Shader({\r\n            gl,\r\n            vertexSource: line_vertex,\r\n            fragmentSource: line_fragment\r\n        });\r\n        this._shader.compile();\r\n        this._shader.use();\r\n        this._shader.setUniformMatrix('u_matrix', this._context.ortho);\r\n        this._vertexBuffer = new VertexBuffer({\r\n            gl,\r\n            size: 6 * 2 * this._maxLines,\r\n            type: 'dynamic'\r\n        });\r\n        this._layout = new VertexLayout({\r\n            gl,\r\n            vertexBuffer: this._vertexBuffer,\r\n            shader: this._shader,\r\n            attributes: [\r\n                ['a_position', 2],\r\n                ['a_color', 4]\r\n            ]\r\n        });\r\n    }\r\n    draw(start, end, color) {\r\n        // Force a render if the batch is full\r\n        if (this._isFull()) {\r\n            this.flush();\r\n        }\r\n        this._lineCount++;\r\n        const transform = this._context.getTransform();\r\n        const finalStart = transform.multiply(start);\r\n        const finalEnd = transform.multiply(end);\r\n        const vertexBuffer = this._vertexBuffer.bufferData;\r\n        // Start\r\n        vertexBuffer[this._vertexIndex++] = finalStart.x;\r\n        vertexBuffer[this._vertexIndex++] = finalStart.y;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        // End\r\n        vertexBuffer[this._vertexIndex++] = finalEnd.x;\r\n        vertexBuffer[this._vertexIndex++] = finalEnd.y;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n    }\r\n    _isFull() {\r\n        if (this._lineCount >= this._maxLines) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    hasPendingDraws() {\r\n        return this._lineCount !== 0;\r\n    }\r\n    flush() {\r\n        // nothing to draw early exit\r\n        if (this._lineCount === 0) {\r\n            return;\r\n        }\r\n        const gl = this._gl;\r\n        this._shader.use();\r\n        this._layout.use(true);\r\n        this._shader.setUniformMatrix('u_matrix', this._context.ortho);\r\n        gl.drawArrays(gl.LINES, 0, this._lineCount * 2); // 2 verts per line\r\n        GraphicsDiagnostics.DrawnImagesCount += this._lineCount;\r\n        GraphicsDiagnostics.DrawCallCount++;\r\n        // reset\r\n        this._vertexIndex = 0;\r\n        this._lineCount = 0;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/point-renderer/point-vertex.glsl\n/* harmony default export */ const point_vertex = (\"#version 300 es\\r\\nin vec2 a_position;\\r\\nin vec4 a_color;\\r\\nin float a_size;\\r\\nout lowp vec4 v_color;\\r\\nuniform mat4 u_matrix;\\r\\n\\r\\nvoid main() {\\r\\n  gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\\r\\n  gl_PointSize = a_size * 2.0;\\r\\n  v_color = a_color;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/point-renderer/point-fragment.glsl\n/* harmony default export */ const point_fragment = (\"#version 300 es\\r\\n\\r\\nprecision mediump float;\\r\\nin lowp vec4 v_color;\\r\\n\\r\\nout vec4 fragColor;\\r\\n\\r\\nvoid main() {\\r\\n  float r = 0.0, delta = 0.0, alpha = 1.0;\\r\\n  vec2 cxy = 2.0 * gl_PointCoord - 1.0;\\r\\n  r = dot(cxy, cxy);\\r\\n\\r\\n  delta = fwidth(r);\\r\\n  alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\\r\\n  // \\\"premultiply\\\" the color by alpha\\r\\n  vec4 color = v_color;\\r\\n  color.a = color.a * alpha;\\r\\n  color.rgb = color.rgb * color.a;\\r\\n  fragColor = color;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/point-renderer/point-renderer.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass PointRenderer {\r\n    constructor() {\r\n        this.type = 'ex.point';\r\n        this.priority = 0;\r\n        this._maxPoints = 10922;\r\n        this._pointCount = 0;\r\n        this._vertexIndex = 0;\r\n    }\r\n    initialize(gl, context) {\r\n        this._gl = gl;\r\n        this._context = context;\r\n        this._shader = new Shader({\r\n            gl,\r\n            vertexSource: point_vertex,\r\n            fragmentSource: point_fragment\r\n        });\r\n        this._shader.compile();\r\n        this._shader.use();\r\n        this._shader.setUniformMatrix('u_matrix', this._context.ortho);\r\n        this._buffer = new VertexBuffer({\r\n            gl,\r\n            size: 7 * this._maxPoints,\r\n            type: 'dynamic'\r\n        });\r\n        this._layout = new VertexLayout({\r\n            gl,\r\n            shader: this._shader,\r\n            vertexBuffer: this._buffer,\r\n            attributes: [\r\n                ['a_position', 2],\r\n                ['a_color', 4],\r\n                ['a_size', 1]\r\n            ]\r\n        });\r\n    }\r\n    draw(point, color, size) {\r\n        // Force a render if the batch is full\r\n        if (this._isFull()) {\r\n            this.flush();\r\n        }\r\n        this._pointCount++;\r\n        const transform = this._context.getTransform();\r\n        const opacity = this._context.opacity;\r\n        const snapToPixel = this._context.snapToPixel;\r\n        const finalPoint = transform.multiply(point);\r\n        if (snapToPixel) {\r\n            finalPoint.x = ~~(finalPoint.x + pixelSnapEpsilon);\r\n            finalPoint.y = ~~(finalPoint.y + pixelSnapEpsilon);\r\n        }\r\n        const vertexBuffer = this._buffer.bufferData;\r\n        vertexBuffer[this._vertexIndex++] = finalPoint.x;\r\n        vertexBuffer[this._vertexIndex++] = finalPoint.y;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a * opacity;\r\n        vertexBuffer[this._vertexIndex++] = size * Math.max(transform.getScaleX(), transform.getScaleY());\r\n    }\r\n    _isFull() {\r\n        if (this._pointCount >= this._maxPoints) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    hasPendingDraws() {\r\n        return this._pointCount !== 0;\r\n    }\r\n    flush() {\r\n        // nothing to draw early exit\r\n        if (this._pointCount === 0) {\r\n            return;\r\n        }\r\n        const gl = this._gl;\r\n        this._shader.use();\r\n        this._layout.use(true);\r\n        this._shader.setUniformMatrix('u_matrix', this._context.ortho);\r\n        gl.drawArrays(gl.POINTS, 0, this._pointCount);\r\n        GraphicsDiagnostics.DrawnImagesCount += this._pointCount;\r\n        GraphicsDiagnostics.DrawCallCount++;\r\n        this._pointCount = 0;\r\n        this._vertexIndex = 0;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/screen-pass-painter/screen-vertex.glsl\n/* harmony default export */ const screen_vertex = (\"#version 300 es\\r\\nin vec2 a_position;\\r\\n\\r\\nin vec2 a_texcoord;\\r\\nout vec2 v_texcoord;\\r\\n\\r\\nvoid main() {\\r\\n  gl_Position = vec4(a_position, 0.0, 1.0);\\r\\n\\r\\n  // Pass the texcoord to the fragment shader.\\r\\n  v_texcoord = a_texcoord;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/screen-pass-painter/screen-fragment.glsl\n/* harmony default export */ const screen_fragment = (\"#version 300 es\\r\\nprecision mediump float;\\r\\n\\r\\n// Passed in from the vertex shader.\\r\\nin vec2 v_texcoord;\\r\\n\\r\\n// The texture.\\r\\nuniform sampler2D u_texture;\\r\\n\\r\\nout vec4 fragColor;\\r\\n\\r\\nvoid main() {\\r\\n   fragColor = texture(u_texture, v_texcoord);\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/screen-pass-painter/screen-pass-painter.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * This is responsible for painting the entire screen during the render passes\r\n */\r\nclass ScreenPassPainter {\r\n    constructor(gl) {\r\n        this._gl = gl;\r\n        this._shader = new Shader({\r\n            gl,\r\n            vertexSource: screen_vertex,\r\n            fragmentSource: screen_fragment\r\n        });\r\n        this._shader.compile();\r\n        // Setup memory layout\r\n        this._buffer = new VertexBuffer({\r\n            gl,\r\n            type: 'static',\r\n            // clip space quad + uv since we don't need a camera\r\n            data: new Float32Array([\r\n                -1, -1, 0, 0,\r\n                -1, 1, 0, 1,\r\n                1, -1, 1, 0,\r\n                1, -1, 1, 0,\r\n                -1, 1, 0, 1,\r\n                1, 1, 1, 1\r\n            ])\r\n        });\r\n        this._layout = new VertexLayout({\r\n            gl,\r\n            shader: this._shader,\r\n            vertexBuffer: this._buffer,\r\n            attributes: [\r\n                ['a_position', 2],\r\n                ['a_texcoord', 2]\r\n            ]\r\n        });\r\n        this._buffer.upload();\r\n    }\r\n    renderWithPostProcessor(postprocessor) {\r\n        const gl = this._gl;\r\n        postprocessor.getShader().use();\r\n        postprocessor.getLayout().use();\r\n        gl.drawArrays(gl.TRIANGLES, 0, 6);\r\n    }\r\n    renderToScreen() {\r\n        const gl = this._gl;\r\n        this._shader.use();\r\n        this._layout.use();\r\n        gl.drawArrays(gl.TRIANGLES, 0, 6);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/quad-index-buffer.ts\n\r\n/**\r\n * Helper that defines and index buffer for quad geometry\r\n *\r\n * Index buffers allow you to save space in vertex buffers when you share vertices in geometry\r\n * it is almost always worth it in terms of performance to use an index buffer.\r\n */\r\nclass QuadIndexBuffer {\r\n    /**\r\n     * @param gl WebGL2RenderingContext this layout will be attached to, these cannot be reused across contexts.\r\n     * @param numberOfQuads Specify the max number of quads you want to draw\r\n     * @param useUint16 Optionally force a uint16 buffer\r\n     */\r\n    constructor(gl, numberOfQuads, useUint16) {\r\n        this._logger = Logger.getInstance();\r\n        this._gl = gl;\r\n        this.buffer = gl.createBuffer();\r\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.buffer);\r\n        const totalVertices = numberOfQuads * 6;\r\n        if (!useUint16) {\r\n            this.bufferData = new Uint32Array(totalVertices);\r\n        }\r\n        else {\r\n            // fall back to using gl.UNSIGNED_SHORT or tell the user they are out of luck\r\n            const maxUint16 = 65535;\r\n            const maxUint16Index = Math.floor((maxUint16 - 1) / 4); // max quads\r\n            this.bufferGlType = gl.UNSIGNED_SHORT;\r\n            this.bufferData = new Uint16Array(totalVertices);\r\n            // TODO Should we error if this happens?? maybe not might crash mid game\r\n            if (numberOfQuads > maxUint16Index) {\r\n                this._logger.warn(`Total quads exceeds hardware index buffer limit (uint16), max(${maxUint16Index}) requested quads(${numberOfQuads})`);\r\n            }\r\n        }\r\n        let currentQuad = 0;\r\n        for (let i = 0; i < totalVertices; i += 6) {\r\n            // first triangle\r\n            this.bufferData[i + 0] = currentQuad + 0;\r\n            this.bufferData[i + 1] = currentQuad + 1;\r\n            this.bufferData[i + 2] = currentQuad + 2;\r\n            // second triangle\r\n            this.bufferData[i + 3] = currentQuad + 2;\r\n            this.bufferData[i + 4] = currentQuad + 1;\r\n            this.bufferData[i + 5] = currentQuad + 3;\r\n            currentQuad += 4;\r\n        }\r\n        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, this.bufferData, gl.STATIC_DRAW);\r\n    }\r\n    get size() {\r\n        return this.bufferData.length;\r\n    }\r\n    /**\r\n     * Upload data to the GPU\r\n     */\r\n    upload() {\r\n        const gl = this._gl;\r\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.buffer);\r\n        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, this.bufferData, gl.STATIC_DRAW);\r\n    }\r\n    /**\r\n     * Bind this index buffer\r\n     */\r\n    bind() {\r\n        const gl = this._gl;\r\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.buffer);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/image-renderer/image-renderer.frag.glsl\n/* harmony default export */ const image_renderer_frag = (\"#version 300 es\\r\\nprecision mediump float;\\r\\n\\r\\n// UV coord\\r\\nin vec2 v_texcoord;\\r\\n\\r\\n// Texture index\\r\\nin lowp float v_textureIndex;\\r\\n\\r\\n// Textures in the current draw\\r\\nuniform sampler2D u_textures[%%count%%];\\r\\n\\r\\n// Opacity\\r\\nin float v_opacity;\\r\\n\\r\\nin vec4 v_tint;\\r\\n\\r\\nout vec4 fragColor;\\r\\n\\r\\nvoid main() {\\r\\n   // In order to support the most efficient sprite batching, we have multiple\\r\\n   // textures loaded into the gpu (usually 8) this picker logic skips over textures\\r\\n   // that do not apply to a particular sprite.\\r\\n\\r\\n   vec4 color = vec4(1.0, 0, 0, 1.0);\\r\\n\\r\\n   // GLSL is templated out to pick the right texture and set the vec4 color\\r\\n   %%texture_picker%%\\r\\n\\r\\n   color.rgb = color.rgb * v_opacity;\\r\\n   color.a = color.a * v_opacity;\\r\\n   fragColor = color * v_tint;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/image-renderer/image-renderer.vert.glsl\n/* harmony default export */ const image_renderer_vert = (\"#version 300 es\\r\\nin vec2 a_position;\\r\\n\\r\\n// Opacity \\r\\nin float a_opacity;\\r\\nout float v_opacity;\\r\\n\\r\\n// UV coordinate\\r\\nin vec2 a_texcoord;\\r\\nout vec2 v_texcoord;\\r\\n\\r\\n// Texture number\\r\\nin lowp float a_textureIndex;\\r\\nout lowp float v_textureIndex;\\r\\n\\r\\nin vec4 a_tint;\\r\\nout vec4 v_tint;\\r\\n\\r\\nuniform mat4 u_matrix;\\r\\n\\r\\nvoid main() {\\r\\n   // Set the vertex position using the ortho transform matrix\\r\\n   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\\r\\n\\r\\n   // Pass through the Opacity to the fragment shader\\r\\n   v_opacity = a_opacity;\\r\\n   // Pass through the UV coord to the fragment shader\\r\\n   v_texcoord = a_texcoord;\\r\\n   // Pass through the texture number to the fragment shader\\r\\n   v_textureIndex = a_textureIndex;\\r\\n   // Pass through the tint\\r\\n   v_tint = a_tint;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/image-renderer/image-renderer.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass ImageRenderer {\r\n    constructor() {\r\n        this.type = 'ex.image';\r\n        this.priority = 0;\r\n        this._maxImages = 10922; // max(uint16) / 6 verts\r\n        this._maxTextures = 0;\r\n        // Per flush vars\r\n        this._imageCount = 0;\r\n        this._textures = [];\r\n        this._vertexIndex = 0;\r\n    }\r\n    initialize(gl, context) {\r\n        this._gl = gl;\r\n        this._context = context;\r\n        // Transform shader source\r\n        // FIXME: PIXEL 6 complains `ERROR: Expression too complex.` if we use it's reported max texture units, 125 seems to work for now...\r\n        this._maxTextures = Math.min(gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS), 125);\r\n        const transformedFrag = this._transformFragmentSource(image_renderer_frag, this._maxTextures);\r\n        // Compile shader\r\n        this._shader = new Shader({\r\n            gl,\r\n            fragmentSource: transformedFrag,\r\n            vertexSource: image_renderer_vert\r\n        });\r\n        this._shader.compile();\r\n        // setup uniforms\r\n        this._shader.use();\r\n        this._shader.setUniformMatrix('u_matrix', context.ortho);\r\n        // Initialize texture slots to [0, 1, 2, 3, 4, .... maxGPUTextures]\r\n        this._shader.setUniformIntArray('u_textures', [...Array(this._maxTextures)].map((_, i) => i));\r\n        // Setup memory layout\r\n        this._buffer = new VertexBuffer({\r\n            gl,\r\n            size: 10 * 4 * this._maxImages,\r\n            type: 'dynamic'\r\n        });\r\n        this._layout = new VertexLayout({\r\n            gl,\r\n            shader: this._shader,\r\n            vertexBuffer: this._buffer,\r\n            attributes: [\r\n                ['a_position', 2],\r\n                ['a_opacity', 1],\r\n                ['a_texcoord', 2],\r\n                ['a_textureIndex', 1],\r\n                ['a_tint', 4]\r\n            ]\r\n        });\r\n        // Setup index buffer\r\n        this._quads = new QuadIndexBuffer(gl, this._maxImages, true);\r\n    }\r\n    _transformFragmentSource(source, maxTextures) {\r\n        let newSource = source.replace('%%count%%', maxTextures.toString());\r\n        let texturePickerBuilder = '';\r\n        for (let i = 0; i < maxTextures; i++) {\r\n            if (i === 0) {\r\n                texturePickerBuilder += `if (v_textureIndex <= ${i}.5) {\\n`;\r\n            }\r\n            else {\r\n                texturePickerBuilder += `   else if (v_textureIndex <= ${i}.5) {\\n`;\r\n            }\r\n            texturePickerBuilder += `      color = texture(u_textures[${i}], v_texcoord);\\n`;\r\n            texturePickerBuilder += `   }\\n`;\r\n        }\r\n        newSource = newSource.replace('%%texture_picker%%', texturePickerBuilder);\r\n        return newSource;\r\n    }\r\n    _addImageAsTexture(image) {\r\n        const maybeFiltering = image.getAttribute('filtering');\r\n        let filtering = null;\r\n        if (maybeFiltering === ImageFiltering.Blended ||\r\n            maybeFiltering === ImageFiltering.Pixel) {\r\n            filtering = maybeFiltering;\r\n        }\r\n        const force = image.getAttribute('forceUpload') === 'true' ? true : false;\r\n        const texture = this._context.textureLoader.load(image, filtering, force);\r\n        // remove force attribute after upload\r\n        image.removeAttribute('forceUpload');\r\n        if (this._textures.indexOf(texture) === -1) {\r\n            this._textures.push(texture);\r\n        }\r\n    }\r\n    _bindTextures(gl) {\r\n        // Bind textures in the correct order\r\n        for (let i = 0; i < this._maxTextures; i++) {\r\n            gl.activeTexture(gl.TEXTURE0 + i);\r\n            gl.bindTexture(gl.TEXTURE_2D, this._textures[i] || this._textures[0]);\r\n        }\r\n    }\r\n    _getTextureIdForImage(image) {\r\n        if (image) {\r\n            const maybeTexture = this._context.textureLoader.get(image);\r\n            return this._textures.indexOf(maybeTexture);\r\n        }\r\n        return -1;\r\n    }\r\n    _isFull() {\r\n        if (this._imageCount >= this._maxImages) {\r\n            return true;\r\n        }\r\n        if (this._textures.length >= this._maxTextures) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    draw(image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight) {\r\n        var _a, _b, _c, _d;\r\n        // Force a render if the batch is full\r\n        if (this._isFull()) {\r\n            this.flush();\r\n        }\r\n        this._imageCount++;\r\n        // This creates and uploads the texture if not already done\r\n        this._addImageAsTexture(image);\r\n        let width = (image === null || image === void 0 ? void 0 : image.width) || swidth || 0;\r\n        let height = (image === null || image === void 0 ? void 0 : image.height) || sheight || 0;\r\n        let view = [0, 0, (_a = swidth !== null && swidth !== void 0 ? swidth : image === null || image === void 0 ? void 0 : image.width) !== null && _a !== void 0 ? _a : 0, (_b = sheight !== null && sheight !== void 0 ? sheight : image === null || image === void 0 ? void 0 : image.height) !== null && _b !== void 0 ? _b : 0];\r\n        let dest = [sx !== null && sx !== void 0 ? sx : 1, sy !== null && sy !== void 0 ? sy : 1];\r\n        // If destination is specified, update view and dest\r\n        if (dx !== undefined && dy !== undefined && dwidth !== undefined && dheight !== undefined) {\r\n            view = [sx !== null && sx !== void 0 ? sx : 1, sy !== null && sy !== void 0 ? sy : 1, (_c = swidth !== null && swidth !== void 0 ? swidth : image === null || image === void 0 ? void 0 : image.width) !== null && _c !== void 0 ? _c : 0, (_d = sheight !== null && sheight !== void 0 ? sheight : image === null || image === void 0 ? void 0 : image.height) !== null && _d !== void 0 ? _d : 0];\r\n            dest = [dx, dy];\r\n            width = dwidth;\r\n            height = dheight;\r\n        }\r\n        sx = view[0];\r\n        sy = view[1];\r\n        const sw = view[2];\r\n        const sh = view[3];\r\n        // transform based on current context\r\n        const transform = this._context.getTransform();\r\n        const opacity = this._context.opacity;\r\n        const snapToPixel = this._context.snapToPixel;\r\n        let topLeft = vec(dest[0], dest[1]);\r\n        let topRight = vec(dest[0] + width, dest[1]);\r\n        let bottomLeft = vec(dest[0], dest[1] + height);\r\n        let bottomRight = vec(dest[0] + width, dest[1] + height);\r\n        topLeft = transform.multiply(topLeft);\r\n        topRight = transform.multiply(topRight);\r\n        bottomLeft = transform.multiply(bottomLeft);\r\n        bottomRight = transform.multiply(bottomRight);\r\n        if (snapToPixel) {\r\n            topLeft.x = ~~(topLeft.x + pixelSnapEpsilon);\r\n            topLeft.y = ~~(topLeft.y + pixelSnapEpsilon);\r\n            topRight.x = ~~(topRight.x + pixelSnapEpsilon);\r\n            topRight.y = ~~(topRight.y + pixelSnapEpsilon);\r\n            bottomLeft.x = ~~(bottomLeft.x + pixelSnapEpsilon);\r\n            bottomLeft.y = ~~(bottomLeft.y + pixelSnapEpsilon);\r\n            bottomRight.x = ~~(bottomRight.x + pixelSnapEpsilon);\r\n            bottomRight.y = ~~(bottomRight.y + pixelSnapEpsilon);\r\n        }\r\n        const tint = this._context.tint;\r\n        const textureId = this._getTextureIdForImage(image);\r\n        const imageWidth = image.width || width;\r\n        const imageHeight = image.height || height;\r\n        const uvx0 = (sx) / imageWidth;\r\n        const uvy0 = (sy) / imageHeight;\r\n        const uvx1 = (sx + sw - 0.01) / imageWidth;\r\n        const uvy1 = (sy + sh - 0.01) / imageHeight;\r\n        // update data\r\n        const vertexBuffer = this._layout.vertexBuffer.bufferData;\r\n        // (0, 0) - 0\r\n        vertexBuffer[this._vertexIndex++] = topLeft.x;\r\n        vertexBuffer[this._vertexIndex++] = topLeft.y;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = uvx0;\r\n        vertexBuffer[this._vertexIndex++] = uvy0;\r\n        vertexBuffer[this._vertexIndex++] = textureId;\r\n        vertexBuffer[this._vertexIndex++] = tint.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = tint.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = tint.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = tint.a;\r\n        // (0, 1) - 1\r\n        vertexBuffer[this._vertexIndex++] = bottomLeft.x;\r\n        vertexBuffer[this._vertexIndex++] = bottomLeft.y;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = uvx0;\r\n        vertexBuffer[this._vertexIndex++] = uvy1;\r\n        vertexBuffer[this._vertexIndex++] = textureId;\r\n        vertexBuffer[this._vertexIndex++] = tint.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = tint.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = tint.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = tint.a;\r\n        // (1, 0) - 2\r\n        vertexBuffer[this._vertexIndex++] = topRight.x;\r\n        vertexBuffer[this._vertexIndex++] = topRight.y;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = uvx1;\r\n        vertexBuffer[this._vertexIndex++] = uvy0;\r\n        vertexBuffer[this._vertexIndex++] = textureId;\r\n        vertexBuffer[this._vertexIndex++] = tint.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = tint.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = tint.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = tint.a;\r\n        // (1, 1) - 3\r\n        vertexBuffer[this._vertexIndex++] = bottomRight.x;\r\n        vertexBuffer[this._vertexIndex++] = bottomRight.y;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = uvx1;\r\n        vertexBuffer[this._vertexIndex++] = uvy1;\r\n        vertexBuffer[this._vertexIndex++] = textureId;\r\n        vertexBuffer[this._vertexIndex++] = tint.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = tint.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = tint.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = tint.a;\r\n    }\r\n    hasPendingDraws() {\r\n        return this._imageCount !== 0;\r\n    }\r\n    flush() {\r\n        // nothing to draw early exit\r\n        if (this._imageCount === 0) {\r\n            return;\r\n        }\r\n        const gl = this._gl;\r\n        // Bind the shader\r\n        this._shader.use();\r\n        // Bind the memory layout and upload data\r\n        this._layout.use(true, 4 * 10 * this._imageCount);\r\n        // Update ortho matrix uniform\r\n        this._shader.setUniformMatrix('u_matrix', this._context.ortho);\r\n        // Bind textures to\r\n        this._bindTextures(gl);\r\n        // Bind index buffer\r\n        this._quads.bind();\r\n        // Draw all the quads\r\n        gl.drawElements(gl.TRIANGLES, this._imageCount * 6, this._quads.bufferGlType, 0);\r\n        GraphicsDiagnostics.DrawnImagesCount += this._imageCount;\r\n        GraphicsDiagnostics.DrawCallCount++;\r\n        // Reset\r\n        this._imageCount = 0;\r\n        this._vertexIndex = 0;\r\n        this._textures.length = 0;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/rectangle-renderer/rectangle-renderer.frag.glsl\n/* harmony default export */ const rectangle_renderer_frag = (\"#version 300 es\\r\\n\\r\\nprecision mediump float;\\r\\n\\r\\n// UV coord\\r\\nin vec2 v_uv;\\r\\n\\r\\nin vec2 v_size; // in pixels\\r\\n\\r\\n// Color coord to blend with image\\r\\nin lowp vec4 v_color;\\r\\n\\r\\n// Stroke color if used\\r\\nin lowp vec4 v_strokeColor;\\r\\n\\r\\n// Stroke thickness if used\\r\\nin lowp float v_strokeThickness; // in pixels\\r\\n\\r\\n// Opacity\\r\\nin float v_opacity;\\r\\n\\r\\nout vec4 fragColor;\\r\\n\\r\\nvoid main() {\\r\\n    // modified from https://stackoverflow.com/questions/59197671/glsl-rounded-rectangle-with-variable-border\\r\\n    vec2 uv = v_uv;\\r\\n    vec2 fragCoord = uv * v_size;\\r\\n    float maxX = v_size.x - v_strokeThickness;\\r\\n    float minX = v_strokeThickness;\\r\\n    float maxY = v_size.y - v_strokeThickness;\\r\\n    float minY = v_strokeThickness;\\r\\n\\r\\n    if (fragCoord.x < maxX && fragCoord.x > minX &&\\r\\n        fragCoord.y < maxY && fragCoord.y > minY) {\\r\\n      fragColor = v_color;\\r\\n    } else {\\r\\n      fragColor = v_strokeColor;\\r\\n    }\\r\\n    fragColor.a *= v_opacity;\\r\\n    fragColor.rgb *= fragColor.a;\\r\\n\\r\\n    // vec2 v2CenteredPos     = abs(fragCoord - v_size.xy / 2.0);\\r\\n    // vec2 v2HalfShapeSizePx = v_size.xy/2.0 - v_strokeThickness/2.0;\\r\\n\\r\\n    // float fHalfBorderDist      = 0.0;\\r\\n    // float fHalfBorderThickness = 0.0;\\r\\n\\r\\n    // if (fragCoord.x > max(v_radius, v_strokeThickness) && \\r\\n    //     fragCoord.x < v_size.x - max(v_radius, v_strokeThickness))\\r\\n    // {\\r\\n    //     fHalfBorderDist      = v2CenteredPos.y - v2HalfShapeSizePx.y;\\r\\n    //     fHalfBorderThickness = v_strokeThickness / 2.0;\\r\\n    // }\\r\\n    // else if (fragCoord.y > max(v_radius, v_strokeThickness) && \\r\\n    //          fragCoord.y < v_size.y - max(v_radius, v_strokeThickness))\\r\\n    // {\\r\\n    //     fHalfBorderDist      = v2CenteredPos.x - v2HalfShapeSizePx.x;\\r\\n    //     fHalfBorderThickness = v_strokeThickness / 2.0;\\r\\n    // }\\r\\n    // else\\r\\n    // {\\r\\n    //     vec2 edgeVec = max(vec2(0.0), v_radius - vec2(\\r\\n    //         uv.x > 0.5 ? v_size.x - fragCoord.x : fragCoord.x,\\r\\n    //         uv.y > 0.5 ? v_size.y - fragCoord.y : fragCoord.y));\\r\\n        \\r\\n    //     float ellipse_ab    = v_radius-v_strokeThickness;\\r\\n    //     vec2 ellipse_isect = (v_strokeThickness > v_radius || v_strokeThickness > v_radius) ? vec2(0.0) :\\r\\n    //                             edgeVec.xy * ellipse_ab*ellipse_ab / length(ellipse_ab*edgeVec.yx); \\r\\n            \\r\\n    //     fHalfBorderThickness = (v_radius - length(ellipse_isect)) / 2.0;\\r\\n    //     fHalfBorderDist      = length(edgeVec) - (v_radius - fHalfBorderThickness);\\r\\n    // }\\r\\n\\r\\n    // vec4 v4FromColor = v_strokeColor;\\r\\n    // v4FromColor.rgb *= v4FromColor.a;\\r\\n    // vec4 v4ToColor   = vec4(0.0); // background color is transparent\\r\\n    // if (fHalfBorderDist < 0.0) {\\r\\n    //     v4ToColor = v_color;\\r\\n    //     v4ToColor.rgb *= v4ToColor.a;\\r\\n    // }\\r\\n\\r\\n    // float mixPct = abs(fHalfBorderDist) - fHalfBorderThickness;\\r\\n\\r\\n    // vec4 finalColor = mix(v4FromColor, v4ToColor, mixPct);\\r\\n    // gl_FragColor = finalColor;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/rectangle-renderer/rectangle-renderer.vert.glsl\n/* harmony default export */ const rectangle_renderer_vert = (\"#version 300 es\\r\\nin vec2 a_position;\\r\\n\\r\\n// UV coordinate\\r\\nin vec2 a_uv;\\r\\nout vec2 v_uv;\\r\\n\\r\\nin vec2 a_size;\\r\\nout vec2 v_size;\\r\\n\\r\\n// Opacity \\r\\nin float a_opacity;\\r\\nout float v_opacity;\\r\\n\\r\\nin vec4 a_color;\\r\\nout vec4 v_color;\\r\\n\\r\\nin vec4 a_strokeColor;\\r\\nout vec4 v_strokeColor;\\r\\n\\r\\nin float a_strokeThickness;\\r\\nout float v_strokeThickness;\\r\\n\\r\\nuniform mat4 u_matrix;\\r\\n\\r\\n\\r\\nvoid main() {\\r\\n   // Set the vertex position using the ortho transform matrix\\r\\n   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\\r\\n\\r\\n   // Pass through UV coords\\r\\n   v_uv = a_uv;\\r\\n   // Pass through size\\r\\n   v_size = a_size;\\r\\n   // Pass through the Opacity to the fragment shader\\r\\n   v_opacity = a_opacity;\\r\\n   // Pass through the color to the fragment shader\\r\\n   v_color = a_color;\\r\\n   // Pass through the stroke color to the fragment shader\\r\\n   v_strokeColor = a_strokeColor;\\r\\n   // Pass through the stroke thickenss to the fragment shader\\r\\n   v_strokeThickness = a_strokeThickness;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/rectangle-renderer/rectangle-renderer.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass RectangleRenderer {\r\n    constructor() {\r\n        this.type = 'ex.rectangle';\r\n        this.priority = 0;\r\n        this._maxRectangles = 10922; // max(uint16) / 6 verts\r\n        this._rectangleCount = 0;\r\n        this._vertexIndex = 0;\r\n    }\r\n    initialize(gl, context) {\r\n        this._gl = gl;\r\n        this._context = context;\r\n        // https://stackoverflow.com/questions/59197671/glsl-rounded-rectangle-with-variable-border\r\n        this._shader = new Shader({\r\n            gl,\r\n            fragmentSource: rectangle_renderer_frag,\r\n            vertexSource: rectangle_renderer_vert\r\n        });\r\n        this._shader.compile();\r\n        // setup uniforms\r\n        this._shader.use();\r\n        this._shader.setUniformMatrix('u_matrix', context.ortho);\r\n        this._buffer = new VertexBuffer({\r\n            gl,\r\n            size: 16 * 4 * this._maxRectangles,\r\n            type: 'dynamic'\r\n        });\r\n        this._layout = new VertexLayout({\r\n            gl,\r\n            shader: this._shader,\r\n            vertexBuffer: this._buffer,\r\n            attributes: [\r\n                ['a_position', 2],\r\n                ['a_uv', 2],\r\n                ['a_size', 2],\r\n                ['a_opacity', 1],\r\n                ['a_color', 4],\r\n                ['a_strokeColor', 4],\r\n                ['a_strokeThickness', 1]\r\n            ]\r\n        });\r\n        this._quads = new QuadIndexBuffer(gl, this._maxRectangles, true);\r\n    }\r\n    _isFull() {\r\n        if (this._rectangleCount >= this._maxRectangles) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    draw(...args) {\r\n        if (args[0] instanceof Vector && args[1] instanceof Vector) {\r\n            this.drawLine.apply(this, args);\r\n        }\r\n        else {\r\n            this.drawRectangle.apply(this, args);\r\n        }\r\n    }\r\n    drawLine(start, end, color, thickness = 1) {\r\n        if (this._isFull()) {\r\n            this.flush();\r\n        }\r\n        this._rectangleCount++;\r\n        // transform based on current context\r\n        const transform = this._context.getTransform();\r\n        const opacity = this._context.opacity;\r\n        const snapToPixel = this._context.snapToPixel;\r\n        const dir = end.sub(start);\r\n        const length = dir.size;\r\n        const normal = dir.normalize().perpendicular();\r\n        const halfThick = thickness / 2;\r\n        /**\r\n         *    +---------------------^----------------------+\r\n         *    |                     | (normal)             |\r\n         *   (startx, starty)------------------>(endx, endy)\r\n         *    |                                            |\r\n         *    + -------------------------------------------+\r\n         */\r\n        const startTop = transform.multiply(normal.scale(halfThick).add(start));\r\n        const startBottom = transform.multiply(normal.scale(-halfThick).add(start));\r\n        const endTop = transform.multiply(normal.scale(halfThick).add(end));\r\n        const endBottom = transform.multiply(normal.scale(-halfThick).add(end));\r\n        if (snapToPixel) {\r\n            startTop.x = ~~(startTop.x + pixelSnapEpsilon);\r\n            startTop.y = ~~(startTop.y + pixelSnapEpsilon);\r\n            endTop.x = ~~(endTop.x + pixelSnapEpsilon);\r\n            endTop.y = ~~(endTop.y + pixelSnapEpsilon);\r\n            startBottom.x = ~~(startBottom.x + pixelSnapEpsilon);\r\n            startBottom.y = ~~(startBottom.y + pixelSnapEpsilon);\r\n            endBottom.x = ~~(endBottom.x + pixelSnapEpsilon);\r\n            endBottom.y = ~~(endBottom.y + pixelSnapEpsilon);\r\n        }\r\n        // TODO uv could be static vertex buffer\r\n        const uvx0 = 0;\r\n        const uvy0 = 0;\r\n        const uvx1 = 1;\r\n        const uvy1 = 1;\r\n        const stroke = Color.Transparent;\r\n        const strokeThickness = 0;\r\n        const width = 1;\r\n        // update data\r\n        const vertexBuffer = this._layout.vertexBuffer.bufferData;\r\n        // (0, 0) - 0\r\n        vertexBuffer[this._vertexIndex++] = startTop.x;\r\n        vertexBuffer[this._vertexIndex++] = startTop.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx0;\r\n        vertexBuffer[this._vertexIndex++] = uvy0;\r\n        vertexBuffer[this._vertexIndex++] = length;\r\n        vertexBuffer[this._vertexIndex++] = thickness;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness / width;\r\n        // (0, 1) - 1\r\n        vertexBuffer[this._vertexIndex++] = startBottom.x;\r\n        vertexBuffer[this._vertexIndex++] = startBottom.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx0;\r\n        vertexBuffer[this._vertexIndex++] = uvy1;\r\n        vertexBuffer[this._vertexIndex++] = length;\r\n        vertexBuffer[this._vertexIndex++] = thickness;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness / width;\r\n        // (1, 0) - 2\r\n        vertexBuffer[this._vertexIndex++] = endTop.x;\r\n        vertexBuffer[this._vertexIndex++] = endTop.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx1;\r\n        vertexBuffer[this._vertexIndex++] = uvy0;\r\n        vertexBuffer[this._vertexIndex++] = length;\r\n        vertexBuffer[this._vertexIndex++] = thickness;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness / width;\r\n        // (1, 1) - 3\r\n        vertexBuffer[this._vertexIndex++] = endBottom.x;\r\n        vertexBuffer[this._vertexIndex++] = endBottom.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx1;\r\n        vertexBuffer[this._vertexIndex++] = uvy1;\r\n        vertexBuffer[this._vertexIndex++] = length;\r\n        vertexBuffer[this._vertexIndex++] = thickness;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness / width;\r\n    }\r\n    drawRectangle(pos, width, height, color, stroke = Color.Transparent, strokeThickness = 0) {\r\n        if (this._isFull()) {\r\n            this.flush();\r\n        }\r\n        this._rectangleCount++;\r\n        // transform based on current context\r\n        const transform = this._context.getTransform();\r\n        const opacity = this._context.opacity;\r\n        const snapToPixel = this._context.snapToPixel;\r\n        const topLeft = transform.multiply(pos.add(vec(0, 0)));\r\n        const topRight = transform.multiply(pos.add(vec(width, 0)));\r\n        const bottomRight = transform.multiply(pos.add(vec(width, height)));\r\n        const bottomLeft = transform.multiply(pos.add(vec(0, height)));\r\n        if (snapToPixel) {\r\n            topLeft.x = ~~(topLeft.x + pixelSnapEpsilon);\r\n            topLeft.y = ~~(topLeft.y + pixelSnapEpsilon);\r\n            topRight.x = ~~(topRight.x + pixelSnapEpsilon);\r\n            topRight.y = ~~(topRight.y + pixelSnapEpsilon);\r\n            bottomLeft.x = ~~(bottomLeft.x + pixelSnapEpsilon);\r\n            bottomLeft.y = ~~(bottomLeft.y + pixelSnapEpsilon);\r\n            bottomRight.x = ~~(bottomRight.x + pixelSnapEpsilon);\r\n            bottomRight.y = ~~(bottomRight.y + pixelSnapEpsilon);\r\n        }\r\n        // TODO uv could be static vertex buffer\r\n        const uvx0 = 0;\r\n        const uvy0 = 0;\r\n        const uvx1 = 1;\r\n        const uvy1 = 1;\r\n        // update data\r\n        const vertexBuffer = this._layout.vertexBuffer.bufferData;\r\n        // (0, 0) - 0\r\n        vertexBuffer[this._vertexIndex++] = topLeft.x;\r\n        vertexBuffer[this._vertexIndex++] = topLeft.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx0;\r\n        vertexBuffer[this._vertexIndex++] = uvy0;\r\n        vertexBuffer[this._vertexIndex++] = width;\r\n        vertexBuffer[this._vertexIndex++] = height;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness;\r\n        // (0, 1) - 1\r\n        vertexBuffer[this._vertexIndex++] = bottomLeft.x;\r\n        vertexBuffer[this._vertexIndex++] = bottomLeft.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx0;\r\n        vertexBuffer[this._vertexIndex++] = uvy1;\r\n        vertexBuffer[this._vertexIndex++] = width;\r\n        vertexBuffer[this._vertexIndex++] = height;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness;\r\n        // (1, 0) - 2\r\n        vertexBuffer[this._vertexIndex++] = topRight.x;\r\n        vertexBuffer[this._vertexIndex++] = topRight.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx1;\r\n        vertexBuffer[this._vertexIndex++] = uvy0;\r\n        vertexBuffer[this._vertexIndex++] = width;\r\n        vertexBuffer[this._vertexIndex++] = height;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness;\r\n        // (1, 1) - 3\r\n        vertexBuffer[this._vertexIndex++] = bottomRight.x;\r\n        vertexBuffer[this._vertexIndex++] = bottomRight.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx1;\r\n        vertexBuffer[this._vertexIndex++] = uvy1;\r\n        vertexBuffer[this._vertexIndex++] = width;\r\n        vertexBuffer[this._vertexIndex++] = height;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness;\r\n    }\r\n    hasPendingDraws() {\r\n        return this._rectangleCount !== 0;\r\n    }\r\n    flush() {\r\n        // nothing to draw early exit\r\n        if (this._rectangleCount === 0) {\r\n            return;\r\n        }\r\n        const gl = this._gl;\r\n        // Bind the shader\r\n        this._shader.use();\r\n        // Bind the memory layout and upload data\r\n        this._layout.use(true);\r\n        // Update ortho matrix uniform\r\n        this._shader.setUniformMatrix('u_matrix', this._context.ortho);\r\n        // Bind index buffer\r\n        this._quads.bind();\r\n        // Draw all the quads\r\n        gl.drawElements(gl.TRIANGLES, this._rectangleCount * 6, this._quads.bufferGlType, 0);\r\n        GraphicsDiagnostics.DrawnImagesCount += this._rectangleCount;\r\n        GraphicsDiagnostics.DrawCallCount++;\r\n        // Reset\r\n        this._rectangleCount = 0;\r\n        this._vertexIndex = 0;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/circle-renderer/circle-renderer.frag.glsl\n/* harmony default export */ const circle_renderer_frag = (\"#version 300 es\\r\\nprecision highp float;\\r\\n\\r\\n// UV coord\\r\\nin vec2 v_uv;\\r\\n\\r\\n// Color coord to blend with image\\r\\nin lowp vec4 v_color;\\r\\n\\r\\n// Stroke color if used\\r\\nin lowp vec4 v_strokeColor;\\r\\n\\r\\n// Stroke thickness if used\\r\\nin lowp float v_strokeThickness;\\r\\n\\r\\n// Opacity\\r\\nin float v_opacity;\\r\\n\\r\\nout vec4 fragColor;\\r\\n\\r\\nvoid main() {\\r\\n  // make (0, 0) the center the uv \\r\\n  vec2 uv = v_uv * 2.0 - 1.0;\\r\\n\\r\\n  vec4 color = v_color;\\r\\n  vec4 strokeColor = v_strokeColor;\\r\\n\\r\\n  // circle border is at radius 1.0 \\r\\n  // dist is > 0 when inside the circle \\r\\n  float d = length(uv);\\r\\n  float dist = 1.0 - length(uv);\\r\\n\\r\\n  // Fade based on fwidth\\r\\n  float fade = fwidth(dot(uv, uv));\\r\\n\\r\\n  // if dist is greater than 0 step to 1;\\r\\n  // when we cross this 0 threshold add a smooth fade\\r\\n  float fill = smoothstep(-fade/2.0, fade/2.0, dist);\\r\\n\\r\\n  // if dist is greater than the stroke thickness step to 1\\r\\n  float stroke = 1.0 - smoothstep(v_strokeThickness, v_strokeThickness + fade, dist);\\r\\n\\r\\n  strokeColor.a *= fill * stroke;\\r\\n  strokeColor.rgb *= strokeColor.a;\\r\\n\\r\\n  color.a *= fill * (1.0 - stroke);\\r\\n  color.rgb *= color.a;\\r\\n\\r\\n  vec4 finalColor = mix(vec4(0.0), (color + strokeColor), fill);\\r\\n  finalColor.rgb = finalColor.rgb * v_opacity;\\r\\n  finalColor.a = finalColor.a * v_opacity;\\r\\n  fragColor = finalColor;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/circle-renderer/circle-renderer.vert.glsl\n/* harmony default export */ const circle_renderer_vert = (\"#version 300 es\\r\\nin vec2 a_position;\\r\\n\\r\\n// UV coordinate\\r\\nin vec2 a_uv;\\r\\nout vec2 v_uv;\\r\\n\\r\\n// Opacity \\r\\nin float a_opacity;\\r\\nout float v_opacity;\\r\\n\\r\\nin vec4 a_color;\\r\\nout vec4 v_color;\\r\\n\\r\\nin vec4 a_strokeColor;\\r\\nout vec4 v_strokeColor;\\r\\n\\r\\nin float a_strokeThickness;\\r\\nout float v_strokeThickness;\\r\\n\\r\\nuniform mat4 u_matrix;\\r\\n\\r\\n\\r\\nvoid main() {\\r\\n   // Set the vertex position using the ortho transform matrix\\r\\n   gl_Position = u_matrix * vec4(a_position, 0.0, 1.0);\\r\\n\\r\\n   // Pass through UV coords\\r\\n   v_uv = a_uv;\\r\\n   // Pass through the Opacity to the fragment shader\\r\\n   v_opacity = a_opacity;\\r\\n   // Pass through the color to the fragment shader\\r\\n   v_color = a_color;\\r\\n   // Pass through the stroke color to the fragment shader\\r\\n   v_strokeColor = a_strokeColor;\\r\\n   // Pass through the stroke thickenss to the fragment shader\\r\\n   v_strokeThickness = a_strokeThickness;\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/Context/circle-renderer/circle-renderer.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass CircleRenderer {\r\n    constructor() {\r\n        this.type = 'ex.circle';\r\n        this.priority = 0;\r\n        this._maxCircles = 10922; // max(uint16) / 6 verts\r\n        this._circleCount = 0;\r\n        this._vertexIndex = 0;\r\n    }\r\n    initialize(gl, context) {\r\n        this._gl = gl;\r\n        this._context = context;\r\n        this._shader = new Shader({\r\n            gl,\r\n            fragmentSource: circle_renderer_frag,\r\n            vertexSource: circle_renderer_vert\r\n        });\r\n        this._shader.compile();\r\n        // setup uniforms\r\n        this._shader.use();\r\n        this._shader.setUniformMatrix('u_matrix', context.ortho);\r\n        this._buffer = new VertexBuffer({\r\n            gl,\r\n            size: 14 * 4 * this._maxCircles,\r\n            type: 'dynamic'\r\n        });\r\n        this._layout = new VertexLayout({\r\n            gl,\r\n            shader: this._shader,\r\n            vertexBuffer: this._buffer,\r\n            attributes: [\r\n                ['a_position', 2],\r\n                ['a_uv', 2],\r\n                ['a_opacity', 1],\r\n                ['a_color', 4],\r\n                ['a_strokeColor', 4],\r\n                ['a_strokeThickness', 1]\r\n            ]\r\n        });\r\n        this._quads = new QuadIndexBuffer(gl, this._maxCircles, true);\r\n    }\r\n    _isFull() {\r\n        if (this._circleCount >= this._maxCircles) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    draw(pos, radius, color, stroke = Color.Transparent, strokeThickness = 0) {\r\n        if (this._isFull()) {\r\n            this.flush();\r\n        }\r\n        this._circleCount++;\r\n        // transform based on current context\r\n        const transform = this._context.getTransform();\r\n        const opacity = this._context.opacity;\r\n        const snapToPixel = this._context.snapToPixel;\r\n        const topLeft = transform.multiply(pos.add(vec(-radius, -radius)));\r\n        const topRight = transform.multiply(pos.add(vec(radius, -radius)));\r\n        const bottomRight = transform.multiply(pos.add(vec(radius, radius)));\r\n        const bottomLeft = transform.multiply(pos.add(vec(-radius, radius)));\r\n        if (snapToPixel) {\r\n            topLeft.x = ~~(topLeft.x + pixelSnapEpsilon);\r\n            topLeft.y = ~~(topLeft.y + pixelSnapEpsilon);\r\n            topRight.x = ~~(topRight.x + pixelSnapEpsilon);\r\n            topRight.y = ~~(topRight.y + pixelSnapEpsilon);\r\n            bottomLeft.x = ~~(bottomLeft.x + pixelSnapEpsilon);\r\n            bottomLeft.y = ~~(bottomLeft.y + pixelSnapEpsilon);\r\n            bottomRight.x = ~~(bottomRight.x + pixelSnapEpsilon);\r\n            bottomRight.y = ~~(bottomRight.y + pixelSnapEpsilon);\r\n        }\r\n        // TODO UV could be static vertex buffer\r\n        const uvx0 = 0;\r\n        const uvy0 = 0;\r\n        const uvx1 = 1;\r\n        const uvy1 = 1;\r\n        // update data\r\n        const vertexBuffer = this._layout.vertexBuffer.bufferData;\r\n        // (0, 0) - 0\r\n        vertexBuffer[this._vertexIndex++] = topLeft.x;\r\n        vertexBuffer[this._vertexIndex++] = topLeft.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx0;\r\n        vertexBuffer[this._vertexIndex++] = uvy0;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness / radius;\r\n        // (0, 1) - 1\r\n        vertexBuffer[this._vertexIndex++] = bottomLeft.x;\r\n        vertexBuffer[this._vertexIndex++] = bottomLeft.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx0;\r\n        vertexBuffer[this._vertexIndex++] = uvy1;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness / radius;\r\n        // (1, 0) - 2\r\n        vertexBuffer[this._vertexIndex++] = topRight.x;\r\n        vertexBuffer[this._vertexIndex++] = topRight.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx1;\r\n        vertexBuffer[this._vertexIndex++] = uvy0;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness / radius;\r\n        // (1, 1) - 3\r\n        vertexBuffer[this._vertexIndex++] = bottomRight.x;\r\n        vertexBuffer[this._vertexIndex++] = bottomRight.y;\r\n        vertexBuffer[this._vertexIndex++] = uvx1;\r\n        vertexBuffer[this._vertexIndex++] = uvy1;\r\n        vertexBuffer[this._vertexIndex++] = opacity;\r\n        vertexBuffer[this._vertexIndex++] = color.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = color.a;\r\n        vertexBuffer[this._vertexIndex++] = stroke.r / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.g / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.b / 255;\r\n        vertexBuffer[this._vertexIndex++] = stroke.a;\r\n        vertexBuffer[this._vertexIndex++] = strokeThickness / radius;\r\n    }\r\n    hasPendingDraws() {\r\n        return this._circleCount !== 0;\r\n    }\r\n    flush() {\r\n        // nothing to draw early exit\r\n        if (this._circleCount === 0) {\r\n            return;\r\n        }\r\n        const gl = this._gl;\r\n        // Bind the shader\r\n        this._shader.use();\r\n        // Bind the memory layout and upload data\r\n        this._layout.use(true);\r\n        // Update ortho matrix uniform\r\n        this._shader.setUniformMatrix('u_matrix', this._context.ortho);\r\n        // Bind index buffer\r\n        this._quads.bind();\r\n        // Draw all the quads\r\n        gl.drawElements(gl.TRIANGLES, this._circleCount * 6, this._quads.bufferGlType, 0);\r\n        GraphicsDiagnostics.DrawnImagesCount += this._circleCount;\r\n        GraphicsDiagnostics.DrawCallCount++;\r\n        // Reset\r\n        this._circleCount = 0;\r\n        this._vertexIndex = 0;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Pool.ts\n\r\nclass Pool {\r\n    constructor(builder, recycler, maxObjects = 100) {\r\n        this.builder = builder;\r\n        this.recycler = recycler;\r\n        this.maxObjects = maxObjects;\r\n        this.totalAllocations = 0;\r\n        this.index = 0;\r\n        this.objects = [];\r\n        this.disableWarnings = false;\r\n        this._logger = Logger.getInstance();\r\n    }\r\n    preallocate() {\r\n        for (let i = 0; i < this.maxObjects; i++) {\r\n            this.objects[i] = this.builder();\r\n        }\r\n    }\r\n    /**\r\n     * Use many instances out of the in the context and return all to the pool.\r\n     *\r\n     * By returning values out of the context they will be un-hooked from the pool and are free to be passed to consumers\r\n     * @param context\r\n     */\r\n    using(context) {\r\n        const result = context(this);\r\n        if (result) {\r\n            return this.done(...result);\r\n        }\r\n        return this.done();\r\n    }\r\n    /**\r\n     * Use a single instance out of th pool and immediately return it to the pool\r\n     * @param context\r\n     */\r\n    borrow(context) {\r\n        const object = this.get();\r\n        context(object);\r\n        this.index--;\r\n    }\r\n    /**\r\n     * Retrieve a value from the pool, will allocate a new instance if necessary or recycle from the pool\r\n     * @param args\r\n     */\r\n    get(...args) {\r\n        if (this.index === this.maxObjects) {\r\n            if (!this.disableWarnings) {\r\n                this._logger.warn('Max pooled objects reached, possible memory leak? Doubling');\r\n            }\r\n            this.maxObjects = this.maxObjects * 2;\r\n        }\r\n        if (this.objects[this.index]) {\r\n            // Pool has an available object already constructed\r\n            return this.recycler(this.objects[this.index++], ...args);\r\n        }\r\n        else {\r\n            // New allocation\r\n            this.totalAllocations++;\r\n            const object = (this.objects[this.index++] = this.builder(...args));\r\n            return object;\r\n        }\r\n    }\r\n    done(...objects) {\r\n        // All objects in pool now considered \"free\"\r\n        this.index = 0;\r\n        for (const object of objects) {\r\n            const poolIndex = this.objects.indexOf(object);\r\n            // Build a new object to take the pool place\r\n            this.objects[poolIndex] = this.builder(); // TODO problematic 0-arg only support\r\n            this.totalAllocations++;\r\n        }\r\n        return objects;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/draw-call.ts\n\r\n\r\nclass DrawCall {\r\n    constructor() {\r\n        this.z = 0;\r\n        this.priority = 0;\r\n        this.transform = AffineMatrix.identity();\r\n        this.state = {\r\n            z: 0,\r\n            opacity: 1,\r\n            tint: Color.White,\r\n            material: null\r\n        };\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/material.ts\n\r\nconst defaultVertexSource = `#version 300 es\r\nin vec2 a_position;\r\n\r\nin vec2 a_uv;\r\nout vec2 v_uv;\r\n\r\nuniform mat4 u_matrix;\r\nuniform mat4 u_transform;\r\n\r\nvoid main() {\r\n  // Set the vertex position using the ortho & transform matrix\r\n  gl_Position = u_matrix * u_transform * vec4(a_position, 0.0, 1.0);\r\n\r\n  // Pass through the UV coord to the fragment shader\r\n  v_uv = a_uv;\r\n}\r\n`;\r\nclass Material {\r\n    constructor(options) {\r\n        this._color = Color.Transparent;\r\n        this._initialized = false;\r\n        const { color, name, vertexSource, fragmentSource } = options;\r\n        this._name = name;\r\n        this._vertexSource = vertexSource !== null && vertexSource !== void 0 ? vertexSource : defaultVertexSource;\r\n        this._fragmentSource = fragmentSource;\r\n        this._color = color !== null && color !== void 0 ? color : this._color;\r\n    }\r\n    initialize(_gl, _context) {\r\n        if (this._initialized) {\r\n            return;\r\n        }\r\n        this._shader = _context.createShader({\r\n            vertexSource: this._vertexSource,\r\n            fragmentSource: this._fragmentSource\r\n        });\r\n        this._shader.compile();\r\n        this._initialized = true;\r\n    }\r\n    get name() {\r\n        var _a;\r\n        return (_a = this._name) !== null && _a !== void 0 ? _a : 'anonymous material';\r\n    }\r\n    getShader() {\r\n        return this._shader;\r\n    }\r\n    use() {\r\n        if (this._initialized) {\r\n            // bind the shader\r\n            this._shader.use();\r\n            // Apply standard uniforms\r\n            this._shader.trySetUniformFloatColor('u_color', this._color);\r\n        }\r\n        else {\r\n            throw Error(`Material ${this.name} not yet initialized, use the ExcaliburGraphicsContext.createMaterial() to work around this.`);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/material-renderer/material-renderer.ts\n\r\n\r\n\r\n\r\n\r\nclass MaterialRenderer {\r\n    constructor() {\r\n        this.type = 'ex.material';\r\n        this.priority = 0;\r\n        this._textures = [];\r\n    }\r\n    initialize(gl, context) {\r\n        this._gl = gl;\r\n        this._context = context;\r\n        // Setup memory layout\r\n        this._buffer = new VertexBuffer({\r\n            gl,\r\n            size: 4 * 4,\r\n            type: 'dynamic'\r\n        });\r\n        // Setup a vertex layout/buffer to the material\r\n        this._layout = new VertexLayout({\r\n            gl,\r\n            vertexBuffer: this._buffer,\r\n            attributes: [\r\n                ['a_position', 2],\r\n                ['a_uv', 2]\r\n            ]\r\n        });\r\n        // Setup index buffer\r\n        this._quads = new QuadIndexBuffer(gl, 1, true);\r\n    }\r\n    draw(image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight) {\r\n        var _a, _b, _c, _d;\r\n        const gl = this._gl;\r\n        // Extract context info\r\n        const material = this._context.material;\r\n        material.initialize(gl, this._context);\r\n        const transform = this._context.getTransform();\r\n        const opacity = this._context.opacity;\r\n        // material shader\r\n        const shader = material.getShader();\r\n        // construct geometry, or hold on to it in the material?\r\n        // geometry primitive for drawing rectangles?\r\n        // update data\r\n        const vertexBuffer = this._layout.vertexBuffer.bufferData;\r\n        let vertexIndex = 0;\r\n        let width = (image === null || image === void 0 ? void 0 : image.width) || swidth || 0;\r\n        let height = (image === null || image === void 0 ? void 0 : image.height) || sheight || 0;\r\n        let view = [0, 0, (_a = swidth !== null && swidth !== void 0 ? swidth : image === null || image === void 0 ? void 0 : image.width) !== null && _a !== void 0 ? _a : 0, (_b = sheight !== null && sheight !== void 0 ? sheight : image === null || image === void 0 ? void 0 : image.height) !== null && _b !== void 0 ? _b : 0];\r\n        let dest = [sx !== null && sx !== void 0 ? sx : 1, sy !== null && sy !== void 0 ? sy : 1];\r\n        // If destination is specified, update view and dest\r\n        if (dx !== undefined && dy !== undefined && dwidth !== undefined && dheight !== undefined) {\r\n            view = [sx !== null && sx !== void 0 ? sx : 1, sy !== null && sy !== void 0 ? sy : 1, (_c = swidth !== null && swidth !== void 0 ? swidth : image === null || image === void 0 ? void 0 : image.width) !== null && _c !== void 0 ? _c : 0, (_d = sheight !== null && sheight !== void 0 ? sheight : image === null || image === void 0 ? void 0 : image.height) !== null && _d !== void 0 ? _d : 0];\r\n            dest = [dx, dy];\r\n            width = dwidth;\r\n            height = dheight;\r\n        }\r\n        sx = view[0];\r\n        sy = view[1];\r\n        const sw = view[2];\r\n        const sh = view[3];\r\n        const topLeft = vec(dest[0], dest[1]);\r\n        const topRight = vec(dest[0] + width, dest[1]);\r\n        const bottomLeft = vec(dest[0], dest[1] + height);\r\n        const bottomRight = vec(dest[0] + width, dest[1] + height);\r\n        const imageWidth = image.width || width;\r\n        const imageHeight = image.height || height;\r\n        const uvx0 = (sx) / imageWidth;\r\n        const uvy0 = (sy) / imageHeight;\r\n        const uvx1 = (sx + sw - 0.01) / imageWidth;\r\n        const uvy1 = (sy + sh - 0.01) / imageHeight;\r\n        // (0, 0) - 0\r\n        vertexBuffer[vertexIndex++] = topLeft.x;\r\n        vertexBuffer[vertexIndex++] = topLeft.y;\r\n        vertexBuffer[vertexIndex++] = uvx0;\r\n        vertexBuffer[vertexIndex++] = uvy0;\r\n        // (0, 1) - 1\r\n        vertexBuffer[vertexIndex++] = bottomLeft.x;\r\n        vertexBuffer[vertexIndex++] = bottomLeft.y;\r\n        vertexBuffer[vertexIndex++] = uvx0;\r\n        vertexBuffer[vertexIndex++] = uvy1;\r\n        // (1, 0) - 2\r\n        vertexBuffer[vertexIndex++] = topRight.x;\r\n        vertexBuffer[vertexIndex++] = topRight.y;\r\n        vertexBuffer[vertexIndex++] = uvx1;\r\n        vertexBuffer[vertexIndex++] = uvy0;\r\n        // (1, 1) - 3\r\n        vertexBuffer[vertexIndex++] = bottomRight.x;\r\n        vertexBuffer[vertexIndex++] = bottomRight.y;\r\n        vertexBuffer[vertexIndex++] = uvx1;\r\n        vertexBuffer[vertexIndex++] = uvy1;\r\n        // This creates and uploads the texture if not already done\r\n        const texture = this._addImageAsTexture(image);\r\n        // apply material\r\n        material.use();\r\n        this._layout.shader = shader;\r\n        // apply layout and geometry\r\n        this._layout.use(true);\r\n        // apply opacity\r\n        shader.trySetUniformFloat('u_opacity', opacity);\r\n        // apply resolution\r\n        shader.trySetUniformFloatVector('u_resolution', vec(this._context.width, this._context.height));\r\n        // apply size\r\n        shader.trySetUniformFloatVector('u_size', vec(sw, sh));\r\n        // apply orthographic projection\r\n        shader.trySetUniformMatrix('u_matrix', this._context.ortho);\r\n        // apply geometry transform\r\n        shader.trySetUniformMatrix('u_transform', transform.to4x4());\r\n        // bind graphic image texture 'uniform sampler2D u_graphic;'\r\n        gl.activeTexture(gl.TEXTURE0 + 0);\r\n        gl.bindTexture(gl.TEXTURE_2D, texture);\r\n        shader.trySetUniformInt('u_graphic', 0);\r\n        // bind quad index buffer\r\n        this._quads.bind();\r\n        // Draw a single quad\r\n        gl.drawElements(gl.TRIANGLES, 6, this._quads.bufferGlType, 0);\r\n    }\r\n    _addImageAsTexture(image) {\r\n        const maybeFiltering = image.getAttribute('filtering');\r\n        let filtering = null;\r\n        if (maybeFiltering === ImageFiltering.Blended ||\r\n            maybeFiltering === ImageFiltering.Pixel) {\r\n            filtering = maybeFiltering;\r\n        }\r\n        const force = image.getAttribute('forceUpload') === 'true' ? true : false;\r\n        const texture = this._context.textureLoader.load(image, filtering, force);\r\n        // remove force attribute after upload\r\n        image.removeAttribute('forceUpload');\r\n        if (this._textures.indexOf(texture) === -1) {\r\n            this._textures.push(texture);\r\n        }\r\n        return texture;\r\n    }\r\n    hasPendingDraws() {\r\n        return false;\r\n    }\r\n    flush() {\r\n        // flush does not do anything, material renderer renders immediately per draw\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/ExcaliburGraphicsContextWebGL.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// renderers\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst pixelSnapEpsilon = 0.0001;\r\nclass ExcaliburGraphicsContextWebGLDebug {\r\n    constructor(_webglCtx) {\r\n        this._webglCtx = _webglCtx;\r\n        this._debugText = new DebugText();\r\n    }\r\n    /**\r\n     * Draw a debugging rectangle to the context\r\n     * @param x\r\n     * @param y\r\n     * @param width\r\n     * @param height\r\n     */\r\n    drawRect(x, y, width, height, rectOptions = { color: Color.Black }) {\r\n        this.drawLine(vec(x, y), vec(x + width, y), { ...rectOptions });\r\n        this.drawLine(vec(x + width, y), vec(x + width, y + height), { ...rectOptions });\r\n        this.drawLine(vec(x + width, y + height), vec(x, y + height), { ...rectOptions });\r\n        this.drawLine(vec(x, y + height), vec(x, y), { ...rectOptions });\r\n    }\r\n    /**\r\n     * Draw a debugging line to the context\r\n     * @param start\r\n     * @param end\r\n     * @param lineOptions\r\n     */\r\n    drawLine(start, end, lineOptions = { color: Color.Black }) {\r\n        this._webglCtx.draw('ex.line', start, end, lineOptions.color);\r\n    }\r\n    /**\r\n     * Draw a debugging point to the context\r\n     * @param point\r\n     * @param pointOptions\r\n     */\r\n    drawPoint(point, pointOptions = { color: Color.Black, size: 5 }) {\r\n        this._webglCtx.draw('ex.point', point, pointOptions.color, pointOptions.size);\r\n    }\r\n    drawText(text, pos) {\r\n        this._debugText.write(this._webglCtx, text, pos);\r\n    }\r\n}\r\nclass ExcaliburGraphicsContextWebGL {\r\n    get z() {\r\n        return this._state.current.z;\r\n    }\r\n    set z(value) {\r\n        this._state.current.z = value;\r\n    }\r\n    get opacity() {\r\n        return this._state.current.opacity;\r\n    }\r\n    set opacity(value) {\r\n        this._state.current.opacity = value;\r\n    }\r\n    get tint() {\r\n        return this._state.current.tint;\r\n    }\r\n    set tint(color) {\r\n        this._state.current.tint = color;\r\n    }\r\n    get width() {\r\n        return this.__gl.canvas.width;\r\n    }\r\n    get height() {\r\n        return this.__gl.canvas.height;\r\n    }\r\n    get ortho() {\r\n        return this._ortho;\r\n    }\r\n    /**\r\n     * Checks the underlying webgl implementation if the requested internal resolution is supported\r\n     * @param dim\r\n     */\r\n    checkIfResolutionSupported(dim) {\r\n        // Slight hack based on this thread https://groups.google.com/g/webgl-dev-list/c/AHONvz3oQTo\r\n        let supported = true;\r\n        if (dim.width > 4096 || dim.height > 4096) {\r\n            supported = false;\r\n        }\r\n        return supported;\r\n    }\r\n    constructor(options) {\r\n        this._logger = Logger.getInstance();\r\n        this._renderers = new Map();\r\n        this._isDrawLifecycle = false;\r\n        this.useDrawSorting = true;\r\n        this._drawCallPool = new Pool(() => new DrawCall(), (instance) => {\r\n            instance.priority = 0;\r\n            instance.z = 0;\r\n            instance.renderer = undefined;\r\n            instance.args = undefined;\r\n            return instance;\r\n        }, 4000);\r\n        this._drawCalls = [];\r\n        // Postprocessing is a tuple with 2 render targets, these are flip-flopped during the postprocessing process\r\n        this._postProcessTargets = [];\r\n        this._postprocessors = [];\r\n        this._transform = new TransformStack();\r\n        this._state = new StateStack();\r\n        this.snapToPixel = false;\r\n        this.smoothing = false;\r\n        this.backgroundColor = Color.ExcaliburBlue;\r\n        this._alreadyWarnedDrawLifecycle = false;\r\n        this.debug = new ExcaliburGraphicsContextWebGLDebug(this);\r\n        this._totalPostProcessorTime = 0;\r\n        const { canvasElement, enableTransparency, smoothing, snapToPixel, backgroundColor, useDrawSorting } = options;\r\n        this.__gl = canvasElement.getContext('webgl2', {\r\n            antialias: smoothing !== null && smoothing !== void 0 ? smoothing : this.smoothing,\r\n            premultipliedAlpha: false,\r\n            alpha: enableTransparency !== null && enableTransparency !== void 0 ? enableTransparency : true,\r\n            depth: true,\r\n            powerPreference: 'high-performance'\r\n            // TODO Chromium fixed the bug where this didn't work now it breaks CI :(\r\n            // failIfMajorPerformanceCaveat: true\r\n        });\r\n        if (!this.__gl) {\r\n            throw Error('Failed to retrieve webgl context from browser');\r\n        }\r\n        this.textureLoader = new TextureLoader(this.__gl);\r\n        this.snapToPixel = snapToPixel !== null && snapToPixel !== void 0 ? snapToPixel : this.snapToPixel;\r\n        this.smoothing = smoothing !== null && smoothing !== void 0 ? smoothing : this.smoothing;\r\n        this.backgroundColor = backgroundColor !== null && backgroundColor !== void 0 ? backgroundColor : this.backgroundColor;\r\n        this.useDrawSorting = useDrawSorting !== null && useDrawSorting !== void 0 ? useDrawSorting : this.useDrawSorting;\r\n        this._drawCallPool.disableWarnings = true;\r\n        this._drawCallPool.preallocate();\r\n        this._init();\r\n    }\r\n    _init() {\r\n        const gl = this.__gl;\r\n        // Setup viewport and view matrix\r\n        this._ortho = Matrix.ortho(0, gl.canvas.width, gl.canvas.height, 0, 400, -400);\r\n        gl.viewport(0, 0, gl.canvas.width, gl.canvas.height);\r\n        // Clear background\r\n        gl.clearColor(this.backgroundColor.r / 255, this.backgroundColor.g / 255, this.backgroundColor.b / 255, this.backgroundColor.a);\r\n        gl.clear(gl.COLOR_BUFFER_BIT);\r\n        // Enable alpha blending\r\n        // https://www.realtimerendering.com/blog/gpus-prefer-premultiplication/\r\n        gl.enable(gl.BLEND);\r\n        gl.blendEquation(gl.FUNC_ADD);\r\n        gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\r\n        gl.blendEquationSeparate(gl.FUNC_ADD, gl.FUNC_ADD);\r\n        gl.blendFuncSeparate(gl.ONE, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\r\n        // Setup builtin renderers\r\n        this.register(new ImageRenderer());\r\n        this.register(new MaterialRenderer());\r\n        this.register(new RectangleRenderer());\r\n        this.register(new CircleRenderer());\r\n        this.register(new PointRenderer());\r\n        this.register(new LineRenderer());\r\n        this._screenRenderer = new ScreenPassPainter(gl);\r\n        this._renderTarget = new RenderTarget({\r\n            gl,\r\n            width: gl.canvas.width,\r\n            height: gl.canvas.height\r\n        });\r\n        this._postProcessTargets = [\r\n            new RenderTarget({\r\n                gl,\r\n                width: gl.canvas.width,\r\n                height: gl.canvas.height\r\n            }),\r\n            new RenderTarget({\r\n                gl,\r\n                width: gl.canvas.width,\r\n                height: gl.canvas.height\r\n            })\r\n        ];\r\n    }\r\n    register(renderer) {\r\n        this._renderers.set(renderer.type, renderer);\r\n        renderer.initialize(this.__gl, this);\r\n    }\r\n    get(rendererName) {\r\n        return this._renderers.get(rendererName);\r\n    }\r\n    _isCurrentRenderer(renderer) {\r\n        if (!this._currentRenderer || this._currentRenderer === renderer) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    beginDrawLifecycle() {\r\n        this._isDrawLifecycle = true;\r\n    }\r\n    endDrawLifecycle() {\r\n        this._isDrawLifecycle = false;\r\n    }\r\n    draw(rendererName, ...args) {\r\n        if (!this._isDrawLifecycle && !this._alreadyWarnedDrawLifecycle) {\r\n            this._logger.warn(`Attempting to draw outside the the drawing lifecycle (preDraw/postDraw) is not supported and is a source of bugs/errors.\\n` +\r\n                `If you want to do custom drawing, use Actor.graphics, or any onPreDraw or onPostDraw handler.`);\r\n            this._alreadyWarnedDrawLifecycle = true;\r\n        }\r\n        const renderer = this._renderers.get(rendererName);\r\n        if (renderer) {\r\n            if (this.useDrawSorting) {\r\n                const drawCall = this._drawCallPool.get();\r\n                drawCall.z = this._state.current.z;\r\n                drawCall.priority = renderer.priority;\r\n                drawCall.renderer = rendererName;\r\n                this.getTransform().clone(drawCall.transform);\r\n                drawCall.state.z = this._state.current.z;\r\n                drawCall.state.opacity = this._state.current.opacity;\r\n                drawCall.state.tint = this._state.current.tint;\r\n                drawCall.state.material = this._state.current.material;\r\n                drawCall.args = args;\r\n                this._drawCalls.push(drawCall);\r\n            }\r\n            else {\r\n                // Set the current renderer if not defined\r\n                if (!this._currentRenderer) {\r\n                    this._currentRenderer = renderer;\r\n                }\r\n                if (!this._isCurrentRenderer(renderer)) {\r\n                    // switching graphics means we must flush the previous\r\n                    this._currentRenderer.flush();\r\n                }\r\n                // If we are still using the same renderer we can add to the current batch\r\n                renderer.draw(...args);\r\n                this._currentRenderer = renderer;\r\n            }\r\n        }\r\n        else {\r\n            throw Error(`No renderer with name ${rendererName} has been registered`);\r\n        }\r\n    }\r\n    resetTransform() {\r\n        this._transform.current = AffineMatrix.identity();\r\n    }\r\n    updateViewport(resolution) {\r\n        const gl = this.__gl;\r\n        this._ortho = this._ortho = Matrix.ortho(0, resolution.width, resolution.height, 0, 400, -400);\r\n        this._renderTarget.setResolution(gl.canvas.width, gl.canvas.height);\r\n        this._postProcessTargets[0].setResolution(gl.canvas.width, gl.canvas.height);\r\n        this._postProcessTargets[1].setResolution(gl.canvas.width, gl.canvas.height);\r\n    }\r\n    drawImage(image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight) {\r\n        if (swidth === 0 || sheight === 0) {\r\n            return; // zero dimension dest exit early\r\n        }\r\n        else if (dwidth === 0 || dheight === 0) {\r\n            return; // zero dimension dest exit early\r\n        }\r\n        else if (image.width === 0 || image.height === 0) {\r\n            return; // zero dimension source exit early\r\n        }\r\n        if (!image) {\r\n            Logger.getInstance().warn('Cannot draw a null or undefined image');\r\n            // tslint:disable-next-line: no-console\r\n            if (console.trace) {\r\n                // tslint:disable-next-line: no-console\r\n                console.trace();\r\n            }\r\n            return;\r\n        }\r\n        if (this._state.current.material) {\r\n            this.draw('ex.material', image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight);\r\n        }\r\n        else {\r\n            this.draw('ex.image', image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight);\r\n        }\r\n    }\r\n    drawLine(start, end, color, thickness = 1) {\r\n        this.draw('ex.rectangle', start, end, color, thickness);\r\n    }\r\n    drawRectangle(pos, width, height, color, stroke, strokeThickness) {\r\n        this.draw('ex.rectangle', pos, width, height, color, stroke, strokeThickness);\r\n    }\r\n    drawCircle(pos, radius, color, stroke, thickness) {\r\n        this.draw('ex.circle', pos, radius, color, stroke, thickness);\r\n    }\r\n    save() {\r\n        this._transform.save();\r\n        this._state.save();\r\n    }\r\n    restore() {\r\n        this._transform.restore();\r\n        this._state.restore();\r\n    }\r\n    translate(x, y) {\r\n        this._transform.translate(this.snapToPixel ? ~~(x + pixelSnapEpsilon) : x, this.snapToPixel ? ~~(y + pixelSnapEpsilon) : y);\r\n    }\r\n    rotate(angle) {\r\n        this._transform.rotate(angle);\r\n    }\r\n    scale(x, y) {\r\n        this._transform.scale(x, y);\r\n    }\r\n    transform(matrix) {\r\n        this._transform.current = matrix;\r\n    }\r\n    getTransform() {\r\n        return this._transform.current;\r\n    }\r\n    multiply(m) {\r\n        this._transform.current.multiply(m, this._transform.current);\r\n    }\r\n    addPostProcessor(postprocessor) {\r\n        this._postprocessors.push(postprocessor);\r\n        postprocessor.initialize(this.__gl);\r\n    }\r\n    removePostProcessor(postprocessor) {\r\n        const index = this._postprocessors.indexOf(postprocessor);\r\n        if (index !== -1) {\r\n            this._postprocessors.splice(index, 1);\r\n        }\r\n    }\r\n    clearPostProcessors() {\r\n        this._postprocessors.length = 0;\r\n    }\r\n    updatePostProcessors(delta) {\r\n        for (const postprocessor of this._postprocessors) {\r\n            const shader = postprocessor.getShader();\r\n            shader.use();\r\n            const uniforms = shader.getUniforms();\r\n            this._totalPostProcessorTime += delta;\r\n            if (uniforms.find(u => u.name === 'u_time_ms')) {\r\n                shader.setUniformFloat('u_time_ms', this._totalPostProcessorTime);\r\n            }\r\n            if (uniforms.find(u => u.name === 'u_elapsed_ms')) {\r\n                shader.setUniformFloat('u_elapsed_ms', delta);\r\n            }\r\n            if (uniforms.find(u => u.name === 'u_resolution')) {\r\n                shader.setUniformFloatVector('u_resolution', vec(this.width, this.height));\r\n            }\r\n            if (postprocessor.onUpdate) {\r\n                postprocessor.onUpdate(delta);\r\n            }\r\n        }\r\n    }\r\n    set material(material) {\r\n        this._state.current.material = material;\r\n    }\r\n    get material() {\r\n        return this._state.current.material;\r\n    }\r\n    /**\r\n     * Creates and initializes the material which compiles the internal shader\r\n     * @param options\r\n     * @returns Material\r\n     */\r\n    createMaterial(options) {\r\n        const material = new Material(options);\r\n        material.initialize(this.__gl, this);\r\n        return material;\r\n    }\r\n    createShader(options) {\r\n        const gl = this.__gl;\r\n        const { vertexSource, fragmentSource } = options;\r\n        const shader = new Shader({\r\n            gl,\r\n            vertexSource,\r\n            fragmentSource\r\n        });\r\n        shader.compile();\r\n        return shader;\r\n    }\r\n    clear() {\r\n        const gl = this.__gl;\r\n        this._renderTarget.use();\r\n        gl.clearColor(this.backgroundColor.r / 255, this.backgroundColor.g / 255, this.backgroundColor.b / 255, this.backgroundColor.a);\r\n        // Clear the context with the newly set color. This is\r\n        // the function call that actually does the drawing.\r\n        gl.clear(gl.COLOR_BUFFER_BIT);\r\n    }\r\n    /**\r\n     * Flushes all batched rendering to the screen\r\n     */\r\n    flush() {\r\n        const gl = this.__gl;\r\n        // render target captures all draws and redirects to the render target\r\n        this._renderTarget.use();\r\n        if (this.useDrawSorting) {\r\n            // sort draw calls\r\n            // Find the original order of the first instance of the draw call\r\n            const originalSort = new Map();\r\n            for (const [name] of this._renderers) {\r\n                const firstIndex = this._drawCalls.findIndex(dc => dc.renderer === name);\r\n                originalSort.set(name, firstIndex);\r\n            }\r\n            this._drawCalls.sort((a, b) => {\r\n                const zIndex = a.z - b.z;\r\n                const originalSortOrder = originalSort.get(a.renderer) - originalSort.get(b.renderer);\r\n                const priority = a.priority - b.priority;\r\n                if (zIndex === 0) { // sort by z first\r\n                    if (priority === 0) { // sort by priority\r\n                        return originalSortOrder; // use the original order to inform draw call packing to maximally preserve painter order\r\n                    }\r\n                    return priority;\r\n                }\r\n                return zIndex;\r\n            });\r\n            const oldTransform = this._transform.current;\r\n            const oldState = this._state.current;\r\n            if (this._drawCalls.length) {\r\n                let currentRendererName = this._drawCalls[0].renderer;\r\n                let currentRenderer = this._renderers.get(currentRendererName);\r\n                for (let i = 0; i < this._drawCalls.length; i++) {\r\n                    // hydrate the state for renderers\r\n                    this._transform.current = this._drawCalls[i].transform;\r\n                    this._state.current = this._drawCalls[i].state;\r\n                    if (this._drawCalls[i].renderer !== currentRendererName) {\r\n                        // switching graphics renderer means we must flush the previous\r\n                        currentRenderer.flush();\r\n                        currentRendererName = this._drawCalls[i].renderer;\r\n                        currentRenderer = this._renderers.get(currentRendererName);\r\n                    }\r\n                    // If we are still using the same renderer we can add to the current batch\r\n                    currentRenderer.draw(...this._drawCalls[i].args);\r\n                }\r\n                if (currentRenderer.hasPendingDraws()) {\r\n                    currentRenderer.flush();\r\n                }\r\n            }\r\n            // reset state\r\n            this._transform.current = oldTransform;\r\n            this._state.current = oldState;\r\n            // reclaim draw calls\r\n            this._drawCallPool.done();\r\n            this._drawCalls.length = 0;\r\n        }\r\n        else {\r\n            // This is the final flush at the moment to draw any leftover pending draw\r\n            for (const renderer of this._renderers.values()) {\r\n                if (renderer.hasPendingDraws()) {\r\n                    renderer.flush();\r\n                }\r\n            }\r\n        }\r\n        this._renderTarget.disable();\r\n        // post process step\r\n        const source = this._renderTarget.toRenderSource();\r\n        source.use();\r\n        // flip flop render targets\r\n        for (let i = 0; i < this._postprocessors.length; i++) {\r\n            this._postProcessTargets[i % 2].use();\r\n            this._screenRenderer.renderWithPostProcessor(this._postprocessors[i]);\r\n            this._postProcessTargets[i % 2].toRenderSource().use();\r\n        }\r\n        // passing null switches rendering back to the canvas\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n        this._screenRenderer.renderToScreen();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Context/ExcaliburGraphicsContext2DCanvas.ts\n\r\n\r\n\r\n\r\nconst ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon = 0.0001;\r\nclass ExcaliburGraphicsContext2DCanvasDebug {\r\n    constructor(_ex) {\r\n        this._ex = _ex;\r\n        this._debugText = new DebugText();\r\n    }\r\n    /**\r\n     * Draw a debug rectangle to the context\r\n     * @param x\r\n     * @param y\r\n     * @param width\r\n     * @param height\r\n     */\r\n    drawRect(x, y, width, height) {\r\n        this._ex.__ctx.save();\r\n        this._ex.__ctx.strokeStyle = 'red';\r\n        this._ex.__ctx.strokeRect(this._ex.snapToPixel ? ~~(x + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : x, this._ex.snapToPixel ? ~~(y + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : y, this._ex.snapToPixel ? ~~(width + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : width, this._ex.snapToPixel ? ~~(height + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : height);\r\n        this._ex.__ctx.restore();\r\n    }\r\n    drawLine(start, end, lineOptions = { color: Color.Black }) {\r\n        this._ex.__ctx.save();\r\n        this._ex.__ctx.beginPath();\r\n        this._ex.__ctx.strokeStyle = lineOptions.color.toString();\r\n        this._ex.__ctx.moveTo(this._ex.snapToPixel ? ~~(start.x + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : start.x, this._ex.snapToPixel ? ~~(start.y + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : start.y);\r\n        this._ex.__ctx.lineTo(this._ex.snapToPixel ? ~~(end.x + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : end.x, this._ex.snapToPixel ? ~~(end.y + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : end.y);\r\n        this._ex.__ctx.lineWidth = 2;\r\n        this._ex.__ctx.stroke();\r\n        this._ex.__ctx.closePath();\r\n        this._ex.__ctx.restore();\r\n    }\r\n    drawPoint(point, pointOptions = { color: Color.Black, size: 5 }) {\r\n        this._ex.__ctx.save();\r\n        this._ex.__ctx.beginPath();\r\n        this._ex.__ctx.fillStyle = pointOptions.color.toString();\r\n        this._ex.__ctx.arc(this._ex.snapToPixel ? ~~(point.x + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : point.x, this._ex.snapToPixel ? ~~(point.y + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : point.y, pointOptions.size, 0, Math.PI * 2);\r\n        this._ex.__ctx.fill();\r\n        this._ex.__ctx.closePath();\r\n        this._ex.__ctx.restore();\r\n    }\r\n    drawText(text, pos) {\r\n        this._debugText.write(this._ex, text, pos);\r\n    }\r\n}\r\nclass ExcaliburGraphicsContext2DCanvas {\r\n    get width() {\r\n        return this.__ctx.canvas.width;\r\n    }\r\n    get height() {\r\n        return this.__ctx.canvas.height;\r\n    }\r\n    get opacity() {\r\n        return this._state.current.opacity;\r\n    }\r\n    set opacity(value) {\r\n        this._state.current.opacity = value;\r\n    }\r\n    get tint() {\r\n        return this._state.current.tint;\r\n    }\r\n    set tint(color) {\r\n        this._state.current.tint = color;\r\n    }\r\n    get smoothing() {\r\n        return this.__ctx.imageSmoothingEnabled;\r\n    }\r\n    set smoothing(value) {\r\n        this.__ctx.imageSmoothingEnabled = value;\r\n    }\r\n    constructor(options) {\r\n        /**\r\n         * Unused in Canvas implementation\r\n         */\r\n        this.useDrawSorting = false;\r\n        /**\r\n         * Unused in Canvas implementation\r\n         */\r\n        this.z = 0;\r\n        this.backgroundColor = Color.ExcaliburBlue;\r\n        this._state = new StateStack();\r\n        this.snapToPixel = false;\r\n        this.debug = new ExcaliburGraphicsContext2DCanvasDebug(this);\r\n        const { canvasElement, enableTransparency, snapToPixel, smoothing, backgroundColor } = options;\r\n        this.__ctx = canvasElement.getContext('2d', {\r\n            alpha: enableTransparency !== null && enableTransparency !== void 0 ? enableTransparency : true\r\n        });\r\n        this.backgroundColor = backgroundColor !== null && backgroundColor !== void 0 ? backgroundColor : this.backgroundColor;\r\n        this.snapToPixel = snapToPixel !== null && snapToPixel !== void 0 ? snapToPixel : this.snapToPixel;\r\n        this.smoothing = smoothing !== null && smoothing !== void 0 ? smoothing : this.smoothing;\r\n    }\r\n    resetTransform() {\r\n        this.__ctx.resetTransform();\r\n    }\r\n    updateViewport(_resolution) {\r\n        // pass\r\n    }\r\n    drawImage(image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight) {\r\n        if (swidth === 0 || sheight === 0) {\r\n            return; // zero dimension dest exit early\r\n        }\r\n        else if (dwidth === 0 || dheight === 0) {\r\n            return; // zero dimension dest exit early\r\n        }\r\n        else if (image.width === 0 || image.height === 0) {\r\n            return; // zero dimension source exit early\r\n        }\r\n        this.__ctx.globalAlpha = this.opacity;\r\n        const args = [image, sx, sy, swidth, sheight, dx, dy, dwidth, dheight]\r\n            .filter((a) => a !== undefined)\r\n            .map((a) => (typeof a === 'number' && this.snapToPixel ? ~~a : a));\r\n        this.__ctx.drawImage.apply(this.__ctx, args);\r\n        GraphicsDiagnostics.DrawCallCount++;\r\n        GraphicsDiagnostics.DrawnImagesCount = 1;\r\n    }\r\n    drawLine(start, end, color, thickness = 1) {\r\n        this.__ctx.save();\r\n        this.__ctx.beginPath();\r\n        this.__ctx.strokeStyle = color.toString();\r\n        this.__ctx.moveTo(this.snapToPixel ? ~~(start.x + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : start.x, this.snapToPixel ? ~~(start.y + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : start.y);\r\n        this.__ctx.lineTo(this.snapToPixel ? ~~(end.x + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : end.x, this.snapToPixel ? ~~(end.y + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : end.y);\r\n        this.__ctx.lineWidth = thickness;\r\n        this.__ctx.stroke();\r\n        this.__ctx.closePath();\r\n        this.__ctx.restore();\r\n    }\r\n    drawRectangle(pos, width, height, color) {\r\n        this.__ctx.save();\r\n        this.__ctx.fillStyle = color.toString();\r\n        this.__ctx.fillRect(this.snapToPixel ? ~~(pos.x + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : pos.x, this.snapToPixel ? ~~(pos.y + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : pos.y, this.snapToPixel ? ~~(width + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : width, this.snapToPixel ? ~~(height + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : height);\r\n        this.__ctx.restore();\r\n    }\r\n    drawCircle(pos, radius, color, stroke, thickness) {\r\n        this.__ctx.save();\r\n        this.__ctx.beginPath();\r\n        if (stroke) {\r\n            this.__ctx.strokeStyle = stroke.toString();\r\n        }\r\n        if (thickness) {\r\n            this.__ctx.lineWidth = thickness;\r\n        }\r\n        this.__ctx.fillStyle = color.toString();\r\n        this.__ctx.arc(this.snapToPixel ? ~~(pos.x + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : pos.x, this.snapToPixel ? ~~(pos.y + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : pos.y, radius, 0, Math.PI * 2);\r\n        this.__ctx.fill();\r\n        if (stroke) {\r\n            this.__ctx.stroke();\r\n        }\r\n        this.__ctx.closePath();\r\n        this.__ctx.restore();\r\n    }\r\n    /**\r\n     * Save the current state of the canvas to the stack (transforms and opacity)\r\n     */\r\n    save() {\r\n        this.__ctx.save();\r\n    }\r\n    /**\r\n     * Restore the state of the canvas from the stack\r\n     */\r\n    restore() {\r\n        this.__ctx.restore();\r\n    }\r\n    /**\r\n     * Translate the origin of the context by an x and y\r\n     * @param x\r\n     * @param y\r\n     */\r\n    translate(x, y) {\r\n        this.__ctx.translate(this.snapToPixel ? ~~(x + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : x, this.snapToPixel ? ~~(y + ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon) : y);\r\n    }\r\n    /**\r\n     * Rotate the context about the current origin\r\n     */\r\n    rotate(angle) {\r\n        this.__ctx.rotate(angle);\r\n    }\r\n    /**\r\n     * Scale the context by an x and y factor\r\n     * @param x\r\n     * @param y\r\n     */\r\n    scale(x, y) {\r\n        this.__ctx.scale(x, y);\r\n    }\r\n    getTransform() {\r\n        throw new Error('Not implemented');\r\n    }\r\n    multiply(_m) {\r\n        this.__ctx.setTransform(this.__ctx.getTransform().multiply(_m.toDOMMatrix()));\r\n    }\r\n    addPostProcessor(_postprocessor) {\r\n        // pass\r\n    }\r\n    removePostProcessor(_postprocessor) {\r\n        // pass\r\n    }\r\n    clearPostProcessors() {\r\n        // pass\r\n    }\r\n    updatePostProcessors(_delta) {\r\n        // pass\r\n    }\r\n    beginDrawLifecycle() {\r\n        // pass\r\n    }\r\n    endDrawLifecycle() {\r\n        // pass\r\n    }\r\n    set material(material) {\r\n        this._state.current.material = material;\r\n    }\r\n    get material() {\r\n        return this._state.current.material;\r\n    }\r\n    createMaterial(_options) {\r\n        // pass\r\n        return null;\r\n    }\r\n    clear() {\r\n        // Clear frame\r\n        this.__ctx.clearRect(0, 0, this.width, this.height);\r\n        this.__ctx.fillStyle = this.backgroundColor.toString();\r\n        this.__ctx.fillRect(0, 0, this.width, this.height);\r\n        GraphicsDiagnostics.clear();\r\n    }\r\n    /**\r\n     * Flushes the batched draw calls to the screen\r\n     */\r\n    flush() {\r\n        // pass\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Screen.ts\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Enum representing the different display modes available to Excalibur.\r\n */\r\nvar DisplayMode;\r\n(function (DisplayMode) {\r\n    /**\r\n     * Default, use a specified resolution for the game. Like 800x600 pixels for example.\r\n     */\r\n    DisplayMode[\"Fixed\"] = \"Fixed\";\r\n    /**\r\n     * Fit the aspect ratio given by the game resolution within the container at all times will fill any gaps with canvas.\r\n     * The displayed area outside the aspect ratio is not guaranteed to be on the screen, only the [[Screen.contentArea]]\r\n     * is guaranteed to be on screen.\r\n     */\r\n    DisplayMode[\"FitContainerAndFill\"] = \"FitContainerAndFill\";\r\n    /**\r\n     * Fit the aspect ratio given by the game resolution the screen at all times will fill the screen.\r\n     * This displayed area outside the aspect ratio is not guaranteed to be on the screen, only the [[Screen.contentArea]]\r\n     * is guaranteed to be on screen.\r\n     */\r\n    DisplayMode[\"FitScreenAndFill\"] = \"FitScreenAndFill\";\r\n    /**\r\n     * Fit the viewport to the parent element maintaining aspect ratio given by the game resolution, but zooms in to avoid the black bars\r\n     * (letterbox) that would otherwise be present in [[FitContainer]].\r\n     *\r\n     * **warning** This will clip some drawable area from the user because of the zoom,\r\n     * use [[Screen.contentArea]] to know the safe to draw area.\r\n     */\r\n    DisplayMode[\"FitContainerAndZoom\"] = \"FitContainerAndZoom\";\r\n    /**\r\n     * Fit the viewport to the device screen maintaining aspect ratio given by the game resolution, but zooms in to avoid the black bars\r\n     * (letterbox) that would otherwise be present in [[FitScreen]].\r\n     *\r\n     * **warning** This will clip some drawable area from the user because of the zoom,\r\n     * use [[Screen.contentArea]] to know the safe to draw area.\r\n     */\r\n    DisplayMode[\"FitScreenAndZoom\"] = \"FitScreenAndZoom\";\r\n    /**\r\n     * Fit to screen using as much space as possible while maintaining aspect ratio and resolution.\r\n     * This is not the same as [[Screen.goFullScreen]] but behaves in a similar way maintaining aspect ratio.\r\n     *\r\n     * You may want to center your game here is an example\r\n     * ```html\r\n     * <!-- html -->\r\n     * <body>\r\n     * <main>\r\n     *   <canvas id=\"game\"></canvas>\r\n     * </main>\r\n     * </body>\r\n     * ```\r\n     *\r\n     * ```css\r\n     * // css\r\n     * main {\r\n     *   display: flex;\r\n     *   align-items: center;\r\n     *   justify-content: center;\r\n     *   height: 100%;\r\n     *   width: 100%;\r\n     * }\r\n     * ```\r\n     */\r\n    DisplayMode[\"FitScreen\"] = \"FitScreen\";\r\n    /**\r\n     * Fill the entire screen's css width/height for the game resolution dynamically. This means the resolution of the game will\r\n     * change dynamically as the window is resized. This is not the same as [[Screen.goFullScreen]]\r\n     */\r\n    DisplayMode[\"FillScreen\"] = \"FillScreen\";\r\n    /**\r\n     * Fit to parent element width/height using as much space as possible while maintaining aspect ratio and resolution.\r\n     */\r\n    DisplayMode[\"FitContainer\"] = \"FitContainer\";\r\n    /**\r\n     * Use the parent DOM container's css width/height for the game resolution dynamically\r\n     */\r\n    DisplayMode[\"FillContainer\"] = \"FillContainer\";\r\n})(DisplayMode || (DisplayMode = {}));\r\n/**\r\n * Convenience class for quick resolutions\r\n * Mostly sourced from https://emulation.gametechwiki.com/index.php/Resolution\r\n */\r\nclass Resolution {\r\n    /* istanbul ignore next */\r\n    static get SVGA() {\r\n        return { width: 800, height: 600 };\r\n    }\r\n    /* istanbul ignore next */\r\n    static get Standard() {\r\n        return { width: 1920, height: 1080 };\r\n    }\r\n    /* istanbul ignore next */\r\n    static get Atari2600() {\r\n        return { width: 160, height: 192 };\r\n    }\r\n    /* istanbul ignore next */\r\n    static get GameBoy() {\r\n        return { width: 160, height: 144 };\r\n    }\r\n    /* istanbul ignore next */\r\n    static get GameBoyAdvance() {\r\n        return { width: 240, height: 160 };\r\n    }\r\n    /* istanbul ignore next */\r\n    static get NintendoDS() {\r\n        return { width: 256, height: 192 };\r\n    }\r\n    /* istanbul ignore next */\r\n    static get NES() {\r\n        return { width: 256, height: 224 };\r\n    }\r\n    /* istanbul ignore next */\r\n    static get SNES() {\r\n        return { width: 256, height: 244 };\r\n    }\r\n}\r\n/**\r\n * The Screen handles all aspects of interacting with the screen for Excalibur.\r\n */\r\nclass Screen {\r\n    constructor(options) {\r\n        var _a, _b, _c;\r\n        this._antialiasing = true;\r\n        this._resolutionStack = [];\r\n        this._viewportStack = [];\r\n        this._pixelRatioOverride = null;\r\n        this._isFullScreen = false;\r\n        this._isDisposed = false;\r\n        this._logger = Logger.getInstance();\r\n        this._fullscreenChangeHandler = () => {\r\n            this._isFullScreen = !this._isFullScreen;\r\n            this._logger.debug('Fullscreen Change', this._isFullScreen);\r\n        };\r\n        this._pixelRatioChangeHandler = () => {\r\n            this._logger.debug('Pixel Ratio Change', window.devicePixelRatio);\r\n            this._listenForPixelRatio();\r\n            this._devicePixelRatio = this._calculateDevicePixelRatio();\r\n            this.applyResolutionAndViewport();\r\n        };\r\n        this._resizeHandler = () => {\r\n            const parent = this.parent;\r\n            this._logger.debug('View port resized');\r\n            this._setResolutionAndViewportByDisplayMode(parent);\r\n            this.applyResolutionAndViewport();\r\n        };\r\n        // Asking the window.devicePixelRatio is expensive we do it once\r\n        this._devicePixelRatio = this._calculateDevicePixelRatio();\r\n        this._alreadyWarned = false;\r\n        this._contentArea = new BoundingBox();\r\n        this.viewport = options.viewport;\r\n        this.resolution = (_a = options.resolution) !== null && _a !== void 0 ? _a : { ...this.viewport };\r\n        this._contentResolution = this.resolution;\r\n        this._displayMode = (_b = options.displayMode) !== null && _b !== void 0 ? _b : DisplayMode.Fixed;\r\n        this._canvas = options.canvas;\r\n        this.graphicsContext = options.context;\r\n        this._antialiasing = (_c = options.antialiasing) !== null && _c !== void 0 ? _c : this._antialiasing;\r\n        this._browser = options.browser;\r\n        this._pixelRatioOverride = options.pixelRatio;\r\n        this._applyDisplayMode();\r\n        this._listenForPixelRatio();\r\n        this._canvas.addEventListener('fullscreenchange', this._fullscreenChangeHandler);\r\n        this.applyResolutionAndViewport();\r\n    }\r\n    _listenForPixelRatio() {\r\n        if (this._mediaQueryList && !this._mediaQueryList.addEventListener) {\r\n            // Safari <=13.1 workaround, remove any existing handlers\r\n            this._mediaQueryList.removeListener(this._pixelRatioChangeHandler);\r\n        }\r\n        this._mediaQueryList = this._browser.window.nativeComponent.matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);\r\n        // Safari <=13.1 workaround\r\n        if (this._mediaQueryList.addEventListener) {\r\n            this._mediaQueryList.addEventListener('change', this._pixelRatioChangeHandler, { once: true });\r\n        }\r\n        else {\r\n            this._mediaQueryList.addListener(this._pixelRatioChangeHandler);\r\n        }\r\n    }\r\n    dispose() {\r\n        if (!this._isDisposed) {\r\n            // Clean up handlers\r\n            this._isDisposed = true;\r\n            this._browser.window.off('resize', this._resizeHandler);\r\n            if (this._resizeObserver) {\r\n                this._resizeObserver.disconnect();\r\n            }\r\n            this.parent.removeEventListener('resize', this._resizeHandler);\r\n            // Safari <=13.1 workaround\r\n            if (this._mediaQueryList.removeEventListener) {\r\n                this._mediaQueryList.removeEventListener('change', this._pixelRatioChangeHandler);\r\n            }\r\n            else {\r\n                this._mediaQueryList.removeListener(this._pixelRatioChangeHandler);\r\n            }\r\n            this._canvas.removeEventListener('fullscreenchange', this._fullscreenChangeHandler);\r\n        }\r\n    }\r\n    _calculateDevicePixelRatio() {\r\n        if (window.devicePixelRatio < 1) {\r\n            return 1;\r\n        }\r\n        const devicePixelRatio = window.devicePixelRatio || 1;\r\n        return devicePixelRatio;\r\n    }\r\n    get pixelRatio() {\r\n        if (this._pixelRatioOverride) {\r\n            return this._pixelRatioOverride;\r\n        }\r\n        return this._devicePixelRatio;\r\n    }\r\n    get isHiDpi() {\r\n        return this.pixelRatio !== 1;\r\n    }\r\n    get displayMode() {\r\n        return this._displayMode;\r\n    }\r\n    get canvas() {\r\n        return this._canvas;\r\n    }\r\n    get parent() {\r\n        switch (this.displayMode) {\r\n            case DisplayMode.FillContainer:\r\n            case DisplayMode.FitContainer:\r\n            case DisplayMode.FitContainerAndFill:\r\n            case DisplayMode.FitContainerAndZoom:\r\n                return this.canvas.parentElement || document.body;\r\n            default:\r\n                return window;\r\n        }\r\n    }\r\n    get resolution() {\r\n        return this._resolution;\r\n    }\r\n    set resolution(resolution) {\r\n        this._resolution = resolution;\r\n    }\r\n    get viewport() {\r\n        if (this._viewport) {\r\n            return this._viewport;\r\n        }\r\n        return this._resolution;\r\n    }\r\n    set viewport(viewport) {\r\n        this._viewport = viewport;\r\n    }\r\n    get aspectRatio() {\r\n        return this._resolution.width / this._resolution.height;\r\n    }\r\n    get scaledWidth() {\r\n        return this._resolution.width * this.pixelRatio;\r\n    }\r\n    get scaledHeight() {\r\n        return this._resolution.height * this.pixelRatio;\r\n    }\r\n    setCurrentCamera(camera) {\r\n        this._camera = camera;\r\n    }\r\n    pushResolutionAndViewport() {\r\n        this._resolutionStack.push(this.resolution);\r\n        this._viewportStack.push(this.viewport);\r\n        this.resolution = { ...this.resolution };\r\n        this.viewport = { ...this.viewport };\r\n    }\r\n    peekViewport() {\r\n        return this._viewportStack[this._viewportStack.length - 1];\r\n    }\r\n    peekResolution() {\r\n        return this._resolutionStack[this._resolutionStack.length - 1];\r\n    }\r\n    popResolutionAndViewport() {\r\n        this.resolution = this._resolutionStack.pop();\r\n        this.viewport = this._viewportStack.pop();\r\n    }\r\n    applyResolutionAndViewport() {\r\n        this._canvas.width = this.scaledWidth;\r\n        this._canvas.height = this.scaledHeight;\r\n        if (this.graphicsContext instanceof ExcaliburGraphicsContextWebGL) {\r\n            const supported = this.graphicsContext.checkIfResolutionSupported({\r\n                width: this.scaledWidth,\r\n                height: this.scaledHeight\r\n            });\r\n            if (!supported && !this._alreadyWarned) {\r\n                this._alreadyWarned = true; // warn once\r\n                this._logger.warn(`The currently configured resolution (${this.resolution.width}x${this.resolution.height}) and pixel ratio (${this.pixelRatio})` +\r\n                    ' are too large for the platform WebGL implementation, this may work but cause WebGL rendering to behave oddly.' +\r\n                    ' Try reducing the resolution or disabling Hi DPI scaling to avoid this' +\r\n                    ' (read more here https://excaliburjs.com/docs/screens#understanding-viewport--resolution).');\r\n            }\r\n        }\r\n        if (this._antialiasing) {\r\n            this._canvas.style.imageRendering = 'auto';\r\n        }\r\n        else {\r\n            this._canvas.style.imageRendering = 'pixelated';\r\n            // Fall back to 'crisp-edges' if 'pixelated' is not supported\r\n            // Currently for firefox https://developer.mozilla.org/en-US/docs/Web/CSS/image-rendering\r\n            if (this._canvas.style.imageRendering === '') {\r\n                this._canvas.style.imageRendering = 'crisp-edges';\r\n            }\r\n        }\r\n        this._canvas.style.width = this.viewport.width + 'px';\r\n        this._canvas.style.height = this.viewport.height + 'px';\r\n        // After messing with the canvas width/height the graphics context is invalidated and needs to have some properties reset\r\n        this.graphicsContext.updateViewport(this.resolution);\r\n        this.graphicsContext.resetTransform();\r\n        this.graphicsContext.smoothing = this._antialiasing;\r\n        if (this.graphicsContext instanceof ExcaliburGraphicsContext2DCanvas) {\r\n            this.graphicsContext.scale(this.pixelRatio, this.pixelRatio);\r\n        }\r\n    }\r\n    get antialiasing() {\r\n        return this._antialiasing;\r\n    }\r\n    set antialiasing(isSmooth) {\r\n        this._antialiasing = isSmooth;\r\n        this.graphicsContext.smoothing = this._antialiasing;\r\n    }\r\n    /**\r\n     * Returns true if excalibur is fullscreen using the browser fullscreen api\r\n     */\r\n    get isFullScreen() {\r\n        return this._isFullScreen;\r\n    }\r\n    /**\r\n     * Requests to go fullscreen using the browser fullscreen api, requires user interaction to be successful.\r\n     * For example, wire this to a user click handler.\r\n     *\r\n     * Optionally specify a target element id to go fullscreen, by default the game canvas is used\r\n     * @param elementId\r\n     */\r\n    goFullScreen(elementId) {\r\n        if (elementId) {\r\n            const maybeElement = document.getElementById(elementId);\r\n            if (maybeElement) {\r\n                return maybeElement.requestFullscreen();\r\n            }\r\n        }\r\n        return this._canvas.requestFullscreen();\r\n    }\r\n    /**\r\n     * Requests to exit fullscreen using the browser fullscreen api\r\n     */\r\n    exitFullScreen() {\r\n        return document.exitFullscreen();\r\n    }\r\n    /**\r\n     * Takes a coordinate in normal html page space, for example from a pointer move event, and translates it to\r\n     * Excalibur screen space.\r\n     *\r\n     * Excalibur screen space starts at the top left (0, 0) corner of the viewport, and extends to the\r\n     * bottom right corner (resolutionX, resolutionY)\r\n     * @param point\r\n     */\r\n    pageToScreenCoordinates(point) {\r\n        let newX = point.x;\r\n        let newY = point.y;\r\n        if (!this._isFullScreen) {\r\n            newX -= getPosition(this._canvas).x;\r\n            newY -= getPosition(this._canvas).y;\r\n        }\r\n        // if fullscreen api on it centers with black bars\r\n        // we need to adjust the screen to world coordinates in this case\r\n        if (this._isFullScreen) {\r\n            if (window.innerWidth / this.aspectRatio < window.innerHeight) {\r\n                const screenHeight = window.innerWidth / this.aspectRatio;\r\n                const screenMarginY = (window.innerHeight - screenHeight) / 2;\r\n                newY = ((newY - screenMarginY) / screenHeight) * this.viewport.height;\r\n                newX = (newX / window.innerWidth) * this.viewport.width;\r\n            }\r\n            else {\r\n                const screenWidth = window.innerHeight * this.aspectRatio;\r\n                const screenMarginX = (window.innerWidth - screenWidth) / 2;\r\n                newX = ((newX - screenMarginX) / screenWidth) * this.viewport.width;\r\n                newY = (newY / window.innerHeight) * this.viewport.height;\r\n            }\r\n        }\r\n        newX = (newX / this.viewport.width) * this.resolution.width;\r\n        newY = (newY / this.viewport.height) * this.resolution.height;\r\n        return new Vector(newX, newY);\r\n    }\r\n    /**\r\n     * Takes a coordinate in Excalibur screen space, and translates it to normal html page space. For example,\r\n     * this is where html elements might live if you want to position them relative to Excalibur.\r\n     *\r\n     * Excalibur screen space starts at the top left (0, 0) corner of the viewport, and extends to the\r\n     * bottom right corner (resolutionX, resolutionY)\r\n     * @param point\r\n     */\r\n    screenToPageCoordinates(point) {\r\n        let newX = point.x;\r\n        let newY = point.y;\r\n        newX = (newX / this.resolution.width) * this.viewport.width;\r\n        newY = (newY / this.resolution.height) * this.viewport.height;\r\n        if (this._isFullScreen) {\r\n            if (window.innerWidth / this.aspectRatio < window.innerHeight) {\r\n                const screenHeight = window.innerWidth / this.aspectRatio;\r\n                const screenMarginY = (window.innerHeight - screenHeight) / 2;\r\n                newY = (newY / this.viewport.height) * screenHeight + screenMarginY;\r\n                newX = (newX / this.viewport.width) * window.innerWidth;\r\n            }\r\n            else {\r\n                const screenWidth = window.innerHeight * this.aspectRatio;\r\n                const screenMarginX = (window.innerWidth - screenWidth) / 2;\r\n                newX = (newX / this.viewport.width) * screenWidth + screenMarginX;\r\n                newY = (newY / this.viewport.height) * window.innerHeight;\r\n            }\r\n        }\r\n        if (!this._isFullScreen) {\r\n            newX += getPosition(this._canvas).x;\r\n            newY += getPosition(this._canvas).y;\r\n        }\r\n        return new Vector(newX, newY);\r\n    }\r\n    /**\r\n     * Takes a coordinate in Excalibur screen space, and translates it to Excalibur world space.\r\n     *\r\n     * World space is where [[Entity|entities]] in Excalibur live by default [[CoordPlane.World]]\r\n     * and extends infinitely out relative from the [[Camera]].\r\n     * @param point  Screen coordinate to convert\r\n     */\r\n    screenToWorldCoordinates(point) {\r\n        // the only difference between screen & world is the camera transform\r\n        if (this._camera) {\r\n            return this._camera.inverse.multiply(point);\r\n        }\r\n        return point.sub(vec(this.resolution.width / 2, this.resolution.height / 2));\r\n    }\r\n    /**\r\n     * Takes a coordinate in Excalibur world space, and translates it to Excalibur screen space.\r\n     *\r\n     * Screen space is where [[ScreenElement|screen elements]] and [[Entity|entities]] with [[CoordPlane.Screen]] live.\r\n     * @param point  World coordinate to convert\r\n     */\r\n    worldToScreenCoordinates(point) {\r\n        if (this._camera) {\r\n            return this._camera.transform.multiply(point);\r\n        }\r\n        return point.add(vec(this.resolution.width / 2, this.resolution.height / 2));\r\n    }\r\n    pageToWorldCoordinates(point) {\r\n        const screen = this.pageToScreenCoordinates(point);\r\n        return this.screenToWorldCoordinates(screen);\r\n    }\r\n    worldToPageCoordinates(point) {\r\n        const screen = this.worldToScreenCoordinates(point);\r\n        return this.screenToPageCoordinates(screen);\r\n    }\r\n    /**\r\n     * Returns a BoundingBox of the top left corner of the screen\r\n     * and the bottom right corner of the screen.\r\n     *\r\n     * World bounds are in world coordinates, useful for culling objects offscreen\r\n     */\r\n    getWorldBounds() {\r\n        const bounds = BoundingBox.fromDimension(this.resolution.width, this.resolution.height, Vector.Half)\r\n            .scale(vec(1 / this._camera.zoom, 1 / this._camera.zoom))\r\n            .rotate(this._camera.rotation)\r\n            .translate(this._camera.pos);\r\n        return bounds;\r\n    }\r\n    /**\r\n     * The width of the game canvas in pixels (physical width component of the\r\n     * resolution of the canvas element)\r\n     */\r\n    get canvasWidth() {\r\n        return this.canvas.width;\r\n    }\r\n    /**\r\n     * Returns half width of the game canvas in pixels (half physical width component)\r\n     */\r\n    get halfCanvasWidth() {\r\n        return this.canvas.width / 2;\r\n    }\r\n    /**\r\n     * The height of the game canvas in pixels, (physical height component of\r\n     * the resolution of the canvas element)\r\n     */\r\n    get canvasHeight() {\r\n        return this.canvas.height;\r\n    }\r\n    /**\r\n     * Returns half height of the game canvas in pixels (half physical height component)\r\n     */\r\n    get halfCanvasHeight() {\r\n        return this.canvas.height / 2;\r\n    }\r\n    /**\r\n     * Returns the width of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get drawWidth() {\r\n        if (this._camera) {\r\n            return this.resolution.width / this._camera.zoom;\r\n        }\r\n        return this.resolution.width;\r\n    }\r\n    /**\r\n     * Returns half the width of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get halfDrawWidth() {\r\n        return this.drawWidth / 2;\r\n    }\r\n    /**\r\n     * Returns the height of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get drawHeight() {\r\n        if (this._camera) {\r\n            return this.resolution.height / this._camera.zoom;\r\n        }\r\n        return this.resolution.height;\r\n    }\r\n    /**\r\n     * Returns half the height of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get halfDrawHeight() {\r\n        return this.drawHeight / 2;\r\n    }\r\n    /**\r\n     * Returns screen center coordinates including zoom and device pixel ratio.\r\n     */\r\n    get center() {\r\n        return vec(this.halfDrawWidth, this.halfDrawHeight);\r\n    }\r\n    /**\r\n     * Returns the content area in screen space where it is safe to place content\r\n     */\r\n    get contentArea() {\r\n        return this._contentArea;\r\n    }\r\n    _computeFit() {\r\n        document.body.style.margin = '0px';\r\n        document.body.style.overflow = 'hidden';\r\n        const aspect = this.aspectRatio;\r\n        let adjustedWidth = 0;\r\n        let adjustedHeight = 0;\r\n        if (window.innerWidth / aspect < window.innerHeight) {\r\n            adjustedWidth = window.innerWidth;\r\n            adjustedHeight = window.innerWidth / aspect;\r\n        }\r\n        else {\r\n            adjustedWidth = window.innerHeight * aspect;\r\n            adjustedHeight = window.innerHeight;\r\n        }\r\n        this.viewport = {\r\n            width: adjustedWidth,\r\n            height: adjustedHeight\r\n        };\r\n        this._contentArea = BoundingBox.fromDimension(this.resolution.width, this.resolution.height, Vector.Zero);\r\n    }\r\n    _computeFitScreenAndFill() {\r\n        document.body.style.margin = '0px';\r\n        document.body.style.overflow = 'hidden';\r\n        const vw = window.innerWidth;\r\n        const vh = window.innerHeight;\r\n        this._computeFitAndFill(vw, vh);\r\n    }\r\n    _computeFitContainerAndFill() {\r\n        document.body.style.margin = '0px';\r\n        document.body.style.overflow = 'hidden';\r\n        const parent = this.canvas.parentElement;\r\n        const vw = parent.clientWidth;\r\n        const vh = parent.clientHeight;\r\n        this._computeFitAndFill(vw, vh);\r\n    }\r\n    _computeFitAndFill(vw, vh) {\r\n        this.viewport = {\r\n            width: vw,\r\n            height: vh\r\n        };\r\n        // if the current screen aspectRatio is less than the original aspectRatio\r\n        if (vw / vh <= this._contentResolution.width / this._contentResolution.height) {\r\n            // compute new resolution to match the original aspect ratio\r\n            this.resolution = {\r\n                width: vw * this._contentResolution.width / vw,\r\n                height: vw * this._contentResolution.width / vw * vh / vw\r\n            };\r\n            const clip = (this.resolution.height - this._contentResolution.height) / 2;\r\n            this._contentArea = new BoundingBox({\r\n                top: clip,\r\n                left: 0,\r\n                right: this._contentResolution.width,\r\n                bottom: this.resolution.height - clip\r\n            });\r\n        }\r\n        else {\r\n            this.resolution = {\r\n                width: vh * this._contentResolution.height / vh * vw / vh,\r\n                height: vh * this._contentResolution.height / vh\r\n            };\r\n            const clip = (this.resolution.width - this._contentResolution.width) / 2;\r\n            this._contentArea = new BoundingBox({\r\n                top: 0,\r\n                left: clip,\r\n                right: this.resolution.width - clip,\r\n                bottom: this._contentResolution.height\r\n            });\r\n        }\r\n    }\r\n    _computeFitScreenAndZoom() {\r\n        document.body.style.margin = '0px';\r\n        document.body.style.overflow = 'hidden';\r\n        this.canvas.style.position = 'absolute';\r\n        const vw = window.innerWidth;\r\n        const vh = window.innerHeight;\r\n        this._computeFitAndZoom(vw, vh);\r\n    }\r\n    _computeFitContainerAndZoom() {\r\n        document.body.style.margin = '0px';\r\n        document.body.style.overflow = 'hidden';\r\n        this.canvas.style.position = 'absolute';\r\n        const parent = this.canvas.parentElement;\r\n        parent.style.position = 'relative';\r\n        parent.style.overflow = 'hidden';\r\n        const vw = parent.clientWidth;\r\n        const vh = parent.clientHeight;\r\n        this._computeFitAndZoom(vw, vh);\r\n    }\r\n    _computeFitAndZoom(vw, vh) {\r\n        const aspect = this.aspectRatio;\r\n        let adjustedWidth = 0;\r\n        let adjustedHeight = 0;\r\n        if (vw / aspect < vh) {\r\n            adjustedWidth = vw;\r\n            adjustedHeight = vw / aspect;\r\n        }\r\n        else {\r\n            adjustedWidth = vh * aspect;\r\n            adjustedHeight = vh;\r\n        }\r\n        const scaleX = vw / adjustedWidth;\r\n        const scaleY = vh / adjustedHeight;\r\n        const maxScaleFactor = Math.max(scaleX, scaleY);\r\n        const zoomedWidth = adjustedWidth * maxScaleFactor;\r\n        const zoomedHeight = adjustedHeight * maxScaleFactor;\r\n        // Center zoomed dimension if bigger than the screen\r\n        if (zoomedWidth > vw) {\r\n            this.canvas.style.left = -(zoomedWidth - vw) / 2 + 'px';\r\n        }\r\n        else {\r\n            this.canvas.style.left = '';\r\n        }\r\n        if (zoomedHeight > vh) {\r\n            this.canvas.style.top = -(zoomedHeight - vh) / 2 + 'px';\r\n        }\r\n        else {\r\n            this.canvas.style.top = '';\r\n        }\r\n        this.viewport = {\r\n            width: zoomedWidth,\r\n            height: zoomedHeight\r\n        };\r\n        const bounds = BoundingBox.fromDimension(this.viewport.width, this.viewport.height, Vector.Zero);\r\n        // return safe area\r\n        if (this.viewport.width > vw) {\r\n            const clip = (this.viewport.width - vw) / this.viewport.width * this.resolution.width;\r\n            bounds.top = 0;\r\n            bounds.left = clip / 2;\r\n            bounds.right = this.resolution.width - clip / 2;\r\n            bounds.bottom = this.resolution.height;\r\n        }\r\n        if (this.viewport.height > vh) {\r\n            const clip = (this.viewport.height - vh) / this.viewport.height * this.resolution.height;\r\n            bounds.top = clip / 2;\r\n            bounds.left = 0;\r\n            bounds.bottom = this.resolution.height - clip / 2;\r\n            bounds.right = this.resolution.width;\r\n        }\r\n        this._contentArea = bounds;\r\n    }\r\n    _computeFitContainer() {\r\n        const aspect = this.aspectRatio;\r\n        let adjustedWidth = 0;\r\n        let adjustedHeight = 0;\r\n        const parent = this.canvas.parentElement;\r\n        if (parent.clientWidth / aspect < parent.clientHeight) {\r\n            adjustedWidth = parent.clientWidth;\r\n            adjustedHeight = parent.clientWidth / aspect;\r\n        }\r\n        else {\r\n            adjustedWidth = parent.clientHeight * aspect;\r\n            adjustedHeight = parent.clientHeight;\r\n        }\r\n        this.viewport = {\r\n            width: adjustedWidth,\r\n            height: adjustedHeight\r\n        };\r\n        this._contentArea = BoundingBox.fromDimension(this.resolution.width, this.resolution.height, Vector.Zero);\r\n    }\r\n    _applyDisplayMode() {\r\n        this._setResolutionAndViewportByDisplayMode(this.parent);\r\n        // watch resizing\r\n        if (this.parent instanceof Window) {\r\n            this._browser.window.on('resize', this._resizeHandler);\r\n        }\r\n        else {\r\n            this._resizeObserver = new ResizeObserver(() => {\r\n                this._resizeHandler();\r\n            });\r\n            this._resizeObserver.observe(this.parent);\r\n        }\r\n        this.parent.addEventListener('resize', this._resizeHandler);\r\n    }\r\n    /**\r\n     * Sets the resolution and viewport based on the selected display mode.\r\n     */\r\n    _setResolutionAndViewportByDisplayMode(parent) {\r\n        if (this.displayMode === DisplayMode.FillContainer) {\r\n            this.resolution = {\r\n                width: parent.clientWidth,\r\n                height: parent.clientHeight\r\n            };\r\n            this.viewport = this.resolution;\r\n        }\r\n        if (this.displayMode === DisplayMode.FillScreen) {\r\n            document.body.style.margin = '0px';\r\n            document.body.style.overflow = 'hidden';\r\n            this.resolution = {\r\n                width: parent.innerWidth,\r\n                height: parent.innerHeight\r\n            };\r\n            this.viewport = this.resolution;\r\n        }\r\n        this._contentArea = BoundingBox.fromDimension(this.resolution.width, this.resolution.height, Vector.Zero);\r\n        if (this.displayMode === DisplayMode.FitScreen) {\r\n            this._computeFit();\r\n        }\r\n        if (this.displayMode === DisplayMode.FitContainer) {\r\n            this._computeFitContainer();\r\n        }\r\n        if (this.displayMode === DisplayMode.FitScreenAndFill) {\r\n            this._computeFitScreenAndFill();\r\n        }\r\n        if (this.displayMode === DisplayMode.FitContainerAndFill) {\r\n            this._computeFitContainerAndFill();\r\n        }\r\n        if (this.displayMode === DisplayMode.FitScreenAndZoom) {\r\n            this._computeFitScreenAndZoom();\r\n        }\r\n        if (this.displayMode === DisplayMode.FitContainerAndZoom) {\r\n            this._computeFitContainerAndZoom();\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Resources/Sound/AudioContext.ts\n/**\r\n * Internal class used to build instances of AudioContext\r\n */\r\n/* istanbul ignore next */\r\nclass AudioContextFactory {\r\n    static create() {\r\n        if (!this._INSTANCE) {\r\n            if (window.AudioContext || window.webkitAudioContext) {\r\n                this._INSTANCE = new AudioContext();\r\n            }\r\n        }\r\n        return this._INSTANCE;\r\n    }\r\n}\r\nAudioContextFactory._INSTANCE = null;\r\n\n;// CONCATENATED MODULE: ./Util/WebAudio.ts\n\r\n\r\n/**\r\n * Patch for detecting legacy web audio in browsers\r\n * @internal\r\n * @param source\r\n */\r\nfunction isLegacyWebAudioSource(source) {\r\n    return !!source.playbackState;\r\n}\r\nclass WebAudio {\r\n    /**\r\n     * Play an empty sound to unlock Safari WebAudio context. Call this function\r\n     * right after a user interaction event.\r\n     * @source https://paulbakaus.com/tutorials/html5/web-audio-on-ios/\r\n     */\r\n    static unlock() {\r\n        const promise = new Promise((resolve, reject) => {\r\n            if (WebAudio._UNLOCKED || !AudioContextFactory.create()) {\r\n                return resolve(true);\r\n            }\r\n            const unlockTimeoutTimer = setTimeout(() => {\r\n                Logger.getInstance().warn('Excalibur was unable to unlock the audio context, audio probably will not play in this browser.');\r\n                resolve(false);\r\n            }, 200);\r\n            const audioContext = AudioContextFactory.create();\r\n            audioContext.resume().then(() => {\r\n                // create empty buffer and play it\r\n                const buffer = audioContext.createBuffer(1, 1, 22050);\r\n                const source = audioContext.createBufferSource();\r\n                let ended = false;\r\n                source.buffer = buffer;\r\n                source.connect(audioContext.destination);\r\n                source.onended = () => (ended = true);\r\n                source.start(0);\r\n                // by checking the play state after some time, we know if we're really unlocked\r\n                setTimeout(() => {\r\n                    if (isLegacyWebAudioSource(source)) {\r\n                        if (source.playbackState === source.PLAYING_STATE || source.playbackState === source.FINISHED_STATE) {\r\n                            WebAudio._UNLOCKED = true;\r\n                        }\r\n                    }\r\n                    else {\r\n                        if (audioContext.currentTime > 0 || ended) {\r\n                            WebAudio._UNLOCKED = true;\r\n                        }\r\n                    }\r\n                }, 0);\r\n                clearTimeout(unlockTimeoutTimer);\r\n                resolve(true);\r\n            }, () => {\r\n                reject();\r\n            });\r\n        });\r\n        return promise;\r\n    }\r\n    static isUnlocked() {\r\n        return this._UNLOCKED;\r\n    }\r\n}\r\nWebAudio._UNLOCKED = false;\r\n\n;// CONCATENATED MODULE: ./Util/DrawUtil.ts\n\r\n/* istanbul ignore next */\r\n/**\r\n * Draw a line on canvas context\r\n *\r\n * @param ctx The canvas context\r\n * @param color The color of the line\r\n * @param x1 The start x coordinate\r\n * @param y1 The start y coordinate\r\n * @param x2 The ending x coordinate\r\n * @param y2 The ending y coordinate\r\n * @param thickness The line thickness\r\n * @param cap The [[LineCapStyle]] (butt, round, or square)\r\n */\r\nfunction line(ctx, color = Color.Red, x1, y1, x2, y2, thickness = 1, cap = 'butt') {\r\n    ctx.save();\r\n    ctx.beginPath();\r\n    ctx.lineWidth = thickness;\r\n    ctx.lineCap = cap;\r\n    ctx.strokeStyle = color.toString();\r\n    ctx.moveTo(x1, y1);\r\n    ctx.lineTo(x2, y2);\r\n    ctx.closePath();\r\n    ctx.stroke();\r\n    ctx.restore();\r\n}\r\n/* istanbul ignore next */\r\n/**\r\n * Draw the vector as a point onto the canvas.\r\n */\r\nfunction point(ctx, color = Color.Red, point) {\r\n    ctx.beginPath();\r\n    ctx.strokeStyle = color.toString();\r\n    ctx.arc(point.x, point.y, 5, 0, Math.PI * 2);\r\n    ctx.closePath();\r\n    ctx.stroke();\r\n}\r\n/**\r\n * Draw the vector as a line onto the canvas starting a origin point.\r\n */\r\n/* istanbul ignore next */\r\n/**\r\n *\r\n */\r\nfunction vector(ctx, color, origin, vector, scale = 1.0) {\r\n    const c = color ? color.toString() : 'blue';\r\n    const v = vector.scale(scale);\r\n    ctx.beginPath();\r\n    ctx.strokeStyle = c;\r\n    ctx.moveTo(origin.x, origin.y);\r\n    ctx.lineTo(origin.x + v.x, origin.y + v.y);\r\n    ctx.closePath();\r\n    ctx.stroke();\r\n}\r\n/**\r\n * Draw a round rectangle on a canvas context\r\n *\r\n * @param ctx The canvas context\r\n * @param x The top-left x coordinate\r\n * @param y The top-left y coordinate\r\n * @param width The width of the rectangle\r\n * @param height The height of the rectangle\r\n * @param radius The border radius of the rectangle\r\n * @param stroke The [[Color]] to stroke rectangle with\r\n * @param fill The [[Color]] to fill rectangle with\r\n */\r\nfunction roundRect(ctx, x, y, width, height, radius = 5, stroke = Color.White, fill = null) {\r\n    let br;\r\n    if (typeof radius === 'number') {\r\n        br = { tl: radius, tr: radius, br: radius, bl: radius };\r\n    }\r\n    else {\r\n        const defaultRadius = { tl: 0, tr: 0, br: 0, bl: 0 };\r\n        for (const prop in defaultRadius) {\r\n            if (defaultRadius.hasOwnProperty(prop)) {\r\n                const side = prop;\r\n                br[side] = radius[side] || defaultRadius[side];\r\n            }\r\n        }\r\n    }\r\n    ctx.beginPath();\r\n    ctx.moveTo(x + br.tl, y);\r\n    ctx.lineTo(x + width - br.tr, y);\r\n    ctx.quadraticCurveTo(x + width, y, x + width, y + br.tr);\r\n    ctx.lineTo(x + width, y + height - br.br);\r\n    ctx.quadraticCurveTo(x + width, y + height, x + width - br.br, y + height);\r\n    ctx.lineTo(x + br.bl, y + height);\r\n    ctx.quadraticCurveTo(x, y + height, x, y + height - br.bl);\r\n    ctx.lineTo(x, y + br.tl);\r\n    ctx.quadraticCurveTo(x, y, x + br.tl, y);\r\n    ctx.closePath();\r\n    if (fill) {\r\n        ctx.fillStyle = fill.toString();\r\n        ctx.fill();\r\n    }\r\n    if (stroke) {\r\n        ctx.strokeStyle = stroke.toString();\r\n        ctx.stroke();\r\n    }\r\n}\r\n/**\r\n *\r\n */\r\nfunction circle(ctx, x, y, radius, stroke = Color.White, fill = null) {\r\n    ctx.beginPath();\r\n    ctx.arc(x, y, radius, 0, Math.PI * 2);\r\n    ctx.closePath();\r\n    if (fill) {\r\n        ctx.fillStyle = fill.toString();\r\n        ctx.fill();\r\n    }\r\n    if (stroke) {\r\n        ctx.strokeStyle = stroke.toString();\r\n        ctx.stroke();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Loader.logo.png\n/* harmony default export */ const Loader_logo = (\"data:image/png;base64,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\");\n// EXTERNAL MODULE: ./Loader.css\nvar Loader_0 = __webpack_require__(1388);\n;// CONCATENATED MODULE: ./Graphics/Raster.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * A Raster is a Graphic that needs to be first painted to a HTMLCanvasElement before it can be drawn to the\r\n * [[ExcaliburGraphicsContext]]. This is useful for generating custom images using the 2D canvas api.\r\n *\r\n * Implementors must implement the [[Raster.execute]] method to rasterize their drawing.\r\n */\r\nclass Raster extends Graphic {\r\n    constructor(options) {\r\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k;\r\n        super(options);\r\n        this.filtering = null;\r\n        this.lineCap = 'butt';\r\n        this.quality = 1;\r\n        this._dirty = true;\r\n        this._smoothing = false;\r\n        this._color = watch(Color.Black, () => this.flagDirty());\r\n        this._lineWidth = 1;\r\n        this._lineDash = [];\r\n        this._padding = 0;\r\n        if (options) {\r\n            this.quality = (_a = options.quality) !== null && _a !== void 0 ? _a : this.quality;\r\n            this.color = (_b = options.color) !== null && _b !== void 0 ? _b : Color.Black;\r\n            this.strokeColor = options === null || options === void 0 ? void 0 : options.strokeColor;\r\n            this.smoothing = (_c = options.smoothing) !== null && _c !== void 0 ? _c : this.smoothing;\r\n            this.lineWidth = (_d = options.lineWidth) !== null && _d !== void 0 ? _d : this.lineWidth;\r\n            this.lineDash = (_e = options.lineDash) !== null && _e !== void 0 ? _e : this.lineDash;\r\n            this.lineCap = (_f = options.lineCap) !== null && _f !== void 0 ? _f : this.lineCap;\r\n            this.padding = (_g = options.padding) !== null && _g !== void 0 ? _g : this.padding;\r\n            this.filtering = (_h = options.filtering) !== null && _h !== void 0 ? _h : this.filtering;\r\n        }\r\n        this._bitmap = document.createElement('canvas');\r\n        // get the default canvas width/height as a fallback\r\n        const bitmapWidth = (_j = options === null || options === void 0 ? void 0 : options.width) !== null && _j !== void 0 ? _j : this._bitmap.width;\r\n        const bitmapHeight = (_k = options === null || options === void 0 ? void 0 : options.height) !== null && _k !== void 0 ? _k : this._bitmap.height;\r\n        this.width = bitmapWidth;\r\n        this.height = bitmapHeight;\r\n        const maybeCtx = this._bitmap.getContext('2d');\r\n        if (!maybeCtx) {\r\n            /* istanbul ignore next */\r\n            throw new Error('Browser does not support 2d canvas drawing, cannot create Raster graphic');\r\n        }\r\n        else {\r\n            this._ctx = maybeCtx;\r\n        }\r\n    }\r\n    cloneRasterOptions() {\r\n        return {\r\n            color: this.color ? this.color.clone() : null,\r\n            strokeColor: this.strokeColor ? this.strokeColor.clone() : null,\r\n            smoothing: this.smoothing,\r\n            lineWidth: this.lineWidth,\r\n            lineDash: this.lineDash,\r\n            lineCap: this.lineCap,\r\n            quality: this.quality,\r\n            padding: this.padding\r\n        };\r\n    }\r\n    /**\r\n     * Gets whether the graphic is dirty, this means there are changes that haven't been re-rasterized\r\n     */\r\n    get dirty() {\r\n        return this._dirty;\r\n    }\r\n    /**\r\n     * Flags the graphic as dirty, meaning it must be re-rasterized before draw.\r\n     * This should be called any time the graphics state changes such that it affects the outputted drawing\r\n     */\r\n    flagDirty() {\r\n        this._dirty = true;\r\n    }\r\n    /**\r\n     * Gets or sets the current width of the Raster graphic. Setting the width will cause the raster\r\n     * to be flagged dirty causing a re-raster on the next draw.\r\n     *\r\n     * Any `padding`s or `quality` set will be factored into the width\r\n     */\r\n    get width() {\r\n        return Math.abs(this._getTotalWidth() * this.scale.x);\r\n    }\r\n    set width(value) {\r\n        value /= Math.abs(this.scale.x);\r\n        this._bitmap.width = value;\r\n        this._originalWidth = value;\r\n        this.flagDirty();\r\n    }\r\n    /**\r\n     * Gets or sets the current height of the Raster graphic. Setting the height will cause the raster\r\n     * to be flagged dirty causing a re-raster on the next draw.\r\n     *\r\n     * Any `padding` or `quality` set will be factored into the height\r\n     */\r\n    get height() {\r\n        return Math.abs(this._getTotalHeight() * this.scale.y);\r\n    }\r\n    set height(value) {\r\n        value /= Math.abs(this.scale.y);\r\n        this._bitmap.height = value;\r\n        this._originalHeight = value;\r\n        this.flagDirty();\r\n    }\r\n    _getTotalWidth() {\r\n        var _a;\r\n        return (((_a = this._originalWidth) !== null && _a !== void 0 ? _a : this._bitmap.width) + this.padding * 2) * 1;\r\n    }\r\n    _getTotalHeight() {\r\n        var _a;\r\n        return (((_a = this._originalHeight) !== null && _a !== void 0 ? _a : this._bitmap.height) + this.padding * 2) * 1;\r\n    }\r\n    /**\r\n     * Returns the local bounds of the Raster including the padding\r\n     */\r\n    get localBounds() {\r\n        return BoundingBox.fromDimension(this._getTotalWidth() * this.scale.x, this._getTotalHeight() * this.scale.y, Vector.Zero);\r\n    }\r\n    /**\r\n     * Gets or sets the smoothing (anti-aliasing of the graphic). Setting the height will cause the raster\r\n     * to be flagged dirty causing a re-raster on the next draw.\r\n     */\r\n    get smoothing() {\r\n        return this._smoothing;\r\n    }\r\n    set smoothing(value) {\r\n        this._smoothing = value;\r\n        this.flagDirty();\r\n    }\r\n    /**\r\n     * Gets or sets the fillStyle of the Raster graphic. Setting the fillStyle will cause the raster to be\r\n     * flagged dirty causing a re-raster on the next draw.\r\n     */\r\n    get color() {\r\n        return this._color;\r\n    }\r\n    set color(value) {\r\n        this.flagDirty();\r\n        this._color = watch(value, () => this.flagDirty());\r\n    }\r\n    /**\r\n     * Gets or sets the strokeStyle of the Raster graphic. Setting the strokeStyle will cause the raster to be\r\n     * flagged dirty causing a re-raster on the next draw.\r\n     */\r\n    get strokeColor() {\r\n        return this._strokeColor;\r\n    }\r\n    set strokeColor(value) {\r\n        this.flagDirty();\r\n        this._strokeColor = watch(value, () => this.flagDirty());\r\n    }\r\n    /**\r\n     * Gets or sets the line width of the Raster graphic. Setting the lineWidth will cause the raster to be\r\n     * flagged dirty causing a re-raster on the next draw.\r\n     */\r\n    get lineWidth() {\r\n        return this._lineWidth;\r\n    }\r\n    set lineWidth(value) {\r\n        this._lineWidth = value;\r\n        this.flagDirty();\r\n    }\r\n    get lineDash() {\r\n        return this._lineDash;\r\n    }\r\n    set lineDash(value) {\r\n        this._lineDash = value;\r\n        this.flagDirty();\r\n    }\r\n    get padding() {\r\n        return this._padding;\r\n    }\r\n    set padding(value) {\r\n        this._padding = value;\r\n        this.flagDirty();\r\n    }\r\n    /**\r\n     * Rasterize the graphic to a bitmap making it usable as in excalibur. Rasterize is called automatically if\r\n     * the graphic is [[Raster.dirty]] on the next [[Graphic.draw]] call\r\n     */\r\n    rasterize() {\r\n        this._dirty = false;\r\n        this._ctx.clearRect(0, 0, this._getTotalWidth(), this._getTotalHeight());\r\n        this._ctx.save();\r\n        this._applyRasterProperties(this._ctx);\r\n        this.execute(this._ctx);\r\n        this._ctx.restore();\r\n    }\r\n    _applyRasterProperties(ctx) {\r\n        var _a, _b, _c;\r\n        this._bitmap.width = this._getTotalWidth() * this.quality;\r\n        this._bitmap.height = this._getTotalHeight() * this.quality;\r\n        // Do a bad thing to pass the filtering as an attribute\r\n        this._bitmap.setAttribute('filtering', this.filtering);\r\n        this._bitmap.setAttribute('forceUpload', 'true');\r\n        ctx.scale(this.quality, this.quality);\r\n        ctx.translate(this.padding, this.padding);\r\n        ctx.imageSmoothingEnabled = this.smoothing;\r\n        ctx.lineWidth = this.lineWidth;\r\n        ctx.setLineDash((_a = this.lineDash) !== null && _a !== void 0 ? _a : ctx.getLineDash());\r\n        ctx.lineCap = this.lineCap;\r\n        ctx.strokeStyle = (_b = this.strokeColor) === null || _b === void 0 ? void 0 : _b.toString();\r\n        ctx.fillStyle = (_c = this.color) === null || _c === void 0 ? void 0 : _c.toString();\r\n    }\r\n    _drawImage(ex, x, y) {\r\n        if (this._dirty) {\r\n            this.rasterize();\r\n        }\r\n        ex.scale(1 / this.quality, 1 / this.quality);\r\n        ex.drawImage(this._bitmap, x, y);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Canvas.ts\n\r\n/**\r\n * A canvas [[Graphic]] to provide an adapter between the 2D Canvas API and the [[ExcaliburGraphicsContext]].\r\n *\r\n * The [[Canvas]] works by re-rastering a draw handler to a HTMLCanvasElement for every draw which is then passed\r\n * to the [[ExcaliburGraphicsContext]] implementation as a rendered image.\r\n *\r\n * **Low performance API**\r\n */\r\nclass Canvas extends Raster {\r\n    /**\r\n     * Return the 2D graphics context of this canvas\r\n     */\r\n    get ctx() {\r\n        return this._ctx;\r\n    }\r\n    constructor(_options) {\r\n        super(_options);\r\n        this._options = _options;\r\n    }\r\n    clone() {\r\n        return new Canvas({\r\n            ...this._options,\r\n            ...this.cloneGraphicOptions(),\r\n            ...this.cloneRasterOptions()\r\n        });\r\n    }\r\n    execute(ctx) {\r\n        var _a, _b;\r\n        if ((_a = this._options) === null || _a === void 0 ? void 0 : _a.draw) {\r\n            (_b = this._options) === null || _b === void 0 ? void 0 : _b.draw(ctx);\r\n        }\r\n        if (!this._options.cache) {\r\n            this.flagDirty();\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Interfaces/AudioImplementation.ts\nclass ExResponse {\r\n}\r\nExResponse.type = {\r\n    any: '',\r\n    blob: 'blob',\r\n    json: 'json',\r\n    text: 'text',\r\n    document: 'document',\r\n    arraybuffer: 'arraybuffer'\r\n};\r\n\n;// CONCATENATED MODULE: ./Util/StateMachine.ts\nclass StateMachine {\r\n    constructor() {\r\n        this.states = new Map();\r\n    }\r\n    get currentState() {\r\n        return this._currentState;\r\n    }\r\n    set currentState(state) {\r\n        this._currentState = state;\r\n    }\r\n    static create(machineDescription, data) {\r\n        const machine = new StateMachine();\r\n        machine.data = data;\r\n        for (const stateName in machineDescription.states) {\r\n            machine.states.set(stateName, {\r\n                name: stateName,\r\n                ...machineDescription.states[stateName]\r\n            });\r\n        }\r\n        // validate transitions are states\r\n        for (const state of machine.states.values()) {\r\n            for (const transitionState of state.transitions) {\r\n                if (transitionState === '*') {\r\n                    continue;\r\n                }\r\n                if (!machine.states.has(transitionState)) {\r\n                    throw Error(`Invalid state machine, state [${state.name}] has a transition to another state that doesn't exist [${transitionState}]`);\r\n                }\r\n            }\r\n        }\r\n        machine.currentState = machine.startState = machine.states.get(machineDescription.start);\r\n        return machine;\r\n    }\r\n    in(state) {\r\n        return this.currentState.name === state;\r\n    }\r\n    go(stateName, eventData) {\r\n        var _a, _b;\r\n        if (this.currentState.transitions.includes(stateName) || this.currentState.transitions.includes('*')) {\r\n            const potentialNewState = this.states.get(stateName);\r\n            if (this.currentState.onExit) {\r\n                const canExit = (_a = this.currentState) === null || _a === void 0 ? void 0 : _a.onExit({ to: potentialNewState.name, data: this.data });\r\n                if (canExit === false) {\r\n                    return false;\r\n                }\r\n            }\r\n            if (potentialNewState === null || potentialNewState === void 0 ? void 0 : potentialNewState.onEnter) {\r\n                const canEnter = potentialNewState === null || potentialNewState === void 0 ? void 0 : potentialNewState.onEnter({ from: this.currentState.name, eventData, data: this.data });\r\n                if (canEnter === false) {\r\n                    return false;\r\n                }\r\n            }\r\n            // console.log(`${this.currentState.name} => ${potentialNewState.name} (${eventData})`);\r\n            this.currentState = potentialNewState;\r\n            if ((_b = this.currentState) === null || _b === void 0 ? void 0 : _b.onState) {\r\n                this.currentState.onState();\r\n            }\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    update(elapsedMs) {\r\n        if (this.currentState.onUpdate) {\r\n            this.currentState.onUpdate(this.data, elapsedMs);\r\n        }\r\n    }\r\n    save(saveKey) {\r\n        localStorage.setItem(saveKey, JSON.stringify({\r\n            currentState: this.currentState.name,\r\n            data: this.data\r\n        }));\r\n    }\r\n    restore(saveKey) {\r\n        const state = JSON.parse(localStorage.getItem(saveKey));\r\n        this.currentState = this.states.get(state.currentState);\r\n        this.data = state.data;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Resources/Sound/WebAudioInstance.ts\n\r\n\r\n\r\n/**\r\n * Internal class representing a Web Audio AudioBufferSourceNode instance\r\n * @see https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API\r\n */\r\nclass WebAudioInstance {\r\n    _createNewBufferSource() {\r\n        this._instance = this._audioContext.createBufferSource();\r\n        this._instance.buffer = this._src;\r\n        this._instance.loop = this.loop;\r\n        this._instance.playbackRate.value = this._playbackRate;\r\n        this._instance.connect(this._volumeNode);\r\n        this._volumeNode.connect(this._audioContext.destination);\r\n    }\r\n    _handleEnd() {\r\n        if (!this.loop) {\r\n            this._instance.onended = () => {\r\n                this._playingResolve(true);\r\n            };\r\n        }\r\n    }\r\n    set loop(value) {\r\n        this._loop = value;\r\n        if (this._instance) {\r\n            this._instance.loop = value;\r\n            if (!this.loop) {\r\n                this._instance.onended = () => {\r\n                    this._playingResolve(true);\r\n                };\r\n            }\r\n        }\r\n    }\r\n    get loop() {\r\n        return this._loop;\r\n    }\r\n    set volume(value) {\r\n        value = clamp(value, 0, 1.0);\r\n        this._volume = value;\r\n        if (this._stateMachine.in('PLAYING') && this._volumeNode.gain.setTargetAtTime) {\r\n            // https://developer.mozilla.org/en-US/docs/Web/API/AudioParam/setTargetAtTime\r\n            // After each .1 seconds timestep, the target value will ~63.2% closer to the target value.\r\n            // This exponential ramp provides a more pleasant transition in gain\r\n            this._volumeNode.gain.setTargetAtTime(value, this._audioContext.currentTime, 0.1);\r\n        }\r\n        else {\r\n            this._volumeNode.gain.value = value;\r\n        }\r\n    }\r\n    get volume() {\r\n        return this._volume;\r\n    }\r\n    /**\r\n     * Returns the set duration to play, otherwise returns the total duration if unset\r\n     */\r\n    get duration() {\r\n        var _a;\r\n        return (_a = this._duration) !== null && _a !== void 0 ? _a : this.getTotalPlaybackDuration();\r\n    }\r\n    /**\r\n     * Set the duration that this audio should play.\r\n     *\r\n     * Note: if you seek to a specific point the duration will start from that point, for example\r\n     *\r\n     * If you have a 10 second clip, seek to 5 seconds, then set the duration to 2, it will play the clip from 5-7 seconds.\r\n     */\r\n    set duration(duration) {\r\n        this._duration = duration;\r\n    }\r\n    constructor(_src) {\r\n        this._src = _src;\r\n        this._audioContext = AudioContextFactory.create();\r\n        this._volumeNode = this._audioContext.createGain();\r\n        this._playingPromise = new Promise((resolve) => {\r\n            this._playingResolve = resolve;\r\n        });\r\n        this._stateMachine = StateMachine.create({\r\n            start: 'STOPPED',\r\n            states: {\r\n                PLAYING: {\r\n                    onEnter: ({ data }) => {\r\n                        // Buffer nodes are single use\r\n                        this._createNewBufferSource();\r\n                        this._handleEnd();\r\n                        if (this.loop) {\r\n                            // when looping don't set a duration\r\n                            this._instance.start(0, data.pausedAt * this._playbackRate);\r\n                        }\r\n                        else {\r\n                            this._instance.start(0, data.pausedAt * this._playbackRate, this.duration);\r\n                        }\r\n                        data.startedAt = (this._audioContext.currentTime - data.pausedAt);\r\n                        data.pausedAt = 0;\r\n                    },\r\n                    onState: () => this._playStarted(),\r\n                    onExit: ({ to }) => {\r\n                        // If you've exited early only resolve if explicitly STOPPED\r\n                        if (to === 'STOPPED') {\r\n                            this._playingResolve(true);\r\n                        }\r\n                        // Whenever you're not playing... you stop!\r\n                        this._instance.onended = null; // disconnect the wired on-end handler\r\n                        this._instance.disconnect();\r\n                        this._instance.stop(0);\r\n                        this._instance = null;\r\n                    },\r\n                    transitions: ['STOPPED', 'PAUSED', 'SEEK']\r\n                },\r\n                SEEK: {\r\n                    onEnter: ({ eventData: position, data }) => {\r\n                        data.pausedAt = (position !== null && position !== void 0 ? position : 0) / this._playbackRate;\r\n                        data.startedAt = 0;\r\n                    },\r\n                    transitions: ['*']\r\n                },\r\n                STOPPED: {\r\n                    onEnter: ({ data }) => {\r\n                        data.pausedAt = 0;\r\n                        data.startedAt = 0;\r\n                        this._playingResolve(true);\r\n                    },\r\n                    transitions: ['PLAYING', 'PAUSED', 'SEEK']\r\n                },\r\n                PAUSED: {\r\n                    onEnter: ({ data }) => {\r\n                        // Playback rate will be a scale factor of how fast/slow the audio is being played\r\n                        // default is 1.0\r\n                        // we need to invert it to get the time scale\r\n                        data.pausedAt = (this._audioContext.currentTime - data.startedAt);\r\n                    },\r\n                    transitions: ['PLAYING', 'STOPPED', 'SEEK']\r\n                }\r\n            }\r\n        }, {\r\n            startedAt: 0,\r\n            pausedAt: 0\r\n        });\r\n        this._volume = 1;\r\n        this._loop = false;\r\n        // eslint-disable-next-line @typescript-eslint/no-empty-function\r\n        this._playStarted = () => { };\r\n        this._playbackRate = 1.0;\r\n        this._createNewBufferSource();\r\n    }\r\n    isPlaying() {\r\n        return this._stateMachine.in('PLAYING');\r\n    }\r\n    isPaused() {\r\n        return this._stateMachine.in('PAUSED') || this._stateMachine.in('SEEK');\r\n    }\r\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\r\n    play(playStarted = () => { }) {\r\n        this._playStarted = playStarted;\r\n        this._stateMachine.go('PLAYING');\r\n        return this._playingPromise;\r\n    }\r\n    pause() {\r\n        this._stateMachine.go('PAUSED');\r\n    }\r\n    stop() {\r\n        this._stateMachine.go('STOPPED');\r\n    }\r\n    seek(position) {\r\n        this._stateMachine.go('PAUSED');\r\n        this._stateMachine.go('SEEK', position);\r\n    }\r\n    getTotalPlaybackDuration() {\r\n        return this._src.duration;\r\n    }\r\n    getPlaybackPosition() {\r\n        const { pausedAt, startedAt } = this._stateMachine.data;\r\n        if (pausedAt) {\r\n            return pausedAt * this._playbackRate;\r\n        }\r\n        if (startedAt) {\r\n            return (this._audioContext.currentTime - startedAt) * this._playbackRate;\r\n        }\r\n        return 0;\r\n    }\r\n    set playbackRate(playbackRate) {\r\n        this._instance.playbackRate.value = this._playbackRate = playbackRate;\r\n    }\r\n    get playbackRate() {\r\n        return this._instance.playbackRate.value;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Events/MediaEvents.ts\n\r\nclass MediaEvent extends GameEvent {\r\n    /**\r\n     * Media event cannot bubble\r\n     */\r\n    set bubbles(_value) {\r\n        // stubbed\r\n    }\r\n    /**\r\n     * Media event cannot bubble\r\n     */\r\n    get bubbles() {\r\n        return false;\r\n    }\r\n    /**\r\n     * Media event cannot bubble, so they have no path\r\n     */\r\n    get _path() {\r\n        return null;\r\n    }\r\n    /**\r\n     * Media event cannot bubble, so they have no path\r\n     */\r\n    set _path(_val) {\r\n        // stubbed\r\n    }\r\n    constructor(target, _name = 'MediaEvent') {\r\n        super();\r\n        this.target = target;\r\n        this._name = _name;\r\n    }\r\n    /**\r\n     * Prevents event from bubbling\r\n     */\r\n    stopPropagation() {\r\n        /**\r\n         * Stub\r\n         */\r\n    }\r\n    /**\r\n     * Action, that calls when event happens\r\n     */\r\n    action() {\r\n        /**\r\n         * Stub\r\n         */\r\n    }\r\n    /**\r\n     * Propagate event further through event path\r\n     */\r\n    propagate() {\r\n        /**\r\n         * Stub\r\n         */\r\n    }\r\n    layPath(_actor) {\r\n        /**\r\n         * Stub\r\n         */\r\n    }\r\n}\r\nclass NativeSoundEvent extends MediaEvent {\r\n    constructor(target, track) {\r\n        super(target, 'NativeSoundEvent');\r\n        this.track = track;\r\n    }\r\n}\r\nclass NativeSoundProcessedEvent extends MediaEvent {\r\n    constructor(target, _processedData) {\r\n        super(target, 'NativeSoundProcessedEvent');\r\n        this._processedData = _processedData;\r\n        this.data = this._processedData;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Sound.ts\n\r\n/**\r\n * Whether or not the browser can play this file as HTML5 Audio\r\n */\r\nfunction canPlayFile(file) {\r\n    try {\r\n        const a = new Audio();\r\n        const filetype = /.*\\.([A-Za-z0-9]+)(?:(?:\\?|\\#).*)*$/;\r\n        const type = file.match(filetype)[1];\r\n        if (a.canPlayType('audio/' + type)) {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n    catch (e) {\r\n        Logger.getInstance().warn('Cannot determine audio support, assuming no support for the Audio Tag', e);\r\n        return false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Resources/Sound/Sound.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst SoundEvents = {\r\n    VolumeChange: 'volumechange',\r\n    Processed: 'processed',\r\n    Pause: 'pause',\r\n    Stop: 'stop',\r\n    PlaybackEnd: 'playbackend',\r\n    Resume: 'resume',\r\n    PlaybackStart: 'playbackstart'\r\n};\r\n/**\r\n * The [[Sound]] object allows games built in Excalibur to load audio\r\n * components, from soundtracks to sound effects. [[Sound]] is an [[Loadable]]\r\n * which means it can be passed to a [[Loader]] to pre-load before a game or level.\r\n */\r\nclass Sound {\r\n    /**\r\n     * Indicates whether the clip should loop when complete\r\n     * @param value  Set the looping flag\r\n     */\r\n    set loop(value) {\r\n        this._loop = value;\r\n        for (const track of this._tracks) {\r\n            track.loop = this._loop;\r\n        }\r\n        this.logger.debug('Set loop for all instances of sound', this.path, 'to', this._loop);\r\n    }\r\n    get loop() {\r\n        return this._loop;\r\n    }\r\n    set volume(value) {\r\n        this._volume = value;\r\n        for (const track of this._tracks) {\r\n            track.volume = this._volume;\r\n        }\r\n        this.events.emit('volumechange', new NativeSoundEvent(this));\r\n        this.logger.debug('Set loop for all instances of sound', this.path, 'to', this._volume);\r\n    }\r\n    get volume() {\r\n        return this._volume;\r\n    }\r\n    /**\r\n     * Get the duration that this audio should play. If unset the total natural playback duration will be used.\r\n     */\r\n    get duration() {\r\n        return this._duration;\r\n    }\r\n    /**\r\n     * Set the duration that this audio should play. If unset the total natural playback duration will be used.\r\n     *\r\n     * Note: if you seek to a specific point the duration will start from that point, for example\r\n     *\r\n     * If you have a 10 second clip, seek to 5 seconds, then set the duration to 2, it will play the clip from 5-7 seconds.\r\n     */\r\n    set duration(duration) {\r\n        this._duration = duration;\r\n    }\r\n    /**\r\n     * Return array of Current AudioInstances playing or being paused\r\n     */\r\n    get instances() {\r\n        return this._tracks;\r\n    }\r\n    get path() {\r\n        return this._resource.path;\r\n    }\r\n    set path(val) {\r\n        this._resource.path = val;\r\n    }\r\n    /**\r\n     * Should excalibur add a cache busting querystring? By default false.\r\n     * Must be set before loading\r\n     */\r\n    get bustCache() {\r\n        return this._resource.bustCache;\r\n    }\r\n    set bustCache(val) {\r\n        this._resource.bustCache = val;\r\n    }\r\n    /**\r\n     * @param paths A list of audio sources (clip.wav, clip.mp3, clip.ogg) for this audio clip. This is done for browser compatibility.\r\n     */\r\n    constructor(...paths) {\r\n        this.events = new EventEmitter();\r\n        this.logger = Logger.getInstance();\r\n        this._loop = false;\r\n        this._volume = 1;\r\n        this._isStopped = false;\r\n        // private _isPaused = false;\r\n        this._tracks = [];\r\n        this._wasPlayingOnHidden = false;\r\n        this._playbackRate = 1.0;\r\n        this._audioContext = AudioContextFactory.create();\r\n        this._resource = new Resource('', ExResponse.type.arraybuffer);\r\n        /**\r\n         * Chrome : MP3, WAV, Ogg\r\n         * Firefox : WAV, Ogg,\r\n         * IE : MP3, WAV coming soon\r\n         * Safari MP3, WAV, Ogg\r\n         */\r\n        for (const path of paths) {\r\n            if (canPlayFile(path)) {\r\n                this.path = path;\r\n                break;\r\n            }\r\n        }\r\n        if (!this.path) {\r\n            this.logger.warn('This browser does not support any of the audio files specified:', paths.join(', '));\r\n            this.logger.warn('Attempting to use', paths[0]);\r\n            this.path = paths[0]; // select the first specified\r\n        }\r\n    }\r\n    isLoaded() {\r\n        return !!this.data;\r\n    }\r\n    async load() {\r\n        var _a, _b;\r\n        if (this.data) {\r\n            return this.data;\r\n        }\r\n        const arraybuffer = await this._resource.load();\r\n        const audiobuffer = await this.decodeAudio(arraybuffer.slice(0));\r\n        this._duration = (_b = (_a = this._duration) !== null && _a !== void 0 ? _a : audiobuffer === null || audiobuffer === void 0 ? void 0 : audiobuffer.duration) !== null && _b !== void 0 ? _b : undefined;\r\n        this.events.emit('processed', new NativeSoundProcessedEvent(this, audiobuffer));\r\n        return this.data = audiobuffer;\r\n    }\r\n    async decodeAudio(data) {\r\n        try {\r\n            return await this._audioContext.decodeAudioData(data.slice(0));\r\n        }\r\n        catch (e) {\r\n            this.logger.error('Unable to decode ' +\r\n                ' this browser may not fully support this format, or the file may be corrupt, ' +\r\n                'if this is an mp3 try removing id3 tags and album art from the file.');\r\n            return await Promise.reject();\r\n        }\r\n    }\r\n    wireEngine(engine) {\r\n        if (engine) {\r\n            this._engine = engine;\r\n            this._engine.on('hidden', () => {\r\n                if (engine.pauseAudioWhenHidden && this.isPlaying()) {\r\n                    this._wasPlayingOnHidden = true;\r\n                    this.pause();\r\n                }\r\n            });\r\n            this._engine.on('visible', () => {\r\n                if (engine.pauseAudioWhenHidden && this._wasPlayingOnHidden) {\r\n                    this.play();\r\n                    this._wasPlayingOnHidden = false;\r\n                }\r\n            });\r\n            this._engine.on('start', () => {\r\n                this._isStopped = false;\r\n            });\r\n            this._engine.on('stop', () => {\r\n                this.stop();\r\n                this._isStopped = true;\r\n            });\r\n        }\r\n    }\r\n    /**\r\n     * Returns how many instances of the sound are currently playing\r\n     */\r\n    instanceCount() {\r\n        return this._tracks.length;\r\n    }\r\n    /**\r\n     * Whether or not the sound is playing right now\r\n     */\r\n    isPlaying() {\r\n        return this._tracks.some((t) => t.isPlaying());\r\n    }\r\n    isPaused() {\r\n        return this._tracks.some(t => t.isPaused());\r\n    }\r\n    /**\r\n     * Play the sound, returns a promise that resolves when the sound is done playing\r\n     * An optional volume argument can be passed in to play the sound. Max volume is 1.0\r\n     */\r\n    play(volume) {\r\n        if (!this.isLoaded()) {\r\n            this.logger.warn('Cannot start playing. Resource', this.path, 'is not loaded yet');\r\n            return Promise.resolve(true);\r\n        }\r\n        if (this._isStopped) {\r\n            this.logger.warn('Cannot start playing. Engine is in a stopped state.');\r\n            return Promise.resolve(false);\r\n        }\r\n        this.volume = volume || this.volume;\r\n        if (this.isPaused()) {\r\n            return this._resumePlayback();\r\n        }\r\n        else {\r\n            return this._startPlayback();\r\n        }\r\n    }\r\n    /**\r\n     * Stop the sound, and do not rewind\r\n     */\r\n    pause() {\r\n        if (!this.isPlaying()) {\r\n            return;\r\n        }\r\n        for (const track of this._tracks) {\r\n            track.pause();\r\n        }\r\n        this.events.emit('pause', new NativeSoundEvent(this));\r\n        this.logger.debug('Paused all instances of sound', this.path);\r\n    }\r\n    /**\r\n     * Stop the sound if it is currently playing and rewind the track. If the sound is not playing, rewinds the track.\r\n     */\r\n    stop() {\r\n        for (const track of this._tracks) {\r\n            track.stop();\r\n        }\r\n        this.events.emit('stop', new NativeSoundEvent(this));\r\n        this._tracks.length = 0;\r\n        this.logger.debug('Stopped all instances of sound', this.path);\r\n    }\r\n    get playbackRate() {\r\n        return this._playbackRate;\r\n    }\r\n    set playbackRate(playbackRate) {\r\n        this._playbackRate = playbackRate;\r\n        this._tracks.forEach(t => {\r\n            t.playbackRate = this._playbackRate;\r\n        });\r\n    }\r\n    seek(position, trackId = 0) {\r\n        if (this._tracks.length === 0) {\r\n            this._getTrackInstance(this.data);\r\n        }\r\n        this._tracks[trackId].seek(position);\r\n    }\r\n    getTotalPlaybackDuration() {\r\n        return this.data.duration;\r\n    }\r\n    /**\r\n     * Return the current playback time of the playing track in seconds from the start.\r\n     *\r\n     * Optionally specify the track to query if multiple are playing at once.\r\n     * @param trackId\r\n     */\r\n    getPlaybackPosition(trackId = 0) {\r\n        if (this._tracks.length) {\r\n            return this._tracks[trackId].getPlaybackPosition();\r\n        }\r\n        return 0;\r\n    }\r\n    /**\r\n     * Get Id of provided AudioInstance in current trackList\r\n     * @param track [[Audio]] which Id is to be given\r\n     */\r\n    getTrackId(track) {\r\n        return this._tracks.indexOf(track);\r\n    }\r\n    async _resumePlayback() {\r\n        if (this.isPaused) {\r\n            const resumed = [];\r\n            // ensure we resume *current* tracks (if paused)\r\n            for (const track of this._tracks) {\r\n                resumed.push(track.play().then(() => {\r\n                    this.events.emit('playbackend', new NativeSoundEvent(this, track));\r\n                    this._tracks.splice(this.getTrackId(track), 1);\r\n                    return true;\r\n                }));\r\n            }\r\n            this.events.emit('resume', new NativeSoundEvent(this));\r\n            this.logger.debug('Resuming paused instances for sound', this.path, this._tracks);\r\n            // resolve when resumed tracks are done\r\n            await Promise.all(resumed);\r\n        }\r\n        return true;\r\n    }\r\n    /**\r\n     * Starts playback, returns a promise that resolves when playback is complete\r\n     */\r\n    async _startPlayback() {\r\n        const track = await this._getTrackInstance(this.data);\r\n        const complete = await track.play(() => {\r\n            this.events.emit('playbackstart', new NativeSoundEvent(this, track));\r\n            this.logger.debug('Playing new instance for sound', this.path);\r\n        });\r\n        // when done, remove track\r\n        this.events.emit('playbackend', new NativeSoundEvent(this, track));\r\n        this._tracks.splice(this.getTrackId(track), 1);\r\n        return complete;\r\n    }\r\n    _getTrackInstance(data) {\r\n        const newTrack = new WebAudioInstance(data);\r\n        newTrack.loop = this.loop;\r\n        newTrack.volume = this.volume;\r\n        newTrack.duration = this.duration;\r\n        newTrack.playbackRate = this._playbackRate;\r\n        this._tracks.push(newTrack);\r\n        return newTrack;\r\n    }\r\n    emit(eventName, event) {\r\n        this.events.emit(eventName, event);\r\n    }\r\n    on(eventName, handler) {\r\n        return this.events.on(eventName, handler);\r\n    }\r\n    once(eventName, handler) {\r\n        return this.events.once(eventName, handler);\r\n    }\r\n    off(eventName, handler) {\r\n        this.events.off(eventName, handler);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Loader.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst LoaderEvents = {\r\n// Add event types here\r\n};\r\n/**\r\n * Pre-loading assets\r\n *\r\n * The loader provides a mechanism to preload multiple resources at\r\n * one time. The loader must be passed to the engine in order to\r\n * trigger the loading progress bar.\r\n *\r\n * The [[Loader]] itself implements [[Loadable]] so you can load loaders.\r\n *\r\n * ## Example: Pre-loading resources for a game\r\n *\r\n * ```js\r\n * // create a loader\r\n * var loader = new ex.Loader();\r\n *\r\n * // create a resource dictionary (best practice is to keep a separate file)\r\n * var resources = {\r\n *   TextureGround: new ex.Texture(\"/images/textures/ground.png\"),\r\n *   SoundDeath: new ex.Sound(\"/sound/death.wav\", \"/sound/death.mp3\")\r\n * };\r\n *\r\n * // loop through dictionary and add to loader\r\n * for (var loadable in resources) {\r\n *   if (resources.hasOwnProperty(loadable)) {\r\n *     loader.addResource(resources[loadable]);\r\n *   }\r\n * }\r\n *\r\n * // start game\r\n * game.start(loader).then(function () {\r\n *   console.log(\"Game started!\");\r\n * });\r\n * ```\r\n *\r\n * ## Customize the Loader\r\n *\r\n * The loader can be customized to show different, text, logo, background color, and button.\r\n *\r\n * ```typescript\r\n * const loader = new ex.Loader([playerTexture]);\r\n *\r\n * // The loaders button text can simply modified using this\r\n * loader.playButtonText = 'Start the best game ever';\r\n *\r\n * // The logo can be changed by inserting a base64 image string here\r\n *\r\n * loader.logo = 'data:image/png;base64,iVBORw...';\r\n * loader.logoWidth = 15;\r\n * loader.logoHeight = 14;\r\n *\r\n * // The background color can be changed like so by supplying a valid CSS color string\r\n *\r\n * loader.backgroundColor = 'red'\r\n * loader.backgroundColor = '#176BAA'\r\n *\r\n * // To build a completely new button\r\n * loader.startButtonFactory = () => {\r\n *     let myButton = document.createElement('button');\r\n *     myButton.textContent = 'The best button';\r\n *     return myButton;\r\n * };\r\n *\r\n * engine.start(loader).then(() => {});\r\n * ```\r\n */\r\nclass Loader {\r\n    get _image() {\r\n        if (!this._imageElement) {\r\n            this._imageElement = new Image();\r\n            this._imageElement.src = this.logo;\r\n        }\r\n        return this._imageElement;\r\n    }\r\n    get playButtonRootElement() {\r\n        return this._playButtonRootElement;\r\n    }\r\n    get playButtonElement() {\r\n        return this._playButtonElement;\r\n    }\r\n    get _playButton() {\r\n        const existingRoot = document.getElementById('excalibur-play-root');\r\n        if (existingRoot) {\r\n            this._playButtonRootElement = existingRoot;\r\n        }\r\n        if (!this._playButtonRootElement) {\r\n            this._playButtonRootElement = document.createElement('div');\r\n            this._playButtonRootElement.id = 'excalibur-play-root';\r\n            this._playButtonRootElement.style.position = 'absolute';\r\n            document.body.appendChild(this._playButtonRootElement);\r\n        }\r\n        if (!this._styleBlock) {\r\n            this._styleBlock = document.createElement('style');\r\n            this._styleBlock.textContent = this._playButtonStyles;\r\n            document.head.appendChild(this._styleBlock);\r\n        }\r\n        if (!this._playButtonElement) {\r\n            this._playButtonElement = this.startButtonFactory();\r\n            this._playButtonRootElement.appendChild(this._playButtonElement);\r\n        }\r\n        return this._playButtonElement;\r\n    }\r\n    /**\r\n     * @param loadables  Optionally provide the list of resources you want to load at constructor time\r\n     */\r\n    constructor(loadables) {\r\n        this.events = new EventEmitter();\r\n        this.canvas = new Canvas({\r\n            filtering: ImageFiltering.Blended,\r\n            smoothing: true,\r\n            cache: true,\r\n            draw: this.draw.bind(this)\r\n        });\r\n        this._resourceList = [];\r\n        this._index = 0;\r\n        this._playButtonShown = false;\r\n        this._resourceCount = 0;\r\n        this._numLoaded = 0;\r\n        this._progressCounts = {};\r\n        this._totalCounts = {};\r\n        // logo drawing stuff\r\n        // base64 string encoding of the excalibur logo (logo-white.png)\r\n        this.logo = Loader_logo;\r\n        this.logoWidth = 468;\r\n        this.logoHeight = 118;\r\n        /**\r\n         * Gets or sets the color of the loading bar, default is [[Color.White]]\r\n         */\r\n        this.loadingBarColor = Color.White;\r\n        /**\r\n         * Gets or sets the background color of the loader as a hex string\r\n         */\r\n        this.backgroundColor = '#176BAA';\r\n        this.suppressPlayButton = false;\r\n        /** Loads the css from Loader.css */\r\n        this._playButtonStyles = Loader_0/* default */.Z.toString();\r\n        /**\r\n         * Get/set play button text\r\n         */\r\n        this.playButtonText = 'Play game';\r\n        /**\r\n         * Return a html button element for excalibur to use as a play button\r\n         */\r\n        this.startButtonFactory = () => {\r\n            let buttonElement = document.getElementById('excalibur-play');\r\n            if (!buttonElement) {\r\n                buttonElement = document.createElement('button');\r\n            }\r\n            buttonElement.id = 'excalibur-play';\r\n            buttonElement.textContent = this.playButtonText;\r\n            buttonElement.style.display = 'none';\r\n            return buttonElement;\r\n        };\r\n        this._loadingFuture = new Future();\r\n        if (loadables) {\r\n            this.addResources(loadables);\r\n        }\r\n    }\r\n    wireEngine(engine) {\r\n        this._engine = engine;\r\n        this.canvas.width = this._engine.canvas.width;\r\n        this.canvas.height = this._engine.canvas.height;\r\n    }\r\n    /**\r\n     * Add a resource to the loader to load\r\n     * @param loadable  Resource to add\r\n     */\r\n    addResource(loadable) {\r\n        const key = this._index++;\r\n        this._resourceList.push(loadable);\r\n        this._progressCounts[key] = 0;\r\n        this._totalCounts[key] = 1;\r\n        this._resourceCount++;\r\n    }\r\n    /**\r\n     * Add a list of resources to the loader to load\r\n     * @param loadables  The list of resources to load\r\n     */\r\n    addResources(loadables) {\r\n        let i = 0;\r\n        const len = loadables.length;\r\n        for (i; i < len; i++) {\r\n            this.addResource(loadables[i]);\r\n        }\r\n    }\r\n    /**\r\n     * Returns true if the loader has completely loaded all resources\r\n     */\r\n    isLoaded() {\r\n        return this._numLoaded === this._resourceCount;\r\n    }\r\n    /**\r\n     * Shows the play button and returns a promise that resolves when clicked\r\n     */\r\n    async showPlayButton() {\r\n        var _a, _b;\r\n        if (this.suppressPlayButton) {\r\n            this.hidePlayButton();\r\n            // Delay is to give the logo a chance to show, otherwise don't delay\r\n            await delay(500, (_a = this._engine) === null || _a === void 0 ? void 0 : _a.clock);\r\n        }\r\n        else {\r\n            const resizeHandler = () => {\r\n                this._positionPlayButton();\r\n            };\r\n            if ((_b = this._engine) === null || _b === void 0 ? void 0 : _b.browser) {\r\n                this._engine.browser.window.on('resize', resizeHandler);\r\n            }\r\n            this._playButtonShown = true;\r\n            this._playButton.style.display = 'block';\r\n            document.body.addEventListener('keyup', (evt) => {\r\n                if (evt.key === 'Enter') {\r\n                    this._playButton.click();\r\n                }\r\n            });\r\n            this._positionPlayButton();\r\n            const playButtonClicked = new Promise((resolve) => {\r\n                const startButtonHandler = (e) => {\r\n                    var _a;\r\n                    // We want to stop propagation to keep bubbling to the engine pointer handlers\r\n                    e.stopPropagation();\r\n                    // Hide Button after click\r\n                    this.hidePlayButton();\r\n                    if ((_a = this._engine) === null || _a === void 0 ? void 0 : _a.browser) {\r\n                        this._engine.browser.window.off('resize', resizeHandler);\r\n                    }\r\n                    resolve();\r\n                };\r\n                this._playButton.addEventListener('click', startButtonHandler);\r\n                this._playButton.addEventListener('touchend', startButtonHandler);\r\n                this._playButton.addEventListener('pointerup', startButtonHandler);\r\n            });\r\n            return await playButtonClicked;\r\n        }\r\n    }\r\n    hidePlayButton() {\r\n        this._playButtonShown = false;\r\n        this._playButton.style.display = 'none';\r\n    }\r\n    /**\r\n     * Clean up generated elements for the loader\r\n     */\r\n    dispose() {\r\n        if (this._playButtonRootElement.parentElement) {\r\n            this._playButtonRootElement.removeChild(this._playButtonElement);\r\n            document.body.removeChild(this._playButtonRootElement);\r\n            document.head.removeChild(this._styleBlock);\r\n            this._playButtonRootElement = null;\r\n            this._playButtonElement = null;\r\n            this._styleBlock = null;\r\n        }\r\n    }\r\n    update(_engine, _delta) {\r\n        // override me\r\n    }\r\n    areResourcesLoaded() {\r\n        return this._loadingFuture.promise;\r\n    }\r\n    /**\r\n     * Begin loading all of the supplied resources, returning a promise\r\n     * that resolves when loading of all is complete AND the user has clicked the \"Play button\"\r\n     */\r\n    async load() {\r\n        var _a, _b;\r\n        await ((_a = this._image) === null || _a === void 0 ? void 0 : _a.decode()); // decode logo if it exists\r\n        this.canvas.flagDirty();\r\n        await Promise.all(this._resourceList.map(async (r) => {\r\n            await r.load().finally(() => {\r\n                // capture progress\r\n                this._numLoaded++;\r\n                this.canvas.flagDirty();\r\n            });\r\n        }));\r\n        // Wire all sound to the engine\r\n        for (const resource of this._resourceList) {\r\n            if (resource instanceof Sound) {\r\n                resource.wireEngine(this._engine);\r\n            }\r\n        }\r\n        this._loadingFuture.resolve();\r\n        // short delay in showing the button for aesthetics\r\n        await delay(200, (_b = this._engine) === null || _b === void 0 ? void 0 : _b.clock);\r\n        this.canvas.flagDirty();\r\n        await this.showPlayButton();\r\n        // Unlock browser AudioContext in after user gesture\r\n        // See: https://github.com/excaliburjs/Excalibur/issues/262\r\n        // See: https://github.com/excaliburjs/Excalibur/issues/1031\r\n        await WebAudio.unlock();\r\n        return (this.data = this._resourceList);\r\n    }\r\n    markResourceComplete() {\r\n        this._numLoaded++;\r\n    }\r\n    /**\r\n     * Returns the progress of the loader as a number between [0, 1] inclusive.\r\n     */\r\n    get progress() {\r\n        return this._resourceCount > 0 ? clamp(this._numLoaded, 0, this._resourceCount) / this._resourceCount : 1;\r\n    }\r\n    _positionPlayButton() {\r\n        if (this._engine) {\r\n            const screenHeight = this._engine.screen.viewport.height;\r\n            const screenWidth = this._engine.screen.viewport.width;\r\n            if (this._playButtonRootElement) {\r\n                const left = this._engine.canvas.offsetLeft;\r\n                const top = this._engine.canvas.offsetTop;\r\n                const buttonWidth = this._playButton.clientWidth;\r\n                const buttonHeight = this._playButton.clientHeight;\r\n                if (this.playButtonPosition) {\r\n                    this._playButtonRootElement.style.left = `${this.playButtonPosition.x}px`;\r\n                    this._playButtonRootElement.style.top = `${this.playButtonPosition.y}px`;\r\n                }\r\n                else {\r\n                    this._playButtonRootElement.style.left = `${left + screenWidth / 2 - buttonWidth / 2}px`;\r\n                    this._playButtonRootElement.style.top = `${top + screenHeight / 2 - buttonHeight / 2 + 100}px`;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Loader draw function. Draws the default Excalibur loading screen.\r\n     * Override `logo`, `logoWidth`, `logoHeight` and `backgroundColor` properties\r\n     * to customize the drawing, or just override entire method.\r\n     */\r\n    draw(ctx) {\r\n        const canvasHeight = this._engine.canvasHeight / this._engine.pixelRatio;\r\n        const canvasWidth = this._engine.canvasWidth / this._engine.pixelRatio;\r\n        this._positionPlayButton();\r\n        ctx.fillStyle = this.backgroundColor;\r\n        ctx.fillRect(0, 0, canvasWidth, canvasHeight);\r\n        let logoY = canvasHeight / 2;\r\n        const width = Math.min(this.logoWidth, canvasWidth * 0.75);\r\n        let logoX = canvasWidth / 2 - width / 2;\r\n        if (this.logoPosition) {\r\n            logoX = this.logoPosition.x;\r\n            logoY = this.logoPosition.y;\r\n        }\r\n        const imageHeight = Math.floor(width * (this.logoHeight / this.logoWidth)); // OG height/width factor\r\n        const oldAntialias = this._engine.getAntialiasing();\r\n        this._engine.setAntialiasing(true);\r\n        if (!this.logoPosition) {\r\n            ctx.drawImage(this._image, 0, 0, this.logoWidth, this.logoHeight, logoX, logoY - imageHeight - 20, width, imageHeight);\r\n        }\r\n        else {\r\n            ctx.drawImage(this._image, 0, 0, this.logoWidth, this.logoHeight, logoX, logoY, width, imageHeight);\r\n        }\r\n        // loading box\r\n        if (!this.suppressPlayButton && this._playButtonShown) {\r\n            this._engine.setAntialiasing(oldAntialias);\r\n            return;\r\n        }\r\n        let loadingX = logoX;\r\n        let loadingY = logoY;\r\n        if (this.loadingBarPosition) {\r\n            loadingX = this.loadingBarPosition.x;\r\n            loadingY = this.loadingBarPosition.y;\r\n        }\r\n        ctx.lineWidth = 2;\r\n        roundRect(ctx, loadingX, loadingY, width, 20, 10, this.loadingBarColor);\r\n        const progress = width * this.progress;\r\n        const margin = 5;\r\n        const progressWidth = progress - margin * 2;\r\n        const height = 20 - margin * 2;\r\n        roundRect(ctx, loadingX + margin, loadingY + margin, progressWidth > 10 ? progressWidth : 10, height, 5, null, this.loadingBarColor);\r\n        this._engine.setAntialiasing(oldAntialias);\r\n    }\r\n    emit(eventName, event) {\r\n        this.events.emit(eventName, event);\r\n    }\r\n    on(eventName, handler) {\r\n        return this.events.on(eventName, handler);\r\n    }\r\n    once(eventName, handler) {\r\n        return this.events.once(eventName, handler);\r\n    }\r\n    off(eventName, handler) {\r\n        this.events.off(eventName, handler);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Detector.ts\n\r\n/**\r\n * This is the list of features that will be used to log the supported\r\n * features to the console when Detector.logBrowserFeatures() is called.\r\n */\r\nconst REPORTED_FEATURES = {\r\n    webgl: 'WebGL',\r\n    webaudio: 'WebAudio',\r\n    gamepadapi: 'Gamepad API'\r\n};\r\n/**\r\n * Excalibur internal feature detection helper class\r\n */\r\nclass Detector {\r\n    constructor() {\r\n        this._features = null;\r\n        this.failedTests = [];\r\n        // critical browser features required for ex to run\r\n        this._criticalTests = {\r\n            // Test canvas/2d context support\r\n            canvasSupport: function () {\r\n                const elem = document.createElement('canvas');\r\n                return !!(elem.getContext && elem.getContext('2d'));\r\n            },\r\n            // Test array buffer support ex uses for downloading binary data\r\n            arrayBufferSupport: function () {\r\n                const xhr = new XMLHttpRequest();\r\n                xhr.open('GET', '/');\r\n                try {\r\n                    xhr.responseType = 'arraybuffer';\r\n                }\r\n                catch (e) {\r\n                    return false;\r\n                }\r\n                return xhr.responseType === 'arraybuffer';\r\n            },\r\n            // Test data urls ex uses for sprites\r\n            dataUrlSupport: function () {\r\n                const canvas = document.createElement('canvas');\r\n                return canvas.toDataURL('image/png').indexOf('data:image/png') === 0;\r\n            },\r\n            // Test object url support for loading\r\n            objectUrlSupport: function () {\r\n                return 'URL' in window && 'revokeObjectURL' in URL && 'createObjectURL' in URL;\r\n            },\r\n            // RGBA support for colors\r\n            rgbaSupport: function () {\r\n                const style = document.createElement('a').style;\r\n                style.cssText = 'background-color:rgba(150,255,150,.5)';\r\n                return ('' + style.backgroundColor).indexOf('rgba') > -1;\r\n            }\r\n        };\r\n        // warnings excalibur performance will be degraded\r\n        this._warningTest = {\r\n            webAudioSupport: function () {\r\n                return !!(window.AudioContext ||\r\n                    window.webkitAudioContext ||\r\n                    window.mozAudioContext ||\r\n                    window.msAudioContext ||\r\n                    window.oAudioContext);\r\n            },\r\n            webglSupport: function () {\r\n                const elem = document.createElement('canvas');\r\n                return !!(elem.getContext && elem.getContext('webgl'));\r\n            }\r\n        };\r\n        this._features = this._loadBrowserFeatures();\r\n    }\r\n    /**\r\n     * Returns a map of currently supported browser features. This method\r\n     * treats the features as a singleton and will only calculate feature\r\n     * support if it has not previously been done.\r\n     */\r\n    getBrowserFeatures() {\r\n        if (this._features === null) {\r\n            this._features = this._loadBrowserFeatures();\r\n        }\r\n        return this._features;\r\n    }\r\n    /**\r\n     * Report on non-critical browser support for debugging purposes.\r\n     * Use native browser console colors for visibility.\r\n     */\r\n    logBrowserFeatures() {\r\n        let msg = '%cSUPPORTED BROWSER FEATURES\\n==========================%c\\n';\r\n        const args = ['font-weight: bold; color: navy', 'font-weight: normal; color: inherit'];\r\n        const supported = this.getBrowserFeatures();\r\n        for (const feature of Object.keys(REPORTED_FEATURES)) {\r\n            if (supported[feature]) {\r\n                msg += '(%c\\u2713%c)'; // (✓)\r\n                args.push('font-weight: bold; color: green');\r\n                args.push('font-weight: normal; color: inherit');\r\n            }\r\n            else {\r\n                msg += '(%c\\u2717%c)'; // (✗)\r\n                args.push('font-weight: bold; color: red');\r\n                args.push('font-weight: normal; color: inherit');\r\n            }\r\n            msg += ' ' + REPORTED_FEATURES[feature] + '\\n';\r\n        }\r\n        args.unshift(msg);\r\n        // eslint-disable-next-line no-console\r\n        console.log.apply(console, args);\r\n    }\r\n    /**\r\n     * Executes several IIFE's to get a constant reference to supported\r\n     * features within the current execution context.\r\n     */\r\n    _loadBrowserFeatures() {\r\n        return {\r\n            // IIFE to check canvas support\r\n            canvas: (() => {\r\n                return this._criticalTests.canvasSupport();\r\n            })(),\r\n            // IIFE to check arraybuffer support\r\n            arraybuffer: (() => {\r\n                return this._criticalTests.arrayBufferSupport();\r\n            })(),\r\n            // IIFE to check dataurl support\r\n            dataurl: (() => {\r\n                return this._criticalTests.dataUrlSupport();\r\n            })(),\r\n            // IIFE to check objecturl support\r\n            objecturl: (() => {\r\n                return this._criticalTests.objectUrlSupport();\r\n            })(),\r\n            // IIFE to check rgba support\r\n            rgba: (() => {\r\n                return this._criticalTests.rgbaSupport();\r\n            })(),\r\n            // IIFE to check webaudio support\r\n            webaudio: (() => {\r\n                return this._warningTest.webAudioSupport();\r\n            })(),\r\n            // IIFE to check webgl support\r\n            webgl: (() => {\r\n                return this._warningTest.webglSupport();\r\n            })(),\r\n            // IIFE to check gamepadapi support\r\n            gamepadapi: (() => {\r\n                return !!navigator.getGamepads;\r\n            })()\r\n        };\r\n    }\r\n    test() {\r\n        // Critical test will for ex not to run\r\n        let failedCritical = false;\r\n        for (const test in this._criticalTests) {\r\n            if (!this._criticalTests[test].call(this)) {\r\n                this.failedTests.push(test);\r\n                Logger.getInstance().error('Critical browser feature missing, Excalibur requires:', test);\r\n                failedCritical = true;\r\n            }\r\n        }\r\n        if (failedCritical) {\r\n            return false;\r\n        }\r\n        // Warning tests do not for ex to return false to compatibility\r\n        for (const warning in this._warningTest) {\r\n            if (!this._warningTest[warning]()) {\r\n                Logger.getInstance().warn('Warning browser feature missing, Excalibur will have reduced performance:', warning);\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/CollisionType.ts\n/**\r\n * An enum that describes the types of collisions bodies can participate in\r\n */\r\nvar CollisionType;\r\n(function (CollisionType) {\r\n    /**\r\n     * Bodies with the `PreventCollision` setting do not participate in any\r\n     * collisions and do not raise collision events.\r\n     */\r\n    CollisionType[\"PreventCollision\"] = \"PreventCollision\";\r\n    /**\r\n     * Bodies with the `Passive` setting only raise collision events, but are not\r\n     * influenced or moved by other bodies and do not influence or move other bodies.\r\n     * This is useful for use in trigger type behavior.\r\n     */\r\n    CollisionType[\"Passive\"] = \"Passive\";\r\n    /**\r\n     * Bodies with the `Active` setting raise collision events and participate\r\n     * in collisions with other bodies and will be push or moved by bodies sharing\r\n     * the `Active` or `Fixed` setting.\r\n     */\r\n    CollisionType[\"Active\"] = \"Active\";\r\n    /**\r\n     * Bodies with the `Fixed` setting raise collision events and participate in\r\n     * collisions with other bodies. Actors with the `Fixed` setting will not be\r\n     * pushed or moved by other bodies sharing the `Fixed`. Think of Fixed\r\n     * bodies as \"immovable/unstoppable\" objects. If two `Fixed` bodies meet they will\r\n     * not be pushed or moved by each other, they will not interact except to throw\r\n     * collision events.\r\n     */\r\n    CollisionType[\"Fixed\"] = \"Fixed\";\r\n})(CollisionType || (CollisionType = {}));\r\n\n;// CONCATENATED MODULE: ./Util/Decorators.ts\n\r\n\r\nconst maxMessages = 5;\r\nconst obsoleteMessage = {};\r\nconst resetObsoleteCounter = () => {\r\n    for (const message in obsoleteMessage) {\r\n        obsoleteMessage[message] = 0;\r\n    }\r\n};\r\nconst logMessage = (message, options) => {\r\n    const suppressObsoleteMessages = Flags.isEnabled('suppress-obsolete-message');\r\n    if (obsoleteMessage[message] < maxMessages && !suppressObsoleteMessages) {\r\n        Logger.getInstance().warn(message);\r\n        // tslint:disable-next-line: no-console\r\n        if (console.trace && options.showStackTrace) {\r\n            // tslint:disable-next-line: no-console\r\n            console.trace();\r\n        }\r\n    }\r\n    obsoleteMessage[message]++;\r\n};\r\n/**\r\n * Obsolete decorator for marking Excalibur methods obsolete, you can optionally specify a custom message and/or alternate replacement\r\n * method do the deprecated one. Inspired by https://github.com/jayphelps/core-decorators.js\r\n */\r\nfunction obsolete(options) {\r\n    options = {\r\n        message: 'This feature will be removed in future versions of Excalibur.',\r\n        alternateMethod: null,\r\n        showStackTrace: false,\r\n        ...options\r\n    };\r\n    return function (target, property, descriptor) {\r\n        if (descriptor &&\r\n            !(typeof descriptor.value === 'function' || typeof descriptor.get === 'function' || typeof descriptor.set === 'function')) {\r\n            throw new SyntaxError('Only classes/functions/getters/setters can be marked as obsolete');\r\n        }\r\n        const methodSignature = `${target.name || ''}${target.name && property ? '.' : ''}${property ? property : ''}`;\r\n        const message = `${methodSignature} is marked obsolete: ${options.message}` +\r\n            (options.alternateMethod ? ` Use ${options.alternateMethod} instead` : '');\r\n        if (!obsoleteMessage[message]) {\r\n            obsoleteMessage[message] = 0;\r\n        }\r\n        // If descriptor is null it is a class\r\n        const method = descriptor ? { ...descriptor } : target;\r\n        if (!descriptor) {\r\n            // with es2015 classes we need to change our decoration tactic\r\n            class DecoratedClass extends method {\r\n                constructor(...args) {\r\n                    logMessage(message, options);\r\n                    super(...args);\r\n                }\r\n            }\r\n            return DecoratedClass;\r\n        }\r\n        if (descriptor && descriptor.value) {\r\n            method.value = function () {\r\n                logMessage(message, options);\r\n                return descriptor.value.apply(this, arguments);\r\n            };\r\n            return method;\r\n        }\r\n        if (descriptor && descriptor.get) {\r\n            method.get = function () {\r\n                logMessage(message, options);\r\n                return descriptor.get.apply(this, arguments);\r\n            };\r\n        }\r\n        if (descriptor && descriptor.set) {\r\n            method.set = function () {\r\n                logMessage(message, options);\r\n                return descriptor.set.apply(this, arguments);\r\n            };\r\n        }\r\n        return method;\r\n    };\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Physics.ts\nvar __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n};\r\n\r\n\r\n/**\r\n * Possible collision resolution strategies\r\n *\r\n * The default is [[CollisionResolutionStrategy.Arcade]] which performs simple axis aligned arcade style physics. This is useful for things\r\n * like platformers or top down games.\r\n *\r\n * More advanced rigid body physics are enabled by setting [[CollisionResolutionStrategy.Realistic]] which allows for complicated\r\n * simulated physical interactions.\r\n */\r\nvar CollisionResolutionStrategy;\r\n(function (CollisionResolutionStrategy) {\r\n    CollisionResolutionStrategy[\"Arcade\"] = \"arcade\";\r\n    CollisionResolutionStrategy[\"Realistic\"] = \"realistic\";\r\n})(CollisionResolutionStrategy || (CollisionResolutionStrategy = {}));\r\n/**\r\n * Possible broadphase collision pair identification strategies\r\n *\r\n * The default strategy is [[BroadphaseStrategy.DynamicAABBTree]] which uses a binary tree of axis-aligned bounding boxes to identify\r\n * potential collision pairs which is O(nlog(n)) faster.\r\n */\r\nvar BroadphaseStrategy;\r\n(function (BroadphaseStrategy) {\r\n    BroadphaseStrategy[BroadphaseStrategy[\"DynamicAABBTree\"] = 0] = \"DynamicAABBTree\";\r\n})(BroadphaseStrategy || (BroadphaseStrategy = {}));\r\n/**\r\n * Possible numerical integrators for position and velocity\r\n */\r\nvar Integrator;\r\n(function (Integrator) {\r\n    Integrator[Integrator[\"Euler\"] = 0] = \"Euler\";\r\n})(Integrator || (Integrator = {}));\r\n/**\r\n * The [[Physics]] object is the global configuration object for all Excalibur physics.\r\n */\r\n/* istanbul ignore next */\r\nclass Physics {\r\n    static get gravity() {\r\n        return Physics.acc;\r\n    }\r\n    static set gravity(v) {\r\n        Physics.acc = v;\r\n    }\r\n    /**\r\n     * Configures Excalibur to use \"arcade\" physics. Arcade physics which performs simple axis aligned arcade style physics.\r\n     */\r\n    static useArcadePhysics() {\r\n        Physics.collisionResolutionStrategy = CollisionResolutionStrategy.Arcade;\r\n    }\r\n    /**\r\n     * Configures Excalibur to use rigid body physics. Rigid body physics allows for complicated\r\n     * simulated physical interactions.\r\n     */\r\n    static useRealisticPhysics() {\r\n        Physics.collisionResolutionStrategy = CollisionResolutionStrategy.Realistic;\r\n    }\r\n    static get dynamicTreeVelocityMultiplyer() {\r\n        return Physics.dynamicTreeVelocityMultiplier;\r\n    }\r\n    static set dynamicTreeVelocityMultiplyer(value) {\r\n        Physics.dynamicTreeVelocityMultiplier = value;\r\n    }\r\n}\r\n/**\r\n * Global acceleration that is applied to all vanilla actors that have a [[CollisionType.Active|active]] collision type.\r\n * Global acceleration won't effect [[Label|labels]], [[ScreenElement|ui actors]], or [[Trigger|triggers]] in Excalibur.\r\n *\r\n * This is a great way to globally simulate effects like gravity.\r\n */\r\nPhysics.acc = new Vector(0, 0);\r\n/**\r\n * Globally switches all Excalibur physics behavior on or off.\r\n */\r\nPhysics.enabled = true;\r\n/**\r\n * Gets or sets the broadphase pair identification strategy.\r\n *\r\n * The default strategy is [[BroadphaseStrategy.DynamicAABBTree]] which uses a binary tree of axis-aligned bounding boxes to identify\r\n * potential collision pairs which is O(nlog(n)) faster.\r\n */\r\nPhysics.broadphaseStrategy = BroadphaseStrategy.DynamicAABBTree;\r\n/**\r\n * Gets or sets the global collision resolution strategy (narrowphase).\r\n *\r\n * The default is [[CollisionResolutionStrategy.Arcade]] which performs simple axis aligned arcade style physics.\r\n *\r\n * More advanced rigid body physics are enabled by setting [[CollisionResolutionStrategy.Realistic]] which allows for complicated\r\n * simulated physical interactions.\r\n */\r\nPhysics.collisionResolutionStrategy = CollisionResolutionStrategy.Arcade;\r\n/**\r\n * The default mass to use if none is specified\r\n */\r\nPhysics.defaultMass = 10;\r\n/**\r\n * Gets or sets the position and velocity positional integrator, currently only Euler is supported.\r\n */\r\nPhysics.integrator = Integrator.Euler;\r\n/**\r\n * Factor to add to the RigidBody BoundingBox, bounding box (dimensions += vel * dynamicTreeVelocityMultiplier);\r\n */\r\nPhysics.dynamicTreeVelocityMultiplier = 2;\r\n/**\r\n * Pad RigidBody BoundingBox by a constant amount\r\n */\r\nPhysics.boundsPadding = 5;\r\n/**\r\n * Number of position iterations (overlap) to run in the solver\r\n */\r\nPhysics.positionIterations = 3;\r\n/**\r\n * Number of velocity iteration (response) to run in the solver\r\n */\r\nPhysics.velocityIterations = 8;\r\n/**\r\n * Amount of overlap to tolerate in pixels\r\n */\r\nPhysics.slop = 1;\r\n/**\r\n * Amount of positional overlap correction to apply each position iteration of the solver\r\n * O - meaning no correction, 1 - meaning correct all overlap\r\n */\r\nPhysics.steeringFactor = 0.2;\r\n/**\r\n * Warm start set to true re-uses impulses from previous frames back in the solver\r\n */\r\nPhysics.warmStart = true;\r\n/**\r\n * By default bodies do not sleep\r\n */\r\nPhysics.bodiesCanSleepByDefault = false;\r\n/**\r\n * Surface epsilon is used to help deal with surface penetration\r\n */\r\nPhysics.surfaceEpsilon = 0.1;\r\nPhysics.sleepEpsilon = 0.07;\r\nPhysics.wakeThreshold = Physics.sleepEpsilon * 3;\r\nPhysics.sleepBias = 0.9;\r\n/**\r\n * Enable fast moving body checking, this enables checking for collision pairs via raycast for fast moving objects to prevent\r\n * bodies from tunneling through one another.\r\n */\r\nPhysics.checkForFastBodies = true;\r\n/**\r\n * Disable minimum fast moving body raycast, by default if ex.Physics.checkForFastBodies = true Excalibur will only check if the\r\n * body is moving at least half of its minimum dimension in an update. If ex.Physics.disableMinimumSpeedForFastBody is set to true,\r\n * Excalibur will always perform the fast body raycast regardless of speed.\r\n */\r\nPhysics.disableMinimumSpeedForFastBody = false;\r\n__decorate([\r\n    obsolete({\r\n        message: 'Alias for incorrect spelling used in older versions, will be removed in v0.25.0',\r\n        alternateMethod: 'dynamicTreeVelocityMultiplier'\r\n    })\r\n], Physics, \"dynamicTreeVelocityMultiplyer\", null);\r\n\n;// CONCATENATED MODULE: ./Math/coord-plane.ts\n/**\r\n * Enum representing the coordinate plane for the position 2D vector in the [[TransformComponent]]\r\n */\r\nvar CoordPlane;\r\n(function (CoordPlane) {\r\n    /**\r\n     * The world coordinate plane (default) represents world space, any entities drawn with world\r\n     * space move when the camera moves.\r\n     */\r\n    CoordPlane[\"World\"] = \"world\";\r\n    /**\r\n     * The screen coordinate plane represents screen space, entities drawn in screen space are pinned\r\n     * to screen coordinates ignoring the camera.\r\n     */\r\n    CoordPlane[\"Screen\"] = \"screen\";\r\n})(CoordPlane || (CoordPlane = {}));\r\n\n;// CONCATENATED MODULE: ./Math/vector-view.ts\n\r\nclass VectorView extends Vector {\r\n    constructor(options) {\r\n        super(0, 0);\r\n        this._getX = options.getX;\r\n        this._getY = options.getY;\r\n        this._setX = options.setX;\r\n        this._setY = options.setY;\r\n    }\r\n    get x() {\r\n        return (this._x = this._getX());\r\n    }\r\n    set x(val) {\r\n        this._setX(val);\r\n        this._x = val;\r\n    }\r\n    get y() {\r\n        return (this._y = this._getY());\r\n    }\r\n    set y(val) {\r\n        this._setY(val);\r\n        this._y = val;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/watch-vector.ts\n\r\n/**\r\n * Wraps a vector and watches for changes in the x/y, modifies the original vector.\r\n */\r\nclass WatchVector extends Vector {\r\n    constructor(original, change) {\r\n        super(original.x, original.y);\r\n        this.original = original;\r\n        this.change = change;\r\n    }\r\n    get x() {\r\n        return this._x = this.original.x;\r\n    }\r\n    set x(newX) {\r\n        this.change(newX, this._y);\r\n        this._x = this.original.x = newX;\r\n    }\r\n    get y() {\r\n        return this._y = this.original.y;\r\n    }\r\n    set y(newY) {\r\n        this.change(this._x, newY);\r\n        this._y = this.original.y = newY;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/transform.ts\n\r\n\r\n\r\n\r\n\r\nclass Transform {\r\n    constructor() {\r\n        this._parent = null;\r\n        this._children = [];\r\n        this._pos = vec(0, 0);\r\n        this._rotation = 0;\r\n        this._scale = vec(1, 1);\r\n        this._isDirty = false;\r\n        this._isInverseDirty = false;\r\n        this._matrix = AffineMatrix.identity();\r\n        this._inverse = AffineMatrix.identity();\r\n    }\r\n    get parent() {\r\n        return this._parent;\r\n    }\r\n    set parent(transform) {\r\n        if (this._parent) {\r\n            const index = this._parent._children.indexOf(this);\r\n            if (index > -1) {\r\n                this._parent._children.splice(index, 1);\r\n            }\r\n        }\r\n        this._parent = transform;\r\n        if (this._parent) {\r\n            this._parent._children.push(this);\r\n        }\r\n        this.flagDirty();\r\n    }\r\n    get children() {\r\n        return this._children;\r\n    }\r\n    set pos(v) {\r\n        if (!v.equals(this._pos)) {\r\n            this._pos.x = v.x;\r\n            this._pos.y = v.y;\r\n            this.flagDirty();\r\n        }\r\n    }\r\n    get pos() {\r\n        return new WatchVector(this._pos, (x, y) => {\r\n            if (x !== this._pos.x || y !== this._pos.y) {\r\n                this.flagDirty();\r\n            }\r\n        });\r\n    }\r\n    set globalPos(v) {\r\n        let localPos = v.clone();\r\n        if (this.parent) {\r\n            localPos = this.parent.inverse.multiply(v);\r\n        }\r\n        if (!localPos.equals(this._pos)) {\r\n            this._pos = localPos;\r\n            this.flagDirty();\r\n        }\r\n    }\r\n    get globalPos() {\r\n        return new VectorView({\r\n            getX: () => this.matrix.data[4],\r\n            getY: () => this.matrix.data[5],\r\n            setX: (x) => {\r\n                if (this.parent) {\r\n                    const { x: newX } = this.parent.inverse.multiply(vec(x, this.pos.y));\r\n                    this.pos.x = newX;\r\n                }\r\n                else {\r\n                    this.pos.x = x;\r\n                }\r\n                if (x !== this.matrix.data[4]) {\r\n                    this.flagDirty();\r\n                }\r\n            },\r\n            setY: (y) => {\r\n                if (this.parent) {\r\n                    const { y: newY } = this.parent.inverse.multiply(vec(this.pos.x, y));\r\n                    this.pos.y = newY;\r\n                }\r\n                else {\r\n                    this.pos.y = y;\r\n                }\r\n                if (y !== this.matrix.data[5]) {\r\n                    this.flagDirty();\r\n                }\r\n            }\r\n        });\r\n    }\r\n    set rotation(rotation) {\r\n        const canonRotation = canonicalizeAngle(rotation);\r\n        if (canonRotation !== this._rotation) {\r\n            this.flagDirty();\r\n        }\r\n        this._rotation = canonRotation;\r\n    }\r\n    get rotation() {\r\n        return this._rotation;\r\n    }\r\n    set globalRotation(rotation) {\r\n        let inverseRotation = 0;\r\n        if (this.parent) {\r\n            inverseRotation = this.parent.globalRotation;\r\n        }\r\n        const canonRotation = canonicalizeAngle(rotation + inverseRotation);\r\n        if (canonRotation !== this._rotation) {\r\n            this.flagDirty();\r\n        }\r\n        this._rotation = canonRotation;\r\n    }\r\n    get globalRotation() {\r\n        if (this.parent) {\r\n            return this.matrix.getRotation();\r\n        }\r\n        return this.rotation;\r\n    }\r\n    set scale(v) {\r\n        if (!v.equals(this._scale)) {\r\n            this._scale.x = v.x;\r\n            this._scale.y = v.y;\r\n            this.flagDirty();\r\n        }\r\n    }\r\n    get scale() {\r\n        return new WatchVector(this._scale, (x, y) => {\r\n            if (x !== this._scale.x || y !== this._scale.y) {\r\n                this.flagDirty();\r\n            }\r\n        });\r\n    }\r\n    set globalScale(v) {\r\n        let inverseScale = vec(1, 1);\r\n        if (this.parent) {\r\n            inverseScale = this.parent.globalScale;\r\n        }\r\n        this.scale = v.scale(vec(1 / inverseScale.x, 1 / inverseScale.y));\r\n    }\r\n    get globalScale() {\r\n        return new VectorView({\r\n            getX: () => this.parent ? this.matrix.getScaleX() : this.scale.x,\r\n            getY: () => this.parent ? this.matrix.getScaleY() : this.scale.y,\r\n            setX: (x) => {\r\n                if (this.parent) {\r\n                    const globalScaleX = this.parent.globalScale.x;\r\n                    this.scale.x = x / globalScaleX;\r\n                }\r\n                else {\r\n                    this.scale.x = x;\r\n                }\r\n            },\r\n            setY: (y) => {\r\n                if (this.parent) {\r\n                    const globalScaleY = this.parent.globalScale.y;\r\n                    this.scale.y = y / globalScaleY;\r\n                }\r\n                else {\r\n                    this.scale.y = y;\r\n                }\r\n            }\r\n        });\r\n    }\r\n    get matrix() {\r\n        if (this._isDirty) {\r\n            if (this.parent === null) {\r\n                this._matrix = this._calculateMatrix();\r\n            }\r\n            else {\r\n                this._matrix = this.parent.matrix.multiply(this._calculateMatrix());\r\n            }\r\n            this._isDirty = false;\r\n        }\r\n        return this._matrix;\r\n    }\r\n    get inverse() {\r\n        if (this._isInverseDirty) {\r\n            this._inverse = this.matrix.inverse();\r\n            this._isInverseDirty = false;\r\n        }\r\n        return this._inverse;\r\n    }\r\n    _calculateMatrix() {\r\n        const matrix = AffineMatrix.identity()\r\n            .translate(this.pos.x, this.pos.y)\r\n            .rotate(this.rotation)\r\n            .scale(this.scale.x, this.scale.y);\r\n        return matrix;\r\n    }\r\n    flagDirty() {\r\n        this._isDirty = true;\r\n        this._isInverseDirty = true;\r\n        for (let i = 0; i < this._children.length; i++) {\r\n            this._children[i].flagDirty();\r\n        }\r\n    }\r\n    apply(point) {\r\n        return this.matrix.multiply(point);\r\n    }\r\n    applyInverse(point) {\r\n        return this.inverse.multiply(point);\r\n    }\r\n    setTransform(pos, rotation, scale) {\r\n        this._pos.x = pos.x;\r\n        this._pos.y = pos.y;\r\n        this._rotation = canonicalizeAngle(rotation);\r\n        this._scale.x = scale.x;\r\n        this._scale.y = scale.y;\r\n        this.flagDirty();\r\n    }\r\n    clone(dest) {\r\n        const target = dest !== null && dest !== void 0 ? dest : new Transform();\r\n        this._pos.clone(target._pos);\r\n        target._rotation = this._rotation;\r\n        this._scale.clone(target._scale);\r\n        target.flagDirty();\r\n        return target;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/Component.ts\n/**\r\n * Type guard to check if a component implements clone\r\n * @param x\r\n */\r\nfunction hasClone(x) {\r\n    return !!(x === null || x === void 0 ? void 0 : x.clone);\r\n}\r\n/**\r\n * Components are containers for state in Excalibur, the are meant to convey capabilities that an Entity possesses\r\n *\r\n * Implementations of Component must have a zero-arg constructor to support dependencies\r\n *\r\n * ```typescript\r\n * class MyComponent extends ex.Component<'my'> {\r\n *   public readonly type = 'my';\r\n *   // zero arg support required if you want to use component dependencies\r\n *   constructor(public optionalPos?: ex.Vector) {}\r\n * }\r\n * ```\r\n */\r\nclass Component {\r\n    constructor() {\r\n        /**\r\n         * Current owning [[Entity]], if any, of this component. Null if not added to any [[Entity]]\r\n         */\r\n        this.owner = null;\r\n    }\r\n    /**\r\n     * Clones any properties on this component, if that property value has a `clone()` method it will be called\r\n     */\r\n    clone() {\r\n        const newComponent = new this.constructor();\r\n        for (const prop in this) {\r\n            if (this.hasOwnProperty(prop)) {\r\n                const val = this[prop];\r\n                if (hasClone(val) && prop !== 'owner' && prop !== 'clone') {\r\n                    newComponent[prop] = val.clone();\r\n                }\r\n                else {\r\n                    newComponent[prop] = val;\r\n                }\r\n            }\r\n        }\r\n        return newComponent;\r\n    }\r\n}\r\n/**\r\n * Tag components are a way of tagging a component with label and a simple value\r\n *\r\n * For example:\r\n *\r\n * ```typescript\r\n * const isOffscreen = new TagComponent('offscreen');\r\n * entity.addComponent(isOffscreen);\r\n * entity.tags.includes\r\n * ```\r\n */\r\nclass TagComponent extends Component {\r\n    constructor(type, value) {\r\n        super();\r\n        this.type = type;\r\n        this.value = value;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Observable.ts\n/**\r\n * Simple Observable implementation\r\n * @template T is the typescript Type that defines the data being observed\r\n */\r\nclass Observable {\r\n    constructor() {\r\n        this.observers = [];\r\n        this.subscriptions = [];\r\n    }\r\n    /**\r\n     * Register an observer to listen to this observable\r\n     * @param observer\r\n     */\r\n    register(observer) {\r\n        this.observers.push(observer);\r\n    }\r\n    /**\r\n     * Register a callback to listen to this observable\r\n     * @param func\r\n     */\r\n    subscribe(func) {\r\n        this.subscriptions.push(func);\r\n    }\r\n    /**\r\n     * Remove an observer from the observable\r\n     * @param observer\r\n     */\r\n    unregister(observer) {\r\n        const i = this.observers.indexOf(observer);\r\n        if (i !== -1) {\r\n            this.observers.splice(i, 1);\r\n        }\r\n    }\r\n    /**\r\n     * Remove a callback that is listening to this observable\r\n     * @param func\r\n     */\r\n    unsubscribe(func) {\r\n        const i = this.subscriptions.indexOf(func);\r\n        if (i !== -1) {\r\n            this.subscriptions.splice(i, 1);\r\n        }\r\n    }\r\n    /**\r\n     * Broadcasts a message to all observers and callbacks\r\n     * @param message\r\n     */\r\n    notifyAll(message) {\r\n        const observersLength = this.observers.length;\r\n        for (let i = 0; i < observersLength; i++) {\r\n            this.observers[i].notify(message);\r\n        }\r\n        const subscriptionsLength = this.subscriptions.length;\r\n        for (let i = 0; i < subscriptionsLength; i++) {\r\n            this.subscriptions[i](message);\r\n        }\r\n    }\r\n    /**\r\n     * Removes all observers and callbacks\r\n     */\r\n    clear() {\r\n        this.observers.length = 0;\r\n        this.subscriptions.length = 0;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/Components/TransformComponent.ts\n\r\n\r\n\r\n\r\nclass TransformComponent extends Component {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.type = 'ex.transform';\r\n        this._transform = new Transform();\r\n        this._addChildTransform = (child) => {\r\n            const childTxComponent = child.get(TransformComponent);\r\n            if (childTxComponent) {\r\n                childTxComponent._transform.parent = this._transform;\r\n            }\r\n        };\r\n        /**\r\n         * Observable that emits when the z index changes on this component\r\n         */\r\n        this.zIndexChanged$ = new Observable();\r\n        this._z = 0;\r\n        /**\r\n         * The [[CoordPlane|coordinate plane|]] for this transform for the entity.\r\n         */\r\n        this.coordPlane = CoordPlane.World;\r\n    }\r\n    get() {\r\n        return this._transform;\r\n    }\r\n    onAdd(owner) {\r\n        for (const child of owner.children) {\r\n            this._addChildTransform(child);\r\n        }\r\n        owner.childrenAdded$.subscribe(child => this._addChildTransform(child));\r\n        owner.childrenRemoved$.subscribe(child => {\r\n            const childTxComponent = child.get(TransformComponent);\r\n            if (childTxComponent) {\r\n                childTxComponent._transform.parent = null;\r\n            }\r\n        });\r\n    }\r\n    onRemove(_previousOwner) {\r\n        this._transform.parent = null;\r\n    }\r\n    /**\r\n     * The z-index ordering of the entity, a higher values are drawn on top of lower values.\r\n     * For example z=99 would be drawn on top of z=0.\r\n     */\r\n    get z() {\r\n        return this._z;\r\n    }\r\n    set z(val) {\r\n        const oldz = this._z;\r\n        this._z = val;\r\n        if (oldz !== val) {\r\n            this.zIndexChanged$.notifyAll(val);\r\n        }\r\n    }\r\n    get pos() {\r\n        return this._transform.pos;\r\n    }\r\n    set pos(v) {\r\n        this._transform.pos = v;\r\n    }\r\n    get globalPos() {\r\n        return this._transform.globalPos;\r\n    }\r\n    set globalPos(v) {\r\n        this._transform.globalPos = v;\r\n    }\r\n    get rotation() {\r\n        return this._transform.rotation;\r\n    }\r\n    set rotation(rotation) {\r\n        this._transform.rotation = rotation;\r\n    }\r\n    get globalRotation() {\r\n        return this._transform.globalRotation;\r\n    }\r\n    set globalRotation(rotation) {\r\n        this._transform.globalRotation = rotation;\r\n    }\r\n    get scale() {\r\n        return this._transform.scale;\r\n    }\r\n    set scale(v) {\r\n        this._transform.scale = v;\r\n    }\r\n    get globalScale() {\r\n        return this._transform.globalScale;\r\n    }\r\n    set globalScale(v) {\r\n        this._transform.globalScale = v;\r\n    }\r\n    applyInverse(v) {\r\n        return this._transform.applyInverse(v);\r\n    }\r\n    apply(v) {\r\n        return this._transform.apply(v);\r\n    }\r\n    clone() {\r\n        const component = new TransformComponent();\r\n        component._transform = this._transform.clone();\r\n        component._z = this._z;\r\n        return component;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/Components/MotionComponent.ts\n\r\n\r\nclass MotionComponent extends Component {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.type = 'ex.motion';\r\n        /**\r\n         * The velocity of an entity in pixels per second\r\n         */\r\n        this.vel = Vector.Zero;\r\n        /**\r\n         * The acceleration of entity in pixels per second^2\r\n         */\r\n        this.acc = Vector.Zero;\r\n        /**\r\n         * The scale rate of change in scale units per second\r\n         */\r\n        this.scaleFactor = Vector.Zero;\r\n        /**\r\n         * The angular velocity which is how quickly the entity is rotating in radians per second\r\n         */\r\n        this.angularVelocity = 0;\r\n        /**\r\n         * The amount of torque applied to the entity, angular acceleration is torque * inertia\r\n         */\r\n        this.torque = 0;\r\n        /**\r\n         * Inertia can be thought of as the resistance to motion\r\n         */\r\n        this.inertia = 1;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Group/CollisionGroup.ts\n/**\r\n * CollisionGroups indicate like members that do not collide with each other. Use [[CollisionGroupManager]] to create [[CollisionGroup]]s\r\n *\r\n * For example:\r\n *\r\n * Players have collision group \"player\"\r\n *\r\n * ![Player Collision Group](/assets/images/docs/CollisionGroupsPlayer.png)\r\n *\r\n * Enemies have collision group \"enemy\"\r\n *\r\n * ![Enemy Collision Group](/assets/images/docs/CollisionGroupsEnemy.png)\r\n *\r\n * Blocks have collision group \"ground\"\r\n *\r\n * ![Ground collision group](/assets/images/docs/CollisionGroupsGround.png)\r\n *\r\n * Players don't collide with each other, but enemies and blocks. Likewise, enemies don't collide with each other but collide\r\n * with players and blocks.\r\n *\r\n * This is done with bitmasking, see the following pseudo-code\r\n *\r\n * PlayerGroup = `0b001`\r\n * PlayerGroupMask = `0b110`\r\n *\r\n * EnemyGroup = `0b010`\r\n * EnemyGroupMask = `0b101`\r\n *\r\n * BlockGroup = `0b100`\r\n * BlockGroupMask = `0b011`\r\n *\r\n * Should Players collide? No because the bitwise mask evaluates to 0\r\n * `(player1.group & player2.mask) === 0`\r\n * `(0b001 & 0b110) === 0`\r\n *\r\n * Should Players and Enemies collide? Yes because the bitwise mask is non-zero\r\n * `(player1.group & enemy1.mask) === 1`\r\n * `(0b001 & 0b101) === 1`\r\n *\r\n * Should Players and Blocks collide? Yes because the bitwise mask is non-zero\r\n * `(player1.group & blocks1.mask) === 1`\r\n * `(0b001 & 0b011) === 1`\r\n */\r\nclass CollisionGroup {\r\n    /**\r\n     * STOP!!** It is preferred that [[CollisionGroupManager.create]] is used to create collision groups\r\n     *  unless you know how to construct the proper bitmasks. See https://github.com/excaliburjs/Excalibur/issues/1091 for more info.\r\n     * @param name Name of the collision group\r\n     * @param category 32 bit category for the group, should be a unique power of 2. For example `0b001` or `0b010`\r\n     * @param mask 32 bit mask of category, or `~category` generally. For a category of `0b001`, the mask would be `0b110`\r\n     */\r\n    constructor(name, category, mask) {\r\n        this._name = name;\r\n        this._category = category;\r\n        this._mask = mask;\r\n    }\r\n    /**\r\n     * Get the name of the collision group\r\n     */\r\n    get name() {\r\n        return this._name;\r\n    }\r\n    /**\r\n     * Get the category of the collision group, a 32 bit number which should be a unique power of 2\r\n     */\r\n    get category() {\r\n        return this._category;\r\n    }\r\n    /**\r\n     * Get the mask for this collision group\r\n     */\r\n    get mask() {\r\n        return this._mask;\r\n    }\r\n    /**\r\n     * Evaluates whether 2 collision groups can collide\r\n     * @param other  CollisionGroup\r\n     */\r\n    canCollide(other) {\r\n        return (this.category & other.mask) !== 0 && (other.category & this.mask) !== 0;\r\n    }\r\n    /**\r\n     * Inverts the collision group. For example, if before the group specified \"players\",\r\n     * inverting would specify all groups except players\r\n     * @returns CollisionGroup\r\n     */\r\n    invert() {\r\n        return new CollisionGroup('~(' + this.name + ')', ~this.category, ~this.mask);\r\n    }\r\n    /**\r\n     * Combine collision groups with each other. The new group includes all of the previous groups.\r\n     *\r\n     * @param collisionGroups\r\n     */\r\n    static combine(collisionGroups) {\r\n        const combinedName = collisionGroups.map((c) => c.name).join('+');\r\n        const combinedCategory = collisionGroups.reduce((current, g) => g.category | current, 0b0);\r\n        const combinedMask = ~combinedCategory;\r\n        return new CollisionGroup(combinedName, combinedCategory, combinedMask);\r\n    }\r\n    /**\r\n     * Creates a collision group that collides with the listed groups\r\n     * @param collisionGroups\r\n     */\r\n    static collidesWith(collisionGroups) {\r\n        return CollisionGroup.combine(collisionGroups).invert();\r\n    }\r\n}\r\n/**\r\n * The `All` [[CollisionGroup]] is a special group that collides with all other groups including itself,\r\n * it is the default collision group on colliders.\r\n */\r\nCollisionGroup.All = new CollisionGroup('Collide with all groups', -1, -1);\r\n\n;// CONCATENATED MODULE: ./Collision/Detection/Pair.ts\n\r\n\r\n/**\r\n * Models a potential collision between 2 colliders\r\n */\r\nclass Pair {\r\n    constructor(colliderA, colliderB) {\r\n        this.colliderA = colliderA;\r\n        this.colliderB = colliderB;\r\n        this.id = null;\r\n        this.id = Pair.calculatePairHash(colliderA.id, colliderB.id);\r\n    }\r\n    /**\r\n     * Returns whether a it is allowed for 2 colliders in a Pair to collide\r\n     * @param colliderA\r\n     * @param colliderB\r\n     */\r\n    static canCollide(colliderA, colliderB) {\r\n        var _a, _b;\r\n        const bodyA = (_a = colliderA === null || colliderA === void 0 ? void 0 : colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n        const bodyB = (_b = colliderB === null || colliderB === void 0 ? void 0 : colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n        // Prevent self collision\r\n        if (colliderA.id === colliderB.id) {\r\n            return false;\r\n        }\r\n        // Colliders with the same owner do not collide (composite colliders)\r\n        if (colliderA.owner &&\r\n            colliderB.owner &&\r\n            colliderA.owner.id === colliderB.owner.id) {\r\n            return false;\r\n        }\r\n        // if the pair has a member with zero dimension don't collide\r\n        if (colliderA.localBounds.hasZeroDimensions() || colliderB.localBounds.hasZeroDimensions()) {\r\n            return false;\r\n        }\r\n        // Body's needed for collision in the current state\r\n        // TODO can we collide without a body?\r\n        if (!bodyA || !bodyB) {\r\n            return false;\r\n        }\r\n        // If both are in the same collision group short circuit\r\n        if (!bodyA.group.canCollide(bodyB.group)) {\r\n            return false;\r\n        }\r\n        // if both are fixed short circuit\r\n        if (bodyA.collisionType === CollisionType.Fixed && bodyB.collisionType === CollisionType.Fixed) {\r\n            return false;\r\n        }\r\n        // if the either is prevent collision short circuit\r\n        if (bodyB.collisionType === CollisionType.PreventCollision || bodyA.collisionType === CollisionType.PreventCollision) {\r\n            return false;\r\n        }\r\n        // if either is dead short circuit\r\n        if (!bodyA.active || !bodyB.active) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    /**\r\n     * Returns whether or not it is possible for the pairs to collide\r\n     */\r\n    get canCollide() {\r\n        const colliderA = this.colliderA;\r\n        const colliderB = this.colliderB;\r\n        return Pair.canCollide(colliderA, colliderB);\r\n    }\r\n    /**\r\n     * Runs the collision intersection logic on the members of this pair\r\n     */\r\n    collide() {\r\n        return this.colliderA.collide(this.colliderB);\r\n    }\r\n    /**\r\n     * Check if the collider is part of the pair\r\n     * @param collider\r\n     */\r\n    hasCollider(collider) {\r\n        return collider === this.colliderA || collider === this.colliderB;\r\n    }\r\n    /**\r\n     * Calculates the unique pair hash id for this collision pair (owning id)\r\n     */\r\n    static calculatePairHash(idA, idB) {\r\n        if (idA.value < idB.value) {\r\n            return `#${idA.value}+${idB.value}`;\r\n        }\r\n        else {\r\n            return `#${idB.value}+${idA.value}`;\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/projection.ts\n/**\r\n * A 1 dimensional projection on an axis, used to test overlaps\r\n */\r\nclass Projection {\r\n    constructor(min, max) {\r\n        this.min = min;\r\n        this.max = max;\r\n    }\r\n    overlaps(projection) {\r\n        return this.max > projection.min && projection.max > this.min;\r\n    }\r\n    getOverlap(projection) {\r\n        if (this.overlaps(projection)) {\r\n            if (this.max > projection.max) {\r\n                return projection.max - this.min;\r\n            }\r\n            else {\r\n                return this.max - projection.min;\r\n            }\r\n        }\r\n        return 0;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Detection/DynamicTree.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Dynamic Tree Node used for tracking bounds within the tree\r\n */\r\nclass TreeNode {\r\n    constructor(parent) {\r\n        this.parent = parent;\r\n        this.parent = parent || null;\r\n        this.data = null;\r\n        this.bounds = new BoundingBox();\r\n        this.left = null;\r\n        this.right = null;\r\n        this.height = 0;\r\n    }\r\n    isLeaf() {\r\n        return !this.left && !this.right;\r\n    }\r\n}\r\n/**\r\n * The DynamicTrees provides a spatial partitioning data structure for quickly querying for overlapping bounding boxes for\r\n * all tracked bodies. The worst case performance of this is O(n*log(n)) where n is the number of bodies in the tree.\r\n *\r\n * Internally the bounding boxes are organized as a balanced binary tree of bounding boxes, where the leaf nodes are tracked bodies.\r\n * Every non-leaf node is a bounding box that contains child bounding boxes.\r\n */\r\nclass DynamicTree {\r\n    constructor(worldBounds = new BoundingBox(-Number.MAX_VALUE, -Number.MAX_VALUE, Number.MAX_VALUE, Number.MAX_VALUE)) {\r\n        this.worldBounds = worldBounds;\r\n        this.root = null;\r\n        this.nodes = {};\r\n    }\r\n    /**\r\n     * Inserts a node into the dynamic tree\r\n     */\r\n    _insert(leaf) {\r\n        // If there are no nodes in the tree, make this the root leaf\r\n        if (this.root === null) {\r\n            this.root = leaf;\r\n            this.root.parent = null;\r\n            return;\r\n        }\r\n        // Search the tree for a node that is not a leaf and find the best place to insert\r\n        const leafAABB = leaf.bounds;\r\n        let currentRoot = this.root;\r\n        while (!currentRoot.isLeaf()) {\r\n            const left = currentRoot.left;\r\n            const right = currentRoot.right;\r\n            const area = currentRoot.bounds.getPerimeter();\r\n            const combinedAABB = currentRoot.bounds.combine(leafAABB);\r\n            const combinedArea = combinedAABB.getPerimeter();\r\n            // Calculate cost heuristic for creating a new parent and leaf\r\n            const cost = 2 * combinedArea;\r\n            // Minimum cost of pushing the leaf down the tree\r\n            const inheritanceCost = 2 * (combinedArea - area);\r\n            // Cost of descending\r\n            let leftCost = 0;\r\n            const leftCombined = leafAABB.combine(left.bounds);\r\n            let newArea;\r\n            let oldArea;\r\n            if (left.isLeaf()) {\r\n                leftCost = leftCombined.getPerimeter() + inheritanceCost;\r\n            }\r\n            else {\r\n                oldArea = left.bounds.getPerimeter();\r\n                newArea = leftCombined.getPerimeter();\r\n                leftCost = newArea - oldArea + inheritanceCost;\r\n            }\r\n            let rightCost = 0;\r\n            const rightCombined = leafAABB.combine(right.bounds);\r\n            if (right.isLeaf()) {\r\n                rightCost = rightCombined.getPerimeter() + inheritanceCost;\r\n            }\r\n            else {\r\n                oldArea = right.bounds.getPerimeter();\r\n                newArea = rightCombined.getPerimeter();\r\n                rightCost = newArea - oldArea + inheritanceCost;\r\n            }\r\n            // cost is acceptable\r\n            if (cost < leftCost && cost < rightCost) {\r\n                break;\r\n            }\r\n            // Descend to the depths\r\n            if (leftCost < rightCost) {\r\n                currentRoot = left;\r\n            }\r\n            else {\r\n                currentRoot = right;\r\n            }\r\n        }\r\n        // Create the new parent node and insert into the tree\r\n        const oldParent = currentRoot.parent;\r\n        const newParent = new TreeNode(oldParent);\r\n        newParent.bounds = leafAABB.combine(currentRoot.bounds);\r\n        newParent.height = currentRoot.height + 1;\r\n        if (oldParent !== null) {\r\n            // The sibling node was not the root\r\n            if (oldParent.left === currentRoot) {\r\n                oldParent.left = newParent;\r\n            }\r\n            else {\r\n                oldParent.right = newParent;\r\n            }\r\n            newParent.left = currentRoot;\r\n            newParent.right = leaf;\r\n            currentRoot.parent = newParent;\r\n            leaf.parent = newParent;\r\n        }\r\n        else {\r\n            // The sibling node was the root\r\n            newParent.left = currentRoot;\r\n            newParent.right = leaf;\r\n            currentRoot.parent = newParent;\r\n            leaf.parent = newParent;\r\n            this.root = newParent;\r\n        }\r\n        // Walk up the tree fixing heights and AABBs\r\n        let currentNode = leaf.parent;\r\n        while (currentNode) {\r\n            currentNode = this._balance(currentNode);\r\n            if (!currentNode.left) {\r\n                throw new Error('Parent of current leaf cannot have a null left child' + currentNode);\r\n            }\r\n            if (!currentNode.right) {\r\n                throw new Error('Parent of current leaf cannot have a null right child' + currentNode);\r\n            }\r\n            currentNode.height = 1 + Math.max(currentNode.left.height, currentNode.right.height);\r\n            currentNode.bounds = currentNode.left.bounds.combine(currentNode.right.bounds);\r\n            currentNode = currentNode.parent;\r\n        }\r\n    }\r\n    /**\r\n     * Removes a node from the dynamic tree\r\n     */\r\n    _remove(leaf) {\r\n        if (leaf === this.root) {\r\n            this.root = null;\r\n            return;\r\n        }\r\n        const parent = leaf.parent;\r\n        const grandParent = parent.parent;\r\n        let sibling;\r\n        if (parent.left === leaf) {\r\n            sibling = parent.right;\r\n        }\r\n        else {\r\n            sibling = parent.left;\r\n        }\r\n        if (grandParent) {\r\n            if (grandParent.left === parent) {\r\n                grandParent.left = sibling;\r\n            }\r\n            else {\r\n                grandParent.right = sibling;\r\n            }\r\n            sibling.parent = grandParent;\r\n            let currentNode = grandParent;\r\n            while (currentNode) {\r\n                currentNode = this._balance(currentNode);\r\n                currentNode.bounds = currentNode.left.bounds.combine(currentNode.right.bounds);\r\n                currentNode.height = 1 + Math.max(currentNode.left.height, currentNode.right.height);\r\n                currentNode = currentNode.parent;\r\n            }\r\n        }\r\n        else {\r\n            this.root = sibling;\r\n            sibling.parent = null;\r\n        }\r\n    }\r\n    /**\r\n     * Tracks a body in the dynamic tree\r\n     */\r\n    trackCollider(collider) {\r\n        const node = new TreeNode();\r\n        node.data = collider;\r\n        node.bounds = collider.bounds;\r\n        node.bounds.left -= 2;\r\n        node.bounds.top -= 2;\r\n        node.bounds.right += 2;\r\n        node.bounds.bottom += 2;\r\n        this.nodes[collider.id.value] = node;\r\n        this._insert(node);\r\n    }\r\n    /**\r\n     * Updates the dynamic tree given the current bounds of each body being tracked\r\n     */\r\n    updateCollider(collider) {\r\n        var _a;\r\n        const node = this.nodes[collider.id.value];\r\n        if (!node) {\r\n            return false;\r\n        }\r\n        const b = collider.bounds;\r\n        // if the body is outside the world no longer update it\r\n        if (!this.worldBounds.contains(b)) {\r\n            Logger.getInstance().warn('Collider with id ' + collider.id.value + ' is outside the world bounds and will no longer be tracked for physics');\r\n            this.untrackCollider(collider);\r\n            return false;\r\n        }\r\n        if (node.bounds.contains(b)) {\r\n            return false;\r\n        }\r\n        this._remove(node);\r\n        b.left -= Physics.boundsPadding;\r\n        b.top -= Physics.boundsPadding;\r\n        b.right += Physics.boundsPadding;\r\n        b.bottom += Physics.boundsPadding;\r\n        // THIS IS CAUSING UNECESSARY CHECKS\r\n        if (collider.owner) {\r\n            const body = (_a = collider.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n            if (body) {\r\n                const multdx = ((body.vel.x * 32) / 1000) * Physics.dynamicTreeVelocityMultiplier;\r\n                const multdy = ((body.vel.y * 32) / 1000) * Physics.dynamicTreeVelocityMultiplier;\r\n                if (multdx < 0) {\r\n                    b.left += multdx;\r\n                }\r\n                else {\r\n                    b.right += multdx;\r\n                }\r\n                if (multdy < 0) {\r\n                    b.top += multdy;\r\n                }\r\n                else {\r\n                    b.bottom += multdy;\r\n                }\r\n            }\r\n        }\r\n        node.bounds = b;\r\n        this._insert(node);\r\n        return true;\r\n    }\r\n    /**\r\n     * Untracks a body from the dynamic tree\r\n     */\r\n    untrackCollider(collider) {\r\n        const node = this.nodes[collider.id.value];\r\n        if (!node) {\r\n            return;\r\n        }\r\n        this._remove(node);\r\n        this.nodes[collider.id.value] = null;\r\n        delete this.nodes[collider.id.value];\r\n    }\r\n    /**\r\n     * Balances the tree about a node\r\n     */\r\n    _balance(node) {\r\n        if (node === null) {\r\n            throw new Error('Cannot balance at null node');\r\n        }\r\n        if (node.isLeaf() || node.height < 2) {\r\n            return node;\r\n        }\r\n        const left = node.left;\r\n        const right = node.right;\r\n        const a = node;\r\n        const b = left;\r\n        const c = right;\r\n        const d = left.left;\r\n        const e = left.right;\r\n        const f = right.left;\r\n        const g = right.right;\r\n        const balance = c.height - b.height;\r\n        // Rotate c node up\r\n        if (balance > 1) {\r\n            // Swap the right node with it's parent\r\n            c.left = a;\r\n            c.parent = a.parent;\r\n            a.parent = c;\r\n            // The original node's old parent should point to the right node\r\n            // this is mega confusing\r\n            if (c.parent) {\r\n                if (c.parent.left === a) {\r\n                    c.parent.left = c;\r\n                }\r\n                else {\r\n                    c.parent.right = c;\r\n                }\r\n            }\r\n            else {\r\n                this.root = c;\r\n            }\r\n            // Rotate\r\n            if (f.height > g.height) {\r\n                c.right = f;\r\n                a.right = g;\r\n                g.parent = a;\r\n                a.bounds = b.bounds.combine(g.bounds);\r\n                c.bounds = a.bounds.combine(f.bounds);\r\n                a.height = 1 + Math.max(b.height, g.height);\r\n                c.height = 1 + Math.max(a.height, f.height);\r\n            }\r\n            else {\r\n                c.right = g;\r\n                a.right = f;\r\n                f.parent = a;\r\n                a.bounds = b.bounds.combine(f.bounds);\r\n                c.bounds = a.bounds.combine(g.bounds);\r\n                a.height = 1 + Math.max(b.height, f.height);\r\n                c.height = 1 + Math.max(a.height, g.height);\r\n            }\r\n            return c;\r\n        }\r\n        // Rotate left node up\r\n        if (balance < -1) {\r\n            // swap\r\n            b.left = a;\r\n            b.parent = a.parent;\r\n            a.parent = b;\r\n            // node's old parent should point to b\r\n            if (b.parent) {\r\n                if (b.parent.left === a) {\r\n                    b.parent.left = b;\r\n                }\r\n                else {\r\n                    if (b.parent.right !== a) {\r\n                        throw 'Error rotating Dynamic Tree';\r\n                    }\r\n                    b.parent.right = b;\r\n                }\r\n            }\r\n            else {\r\n                this.root = b;\r\n            }\r\n            // rotate\r\n            if (d.height > e.height) {\r\n                b.right = d;\r\n                a.left = e;\r\n                e.parent = a;\r\n                a.bounds = c.bounds.combine(e.bounds);\r\n                b.bounds = a.bounds.combine(d.bounds);\r\n                a.height = 1 + Math.max(c.height, e.height);\r\n                b.height = 1 + Math.max(a.height, d.height);\r\n            }\r\n            else {\r\n                b.right = e;\r\n                a.left = d;\r\n                d.parent = a;\r\n                a.bounds = c.bounds.combine(d.bounds);\r\n                b.bounds = a.bounds.combine(e.bounds);\r\n                a.height = 1 + Math.max(c.height, d.height);\r\n                b.height = 1 + Math.max(a.height, e.height);\r\n            }\r\n            return b;\r\n        }\r\n        return node;\r\n    }\r\n    /**\r\n     * Returns the internal height of the tree, shorter trees are better. Performance drops as the tree grows\r\n     */\r\n    getHeight() {\r\n        if (this.root === null) {\r\n            return 0;\r\n        }\r\n        return this.root.height;\r\n    }\r\n    /**\r\n     * Queries the Dynamic Axis Aligned Tree for bodies that could be colliding with the provided body.\r\n     *\r\n     * In the query callback, it will be passed a potential collider. Returning true from this callback indicates\r\n     * that you are complete with your query and you do not want to continue. Returning false will continue searching\r\n     * the tree until all possible colliders have been returned.\r\n     */\r\n    query(collider, callback) {\r\n        const bounds = collider.bounds;\r\n        const helper = (currentNode) => {\r\n            if (currentNode && currentNode.bounds.overlaps(bounds)) {\r\n                if (currentNode.isLeaf() && currentNode.data !== collider) {\r\n                    if (callback.call(collider, currentNode.data)) {\r\n                        return true;\r\n                    }\r\n                }\r\n                else {\r\n                    return helper(currentNode.left) || helper(currentNode.right);\r\n                }\r\n            }\r\n            return false;\r\n        };\r\n        helper(this.root);\r\n    }\r\n    /**\r\n     * Queries the Dynamic Axis Aligned Tree for bodies that could be intersecting. By default the raycast query uses an infinitely\r\n     * long ray to test the tree specified by `max`.\r\n     *\r\n     * In the query callback, it will be passed a potential body that intersects with the raycast. Returning true from this\r\n     * callback indicates that your are complete with your query and do not want to continue. Return false will continue searching\r\n     * the tree until all possible bodies that would intersect with the ray have been returned.\r\n     */\r\n    rayCastQuery(ray, max = Infinity, callback) {\r\n        const helper = (currentNode) => {\r\n            if (currentNode && currentNode.bounds.rayCast(ray, max)) {\r\n                if (currentNode.isLeaf()) {\r\n                    if (callback.call(ray, currentNode.data)) {\r\n                        // ray hit a leaf! return the body\r\n                        return true;\r\n                    }\r\n                }\r\n                else {\r\n                    // ray hit but not at a leaf, recurse deeper\r\n                    return helper(currentNode.left) || helper(currentNode.right);\r\n                }\r\n            }\r\n            return false; // ray missed\r\n        };\r\n        helper(this.root);\r\n    }\r\n    getNodes() {\r\n        const helper = (currentNode) => {\r\n            if (currentNode) {\r\n                return [currentNode].concat(helper(currentNode.left), helper(currentNode.right));\r\n            }\r\n            else {\r\n                return [];\r\n            }\r\n        };\r\n        return helper(this.root);\r\n    }\r\n    debug(ex) {\r\n        // draw all the nodes in the Dynamic Tree\r\n        const helper = (currentNode) => {\r\n            if (currentNode) {\r\n                if (currentNode.isLeaf()) {\r\n                    currentNode.bounds.draw(ex, Color.Green);\r\n                }\r\n                else {\r\n                    currentNode.bounds.draw(ex, Color.White);\r\n                }\r\n                if (currentNode.left) {\r\n                    helper(currentNode.left);\r\n                }\r\n                if (currentNode.right) {\r\n                    helper(currentNode.right);\r\n                }\r\n            }\r\n        };\r\n        helper(this.root);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/ray.ts\n/**\r\n * A 2D ray that can be cast into the scene to do collision detection\r\n */\r\nclass Ray {\r\n    /**\r\n     * @param pos The starting position for the ray\r\n     * @param dir The vector indicating the direction of the ray\r\n     */\r\n    constructor(pos, dir) {\r\n        this.pos = pos;\r\n        this.dir = dir.normalize();\r\n    }\r\n    /**\r\n     * Tests a whether this ray intersects with a line segment. Returns a number greater than or equal to 0 on success.\r\n     * This number indicates the mathematical intersection time.\r\n     * @param line  The line to test\r\n     */\r\n    intersect(line) {\r\n        const numerator = line.begin.sub(this.pos);\r\n        // Test is line and ray are parallel and non intersecting\r\n        if (this.dir.cross(line.getSlope()) === 0 && numerator.cross(this.dir) !== 0) {\r\n            return -1;\r\n        }\r\n        // Lines are parallel\r\n        const divisor = this.dir.cross(line.getSlope());\r\n        if (divisor === 0) {\r\n            return -1;\r\n        }\r\n        const t = numerator.cross(line.getSlope()) / divisor;\r\n        if (t >= 0) {\r\n            const u = numerator.cross(this.dir) / divisor / line.getLength();\r\n            if (u >= 0 && u <= 1) {\r\n                return t;\r\n            }\r\n        }\r\n        return -1;\r\n    }\r\n    intersectPoint(line) {\r\n        const time = this.intersect(line);\r\n        if (time < 0) {\r\n            return null;\r\n        }\r\n        return this.getPoint(time);\r\n    }\r\n    /**\r\n     * Returns the point of intersection given the intersection time\r\n     */\r\n    getPoint(time) {\r\n        return this.pos.add(this.dir.scale(time));\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Detection/DynamicTreeCollisionProcessor.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Responsible for performing the collision broadphase (locating potential collisions) and\r\n * the narrowphase (actual collision contacts)\r\n */\r\nclass DynamicTreeCollisionProcessor {\r\n    constructor() {\r\n        this._dynamicCollisionTree = new DynamicTree();\r\n        this._pairs = new Set();\r\n        this._collisionPairCache = [];\r\n        this._colliders = [];\r\n    }\r\n    getColliders() {\r\n        return this._colliders;\r\n    }\r\n    rayCast(ray, options) {\r\n        var _a, _b, _c;\r\n        const results = [];\r\n        const maxDistance = (_a = options === null || options === void 0 ? void 0 : options.maxDistance) !== null && _a !== void 0 ? _a : Infinity;\r\n        const collisionGroup = (_b = options === null || options === void 0 ? void 0 : options.collisionGroup) !== null && _b !== void 0 ? _b : CollisionGroup.All;\r\n        const searchAllColliders = (_c = options === null || options === void 0 ? void 0 : options.searchAllColliders) !== null && _c !== void 0 ? _c : false;\r\n        this._dynamicCollisionTree.rayCastQuery(ray, maxDistance, (collider) => {\r\n            var _a;\r\n            const owner = collider.owner;\r\n            const maybeBody = owner.get(BodyComponent);\r\n            // Early exit if not the right group\r\n            if (collisionGroup.mask !== CollisionGroup.All.mask && ((_a = maybeBody === null || maybeBody === void 0 ? void 0 : maybeBody.group) === null || _a === void 0 ? void 0 : _a.mask) !== collisionGroup.mask) {\r\n                return false;\r\n            }\r\n            const hit = collider.rayCast(ray, maxDistance);\r\n            if (hit) {\r\n                results.push({\r\n                    distance: hit.sub(ray.pos).distance(),\r\n                    point: hit,\r\n                    collider: collider,\r\n                    body: maybeBody\r\n                });\r\n                if (!searchAllColliders) {\r\n                    // returning true exits the search\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        });\r\n        return results;\r\n    }\r\n    /**\r\n     * Tracks a physics body for collisions\r\n     */\r\n    track(target) {\r\n        if (!target) {\r\n            Logger.getInstance().warn('Cannot track null collider');\r\n            return;\r\n        }\r\n        if (target instanceof CompositeCollider) {\r\n            const colliders = target.getColliders();\r\n            for (const c of colliders) {\r\n                c.owner = target.owner;\r\n                this._colliders.push(c);\r\n                this._dynamicCollisionTree.trackCollider(c);\r\n            }\r\n        }\r\n        else {\r\n            this._colliders.push(target);\r\n            this._dynamicCollisionTree.trackCollider(target);\r\n        }\r\n    }\r\n    /**\r\n     * Untracks a physics body\r\n     */\r\n    untrack(target) {\r\n        if (!target) {\r\n            Logger.getInstance().warn('Cannot untrack a null collider');\r\n            return;\r\n        }\r\n        if (target instanceof CompositeCollider) {\r\n            const colliders = target.getColliders();\r\n            for (const c of colliders) {\r\n                const index = this._colliders.indexOf(c);\r\n                if (index !== -1) {\r\n                    this._colliders.splice(index, 1);\r\n                }\r\n                this._dynamicCollisionTree.untrackCollider(c);\r\n            }\r\n        }\r\n        else {\r\n            const index = this._colliders.indexOf(target);\r\n            if (index !== -1) {\r\n                this._colliders.splice(index, 1);\r\n            }\r\n            this._dynamicCollisionTree.untrackCollider(target);\r\n        }\r\n    }\r\n    _pairExists(colliderA, colliderB) {\r\n        // if the collision pair has been calculated already short circuit\r\n        const hash = Pair.calculatePairHash(colliderA.id, colliderB.id);\r\n        return this._pairs.has(hash);\r\n    }\r\n    /**\r\n     * Detects potential collision pairs in a broadphase approach with the dynamic AABB tree strategy\r\n     */\r\n    broadphase(targets, delta, stats) {\r\n        const seconds = delta / 1000;\r\n        // Retrieve the list of potential colliders, exclude killed, prevented, and self\r\n        const potentialColliders = targets.filter((other) => {\r\n            var _a, _b;\r\n            const body = (_a = other.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n            return ((_b = other.owner) === null || _b === void 0 ? void 0 : _b.active) && body.collisionType !== CollisionType.PreventCollision;\r\n        });\r\n        // clear old list of collision pairs\r\n        this._collisionPairCache = [];\r\n        this._pairs.clear();\r\n        // check for normal collision pairs\r\n        let collider;\r\n        for (let j = 0, l = potentialColliders.length; j < l; j++) {\r\n            collider = potentialColliders[j];\r\n            // Query the collision tree for potential colliders\r\n            this._dynamicCollisionTree.query(collider, (other) => {\r\n                if (!this._pairExists(collider, other) && Pair.canCollide(collider, other)) {\r\n                    const pair = new Pair(collider, other);\r\n                    this._pairs.add(pair.id);\r\n                    this._collisionPairCache.push(pair);\r\n                }\r\n                // Always return false, to query whole tree. Returning true in the query method stops searching\r\n                return false;\r\n            });\r\n        }\r\n        if (stats) {\r\n            stats.physics.pairs = this._collisionPairCache.length;\r\n        }\r\n        // Check dynamic tree for fast moving objects\r\n        // Fast moving objects are those moving at least there smallest bound per frame\r\n        if (Physics.checkForFastBodies) {\r\n            for (const collider of potentialColliders) {\r\n                const body = collider.owner.get(BodyComponent);\r\n                // Skip non-active objects. Does not make sense on other collision types\r\n                if (body.collisionType !== CollisionType.Active) {\r\n                    continue;\r\n                }\r\n                // Maximum travel distance next frame\r\n                const updateDistance = body.vel.size * seconds + // velocity term\r\n                    body.acc.size * 0.5 * seconds * seconds; // acc term\r\n                // Find the minimum dimension\r\n                const minDimension = Math.min(collider.bounds.height, collider.bounds.width);\r\n                if (Physics.disableMinimumSpeedForFastBody || updateDistance > minDimension / 2) {\r\n                    if (stats) {\r\n                        stats.physics.fastBodies++;\r\n                    }\r\n                    // start with the oldPos because the integration for actors has already happened\r\n                    // objects resting on a surface may be slightly penetrating in the current position\r\n                    const updateVec = body.globalPos.sub(body.oldPos);\r\n                    const centerPoint = collider.center;\r\n                    const furthestPoint = collider.getFurthestPoint(body.vel);\r\n                    const origin = furthestPoint.sub(updateVec);\r\n                    const ray = new Ray(origin, body.vel);\r\n                    // back the ray up by -2x surfaceEpsilon to account for fast moving objects starting on the surface\r\n                    ray.pos = ray.pos.add(ray.dir.scale(-2 * Physics.surfaceEpsilon));\r\n                    let minCollider;\r\n                    let minTranslate = new Vector(Infinity, Infinity);\r\n                    this._dynamicCollisionTree.rayCastQuery(ray, updateDistance + Physics.surfaceEpsilon * 2, (other) => {\r\n                        if (!this._pairExists(collider, other) && Pair.canCollide(collider, other)) {\r\n                            const hitPoint = other.rayCast(ray, updateDistance + Physics.surfaceEpsilon * 10);\r\n                            if (hitPoint) {\r\n                                const translate = hitPoint.sub(origin);\r\n                                if (translate.size < minTranslate.size) {\r\n                                    minTranslate = translate;\r\n                                    minCollider = other;\r\n                                }\r\n                            }\r\n                        }\r\n                        return false;\r\n                    });\r\n                    if (minCollider && Vector.isValid(minTranslate)) {\r\n                        const pair = new Pair(collider, minCollider);\r\n                        if (!this._pairs.has(pair.id)) {\r\n                            this._pairs.add(pair.id);\r\n                            this._collisionPairCache.push(pair);\r\n                        }\r\n                        // move the fast moving object to the other body\r\n                        // need to push into the surface by ex.Physics.surfaceEpsilon\r\n                        const shift = centerPoint.sub(furthestPoint);\r\n                        body.globalPos = origin\r\n                            .add(shift)\r\n                            .add(minTranslate)\r\n                            .add(ray.dir.scale(10 * Physics.surfaceEpsilon)); // needed to push the shape slightly into contact\r\n                        collider.update(body.transform.get());\r\n                        if (stats) {\r\n                            stats.physics.fastBodyCollisions++;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        // return cache\r\n        return this._collisionPairCache;\r\n    }\r\n    /**\r\n     * Applies narrow phase on collision pairs to find actual area intersections\r\n     * Adds actual colliding pairs to stats' Frame data\r\n     */\r\n    narrowphase(pairs, stats) {\r\n        let contacts = [];\r\n        for (let i = 0; i < pairs.length; i++) {\r\n            const newContacts = pairs[i].collide();\r\n            contacts = contacts.concat(newContacts);\r\n            if (stats && newContacts.length > 0) {\r\n                for (const c of newContacts) {\r\n                    stats.physics.contacts.set(c.id, c);\r\n                }\r\n            }\r\n        }\r\n        if (stats) {\r\n            stats.physics.collisions += contacts.length;\r\n        }\r\n        return contacts;\r\n    }\r\n    /**\r\n     * Update the dynamic tree positions\r\n     */\r\n    update(targets) {\r\n        let updated = 0;\r\n        const len = targets.length;\r\n        for (let i = 0; i < len; i++) {\r\n            if (this._dynamicCollisionTree.updateCollider(targets[i])) {\r\n                updated++;\r\n            }\r\n        }\r\n        return updated;\r\n    }\r\n    debug(ex) {\r\n        this._dynamicCollisionTree.debug(ex);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/Collider.ts\n\r\n\r\n/**\r\n * A collision collider specifies the geometry that can detect when other collision colliders intersect\r\n * for the purposes of colliding 2 objects in excalibur.\r\n */\r\nclass Collider {\r\n    constructor() {\r\n        this.id = createId('collider', Collider._ID++);\r\n        /**\r\n         * Excalibur uses this to signal to the [[CollisionSystem]] this is part of a composite collider\r\n         * @internal\r\n         * @hidden\r\n         */\r\n        this.__compositeColliderId = null;\r\n        this.events = new EventEmitter();\r\n    }\r\n    /**\r\n     * Returns a boolean indicating whether this body collided with\r\n     * or was in stationary contact with\r\n     * the body of the other [[Collider]]\r\n     */\r\n    touching(other) {\r\n        const contact = this.collide(other);\r\n        if (contact) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n}\r\nCollider._ID = 0;\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/CompositeCollider.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass CompositeCollider extends Collider {\r\n    constructor(colliders) {\r\n        super();\r\n        this._collisionProcessor = new DynamicTreeCollisionProcessor();\r\n        this._dynamicAABBTree = new DynamicTree();\r\n        this._colliders = [];\r\n        for (const c of colliders) {\r\n            this.addCollider(c);\r\n        }\r\n    }\r\n    clearColliders() {\r\n        this._colliders = [];\r\n    }\r\n    addCollider(collider) {\r\n        collider.events.pipe(this.events);\r\n        collider.__compositeColliderId = this.id;\r\n        this._colliders.push(collider);\r\n        this._collisionProcessor.track(collider);\r\n        this._dynamicAABBTree.trackCollider(collider);\r\n    }\r\n    removeCollider(collider) {\r\n        collider.events.pipe(this.events);\r\n        collider.__compositeColliderId = null;\r\n        removeItemFromArray(collider, this._colliders);\r\n        this._collisionProcessor.untrack(collider);\r\n        this._dynamicAABBTree.untrackCollider(collider);\r\n    }\r\n    getColliders() {\r\n        return this._colliders;\r\n    }\r\n    get worldPos() {\r\n        var _a, _b;\r\n        // TODO transform component world pos\r\n        return (_b = (_a = this._transform) === null || _a === void 0 ? void 0 : _a.pos) !== null && _b !== void 0 ? _b : Vector.Zero;\r\n    }\r\n    get center() {\r\n        var _a, _b;\r\n        return (_b = (_a = this._transform) === null || _a === void 0 ? void 0 : _a.pos) !== null && _b !== void 0 ? _b : Vector.Zero;\r\n    }\r\n    get bounds() {\r\n        var _a, _b;\r\n        // TODO cache this\r\n        const colliders = this.getColliders();\r\n        const results = colliders.reduce((acc, collider) => acc.combine(collider.bounds), (_b = (_a = colliders[0]) === null || _a === void 0 ? void 0 : _a.bounds) !== null && _b !== void 0 ? _b : new BoundingBox().translate(this.worldPos));\r\n        return results;\r\n    }\r\n    get localBounds() {\r\n        var _a, _b;\r\n        // TODO cache this\r\n        const colliders = this.getColliders();\r\n        const results = colliders.reduce((acc, collider) => acc.combine(collider.localBounds), (_b = (_a = colliders[0]) === null || _a === void 0 ? void 0 : _a.localBounds) !== null && _b !== void 0 ? _b : new BoundingBox());\r\n        return results;\r\n    }\r\n    get axes() {\r\n        // TODO cache this\r\n        const colliders = this.getColliders();\r\n        let axes = [];\r\n        for (const collider of colliders) {\r\n            axes = axes.concat(collider.axes);\r\n        }\r\n        return axes;\r\n    }\r\n    getFurthestPoint(direction) {\r\n        const colliders = this.getColliders();\r\n        const furthestPoints = [];\r\n        for (const collider of colliders) {\r\n            furthestPoints.push(collider.getFurthestPoint(direction));\r\n        }\r\n        // Pick best point from all colliders\r\n        let bestPoint = furthestPoints[0];\r\n        let maxDistance = -Number.MAX_VALUE;\r\n        for (const point of furthestPoints) {\r\n            const distance = point.dot(direction);\r\n            if (distance > maxDistance) {\r\n                bestPoint = point;\r\n                maxDistance = distance;\r\n            }\r\n        }\r\n        return bestPoint;\r\n    }\r\n    getInertia(mass) {\r\n        const colliders = this.getColliders();\r\n        let totalInertia = 0;\r\n        for (const collider of colliders) {\r\n            totalInertia += collider.getInertia(mass);\r\n        }\r\n        return totalInertia;\r\n    }\r\n    collide(other) {\r\n        let otherColliders = [other];\r\n        if (other instanceof CompositeCollider) {\r\n            otherColliders = other.getColliders();\r\n        }\r\n        const pairs = [];\r\n        for (const c of otherColliders) {\r\n            this._dynamicAABBTree.query(c, (potentialCollider) => {\r\n                pairs.push(new Pair(c, potentialCollider));\r\n                return false;\r\n            });\r\n        }\r\n        let contacts = [];\r\n        for (const p of pairs) {\r\n            contacts = contacts.concat(p.collide());\r\n        }\r\n        return contacts;\r\n    }\r\n    getClosestLineBetween(other) {\r\n        const colliders = this.getColliders();\r\n        const lines = [];\r\n        if (other instanceof CompositeCollider) {\r\n            const otherColliders = other.getColliders();\r\n            for (const colliderA of colliders) {\r\n                for (const colliderB of otherColliders) {\r\n                    const maybeLine = colliderA.getClosestLineBetween(colliderB);\r\n                    if (maybeLine) {\r\n                        lines.push(maybeLine);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            for (const collider of colliders) {\r\n                const maybeLine = other.getClosestLineBetween(collider);\r\n                if (maybeLine) {\r\n                    lines.push(maybeLine);\r\n                }\r\n            }\r\n        }\r\n        if (lines.length) {\r\n            let minLength = lines[0].getLength();\r\n            let minLine = lines[0];\r\n            for (const line of lines) {\r\n                const length = line.getLength();\r\n                if (length < minLength) {\r\n                    minLength = length;\r\n                    minLine = line;\r\n                }\r\n            }\r\n            return minLine;\r\n        }\r\n        return null;\r\n    }\r\n    contains(point) {\r\n        const colliders = this.getColliders();\r\n        for (const collider of colliders) {\r\n            if (collider.contains(point)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    rayCast(ray, max) {\r\n        const colliders = this.getColliders();\r\n        const points = [];\r\n        for (const collider of colliders) {\r\n            const vec = collider.rayCast(ray, max);\r\n            if (vec) {\r\n                points.push(vec);\r\n            }\r\n        }\r\n        if (points.length) {\r\n            let minPoint = points[0];\r\n            let minDistance = minPoint.dot(ray.dir);\r\n            for (const point of points) {\r\n                const distance = ray.dir.dot(point);\r\n                if (distance < minDistance) {\r\n                    minPoint = point;\r\n                    minDistance = distance;\r\n                }\r\n            }\r\n            return minPoint;\r\n        }\r\n        return null;\r\n    }\r\n    project(axis) {\r\n        const colliders = this.getColliders();\r\n        const projs = [];\r\n        for (const collider of colliders) {\r\n            const proj = collider.project(axis);\r\n            if (proj) {\r\n                projs.push(proj);\r\n            }\r\n        }\r\n        // Merge all proj's on the same axis\r\n        if (projs.length) {\r\n            const newProjection = new Projection(projs[0].min, projs[0].max);\r\n            for (const proj of projs) {\r\n                newProjection.min = Math.min(proj.min, newProjection.min);\r\n                newProjection.max = Math.max(proj.max, newProjection.max);\r\n            }\r\n            return newProjection;\r\n        }\r\n        return null;\r\n    }\r\n    update(transform) {\r\n        if (transform) {\r\n            const colliders = this.getColliders();\r\n            for (const collider of colliders) {\r\n                collider.owner = this.owner;\r\n                collider.update(transform);\r\n            }\r\n        }\r\n    }\r\n    debug(ex, color) {\r\n        const colliders = this.getColliders();\r\n        for (const collider of colliders) {\r\n            collider.debug(ex, color);\r\n        }\r\n    }\r\n    clone() {\r\n        return new CompositeCollider(this._colliders.map((c) => c.clone()));\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/line-segment.ts\n\r\n/**\r\n * A 2D line segment\r\n */\r\nclass LineSegment {\r\n    /**\r\n     * @param begin  The starting point of the line segment\r\n     * @param end  The ending point of the line segment\r\n     */\r\n    constructor(begin, end) {\r\n        this.begin = begin;\r\n        this.end = end;\r\n    }\r\n    /**\r\n     * Gets the raw slope (m) of the line. Will return (+/-)Infinity for vertical lines.\r\n     */\r\n    get slope() {\r\n        return (this.end.y - this.begin.y) / (this.end.x - this.begin.x);\r\n    }\r\n    /**\r\n     * Gets the Y-intercept (b) of the line. Will return (+/-)Infinity if there is no intercept.\r\n     */\r\n    get intercept() {\r\n        return this.begin.y - this.slope * this.begin.x;\r\n    }\r\n    /**\r\n     * Gets the normal of the line\r\n     */\r\n    normal() {\r\n        if (this._normal) {\r\n            return this._normal;\r\n        }\r\n        return this._normal = this.end.sub(this.begin).normal();\r\n    }\r\n    dir() {\r\n        if (this._dir) {\r\n            return this._dir;\r\n        }\r\n        return this._dir = this.end.sub(this.begin);\r\n    }\r\n    getPoints() {\r\n        return [this.begin, this.end];\r\n    }\r\n    /**\r\n     * Returns the slope of the line in the form of a vector of length 1\r\n     */\r\n    getSlope() {\r\n        if (this._slope) {\r\n            return this._slope;\r\n        }\r\n        const begin = this.begin;\r\n        const end = this.end;\r\n        const distance = begin.distance(end);\r\n        return this._slope = end.sub(begin).scale(1 / distance);\r\n    }\r\n    /**\r\n     * Returns the edge of the line as vector, the length of the vector is the length of the edge\r\n     */\r\n    getEdge() {\r\n        const begin = this.begin;\r\n        const end = this.end;\r\n        return end.sub(begin);\r\n    }\r\n    /**\r\n     * Returns the length of the line segment in pixels\r\n     */\r\n    getLength() {\r\n        if (this._length) {\r\n            return this._length;\r\n        }\r\n        const begin = this.begin;\r\n        const end = this.end;\r\n        const distance = begin.distance(end);\r\n        return this._length = distance;\r\n    }\r\n    /**\r\n     * Returns the midpoint of the edge\r\n     */\r\n    get midpoint() {\r\n        return this.begin.add(this.end).scale(0.5);\r\n    }\r\n    /**\r\n     * Flips the direction of the line segment\r\n     */\r\n    flip() {\r\n        return new LineSegment(this.end, this.begin);\r\n    }\r\n    /**\r\n     * Tests if a given point is below the line, points in the normal direction above the line are considered above.\r\n     * @param point\r\n     */\r\n    below(point) {\r\n        const above2 = (this.end.x - this.begin.x) * (point.y - this.begin.y) - (this.end.y - this.begin.y) * (point.x - this.begin.x);\r\n        return above2 >= 0;\r\n    }\r\n    /**\r\n     * Returns the clip point\r\n     * @param sideVector Vector that traces the line\r\n     * @param length Length to clip along side\r\n     */\r\n    clip(sideVector, length) {\r\n        let dir = sideVector;\r\n        dir = dir.normalize();\r\n        const near = dir.dot(this.begin) - length;\r\n        const far = dir.dot(this.end) - length;\r\n        const results = [];\r\n        if (near <= 0) {\r\n            results.push(this.begin);\r\n        }\r\n        if (far <= 0) {\r\n            results.push(this.end);\r\n        }\r\n        if (near * far < 0) {\r\n            const clipTime = near / (near - far);\r\n            results.push(this.begin.add(this.end.sub(this.begin).scale(clipTime)));\r\n        }\r\n        if (results.length !== 2) {\r\n            return null;\r\n        }\r\n        return new LineSegment(results[0], results[1]);\r\n    }\r\n    /**\r\n     * Find the perpendicular distance from the line to a point\r\n     * https://en.wikipedia.org/wiki/Distance_from_a_point_to_a_line\r\n     * @param point\r\n     */\r\n    distanceToPoint(point, signed = false) {\r\n        const x0 = point.x;\r\n        const y0 = point.y;\r\n        const l = this.getLength();\r\n        const dy = this.end.y - this.begin.y;\r\n        const dx = this.end.x - this.begin.x;\r\n        const distance = (dy * x0 - dx * y0 + this.end.x * this.begin.y - this.end.y * this.begin.x) / l;\r\n        return signed ? distance : Math.abs(distance);\r\n    }\r\n    /**\r\n     * Find the perpendicular line from the line to a point\r\n     * https://en.wikipedia.org/wiki/Distance_from_a_point_to_a_line\r\n     * (a - p) - ((a - p) * n)n\r\n     * a is a point on the line\r\n     * p is the arbitrary point above the line\r\n     * n is a unit vector in direction of the line\r\n     * @param point\r\n     */\r\n    findVectorToPoint(point) {\r\n        const aMinusP = this.begin.sub(point);\r\n        const n = this.getSlope();\r\n        return aMinusP.sub(n.scale(aMinusP.dot(n)));\r\n    }\r\n    /**\r\n     * Finds a point on the line given only an X or a Y value. Given an X value, the function returns\r\n     * a new point with the calculated Y value and vice-versa.\r\n     *\r\n     * @param x The known X value of the target point\r\n     * @param y The known Y value of the target point\r\n     * @returns A new point with the other calculated axis value\r\n     */\r\n    findPoint(x = null, y = null) {\r\n        const m = this.slope;\r\n        const b = this.intercept;\r\n        if (x !== null) {\r\n            return new Vector(x, m * x + b);\r\n        }\r\n        else if (y !== null) {\r\n            return new Vector((y - b) / m, y);\r\n        }\r\n        else {\r\n            throw new Error('You must provide an X or a Y value');\r\n        }\r\n    }\r\n    /**\r\n     * @see http://stackoverflow.com/a/11908158/109458\r\n     */\r\n    hasPoint() {\r\n        let currPoint;\r\n        let threshold = 0;\r\n        if (typeof arguments[0] === 'number' && typeof arguments[1] === 'number') {\r\n            currPoint = new Vector(arguments[0], arguments[1]);\r\n            threshold = arguments[2] || 0;\r\n        }\r\n        else if (arguments[0] instanceof Vector) {\r\n            currPoint = arguments[0];\r\n            threshold = arguments[1] || 0;\r\n        }\r\n        else {\r\n            throw 'Could not determine the arguments for Vector.hasPoint';\r\n        }\r\n        const dxc = currPoint.x - this.begin.x;\r\n        const dyc = currPoint.y - this.begin.y;\r\n        const dx1 = this.end.x - this.begin.x;\r\n        const dy1 = this.end.y - this.begin.y;\r\n        const cross = dxc * dy1 - dyc * dx1;\r\n        // check whether point lines on the line\r\n        if (Math.abs(cross) > threshold) {\r\n            return false;\r\n        }\r\n        // check whether point lies in-between start and end\r\n        if (Math.abs(dx1) >= Math.abs(dy1)) {\r\n            return dx1 > 0 ? this.begin.x <= currPoint.x && currPoint.x <= this.end.x : this.end.x <= currPoint.x && currPoint.x <= this.begin.x;\r\n        }\r\n        else {\r\n            return dy1 > 0 ? this.begin.y <= currPoint.y && currPoint.y <= this.end.y : this.end.y <= currPoint.y && currPoint.y <= this.begin.y;\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/ClosestLineJumpTable.ts\n\r\n\r\n\r\n/**\r\n * Finds the closes line between 2 line segments, were the magnitude of u, v are the lengths of each segment\r\n * L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\r\n * L2 = Q(t) = q0 + t * v, where t is time and q0 is the start of the line\r\n * @param p0 Point where L1 begins\r\n * @param u Direction and length of L1\r\n * @param q0 Point were L2 begins\r\n * @param v Direction and length of L2\r\n */\r\nfunction ClosestLine(p0, u, q0, v) {\r\n    // Distance between 2 lines http://geomalgorithms.com/a07-_distance.html\r\n    // w(s, t) = P(s) - Q(t)\r\n    // The w(s, t) that has the minimum distance we will say is w(sClosest, tClosest) = wClosest\r\n    //\r\n    // wClosest is the vector that is uniquely perpendicular to the 2 line directions u & v.\r\n    // wClosest = w0 + sClosest * u - tClosest * v, where w0 is p0 - q0\r\n    //\r\n    // The closest point between 2 lines then satisfies this pair of equations\r\n    // 1: u * wClosest = 0\r\n    // 2: v * wClosest = 0\r\n    //\r\n    // Substituting wClosest into the equations we get\r\n    //\r\n    // 1: (u * u) * sClosest - (u * v) tClosest = -u * w0\r\n    // 2: (v * u) * sClosest - (v * v) tClosest = -v * w0\r\n    // simplify w0\r\n    const w0 = p0.sub(q0);\r\n    // simplify (u * u);\r\n    const a = u.dot(u);\r\n    // simplify (u * v);\r\n    const b = u.dot(v);\r\n    // simplify (v * v)\r\n    const c = v.dot(v);\r\n    // simplify (u * w0)\r\n    const d = u.dot(w0);\r\n    // simplify (v * w0)\r\n    const e = v.dot(w0);\r\n    // denominator ac - b^2\r\n    const denom = a * c - b * b;\r\n    let sDenom = denom;\r\n    let tDenom = denom;\r\n    // if denom is 0 they are parallel, use any point from either as the start in this case p0\r\n    if (denom === 0 || denom <= 0.01) {\r\n        const tClosestParallel = d / b;\r\n        return new LineSegment(p0, q0.add(v.scale(tClosestParallel)));\r\n    }\r\n    // Solve for sClosest for infinite line\r\n    let sClosest = b * e - c * d; // / denom;\r\n    // Solve for tClosest for infinite line\r\n    let tClosest = a * e - b * d; // / denom;\r\n    // Solve for segments candidate edges, if sClosest and tClosest are outside their segments\r\n    if (sClosest < 0) {\r\n        sClosest = 0;\r\n        tClosest = e;\r\n        tDenom = c;\r\n    }\r\n    else if (sClosest > sDenom) {\r\n        sClosest = sDenom;\r\n        tClosest = e + b;\r\n        tDenom = c;\r\n    }\r\n    if (tClosest < 0) {\r\n        tClosest = 0;\r\n        if (-d < 0) {\r\n            sClosest = 0;\r\n        }\r\n        else if (-d > a) {\r\n            sClosest = sDenom;\r\n        }\r\n        else {\r\n            sClosest = -d;\r\n            sDenom = a;\r\n        }\r\n    }\r\n    else if (tClosest > tDenom) {\r\n        tClosest = tDenom;\r\n        if (-d + b < 0) {\r\n            sClosest = 0;\r\n        }\r\n        else if (-d + b > a) {\r\n            sClosest = sDenom;\r\n        }\r\n        else {\r\n            sClosest = -d + b;\r\n            sDenom = a;\r\n        }\r\n    }\r\n    sClosest = Math.abs(sClosest) < 0.001 ? 0 : sClosest / sDenom;\r\n    tClosest = Math.abs(tClosest) < 0.001 ? 0 : tClosest / tDenom;\r\n    return new LineSegment(p0.add(u.scale(sClosest)), q0.add(v.scale(tClosest)));\r\n}\r\nconst ClosestLineJumpTable = {\r\n    PolygonPolygonClosestLine(polygonA, polygonB) {\r\n        // Find the 2 closest faces on each polygon\r\n        const otherWorldPos = polygonB.worldPos;\r\n        const otherDirection = otherWorldPos.sub(polygonA.worldPos);\r\n        const thisDirection = otherDirection.negate();\r\n        const rayTowardsOther = new Ray(polygonA.worldPos, otherDirection);\r\n        const rayTowardsThis = new Ray(otherWorldPos, thisDirection);\r\n        const thisPoint = polygonA.rayCast(rayTowardsOther).add(rayTowardsOther.dir.scale(0.1));\r\n        const otherPoint = polygonB.rayCast(rayTowardsThis).add(rayTowardsThis.dir.scale(0.1));\r\n        const thisFace = polygonA.getClosestFace(thisPoint);\r\n        const otherFace = polygonB.getClosestFace(otherPoint);\r\n        // L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\r\n        const p0 = thisFace.face.begin;\r\n        const u = thisFace.face.getEdge();\r\n        // L2 = Q(t) = q0 + t * v, where t is time and q0 is the start of the line\r\n        const q0 = otherFace.face.begin;\r\n        const v = otherFace.face.getEdge();\r\n        return ClosestLine(p0, u, q0, v);\r\n    },\r\n    PolygonEdgeClosestLine(polygon, edge) {\r\n        // Find the 2 closest faces on each polygon\r\n        const otherWorldPos = edge.worldPos;\r\n        const otherDirection = otherWorldPos.sub(polygon.worldPos);\r\n        const rayTowardsOther = new Ray(polygon.worldPos, otherDirection);\r\n        const thisPoint = polygon.rayCast(rayTowardsOther).add(rayTowardsOther.dir.scale(0.1));\r\n        const thisFace = polygon.getClosestFace(thisPoint);\r\n        // L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\r\n        const p0 = thisFace.face.begin;\r\n        const u = thisFace.face.getEdge();\r\n        // L2 = Q(t) = q0 + t * v, where t is time and q0 is the start of the line\r\n        const edgeLine = edge.asLine();\r\n        const edgeStart = edgeLine.begin;\r\n        const edgeVector = edgeLine.getEdge();\r\n        const q0 = edgeStart;\r\n        const v = edgeVector;\r\n        return ClosestLine(p0, u, q0, v);\r\n    },\r\n    PolygonCircleClosestLine(polygon, circle) {\r\n        // https://math.stackexchange.com/questions/1919177/how-to-find-point-on-line-closest-to-sphere\r\n        // Find the 2 closest faces on each polygon\r\n        const otherWorldPos = circle.worldPos;\r\n        const otherDirection = otherWorldPos.sub(polygon.worldPos);\r\n        const rayTowardsOther = new Ray(polygon.worldPos, otherDirection.normalize());\r\n        const thisPoint = polygon.rayCast(rayTowardsOther).add(rayTowardsOther.dir.scale(0.1));\r\n        const thisFace = polygon.getClosestFace(thisPoint);\r\n        // L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\r\n        const p0 = thisFace.face.begin;\r\n        const u = thisFace.face.getEdge();\r\n        // Time of minimum distance\r\n        let t = (u.x * (otherWorldPos.x - p0.x) + u.y * (otherWorldPos.y - p0.y)) / (u.x * u.x + u.y * u.y);\r\n        // If time of minimum is past the edge clamp\r\n        if (t > 1) {\r\n            t = 1;\r\n        }\r\n        else if (t < 0) {\r\n            t = 0;\r\n        }\r\n        // Minimum distance\r\n        const d = Math.sqrt(Math.pow(p0.x + u.x * t - otherWorldPos.x, 2) + Math.pow(p0.y + u.y * t - otherWorldPos.y, 2)) - circle.radius;\r\n        const circlex = ((p0.x + u.x * t - otherWorldPos.x) * circle.radius) / (circle.radius + d);\r\n        const circley = ((p0.y + u.y * t - otherWorldPos.y) * circle.radius) / (circle.radius + d);\r\n        return new LineSegment(u.scale(t).add(p0), new Vector(otherWorldPos.x + circlex, otherWorldPos.y + circley));\r\n    },\r\n    CircleCircleClosestLine(circleA, circleB) {\r\n        // Find the 2 closest faces on each polygon\r\n        const otherWorldPos = circleB.worldPos;\r\n        const otherDirection = otherWorldPos.sub(circleA.worldPos);\r\n        const thisWorldPos = circleA.worldPos;\r\n        const thisDirection = thisWorldPos.sub(circleB.worldPos);\r\n        const rayTowardsOther = new Ray(circleA.worldPos, otherDirection);\r\n        const rayTowardsThis = new Ray(circleB.worldPos, thisDirection);\r\n        const thisPoint = circleA.rayCast(rayTowardsOther);\r\n        const otherPoint = circleB.rayCast(rayTowardsThis);\r\n        return new LineSegment(thisPoint, otherPoint);\r\n    },\r\n    CircleEdgeClosestLine(circle, edge) {\r\n        // https://math.stackexchange.com/questions/1919177/how-to-find-point-on-line-closest-to-sphere\r\n        const circleWorlPos = circle.worldPos;\r\n        // L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\r\n        const edgeLine = edge.asLine();\r\n        const edgeStart = edgeLine.begin;\r\n        const edgeVector = edgeLine.getEdge();\r\n        const p0 = edgeStart;\r\n        const u = edgeVector;\r\n        // Time of minimum distance\r\n        let t = (u.x * (circleWorlPos.x - p0.x) + u.y * (circleWorlPos.y - p0.y)) / (u.x * u.x + u.y * u.y);\r\n        // If time of minimum is past the edge clamp to edge\r\n        if (t > 1) {\r\n            t = 1;\r\n        }\r\n        else if (t < 0) {\r\n            t = 0;\r\n        }\r\n        // Minimum distance\r\n        const d = Math.sqrt(Math.pow(p0.x + u.x * t - circleWorlPos.x, 2) + Math.pow(p0.y + u.y * t - circleWorlPos.y, 2)) - circle.radius;\r\n        const circlex = ((p0.x + u.x * t - circleWorlPos.x) * circle.radius) / (circle.radius + d);\r\n        const circley = ((p0.y + u.y * t - circleWorlPos.y) * circle.radius) / (circle.radius + d);\r\n        return new LineSegment(u.scale(t).add(p0), new Vector(circleWorlPos.x + circlex, circleWorlPos.y + circley));\r\n    },\r\n    EdgeEdgeClosestLine(edgeA, edgeB) {\r\n        // L1 = P(s) = p0 + s * u, where s is time and p0 is the start of the line\r\n        const edgeLineA = edgeA.asLine();\r\n        const edgeStartA = edgeLineA.begin;\r\n        const edgeVectorA = edgeLineA.getEdge();\r\n        const p0 = edgeStartA;\r\n        const u = edgeVectorA;\r\n        // L2 = Q(t) = q0 + t * v, where t is time and q0 is the start of the line\r\n        const edgeLineB = edgeB.asLine();\r\n        const edgeStartB = edgeLineB.begin;\r\n        const edgeVectorB = edgeLineB.getEdge();\r\n        const q0 = edgeStartB;\r\n        const v = edgeVectorB;\r\n        return ClosestLine(p0, u, q0, v);\r\n    }\r\n};\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/CircleCollider.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * This is a circle collider for the excalibur rigid body physics simulation\r\n */\r\nclass CircleCollider extends Collider {\r\n    get worldPos() {\r\n        return this._globalMatrix.getPosition();\r\n    }\r\n    /**\r\n     * Get the radius of the circle\r\n     */\r\n    get radius() {\r\n        var _a;\r\n        const tx = this._transform;\r\n        const scale = (_a = tx === null || tx === void 0 ? void 0 : tx.globalScale) !== null && _a !== void 0 ? _a : Vector.One;\r\n        // This is a trade off, the alternative is retooling circles to support ellipse collisions\r\n        return this._naturalRadius * Math.min(scale.x, scale.y);\r\n    }\r\n    /**\r\n     * Set the radius of the circle\r\n     */\r\n    set radius(val) {\r\n        var _a;\r\n        const tx = this._transform;\r\n        const scale = (_a = tx === null || tx === void 0 ? void 0 : tx.globalScale) !== null && _a !== void 0 ? _a : Vector.One;\r\n        // This is a trade off, the alternative is retooling circles to support ellipse collisions\r\n        this._naturalRadius = val / Math.min(scale.x, scale.y);\r\n    }\r\n    constructor(options) {\r\n        super();\r\n        /**\r\n         * Position of the circle relative to the collider, by default (0, 0).\r\n         */\r\n        this.offset = Vector.Zero;\r\n        this._globalMatrix = AffineMatrix.identity();\r\n        this.offset = options.offset || Vector.Zero;\r\n        this.radius = options.radius || 0;\r\n        this._globalMatrix.translate(this.offset.x, this.offset.y);\r\n    }\r\n    /**\r\n     * Returns a clone of this shape, not associated with any collider\r\n     */\r\n    clone() {\r\n        return new CircleCollider({\r\n            offset: this.offset.clone(),\r\n            radius: this.radius\r\n        });\r\n    }\r\n    /**\r\n     * Get the center of the collider in world coordinates\r\n     */\r\n    get center() {\r\n        return this._globalMatrix.getPosition();\r\n    }\r\n    /**\r\n     * Tests if a point is contained in this collider\r\n     */\r\n    contains(point) {\r\n        var _a, _b;\r\n        const pos = (_b = (_a = this._transform) === null || _a === void 0 ? void 0 : _a.pos) !== null && _b !== void 0 ? _b : this.offset;\r\n        const distance = pos.distance(point);\r\n        if (distance <= this.radius) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n    /**\r\n     * Casts a ray at the Circle collider and returns the nearest point of collision\r\n     * @param ray\r\n     */\r\n    rayCast(ray, max = Infinity) {\r\n        //https://en.wikipedia.org/wiki/Line%E2%80%93sphere_intersection\r\n        const c = this.center;\r\n        const dir = ray.dir;\r\n        const orig = ray.pos;\r\n        const discriminant = Math.sqrt(Math.pow(dir.dot(orig.sub(c)), 2) - Math.pow(orig.sub(c).distance(), 2) + Math.pow(this.radius, 2));\r\n        if (discriminant < 0) {\r\n            // no intersection\r\n            return null;\r\n        }\r\n        else {\r\n            let toi = 0;\r\n            if (discriminant === 0) {\r\n                toi = -dir.dot(orig.sub(c));\r\n                if (toi > 0 && toi < max) {\r\n                    return ray.getPoint(toi);\r\n                }\r\n                return null;\r\n            }\r\n            else {\r\n                const toi1 = -dir.dot(orig.sub(c)) + discriminant;\r\n                const toi2 = -dir.dot(orig.sub(c)) - discriminant;\r\n                const positiveToi = [];\r\n                if (toi1 >= 0) {\r\n                    positiveToi.push(toi1);\r\n                }\r\n                if (toi2 >= 0) {\r\n                    positiveToi.push(toi2);\r\n                }\r\n                const mintoi = Math.min(...positiveToi);\r\n                if (mintoi <= max) {\r\n                    return ray.getPoint(mintoi);\r\n                }\r\n                return null;\r\n            }\r\n        }\r\n    }\r\n    getClosestLineBetween(shape) {\r\n        if (shape instanceof CircleCollider) {\r\n            return ClosestLineJumpTable.CircleCircleClosestLine(this, shape);\r\n        }\r\n        else if (shape instanceof PolygonCollider) {\r\n            return ClosestLineJumpTable.PolygonCircleClosestLine(shape, this).flip();\r\n        }\r\n        else if (shape instanceof EdgeCollider) {\r\n            return ClosestLineJumpTable.CircleEdgeClosestLine(this, shape).flip();\r\n        }\r\n        else {\r\n            throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof shape}`);\r\n        }\r\n    }\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    collide(collider) {\r\n        if (collider instanceof CircleCollider) {\r\n            return CollisionJumpTable.CollideCircleCircle(this, collider);\r\n        }\r\n        else if (collider instanceof PolygonCollider) {\r\n            return CollisionJumpTable.CollideCirclePolygon(this, collider);\r\n        }\r\n        else if (collider instanceof EdgeCollider) {\r\n            return CollisionJumpTable.CollideCircleEdge(this, collider);\r\n        }\r\n        else {\r\n            throw new Error(`Circle could not collide with unknown CollisionShape ${typeof collider}`);\r\n        }\r\n    }\r\n    /**\r\n     * Find the point on the collider furthest in the direction specified\r\n     */\r\n    getFurthestPoint(direction) {\r\n        return this.center.add(direction.normalize().scale(this.radius));\r\n    }\r\n    /**\r\n     * Find the local point on the shape in the direction specified\r\n     * @param direction\r\n     */\r\n    getFurthestLocalPoint(direction) {\r\n        const dir = direction.normalize();\r\n        return dir.scale(this.radius);\r\n    }\r\n    /**\r\n     * Get the axis aligned bounding box for the circle collider in world coordinates\r\n     */\r\n    get bounds() {\r\n        var _a, _b, _c;\r\n        const tx = this._transform;\r\n        const scale = (_a = tx === null || tx === void 0 ? void 0 : tx.globalScale) !== null && _a !== void 0 ? _a : Vector.One;\r\n        const rotation = (_b = tx === null || tx === void 0 ? void 0 : tx.globalRotation) !== null && _b !== void 0 ? _b : 0;\r\n        const pos = ((_c = tx === null || tx === void 0 ? void 0 : tx.globalPos) !== null && _c !== void 0 ? _c : Vector.Zero);\r\n        return new BoundingBox(this.offset.x - this._naturalRadius, this.offset.y - this._naturalRadius, this.offset.x + this._naturalRadius, this.offset.y + this._naturalRadius).rotate(rotation).scale(scale).translate(pos);\r\n    }\r\n    /**\r\n     * Get the axis aligned bounding box for the circle collider in local coordinates\r\n     */\r\n    get localBounds() {\r\n        return new BoundingBox(this.offset.x - this._naturalRadius, this.offset.y - this._naturalRadius, this.offset.x + this._naturalRadius, this.offset.y + this._naturalRadius);\r\n    }\r\n    /**\r\n     * Get axis not implemented on circles, since there are infinite axis in a circle\r\n     */\r\n    get axes() {\r\n        return [];\r\n    }\r\n    /**\r\n     * Returns the moment of inertia of a circle given it's mass\r\n     * https://en.wikipedia.org/wiki/List_of_moments_of_inertia\r\n     */\r\n    getInertia(mass) {\r\n        return (mass * this.radius * this.radius) / 2;\r\n    }\r\n    /* istanbul ignore next */\r\n    update(transform) {\r\n        var _a;\r\n        this._transform = transform;\r\n        const globalMat = (_a = transform.matrix) !== null && _a !== void 0 ? _a : this._globalMatrix;\r\n        globalMat.clone(this._globalMatrix);\r\n        this._globalMatrix.translate(this.offset.x, this.offset.y);\r\n    }\r\n    /**\r\n     * Project the circle along a specified axis\r\n     */\r\n    project(axis) {\r\n        const scalars = [];\r\n        const point = this.center;\r\n        const dotProduct = point.dot(axis);\r\n        scalars.push(dotProduct);\r\n        scalars.push(dotProduct + this.radius);\r\n        scalars.push(dotProduct - this.radius);\r\n        return new Projection(Math.min.apply(Math, scalars), Math.max.apply(Math, scalars));\r\n    }\r\n    debug(ex, color) {\r\n        var _a, _b, _c, _d;\r\n        const tx = this._transform;\r\n        const scale = (_a = tx === null || tx === void 0 ? void 0 : tx.globalScale) !== null && _a !== void 0 ? _a : Vector.One;\r\n        const rotation = (_b = tx === null || tx === void 0 ? void 0 : tx.globalRotation) !== null && _b !== void 0 ? _b : 0;\r\n        const pos = ((_c = tx === null || tx === void 0 ? void 0 : tx.globalPos) !== null && _c !== void 0 ? _c : Vector.Zero);\r\n        ex.save();\r\n        ex.translate(pos.x, pos.y);\r\n        ex.rotate(rotation);\r\n        ex.scale(scale.x, scale.y);\r\n        ex.drawCircle(((_d = this.offset) !== null && _d !== void 0 ? _d : Vector.Zero), this._naturalRadius, Color.Transparent, color, 2);\r\n        ex.restore();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Detection/CollisionContact.ts\n\r\n\r\n\r\n\r\n/**\r\n * Collision contacts are used internally by Excalibur to resolve collision between colliders. This\r\n * Pair prevents collisions from being evaluated more than one time\r\n */\r\nclass CollisionContact {\r\n    constructor(colliderA, colliderB, mtv, normal, tangent, points, localPoints, info) {\r\n        var _a, _b;\r\n        this._canceled = false;\r\n        this.colliderA = colliderA;\r\n        this.colliderB = colliderB;\r\n        this.mtv = mtv;\r\n        this.normal = normal;\r\n        this.tangent = tangent;\r\n        this.points = points;\r\n        this.localPoints = localPoints;\r\n        this.info = info;\r\n        this.id = Pair.calculatePairHash(colliderA.id, colliderB.id);\r\n        if (colliderA.__compositeColliderId || colliderB.__compositeColliderId) {\r\n            // Add on the parent composite pair for start/end contact\r\n            this.id += '|' + Pair.calculatePairHash((_a = colliderA.__compositeColliderId) !== null && _a !== void 0 ? _a : colliderA.id, (_b = colliderB.__compositeColliderId) !== null && _b !== void 0 ? _b : colliderB.id);\r\n        }\r\n    }\r\n    /**\r\n     * Match contact awake state, except if body's are Fixed\r\n     */\r\n    matchAwake() {\r\n        const bodyA = this.colliderA.owner.get(BodyComponent);\r\n        const bodyB = this.colliderB.owner.get(BodyComponent);\r\n        if (bodyA && bodyB) {\r\n            if (bodyA.sleeping !== bodyB.sleeping) {\r\n                if (bodyA.sleeping && bodyA.collisionType !== CollisionType.Fixed && bodyB.sleepMotion >= Physics.wakeThreshold) {\r\n                    bodyA.setSleeping(false);\r\n                }\r\n                if (bodyB.sleeping && bodyB.collisionType !== CollisionType.Fixed && bodyA.sleepMotion >= Physics.wakeThreshold) {\r\n                    bodyB.setSleeping(false);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    isCanceled() {\r\n        return this._canceled;\r\n    }\r\n    cancel() {\r\n        this._canceled = true;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/SeparatingAxis.ts\nclass SeparatingAxis {\r\n    static findPolygonPolygonSeparation(polyA, polyB) {\r\n        let bestSeparation = -Number.MAX_VALUE;\r\n        let bestSide = null;\r\n        let bestAxis = null;\r\n        let bestSideIndex = -1;\r\n        let bestOtherPoint = null;\r\n        const sides = polyA.getSides();\r\n        const localSides = polyA.getLocalSides();\r\n        for (let i = 0; i < sides.length; i++) {\r\n            const side = sides[i];\r\n            const axis = side.normal();\r\n            const vertB = polyB.getFurthestPoint(axis.negate());\r\n            // Separation on side i's axis\r\n            // We are looking for the largest separation between poly A's sides\r\n            const vertSeparation = side.distanceToPoint(vertB, true);\r\n            if (vertSeparation > bestSeparation) {\r\n                bestSeparation = vertSeparation;\r\n                bestSide = side;\r\n                bestAxis = axis;\r\n                bestSideIndex = i;\r\n                bestOtherPoint = vertB;\r\n            }\r\n        }\r\n        return {\r\n            collider: polyA,\r\n            separation: bestAxis ? bestSeparation : 99,\r\n            axis: bestAxis,\r\n            side: bestSide,\r\n            localSide: localSides[bestSideIndex],\r\n            sideId: bestSideIndex,\r\n            point: bestOtherPoint,\r\n            localPoint: bestAxis ? polyB.getFurthestLocalPoint(bestAxis.negate()) : null\r\n        };\r\n    }\r\n    static findCirclePolygonSeparation(circle, polygon) {\r\n        const axes = polygon.axes;\r\n        const pc = polygon.center;\r\n        // Special SAT with circles\r\n        const polyDir = pc.sub(circle.worldPos);\r\n        const closestPointOnPoly = polygon.getFurthestPoint(polyDir.negate());\r\n        axes.push(closestPointOnPoly.sub(circle.worldPos).normalize());\r\n        let minOverlap = Number.MAX_VALUE;\r\n        let minAxis = null;\r\n        let minIndex = -1;\r\n        for (let i = 0; i < axes.length; i++) {\r\n            const proj1 = polygon.project(axes[i]);\r\n            const proj2 = circle.project(axes[i]);\r\n            const overlap = proj1.getOverlap(proj2);\r\n            if (overlap <= 0) {\r\n                return null;\r\n            }\r\n            else {\r\n                if (overlap < minOverlap) {\r\n                    minOverlap = overlap;\r\n                    minAxis = axes[i];\r\n                    minIndex = i;\r\n                }\r\n            }\r\n        }\r\n        if (minIndex < 0) {\r\n            return null;\r\n        }\r\n        return minAxis.normalize().scale(minOverlap);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/CollisionJumpTable.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst CollisionJumpTable = {\r\n    CollideCircleCircle(circleA, circleB) {\r\n        const circleAPos = circleA.worldPos;\r\n        const circleBPos = circleB.worldPos;\r\n        const combinedRadius = circleA.radius + circleB.radius;\r\n        const distance = circleAPos.distance(circleBPos);\r\n        if (distance > combinedRadius) {\r\n            return [];\r\n        }\r\n        // negative means overlap\r\n        const separation = combinedRadius - distance;\r\n        // Normal points from A -> B\r\n        const normal = circleBPos.sub(circleAPos).normalize();\r\n        const tangent = normal.perpendicular();\r\n        const mvt = normal.scale(separation);\r\n        const point = circleA.getFurthestPoint(normal);\r\n        const local = circleA.getFurthestLocalPoint(normal);\r\n        const info = {\r\n            collider: circleA,\r\n            separation,\r\n            axis: normal,\r\n            point: point\r\n        };\r\n        return [new CollisionContact(circleA, circleB, mvt, normal, tangent, [point], [local], info)];\r\n    },\r\n    CollideCirclePolygon(circle, polygon) {\r\n        var _a, _b;\r\n        let minAxis = SeparatingAxis.findCirclePolygonSeparation(circle, polygon);\r\n        if (!minAxis) {\r\n            return [];\r\n        }\r\n        // make sure that the minAxis is pointing away from circle\r\n        const samedir = minAxis.dot(polygon.center.sub(circle.center));\r\n        minAxis = samedir < 0 ? minAxis.negate() : minAxis;\r\n        const point = circle.getFurthestPoint(minAxis);\r\n        const xf = (_b = (_a = circle.owner) === null || _a === void 0 ? void 0 : _a.get(TransformComponent)) !== null && _b !== void 0 ? _b : new TransformComponent();\r\n        const local = xf.applyInverse(point);\r\n        const normal = minAxis.normalize();\r\n        const info = {\r\n            collider: circle,\r\n            separation: -minAxis.size,\r\n            axis: normal,\r\n            point: point,\r\n            localPoint: local,\r\n            side: polygon.findSide(normal.negate()),\r\n            localSide: polygon.findLocalSide(normal.negate())\r\n        };\r\n        return [new CollisionContact(circle, polygon, minAxis, normal, normal.perpendicular(), [point], [local], info)];\r\n    },\r\n    CollideCircleEdge(circle, edge) {\r\n        // TODO not sure this actually abides by local/world collisions\r\n        // Are edge.begin and edge.end local space or world space? I think they should be local\r\n        // center of the circle in world pos\r\n        const cc = circle.center;\r\n        // vector in the direction of the edge\r\n        const edgeWorld = edge.asLine();\r\n        const e = edgeWorld.end.sub(edgeWorld.begin);\r\n        // amount of overlap with the circle's center along the edge direction\r\n        const u = e.dot(edgeWorld.end.sub(cc));\r\n        const v = e.dot(cc.sub(edgeWorld.begin));\r\n        const side = edge.asLine();\r\n        const localSide = edge.asLocalLine();\r\n        // Potential region A collision (circle is on the left side of the edge, before the beginning)\r\n        if (v <= 0) {\r\n            const da = edgeWorld.begin.sub(cc);\r\n            const dda = da.dot(da); // quick and dirty way of calc'n distance in r^2 terms saves some sqrts\r\n            // save some sqrts\r\n            if (dda > circle.radius * circle.radius) {\r\n                return []; // no collision\r\n            }\r\n            const normal = da.normalize();\r\n            const separation = circle.radius - Math.sqrt(dda);\r\n            const info = {\r\n                collider: circle,\r\n                separation: separation,\r\n                axis: normal,\r\n                point: side.begin,\r\n                side: side,\r\n                localSide: localSide\r\n            };\r\n            return [\r\n                new CollisionContact(circle, edge, normal.scale(separation), normal, normal.perpendicular(), [side.begin], [localSide.begin], info)\r\n            ];\r\n        }\r\n        // Potential region B collision (circle is on the right side of the edge, after the end)\r\n        if (u <= 0) {\r\n            const db = edgeWorld.end.sub(cc);\r\n            const ddb = db.dot(db);\r\n            if (ddb > circle.radius * circle.radius) {\r\n                return [];\r\n            }\r\n            const normal = db.normalize();\r\n            const separation = circle.radius - Math.sqrt(ddb);\r\n            const info = {\r\n                collider: circle,\r\n                separation: separation,\r\n                axis: normal,\r\n                point: side.end,\r\n                side: side,\r\n                localSide: localSide\r\n            };\r\n            return [\r\n                new CollisionContact(circle, edge, normal.scale(separation), normal, normal.perpendicular(), [side.end], [localSide.end], info)\r\n            ];\r\n        }\r\n        // Otherwise potential region AB collision (circle is in the middle of the edge between the beginning and end)\r\n        const den = e.dot(e);\r\n        const pointOnEdge = edgeWorld.begin\r\n            .scale(u)\r\n            .add(edgeWorld.end.scale(v))\r\n            .scale(1 / den);\r\n        const d = cc.sub(pointOnEdge);\r\n        const dd = d.dot(d);\r\n        if (dd > circle.radius * circle.radius) {\r\n            return []; // no collision\r\n        }\r\n        let normal = e.perpendicular();\r\n        // flip correct direction\r\n        if (normal.dot(cc.sub(edgeWorld.begin)) < 0) {\r\n            normal.x = -normal.x;\r\n            normal.y = -normal.y;\r\n        }\r\n        normal = normal.normalize();\r\n        const separation = circle.radius - Math.sqrt(dd);\r\n        const mvt = normal.scale(separation);\r\n        const info = {\r\n            collider: circle,\r\n            separation: separation,\r\n            axis: normal,\r\n            point: pointOnEdge,\r\n            side: side,\r\n            localSide: localSide\r\n        };\r\n        return [\r\n            new CollisionContact(circle, edge, mvt, normal.negate(), normal.negate().perpendicular(), [pointOnEdge], [pointOnEdge.sub(edge.worldPos)], info)\r\n        ];\r\n    },\r\n    CollideEdgeEdge() {\r\n        // Edge-edge collision doesn't make sense\r\n        return [];\r\n    },\r\n    CollidePolygonEdge(polygon, edge) {\r\n        var _a;\r\n        const pc = polygon.center;\r\n        const ec = edge.center;\r\n        const dir = ec.sub(pc).normalize();\r\n        // build a temporary polygon from the edge to use SAT\r\n        const linePoly = new PolygonCollider({\r\n            points: [edge.begin, edge.end, edge.end.add(dir.scale(100)), edge.begin.add(dir.scale(100))],\r\n            offset: edge.offset\r\n        });\r\n        linePoly.owner = edge.owner;\r\n        const tx = (_a = edge.owner) === null || _a === void 0 ? void 0 : _a.get(TransformComponent);\r\n        if (tx) {\r\n            linePoly.update(edge.owner.get(TransformComponent).get());\r\n        }\r\n        // Gross hack but poly-poly works well\r\n        const contact = this.CollidePolygonPolygon(polygon, linePoly);\r\n        if (contact.length) {\r\n            // Fudge the contact back to edge\r\n            contact[0].colliderB = edge;\r\n            contact[0].id = Pair.calculatePairHash(polygon.id, edge.id);\r\n        }\r\n        return contact;\r\n    },\r\n    CollidePolygonPolygon(polyA, polyB) {\r\n        var _a, _b, _c, _d;\r\n        // Multi contact from SAT\r\n        // https://gamedev.stackexchange.com/questions/111390/multiple-contacts-for-sat-collision-detection\r\n        // do a SAT test to find a min axis if it exists\r\n        const separationA = SeparatingAxis.findPolygonPolygonSeparation(polyA, polyB);\r\n        // If there is no overlap from boxA's perspective we can end early\r\n        if (separationA.separation > 0) {\r\n            return [];\r\n        }\r\n        const separationB = SeparatingAxis.findPolygonPolygonSeparation(polyB, polyA);\r\n        // If there is no overlap from boxB's perspective exit now\r\n        if (separationB.separation > 0) {\r\n            return [];\r\n        }\r\n        // Separations are both negative, we want to pick the least negative (minimal movement)\r\n        const separation = separationA.separation > separationB.separation ? separationA : separationB;\r\n        // The incident side is the most opposite from the axes of collision on the other collider\r\n        const other = separation.collider === polyA ? polyB : polyA;\r\n        const incident = other.findSide(separation.axis.negate());\r\n        // Clip incident side by the perpendicular lines at each end of the reference side\r\n        // https://en.wikipedia.org/wiki/Sutherland%E2%80%93Hodgman_algorithm\r\n        const reference = separation.side;\r\n        const refDir = reference.dir().normalize();\r\n        // Find our contact points by clipping the incident by the collision side\r\n        const clipRight = incident.clip(refDir.negate(), -refDir.dot(reference.begin));\r\n        let clipLeft = null;\r\n        if (clipRight) {\r\n            clipLeft = clipRight.clip(refDir, refDir.dot(reference.end));\r\n        }\r\n        // If there is no left there is no collision\r\n        if (clipLeft) {\r\n            // We only want clip points below the reference edge, discard the others\r\n            const points = clipLeft.getPoints().filter((p) => {\r\n                return reference.below(p);\r\n            });\r\n            let normal = separation.axis;\r\n            let tangent = normal.perpendicular();\r\n            // Point Contact A -> B\r\n            if (polyB.center.sub(polyA.center).dot(normal) < 0) {\r\n                normal = normal.negate();\r\n                tangent = normal.perpendicular();\r\n            }\r\n            // Points are clipped from incident which is the other collider\r\n            // Store those as locals\r\n            let localPoints = [];\r\n            if (separation.collider === polyA) {\r\n                const xf = (_b = (_a = polyB.owner) === null || _a === void 0 ? void 0 : _a.get(TransformComponent)) !== null && _b !== void 0 ? _b : new TransformComponent();\r\n                localPoints = points.map((p) => xf.applyInverse(p));\r\n            }\r\n            else {\r\n                const xf = (_d = (_c = polyA.owner) === null || _c === void 0 ? void 0 : _c.get(TransformComponent)) !== null && _d !== void 0 ? _d : new TransformComponent();\r\n                localPoints = points.map((p) => xf.applyInverse(p));\r\n            }\r\n            return [new CollisionContact(polyA, polyB, normal.scale(-separation.separation), normal, tangent, points, localPoints, separation)];\r\n        }\r\n        return [];\r\n    },\r\n    FindContactSeparation(contact, localPoint) {\r\n        var _a, _b, _c, _d;\r\n        const shapeA = contact.colliderA;\r\n        const txA = (_b = (_a = contact.colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(TransformComponent)) !== null && _b !== void 0 ? _b : new TransformComponent();\r\n        const shapeB = contact.colliderB;\r\n        const txB = (_d = (_c = contact.colliderB.owner) === null || _c === void 0 ? void 0 : _c.get(TransformComponent)) !== null && _d !== void 0 ? _d : new TransformComponent();\r\n        // both are circles\r\n        if (shapeA instanceof CircleCollider && shapeB instanceof CircleCollider) {\r\n            const combinedRadius = shapeA.radius + shapeB.radius;\r\n            const distance = txA.pos.distance(txB.pos);\r\n            const separation = combinedRadius - distance;\r\n            return -separation;\r\n        }\r\n        // both are polygons\r\n        if (shapeA instanceof PolygonCollider && shapeB instanceof PolygonCollider) {\r\n            if (contact.info.localSide) {\r\n                let side;\r\n                let worldPoint;\r\n                if (contact.info.collider === shapeA) {\r\n                    side = new LineSegment(txA.apply(contact.info.localSide.begin), txA.apply(contact.info.localSide.end));\r\n                    worldPoint = txB.apply(localPoint);\r\n                }\r\n                else {\r\n                    side = new LineSegment(txB.apply(contact.info.localSide.begin), txB.apply(contact.info.localSide.end));\r\n                    worldPoint = txA.apply(localPoint);\r\n                }\r\n                return side.distanceToPoint(worldPoint, true);\r\n            }\r\n        }\r\n        // polygon v circle\r\n        if ((shapeA instanceof PolygonCollider && shapeB instanceof CircleCollider) ||\r\n            (shapeB instanceof PolygonCollider && shapeA instanceof CircleCollider)) {\r\n            const worldPoint = txA.apply(localPoint);\r\n            if (contact.info.side) {\r\n                return contact.info.side.distanceToPoint(worldPoint, true);\r\n            }\r\n        }\r\n        // polygon v edge\r\n        if ((shapeA instanceof EdgeCollider && shapeB instanceof PolygonCollider) ||\r\n            (shapeB instanceof EdgeCollider && shapeA instanceof PolygonCollider)) {\r\n            let worldPoint;\r\n            if (contact.info.collider === shapeA) {\r\n                worldPoint = txB.apply(localPoint);\r\n            }\r\n            else {\r\n                worldPoint = txA.apply(localPoint);\r\n            }\r\n            if (contact.info.side) {\r\n                return contact.info.side.distanceToPoint(worldPoint, true);\r\n            }\r\n        }\r\n        // circle v edge\r\n        if ((shapeA instanceof CircleCollider && shapeB instanceof EdgeCollider) ||\r\n            (shapeB instanceof CircleCollider && shapeA instanceof EdgeCollider)) {\r\n            // Local point is always on the edge which is always shapeB\r\n            const worldPoint = txB.apply(localPoint);\r\n            let circlePoint;\r\n            if (shapeA instanceof CircleCollider) {\r\n                circlePoint = shapeA.getFurthestPoint(contact.normal);\r\n            }\r\n            const dist = worldPoint.distance(circlePoint);\r\n            if (contact.info.side) {\r\n                return dist > 0 ? -dist : 0;\r\n            }\r\n        }\r\n        return 0;\r\n    }\r\n};\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/EdgeCollider.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Edge is a single line collider to create collisions with a single line.\r\n */\r\nclass EdgeCollider extends Collider {\r\n    constructor(options) {\r\n        var _a;\r\n        super();\r\n        this._globalMatrix = AffineMatrix.identity();\r\n        this.begin = options.begin || Vector.Zero;\r\n        this.end = options.end || Vector.Zero;\r\n        this.offset = (_a = options.offset) !== null && _a !== void 0 ? _a : Vector.Zero;\r\n    }\r\n    /**\r\n     * Returns a clone of this Edge, not associated with any collider\r\n     */\r\n    clone() {\r\n        return new EdgeCollider({\r\n            begin: this.begin.clone(),\r\n            end: this.end.clone()\r\n        });\r\n    }\r\n    get worldPos() {\r\n        var _a;\r\n        const tx = this._transform;\r\n        return (_a = tx === null || tx === void 0 ? void 0 : tx.globalPos.add(this.offset)) !== null && _a !== void 0 ? _a : this.offset;\r\n    }\r\n    /**\r\n     * Get the center of the collision area in world coordinates\r\n     */\r\n    get center() {\r\n        const begin = this._getTransformedBegin();\r\n        const end = this._getTransformedEnd();\r\n        const pos = begin.average(end);\r\n        return pos;\r\n    }\r\n    _getTransformedBegin() {\r\n        return this._globalMatrix.multiply(this.begin);\r\n    }\r\n    _getTransformedEnd() {\r\n        return this._globalMatrix.multiply(this.end);\r\n    }\r\n    /**\r\n     * Returns the slope of the line in the form of a vector\r\n     */\r\n    getSlope() {\r\n        const begin = this._getTransformedBegin();\r\n        const end = this._getTransformedEnd();\r\n        const distance = begin.distance(end);\r\n        return end.sub(begin).scale(1 / distance);\r\n    }\r\n    /**\r\n     * Returns the length of the line segment in pixels\r\n     */\r\n    getLength() {\r\n        const begin = this._getTransformedBegin();\r\n        const end = this._getTransformedEnd();\r\n        const distance = begin.distance(end);\r\n        return distance;\r\n    }\r\n    /**\r\n     * Tests if a point is contained in this collision area\r\n     */\r\n    contains() {\r\n        return false;\r\n    }\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    rayCast(ray, max = Infinity) {\r\n        const numerator = this._getTransformedBegin().sub(ray.pos);\r\n        // Test is line and ray are parallel and non intersecting\r\n        if (ray.dir.cross(this.getSlope()) === 0 && numerator.cross(ray.dir) !== 0) {\r\n            return null;\r\n        }\r\n        // Lines are parallel\r\n        const divisor = ray.dir.cross(this.getSlope());\r\n        if (divisor === 0) {\r\n            return null;\r\n        }\r\n        const t = numerator.cross(this.getSlope()) / divisor;\r\n        if (t >= 0 && t <= max) {\r\n            const u = numerator.cross(ray.dir) / divisor / this.getLength();\r\n            if (u >= 0 && u <= 1) {\r\n                return ray.getPoint(t);\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n    /**\r\n     * Returns the closes line between this and another collider, from this -> collider\r\n     * @param shape\r\n     */\r\n    getClosestLineBetween(shape) {\r\n        if (shape instanceof CircleCollider) {\r\n            return ClosestLineJumpTable.CircleEdgeClosestLine(shape, this);\r\n        }\r\n        else if (shape instanceof PolygonCollider) {\r\n            return ClosestLineJumpTable.PolygonEdgeClosestLine(shape, this).flip();\r\n        }\r\n        else if (shape instanceof EdgeCollider) {\r\n            return ClosestLineJumpTable.EdgeEdgeClosestLine(this, shape);\r\n        }\r\n        else {\r\n            throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof shape}`);\r\n        }\r\n    }\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    collide(shape) {\r\n        if (shape instanceof CircleCollider) {\r\n            return CollisionJumpTable.CollideCircleEdge(shape, this);\r\n        }\r\n        else if (shape instanceof PolygonCollider) {\r\n            return CollisionJumpTable.CollidePolygonEdge(shape, this);\r\n        }\r\n        else if (shape instanceof EdgeCollider) {\r\n            return CollisionJumpTable.CollideEdgeEdge();\r\n        }\r\n        else {\r\n            throw new Error(`Edge could not collide with unknown CollisionShape ${typeof shape}`);\r\n        }\r\n    }\r\n    /**\r\n     * Find the point on the collider furthest in the direction specified\r\n     */\r\n    getFurthestPoint(direction) {\r\n        const transformedBegin = this._getTransformedBegin();\r\n        const transformedEnd = this._getTransformedEnd();\r\n        if (direction.dot(transformedBegin) > 0) {\r\n            return transformedBegin;\r\n        }\r\n        else {\r\n            return transformedEnd;\r\n        }\r\n    }\r\n    _boundsFromBeginEnd(begin, end, padding = 10) {\r\n        // A perfectly vertical or horizontal edge would have a bounds 0 width or height\r\n        // this causes problems for the collision system so we give them some padding\r\n        return new BoundingBox(Math.min(begin.x, end.x) - padding, Math.min(begin.y, end.y) - padding, Math.max(begin.x, end.x) + padding, Math.max(begin.y, end.y) + padding);\r\n    }\r\n    /**\r\n     * Get the axis aligned bounding box for the edge collider in world space\r\n     */\r\n    get bounds() {\r\n        const transformedBegin = this._getTransformedBegin();\r\n        const transformedEnd = this._getTransformedEnd();\r\n        return this._boundsFromBeginEnd(transformedBegin, transformedEnd);\r\n    }\r\n    /**\r\n     * Get the axis aligned bounding box for the edge collider in local space\r\n     */\r\n    get localBounds() {\r\n        return this._boundsFromBeginEnd(this.begin, this.end);\r\n    }\r\n    /**\r\n     * Returns this edge represented as a line in world coordinates\r\n     */\r\n    asLine() {\r\n        return new LineSegment(this._getTransformedBegin(), this._getTransformedEnd());\r\n    }\r\n    /**\r\n     * Return this edge as a line in local line coordinates (relative to the position)\r\n     */\r\n    asLocalLine() {\r\n        return new LineSegment(this.begin, this.end);\r\n    }\r\n    /**\r\n     * Get the axis associated with the edge\r\n     */\r\n    get axes() {\r\n        const e = this._getTransformedEnd().sub(this._getTransformedBegin());\r\n        const edgeNormal = e.normal();\r\n        const axes = [];\r\n        axes.push(edgeNormal);\r\n        axes.push(edgeNormal.negate());\r\n        axes.push(edgeNormal.normal());\r\n        axes.push(edgeNormal.normal().negate());\r\n        return axes;\r\n    }\r\n    /**\r\n     * Get the moment of inertia for an edge\r\n     * https://en.wikipedia.org/wiki/List_of_moments_of_inertia\r\n     */\r\n    getInertia(mass) {\r\n        const length = this.end.sub(this.begin).distance() / 2;\r\n        return mass * length * length;\r\n    }\r\n    /**\r\n     * @inheritdoc\r\n     */\r\n    update(transform) {\r\n        var _a;\r\n        this._transform = transform;\r\n        const globalMat = (_a = transform.matrix) !== null && _a !== void 0 ? _a : this._globalMatrix;\r\n        globalMat.clone(this._globalMatrix);\r\n        this._globalMatrix.translate(this.offset.x, this.offset.y);\r\n    }\r\n    /**\r\n     * Project the edge along a specified axis\r\n     */\r\n    project(axis) {\r\n        const scalars = [];\r\n        const points = [this._getTransformedBegin(), this._getTransformedEnd()];\r\n        const len = points.length;\r\n        for (let i = 0; i < len; i++) {\r\n            scalars.push(points[i].dot(axis));\r\n        }\r\n        return new Projection(Math.min.apply(Math, scalars), Math.max.apply(Math, scalars));\r\n    }\r\n    debug(ex, color) {\r\n        const begin = this._getTransformedBegin();\r\n        const end = this._getTransformedEnd();\r\n        ex.drawLine(begin, end, color, 2);\r\n        ex.drawCircle(begin, 2, color);\r\n        ex.drawCircle(end, 2, color);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/PolygonCollider.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Polygon collider for detecting collisions\r\n */\r\nclass PolygonCollider extends Collider {\r\n    /**\r\n     * Points in the polygon in order around the perimeter in local coordinates. These are relative from the body transform position.\r\n     * Excalibur stores these in counter-clockwise order\r\n     */\r\n    set points(points) {\r\n        this._localBoundsDirty = true;\r\n        this._localSidesDirty = true;\r\n        this._sidesDirty = true;\r\n        this._points = points;\r\n    }\r\n    /**\r\n     * Points in the polygon in order around the perimeter in local coordinates. These are relative from the body transform position.\r\n     * Excalibur stores these in counter-clockwise order\r\n     */\r\n    get points() {\r\n        return this._points;\r\n    }\r\n    constructor(options) {\r\n        var _a, _b;\r\n        super();\r\n        this._logger = Logger.getInstance();\r\n        this._transformedPoints = [];\r\n        this._sides = [];\r\n        this._localSides = [];\r\n        this._globalMatrix = AffineMatrix.identity();\r\n        this._transformedPointsDirty = true;\r\n        this._sidesDirty = true;\r\n        this._localSidesDirty = true;\r\n        this._localBoundsDirty = true;\r\n        this.offset = (_a = options.offset) !== null && _a !== void 0 ? _a : Vector.Zero;\r\n        this._globalMatrix.translate(this.offset.x, this.offset.y);\r\n        this.points = (_b = options.points) !== null && _b !== void 0 ? _b : [];\r\n        const counterClockwise = this._isCounterClockwiseWinding(this.points);\r\n        if (!counterClockwise) {\r\n            this.points.reverse();\r\n        }\r\n        if (!this.isConvex()) {\r\n            this._logger.warn('Excalibur only supports convex polygon colliders and will not behave properly.' +\r\n                'Call PolygonCollider.triangulate() to build a new collider composed of smaller convex triangles');\r\n        }\r\n        // calculate initial transformation\r\n        this._calculateTransformation();\r\n    }\r\n    _isCounterClockwiseWinding(points) {\r\n        // https://stackoverflow.com/a/1165943\r\n        let sum = 0;\r\n        for (let i = 0; i < points.length; i++) {\r\n            sum += (points[(i + 1) % points.length].x - points[i].x) * (points[(i + 1) % points.length].y + points[i].y);\r\n        }\r\n        return sum < 0;\r\n    }\r\n    /**\r\n     * Returns if the polygon collider is convex, Excalibur does not handle non-convex collision shapes.\r\n     * Call [[Polygon.triangulate]] to generate a [[CompositeCollider]] from this non-convex shape\r\n     */\r\n    isConvex() {\r\n        // From SO: https://stackoverflow.com/a/45372025\r\n        if (this.points.length < 3) {\r\n            return false;\r\n        }\r\n        let oldPoint = this.points[this.points.length - 2];\r\n        let newPoint = this.points[this.points.length - 1];\r\n        let direction = Math.atan2(newPoint.y - oldPoint.y, newPoint.x - oldPoint.x);\r\n        let oldDirection = 0;\r\n        let orientation = 0;\r\n        let angleSum = 0;\r\n        for (const [i, point] of this.points.entries()) {\r\n            oldPoint = newPoint;\r\n            oldDirection = direction;\r\n            newPoint = point;\r\n            direction = Math.atan2(newPoint.y - oldPoint.y, newPoint.x - oldPoint.x);\r\n            if (oldPoint.equals(newPoint)) {\r\n                return false; // repeat point\r\n            }\r\n            let angle = direction - oldDirection;\r\n            if (angle <= -Math.PI) {\r\n                angle += Math.PI * 2;\r\n            }\r\n            else if (angle > Math.PI) {\r\n                angle -= Math.PI * 2;\r\n            }\r\n            if (i === 0) {\r\n                if (angle === 0.0) {\r\n                    return false;\r\n                }\r\n                orientation = angle > 0 ? 1 : -1;\r\n            }\r\n            else {\r\n                if (orientation * angle <= 0) {\r\n                    return false;\r\n                }\r\n            }\r\n            angleSum += angle;\r\n        }\r\n        return Math.abs(Math.round(angleSum / (Math.PI * 2))) === 1;\r\n    }\r\n    /**\r\n     * Tessellates the polygon into a triangle fan as a [[CompositeCollider]] of triangle polygons\r\n     */\r\n    tessellate() {\r\n        const polygons = [];\r\n        for (let i = 1; i < this.points.length - 2; i++) {\r\n            polygons.push([this.points[0], this.points[i + 1], this.points[i + 2]]);\r\n        }\r\n        polygons.push([this.points[0], this.points[1], this.points[2]]);\r\n        return new CompositeCollider(polygons.map(points => Shape.Polygon(points)));\r\n    }\r\n    /**\r\n     * Triangulate the polygon collider using the \"Ear Clipping\" algorithm.\r\n     * Returns a new [[CompositeCollider]] made up of smaller triangles.\r\n     */\r\n    triangulate() {\r\n        // https://www.youtube.com/watch?v=hTJFcHutls8\r\n        if (this.points.length < 3) {\r\n            throw Error('Invalid polygon');\r\n        }\r\n        /**\r\n         * Helper to get a vertex in the list\r\n         */\r\n        function getItem(index, list) {\r\n            if (index >= list.length) {\r\n                return list[index % list.length];\r\n            }\r\n            else if (index < 0) {\r\n                return list[index % list.length + list.length];\r\n            }\r\n            else {\r\n                return list[index];\r\n            }\r\n        }\r\n        /**\r\n         * Quick test for point in triangle\r\n         */\r\n        function isPointInTriangle(point, a, b, c) {\r\n            const ab = b.sub(a);\r\n            const bc = c.sub(b);\r\n            const ca = a.sub(c);\r\n            const ap = point.sub(a);\r\n            const bp = point.sub(b);\r\n            const cp = point.sub(c);\r\n            const cross1 = ab.cross(ap);\r\n            const cross2 = bc.cross(bp);\r\n            const cross3 = ca.cross(cp);\r\n            if (cross1 > 0 || cross2 > 0 || cross3 > 0) {\r\n                return false;\r\n            }\r\n            return true;\r\n        }\r\n        const triangles = [];\r\n        const vertices = [...this.points];\r\n        const indices = range(0, this.points.length - 1);\r\n        // 1. Loop through vertices clockwise\r\n        //    if the vertex is convex (interior angle is < 180) (cross product positive)\r\n        //    if the polygon formed by it's edges doesn't contain the points\r\n        //         it's an ear add it to our list of triangles, and restart\r\n        while (indices.length > 3) {\r\n            for (let i = 0; i < indices.length; i++) {\r\n                const a = indices[i];\r\n                const b = getItem(i - 1, indices);\r\n                const c = getItem(i + 1, indices);\r\n                const va = vertices[a];\r\n                const vb = vertices[b];\r\n                const vc = vertices[c];\r\n                // Check convexity\r\n                const leftArm = vb.sub(va);\r\n                const rightArm = vc.sub(va);\r\n                const isConvex = rightArm.cross(leftArm) > 0; // positive cross means convex\r\n                if (!isConvex) {\r\n                    continue;\r\n                }\r\n                let isEar = true;\r\n                // Check that if any vertices are in the triangle a, b, c\r\n                for (let j = 0; j < indices.length; j++) {\r\n                    const vertIndex = indices[j];\r\n                    // We can skip these\r\n                    if (vertIndex === a || vertIndex === b || vertIndex === c) {\r\n                        continue;\r\n                    }\r\n                    const point = vertices[vertIndex];\r\n                    if (isPointInTriangle(point, vb, va, vc)) {\r\n                        isEar = false;\r\n                        break;\r\n                    }\r\n                }\r\n                // Add ear to polygon list and remove from list\r\n                if (isEar) {\r\n                    triangles.push([vb, va, vc]);\r\n                    indices.splice(i, 1);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        triangles.push([vertices[indices[0]], vertices[indices[1]], vertices[indices[2]]]);\r\n        return new CompositeCollider(triangles.map(points => Shape.Polygon(points)));\r\n    }\r\n    /**\r\n     * Returns a clone of this ConvexPolygon, not associated with any collider\r\n     */\r\n    clone() {\r\n        return new PolygonCollider({\r\n            offset: this.offset.clone(),\r\n            points: this.points.map((p) => p.clone())\r\n        });\r\n    }\r\n    /**\r\n     * Returns the world position of the collider, which is the current body transform plus any defined offset\r\n     */\r\n    get worldPos() {\r\n        if (this._transform) {\r\n            return this._transform.pos.add(this.offset);\r\n        }\r\n        return this.offset;\r\n    }\r\n    /**\r\n     * Get the center of the collider in world coordinates\r\n     */\r\n    get center() {\r\n        return this.bounds.center;\r\n    }\r\n    /**\r\n     * Calculates the underlying transformation from the body relative space to world space\r\n     */\r\n    _calculateTransformation() {\r\n        const points = this.points;\r\n        const len = points.length;\r\n        this._transformedPoints.length = 0; // clear out old transform\r\n        for (let i = 0; i < len; i++) {\r\n            this._transformedPoints[i] = this._globalMatrix.multiply(points[i].clone());\r\n        }\r\n    }\r\n    /**\r\n     * Gets the points that make up the polygon in world space, from actor relative space (if specified)\r\n     */\r\n    getTransformedPoints() {\r\n        if (this._transformedPointsDirty) {\r\n            this._calculateTransformation();\r\n            this._transformedPointsDirty = false;\r\n        }\r\n        return this._transformedPoints;\r\n    }\r\n    /**\r\n     * Gets the sides of the polygon in world space\r\n     */\r\n    getSides() {\r\n        if (this._sidesDirty) {\r\n            const lines = [];\r\n            const points = this.getTransformedPoints();\r\n            const len = points.length;\r\n            for (let i = 0; i < len; i++) {\r\n                // This winding is important\r\n                lines.push(new LineSegment(points[i], points[(i + 1) % len]));\r\n            }\r\n            this._sides = lines;\r\n            this._sidesDirty = false;\r\n        }\r\n        return this._sides;\r\n    }\r\n    /**\r\n     * Returns the local coordinate space sides\r\n     */\r\n    getLocalSides() {\r\n        if (this._localSidesDirty) {\r\n            const lines = [];\r\n            const points = this.points;\r\n            const len = points.length;\r\n            for (let i = 0; i < len; i++) {\r\n                // This winding is important\r\n                lines.push(new LineSegment(points[i], points[(i + 1) % len]));\r\n            }\r\n            this._localSides = lines;\r\n            this._localSidesDirty = false;\r\n        }\r\n        return this._localSides;\r\n    }\r\n    /**\r\n     * Given a direction vector find the world space side that is most in that direction\r\n     * @param direction\r\n     */\r\n    findSide(direction) {\r\n        const sides = this.getSides();\r\n        let bestSide = sides[0];\r\n        let maxDistance = -Number.MAX_VALUE;\r\n        for (let side = 0; side < sides.length; side++) {\r\n            const currentSide = sides[side];\r\n            const sideNormal = currentSide.normal();\r\n            const mostDirection = sideNormal.dot(direction);\r\n            if (mostDirection > maxDistance) {\r\n                bestSide = currentSide;\r\n                maxDistance = mostDirection;\r\n            }\r\n        }\r\n        return bestSide;\r\n    }\r\n    /**\r\n     * Given a direction vector find the local space side that is most in that direction\r\n     * @param direction\r\n     */\r\n    findLocalSide(direction) {\r\n        const sides = this.getLocalSides();\r\n        let bestSide = sides[0];\r\n        let maxDistance = -Number.MAX_VALUE;\r\n        for (let side = 0; side < sides.length; side++) {\r\n            const currentSide = sides[side];\r\n            const sideNormal = currentSide.normal();\r\n            const mostDirection = sideNormal.dot(direction);\r\n            if (mostDirection > maxDistance) {\r\n                bestSide = currentSide;\r\n                maxDistance = mostDirection;\r\n            }\r\n        }\r\n        return bestSide;\r\n    }\r\n    /**\r\n     * Get the axis associated with the convex polygon\r\n     */\r\n    get axes() {\r\n        const axes = [];\r\n        const sides = this.getSides();\r\n        for (let i = 0; i < sides.length; i++) {\r\n            axes.push(sides[i].normal());\r\n        }\r\n        return axes;\r\n    }\r\n    /**\r\n     * Updates the transform for the collision geometry\r\n     *\r\n     * Collision geometry (points/bounds) will not change until this is called.\r\n     * @param transform\r\n     */\r\n    update(transform) {\r\n        var _a;\r\n        if (transform) {\r\n            this._transform = transform;\r\n            this._transformedPointsDirty = true;\r\n            this._sidesDirty = true;\r\n            // This change means an update must be performed in order for geometry to update\r\n            const globalMat = (_a = transform.matrix) !== null && _a !== void 0 ? _a : this._globalMatrix;\r\n            globalMat.clone(this._globalMatrix);\r\n            this._globalMatrix.translate(this.offset.x, this.offset.y);\r\n        }\r\n    }\r\n    /**\r\n     * Tests if a point is contained in this collider in world space\r\n     */\r\n    contains(point) {\r\n        // Always cast to the right, as long as we cast in a consistent fixed direction we\r\n        // will be fine\r\n        const testRay = new Ray(point, new Vector(1, 0));\r\n        const intersectCount = this.getSides().reduce(function (accum, side) {\r\n            if (testRay.intersect(side) >= 0) {\r\n                return accum + 1;\r\n            }\r\n            return accum;\r\n        }, 0);\r\n        if (intersectCount % 2 === 0) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    getClosestLineBetween(collider) {\r\n        if (collider instanceof CircleCollider) {\r\n            return ClosestLineJumpTable.PolygonCircleClosestLine(this, collider);\r\n        }\r\n        else if (collider instanceof PolygonCollider) {\r\n            return ClosestLineJumpTable.PolygonPolygonClosestLine(this, collider);\r\n        }\r\n        else if (collider instanceof EdgeCollider) {\r\n            return ClosestLineJumpTable.PolygonEdgeClosestLine(this, collider);\r\n        }\r\n        else {\r\n            throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof collider}`);\r\n        }\r\n    }\r\n    /**\r\n     * Returns a collision contact if the 2 colliders collide, otherwise collide will\r\n     * return null.\r\n     * @param collider\r\n     */\r\n    collide(collider) {\r\n        if (collider instanceof CircleCollider) {\r\n            return CollisionJumpTable.CollideCirclePolygon(collider, this);\r\n        }\r\n        else if (collider instanceof PolygonCollider) {\r\n            return CollisionJumpTable.CollidePolygonPolygon(this, collider);\r\n        }\r\n        else if (collider instanceof EdgeCollider) {\r\n            return CollisionJumpTable.CollidePolygonEdge(this, collider);\r\n        }\r\n        else {\r\n            throw new Error(`Polygon could not collide with unknown CollisionShape ${typeof collider}`);\r\n        }\r\n    }\r\n    /**\r\n     * Find the point on the collider furthest in the direction specified\r\n     */\r\n    getFurthestPoint(direction) {\r\n        const pts = this.getTransformedPoints();\r\n        let furthestPoint = null;\r\n        let maxDistance = -Number.MAX_VALUE;\r\n        for (let i = 0; i < pts.length; i++) {\r\n            const distance = direction.dot(pts[i]);\r\n            if (distance > maxDistance) {\r\n                maxDistance = distance;\r\n                furthestPoint = pts[i];\r\n            }\r\n        }\r\n        return furthestPoint;\r\n    }\r\n    /**\r\n     * Find the local point on the collider furthest in the direction specified\r\n     * @param direction\r\n     */\r\n    getFurthestLocalPoint(direction) {\r\n        const pts = this.points;\r\n        let furthestPoint = pts[0];\r\n        let maxDistance = -Number.MAX_VALUE;\r\n        for (let i = 0; i < pts.length; i++) {\r\n            const distance = direction.dot(pts[i]);\r\n            if (distance > maxDistance) {\r\n                maxDistance = distance;\r\n                furthestPoint = pts[i];\r\n            }\r\n        }\r\n        return furthestPoint;\r\n    }\r\n    /**\r\n     * Finds the closes face to the point using perpendicular distance\r\n     * @param point point to test against polygon\r\n     */\r\n    getClosestFace(point) {\r\n        const sides = this.getSides();\r\n        let min = Number.POSITIVE_INFINITY;\r\n        let faceIndex = -1;\r\n        let distance = -1;\r\n        for (let i = 0; i < sides.length; i++) {\r\n            const dist = sides[i].distanceToPoint(point);\r\n            if (dist < min) {\r\n                min = dist;\r\n                faceIndex = i;\r\n                distance = dist;\r\n            }\r\n        }\r\n        if (faceIndex !== -1) {\r\n            return {\r\n                distance: sides[faceIndex].normal().scale(distance),\r\n                face: sides[faceIndex]\r\n            };\r\n        }\r\n        return null;\r\n    }\r\n    /**\r\n     * Get the axis aligned bounding box for the polygon collider in world coordinates\r\n     */\r\n    get bounds() {\r\n        return this.localBounds.transform(this._globalMatrix);\r\n    }\r\n    /**\r\n     * Get the axis aligned bounding box for the polygon collider in local coordinates\r\n     */\r\n    get localBounds() {\r\n        if (this._localBoundsDirty) {\r\n            this._localBounds = BoundingBox.fromPoints(this.points);\r\n            this._localBoundsDirty = false;\r\n        }\r\n        return this._localBounds;\r\n    }\r\n    /**\r\n     * Get the moment of inertia for an arbitrary polygon\r\n     * https://en.wikipedia.org/wiki/List_of_moments_of_inertia\r\n     */\r\n    getInertia(mass) {\r\n        if (this._cachedMass === mass && this._cachedInertia) {\r\n            return this._cachedInertia;\r\n        }\r\n        let numerator = 0;\r\n        let denominator = 0;\r\n        const points = this.points;\r\n        for (let i = 0; i < points.length; i++) {\r\n            const iplusone = (i + 1) % points.length;\r\n            const crossTerm = points[iplusone].cross(points[i]);\r\n            numerator +=\r\n                crossTerm *\r\n                    (points[i].dot(points[i]) + points[i].dot(points[iplusone]) + points[iplusone].dot(points[iplusone]));\r\n            denominator += crossTerm;\r\n        }\r\n        this._cachedMass = mass;\r\n        return this._cachedInertia = (mass / 6) * (numerator / denominator);\r\n    }\r\n    /**\r\n     * Casts a ray into the polygon and returns a vector representing the point of contact (in world space) or null if no collision.\r\n     */\r\n    rayCast(ray, max = Infinity) {\r\n        // find the minimum contact time greater than 0\r\n        // contact times less than 0 are behind the ray and we don't want those\r\n        const sides = this.getSides();\r\n        const len = sides.length;\r\n        let minContactTime = Number.MAX_VALUE;\r\n        let contactIndex = -1;\r\n        for (let i = 0; i < len; i++) {\r\n            const contactTime = ray.intersect(sides[i]);\r\n            if (contactTime >= 0 && contactTime < minContactTime && contactTime <= max) {\r\n                minContactTime = contactTime;\r\n                contactIndex = i;\r\n            }\r\n        }\r\n        // contact was found\r\n        if (contactIndex >= 0) {\r\n            return ray.getPoint(minContactTime);\r\n        }\r\n        // no contact found\r\n        return null;\r\n    }\r\n    /**\r\n     * Project the edges of the polygon along a specified axis\r\n     */\r\n    project(axis) {\r\n        const points = this.getTransformedPoints();\r\n        const len = points.length;\r\n        let min = Number.MAX_VALUE;\r\n        let max = -Number.MAX_VALUE;\r\n        for (let i = 0; i < len; i++) {\r\n            const scalar = points[i].dot(axis);\r\n            min = Math.min(min, scalar);\r\n            max = Math.max(max, scalar);\r\n        }\r\n        return new Projection(min, max);\r\n    }\r\n    debug(ex, color) {\r\n        const firstPoint = this.getTransformedPoints()[0];\r\n        const points = [firstPoint, ...this.getTransformedPoints(), firstPoint];\r\n        for (let i = 0; i < points.length - 1; i++) {\r\n            ex.drawLine(points[i], points[i + 1], color, 2);\r\n            ex.drawCircle(points[i], 2, color);\r\n            ex.drawCircle(points[i + 1], 2, color);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Colliders/Shape.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Excalibur helper for defining colliders quickly\r\n */\r\nclass Shape {\r\n    /**\r\n     * Creates a box collider, under the hood defines a [[PolygonCollider]] collider\r\n     * @param width Width of the box\r\n     * @param height Height of the box\r\n     * @param anchor Anchor of the box (default (.5, .5)) which positions the box relative to the center of the collider's position\r\n     * @param offset Optional offset relative to the collider in local coordinates\r\n     */\r\n    static Box(width, height, anchor = Vector.Half, offset = Vector.Zero) {\r\n        return new PolygonCollider({\r\n            points: new BoundingBox(-width * anchor.x, -height * anchor.y, width - width * anchor.x, height - height * anchor.y).getPoints(),\r\n            offset: offset\r\n        });\r\n    }\r\n    /**\r\n     * Creates a new [[PolygonCollider|arbitrary polygon]] collider\r\n     *\r\n     * PolygonColliders are useful for creating convex polygon shapes\r\n     * @param points Points specified in counter clockwise\r\n     * @param offset Optional offset relative to the collider in local coordinates\r\n     */\r\n    static Polygon(points, offset = Vector.Zero) {\r\n        return new PolygonCollider({\r\n            points: points,\r\n            offset: offset\r\n        });\r\n    }\r\n    /**\r\n     * Creates a new [[CircleCollider|circle]] collider\r\n     *\r\n     * Circle colliders are useful for balls, or to make collisions more forgiving on sharp edges\r\n     * @param radius Radius of the circle collider\r\n     * @param offset Optional offset relative to the collider in local coordinates\r\n     */\r\n    static Circle(radius, offset = Vector.Zero) {\r\n        return new CircleCollider({\r\n            radius: radius,\r\n            offset: offset\r\n        });\r\n    }\r\n    /**\r\n     * Creates a new [[EdgeCollider|edge]] collider\r\n     *\r\n     * Edge colliders are useful for  floors, walls, and other barriers\r\n     * @param begin Beginning of the edge in local coordinates to the collider\r\n     * @param end Ending of the edge in local coordinates to the collider\r\n     */\r\n    static Edge(begin, end) {\r\n        return new EdgeCollider({\r\n            begin: begin,\r\n            end: end\r\n        });\r\n    }\r\n    /**\r\n     * Creates a new capsule shaped [[CompositeCollider]] using 2 circles and a box\r\n     *\r\n     * Capsule colliders are useful for platformers with incline or jagged floors to have a smooth\r\n     * player experience.\r\n     *\r\n     * @param width\r\n     * @param height\r\n     * @param offset Optional offset\r\n     */\r\n    static Capsule(width, height, offset = Vector.Zero) {\r\n        const logger = Logger.getInstance();\r\n        if (width === height) {\r\n            logger.warn('A capsule collider with equal width and height is a circle, consider using a ex.Shape.Circle or ex.CircleCollider');\r\n        }\r\n        const vertical = height >= width;\r\n        if (vertical) {\r\n            // height > width, if equal maybe use a circle\r\n            const capsule = new CompositeCollider([\r\n                Shape.Circle(width / 2, vec(0, -height / 2 + width / 2).add(offset)),\r\n                Shape.Box(width, height - width, Vector.Half, offset),\r\n                Shape.Circle(width / 2, vec(0, height / 2 - width / 2).add(offset))\r\n            ]);\r\n            return capsule;\r\n        }\r\n        else {\r\n            // width > height, if equal maybe use a circle\r\n            const capsule = new CompositeCollider([\r\n                Shape.Circle(height / 2, vec(-width / 2 + height / 2, 0).add(offset)),\r\n                Shape.Box(width - height, height, Vector.Half, offset),\r\n                Shape.Circle(height / 2, vec(width / 2 - height / 2, 0).add(offset))\r\n            ]);\r\n            return capsule;\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/ColliderComponent.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass ColliderComponent extends Component {\r\n    constructor(collider) {\r\n        super();\r\n        this.type = 'ex.collider';\r\n        this.events = new EventEmitter();\r\n        /**\r\n         * Observable that notifies when a collider is added to the body\r\n         */\r\n        this.$colliderAdded = new Observable();\r\n        /**\r\n         * Observable that notifies when a collider is removed from the body\r\n         */\r\n        this.$colliderRemoved = new Observable();\r\n        this.set(collider);\r\n    }\r\n    /**\r\n     * Get the current collider geometry\r\n     */\r\n    get() {\r\n        return this._collider;\r\n    }\r\n    /**\r\n     * Set the collider geometry\r\n     * @param collider\r\n     * @returns the collider you set\r\n     */\r\n    set(collider) {\r\n        this.clear();\r\n        if (collider) {\r\n            this._collider = collider;\r\n            this._collider.owner = this.owner;\r\n            collider.events.pipe(this.events);\r\n            this.$colliderAdded.notifyAll(collider);\r\n            this.update();\r\n        }\r\n        return collider;\r\n    }\r\n    /**\r\n     * Remove collider geometry from collider component\r\n     */\r\n    clear() {\r\n        if (this._collider) {\r\n            this._collider.events.unpipe(this.events);\r\n            this.$colliderRemoved.notifyAll(this._collider);\r\n            this._collider.owner = null;\r\n            this._collider = null;\r\n        }\r\n    }\r\n    clone() {\r\n        const clone = new ColliderComponent(this._collider.clone());\r\n        return clone;\r\n    }\r\n    /**\r\n     * Return world space bounds\r\n     */\r\n    get bounds() {\r\n        var _a, _b;\r\n        return (_b = (_a = this._collider) === null || _a === void 0 ? void 0 : _a.bounds) !== null && _b !== void 0 ? _b : new BoundingBox();\r\n    }\r\n    /**\r\n     * Return local space bounds\r\n     */\r\n    get localBounds() {\r\n        var _a, _b;\r\n        return (_b = (_a = this._collider) === null || _a === void 0 ? void 0 : _a.localBounds) !== null && _b !== void 0 ? _b : new BoundingBox();\r\n    }\r\n    /**\r\n     * Update the collider's transformed geometry\r\n     */\r\n    update() {\r\n        var _a;\r\n        const tx = (_a = this.owner) === null || _a === void 0 ? void 0 : _a.get(TransformComponent);\r\n        if (this._collider) {\r\n            this._collider.owner = this.owner;\r\n            if (tx) {\r\n                this._collider.update(tx.get());\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Collide component with another\r\n     * @param other\r\n     */\r\n    collide(other) {\r\n        let colliderA = this._collider;\r\n        let colliderB = other._collider;\r\n        if (!colliderA || !colliderB) {\r\n            return [];\r\n        }\r\n        // If we have a composite lefthand side :(\r\n        // Might bite us, but to avoid updating all the handlers make composite always left side\r\n        let flipped = false;\r\n        if (colliderB instanceof CompositeCollider) {\r\n            colliderA = colliderB;\r\n            colliderB = this._collider;\r\n            flipped = true;\r\n        }\r\n        if (this._collider) {\r\n            const contacts = colliderA.collide(colliderB);\r\n            if (contacts) {\r\n                if (flipped) {\r\n                    contacts.forEach((contact) => {\r\n                        contact.mtv = contact.mtv.negate();\r\n                        contact.normal = contact.normal.negate();\r\n                        contact.tangent = contact.normal.perpendicular();\r\n                        contact.colliderA = this._collider;\r\n                        contact.colliderB = other._collider;\r\n                    });\r\n                }\r\n                return contacts;\r\n            }\r\n            return [];\r\n        }\r\n        return [];\r\n    }\r\n    onAdd(entity) {\r\n        if (this._collider) {\r\n            this.update();\r\n        }\r\n        // Wire up the collider events to the owning entity\r\n        this.events.on('precollision', (evt) => {\r\n            const precollision = evt;\r\n            entity.events.emit('precollision', new PreCollisionEvent(precollision.target.owner, precollision.other.owner, precollision.side, precollision.intersection));\r\n        });\r\n        this.events.on('postcollision', (evt) => {\r\n            const postcollision = evt;\r\n            entity.events.emit('postcollision', new PostCollisionEvent(postcollision.target.owner, postcollision.other.owner, postcollision.side, postcollision.intersection));\r\n        });\r\n        this.events.on('collisionstart', (evt) => {\r\n            const start = evt;\r\n            entity.events.emit('collisionstart', new CollisionStartEvent(start.target.owner, start.other.owner, start.contact));\r\n        });\r\n        this.events.on('collisionend', (evt) => {\r\n            const end = evt;\r\n            entity.events.emit('collisionend', new CollisionEndEvent(end.target.owner, end.other.owner));\r\n        });\r\n    }\r\n    onRemove() {\r\n        this.events.clear();\r\n        this.$colliderRemoved.notifyAll(this._collider);\r\n    }\r\n    /**\r\n     * Sets up a box geometry based on the current bounds of the associated actor of this physics body.\r\n     *\r\n     * If no width/height are specified the body will attempt to use the associated actor's width/height.\r\n     *\r\n     * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.\r\n     */\r\n    useBoxCollider(width, height, anchor = Vector.Half, center = Vector.Zero) {\r\n        const collider = Shape.Box(width, height, anchor, center);\r\n        return (this.set(collider));\r\n    }\r\n    /**\r\n     * Sets up a [[PolygonCollider|polygon]] collision geometry based on a list of of points relative\r\n     *  to the anchor of the associated actor\r\n     * of this physics body.\r\n     *\r\n     * Only [convex polygon](https://en.wikipedia.org/wiki/Convex_polygon) definitions are supported.\r\n     *\r\n     * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.\r\n     */\r\n    usePolygonCollider(points, center = Vector.Zero) {\r\n        const poly = Shape.Polygon(points, center);\r\n        return (this.set(poly));\r\n    }\r\n    /**\r\n     * Sets up a [[Circle|circle collision geometry]] as the only collider with a specified radius in pixels.\r\n     *\r\n     * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.\r\n     */\r\n    useCircleCollider(radius, center = Vector.Zero) {\r\n        const collider = Shape.Circle(radius, center);\r\n        return (this.set(collider));\r\n    }\r\n    /**\r\n     * Sets up an [[Edge|edge collision geometry]] with a start point and an end point relative to the anchor of the associated actor\r\n     * of this physics body.\r\n     *\r\n     * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.\r\n     */\r\n    useEdgeCollider(begin, end) {\r\n        const collider = Shape.Edge(begin, end);\r\n        return (this.set(collider));\r\n    }\r\n    /**\r\n     * Setups up a [[CompositeCollider]] which can define any arbitrary set of excalibur colliders\r\n     * @param colliders\r\n     */\r\n    useCompositeCollider(colliders) {\r\n        return (this.set(new CompositeCollider(colliders)));\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/BodyComponent.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar DegreeOfFreedom;\r\n(function (DegreeOfFreedom) {\r\n    DegreeOfFreedom[\"Rotation\"] = \"rotation\";\r\n    DegreeOfFreedom[\"X\"] = \"x\";\r\n    DegreeOfFreedom[\"Y\"] = \"y\";\r\n})(DegreeOfFreedom || (DegreeOfFreedom = {}));\r\n/**\r\n * Body describes all the physical properties pos, vel, acc, rotation, angular velocity for the purpose of\r\n * of physics simulation.\r\n */\r\nclass BodyComponent extends Component {\r\n    constructor(options) {\r\n        var _a, _b, _c;\r\n        super();\r\n        this.type = 'ex.body';\r\n        this.dependencies = [TransformComponent, MotionComponent];\r\n        this.id = createId('body', BodyComponent._ID++);\r\n        this.events = new EventEmitter();\r\n        this._oldTransform = new Transform();\r\n        /**\r\n         * Indicates whether the old transform has been captured at least once for interpolation\r\n         * @internal\r\n         */\r\n        this.__oldTransformCaptured = false;\r\n        /**\r\n         * Enable or disabled the fixed update interpolation, by default interpolation is on.\r\n         */\r\n        this.enableFixedUpdateInterpolate = true;\r\n        /**\r\n         * Collision type for the rigidbody physics simulation, by default [[CollisionType.PreventCollision]]\r\n         */\r\n        this.collisionType = CollisionType.PreventCollision;\r\n        /**\r\n         * The collision group for the body's colliders, by default body colliders collide with everything\r\n         */\r\n        this.group = CollisionGroup.All;\r\n        /**\r\n         * The amount of mass the body has\r\n         */\r\n        this._mass = Physics.defaultMass;\r\n        /**\r\n         * Amount of \"motion\" the body has before sleeping. If below [[Physics.sleepEpsilon]] it goes to \"sleep\"\r\n         */\r\n        this.sleepMotion = Physics.sleepEpsilon * 5;\r\n        /**\r\n         * Can this body sleep, by default bodies do not sleep\r\n         */\r\n        this.canSleep = Physics.bodiesCanSleepByDefault;\r\n        this._sleeping = false;\r\n        /**\r\n         * The also known as coefficient of restitution of this actor, represents the amount of energy preserved after collision or the\r\n         * bounciness. If 1, it is 100% bouncy, 0 it completely absorbs.\r\n         */\r\n        this.bounciness = 0.2;\r\n        /**\r\n         * The coefficient of friction on this actor\r\n         */\r\n        this.friction = 0.99;\r\n        /**\r\n         * Should use global gravity [[Physics.gravity]] in it's physics simulation, default is true\r\n         */\r\n        this.useGravity = true;\r\n        /**\r\n         * Degrees of freedom to limit\r\n         *\r\n         * Note: this only limits responses in the realistic solver, if velocity/angularVelocity is set the actor will still respond\r\n         */\r\n        this.limitDegreeOfFreedom = [];\r\n        /**\r\n         * The velocity of the actor last frame (vx, vy) in pixels/second\r\n         */\r\n        this.oldVel = new Vector(0, 0);\r\n        /**\r\n         * Gets/sets the acceleration of the actor from the last frame. This does not include the global acc [[Physics.acc]].\r\n         */\r\n        this.oldAcc = Vector.Zero;\r\n        if (options) {\r\n            this.collisionType = (_a = options.type) !== null && _a !== void 0 ? _a : this.collisionType;\r\n            this.group = (_b = options.group) !== null && _b !== void 0 ? _b : this.group;\r\n            this.useGravity = (_c = options.useGravity) !== null && _c !== void 0 ? _c : this.useGravity;\r\n        }\r\n    }\r\n    get matrix() {\r\n        return this.transform.get().matrix;\r\n    }\r\n    get mass() {\r\n        return this._mass;\r\n    }\r\n    set mass(newMass) {\r\n        this._mass = newMass;\r\n        this._cachedInertia = undefined;\r\n        this._cachedInverseInertia = undefined;\r\n    }\r\n    /**\r\n     * The inverse mass (1/mass) of the body. If [[CollisionType.Fixed]] this is 0, meaning \"infinite\" mass\r\n     */\r\n    get inverseMass() {\r\n        return this.collisionType === CollisionType.Fixed ? 0 : 1 / this.mass;\r\n    }\r\n    /**\r\n     * Whether this body is sleeping or not\r\n     */\r\n    get sleeping() {\r\n        return this._sleeping;\r\n    }\r\n    /**\r\n     * Set the sleep state of the body\r\n     * @param sleeping\r\n     */\r\n    setSleeping(sleeping) {\r\n        this._sleeping = sleeping;\r\n        if (!sleeping) {\r\n            // Give it a kick to keep it from falling asleep immediately\r\n            this.sleepMotion = Physics.sleepEpsilon * 5;\r\n        }\r\n        else {\r\n            this.vel = Vector.Zero;\r\n            this.acc = Vector.Zero;\r\n            this.angularVelocity = 0;\r\n            this.sleepMotion = 0;\r\n        }\r\n    }\r\n    /**\r\n     * Update body's [[BodyComponent.sleepMotion]] for the purpose of sleeping\r\n     */\r\n    updateMotion() {\r\n        if (this._sleeping) {\r\n            this.setSleeping(true);\r\n        }\r\n        const currentMotion = this.vel.size * this.vel.size + Math.abs(this.angularVelocity * this.angularVelocity);\r\n        const bias = Physics.sleepBias;\r\n        this.sleepMotion = bias * this.sleepMotion + (1 - bias) * currentMotion;\r\n        this.sleepMotion = clamp(this.sleepMotion, 0, 10 * Physics.sleepEpsilon);\r\n        if (this.canSleep && this.sleepMotion < Physics.sleepEpsilon) {\r\n            this.setSleeping(true);\r\n        }\r\n    }\r\n    /**\r\n     * Get the moment of inertia from the [[ColliderComponent]]\r\n     */\r\n    get inertia() {\r\n        if (this._cachedInertia) {\r\n            return this._cachedInertia;\r\n        }\r\n        // Inertia is a property of the geometry, so this is a little goofy but seems to be okay?\r\n        const collider = this.owner.get(ColliderComponent);\r\n        if (collider) {\r\n            collider.$colliderAdded.subscribe(() => {\r\n                this._cachedInertia = null;\r\n            });\r\n            collider.$colliderRemoved.subscribe(() => {\r\n                this._cachedInertia = null;\r\n            });\r\n            const maybeCollider = collider.get();\r\n            if (maybeCollider) {\r\n                return this._cachedInertia = maybeCollider.getInertia(this.mass);\r\n            }\r\n        }\r\n        return 0;\r\n    }\r\n    /**\r\n     * Get the inverse moment of inertial from the [[ColliderComponent]]. If [[CollisionType.Fixed]] this is 0, meaning \"infinite\" mass\r\n     */\r\n    get inverseInertia() {\r\n        if (this._cachedInverseInertia) {\r\n            return this._cachedInverseInertia;\r\n        }\r\n        return this._cachedInverseInertia = this.collisionType === CollisionType.Fixed ? 0 : 1 / this.inertia;\r\n    }\r\n    /**\r\n     * Returns if the owner is active\r\n     */\r\n    get active() {\r\n        var _a;\r\n        return !!((_a = this.owner) === null || _a === void 0 ? void 0 : _a.active);\r\n    }\r\n    /**\r\n     * @deprecated Use globalP0s\r\n     */\r\n    get center() {\r\n        return this.globalPos;\r\n    }\r\n    get transform() {\r\n        var _a;\r\n        return (_a = this.owner) === null || _a === void 0 ? void 0 : _a.get(TransformComponent);\r\n    }\r\n    get motion() {\r\n        var _a;\r\n        return (_a = this.owner) === null || _a === void 0 ? void 0 : _a.get(MotionComponent);\r\n    }\r\n    get pos() {\r\n        return this.transform.pos;\r\n    }\r\n    set pos(val) {\r\n        this.transform.pos = val;\r\n    }\r\n    /**\r\n     * The (x, y) position of the actor this will be in the middle of the actor if the\r\n     * [[Actor.anchor]] is set to (0.5, 0.5) which is default.\r\n     * If you want the (x, y) position to be the top left of the actor specify an anchor of (0, 0).\r\n     */\r\n    get globalPos() {\r\n        return this.transform.globalPos;\r\n    }\r\n    set globalPos(val) {\r\n        this.transform.globalPos = val;\r\n    }\r\n    /**\r\n     * The position of the actor last frame (x, y) in pixels\r\n     */\r\n    get oldPos() {\r\n        return this._oldTransform.pos;\r\n    }\r\n    /**\r\n     * The current velocity vector (vx, vy) of the actor in pixels/second\r\n     */\r\n    get vel() {\r\n        return this.motion.vel;\r\n    }\r\n    set vel(val) {\r\n        this.motion.vel = val;\r\n    }\r\n    /**\r\n     * The current acceleration vector (ax, ay) of the actor in pixels/second/second. An acceleration pointing down such as (0, 100) may\r\n     * be useful to simulate a gravitational effect.\r\n     */\r\n    get acc() {\r\n        return this.motion.acc;\r\n    }\r\n    set acc(val) {\r\n        this.motion.acc = val;\r\n    }\r\n    /**\r\n     * The current torque applied to the actor\r\n     */\r\n    get torque() {\r\n        return this.motion.torque;\r\n    }\r\n    set torque(val) {\r\n        this.motion.torque = val;\r\n    }\r\n    /**\r\n     * Gets/sets the rotation of the body from the last frame.\r\n     */\r\n    get oldRotation() {\r\n        return this._oldTransform.rotation;\r\n    }\r\n    /**\r\n     * The rotation of the body in radians\r\n     */\r\n    get rotation() {\r\n        return this.transform.globalRotation;\r\n    }\r\n    set rotation(val) {\r\n        this.transform.globalRotation = val;\r\n    }\r\n    /**\r\n     * The scale vector of the actor\r\n     */\r\n    get scale() {\r\n        return this.transform.globalScale;\r\n    }\r\n    set scale(val) {\r\n        this.transform.globalScale = val;\r\n    }\r\n    /**\r\n     * The scale of the actor last frame\r\n     */\r\n    get oldScale() {\r\n        return this._oldTransform.scale;\r\n    }\r\n    /**\r\n     * The scale rate of change of the actor in scale/second\r\n     */\r\n    get scaleFactor() {\r\n        return this.motion.scaleFactor;\r\n    }\r\n    set scaleFactor(scaleFactor) {\r\n        this.motion.scaleFactor = scaleFactor;\r\n    }\r\n    /**\r\n     * Get the angular velocity in radians/second\r\n     */\r\n    get angularVelocity() {\r\n        return this.motion.angularVelocity;\r\n    }\r\n    /**\r\n     * Set the angular velocity in radians/second\r\n     */\r\n    set angularVelocity(value) {\r\n        this.motion.angularVelocity = value;\r\n    }\r\n    /**\r\n     * Apply a specific impulse to the body\r\n     * @param point\r\n     * @param impulse\r\n     */\r\n    applyImpulse(point, impulse) {\r\n        if (this.collisionType !== CollisionType.Active) {\r\n            return; // only active objects participate in the simulation\r\n        }\r\n        const finalImpulse = impulse.scale(this.inverseMass);\r\n        if (this.limitDegreeOfFreedom.includes(DegreeOfFreedom.X)) {\r\n            finalImpulse.x = 0;\r\n        }\r\n        if (this.limitDegreeOfFreedom.includes(DegreeOfFreedom.Y)) {\r\n            finalImpulse.y = 0;\r\n        }\r\n        this.vel.addEqual(finalImpulse);\r\n        if (!this.limitDegreeOfFreedom.includes(DegreeOfFreedom.Rotation)) {\r\n            const distanceFromCenter = point.sub(this.globalPos);\r\n            this.angularVelocity += this.inverseInertia * distanceFromCenter.cross(impulse);\r\n        }\r\n    }\r\n    /**\r\n     * Apply only linear impulse to the body\r\n     * @param impulse\r\n     */\r\n    applyLinearImpulse(impulse) {\r\n        if (this.collisionType !== CollisionType.Active) {\r\n            return; // only active objects participate in the simulation\r\n        }\r\n        const finalImpulse = impulse.scale(this.inverseMass);\r\n        if (this.limitDegreeOfFreedom.includes(DegreeOfFreedom.X)) {\r\n            finalImpulse.x = 0;\r\n        }\r\n        if (this.limitDegreeOfFreedom.includes(DegreeOfFreedom.Y)) {\r\n            finalImpulse.y = 0;\r\n        }\r\n        this.vel = this.vel.add(finalImpulse);\r\n    }\r\n    /**\r\n     * Apply only angular impulse to the body\r\n     * @param point\r\n     * @param impulse\r\n     */\r\n    applyAngularImpulse(point, impulse) {\r\n        if (this.collisionType !== CollisionType.Active) {\r\n            return; // only active objects participate in the simulation\r\n        }\r\n        if (!this.limitDegreeOfFreedom.includes(DegreeOfFreedom.Rotation)) {\r\n            const distanceFromCenter = point.sub(this.globalPos);\r\n            this.angularVelocity += this.inverseInertia * distanceFromCenter.cross(impulse);\r\n        }\r\n    }\r\n    /**\r\n     * Sets the old versions of pos, vel, acc, and scale.\r\n     */\r\n    captureOldTransform() {\r\n        // Capture old values before integration step updates them\r\n        this.__oldTransformCaptured = true;\r\n        this.transform.get().clone(this._oldTransform);\r\n        this.oldVel.setTo(this.vel.x, this.vel.y);\r\n        this.oldAcc.setTo(this.acc.x, this.acc.y);\r\n    }\r\n    clone() {\r\n        const component = super.clone();\r\n        return component;\r\n    }\r\n}\r\nBodyComponent._ID = 0;\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/Entity.ts\n\r\n\r\n\r\n\r\n/**\r\n * AddedComponent message\r\n */\r\nclass AddedComponent {\r\n    constructor(data) {\r\n        this.data = data;\r\n        this.type = 'Component Added';\r\n    }\r\n}\r\n/**\r\n * Type guard to know if message is f an Added Component\r\n */\r\nfunction isAddedComponent(x) {\r\n    return !!x && x.type === 'Component Added';\r\n}\r\n/**\r\n * RemovedComponent message\r\n */\r\nclass RemovedComponent {\r\n    constructor(data) {\r\n        this.data = data;\r\n        this.type = 'Component Removed';\r\n    }\r\n}\r\n/**\r\n * Type guard to know if message is for a Removed Component\r\n */\r\nfunction isRemovedComponent(x) {\r\n    return !!x && x.type === 'Component Removed';\r\n}\r\nconst EntityEvents = {\r\n    Initialize: 'initialize',\r\n    PreUpdate: 'preupdate',\r\n    PostUpdate: 'postupdate'\r\n};\r\n/**\r\n * An Entity is the base type of anything that can have behavior in Excalibur, they are part of the built in entity component system\r\n *\r\n * Entities can be strongly typed with the components they contain\r\n *\r\n * ```typescript\r\n * const entity = new Entity<ComponentA | ComponentB>();\r\n * entity.components.a; // Type ComponentA\r\n * entity.components.b; // Type ComponentB\r\n * ```\r\n */\r\nclass Entity {\r\n    constructor(components, name) {\r\n        /**\r\n         * Listen to or emit events for an entity\r\n         */\r\n        this.events = new EventEmitter();\r\n        /**\r\n         * The unique identifier for the entity\r\n         */\r\n        this.id = Entity._ID++;\r\n        /**\r\n         * The scene that the entity is in, if any\r\n         */\r\n        this.scene = null;\r\n        this._name = 'anonymous';\r\n        /**\r\n         * Whether this entity is active, if set to false it will be reclaimed\r\n         */\r\n        this.active = true;\r\n        /**\r\n         * Bucket to hold on to deferred removals\r\n         */\r\n        this._componentsToRemove = [];\r\n        this._componentTypeToInstance = new Map();\r\n        this._componentStringToInstance = new Map();\r\n        this._tagsMemo = [];\r\n        this._typesMemo = [];\r\n        /**\r\n         * Observable that keeps track of component add or remove changes on the entity\r\n         */\r\n        this.componentAdded$ = new Observable();\r\n        this.componentRemoved$ = new Observable();\r\n        this._parent = null;\r\n        this.childrenAdded$ = new Observable();\r\n        this.childrenRemoved$ = new Observable();\r\n        this._children = [];\r\n        this._isInitialized = false;\r\n        this._setName(name);\r\n        if (components) {\r\n            for (const component of components) {\r\n                this.addComponent(component);\r\n            }\r\n        }\r\n    }\r\n    _setName(name) {\r\n        if (name) {\r\n            this._name = name;\r\n        }\r\n    }\r\n    get name() {\r\n        return this._name;\r\n    }\r\n    /**\r\n     * Kill the entity, means it will no longer be updated. Kills are deferred to the end of the update.\r\n     * If parented it will be removed from the parent when killed.\r\n     */\r\n    kill() {\r\n        if (this.active) {\r\n            this.active = false;\r\n            this.unparent();\r\n        }\r\n    }\r\n    isKilled() {\r\n        return !this.active;\r\n    }\r\n    /**\r\n     * Specifically get the tags on the entity from [[TagComponent]]\r\n     */\r\n    get tags() {\r\n        return this._tagsMemo;\r\n    }\r\n    /**\r\n     * Check if a tag exists on the entity\r\n     * @param tag name to check for\r\n     */\r\n    hasTag(tag) {\r\n        return this.tags.includes(tag);\r\n    }\r\n    /**\r\n     * Adds a tag to an entity\r\n     * @param tag\r\n     * @returns Entity\r\n     */\r\n    addTag(tag) {\r\n        return this.addComponent(new TagComponent(tag));\r\n    }\r\n    /**\r\n     * Removes a tag on the entity\r\n     *\r\n     * Removals are deferred until the end of update\r\n     * @param tag\r\n     * @param force Remove component immediately, no deferred\r\n     */\r\n    removeTag(tag, force = false) {\r\n        return this.removeComponent(tag, force);\r\n    }\r\n    /**\r\n     * The types of the components on the Entity\r\n     */\r\n    get types() {\r\n        return this._typesMemo;\r\n    }\r\n    _rebuildMemos() {\r\n        this._tagsMemo = Array.from(this._componentStringToInstance.values())\r\n            .filter((c) => c instanceof TagComponent)\r\n            .map((c) => c.type);\r\n        this._typesMemo = Array.from(this._componentStringToInstance.keys());\r\n    }\r\n    getComponents() {\r\n        return Array.from(this._componentStringToInstance.values());\r\n    }\r\n    _notifyAddComponent(component) {\r\n        this._rebuildMemos();\r\n        const added = new AddedComponent({\r\n            component,\r\n            entity: this\r\n        });\r\n        this.componentAdded$.notifyAll(added);\r\n    }\r\n    _notifyRemoveComponent(component) {\r\n        const removed = new RemovedComponent({\r\n            component,\r\n            entity: this\r\n        });\r\n        this.componentRemoved$.notifyAll(removed);\r\n        this._rebuildMemos();\r\n    }\r\n    get parent() {\r\n        return this._parent;\r\n    }\r\n    /**\r\n     * Get the direct children of this entity\r\n     */\r\n    get children() {\r\n        return this._children;\r\n    }\r\n    /**\r\n     * Unparents this entity, if there is a parent. Otherwise it does nothing.\r\n     */\r\n    unparent() {\r\n        if (this._parent) {\r\n            this._parent.removeChild(this);\r\n            this._parent = null;\r\n        }\r\n    }\r\n    /**\r\n     * Adds an entity to be a child of this entity\r\n     * @param entity\r\n     */\r\n    addChild(entity) {\r\n        if (entity.parent === null) {\r\n            if (this.getAncestors().includes(entity)) {\r\n                throw new Error('Cycle detected, cannot add entity');\r\n            }\r\n            this._children.push(entity);\r\n            entity._parent = this;\r\n            this.childrenAdded$.notifyAll(entity);\r\n        }\r\n        else {\r\n            throw new Error('Entity already has a parent, cannot add without unparenting');\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Remove an entity from children if it exists\r\n     * @param entity\r\n     */\r\n    removeChild(entity) {\r\n        if (entity.parent === this) {\r\n            removeItemFromArray(entity, this._children);\r\n            entity._parent = null;\r\n            this.childrenRemoved$.notifyAll(entity);\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Removes all children from this entity\r\n     */\r\n    removeAllChildren() {\r\n        // Avoid modifying the array issue by walking backwards\r\n        for (let i = this.children.length - 1; i >= 0; i--) {\r\n            this.removeChild(this.children[i]);\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Returns a list of parent entities starting with the topmost parent. Includes the current entity.\r\n     */\r\n    getAncestors() {\r\n        const result = [this];\r\n        let current = this.parent;\r\n        while (current) {\r\n            result.push(current);\r\n            current = current.parent;\r\n        }\r\n        return result.reverse();\r\n    }\r\n    /**\r\n     * Returns a list of all the entities that descend from this entity. Includes the current entity.\r\n     */\r\n    getDescendants() {\r\n        let result = [this];\r\n        let queue = [this];\r\n        while (queue.length > 0) {\r\n            const curr = queue.pop();\r\n            queue = queue.concat(curr.children);\r\n            result = result.concat(curr.children);\r\n        }\r\n        return result;\r\n    }\r\n    /**\r\n     * Creates a deep copy of the entity and a copy of all its components\r\n     */\r\n    clone() {\r\n        const newEntity = new Entity();\r\n        for (const c of this.types) {\r\n            newEntity.addComponent(this.get(c).clone());\r\n        }\r\n        for (const child of this.children) {\r\n            newEntity.addChild(child.clone());\r\n        }\r\n        return newEntity;\r\n    }\r\n    /**\r\n     * Adds a copy of all the components from another template entity as a \"prefab\"\r\n     * @param templateEntity Entity to use as a template\r\n     * @param force Force component replacement if it already exists on the target entity\r\n     */\r\n    addTemplate(templateEntity, force = false) {\r\n        for (const c of templateEntity.getComponents()) {\r\n            this.addComponent(c.clone(), force);\r\n        }\r\n        for (const child of templateEntity.children) {\r\n            this.addChild(child.clone().addTemplate(child));\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Adds a component to the entity\r\n     * @param component Component or Entity to add copy of components from\r\n     * @param force Optionally overwrite any existing components of the same type\r\n     */\r\n    addComponent(component, force = false) {\r\n        // if component already exists, skip if not forced\r\n        if (this.has(component.type)) {\r\n            if (force) {\r\n                // Remove existing component type if exists when forced\r\n                this.removeComponent(component, true);\r\n            }\r\n            else {\r\n                // early exit component exits\r\n                return this;\r\n            }\r\n        }\r\n        // TODO circular dependencies will be a problem\r\n        if (component.dependencies && component.dependencies.length) {\r\n            for (const ctor of component.dependencies) {\r\n                this.addComponent(new ctor());\r\n            }\r\n        }\r\n        component.owner = this;\r\n        const constuctorType = component.constructor;\r\n        this._componentTypeToInstance.set(constuctorType, component);\r\n        this._componentStringToInstance.set(component.type, component);\r\n        if (component.onAdd) {\r\n            component.onAdd(this);\r\n        }\r\n        this._notifyAddComponent(component);\r\n        return this;\r\n    }\r\n    /**\r\n     * Removes a component from the entity, by default removals are deferred to the end of entity update to avoid consistency issues\r\n     *\r\n     * Components can be force removed with the `force` flag, the removal is not deferred and happens immediately\r\n     * @param componentOrType\r\n     * @param force\r\n     */\r\n    removeComponent(componentOrType, force = false) {\r\n        if (force) {\r\n            if (typeof componentOrType === 'string') {\r\n                this._removeComponentByType(componentOrType);\r\n            }\r\n            else if (componentOrType instanceof Component) {\r\n                this._removeComponentByType(componentOrType.type);\r\n            }\r\n        }\r\n        else {\r\n            this._componentsToRemove.push(componentOrType);\r\n        }\r\n        return this;\r\n    }\r\n    clearComponents() {\r\n        const components = this.getComponents();\r\n        for (const c of components) {\r\n            this.removeComponent(c);\r\n        }\r\n    }\r\n    _removeComponentByType(type) {\r\n        if (this.has(type)) {\r\n            const component = this.get(type);\r\n            component.owner = null;\r\n            if (component.onRemove) {\r\n                component.onRemove(this);\r\n            }\r\n            const ctor = component.constructor;\r\n            this._componentTypeToInstance.delete(ctor);\r\n            this._componentStringToInstance.delete(component.type);\r\n            this._notifyRemoveComponent(component);\r\n        }\r\n    }\r\n    /**\r\n     * @hidden\r\n     * @internal\r\n     */\r\n    processComponentRemoval() {\r\n        for (const componentOrType of this._componentsToRemove) {\r\n            const type = typeof componentOrType === 'string' ? componentOrType : componentOrType.type;\r\n            this._removeComponentByType(type);\r\n        }\r\n        this._componentsToRemove.length = 0;\r\n    }\r\n    has(type) {\r\n        if (typeof type === 'string') {\r\n            return this._componentStringToInstance.has(type);\r\n        }\r\n        else {\r\n            return this._componentTypeToInstance.has(type);\r\n        }\r\n    }\r\n    get(type) {\r\n        if (typeof type === 'string') {\r\n            return this._componentStringToInstance.get(type);\r\n        }\r\n        else {\r\n            return this._componentTypeToInstance.get(type);\r\n        }\r\n    }\r\n    /**\r\n     * Gets whether the actor is Initialized\r\n     */\r\n    get isInitialized() {\r\n        return this._isInitialized;\r\n    }\r\n    /**\r\n     * Initializes this entity, meant to be called by the Scene before first update not by users of Excalibur.\r\n     *\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * @internal\r\n     */\r\n    _initialize(engine) {\r\n        if (!this.isInitialized) {\r\n            this.onInitialize(engine);\r\n            this.events.emit('initialize', new InitializeEvent(engine, this));\r\n            this._isInitialized = true;\r\n        }\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPreUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _preupdate(engine, delta) {\r\n        this.events.emit('preupdate', new PreUpdateEvent(engine, delta, this));\r\n        this.onPreUpdate(engine, delta);\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPostUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _postupdate(engine, delta) {\r\n        this.events.emit('postupdate', new PostUpdateEvent(engine, delta, this));\r\n        this.onPostUpdate(engine, delta);\r\n    }\r\n    /**\r\n     * `onInitialize` is called before the first update of the entity. This method is meant to be\r\n     * overridden.\r\n     *\r\n     * Synonymous with the event handler `.on('initialize', (evt) => {...})`\r\n     */\r\n    onInitialize(_engine) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * Safe to override onPreUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPreUpdate` is called directly before an entity is updated.\r\n     */\r\n    onPreUpdate(_engine, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('postupdate', (evt) =>{...})`\r\n     *\r\n     * `onPostUpdate` is called directly after an entity is updated.\r\n     */\r\n    onPostUpdate(_engine, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     *\r\n     * Entity update lifecycle, called internally\r\n     *\r\n     * @internal\r\n     * @param engine\r\n     * @param delta\r\n     */\r\n    update(engine, delta) {\r\n        this._initialize(engine);\r\n        this._preupdate(engine, delta);\r\n        for (const child of this.children) {\r\n            child.update(engine, delta);\r\n        }\r\n        this._postupdate(engine, delta);\r\n    }\r\n    emit(eventName, event) {\r\n        this.events.emit(eventName, event);\r\n    }\r\n    on(eventName, handler) {\r\n        return this.events.on(eventName, handler);\r\n    }\r\n    once(eventName, handler) {\r\n        return this.events.once(eventName, handler);\r\n    }\r\n    off(eventName, handler) {\r\n        this.events.off(eventName, handler);\r\n    }\r\n}\r\nEntity._ID = 0;\r\n\n;// CONCATENATED MODULE: ./Graphics/GraphicsComponent.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Type guard for checking if a Graphic HasTick (used for graphics that change over time like animations)\r\n * @param graphic\r\n */\r\nfunction hasGraphicsTick(graphic) {\r\n    return !!graphic.tick;\r\n}\r\nclass GraphicsLayer {\r\n    constructor(_options, _graphics) {\r\n        this._options = _options;\r\n        this._graphics = _graphics;\r\n        this.graphics = [];\r\n    }\r\n    get name() {\r\n        return this._options.name;\r\n    }\r\n    hide(nameOrGraphic) {\r\n        if (!nameOrGraphic) {\r\n            this.graphics.length = 0;\r\n        }\r\n        else {\r\n            let gfx = null;\r\n            if (nameOrGraphic instanceof Graphic) {\r\n                gfx = nameOrGraphic;\r\n            }\r\n            else {\r\n                gfx = this._graphics.getGraphic(nameOrGraphic);\r\n            }\r\n            this.graphics = this.graphics.filter((g) => g.graphic !== gfx);\r\n            this._graphics.recalculateBounds();\r\n        }\r\n    }\r\n    /**\r\n     * Show a graphic by name or instance at an offset, graphics are shown in the order in which `show()` is called.\r\n     *\r\n     * If `show()` is called multiple times for the same graphic it will be shown multiple times.\r\n     * @param nameOrGraphic\r\n     * @param options\r\n     */\r\n    show(nameOrGraphic, options) {\r\n        options = { ...options };\r\n        let gfx;\r\n        if (nameOrGraphic instanceof Graphic) {\r\n            gfx = this._graphics.copyGraphics ? nameOrGraphic.clone() : nameOrGraphic;\r\n        }\r\n        else {\r\n            gfx = this._graphics.getGraphic(nameOrGraphic);\r\n            if (!gfx) {\r\n                Logger.getInstance().error(`No such graphic added to component named ${nameOrGraphic}. These named graphics are available: `, this._graphics.getNames());\r\n            }\r\n        }\r\n        if (gfx) {\r\n            this.graphics.push({ graphic: gfx, options });\r\n            this._graphics.recalculateBounds();\r\n            return gfx;\r\n        }\r\n        else {\r\n            return null;\r\n        }\r\n    }\r\n    /**\r\n     * Use a specific graphic, swap out any current graphics being shown\r\n     * @param nameOrGraphic\r\n     * @param options\r\n     */\r\n    use(nameOrGraphic, options) {\r\n        options = { ...options };\r\n        this.hide();\r\n        return this.show(nameOrGraphic, options);\r\n    }\r\n    /**\r\n     * Current order of the layer, higher numbers are on top, lower numbers are on the bottom.\r\n     *\r\n     * For example a layer with `order = -1` would be under a layer of `order = 1`\r\n     */\r\n    get order() {\r\n        return this._options.order;\r\n    }\r\n    /**\r\n     * Set the order of the layer, higher numbers are on top, lower numbers are on the bottom.\r\n     *\r\n     * For example a layer with `order = -1` would be under a layer of `order = 1`\r\n     */\r\n    set order(order) {\r\n        this._options.order = order;\r\n    }\r\n    /**\r\n     * Get or set the pixel offset from the layer anchor for all graphics in the layer\r\n     */\r\n    get offset() {\r\n        var _a;\r\n        return (_a = this._options.offset) !== null && _a !== void 0 ? _a : Vector.Zero;\r\n    }\r\n    set offset(value) {\r\n        this._options.offset = value;\r\n    }\r\n    get currentKeys() {\r\n        var _a;\r\n        return (_a = this.name) !== null && _a !== void 0 ? _a : 'anonymous';\r\n    }\r\n    clone(graphicsComponent) {\r\n        const layer = new GraphicsLayer({ ...this._options }, graphicsComponent);\r\n        layer.graphics = [...this.graphics.map(g => ({ graphic: g.graphic.clone(), options: { ...g.options } }))];\r\n        return layer;\r\n    }\r\n}\r\nclass GraphicsLayers {\r\n    constructor(_component) {\r\n        this._component = _component;\r\n        this._layers = [];\r\n        this._layerMap = {};\r\n        this.default = new GraphicsLayer({ name: 'default', order: 0 }, _component);\r\n        this._maybeAddLayer(this.default);\r\n    }\r\n    create(options) {\r\n        const layer = new GraphicsLayer(options, this._component);\r\n        return this._maybeAddLayer(layer);\r\n    }\r\n    get(name) {\r\n        if (name) {\r\n            return this._getLayer(name);\r\n        }\r\n        return this._layers;\r\n    }\r\n    currentKeys() {\r\n        const graphicsLayerKeys = [];\r\n        for (const layer of this._layers) {\r\n            graphicsLayerKeys.push(layer.currentKeys);\r\n        }\r\n        return graphicsLayerKeys;\r\n    }\r\n    has(name) {\r\n        return name in this._layerMap;\r\n    }\r\n    _maybeAddLayer(layer) {\r\n        if (this._layerMap[layer.name]) {\r\n            // todo log warning\r\n            return this._layerMap[layer.name];\r\n        }\r\n        this._layerMap[layer.name] = layer;\r\n        this._layers.push(layer);\r\n        this._layers.sort((a, b) => a.order - b.order);\r\n        return layer;\r\n    }\r\n    _getLayer(name) {\r\n        return this._layerMap[name];\r\n    }\r\n    clone(graphicsComponent) {\r\n        const layers = new GraphicsLayers(graphicsComponent);\r\n        layers._layerMap = {};\r\n        layers._layers = [];\r\n        layers.default = this.default.clone(graphicsComponent);\r\n        layers._maybeAddLayer(layers.default);\r\n        // Remove the default layer out of the clone\r\n        const clonedLayers = this._layers.filter(l => l.name !== 'default').map(l => l.clone(graphicsComponent));\r\n        clonedLayers.forEach(layer => layers._maybeAddLayer(layer));\r\n        return layers;\r\n    }\r\n}\r\n/**\r\n * Component to manage drawings, using with the position component\r\n */\r\nclass GraphicsComponent extends Component {\r\n    getGraphic(name) {\r\n        return this._graphics[name];\r\n    }\r\n    /**\r\n     * Get registered graphics names\r\n     */\r\n    getNames() {\r\n        return Object.keys(this._graphics);\r\n    }\r\n    constructor(options) {\r\n        super();\r\n        this.type = 'ex.graphics';\r\n        this._graphics = {};\r\n        /**\r\n         * Sets or gets wether any drawing should be visible in this component\r\n         */\r\n        this.visible = true;\r\n        /**\r\n         * Sets or gets wither all drawings should have an opacity applied\r\n         */\r\n        this.opacity = 1;\r\n        /**\r\n         * Offset to apply to graphics by default\r\n         */\r\n        this.offset = Vector.Zero;\r\n        /**\r\n         * Anchor to apply to graphics by default\r\n         */\r\n        this.anchor = Vector.Half;\r\n        /**\r\n         * Flip all graphics horizontally along the y-axis\r\n         */\r\n        this.flipHorizontal = false;\r\n        /**\r\n         * Flip all graphics vertically along the x-axis\r\n         */\r\n        this.flipVertical = false;\r\n        /**\r\n         * If set to true graphics added to the component will be copied. This can affect performance\r\n         */\r\n        this.copyGraphics = false;\r\n        this._localBounds = null;\r\n        // Defaults\r\n        options = {\r\n            visible: this.visible,\r\n            ...options\r\n        };\r\n        const { current, anchor, opacity, visible, graphics, offset, copyGraphics, onPreDraw, onPostDraw } = options;\r\n        this._graphics = graphics || {};\r\n        this.offset = offset !== null && offset !== void 0 ? offset : this.offset;\r\n        this.opacity = opacity !== null && opacity !== void 0 ? opacity : this.opacity;\r\n        this.anchor = anchor !== null && anchor !== void 0 ? anchor : this.anchor;\r\n        this.copyGraphics = copyGraphics !== null && copyGraphics !== void 0 ? copyGraphics : this.copyGraphics;\r\n        this.onPreDraw = onPreDraw !== null && onPreDraw !== void 0 ? onPreDraw : this.onPreDraw;\r\n        this.onPostDraw = onPostDraw !== null && onPostDraw !== void 0 ? onPostDraw : this.onPostDraw;\r\n        this.visible = !!visible;\r\n        this.layers = new GraphicsLayers(this);\r\n        if (current && this._graphics[current]) {\r\n            this.show(this._graphics[current]);\r\n        }\r\n    }\r\n    /**\r\n     * Returns the currently displayed graphics and their offsets, empty array if hidden\r\n     */\r\n    get current() {\r\n        return this.layers.default.graphics;\r\n    }\r\n    /**\r\n     * Returns all graphics associated with this component\r\n     */\r\n    get graphics() {\r\n        return this._graphics;\r\n    }\r\n    add(nameOrGraphic, graphic) {\r\n        let name = 'default';\r\n        let graphicToSet = null;\r\n        if (typeof nameOrGraphic === 'string') {\r\n            name = nameOrGraphic;\r\n            graphicToSet = graphic;\r\n        }\r\n        else {\r\n            graphicToSet = nameOrGraphic;\r\n        }\r\n        this._graphics[name] = this.copyGraphics ? graphicToSet.clone() : graphicToSet;\r\n        if (name === 'default') {\r\n            this.show('default');\r\n        }\r\n        return graphicToSet;\r\n    }\r\n    /**\r\n     * Show a graphic by name on the **default** layer, returns the new [[Graphic]]\r\n     */\r\n    show(nameOrGraphic, options) {\r\n        const result = this.layers.default.show(nameOrGraphic, options);\r\n        this.recalculateBounds();\r\n        return result;\r\n    }\r\n    /**\r\n     * Use a graphic only, swap out any graphics on the **default** layer, returns the new [[Graphic]]\r\n     * @param nameOrGraphic\r\n     * @param options\r\n     */\r\n    use(nameOrGraphic, options) {\r\n        const result = this.layers.default.use(nameOrGraphic, options);\r\n        this.recalculateBounds();\r\n        return result;\r\n    }\r\n    hide(nameOrGraphic) {\r\n        this.layers.default.hide(nameOrGraphic);\r\n    }\r\n    set localBounds(bounds) {\r\n        this._localBounds = bounds;\r\n    }\r\n    recalculateBounds() {\r\n        let bb = new BoundingBox();\r\n        for (const layer of this.layers.get()) {\r\n            for (const { graphic, options } of layer.graphics) {\r\n                let anchor = this.anchor;\r\n                let offset = this.offset;\r\n                if (options === null || options === void 0 ? void 0 : options.anchor) {\r\n                    anchor = options.anchor;\r\n                }\r\n                if (options === null || options === void 0 ? void 0 : options.offset) {\r\n                    offset = options.offset;\r\n                }\r\n                const bounds = graphic.localBounds;\r\n                const offsetX = -bounds.width * anchor.x + offset.x;\r\n                const offsetY = -bounds.height * anchor.y + offset.y;\r\n                bb = graphic === null || graphic === void 0 ? void 0 : graphic.localBounds.translate(vec(offsetX + layer.offset.x, offsetY + layer.offset.y)).combine(bb);\r\n            }\r\n        }\r\n        this._localBounds = bb;\r\n    }\r\n    get localBounds() {\r\n        if (!this._localBounds || this._localBounds.hasZeroDimensions()) {\r\n            this.recalculateBounds();\r\n        }\r\n        return this._localBounds;\r\n    }\r\n    /**\r\n     * Update underlying graphics if necesary, called internally\r\n     * @param elapsed\r\n     * @internal\r\n     */\r\n    update(elapsed, idempotencyToken = 0) {\r\n        for (const layer of this.layers.get()) {\r\n            for (const { graphic } of layer.graphics) {\r\n                if (hasGraphicsTick(graphic)) {\r\n                    graphic === null || graphic === void 0 ? void 0 : graphic.tick(elapsed, idempotencyToken);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    clone() {\r\n        const graphics = new GraphicsComponent();\r\n        graphics._graphics = { ...this._graphics };\r\n        graphics.offset = this.offset.clone();\r\n        graphics.opacity = this.opacity;\r\n        graphics.anchor = this.anchor.clone();\r\n        graphics.copyGraphics = this.copyGraphics;\r\n        graphics.onPreDraw = this.onPreDraw;\r\n        graphics.onPostDraw = this.onPostDraw;\r\n        graphics.visible = this.visible;\r\n        graphics.layers = this.layers.clone(graphics);\r\n        return graphics;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Rectangle.ts\n\r\n/**\r\n * A Rectangle [[Graphic]] for drawing rectangles to the [[ExcaliburGraphicsContext]]\r\n */\r\nclass Rectangle extends Raster {\r\n    constructor(options) {\r\n        super(options);\r\n        this.width = options.width;\r\n        this.height = options.height;\r\n        this.rasterize();\r\n    }\r\n    clone() {\r\n        return new Rectangle({\r\n            width: this.width,\r\n            height: this.height,\r\n            ...this.cloneGraphicOptions(),\r\n            ...this.cloneRasterOptions()\r\n        });\r\n    }\r\n    execute(ctx) {\r\n        if (this.color) {\r\n            ctx.fillRect(0, 0, this.width, this.height);\r\n        }\r\n        if (this.strokeColor) {\r\n            ctx.strokeRect(0, 0, this.width, this.height);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Circle.ts\n\r\n\r\n/**\r\n * A circle [[Graphic]] for drawing circles to the [[ExcaliburGraphicsContext]]\r\n *\r\n * Circles default to [[ImageFiltering.Blended]]\r\n */\r\nclass Circle extends Raster {\r\n    get radius() {\r\n        return this._radius;\r\n    }\r\n    set radius(value) {\r\n        this._radius = value;\r\n        this.width = this._radius * 2;\r\n        this.height = this._radius * 2;\r\n        this.flagDirty();\r\n    }\r\n    constructor(options) {\r\n        var _a, _b, _c;\r\n        super(options);\r\n        this._radius = 0;\r\n        const lineWidth = (_a = options.lineWidth) !== null && _a !== void 0 ? _a : (options.strokeColor ? 1 : 0); // default lineWidth in canvas is 1px\r\n        this.padding = (_b = options.padding) !== null && _b !== void 0 ? _b : 2 + (lineWidth / 2); // default 2 padding for circles looks nice\r\n        this.radius = options.radius;\r\n        this.filtering = (_c = options.filtering) !== null && _c !== void 0 ? _c : ImageFiltering.Blended;\r\n        this.rasterize();\r\n    }\r\n    clone() {\r\n        return new Circle({\r\n            radius: this.radius,\r\n            ...this.cloneGraphicOptions(),\r\n            ...this.cloneRasterOptions()\r\n        });\r\n    }\r\n    execute(ctx) {\r\n        if (this.radius > 0) {\r\n            ctx.beginPath();\r\n            ctx.arc(this.radius, this.radius, this.radius, 0, Math.PI * 2);\r\n            if (this.color) {\r\n                ctx.fill();\r\n            }\r\n            if (this.strokeColor) {\r\n                ctx.stroke();\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Input/PointerComponent.ts\n\r\n/**\r\n * Add this component to optionally configure how the pointer\r\n * system detects pointer events.\r\n *\r\n * By default the collider shape is used and graphics bounds is not.\r\n *\r\n * If both collider shape and graphics bounds are enabled it will fire events if either or\r\n * are intersecting the pointer.\r\n */\r\nclass PointerComponent extends Component {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.type = 'ex.pointer';\r\n        /**\r\n         * Use any existing Collider component geometry for pointer events. This is useful if you want\r\n         * user pointer events only to trigger on the same collision geometry used in the collider component\r\n         * for collision resolution. Default is `true`.\r\n         */\r\n        this.useColliderShape = true;\r\n        /**\r\n         * Use any existing Graphics component bounds for pointers. This is useful if you want the axis aligned\r\n         * bounds around the graphic to trigger pointer events. Default is `false`.\r\n         */\r\n        this.useGraphicsBounds = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/EasingFunctions.ts\n\r\n/**\r\n * Standard easing functions for motion in Excalibur, defined on a domain of [0, duration] and a range from [+startValue,+endValue]\r\n * Given a time, the function will return a value from positive startValue to positive endValue.\r\n *\r\n * ```js\r\n * function Linear (t) {\r\n *    return t * t;\r\n * }\r\n *\r\n * // accelerating from zero velocity\r\n * function EaseInQuad (t) {\r\n *    return t * t;\r\n * }\r\n *\r\n * // decelerating to zero velocity\r\n * function EaseOutQuad (t) {\r\n *    return t * (2 - t);\r\n * }\r\n *\r\n * // acceleration until halfway, then deceleration\r\n * function EaseInOutQuad (t) {\r\n *    return t < .5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\r\n * }\r\n *\r\n * // accelerating from zero velocity\r\n * function EaseInCubic (t) {\r\n *    return t * t * t;\r\n * }\r\n *\r\n * // decelerating to zero velocity\r\n * function EaseOutCubic (t) {\r\n *    return (--t) * t * t + 1;\r\n * }\r\n *\r\n * // acceleration until halfway, then deceleration\r\n * function EaseInOutCubic (t) {\r\n *    return t < .5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1;\r\n * }\r\n * ```\r\n */\r\nclass EasingFunctions {\r\n    static CreateReversibleEasingFunction(easing) {\r\n        return (time, start, end, duration) => {\r\n            if (end < start) {\r\n                return start - (easing(time, end, start, duration) - end);\r\n            }\r\n            else {\r\n                return easing(time, start, end, duration);\r\n            }\r\n        };\r\n    }\r\n    static CreateVectorEasingFunction(easing) {\r\n        return (time, start, end, duration) => {\r\n            return new Vector(easing(time, start.x, end.x, duration), easing(time, start.y, end.y, duration));\r\n        };\r\n    }\r\n}\r\nEasingFunctions.Linear = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\r\n    endValue = endValue - startValue;\r\n    return (endValue * currentTime) / duration + startValue;\r\n});\r\nEasingFunctions.EaseInQuad = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\r\n    endValue = endValue - startValue;\r\n    currentTime /= duration;\r\n    return endValue * currentTime * currentTime + startValue;\r\n});\r\nEasingFunctions.EaseOutQuad = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\r\n    endValue = endValue - startValue;\r\n    currentTime /= duration;\r\n    return -endValue * currentTime * (currentTime - 2) + startValue;\r\n});\r\nEasingFunctions.EaseInOutQuad = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\r\n    endValue = endValue - startValue;\r\n    currentTime /= duration / 2;\r\n    if (currentTime < 1) {\r\n        return (endValue / 2) * currentTime * currentTime + startValue;\r\n    }\r\n    currentTime--;\r\n    return (-endValue / 2) * (currentTime * (currentTime - 2) - 1) + startValue;\r\n});\r\nEasingFunctions.EaseInCubic = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\r\n    endValue = endValue - startValue;\r\n    currentTime /= duration;\r\n    return endValue * currentTime * currentTime * currentTime + startValue;\r\n});\r\nEasingFunctions.EaseOutCubic = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\r\n    endValue = endValue - startValue;\r\n    currentTime /= duration;\r\n    currentTime--;\r\n    return endValue * (currentTime * currentTime * currentTime + 1) + startValue;\r\n});\r\nEasingFunctions.EaseInOutCubic = EasingFunctions.CreateReversibleEasingFunction((currentTime, startValue, endValue, duration) => {\r\n    endValue = endValue - startValue;\r\n    currentTime /= duration / 2;\r\n    if (currentTime < 1) {\r\n        return (endValue / 2) * currentTime * currentTime * currentTime + startValue;\r\n    }\r\n    currentTime -= 2;\r\n    return (endValue / 2) * (currentTime * currentTime * currentTime + 2) + startValue;\r\n});\r\n\n;// CONCATENATED MODULE: ./Actions/ActionQueue.ts\n/**\r\n * Action Queues represent an ordered sequence of actions\r\n *\r\n * Action queues are part of the [[ActionContext|Action API]] and\r\n * store the list of actions to be executed for an [[Actor]].\r\n *\r\n * Actors implement [[Actor.actions]] which can be manipulated by\r\n * advanced users to adjust the actions currently being executed in the\r\n * queue.\r\n */\r\nclass ActionQueue {\r\n    constructor(entity) {\r\n        this._actions = [];\r\n        this._completedActions = [];\r\n        this._entity = entity;\r\n    }\r\n    /**\r\n     * Add an action to the sequence\r\n     * @param action\r\n     */\r\n    add(action) {\r\n        this._actions.push(action);\r\n    }\r\n    /**\r\n     * Remove an action by reference from the sequence\r\n     * @param action\r\n     */\r\n    remove(action) {\r\n        const index = this._actions.indexOf(action);\r\n        this._actions.splice(index, 1);\r\n    }\r\n    /**\r\n     * Removes all actions from this sequence\r\n     */\r\n    clearActions() {\r\n        this._actions.length = 0;\r\n        this._completedActions.length = 0;\r\n        if (this._currentAction) {\r\n            this._currentAction.stop();\r\n        }\r\n    }\r\n    /**\r\n     *\r\n     * @returns The total list of actions in this sequence complete or not\r\n     */\r\n    getActions() {\r\n        return this._actions.concat(this._completedActions);\r\n    }\r\n    /**\r\n     *\r\n     * @returns `true` if there are more actions to process in the sequence\r\n     */\r\n    hasNext() {\r\n        return this._actions.length > 0;\r\n    }\r\n    /**\r\n     * @returns `true` if the current sequence of actions is done\r\n     */\r\n    isComplete() {\r\n        return this._actions.length === 0;\r\n    }\r\n    /**\r\n     * Resets the sequence of actions, this is used to restart a sequence from the beginning\r\n     */\r\n    reset() {\r\n        this._actions = this.getActions();\r\n        const len = this._actions.length;\r\n        for (let i = 0; i < len; i++) {\r\n            this._actions[i].reset();\r\n        }\r\n        this._completedActions = [];\r\n    }\r\n    /**\r\n     * Update the queue which updates actions and handles completing actions\r\n     * @param elapsedMs\r\n     */\r\n    update(elapsedMs) {\r\n        if (this._actions.length > 0) {\r\n            this._currentAction = this._actions[0];\r\n            this._currentAction.update(elapsedMs);\r\n            if (this._currentAction.isComplete(this._entity)) {\r\n                this._completedActions.push(this._actions.shift());\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/Repeat.ts\n\r\nclass Repeat {\r\n    constructor(entity, repeatBuilder, repeat) {\r\n        this._stopped = false;\r\n        this._repeatBuilder = repeatBuilder;\r\n        this._repeatContext = new ActionContext(entity);\r\n        this._actionQueue = this._repeatContext.getQueue();\r\n        this._repeat = repeat;\r\n        this._originalRepeat = repeat;\r\n        this._repeatBuilder(this._repeatContext);\r\n        this._repeat--; // current execution is the first repeat\r\n    }\r\n    update(delta) {\r\n        if (this._actionQueue.isComplete()) {\r\n            this._actionQueue.clearActions();\r\n            this._repeatBuilder(this._repeatContext);\r\n            this._repeat--;\r\n        }\r\n        this._actionQueue.update(delta);\r\n    }\r\n    isComplete() {\r\n        return this._stopped || (this._repeat <= 0 && this._actionQueue.isComplete());\r\n    }\r\n    stop() {\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._repeat = this._originalRepeat;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/RepeatForever.ts\n\r\n/**\r\n * RepeatForever Action implementation, it is recommended you use the fluent action\r\n * context API.\r\n *\r\n *\r\n */\r\nclass RepeatForever {\r\n    constructor(entity, repeatBuilder) {\r\n        this._stopped = false;\r\n        this._repeatBuilder = repeatBuilder;\r\n        this._repeatContext = new ActionContext(entity);\r\n        this._actionQueue = this._repeatContext.getQueue();\r\n        this._repeatBuilder(this._repeatContext);\r\n    }\r\n    update(delta) {\r\n        if (this._stopped) {\r\n            return;\r\n        }\r\n        if (this._actionQueue.isComplete()) {\r\n            this._actionQueue.clearActions();\r\n            this._repeatBuilder(this._repeatContext);\r\n        }\r\n        this._actionQueue.update(delta);\r\n    }\r\n    isComplete() {\r\n        return this._stopped;\r\n    }\r\n    stop() {\r\n        this._stopped = true;\r\n        this._actionQueue.clearActions();\r\n    }\r\n    reset() {\r\n        return;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/MoveBy.ts\n\r\n\r\n\r\n\r\nclass MoveBy {\r\n    constructor(entity, offsetX, offsetY, speed) {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._entity = entity;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._speed = speed;\r\n        this._offset = new Vector(offsetX, offsetY);\r\n        if (speed <= 0) {\r\n            Logger.getInstance().error('Attempted to moveBy with speed less than or equal to zero : ' + speed);\r\n            throw new Error('Speed must be greater than 0 pixels per second');\r\n        }\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._start = new Vector(this._tx.pos.x, this._tx.pos.y);\r\n            this._end = this._start.add(this._offset);\r\n            this._distance = this._offset.size;\r\n            this._dir = this._end.sub(this._start).normalize();\r\n        }\r\n        if (this.isComplete(this._entity)) {\r\n            this._tx.pos = vec(this._end.x, this._end.y);\r\n            this._motion.vel = vec(0, 0);\r\n        }\r\n        else {\r\n            this._motion.vel = this._dir.scale(this._speed);\r\n        }\r\n    }\r\n    isComplete(entity) {\r\n        const tx = entity.get(TransformComponent);\r\n        return this._stopped || tx.pos.distance(this._start) >= this._distance;\r\n    }\r\n    stop() {\r\n        this._motion.vel = vec(0, 0);\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n        this._stopped = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/MoveTo.ts\n\r\n\r\n\r\nclass MoveTo {\r\n    constructor(entity, destx, desty, speed) {\r\n        this.entity = entity;\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._end = new Vector(destx, desty);\r\n        this._speed = speed;\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._start = new Vector(this._tx.pos.x, this._tx.pos.y);\r\n            this._distance = this._start.distance(this._end);\r\n            this._dir = this._end.sub(this._start).normalize();\r\n        }\r\n        const m = this._dir.scale(this._speed);\r\n        this._motion.vel = vec(m.x, m.y);\r\n        if (this.isComplete(this.entity)) {\r\n            this._tx.pos = vec(this._end.x, this._end.y);\r\n            this._motion.vel = vec(0, 0);\r\n        }\r\n    }\r\n    isComplete(entity) {\r\n        const tx = entity.get(TransformComponent);\r\n        return this._stopped || new Vector(tx.pos.x, tx.pos.y).distance(this._start) >= this._distance;\r\n    }\r\n    stop() {\r\n        this._motion.vel = vec(0, 0);\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n        this._stopped = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/RotationType.ts\n/**\r\n * An enum that describes the strategies that rotation actions can use\r\n */\r\nvar RotationType;\r\n(function (RotationType) {\r\n    /**\r\n     * Rotation via `ShortestPath` will use the smallest angle\r\n     * between the starting and ending points. This strategy is the default behavior.\r\n     */\r\n    RotationType[RotationType[\"ShortestPath\"] = 0] = \"ShortestPath\";\r\n    /**\r\n     * Rotation via `LongestPath` will use the largest angle\r\n     * between the starting and ending points.\r\n     */\r\n    RotationType[RotationType[\"LongestPath\"] = 1] = \"LongestPath\";\r\n    /**\r\n     * Rotation via `Clockwise` will travel in a clockwise direction,\r\n     * regardless of the starting and ending points.\r\n     */\r\n    RotationType[RotationType[\"Clockwise\"] = 2] = \"Clockwise\";\r\n    /**\r\n     * Rotation via `CounterClockwise` will travel in a counterclockwise direction,\r\n     * regardless of the starting and ending points.\r\n     */\r\n    RotationType[RotationType[\"CounterClockwise\"] = 3] = \"CounterClockwise\";\r\n})(RotationType || (RotationType = {}));\r\n\n;// CONCATENATED MODULE: ./Actions/Action/RotateTo.ts\n\r\n\r\n\r\n\r\nclass RotateTo {\r\n    constructor(entity, angleRadians, speed, rotationType) {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._end = angleRadians;\r\n        this._speed = speed;\r\n        this._rotationType = rotationType || RotationType.ShortestPath;\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._start = this._tx.rotation;\r\n            this._currentNonCannonAngle = this._tx.rotation;\r\n            const distance1 = Math.abs(this._end - this._start);\r\n            const distance2 = TwoPI - distance1;\r\n            if (distance1 > distance2) {\r\n                this._shortDistance = distance2;\r\n                this._longDistance = distance1;\r\n            }\r\n            else {\r\n                this._shortDistance = distance1;\r\n                this._longDistance = distance2;\r\n            }\r\n            this._shortestPathIsPositive = (this._start - this._end + TwoPI) % TwoPI >= Math.PI;\r\n            switch (this._rotationType) {\r\n                case RotationType.ShortestPath:\r\n                    this._distance = this._shortDistance;\r\n                    if (this._shortestPathIsPositive) {\r\n                        this._direction = 1;\r\n                    }\r\n                    else {\r\n                        this._direction = -1;\r\n                    }\r\n                    break;\r\n                case RotationType.LongestPath:\r\n                    this._distance = this._longDistance;\r\n                    if (this._shortestPathIsPositive) {\r\n                        this._direction = -1;\r\n                    }\r\n                    else {\r\n                        this._direction = 1;\r\n                    }\r\n                    break;\r\n                case RotationType.Clockwise:\r\n                    this._direction = 1;\r\n                    if (this._shortestPathIsPositive) {\r\n                        this._distance = this._shortDistance;\r\n                    }\r\n                    else {\r\n                        this._distance = this._longDistance;\r\n                    }\r\n                    break;\r\n                case RotationType.CounterClockwise:\r\n                    this._direction = -1;\r\n                    if (!this._shortestPathIsPositive) {\r\n                        this._distance = this._shortDistance;\r\n                    }\r\n                    else {\r\n                        this._distance = this._longDistance;\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n        this._motion.angularVelocity = this._direction * this._speed;\r\n        this._currentNonCannonAngle += this._direction * this._speed * (_delta / 1000);\r\n        if (this.isComplete()) {\r\n            this._tx.rotation = this._end;\r\n            this._motion.angularVelocity = 0;\r\n            this._stopped = true;\r\n        }\r\n    }\r\n    isComplete() {\r\n        const distanceTraveled = Math.abs(this._currentNonCannonAngle - this._start);\r\n        return this._stopped || distanceTraveled >= Math.abs(this._distance);\r\n    }\r\n    stop() {\r\n        this._motion.angularVelocity = 0;\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n        this._stopped = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/RotateBy.ts\n\r\n\r\n\r\n\r\nclass RotateBy {\r\n    constructor(entity, angleRadiansOffset, speed, rotationType) {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._speed = speed;\r\n        this._offset = angleRadiansOffset;\r\n        this._rotationType = rotationType || RotationType.ShortestPath;\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._start = this._tx.rotation;\r\n            this._currentNonCannonAngle = this._tx.rotation;\r\n            this._end = this._start + this._offset;\r\n            const distance1 = Math.abs(this._end - this._start);\r\n            const distance2 = TwoPI - distance1;\r\n            if (distance1 > distance2) {\r\n                this._shortDistance = distance2;\r\n                this._longDistance = distance1;\r\n            }\r\n            else {\r\n                this._shortDistance = distance1;\r\n                this._longDistance = distance2;\r\n            }\r\n            this._shortestPathIsPositive = (this._start - this._end + TwoPI) % TwoPI >= Math.PI;\r\n            switch (this._rotationType) {\r\n                case RotationType.ShortestPath:\r\n                    this._distance = this._shortDistance;\r\n                    if (this._shortestPathIsPositive) {\r\n                        this._direction = 1;\r\n                    }\r\n                    else {\r\n                        this._direction = -1;\r\n                    }\r\n                    break;\r\n                case RotationType.LongestPath:\r\n                    this._distance = this._longDistance;\r\n                    if (this._shortestPathIsPositive) {\r\n                        this._direction = -1;\r\n                    }\r\n                    else {\r\n                        this._direction = 1;\r\n                    }\r\n                    break;\r\n                case RotationType.Clockwise:\r\n                    this._direction = 1;\r\n                    if (this._shortDistance >= 0) {\r\n                        this._distance = this._shortDistance;\r\n                    }\r\n                    else {\r\n                        this._distance = this._longDistance;\r\n                    }\r\n                    break;\r\n                case RotationType.CounterClockwise:\r\n                    this._direction = -1;\r\n                    if (this._shortDistance <= 0) {\r\n                        this._distance = this._shortDistance;\r\n                    }\r\n                    else {\r\n                        this._distance = this._longDistance;\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n        this._motion.angularVelocity = this._direction * this._speed;\r\n        this._currentNonCannonAngle += this._direction * this._speed * (_delta / 1000);\r\n        if (this.isComplete()) {\r\n            this._tx.rotation = this._end;\r\n            this._motion.angularVelocity = 0;\r\n            this._stopped = true;\r\n        }\r\n    }\r\n    isComplete() {\r\n        const distanceTraveled = Math.abs(this._currentNonCannonAngle - this._start);\r\n        return this._stopped || distanceTraveled >= Math.abs(this._distance);\r\n    }\r\n    stop() {\r\n        this._motion.angularVelocity = 0;\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._start = undefined;\r\n        this._currentNonCannonAngle = undefined;\r\n        this._distance = undefined;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/ScaleTo.ts\n\r\n\r\n\r\nclass ScaleTo {\r\n    constructor(entity, scaleX, scaleY, speedX, speedY) {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._endX = scaleX;\r\n        this._endY = scaleY;\r\n        this._speedX = speedX;\r\n        this._speedY = speedY;\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._startX = this._tx.scale.x;\r\n            this._startY = this._tx.scale.y;\r\n            this._distanceX = Math.abs(this._endX - this._startX);\r\n            this._distanceY = Math.abs(this._endY - this._startY);\r\n        }\r\n        if (!(Math.abs(this._tx.scale.x - this._startX) >= this._distanceX)) {\r\n            const directionX = this._endY < this._startY ? -1 : 1;\r\n            this._motion.scaleFactor.x = this._speedX * directionX;\r\n        }\r\n        else {\r\n            this._motion.scaleFactor.x = 0;\r\n        }\r\n        if (!(Math.abs(this._tx.scale.y - this._startY) >= this._distanceY)) {\r\n            const directionY = this._endY < this._startY ? -1 : 1;\r\n            this._motion.scaleFactor.y = this._speedY * directionY;\r\n        }\r\n        else {\r\n            this._motion.scaleFactor.y = 0;\r\n        }\r\n        if (this.isComplete()) {\r\n            this._tx.scale = vec(this._endX, this._endY);\r\n            this._motion.scaleFactor.x = 0;\r\n            this._motion.scaleFactor.y = 0;\r\n        }\r\n    }\r\n    isComplete() {\r\n        return (this._stopped ||\r\n            (Math.abs(this._tx.scale.x - this._startX) >= (this._distanceX - 0.01) &&\r\n                Math.abs(this._tx.scale.y - this._startY) >= (this._distanceY - 0.01)));\r\n    }\r\n    stop() {\r\n        this._motion.scaleFactor.x = 0;\r\n        this._motion.scaleFactor.y = 0;\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n        this._stopped = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/ScaleBy.ts\n\r\n\r\n\r\nclass ScaleBy {\r\n    constructor(entity, scaleOffsetX, scaleOffsetY, speed) {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._offset = new Vector(scaleOffsetX, scaleOffsetY);\r\n        this._speedX = this._speedY = speed;\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._startScale = this._tx.scale.clone();\r\n            this._endScale = this._startScale.add(this._offset);\r\n            this._distanceX = Math.abs(this._endScale.x - this._startScale.x);\r\n            this._distanceY = Math.abs(this._endScale.y - this._startScale.y);\r\n            this._directionX = this._endScale.x < this._startScale.x ? -1 : 1;\r\n            this._directionY = this._endScale.y < this._startScale.y ? -1 : 1;\r\n        }\r\n        this._motion.scaleFactor.x = this._speedX * this._directionX;\r\n        this._motion.scaleFactor.y = this._speedY * this._directionY;\r\n        if (this.isComplete()) {\r\n            this._tx.scale = this._endScale;\r\n            this._motion.scaleFactor.x = 0;\r\n            this._motion.scaleFactor.y = 0;\r\n        }\r\n    }\r\n    isComplete() {\r\n        return (this._stopped ||\r\n            (Math.abs(this._tx.scale.x - this._startScale.x) >= (this._distanceX - 0.01) &&\r\n                Math.abs(this._tx.scale.y - this._startScale.y) >= (this._distanceY - 0.01)));\r\n    }\r\n    stop() {\r\n        this._motion.scaleFactor.x = 0;\r\n        this._motion.scaleFactor.y = 0;\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n        this._stopped = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/CallMethod.ts\nclass CallMethod {\r\n    constructor(method) {\r\n        this._method = null;\r\n        this._hasBeenCalled = false;\r\n        this._method = method;\r\n    }\r\n    update(_delta) {\r\n        this._method();\r\n        this._hasBeenCalled = true;\r\n    }\r\n    isComplete() {\r\n        return this._hasBeenCalled;\r\n    }\r\n    reset() {\r\n        this._hasBeenCalled = false;\r\n    }\r\n    stop() {\r\n        this._hasBeenCalled = true;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/EaseTo.ts\n\r\n\r\n\r\nclass EaseTo {\r\n    constructor(entity, x, y, duration, easingFcn) {\r\n        this.easingFcn = easingFcn;\r\n        this._currentLerpTime = 0;\r\n        this._lerpDuration = 1 * 1000; // 1 second\r\n        this._lerpStart = new Vector(0, 0);\r\n        this._lerpEnd = new Vector(0, 0);\r\n        this._initialized = false;\r\n        this._stopped = false;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._lerpDuration = duration;\r\n        this._lerpEnd = new Vector(x, y);\r\n    }\r\n    _initialize() {\r\n        this._lerpStart = new Vector(this._tx.pos.x, this._tx.pos.y);\r\n        this._currentLerpTime = 0;\r\n    }\r\n    update(delta) {\r\n        if (!this._initialized) {\r\n            this._initialize();\r\n            this._initialized = true;\r\n        }\r\n        // Need to update lerp time first, otherwise the first update will always be zero\r\n        this._currentLerpTime += delta;\r\n        let newX = this._tx.pos.x;\r\n        let newY = this._tx.pos.y;\r\n        if (this._currentLerpTime < this._lerpDuration) {\r\n            if (this._lerpEnd.x < this._lerpStart.x) {\r\n                newX =\r\n                    this._lerpStart.x -\r\n                        (this.easingFcn(this._currentLerpTime, this._lerpEnd.x, this._lerpStart.x, this._lerpDuration) - this._lerpEnd.x);\r\n            }\r\n            else {\r\n                newX = this.easingFcn(this._currentLerpTime, this._lerpStart.x, this._lerpEnd.x, this._lerpDuration);\r\n            }\r\n            if (this._lerpEnd.y < this._lerpStart.y) {\r\n                newY =\r\n                    this._lerpStart.y -\r\n                        (this.easingFcn(this._currentLerpTime, this._lerpEnd.y, this._lerpStart.y, this._lerpDuration) - this._lerpEnd.y);\r\n            }\r\n            else {\r\n                newY = this.easingFcn(this._currentLerpTime, this._lerpStart.y, this._lerpEnd.y, this._lerpDuration);\r\n            }\r\n            // Given the lerp position figure out the velocity in pixels per second\r\n            this._motion.vel = vec((newX - this._tx.pos.x) / (delta / 1000), (newY - this._tx.pos.y) / (delta / 1000));\r\n        }\r\n        else {\r\n            this._tx.pos = vec(this._lerpEnd.x, this._lerpEnd.y);\r\n            this._motion.vel = Vector.Zero;\r\n        }\r\n    }\r\n    isComplete() {\r\n        return this._stopped || this._currentLerpTime >= this._lerpDuration;\r\n    }\r\n    reset() {\r\n        this._initialized = false;\r\n        this._stopped = false;\r\n        this._currentLerpTime = 0;\r\n    }\r\n    stop() {\r\n        this._motion.vel = vec(0, 0);\r\n        this._stopped = true;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/EaseBy.ts\n\r\n\r\n\r\nclass EaseBy {\r\n    constructor(entity, offsetX, offsetY, duration, easingFcn) {\r\n        this.easingFcn = easingFcn;\r\n        this._currentLerpTime = 0;\r\n        this._lerpDuration = 1 * 1000; // 1 second\r\n        this._lerpStart = new Vector(0, 0);\r\n        this._lerpEnd = new Vector(0, 0);\r\n        this._initialized = false;\r\n        this._stopped = false;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._lerpDuration = duration;\r\n        this._offset = new Vector(offsetX, offsetY);\r\n    }\r\n    _initialize() {\r\n        this._lerpStart = new Vector(this._tx.pos.x, this._tx.pos.y);\r\n        this._currentLerpTime = 0;\r\n        this._lerpEnd = this._lerpStart.add(this._offset);\r\n    }\r\n    update(delta) {\r\n        if (!this._initialized) {\r\n            this._initialize();\r\n            this._initialized = true;\r\n        }\r\n        // Need to update lerp time first, otherwise the first update will always be zero\r\n        this._currentLerpTime += delta;\r\n        let newX = this._tx.pos.x;\r\n        let newY = this._tx.pos.y;\r\n        if (this._currentLerpTime < this._lerpDuration) {\r\n            if (this._lerpEnd.x < this._lerpStart.x) {\r\n                newX =\r\n                    this._lerpStart.x -\r\n                        (this.easingFcn(this._currentLerpTime, this._lerpEnd.x, this._lerpStart.x, this._lerpDuration) - this._lerpEnd.x);\r\n            }\r\n            else {\r\n                newX = this.easingFcn(this._currentLerpTime, this._lerpStart.x, this._lerpEnd.x, this._lerpDuration);\r\n            }\r\n            if (this._lerpEnd.y < this._lerpStart.y) {\r\n                newY =\r\n                    this._lerpStart.y -\r\n                        (this.easingFcn(this._currentLerpTime, this._lerpEnd.y, this._lerpStart.y, this._lerpDuration) - this._lerpEnd.y);\r\n            }\r\n            else {\r\n                newY = this.easingFcn(this._currentLerpTime, this._lerpStart.y, this._lerpEnd.y, this._lerpDuration);\r\n            }\r\n            // Given the lerp position figure out the velocity in pixels per second\r\n            this._motion.vel = vec((newX - this._tx.pos.x) / (delta / 1000), (newY - this._tx.pos.y) / (delta / 1000));\r\n        }\r\n        else {\r\n            this._tx.pos = vec(this._lerpEnd.x, this._lerpEnd.y);\r\n            this._motion.vel = Vector.Zero;\r\n        }\r\n    }\r\n    isComplete() {\r\n        return this._stopped || this._currentLerpTime >= this._lerpDuration;\r\n    }\r\n    reset() {\r\n        this._initialized = false;\r\n        this._stopped = false;\r\n        this._currentLerpTime = 0;\r\n    }\r\n    stop() {\r\n        this._motion.vel = vec(0, 0);\r\n        this._stopped = true;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/Blink.ts\n\r\nclass Blink {\r\n    constructor(entity, timeVisible, timeNotVisible, numBlinks = 1) {\r\n        this._timeVisible = 0;\r\n        this._timeNotVisible = 0;\r\n        this._elapsedTime = 0;\r\n        this._totalTime = 0;\r\n        this._stopped = false;\r\n        this._started = false;\r\n        this._graphics = entity.get(GraphicsComponent);\r\n        this._timeVisible = timeVisible;\r\n        this._timeNotVisible = timeNotVisible;\r\n        this._duration = (timeVisible + timeNotVisible) * numBlinks;\r\n    }\r\n    update(delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._elapsedTime = 0;\r\n            this._totalTime = 0;\r\n        }\r\n        if (!this._graphics) {\r\n            return;\r\n        }\r\n        this._elapsedTime += delta;\r\n        this._totalTime += delta;\r\n        if (this._graphics.visible && this._elapsedTime >= this._timeVisible) {\r\n            this._graphics.visible = false;\r\n            this._elapsedTime = 0;\r\n        }\r\n        if (!this._graphics.visible && this._elapsedTime >= this._timeNotVisible) {\r\n            this._graphics.visible = true;\r\n            this._elapsedTime = 0;\r\n        }\r\n        if (this.isComplete()) {\r\n            this._graphics.visible = true;\r\n        }\r\n    }\r\n    isComplete() {\r\n        return this._stopped || this._totalTime >= this._duration;\r\n    }\r\n    stop() {\r\n        if (this._graphics) {\r\n            this._graphics.visible = true;\r\n        }\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._elapsedTime = 0;\r\n        this._totalTime = 0;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/Fade.ts\n\r\n\r\nclass Fade {\r\n    constructor(entity, endOpacity, speed) {\r\n        this._multiplier = 1;\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._graphics = entity.get(GraphicsComponent);\r\n        this._endOpacity = endOpacity;\r\n        this._speed = this._ogspeed = speed;\r\n    }\r\n    update(delta) {\r\n        if (!this._graphics) {\r\n            return;\r\n        }\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._speed = this._ogspeed;\r\n            // determine direction when we start\r\n            if (this._endOpacity < this._graphics.opacity) {\r\n                this._multiplier = -1;\r\n            }\r\n            else {\r\n                this._multiplier = 1;\r\n            }\r\n        }\r\n        if (this._speed > 0) {\r\n            this._graphics.opacity += (this._multiplier *\r\n                (Math.abs(this._graphics.opacity - this._endOpacity) * delta)) / this._speed;\r\n        }\r\n        this._speed -= delta;\r\n        if (this.isComplete()) {\r\n            this._graphics.opacity = this._endOpacity;\r\n        }\r\n        Logger.getInstance().debug('[Action fade] Actor opacity:', this._graphics.opacity);\r\n    }\r\n    isComplete() {\r\n        return this._stopped || Math.abs(this._graphics.opacity - this._endOpacity) < 0.05;\r\n    }\r\n    stop() {\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n        this._stopped = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/Delay.ts\nclass Delay {\r\n    constructor(delay) {\r\n        this._elapsedTime = 0;\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._delay = delay;\r\n    }\r\n    update(delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n        }\r\n        this._elapsedTime += delta;\r\n    }\r\n    isComplete() {\r\n        return this._stopped || this._elapsedTime >= this._delay;\r\n    }\r\n    stop() {\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._elapsedTime = 0;\r\n        this._started = false;\r\n        this._stopped = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/Die.ts\n\r\nclass Die {\r\n    constructor(entity) {\r\n        this._stopped = false;\r\n        this._entity = entity;\r\n    }\r\n    update(_delta) {\r\n        this._entity.get(ActionsComponent).clearActions();\r\n        this._entity.kill();\r\n        this._stopped = true;\r\n    }\r\n    isComplete() {\r\n        return this._stopped;\r\n    }\r\n    stop() {\r\n        return;\r\n    }\r\n    reset() {\r\n        return;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/Follow.ts\n\r\n\r\n\r\nclass Follow {\r\n    constructor(entity, entityToFollow, followDistance) {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._tx = entity.get(TransformComponent);\r\n        this._motion = entity.get(MotionComponent);\r\n        this._followTx = entityToFollow.get(TransformComponent);\r\n        this._followMotion = entityToFollow.get(MotionComponent);\r\n        this._current = new Vector(this._tx.pos.x, this._tx.pos.y);\r\n        this._end = new Vector(this._followTx.pos.x, this._followTx.pos.y);\r\n        this._maximumDistance = followDistance !== undefined ? followDistance : this._current.distance(this._end);\r\n        this._speed = 0;\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._distanceBetween = this._current.distance(this._end);\r\n            this._dir = this._end.sub(this._current).normalize();\r\n        }\r\n        const actorToFollowSpeed = Math.sqrt(Math.pow(this._followMotion.vel.x, 2) + Math.pow(this._followMotion.vel.y, 2));\r\n        if (actorToFollowSpeed !== 0) {\r\n            this._speed = actorToFollowSpeed;\r\n        }\r\n        this._current = vec(this._tx.pos.x, this._tx.pos.y);\r\n        this._end = vec(this._followTx.pos.x, this._followTx.pos.y);\r\n        this._distanceBetween = this._current.distance(this._end);\r\n        this._dir = this._end.sub(this._current).normalize();\r\n        if (this._distanceBetween >= this._maximumDistance) {\r\n            const m = this._dir.scale(this._speed);\r\n            this._motion.vel = vec(m.x, m.y);\r\n        }\r\n        else {\r\n            this._motion.vel = vec(0, 0);\r\n        }\r\n        if (this.isComplete()) {\r\n            this._tx.pos = vec(this._end.x, this._end.y);\r\n            this._motion.vel = vec(0, 0);\r\n        }\r\n    }\r\n    stop() {\r\n        this._motion.vel = vec(0, 0);\r\n        this._stopped = true;\r\n    }\r\n    isComplete() {\r\n        // the actor following should never stop unless specified to do so\r\n        return this._stopped;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n        this._stopped = false;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/Meet.ts\n\r\n\r\n\r\nclass Meet {\r\n    constructor(actor, actorToMeet, speed) {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._speedWasSpecified = false;\r\n        this._tx = actor.get(TransformComponent);\r\n        this._motion = actor.get(MotionComponent);\r\n        this._meetTx = actorToMeet.get(TransformComponent);\r\n        this._meetMotion = actorToMeet.get(MotionComponent);\r\n        this._current = new Vector(this._tx.pos.x, this._tx.pos.y);\r\n        this._end = new Vector(this._meetTx.pos.x, this._meetTx.pos.y);\r\n        this._speed = speed || 0;\r\n        if (speed !== undefined) {\r\n            this._speedWasSpecified = true;\r\n        }\r\n    }\r\n    update(_delta) {\r\n        if (!this._started) {\r\n            this._started = true;\r\n            this._distanceBetween = this._current.distance(this._end);\r\n            this._dir = this._end.sub(this._current).normalize();\r\n        }\r\n        const actorToMeetSpeed = Math.sqrt(Math.pow(this._meetMotion.vel.x, 2) + Math.pow(this._meetMotion.vel.y, 2));\r\n        if (actorToMeetSpeed !== 0 && !this._speedWasSpecified) {\r\n            this._speed = actorToMeetSpeed;\r\n        }\r\n        this._current = vec(this._tx.pos.x, this._tx.pos.y);\r\n        this._end = vec(this._meetTx.pos.x, this._meetTx.pos.y);\r\n        this._distanceBetween = this._current.distance(this._end);\r\n        this._dir = this._end.sub(this._current).normalize();\r\n        const m = this._dir.scale(this._speed);\r\n        this._motion.vel = vec(m.x, m.y);\r\n        if (this.isComplete()) {\r\n            this._tx.pos = vec(this._end.x, this._end.y);\r\n            this._motion.vel = vec(0, 0);\r\n        }\r\n    }\r\n    isComplete() {\r\n        return this._stopped || this._distanceBetween <= 1;\r\n    }\r\n    stop() {\r\n        this._motion.vel = vec(0, 0);\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._started = false;\r\n        this._stopped = false;\r\n        this._distanceBetween = undefined;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/ActionContext.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * The fluent Action API allows you to perform \"actions\" on\r\n * [[Actor|Actors]] such as following, moving, rotating, and\r\n * more. You can implement your own actions by implementing\r\n * the [[Action]] interface.\r\n */\r\nclass ActionContext {\r\n    constructor(entity) {\r\n        this._entity = entity;\r\n        this._queue = new ActionQueue(entity);\r\n    }\r\n    getQueue() {\r\n        return this._queue;\r\n    }\r\n    update(elapsedMs) {\r\n        this._queue.update(elapsedMs);\r\n    }\r\n    /**\r\n     * Clears all queued actions from the Actor\r\n     */\r\n    clearActions() {\r\n        this._queue.clearActions();\r\n    }\r\n    runAction(action) {\r\n        action.reset();\r\n        this._queue.add(action);\r\n        return this;\r\n    }\r\n    easeTo(...args) {\r\n        var _a, _b;\r\n        let x = 0;\r\n        let y = 0;\r\n        let duration = 0;\r\n        let easingFcn = EasingFunctions.Linear;\r\n        if (args[0] instanceof Vector) {\r\n            x = args[0].x;\r\n            y = args[0].y;\r\n            duration = args[1];\r\n            easingFcn = (_a = args[2]) !== null && _a !== void 0 ? _a : easingFcn;\r\n        }\r\n        else {\r\n            x = args[0];\r\n            y = args[1];\r\n            duration = args[2];\r\n            easingFcn = (_b = args[3]) !== null && _b !== void 0 ? _b : easingFcn;\r\n        }\r\n        this._queue.add(new EaseTo(this._entity, x, y, duration, easingFcn));\r\n        return this;\r\n    }\r\n    easeBy(...args) {\r\n        var _a, _b;\r\n        let offsetX = 0;\r\n        let offsetY = 0;\r\n        let duration = 0;\r\n        let easingFcn = EasingFunctions.Linear;\r\n        if (args[0] instanceof Vector) {\r\n            offsetX = args[0].x;\r\n            offsetY = args[0].y;\r\n            duration = args[1];\r\n            easingFcn = (_a = args[2]) !== null && _a !== void 0 ? _a : easingFcn;\r\n        }\r\n        else {\r\n            offsetX = args[0];\r\n            offsetY = args[1];\r\n            duration = args[2];\r\n            easingFcn = (_b = args[3]) !== null && _b !== void 0 ? _b : easingFcn;\r\n        }\r\n        this._queue.add(new EaseBy(this._entity, offsetX, offsetY, duration, easingFcn));\r\n        return this;\r\n    }\r\n    moveTo(xOrPos, yOrSpeed, speedOrUndefined) {\r\n        let x = 0;\r\n        let y = 0;\r\n        let speed = 0;\r\n        if (xOrPos instanceof Vector) {\r\n            x = xOrPos.x;\r\n            y = xOrPos.y;\r\n            speed = yOrSpeed;\r\n        }\r\n        else {\r\n            x = xOrPos;\r\n            y = yOrSpeed;\r\n            speed = speedOrUndefined;\r\n        }\r\n        this._queue.add(new MoveTo(this._entity, x, y, speed));\r\n        return this;\r\n    }\r\n    moveBy(xOffsetOrVector, yOffsetOrSpeed, speedOrUndefined) {\r\n        let xOffset = 0;\r\n        let yOffset = 0;\r\n        let speed = 0;\r\n        if (xOffsetOrVector instanceof Vector) {\r\n            xOffset = xOffsetOrVector.x;\r\n            yOffset = xOffsetOrVector.y;\r\n            speed = yOffsetOrSpeed;\r\n        }\r\n        else {\r\n            xOffset = xOffsetOrVector;\r\n            yOffset = yOffsetOrSpeed;\r\n            speed = speedOrUndefined;\r\n        }\r\n        this._queue.add(new MoveBy(this._entity, xOffset, yOffset, speed));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will rotate an actor to the specified angle at the speed\r\n     * specified (in radians per second) and return back the actor. This\r\n     * method is part of the actor 'Action' fluent API allowing action chaining.\r\n     * @param angleRadians  The angle to rotate to in radians\r\n     * @param speed         The angular velocity of the rotation specified in radians per second\r\n     * @param rotationType  The [[RotationType]] to use for this rotation\r\n     */\r\n    rotateTo(angleRadians, speed, rotationType) {\r\n        this._queue.add(new RotateTo(this._entity, angleRadians, speed, rotationType));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will rotate an actor by the specified angle offset, from it's current rotation given a certain speed\r\n     * in radians/sec and return back the actor. This method is part\r\n     * of the actor 'Action' fluent API allowing action chaining.\r\n     * @param angleRadiansOffset  The angle to rotate to in radians relative to the current rotation\r\n     * @param speed          The speed in radians/sec the actor should rotate at\r\n     * @param rotationType  The [[RotationType]] to use for this rotation, default is shortest path\r\n     */\r\n    rotateBy(angleRadiansOffset, speed, rotationType) {\r\n        this._queue.add(new RotateBy(this._entity, angleRadiansOffset, speed, rotationType));\r\n        return this;\r\n    }\r\n    scaleTo(sizeXOrVector, sizeYOrSpeed, speedXOrUndefined, speedYOrUndefined) {\r\n        let sizeX = 1;\r\n        let sizeY = 1;\r\n        let speedX = 0;\r\n        let speedY = 0;\r\n        if (sizeXOrVector instanceof Vector && sizeYOrSpeed instanceof Vector) {\r\n            sizeX = sizeXOrVector.x;\r\n            sizeY = sizeXOrVector.y;\r\n            speedX = sizeYOrSpeed.x;\r\n            speedY = sizeYOrSpeed.y;\r\n        }\r\n        if (typeof sizeXOrVector === 'number' && typeof sizeYOrSpeed === 'number') {\r\n            sizeX = sizeXOrVector;\r\n            sizeY = sizeYOrSpeed;\r\n            speedX = speedXOrUndefined;\r\n            speedY = speedYOrUndefined;\r\n        }\r\n        this._queue.add(new ScaleTo(this._entity, sizeX, sizeY, speedX, speedY));\r\n        return this;\r\n    }\r\n    scaleBy(sizeOffsetXOrVector, sizeOffsetYOrSpeed, speed) {\r\n        let sizeOffsetX = 1;\r\n        let sizeOffsetY = 1;\r\n        if (sizeOffsetXOrVector instanceof Vector) {\r\n            sizeOffsetX = sizeOffsetXOrVector.x;\r\n            sizeOffsetY = sizeOffsetXOrVector.y;\r\n            speed = sizeOffsetYOrSpeed;\r\n        }\r\n        if (typeof sizeOffsetXOrVector === 'number' && typeof sizeOffsetYOrSpeed === 'number') {\r\n            sizeOffsetX = sizeOffsetXOrVector;\r\n            sizeOffsetY = sizeOffsetYOrSpeed;\r\n        }\r\n        this._queue.add(new ScaleBy(this._entity, sizeOffsetX, sizeOffsetY, speed));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will cause an actor to blink (become visible and not\r\n     * visible). Optionally, you may specify the number of blinks. Specify the amount of time\r\n     * the actor should be visible per blink, and the amount of time not visible.\r\n     * This method is part of the actor 'Action' fluent API allowing action chaining.\r\n     * @param timeVisible     The amount of time to stay visible per blink in milliseconds\r\n     * @param timeNotVisible  The amount of time to stay not visible per blink in milliseconds\r\n     * @param numBlinks       The number of times to blink\r\n     */\r\n    blink(timeVisible, timeNotVisible, numBlinks = 1) {\r\n        this._queue.add(new Blink(this._entity, timeVisible, timeNotVisible, numBlinks));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will cause an actor's opacity to change from its current value\r\n     * to the provided value by a specified time (in milliseconds). This method is\r\n     * part of the actor 'Action' fluent API allowing action chaining.\r\n     * @param opacity  The ending opacity\r\n     * @param time     The time it should take to fade the actor (in milliseconds)\r\n     */\r\n    fade(opacity, time) {\r\n        this._queue.add(new Fade(this._entity, opacity, time));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will delay the next action from executing for a certain\r\n     * amount of time (in milliseconds). This method is part of the actor\r\n     * 'Action' fluent API allowing action chaining.\r\n     * @param time  The amount of time to delay the next action in the queue from executing in milliseconds\r\n     */\r\n    delay(time) {\r\n        this._queue.add(new Delay(time));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will add an action to the queue that will remove the actor from the\r\n     * scene once it has completed its previous  Any actions on the\r\n     * action queue after this action will not be executed.\r\n     */\r\n    die() {\r\n        this._queue.add(new Die(this._entity));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method allows you to call an arbitrary method as the next action in the\r\n     * action queue. This is useful if you want to execute code in after a specific\r\n     * action, i.e An actor arrives at a destination after traversing a path\r\n     */\r\n    callMethod(method) {\r\n        this._queue.add(new CallMethod(method));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will cause the actor to repeat all of the actions built in\r\n     * the `repeatBuilder` callback. If the number of repeats\r\n     * is not specified it will repeat forever. This method is part of\r\n     * the actor 'Action' fluent API allowing action chaining\r\n     *\r\n     * ```typescript\r\n     * // Move up in a zig-zag by repeated moveBy's\r\n     * actor.actions.repeat(repeatCtx => {\r\n     *  repeatCtx.moveBy(10, 0, 10);\r\n     *  repeatCtx.moveBy(0, 10, 10);\r\n     * }, 5);\r\n     * ```\r\n     *\r\n     * @param repeatBuilder The builder to specify the repeatable list of actions\r\n     * @param times  The number of times to repeat all the previous actions in the action queue. If nothing is specified the actions\r\n     * will repeat forever\r\n     */\r\n    repeat(repeatBuilder, times) {\r\n        if (!times) {\r\n            this.repeatForever(repeatBuilder);\r\n            return this;\r\n        }\r\n        this._queue.add(new Repeat(this._entity, repeatBuilder, times));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will cause the actor to repeat all of the actions built in\r\n     * the `repeatBuilder` callback. If the number of repeats\r\n     * is not specified it will repeat forever. This method is part of\r\n     * the actor 'Action' fluent API allowing action chaining\r\n     *\r\n     * ```typescript\r\n     * // Move up in a zig-zag by repeated moveBy's\r\n     * actor.actions.repeat(repeatCtx => {\r\n     *  repeatCtx.moveBy(10, 0, 10);\r\n     *  repeatCtx.moveBy(0, 10, 10);\r\n     * }, 5);\r\n     * ```\r\n     *\r\n     * @param repeatBuilder The builder to specify the repeatable list of actions\r\n     */\r\n    repeatForever(repeatBuilder) {\r\n        this._queue.add(new RepeatForever(this._entity, repeatBuilder));\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will cause the entity to follow another at a specified distance\r\n     * @param entity           The entity to follow\r\n     * @param followDistance  The distance to maintain when following, if not specified the actor will follow at the current distance.\r\n     */\r\n    follow(entity, followDistance) {\r\n        if (followDistance === undefined) {\r\n            this._queue.add(new Follow(this._entity, entity));\r\n        }\r\n        else {\r\n            this._queue.add(new Follow(this._entity, entity, followDistance));\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * This method will cause the entity to move towards another until they\r\n     * collide \"meet\" at a specified speed.\r\n     * @param entity  The entity to meet\r\n     * @param speed  The speed in pixels per second to move, if not specified it will match the speed of the other actor\r\n     */\r\n    meet(entity, speed) {\r\n        if (speed === undefined) {\r\n            this._queue.add(new Meet(this._entity, entity));\r\n        }\r\n        else {\r\n            this._queue.add(new Meet(this._entity, entity, speed));\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Returns a promise that resolves when the current action queue up to now\r\n     * is finished.\r\n     */\r\n    toPromise() {\r\n        const temp = new Promise((resolve) => {\r\n            this._queue.add(new CallMethod(() => {\r\n                resolve();\r\n            }));\r\n        });\r\n        return temp;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/ActionsComponent.ts\n\r\n\r\n\r\n\r\n;\r\nclass ActionsComponent extends Component {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.type = 'ex.actions';\r\n        this.dependencies = [TransformComponent, MotionComponent];\r\n    }\r\n    onAdd(entity) {\r\n        this._ctx = new ActionContext(entity);\r\n    }\r\n    onRemove() {\r\n        this._ctx = null;\r\n    }\r\n    /**\r\n     * Returns the internal action queue\r\n     * @returns action queue\r\n     */\r\n    getQueue() {\r\n        var _a;\r\n        return (_a = this._ctx) === null || _a === void 0 ? void 0 : _a.getQueue();\r\n    }\r\n    runAction(action) {\r\n        var _a;\r\n        return (_a = this._ctx) === null || _a === void 0 ? void 0 : _a.runAction(action);\r\n    }\r\n    /**\r\n     * Updates the internal action context, performing action and moving through the internal queue\r\n     * @param elapsedMs\r\n     */\r\n    update(elapsedMs) {\r\n        var _a;\r\n        return (_a = this._ctx) === null || _a === void 0 ? void 0 : _a.update(elapsedMs);\r\n    }\r\n    /**\r\n     * Clears all queued actions from the Actor\r\n     */\r\n    clearActions() {\r\n        var _a;\r\n        (_a = this._ctx) === null || _a === void 0 ? void 0 : _a.clearActions();\r\n    }\r\n    easeTo(...args) {\r\n        return this._ctx.easeTo.apply(this._ctx, args);\r\n    }\r\n    easeBy(...args) {\r\n        return this._ctx.easeBy.apply(this._ctx, args);\r\n    }\r\n    moveTo(xOrPos, yOrSpeed, speedOrUndefined) {\r\n        return this._ctx.moveTo.apply(this._ctx, [xOrPos, yOrSpeed, speedOrUndefined]);\r\n    }\r\n    moveBy(xOffsetOrVector, yOffsetOrSpeed, speedOrUndefined) {\r\n        return this._ctx.moveBy.apply(this._ctx, [xOffsetOrVector, yOffsetOrSpeed, speedOrUndefined]);\r\n    }\r\n    /**\r\n     * This method will rotate an actor to the specified angle at the speed\r\n     * specified (in radians per second) and return back the actor. This\r\n     * method is part of the actor 'Action' fluent API allowing action chaining.\r\n     * @param angleRadians  The angle to rotate to in radians\r\n     * @param speed         The angular velocity of the rotation specified in radians per second\r\n     * @param rotationType  The [[RotationType]] to use for this rotation\r\n     */\r\n    rotateTo(angleRadians, speed, rotationType) {\r\n        return this._ctx.rotateTo(angleRadians, speed, rotationType);\r\n    }\r\n    /**\r\n     * This method will rotate an actor by the specified angle offset, from it's current rotation given a certain speed\r\n     * in radians/sec and return back the actor. This method is part\r\n     * of the actor 'Action' fluent API allowing action chaining.\r\n     * @param angleRadiansOffset  The angle to rotate to in radians relative to the current rotation\r\n     * @param speed          The speed in radians/sec the actor should rotate at\r\n     * @param rotationType  The [[RotationType]] to use for this rotation, default is shortest path\r\n     */\r\n    rotateBy(angleRadiansOffset, speed, rotationType) {\r\n        return this._ctx.rotateBy(angleRadiansOffset, speed, rotationType);\r\n    }\r\n    scaleTo(sizeXOrVector, sizeYOrSpeed, speedXOrUndefined, speedYOrUndefined) {\r\n        return this._ctx.scaleTo.apply(this._ctx, [sizeXOrVector, sizeYOrSpeed, speedXOrUndefined, speedYOrUndefined]);\r\n    }\r\n    scaleBy(sizeOffsetXOrVector, sizeOffsetYOrSpeed, speed) {\r\n        return this._ctx.scaleBy.apply(this._ctx, [sizeOffsetXOrVector, sizeOffsetYOrSpeed, speed]);\r\n    }\r\n    /**\r\n     * This method will cause an actor to blink (become visible and not\r\n     * visible). Optionally, you may specify the number of blinks. Specify the amount of time\r\n     * the actor should be visible per blink, and the amount of time not visible.\r\n     * This method is part of the actor 'Action' fluent API allowing action chaining.\r\n     * @param timeVisible     The amount of time to stay visible per blink in milliseconds\r\n     * @param timeNotVisible  The amount of time to stay not visible per blink in milliseconds\r\n     * @param numBlinks       The number of times to blink\r\n     */\r\n    blink(timeVisible, timeNotVisible, numBlinks) {\r\n        return this._ctx.blink(timeVisible, timeNotVisible, numBlinks);\r\n    }\r\n    /**\r\n     * This method will cause an actor's opacity to change from its current value\r\n     * to the provided value by a specified time (in milliseconds). This method is\r\n     * part of the actor 'Action' fluent API allowing action chaining.\r\n     * @param opacity  The ending opacity\r\n     * @param time     The time it should take to fade the actor (in milliseconds)\r\n     */\r\n    fade(opacity, time) {\r\n        return this._ctx.fade(opacity, time);\r\n    }\r\n    /**\r\n     * This method will delay the next action from executing for a certain\r\n     * amount of time (in milliseconds). This method is part of the actor\r\n     * 'Action' fluent API allowing action chaining.\r\n     * @param time  The amount of time to delay the next action in the queue from executing in milliseconds\r\n     */\r\n    delay(time) {\r\n        return this._ctx.delay(time);\r\n    }\r\n    /**\r\n     * This method will add an action to the queue that will remove the actor from the\r\n     * scene once it has completed its previous  Any actions on the\r\n     * action queue after this action will not be executed.\r\n     */\r\n    die() {\r\n        return this._ctx.die();\r\n    }\r\n    /**\r\n     * This method allows you to call an arbitrary method as the next action in the\r\n     * action queue. This is useful if you want to execute code in after a specific\r\n     * action, i.e An actor arrives at a destination after traversing a path\r\n     */\r\n    callMethod(method) {\r\n        return this._ctx.callMethod(method);\r\n    }\r\n    /**\r\n     * This method will cause the actor to repeat all of the actions built in\r\n     * the `repeatBuilder` callback. If the number of repeats\r\n     * is not specified it will repeat forever. This method is part of\r\n     * the actor 'Action' fluent API allowing action chaining\r\n     *\r\n     * ```typescript\r\n     * // Move up in a zig-zag by repeated moveBy's\r\n     * actor.actions.repeat(repeatCtx => {\r\n     *  repeatCtx.moveBy(10, 0, 10);\r\n     *  repeatCtx.moveBy(0, 10, 10);\r\n     * }, 5);\r\n     * ```\r\n     *\r\n     * @param repeatBuilder The builder to specify the repeatable list of actions\r\n     * @param times  The number of times to repeat all the previous actions in the action queue. If nothing is specified the actions\r\n     * will repeat forever\r\n     */\r\n    repeat(repeatBuilder, times) {\r\n        return this._ctx.repeat(repeatBuilder, times);\r\n    }\r\n    /**\r\n     * This method will cause the actor to repeat all of the actions built in\r\n     * the `repeatBuilder` callback. If the number of repeats\r\n     * is not specified it will repeat forever. This method is part of\r\n     * the actor 'Action' fluent API allowing action chaining\r\n     *\r\n     * ```typescript\r\n     * // Move up in a zig-zag by repeated moveBy's\r\n     * actor.actions.repeat(repeatCtx => {\r\n     *  repeatCtx.moveBy(10, 0, 10);\r\n     *  repeatCtx.moveBy(0, 10, 10);\r\n     * }, 5);\r\n     * ```\r\n     *\r\n     * @param repeatBuilder The builder to specify the repeatable list of actions\r\n     */\r\n    repeatForever(repeatBuilder) {\r\n        return this._ctx.repeatForever(repeatBuilder);\r\n    }\r\n    /**\r\n     * This method will cause the entity to follow another at a specified distance\r\n     * @param entity           The entity to follow\r\n     * @param followDistance  The distance to maintain when following, if not specified the actor will follow at the current distance.\r\n     */\r\n    follow(entity, followDistance) {\r\n        return this._ctx.follow(entity, followDistance);\r\n    }\r\n    /**\r\n     * This method will cause the entity to move towards another until they\r\n     * collide \"meet\" at a specified speed.\r\n     * @param entity  The entity to meet\r\n     * @param speed  The speed in pixels per second to move, if not specified it will match the speed of the other actor\r\n     */\r\n    meet(entity, speed) {\r\n        return this._ctx.meet(entity, speed);\r\n    }\r\n    /**\r\n     * Returns a promise that resolves when the current action queue up to now\r\n     * is finished.\r\n     */\r\n    toPromise() {\r\n        return this._ctx.toPromise();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/FontCommon.ts\n/**\r\n * Enum representing the different font size units\r\n * https://developer.mozilla.org/en-US/docs/Web/CSS/font-size\r\n */\r\nvar FontUnit;\r\n(function (FontUnit) {\r\n    /**\r\n     * Em is a scalable unit, 1 em is equal to the current font size of the current element, parent elements can effect em values\r\n     */\r\n    FontUnit[\"Em\"] = \"em\";\r\n    /**\r\n     * Rem is similar to the Em, it is a scalable unit. 1 rem is equal to the font size of the root element\r\n     */\r\n    FontUnit[\"Rem\"] = \"rem\";\r\n    /**\r\n     * Pixel is a unit of length in screen pixels\r\n     */\r\n    FontUnit[\"Px\"] = \"px\";\r\n    /**\r\n     * Point is a physical unit length (1/72 of an inch)\r\n     */\r\n    FontUnit[\"Pt\"] = \"pt\";\r\n    /**\r\n     * Percent is a scalable unit similar to Em, the only difference is the Em units scale faster when Text-Size stuff\r\n     */\r\n    FontUnit[\"Percent\"] = \"%\";\r\n})(FontUnit || (FontUnit = {}));\r\n/**\r\n * Enum representing the different horizontal text alignments\r\n */\r\nvar TextAlign;\r\n(function (TextAlign) {\r\n    /**\r\n     * The text is left-aligned.\r\n     */\r\n    TextAlign[\"Left\"] = \"left\";\r\n    /**\r\n     * The text is right-aligned.\r\n     */\r\n    TextAlign[\"Right\"] = \"right\";\r\n    /**\r\n     * The text is centered.\r\n     */\r\n    TextAlign[\"Center\"] = \"center\";\r\n    /**\r\n     * The text is aligned at the normal start of the line (left-aligned for left-to-right locales,\r\n     * right-aligned for right-to-left locales).\r\n     */\r\n    TextAlign[\"Start\"] = \"start\";\r\n    /**\r\n     * The text is aligned at the normal end of the line (right-aligned for left-to-right locales,\r\n     * left-aligned for right-to-left locales).\r\n     */\r\n    TextAlign[\"End\"] = \"end\";\r\n})(TextAlign || (TextAlign = {}));\r\n/**\r\n * Enum representing the different baseline text alignments\r\n */\r\nvar BaseAlign;\r\n(function (BaseAlign) {\r\n    /**\r\n     * The text baseline is the top of the em square.\r\n     */\r\n    BaseAlign[\"Top\"] = \"top\";\r\n    /**\r\n     * The text baseline is the hanging baseline.  Currently unsupported; this will act like\r\n     * alphabetic.\r\n     */\r\n    BaseAlign[\"Hanging\"] = \"hanging\";\r\n    /**\r\n     * The text baseline is the middle of the em square.\r\n     */\r\n    BaseAlign[\"Middle\"] = \"middle\";\r\n    /**\r\n     * The text baseline is the normal alphabetic baseline.\r\n     */\r\n    BaseAlign[\"Alphabetic\"] = \"alphabetic\";\r\n    /**\r\n     * The text baseline is the ideographic baseline; this is the bottom of\r\n     * the body of the characters, if the main body of characters protrudes\r\n     * beneath the alphabetic baseline.  Currently unsupported; this will\r\n     * act like alphabetic.\r\n     */\r\n    BaseAlign[\"Ideographic\"] = \"ideographic\";\r\n    /**\r\n     * The text baseline is the bottom of the bounding box.  This differs\r\n     * from the ideographic baseline in that the ideographic baseline\r\n     * doesn't consider descenders.\r\n     */\r\n    BaseAlign[\"Bottom\"] = \"bottom\";\r\n})(BaseAlign || (BaseAlign = {}));\r\n/**\r\n * Enum representing the different possible font styles\r\n */\r\nvar FontStyle;\r\n(function (FontStyle) {\r\n    FontStyle[\"Normal\"] = \"normal\";\r\n    FontStyle[\"Italic\"] = \"italic\";\r\n    FontStyle[\"Oblique\"] = \"oblique\";\r\n})(FontStyle || (FontStyle = {}));\r\n/**\r\n * Enum representing the text direction, useful for other languages, or writing text in reverse\r\n */\r\nvar Direction;\r\n(function (Direction) {\r\n    Direction[\"LeftToRight\"] = \"ltr\";\r\n    Direction[\"RightToLeft\"] = \"rtl\";\r\n})(Direction || (Direction = {}));\r\n\n;// CONCATENATED MODULE: ./Graphics/FontTextInstance.ts\n\r\n\r\n\r\n\r\nclass FontTextInstance {\r\n    constructor(font, text, color, maxWidth) {\r\n        this.font = font;\r\n        this.text = text;\r\n        this.color = color;\r\n        this.maxWidth = maxWidth;\r\n        this._textFragments = [];\r\n        this.disposed = false;\r\n        this._dirty = true;\r\n        this.canvas = document.createElement('canvas');\r\n        this.ctx = this.canvas.getContext('2d');\r\n        this.dimensions = this.measureText(text);\r\n        this._setDimension(this.dimensions, this.ctx);\r\n        this._lastHashCode = this.getHashCode();\r\n    }\r\n    measureText(text, maxWidth) {\r\n        if (this.disposed) {\r\n            throw Error('Accessing disposed text instance! ' + this.text);\r\n        }\r\n        let lines = null;\r\n        if (maxWidth != null) {\r\n            lines = this._getLinesFromText(text, maxWidth);\r\n        }\r\n        else {\r\n            lines = text.split('\\n');\r\n        }\r\n        const maxWidthLine = lines.reduce((a, b) => {\r\n            return a.length > b.length ? a : b;\r\n        });\r\n        this._applyFont(this.ctx); // font must be applied to the context to measure it\r\n        const metrics = this.ctx.measureText(maxWidthLine);\r\n        let textHeight = Math.abs(metrics.actualBoundingBoxAscent) + Math.abs(metrics.actualBoundingBoxDescent);\r\n        // TODO lineheight makes the text bounds wonky\r\n        const lineAdjustedHeight = textHeight * lines.length;\r\n        textHeight = lineAdjustedHeight;\r\n        const bottomBounds = lineAdjustedHeight - Math.abs(metrics.actualBoundingBoxAscent);\r\n        const x = 0;\r\n        const y = 0;\r\n        const measurement = new BoundingBox({\r\n            left: x - Math.abs(metrics.actualBoundingBoxLeft) - this.font.padding,\r\n            top: y - Math.abs(metrics.actualBoundingBoxAscent) - this.font.padding,\r\n            bottom: y + bottomBounds + this.font.padding,\r\n            right: x + Math.abs(metrics.actualBoundingBoxRight) + this.font.padding\r\n        });\r\n        return measurement;\r\n    }\r\n    _setDimension(textBounds, bitmap) {\r\n        // Changing the width and height clears the context properties\r\n        // We double the bitmap width to account for all possible alignment\r\n        // We scale by \"quality\" so we render text without jaggies\r\n        bitmap.canvas.width = (textBounds.width + this.font.padding * 2) * 2 * this.font.quality;\r\n        bitmap.canvas.height = (textBounds.height + this.font.padding * 2) * 2 * this.font.quality;\r\n    }\r\n    static getHashCode(font, text, color) {\r\n        var _a;\r\n        const hash = text +\r\n            '__hashcode__' +\r\n            font.fontString +\r\n            font.showDebug +\r\n            font.textAlign +\r\n            font.baseAlign +\r\n            font.direction +\r\n            JSON.stringify(font.shadow) +\r\n            (font.padding.toString() +\r\n                font.smoothing.toString() +\r\n                font.lineWidth.toString() +\r\n                font.lineDash.toString() +\r\n                ((_a = font.strokeColor) === null || _a === void 0 ? void 0 : _a.toString()) +\r\n                (color ? color.toString() : font.color.toString()));\r\n        return hash;\r\n    }\r\n    getHashCode(includeColor = true) {\r\n        return FontTextInstance.getHashCode(this.font, this.text, includeColor ? this.color : undefined);\r\n    }\r\n    _applyRasterProperties(ctx) {\r\n        var _a, _b;\r\n        ctx.translate(this.font.padding, this.font.padding);\r\n        ctx.imageSmoothingEnabled = this.font.smoothing;\r\n        ctx.lineWidth = this.font.lineWidth;\r\n        ctx.setLineDash((_a = this.font.lineDash) !== null && _a !== void 0 ? _a : ctx.getLineDash());\r\n        ctx.strokeStyle = (_b = this.font.strokeColor) === null || _b === void 0 ? void 0 : _b.toString();\r\n        ctx.fillStyle = this.color.toString();\r\n    }\r\n    _applyFont(ctx) {\r\n        ctx.resetTransform();\r\n        ctx.translate(this.font.padding + ctx.canvas.width / 2, this.font.padding + ctx.canvas.height / 2);\r\n        ctx.scale(this.font.quality, this.font.quality);\r\n        ctx.textAlign = this.font.textAlign;\r\n        ctx.textBaseline = this.font.baseAlign;\r\n        ctx.font = this.font.fontString;\r\n        ctx.direction = this.font.direction;\r\n        if (this.font.shadow) {\r\n            ctx.shadowColor = this.font.shadow.color.toString();\r\n            ctx.shadowBlur = this.font.shadow.blur;\r\n            ctx.shadowOffsetX = this.font.shadow.offset.x;\r\n            ctx.shadowOffsetY = this.font.shadow.offset.y;\r\n        }\r\n    }\r\n    _drawText(ctx, lines, lineHeight) {\r\n        this._applyRasterProperties(ctx);\r\n        this._applyFont(ctx);\r\n        for (let i = 0; i < lines.length; i++) {\r\n            const line = lines[i];\r\n            if (this.color) {\r\n                ctx.fillText(line, 0, i * lineHeight);\r\n            }\r\n            if (this.font.strokeColor) {\r\n                ctx.strokeText(line, 0, i * lineHeight);\r\n            }\r\n        }\r\n        if (this.font.showDebug) {\r\n            // Horizontal line\r\n            /* istanbul ignore next */\r\n            line(ctx, Color.Green, -ctx.canvas.width / 2, 0, ctx.canvas.width / 2, 0, 2);\r\n            // Vertical line\r\n            /* istanbul ignore next */\r\n            line(ctx, Color.Red, 0, -ctx.canvas.height / 2, 0, ctx.canvas.height / 2, 2);\r\n        }\r\n    }\r\n    _splitTextBitmap(bitmap) {\r\n        const textImages = [];\r\n        let currentX = 0;\r\n        let currentY = 0;\r\n        // 4k is the max for mobile devices\r\n        const width = Math.min(4096, bitmap.canvas.width);\r\n        const height = Math.min(4096, bitmap.canvas.height);\r\n        // Splits the original bitmap into 4k max chunks\r\n        while (currentX < bitmap.canvas.width) {\r\n            while (currentY < bitmap.canvas.height) {\r\n                // create new bitmap\r\n                const canvas = document.createElement('canvas');\r\n                canvas.width = width;\r\n                canvas.height = height;\r\n                const ctx = canvas.getContext('2d');\r\n                // draw current slice to new bitmap in < 4k chunks\r\n                ctx.drawImage(bitmap.canvas, currentX, currentY, width, height, 0, 0, width, height);\r\n                textImages.push({ x: currentX, y: currentY, canvas });\r\n                currentY += height;\r\n            }\r\n            currentX += width;\r\n            currentY = 0;\r\n        }\r\n        return textImages;\r\n    }\r\n    flagDirty() {\r\n        this._dirty = true;\r\n    }\r\n    render(ex, x, y, maxWidth) {\r\n        if (this.disposed) {\r\n            throw Error('Accessing disposed text instance! ' + this.text);\r\n        }\r\n        this._ex = ex;\r\n        const hashCode = this.getHashCode();\r\n        if (this._lastHashCode !== hashCode) {\r\n            this._dirty = true;\r\n        }\r\n        // Calculate image chunks\r\n        if (this._dirty) {\r\n            this.dimensions = this.measureText(this.text, maxWidth);\r\n            this._setDimension(this.dimensions, this.ctx);\r\n            const lines = this._getLinesFromText(this.text, maxWidth);\r\n            const lineHeight = this.dimensions.height / lines.length;\r\n            // draws the text to the main bitmap\r\n            this._drawText(this.ctx, lines, lineHeight);\r\n            // clear any out old fragments\r\n            if (ex instanceof ExcaliburGraphicsContextWebGL) {\r\n                for (const frag of this._textFragments) {\r\n                    ex.textureLoader.delete(frag.canvas);\r\n                }\r\n            }\r\n            // splits to < 4k fragments for large text\r\n            this._textFragments = this._splitTextBitmap(this.ctx);\r\n            if (ex instanceof ExcaliburGraphicsContextWebGL) {\r\n                for (const frag of this._textFragments) {\r\n                    ex.textureLoader.load(frag.canvas, this.font.filtering, true);\r\n                }\r\n            }\r\n            this._lastHashCode = hashCode;\r\n            this._dirty = false;\r\n        }\r\n        // draws the bitmap fragments to excalibur graphics context\r\n        for (const frag of this._textFragments) {\r\n            ex.drawImage(frag.canvas, 0, 0, frag.canvas.width, frag.canvas.height, frag.x / this.font.quality + x - this.ctx.canvas.width / this.font.quality / 2, frag.y / this.font.quality + y - this.ctx.canvas.height / this.font.quality / 2, frag.canvas.width / this.font.quality, frag.canvas.height / this.font.quality);\r\n        }\r\n    }\r\n    dispose() {\r\n        this.disposed = true;\r\n        this.dimensions = undefined;\r\n        this.canvas = undefined;\r\n        this.ctx = undefined;\r\n        if (this._ex instanceof ExcaliburGraphicsContextWebGL) {\r\n            for (const frag of this._textFragments) {\r\n                this._ex.textureLoader.delete(frag.canvas);\r\n            }\r\n        }\r\n        this._textFragments.length = 0;\r\n    }\r\n    _getLinesFromText(text, maxWidth) {\r\n        if (this._chachedText === text && this._cachedRenderWidth === maxWidth) {\r\n            return this._chachedLines;\r\n        }\r\n        const lines = text.split('\\n');\r\n        if (maxWidth == null) {\r\n            return lines;\r\n        }\r\n        // If the current line goes past the maxWidth, append a new line without modifying the underlying text.\r\n        for (let i = 0; i < lines.length; i++) {\r\n            let line = lines[i];\r\n            let newLine = '';\r\n            if (this.measureText(line).width > maxWidth) {\r\n                while (this.measureText(line).width > maxWidth) {\r\n                    newLine = line[line.length - 1] + newLine;\r\n                    line = line.slice(0, -1); // Remove last character from line\r\n                }\r\n                // Update the array with our new values\r\n                lines[i] = line;\r\n                lines[i + 1] = newLine;\r\n            }\r\n        }\r\n        this._chachedText = text;\r\n        this._chachedLines = lines;\r\n        this._cachedRenderWidth = maxWidth;\r\n        return lines;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/FontCache.ts\n\r\n\r\nclass FontCache {\r\n    static measureText(text, font, maxWidth) {\r\n        const hash = FontTextInstance.getHashCode(font, text);\r\n        if (FontCache._MEASURE_CACHE.has(hash)) {\r\n            return FontCache._MEASURE_CACHE.get(hash);\r\n        }\r\n        FontCache._LOGGER.debug('Font text measurement cache miss');\r\n        const measurement = font.measureTextWithoutCache(text, maxWidth);\r\n        FontCache._MEASURE_CACHE.set(hash, measurement);\r\n        return measurement;\r\n    }\r\n    static getTextInstance(text, font, color) {\r\n        const hash = FontTextInstance.getHashCode(font, text, color);\r\n        let textInstance = FontCache._TEXT_CACHE.get(hash);\r\n        if (!textInstance) {\r\n            textInstance = new FontTextInstance(font, text, color);\r\n            FontCache._TEXT_CACHE.set(hash, textInstance);\r\n            FontCache._LOGGER.debug('Font text instance cache miss');\r\n        }\r\n        // Cache the bitmap for certain amount of time\r\n        FontCache._TEXT_USAGE.set(textInstance, performance.now());\r\n        return textInstance;\r\n    }\r\n    static checkAndClearCache() {\r\n        const deferred = [];\r\n        const currentHashCodes = new Set();\r\n        for (const [textInstance, time] of FontCache._TEXT_USAGE.entries()) {\r\n            // if bitmap hasn't been used in 100 ms clear it\r\n            if (time + 100 < performance.now()) {\r\n                FontCache._LOGGER.debug(`Text cache entry timed out ${textInstance.text}`);\r\n                deferred.push(textInstance);\r\n                textInstance.dispose();\r\n            }\r\n            else {\r\n                const hash = textInstance.getHashCode(false);\r\n                currentHashCodes.add(hash);\r\n            }\r\n        }\r\n        // Deferred removal of text instances\r\n        deferred.forEach((t) => {\r\n            FontCache._TEXT_USAGE.delete(t);\r\n        });\r\n        // Regenerate text instance cache\r\n        this._TEXT_CACHE.clear();\r\n        for (const [textInstance] of this._TEXT_USAGE.entries()) {\r\n            this._TEXT_CACHE.set(textInstance.getHashCode(), textInstance);\r\n        }\r\n        // Regenerated measurement cache\r\n        const newTextMeasurementCache = new Map();\r\n        for (const current of currentHashCodes) {\r\n            if (FontCache._MEASURE_CACHE.has(current)) {\r\n                newTextMeasurementCache.set(current, FontCache._MEASURE_CACHE.get(current));\r\n            }\r\n        }\r\n        this._MEASURE_CACHE.clear();\r\n        this._MEASURE_CACHE = newTextMeasurementCache;\r\n    }\r\n    static get cacheSize() {\r\n        return FontCache._TEXT_USAGE.size;\r\n    }\r\n    /**\r\n     * Force clear all cached text bitmaps\r\n     */\r\n    static clearCache() {\r\n        for (const [textInstance] of FontCache._TEXT_USAGE.entries()) {\r\n            textInstance.dispose();\r\n        }\r\n        FontCache._TEXT_USAGE.clear();\r\n        FontCache._TEXT_CACHE.clear();\r\n        FontCache._MEASURE_CACHE.clear();\r\n    }\r\n}\r\nFontCache._LOGGER = Logger.getInstance();\r\nFontCache._TEXT_USAGE = new Map();\r\nFontCache._TEXT_CACHE = new Map();\r\nFontCache._MEASURE_CACHE = new Map();\r\n\n;// CONCATENATED MODULE: ./Graphics/Font.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Represents a system or web font in Excalibur\r\n *\r\n * If no options specified, the system sans-serif 10 pixel is used\r\n *\r\n * If loading a custom web font be sure to have the font loaded before you use it https://erikonarheim.com/posts/dont-test-fonts/\r\n */\r\nclass Font extends Graphic {\r\n    constructor(options = {}) {\r\n        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t, _u;\r\n        super(options); // <- Graphics properties\r\n        /**\r\n         * Set the font filtering mode, by default set to [[ImageFiltering.Blended]] regardless of the engine default smoothing\r\n         *\r\n         * If you have a pixel style font that may be a reason to switch this to [[ImageFiltering.Pixel]]\r\n         */\r\n        this.filtering = ImageFiltering.Blended;\r\n        /**\r\n         * Font quality determines the size of the underlying raster text, higher quality means less jagged edges.\r\n         * If quality is set to 1, then just enough raster bitmap is generated to render the text.\r\n         *\r\n         * You can think of quality as how zoomed in to the text you can get before seeing jagged edges.\r\n         *\r\n         * (Default 2)\r\n         */\r\n        this.quality = 2;\r\n        // Raster properties for fonts\r\n        this.padding = 2;\r\n        this.smoothing = false;\r\n        this.lineWidth = 1;\r\n        this.lineDash = [];\r\n        this.color = Color.Black;\r\n        this.family = 'sans-serif';\r\n        this.style = FontStyle.Normal;\r\n        this.bold = false;\r\n        this.unit = FontUnit.Px;\r\n        this.textAlign = TextAlign.Left;\r\n        this.baseAlign = BaseAlign.Alphabetic;\r\n        this.direction = Direction.LeftToRight;\r\n        this.size = 10;\r\n        this.shadow = null;\r\n        this._textBounds = new BoundingBox();\r\n        this._textMeasurement = new FontTextInstance(this, '', Color.Black);\r\n        // Raster properties\r\n        this.smoothing = (_a = options === null || options === void 0 ? void 0 : options.smoothing) !== null && _a !== void 0 ? _a : this.smoothing;\r\n        this.padding = (_b = options === null || options === void 0 ? void 0 : options.padding) !== null && _b !== void 0 ? _b : this.padding;\r\n        this.color = (_c = options === null || options === void 0 ? void 0 : options.color) !== null && _c !== void 0 ? _c : this.color;\r\n        this.strokeColor = (_d = options === null || options === void 0 ? void 0 : options.strokeColor) !== null && _d !== void 0 ? _d : this.strokeColor;\r\n        this.lineDash = (_e = options === null || options === void 0 ? void 0 : options.lineDash) !== null && _e !== void 0 ? _e : this.lineDash;\r\n        this.lineWidth = (_f = options === null || options === void 0 ? void 0 : options.lineWidth) !== null && _f !== void 0 ? _f : this.lineWidth;\r\n        this.filtering = (_g = options === null || options === void 0 ? void 0 : options.filtering) !== null && _g !== void 0 ? _g : this.filtering;\r\n        // Font specific properties\r\n        this.family = (_h = options === null || options === void 0 ? void 0 : options.family) !== null && _h !== void 0 ? _h : this.family;\r\n        this.style = (_j = options === null || options === void 0 ? void 0 : options.style) !== null && _j !== void 0 ? _j : this.style;\r\n        this.bold = (_k = options === null || options === void 0 ? void 0 : options.bold) !== null && _k !== void 0 ? _k : this.bold;\r\n        this.size = (_l = options === null || options === void 0 ? void 0 : options.size) !== null && _l !== void 0 ? _l : this.size;\r\n        this.unit = (_m = options === null || options === void 0 ? void 0 : options.unit) !== null && _m !== void 0 ? _m : this.unit;\r\n        this.textAlign = (_o = options === null || options === void 0 ? void 0 : options.textAlign) !== null && _o !== void 0 ? _o : this.textAlign;\r\n        this.baseAlign = (_p = options === null || options === void 0 ? void 0 : options.baseAlign) !== null && _p !== void 0 ? _p : this.baseAlign;\r\n        this.direction = (_q = options === null || options === void 0 ? void 0 : options.direction) !== null && _q !== void 0 ? _q : this.direction;\r\n        this.quality = (_r = options === null || options === void 0 ? void 0 : options.quality) !== null && _r !== void 0 ? _r : this.quality;\r\n        if (options === null || options === void 0 ? void 0 : options.shadow) {\r\n            this.shadow = {};\r\n            this.shadow.blur = (_s = options.shadow.blur) !== null && _s !== void 0 ? _s : this.shadow.blur;\r\n            this.shadow.offset = (_t = options.shadow.offset) !== null && _t !== void 0 ? _t : this.shadow.offset;\r\n            this.shadow.color = (_u = options.shadow.color) !== null && _u !== void 0 ? _u : this.shadow.color;\r\n        }\r\n    }\r\n    clone() {\r\n        return new Font({\r\n            ...this.cloneGraphicOptions(),\r\n            size: this.size,\r\n            unit: this.unit,\r\n            family: this.family,\r\n            style: this.style,\r\n            bold: this.bold,\r\n            textAlign: this.textAlign,\r\n            baseAlign: this.baseAlign,\r\n            direction: this.direction,\r\n            shadow: this.shadow\r\n                ? {\r\n                    blur: this.shadow.blur,\r\n                    offset: this.shadow.offset,\r\n                    color: this.shadow.color\r\n                }\r\n                : null\r\n        });\r\n    }\r\n    get fontString() {\r\n        return `${this.style} ${this.bold ? 'bold' : ''} ${this.size}${this.unit} ${this.family}`;\r\n    }\r\n    get localBounds() {\r\n        return this._textBounds;\r\n    }\r\n    _drawImage(_ex, _x, _y) {\r\n        // TODO weird vestigial drawimage\r\n    }\r\n    _rotate(ex) {\r\n        var _a;\r\n        // TODO this needs to change depending on the bounding box...\r\n        const origin = (_a = this.origin) !== null && _a !== void 0 ? _a : this._textBounds.center;\r\n        ex.translate(origin.x, origin.y);\r\n        ex.rotate(this.rotation);\r\n        ex.translate(-origin.x, -origin.y);\r\n    }\r\n    _flip(ex) {\r\n        if (this.flipHorizontal) {\r\n            ex.translate(this._textBounds.width / this.scale.x, 0);\r\n            ex.scale(-1, 1);\r\n        }\r\n        if (this.flipVertical) {\r\n            ex.translate(0, -this._textBounds.height / 2 / this.scale.y);\r\n            ex.scale(1, -1);\r\n        }\r\n    }\r\n    measureTextWithoutCache(text, maxWidth) {\r\n        return this._textMeasurement.measureText(text, maxWidth);\r\n    }\r\n    /**\r\n     * Returns a BoundingBox that is the total size of the text including multiple lines\r\n     *\r\n     * Does not include any padding or adjustment\r\n     * @param text\r\n     * @returns BoundingBox\r\n     */\r\n    measureText(text, maxWidth) {\r\n        return FontCache.measureText(text, this, maxWidth);\r\n    }\r\n    _postDraw(ex) {\r\n        ex.restore();\r\n    }\r\n    render(ex, text, colorOverride, x, y, maxWidth) {\r\n        const textInstance = FontCache.getTextInstance(text, this, colorOverride);\r\n        // Apply affine transformations\r\n        this._textBounds = textInstance.dimensions;\r\n        this._preDraw(ex, x, y);\r\n        textInstance.render(ex, x, y, maxWidth);\r\n        this._postDraw(ex);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Text.ts\n\r\n\r\n\r\n/**\r\n * Represent Text graphics in excalibur\r\n *\r\n * Useful for in game labels, ui, or overlays\r\n */\r\nclass Text extends Graphic {\r\n    constructor(options) {\r\n        var _a, _b;\r\n        super(options);\r\n        this._text = '';\r\n        this._textWidth = 0;\r\n        this._textHeight = 0;\r\n        // This order is important font, color, then text\r\n        this.font = (_a = options.font) !== null && _a !== void 0 ? _a : new Font();\r\n        this.color = (_b = options.color) !== null && _b !== void 0 ? _b : this.color;\r\n        this.text = options.text;\r\n        this.maxWidth = options.maxWidth;\r\n    }\r\n    clone() {\r\n        var _a, _b;\r\n        return new Text({\r\n            text: this.text.slice(),\r\n            color: (_b = (_a = this.color) === null || _a === void 0 ? void 0 : _a.clone()) !== null && _b !== void 0 ? _b : Color.Black,\r\n            font: this.font.clone(),\r\n            maxWidth: this.maxWidth\r\n        });\r\n    }\r\n    get text() {\r\n        return this._text;\r\n    }\r\n    set text(value) {\r\n        this._text = value;\r\n        this._calculateDimension();\r\n    }\r\n    get font() {\r\n        return this._font;\r\n    }\r\n    set font(font) {\r\n        this._font = font;\r\n    }\r\n    get width() {\r\n        if (this._textWidth === 0) {\r\n            this._calculateDimension();\r\n        }\r\n        return this._textWidth * this.scale.x;\r\n    }\r\n    get height() {\r\n        if (this._textHeight === 0) {\r\n            this._calculateDimension();\r\n        }\r\n        return this._textHeight * this.scale.y;\r\n    }\r\n    _calculateDimension() {\r\n        const { width, height } = this.font.measureText(this._text, this.maxWidth);\r\n        this._textWidth = width;\r\n        this._textHeight = height;\r\n    }\r\n    get localBounds() {\r\n        return this.font.measureText(this._text, this.maxWidth).scale(this.scale);\r\n    }\r\n    _rotate(_ex) {\r\n        // None this is delegated to font\r\n        // This override erases the default behavior\r\n    }\r\n    _flip(_ex) {\r\n        // None this is delegated to font\r\n        // This override erases the default behavior\r\n    }\r\n    _preDraw(ex, x, y) {\r\n        if (this.isStale() || this.font.isStale()) {\r\n            this.font.flipHorizontal = this.flipHorizontal;\r\n            this.font.flipVertical = this.flipVertical;\r\n            this.font.rotation = this.rotation;\r\n            this.font.origin = this.origin;\r\n            this.font.opacity = this.opacity;\r\n        }\r\n        this.font.tint = this.tint;\r\n        super._preDraw(ex, x, y);\r\n    }\r\n    _drawImage(ex, x, y) {\r\n        var _a;\r\n        let color = Color.Black;\r\n        if (this.font instanceof Font) {\r\n            color = (_a = this.color) !== null && _a !== void 0 ? _a : this.font.color;\r\n        }\r\n        const { width, height } = this.font.measureText(this._text, this.maxWidth);\r\n        this._textWidth = width;\r\n        this._textHeight = height;\r\n        this.font.render(ex, this._text, color, x, y, this.maxWidth);\r\n        if (this.font.showDebug) {\r\n            ex.debug.drawRect(x - width, y - height, width * 2, height * 2);\r\n            if (this.maxWidth != null) {\r\n                ex.debug.drawRect(x, y, this.maxWidth, this.height, {\r\n                    color: Color.Yellow\r\n                });\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actor.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Type guard for checking if something is an Actor\r\n * @param x\r\n */\r\nfunction isActor(x) {\r\n    return x instanceof Actor;\r\n}\r\nconst ActorEvents = {\r\n    CollisionStart: 'collisionstart',\r\n    CollisionEnd: 'collisionend',\r\n    PreCollision: 'precollision',\r\n    PostCollision: 'postcollision',\r\n    Kill: 'kill',\r\n    PreKill: 'prekill',\r\n    PostKill: 'postkill',\r\n    PreDraw: 'predraw',\r\n    PostDraw: 'postdraw',\r\n    PreDebugDraw: 'predebugdraw',\r\n    PostDebugDraw: 'postdebugdraw',\r\n    PointerUp: 'pointerup',\r\n    PointerDown: 'pointerdown',\r\n    PointerEnter: 'pointerenter',\r\n    PointerLeave: 'pointerleave',\r\n    PointerMove: 'pointermove',\r\n    PointerCancel: 'pointercancel',\r\n    Wheel: 'pointerwheel',\r\n    PointerDrag: 'pointerdragstart',\r\n    PointerDragEnd: 'pointerdragend',\r\n    PointerDragEnter: 'pointerdragenter',\r\n    PointerDragLeave: 'pointerdragleave',\r\n    PointerDragMove: 'pointerdragmove',\r\n    EnterViewPort: 'enterviewport',\r\n    ExitViewPort: 'exitviewport'\r\n};\r\n/**\r\n * The most important primitive in Excalibur is an `Actor`. Anything that\r\n * can move on the screen, collide with another `Actor`, respond to events,\r\n * or interact with the current scene, must be an actor. An `Actor` **must**\r\n * be part of a [[Scene]] for it to be drawn to the screen.\r\n */\r\nclass Actor extends Entity {\r\n    /**\r\n     * The physics body the is associated with this actor. The body is the container for all physical properties, like position, velocity,\r\n     * acceleration, mass, inertia, etc.\r\n     */\r\n    get body() {\r\n        return this.get(BodyComponent);\r\n    }\r\n    /**\r\n     * Access the Actor's built in [[TransformComponent]]\r\n     */\r\n    get transform() {\r\n        return this.get(TransformComponent);\r\n    }\r\n    /**\r\n     * Access the Actor's built in [[MotionComponent]]\r\n     */\r\n    get motion() {\r\n        return this.get(MotionComponent);\r\n    }\r\n    /**\r\n     * Access to the Actor's built in [[GraphicsComponent]]\r\n     */\r\n    get graphics() {\r\n        return this.get(GraphicsComponent);\r\n    }\r\n    /**\r\n     * Access to the Actor's built in [[ColliderComponent]]\r\n     */\r\n    get collider() {\r\n        return this.get(ColliderComponent);\r\n    }\r\n    /**\r\n     * Access to the Actor's built in [[PointerComponent]] config\r\n     */\r\n    get pointer() {\r\n        return this.get(PointerComponent);\r\n    }\r\n    /**\r\n     * Useful for quickly scripting actor behavior, like moving to a place, patrolling back and forth, blinking, etc.\r\n     *\r\n     *  Access to the Actor's built in [[ActionsComponent]] which forwards to the\r\n     * [[ActionContext|Action context]] of the actor.\r\n     */\r\n    get actions() {\r\n        return this.get(ActionsComponent);\r\n    }\r\n    /**\r\n     * Gets the position vector of the actor in pixels\r\n     */\r\n    get pos() {\r\n        return this.transform.pos;\r\n    }\r\n    /**\r\n     * Sets the position vector of the actor in pixels\r\n     */\r\n    set pos(thePos) {\r\n        this.transform.pos = thePos.clone();\r\n    }\r\n    /**\r\n     * Gets the position vector of the actor from the last frame\r\n     */\r\n    get oldPos() {\r\n        return this.body.oldPos;\r\n    }\r\n    /**\r\n     * Sets the position vector of the actor in the last frame\r\n     */\r\n    set oldPos(thePos) {\r\n        this.body.oldPos.setTo(thePos.x, thePos.y);\r\n    }\r\n    /**\r\n     * Gets the velocity vector of the actor in pixels/sec\r\n     */\r\n    get vel() {\r\n        return this.motion.vel;\r\n    }\r\n    /**\r\n     * Sets the velocity vector of the actor in pixels/sec\r\n     */\r\n    set vel(theVel) {\r\n        this.motion.vel = theVel.clone();\r\n    }\r\n    /**\r\n     * Gets the velocity vector of the actor from the last frame\r\n     */\r\n    get oldVel() {\r\n        return this.body.oldVel;\r\n    }\r\n    /**\r\n     * Sets the velocity vector of the actor from the last frame\r\n     */\r\n    set oldVel(theVel) {\r\n        this.body.oldVel.setTo(theVel.x, theVel.y);\r\n    }\r\n    /**\r\n     * Gets the acceleration vector of the actor in pixels/second/second. An acceleration pointing down such as (0, 100) may be\r\n     * useful to simulate a gravitational effect.\r\n     */\r\n    get acc() {\r\n        return this.motion.acc;\r\n    }\r\n    /**\r\n     * Sets the acceleration vector of teh actor in pixels/second/second\r\n     */\r\n    set acc(theAcc) {\r\n        this.motion.acc = theAcc.clone();\r\n    }\r\n    /**\r\n     * Sets the acceleration of the actor from the last frame. This does not include the global acc [[Physics.acc]].\r\n     */\r\n    set oldAcc(theAcc) {\r\n        this.body.oldAcc.setTo(theAcc.x, theAcc.y);\r\n    }\r\n    /**\r\n     * Gets the acceleration of the actor from the last frame. This does not include the global acc [[Physics.acc]].\r\n     */\r\n    get oldAcc() {\r\n        return this.body.oldAcc;\r\n    }\r\n    /**\r\n     * Gets the rotation of the actor in radians. 1 radian = 180/PI Degrees.\r\n     */\r\n    get rotation() {\r\n        return this.transform.rotation;\r\n    }\r\n    /**\r\n     * Sets the rotation of the actor in radians. 1 radian = 180/PI Degrees.\r\n     */\r\n    set rotation(theAngle) {\r\n        this.transform.rotation = theAngle;\r\n    }\r\n    /**\r\n     * Gets the rotational velocity of the actor in radians/second\r\n     */\r\n    get angularVelocity() {\r\n        return this.motion.angularVelocity;\r\n    }\r\n    /**\r\n     * Sets the rotational velocity of the actor in radians/sec\r\n     */\r\n    set angularVelocity(angularVelocity) {\r\n        this.motion.angularVelocity = angularVelocity;\r\n    }\r\n    get scale() {\r\n        return this.get(TransformComponent).scale;\r\n    }\r\n    set scale(scale) {\r\n        this.get(TransformComponent).scale = scale;\r\n    }\r\n    get anchor() {\r\n        return this._anchor;\r\n    }\r\n    set anchor(vec) {\r\n        this._anchor = watch(vec, (v) => this._handleAnchorChange(v));\r\n        this._handleAnchorChange(vec);\r\n    }\r\n    _handleAnchorChange(v) {\r\n        if (this.graphics) {\r\n            this.graphics.anchor = v;\r\n        }\r\n    }\r\n    /**\r\n     * Indicates whether the actor is physically in the viewport\r\n     */\r\n    get isOffScreen() {\r\n        return this.hasTag('ex.offscreen');\r\n    }\r\n    get draggable() {\r\n        return this._draggable;\r\n    }\r\n    set draggable(isDraggable) {\r\n        if (isDraggable) {\r\n            if (isDraggable && !this._draggable) {\r\n                this.events.on('pointerdragstart', this._pointerDragStartHandler);\r\n                this.events.on('pointerdragend', this._pointerDragEndHandler);\r\n                this.events.on('pointerdragmove', this._pointerDragMoveHandler);\r\n                this.events.on('pointerdragleave', this._pointerDragLeaveHandler);\r\n            }\r\n            else if (!isDraggable && this._draggable) {\r\n                this.events.off('pointerdragstart', this._pointerDragStartHandler);\r\n                this.events.off('pointerdragend', this._pointerDragEndHandler);\r\n                this.events.off('pointerdragmove', this._pointerDragMoveHandler);\r\n                this.events.off('pointerdragleave', this._pointerDragLeaveHandler);\r\n            }\r\n            this._draggable = isDraggable;\r\n        }\r\n    }\r\n    /**\r\n     * Sets the color of the actor's current graphic\r\n     */\r\n    get color() {\r\n        return this._color;\r\n    }\r\n    set color(v) {\r\n        var _a;\r\n        this._color = v.clone();\r\n        const defaultLayer = this.graphics.layers.default;\r\n        const currentGraphic = (_a = defaultLayer.graphics[0]) === null || _a === void 0 ? void 0 : _a.graphic;\r\n        if (currentGraphic instanceof Raster || currentGraphic instanceof Text) {\r\n            currentGraphic.color = this._color;\r\n        }\r\n    }\r\n    // #endregion\r\n    /**\r\n     *\r\n     * @param config\r\n     */\r\n    constructor(config) {\r\n        super();\r\n        this.events = new EventEmitter();\r\n        /**\r\n         * The anchor to apply all actor related transformations like rotation,\r\n         * translation, and scaling. By default the anchor is in the center of\r\n         * the actor. By default it is set to the center of the actor (.5, .5)\r\n         *\r\n         * An anchor of (.5, .5) will ensure that drawings are centered.\r\n         *\r\n         * Use `anchor.setTo` to set the anchor to a different point using\r\n         * values between 0 and 1. For example, anchoring to the top-left would be\r\n         * `Actor.anchor.setTo(0, 0)` and top-right would be `Actor.anchor.setTo(0, 1)`.\r\n         */\r\n        this._anchor = watch(Vector.Half, (v) => this._handleAnchorChange(v));\r\n        /**\r\n         * Convenience reference to the global logger\r\n         */\r\n        this.logger = Logger.getInstance();\r\n        /**\r\n         * Draggable helper\r\n         */\r\n        this._draggable = false;\r\n        this._dragging = false;\r\n        this._pointerDragStartHandler = () => {\r\n            this._dragging = true;\r\n        };\r\n        this._pointerDragEndHandler = () => {\r\n            this._dragging = false;\r\n        };\r\n        this._pointerDragMoveHandler = (pe) => {\r\n            if (this._dragging) {\r\n                this.pos = pe.worldPos;\r\n            }\r\n        };\r\n        this._pointerDragLeaveHandler = (pe) => {\r\n            if (this._dragging) {\r\n                this.pos = pe.worldPos;\r\n            }\r\n        };\r\n        const { name, x, y, pos, coordPlane, scale, width, height, radius, collider, vel, acc, rotation, angularVelocity, z, color, visible, anchor, collisionType, collisionGroup } = {\r\n            ...config\r\n        };\r\n        this._setName(name);\r\n        this.anchor = anchor !== null && anchor !== void 0 ? anchor : Actor.defaults.anchor.clone();\r\n        const tx = new TransformComponent();\r\n        this.addComponent(tx);\r\n        this.pos = pos !== null && pos !== void 0 ? pos : vec(x !== null && x !== void 0 ? x : 0, y !== null && y !== void 0 ? y : 0);\r\n        this.rotation = rotation !== null && rotation !== void 0 ? rotation : 0;\r\n        this.scale = scale !== null && scale !== void 0 ? scale : vec(1, 1);\r\n        this.z = z !== null && z !== void 0 ? z : 0;\r\n        tx.coordPlane = coordPlane !== null && coordPlane !== void 0 ? coordPlane : CoordPlane.World;\r\n        this.addComponent(new PointerComponent);\r\n        this.addComponent(new GraphicsComponent({\r\n            anchor: this.anchor\r\n        }));\r\n        this.addComponent(new MotionComponent());\r\n        this.vel = vel !== null && vel !== void 0 ? vel : Vector.Zero;\r\n        this.acc = acc !== null && acc !== void 0 ? acc : Vector.Zero;\r\n        this.angularVelocity = angularVelocity !== null && angularVelocity !== void 0 ? angularVelocity : 0;\r\n        this.addComponent(new ActionsComponent());\r\n        this.addComponent(new BodyComponent());\r\n        this.body.collisionType = collisionType !== null && collisionType !== void 0 ? collisionType : CollisionType.Passive;\r\n        if (collisionGroup) {\r\n            this.body.group = collisionGroup;\r\n        }\r\n        if (collider) {\r\n            this.addComponent(new ColliderComponent(collider));\r\n        }\r\n        else if (radius) {\r\n            this.addComponent(new ColliderComponent(Shape.Circle(radius)));\r\n        }\r\n        else {\r\n            if (width > 0 && height > 0) {\r\n                this.addComponent(new ColliderComponent(Shape.Box(width, height, this.anchor)));\r\n            }\r\n            else {\r\n                this.addComponent(new ColliderComponent()); // no collider\r\n            }\r\n        }\r\n        this.graphics.visible = visible !== null && visible !== void 0 ? visible : true;\r\n        if (color) {\r\n            this.color = color;\r\n            if (width && height) {\r\n                this.graphics.add(new Rectangle({\r\n                    color: color,\r\n                    width,\r\n                    height\r\n                }));\r\n            }\r\n            else if (radius) {\r\n                this.graphics.add(new Circle({\r\n                    color: color,\r\n                    radius\r\n                }));\r\n            }\r\n        }\r\n    }\r\n    clone() {\r\n        const clone = new Actor({\r\n            color: this.color.clone(),\r\n            anchor: this.anchor.clone()\r\n        });\r\n        clone.clearComponents();\r\n        clone.processComponentRemoval();\r\n        // Clone the current actors components\r\n        const components = this.getComponents();\r\n        for (const c of components) {\r\n            clone.addComponent(c.clone(), true);\r\n        }\r\n        return clone;\r\n    }\r\n    /**\r\n     * `onInitialize` is called before the first update of the actor. This method is meant to be\r\n     * overridden. This is where initialization of child actors should take place.\r\n     *\r\n     * Synonymous with the event handler `.on('initialize', (evt) => {...})`\r\n     */\r\n    onInitialize(_engine) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * Initializes this actor and all it's child actors, meant to be called by the Scene before first update not by users of Excalibur.\r\n     *\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * @internal\r\n     */\r\n    _initialize(engine) {\r\n        super._initialize(engine);\r\n        for (const child of this.children) {\r\n            child._initialize(engine);\r\n        }\r\n    }\r\n    emit(eventName, event) {\r\n        this.events.emit(eventName, event);\r\n    }\r\n    on(eventName, handler) {\r\n        return this.events.on(eventName, handler);\r\n    }\r\n    once(eventName, handler) {\r\n        return this.events.once(eventName, handler);\r\n    }\r\n    off(eventName, handler) {\r\n        this.events.off(eventName, handler);\r\n    }\r\n    // #endregion\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _prekill handler for [[onPreKill]] lifecycle event\r\n     * @internal\r\n     */\r\n    _prekill(_scene) {\r\n        this.events.emit('prekill', new PreKillEvent(this));\r\n        this.onPreKill(_scene);\r\n    }\r\n    /**\r\n     * Safe to override onPreKill lifecycle event handler. Synonymous with `.on('prekill', (evt) =>{...})`\r\n     *\r\n     * `onPreKill` is called directly before an actor is killed and removed from its current [[Scene]].\r\n     */\r\n    onPreKill(_scene) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _prekill handler for [[onPostKill]] lifecycle event\r\n     * @internal\r\n     */\r\n    _postkill(_scene) {\r\n        this.events.emit('postkill', new PostKillEvent(this));\r\n        this.onPostKill(_scene);\r\n    }\r\n    /**\r\n     * Safe to override onPostKill lifecycle event handler. Synonymous with `.on('postkill', (evt) => {...})`\r\n     *\r\n     * `onPostKill` is called directly after an actor is killed and remove from its current [[Scene]].\r\n     */\r\n    onPostKill(_scene) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * If the current actor is a member of the scene, this will remove\r\n     * it from the scene graph. It will no longer be drawn or updated.\r\n     */\r\n    kill() {\r\n        if (this.scene) {\r\n            this._prekill(this.scene);\r\n            this.events.emit('kill', new KillEvent(this));\r\n            super.kill();\r\n            this._postkill(this.scene);\r\n        }\r\n        else {\r\n            this.logger.warn(`Cannot kill actor named \"${this.name}\", it was never added to the Scene`);\r\n        }\r\n    }\r\n    /**\r\n     * If the current actor is killed, it will now not be killed.\r\n     */\r\n    unkill() {\r\n        this.active = true;\r\n    }\r\n    /**\r\n     * Indicates wether the actor has been killed.\r\n     */\r\n    isKilled() {\r\n        return !this.active;\r\n    }\r\n    /**\r\n     * Gets the z-index of an actor. The z-index determines the relative order an actor is drawn in.\r\n     * Actors with a higher z-index are drawn on top of actors with a lower z-index\r\n     */\r\n    get z() {\r\n        return this.get(TransformComponent).z;\r\n    }\r\n    /**\r\n     * Sets the z-index of an actor and updates it in the drawing list for the scene.\r\n     * The z-index determines the relative order an actor is drawn in.\r\n     * Actors with a higher z-index are drawn on top of actors with a lower z-index\r\n     * @param newZ new z-index to assign\r\n     */\r\n    set z(newZ) {\r\n        this.get(TransformComponent).z = newZ;\r\n    }\r\n    /**\r\n     * Get the center point of an actor (global position)\r\n     */\r\n    get center() {\r\n        const globalPos = this.getGlobalPos();\r\n        return new Vector(globalPos.x + this.width / 2 - this.anchor.x * this.width, globalPos.y + this.height / 2 - this.anchor.y * this.height);\r\n    }\r\n    /**\r\n     * Get the local center point of an actor\r\n     */\r\n    get localCenter() {\r\n        return new Vector(this.pos.x + this.width / 2 - this.anchor.x * this.width, this.pos.y + this.height / 2 - this.anchor.y * this.height);\r\n    }\r\n    get width() {\r\n        return this.collider.localBounds.width * this.getGlobalScale().x;\r\n    }\r\n    get height() {\r\n        return this.collider.localBounds.height * this.getGlobalScale().y;\r\n    }\r\n    /**\r\n     * Gets this actor's rotation taking into account any parent relationships\r\n     *\r\n     * @returns Rotation angle in radians\r\n     */\r\n    getGlobalRotation() {\r\n        return this.get(TransformComponent).globalRotation;\r\n    }\r\n    /**\r\n     * Gets an actor's world position taking into account parent relationships, scaling, rotation, and translation\r\n     *\r\n     * @returns Position in world coordinates\r\n     */\r\n    getGlobalPos() {\r\n        return this.get(TransformComponent).globalPos;\r\n    }\r\n    /**\r\n     * Gets the global scale of the Actor\r\n     */\r\n    getGlobalScale() {\r\n        return this.get(TransformComponent).globalScale;\r\n    }\r\n    // #region Collision\r\n    /**\r\n     * Tests whether the x/y specified are contained in the actor\r\n     * @param x  X coordinate to test (in world coordinates)\r\n     * @param y  Y coordinate to test (in world coordinates)\r\n     * @param recurse checks whether the x/y are contained in any child actors (if they exist).\r\n     */\r\n    contains(x, y, recurse = false) {\r\n        const point = vec(x, y);\r\n        const collider = this.get(ColliderComponent);\r\n        collider.update();\r\n        const geom = collider.get();\r\n        if (!geom) {\r\n            return false;\r\n        }\r\n        const containment = geom.contains(point);\r\n        if (recurse) {\r\n            return (containment ||\r\n                this.children.some((child) => {\r\n                    return child.contains(x, y, true);\r\n                }));\r\n        }\r\n        return containment;\r\n    }\r\n    /**\r\n     * Returns true if the two actor.collider's surfaces are less than or equal to the distance specified from each other\r\n     * @param actor     Actor to test\r\n     * @param distance  Distance in pixels to test\r\n     */\r\n    within(actor, distance) {\r\n        const collider = this.get(ColliderComponent);\r\n        const otherCollider = actor.get(ColliderComponent);\r\n        const me = collider.get();\r\n        const other = otherCollider.get();\r\n        if (me && other) {\r\n            return me.getClosestLineBetween(other).getLength() <= distance;\r\n        }\r\n        return false;\r\n    }\r\n    // #endregion\r\n    // #region Update\r\n    /**\r\n     * Called by the Engine, updates the state of the actor\r\n     * @internal\r\n     * @param engine The reference to the current game engine\r\n     * @param delta  The time elapsed since the last update in milliseconds\r\n     */\r\n    update(engine, delta) {\r\n        this._initialize(engine);\r\n        this._preupdate(engine, delta);\r\n        this._postupdate(engine, delta);\r\n    }\r\n    /**\r\n     * Safe to override onPreUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPreUpdate` is called directly before an actor is updated.\r\n     */\r\n    onPreUpdate(_engine, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('postupdate', (evt) =>{...})`\r\n     *\r\n     * `onPostUpdate` is called directly after an actor is updated.\r\n     */\r\n    onPostUpdate(_engine, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPreUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _preupdate(engine, delta) {\r\n        this.events.emit('preupdate', new PreUpdateEvent(engine, delta, this));\r\n        this.onPreUpdate(engine, delta);\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPostUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _postupdate(engine, delta) {\r\n        this.events.emit('postupdate', new PostUpdateEvent(engine, delta, this));\r\n        this.onPostUpdate(engine, delta);\r\n    }\r\n}\r\n// #region Properties\r\n/**\r\n * Set defaults for all Actors\r\n */\r\nActor.defaults = {\r\n    anchor: Vector.Half\r\n};\r\n\n;// CONCATENATED MODULE: ./ScreenElement.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Type guard to detect a screen element\r\n */\r\nfunction isScreenElement(actor) {\r\n    return actor instanceof ScreenElement;\r\n}\r\n/**\r\n * Helper [[Actor]] primitive for drawing UI's, optimized for UI drawing. Does\r\n * not participate in collisions. Drawn on top of all other actors.\r\n */\r\nclass ScreenElement extends Actor {\r\n    constructor(config) {\r\n        var _a, _b;\r\n        super({ ...config });\r\n        this.get(TransformComponent).coordPlane = CoordPlane.Screen;\r\n        this.anchor = (_a = config === null || config === void 0 ? void 0 : config.anchor) !== null && _a !== void 0 ? _a : vec(0, 0);\r\n        this.body.collisionType = (_b = config === null || config === void 0 ? void 0 : config.collisionType) !== null && _b !== void 0 ? _b : CollisionType.PreventCollision;\r\n        this.pointer.useGraphicsBounds = true;\r\n        this.pointer.useColliderShape = false;\r\n        if (!(config === null || config === void 0 ? void 0 : config.collider) &&\r\n            (config === null || config === void 0 ? void 0 : config.width) > 0 &&\r\n            (config === null || config === void 0 ? void 0 : config.height) > 0) {\r\n            this.collider.useBoxCollider(this.width, this.height, this.anchor);\r\n        }\r\n    }\r\n    _initialize(engine) {\r\n        this._engine = engine;\r\n        super._initialize(engine);\r\n    }\r\n    contains(x, y, useWorld = true) {\r\n        if (useWorld) {\r\n            return super.contains(x, y);\r\n        }\r\n        const coords = this._engine.worldToScreenCoordinates(new Vector(x, y));\r\n        return super.contains(coords.x, coords.y);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Timer.ts\n\r\n\r\n/**\r\n * The Excalibur timer hooks into the internal timer and fires callbacks,\r\n * after a certain interval, optionally repeating.\r\n */\r\nclass Timer {\r\n    get complete() {\r\n        return this._complete;\r\n    }\r\n    constructor(fcn, interval, repeats, numberOfRepeats, randomRange, random) {\r\n        this._logger = Logger.getInstance();\r\n        this.id = 0;\r\n        this._elapsedTime = 0;\r\n        this._totalTimeAlive = 0;\r\n        this._running = false;\r\n        this._numberOfTicks = 0;\r\n        this.interval = 10;\r\n        this.repeats = false;\r\n        this.maxNumberOfRepeats = -1;\r\n        this.randomRange = [0, 0];\r\n        this._baseInterval = 10;\r\n        this._generateRandomInterval = () => {\r\n            return this._baseInterval + this.random.integer(this.randomRange[0], this.randomRange[1]);\r\n        };\r\n        this._complete = false;\r\n        this.scene = null;\r\n        if (typeof fcn !== 'function') {\r\n            const options = fcn;\r\n            fcn = options.fcn;\r\n            interval = options.interval;\r\n            repeats = options.repeats;\r\n            numberOfRepeats = options.numberOfRepeats;\r\n            randomRange = options.randomRange;\r\n            random = options.random;\r\n        }\r\n        if (!!numberOfRepeats && numberOfRepeats >= 0) {\r\n            this.maxNumberOfRepeats = numberOfRepeats;\r\n            if (!repeats) {\r\n                throw new Error('repeats must be set to true if numberOfRepeats is set');\r\n            }\r\n        }\r\n        this.id = Timer._MAX_ID++;\r\n        this._callbacks = [];\r\n        this._baseInterval = this.interval = interval;\r\n        if (!!randomRange) {\r\n            if (randomRange[0] > randomRange[1]) {\r\n                throw new Error('min value must be lower than max value for range');\r\n            }\r\n            //We use the instance of ex.Random to generate the range\r\n            this.random = random !== null && random !== void 0 ? random : new Random();\r\n            this.randomRange = randomRange;\r\n            this.interval = this._generateRandomInterval();\r\n            this.on(() => {\r\n                this.interval = this._generateRandomInterval();\r\n            });\r\n        }\r\n        ;\r\n        this.repeats = repeats || this.repeats;\r\n        if (fcn) {\r\n            this.on(fcn);\r\n        }\r\n    }\r\n    /**\r\n     * Adds a new callback to be fired after the interval is complete\r\n     * @param fcn The callback to be added to the callback list, to be fired after the interval is complete.\r\n     */\r\n    on(fcn) {\r\n        this._callbacks.push(fcn);\r\n    }\r\n    /**\r\n     * Removes a callback from the callback list to be fired after the interval is complete.\r\n     * @param fcn The callback to be removed from the callback list, to be fired after the interval is complete.\r\n     */\r\n    off(fcn) {\r\n        const index = this._callbacks.indexOf(fcn);\r\n        this._callbacks.splice(index, 1);\r\n    }\r\n    /**\r\n     * Updates the timer after a certain number of milliseconds have elapsed. This is used internally by the engine.\r\n     * @param delta  Number of elapsed milliseconds since the last update.\r\n     */\r\n    update(delta) {\r\n        if (this._running) {\r\n            this._totalTimeAlive += delta;\r\n            this._elapsedTime += delta;\r\n            if (this.maxNumberOfRepeats > -1 && this._numberOfTicks >= this.maxNumberOfRepeats) {\r\n                this._complete = true;\r\n                this._running = false;\r\n                this._elapsedTime = 0;\r\n            }\r\n            if (!this.complete && this._elapsedTime >= this.interval) {\r\n                this._callbacks.forEach((c) => {\r\n                    c.call(this);\r\n                });\r\n                this._numberOfTicks++;\r\n                if (this.repeats) {\r\n                    this._elapsedTime = 0;\r\n                }\r\n                else {\r\n                    this._complete = true;\r\n                    this._running = false;\r\n                    this._elapsedTime = 0;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Resets the timer so that it can be reused, and optionally reconfigure the timers interval.\r\n     *\r\n     * Warning** you may need to call `timer.start()` again if the timer had completed\r\n     * @param newInterval If specified, sets a new non-negative interval in milliseconds to refire the callback\r\n     * @param newNumberOfRepeats If specified, sets a new non-negative upper limit to the number of time this timer executes\r\n     */\r\n    reset(newInterval, newNumberOfRepeats) {\r\n        if (!!newInterval && newInterval >= 0) {\r\n            this._baseInterval = this.interval = newInterval;\r\n        }\r\n        if (!!this.maxNumberOfRepeats && this.maxNumberOfRepeats >= 0) {\r\n            this.maxNumberOfRepeats = newNumberOfRepeats;\r\n            if (!this.repeats) {\r\n                throw new Error('repeats must be set to true if numberOfRepeats is set');\r\n            }\r\n        }\r\n        this._complete = false;\r\n        this._elapsedTime = 0;\r\n        this._numberOfTicks = 0;\r\n    }\r\n    get timesRepeated() {\r\n        return this._numberOfTicks;\r\n    }\r\n    getTimeRunning() {\r\n        return this._totalTimeAlive;\r\n    }\r\n    /**\r\n     * @returns milliseconds until the next action callback, if complete will return 0\r\n     */\r\n    get timeToNextAction() {\r\n        if (this.complete) {\r\n            return 0;\r\n        }\r\n        return this.interval - this._elapsedTime;\r\n    }\r\n    /**\r\n     * @returns milliseconds elapsed toward the next action\r\n     */\r\n    get timeElapsedTowardNextAction() {\r\n        return this._elapsedTime;\r\n    }\r\n    get isRunning() {\r\n        return this._running;\r\n    }\r\n    /**\r\n     * Pauses the timer, time will no longer increment towards the next call\r\n     */\r\n    pause() {\r\n        this._running = false;\r\n        return this;\r\n    }\r\n    /**\r\n     * Resumes the timer, time will now increment towards the next call.\r\n     */\r\n    resume() {\r\n        this._running = true;\r\n        return this;\r\n    }\r\n    /**\r\n     * Starts the timer, if the timer was complete it will restart the timer and reset the elapsed time counter\r\n     */\r\n    start() {\r\n        if (!this.scene) {\r\n            this._logger.warn('Cannot start a timer not part of a scene, timer wont start until added');\r\n        }\r\n        this._running = true;\r\n        if (this.complete) {\r\n            this._complete = false;\r\n            this._elapsedTime = 0;\r\n            this._numberOfTicks = 0;\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Stops the timer and resets the elapsed time counter towards the next action invocation\r\n     */\r\n    stop() {\r\n        this._running = false;\r\n        this._elapsedTime = 0;\r\n        this._numberOfTicks = 0;\r\n        return this;\r\n    }\r\n    /**\r\n     * Cancels the timer, preventing any further executions.\r\n     */\r\n    cancel() {\r\n        this.pause();\r\n        if (this.scene) {\r\n            this.scene.cancelTimer(this);\r\n        }\r\n    }\r\n}\r\nTimer._MAX_ID = 0;\r\n\n;// CONCATENATED MODULE: ./Graphics/ParallaxComponent.ts\n\r\n\r\nclass ParallaxComponent extends Component {\r\n    constructor(parallaxFactor) {\r\n        super();\r\n        this.type = 'ex.parallax';\r\n        this.parallaxFactor = vec(1.0, 1.0);\r\n        this.parallaxFactor = parallaxFactor !== null && parallaxFactor !== void 0 ? parallaxFactor : this.parallaxFactor;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/DebugGraphicsComponent.ts\n\r\n/**\r\n * Provide arbitrary drawing for the purposes of debugging your game\r\n *\r\n * Will only show when the Engine is set to debug mode [[Engine.showDebug]] or [[Engine.toggleDebug]]\r\n *\r\n */\r\nclass DebugGraphicsComponent extends Component {\r\n    constructor(draw, useTransform = true) {\r\n        super();\r\n        this.draw = draw;\r\n        this.useTransform = useTransform;\r\n        this.type = 'ex.debuggraphics';\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./TileMap/TileMap.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst TileMapEvents = {\r\n    PreUpdate: 'preupdate',\r\n    PostUpdate: 'postupdate',\r\n    PreDraw: 'predraw',\r\n    PostDraw: 'postdraw'\r\n};\r\n/**\r\n * The TileMap provides a mechanism for doing flat 2D tiles rendered in a grid.\r\n *\r\n * TileMaps are useful for top down or side scrolling grid oriented games.\r\n */\r\nclass TileMap extends Entity {\r\n    flagCollidersDirty() {\r\n        this._collidersDirty = true;\r\n    }\r\n    flagTilesDirty() {\r\n        for (let i = 0; i < this.tiles.length; i++) {\r\n            if (this.tiles[i]) {\r\n                this.tiles[i].flagDirty();\r\n            }\r\n        }\r\n    }\r\n    get x() {\r\n        var _a;\r\n        return (_a = this._transform.pos.x) !== null && _a !== void 0 ? _a : 0;\r\n    }\r\n    set x(val) {\r\n        var _a;\r\n        if ((_a = this._transform) === null || _a === void 0 ? void 0 : _a.pos) {\r\n            this.get(TransformComponent).pos = vec(val, this.y);\r\n        }\r\n    }\r\n    get y() {\r\n        var _a, _b;\r\n        return (_b = (_a = this._transform) === null || _a === void 0 ? void 0 : _a.pos.y) !== null && _b !== void 0 ? _b : 0;\r\n    }\r\n    set y(val) {\r\n        var _a;\r\n        if ((_a = this._transform) === null || _a === void 0 ? void 0 : _a.pos) {\r\n            this._transform.pos = vec(this.x, val);\r\n        }\r\n    }\r\n    get z() {\r\n        var _a;\r\n        return (_a = this._transform.z) !== null && _a !== void 0 ? _a : 0;\r\n    }\r\n    set z(val) {\r\n        if (this._transform) {\r\n            this._transform.z = val;\r\n        }\r\n    }\r\n    get rotation() {\r\n        var _a, _b;\r\n        return (_b = (_a = this._transform) === null || _a === void 0 ? void 0 : _a.rotation) !== null && _b !== void 0 ? _b : 0;\r\n    }\r\n    set rotation(val) {\r\n        var _a;\r\n        if ((_a = this._transform) === null || _a === void 0 ? void 0 : _a.rotation) {\r\n            this._transform.rotation = val;\r\n        }\r\n    }\r\n    get scale() {\r\n        var _a, _b;\r\n        return (_b = (_a = this._transform) === null || _a === void 0 ? void 0 : _a.scale) !== null && _b !== void 0 ? _b : Vector.One;\r\n    }\r\n    set scale(val) {\r\n        var _a;\r\n        if ((_a = this._transform) === null || _a === void 0 ? void 0 : _a.scale) {\r\n            this._transform.scale = val;\r\n        }\r\n    }\r\n    get pos() {\r\n        return this._transform.pos;\r\n    }\r\n    set pos(val) {\r\n        this._transform.pos = val;\r\n    }\r\n    get vel() {\r\n        return this._motion.vel;\r\n    }\r\n    set vel(val) {\r\n        this._motion.vel = val;\r\n    }\r\n    emit(eventName, event) {\r\n        this.events.emit(eventName, event);\r\n    }\r\n    on(eventName, handler) {\r\n        return this.events.on(eventName, handler);\r\n    }\r\n    once(eventName, handler) {\r\n        return this.events.once(eventName, handler);\r\n    }\r\n    off(eventName, handler) {\r\n        this.events.off(eventName, handler);\r\n    }\r\n    /**\r\n     * @param options\r\n     */\r\n    constructor(options) {\r\n        var _a, _b;\r\n        super(null, options.name);\r\n        this.events = new EventEmitter();\r\n        this._token = 0;\r\n        this.logger = Logger.getInstance();\r\n        this.tiles = [];\r\n        this._rows = [];\r\n        this._cols = [];\r\n        this.renderFromTopOfGraphic = false;\r\n        this._collidersDirty = true;\r\n        this._originalOffsets = new WeakMap();\r\n        this.addComponent(new TransformComponent());\r\n        this.addComponent(new MotionComponent());\r\n        this.addComponent(new BodyComponent({\r\n            type: CollisionType.Fixed\r\n        }));\r\n        this.addComponent(new GraphicsComponent({\r\n            onPostDraw: (ctx, delta) => this.draw(ctx, delta)\r\n        }));\r\n        this.addComponent(new DebugGraphicsComponent((ctx) => this.debug(ctx)));\r\n        this.addComponent(new ColliderComponent());\r\n        this._graphics = this.get(GraphicsComponent);\r\n        this._transform = this.get(TransformComponent);\r\n        this._motion = this.get(MotionComponent);\r\n        this._collider = this.get(ColliderComponent);\r\n        this._composite = this._collider.useCompositeCollider([]);\r\n        this._transform.pos = (_a = options.pos) !== null && _a !== void 0 ? _a : Vector.Zero;\r\n        this._oldPos = this._transform.pos.clone();\r\n        this._oldScale = this._transform.scale.clone();\r\n        this.renderFromTopOfGraphic = (_b = options.renderFromTopOfGraphic) !== null && _b !== void 0 ? _b : this.renderFromTopOfGraphic;\r\n        this.tileWidth = options.tileWidth;\r\n        this.tileHeight = options.tileHeight;\r\n        this.rows = options.rows;\r\n        this.columns = options.columns;\r\n        this.tiles = new Array(this.rows * this.columns);\r\n        this._rows = new Array(this.rows);\r\n        this._cols = new Array(this.columns);\r\n        let currentCol = [];\r\n        for (let i = 0; i < this.columns; i++) {\r\n            for (let j = 0; j < this.rows; j++) {\r\n                const cd = new Tile({\r\n                    x: i,\r\n                    y: j,\r\n                    map: this\r\n                });\r\n                cd.map = this;\r\n                this.tiles[i + j * this.columns] = cd;\r\n                currentCol.push(cd);\r\n                if (!this._rows[j]) {\r\n                    this._rows[j] = [];\r\n                }\r\n                this._rows[j].push(cd);\r\n            }\r\n            this._cols[i] = currentCol;\r\n            currentCol = [];\r\n        }\r\n        this._graphics.localBounds = new BoundingBox({\r\n            left: 0,\r\n            top: 0,\r\n            right: this.columns * this.tileWidth * this.scale.x,\r\n            bottom: this.rows * this.tileHeight * this.scale.y\r\n        });\r\n    }\r\n    _initialize(engine) {\r\n        super._initialize(engine);\r\n        this._engine = engine;\r\n    }\r\n    _getOrSetColliderOriginalOffset(collider) {\r\n        if (!this._originalOffsets.has(collider)) {\r\n            const originalOffset = collider.offset;\r\n            this._originalOffsets.set(collider, originalOffset);\r\n            return originalOffset;\r\n        }\r\n        else {\r\n            return this._originalOffsets.get(collider);\r\n        }\r\n    }\r\n    /**\r\n     * Tiles colliders based on the solid tiles in the tilemap.\r\n     */\r\n    _updateColliders() {\r\n        this._collider.$colliderRemoved.notifyAll(this._composite);\r\n        this._composite.clearColliders();\r\n        const colliders = [];\r\n        this._composite = this._collider.useCompositeCollider([]);\r\n        let current;\r\n        // Bad square tesselation algo\r\n        for (let i = 0; i < this.columns; i++) {\r\n            // Scan column for colliders\r\n            for (let j = 0; j < this.rows; j++) {\r\n                // Columns start with a new collider\r\n                if (j === 0) {\r\n                    current = null;\r\n                }\r\n                const tile = this.tiles[i + j * this.columns];\r\n                // Current tile in column is solid build up current collider\r\n                if (tile.solid) {\r\n                    // Use custom collider otherwise bounding box\r\n                    if (tile.getColliders().length > 0) {\r\n                        // tile with custom collider interrupting the current run\r\n                        for (const collider of tile.getColliders()) {\r\n                            const originalOffset = this._getOrSetColliderOriginalOffset(collider);\r\n                            collider.offset = vec(tile.x * this.tileWidth * this.scale.x, tile.y * this.tileHeight * this.scale.y).add(originalOffset);\r\n                            collider.owner = this;\r\n                            this._composite.addCollider(collider);\r\n                        }\r\n                        //we push any current collider before nulling the current run\r\n                        if (current) {\r\n                            colliders.push(current);\r\n                        }\r\n                        current = null;\r\n                    }\r\n                    else {\r\n                        if (!current) {\r\n                            // no current run, start one\r\n                            current = tile.bounds;\r\n                        }\r\n                        else {\r\n                            // combine with current run\r\n                            current = current.combine(tile.bounds);\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    // Not solid skip and cut off the current collider\r\n                    if (current) {\r\n                        colliders.push(current);\r\n                    }\r\n                    current = null;\r\n                }\r\n            }\r\n            // After a column is complete check to see if it can be merged into the last one\r\n            if (current) {\r\n                // if previous is the same combine it\r\n                const prev = colliders[colliders.length - 1];\r\n                if (prev && prev.top === current.top && prev.bottom === current.bottom) {\r\n                    colliders[colliders.length - 1] = prev.combine(current);\r\n                }\r\n                else {\r\n                    // else new collider\r\n                    colliders.push(current);\r\n                }\r\n            }\r\n        }\r\n        for (const c of colliders) {\r\n            const collider = Shape.Box(c.width, c.height, Vector.Zero, vec(c.left - this.pos.x, c.top - this.pos.y));\r\n            collider.owner = this;\r\n            this._composite.addCollider(collider);\r\n        }\r\n        this._collider.update();\r\n        // Notify that colliders have been updated\r\n        this._collider.$colliderAdded.notifyAll(this._composite);\r\n    }\r\n    /**\r\n     * Returns the [[Tile]] by index (row major order)\r\n     */\r\n    getTileByIndex(index) {\r\n        return this.tiles[index];\r\n    }\r\n    /**\r\n     * Returns the [[Tile]] by its x and y integer coordinates\r\n     */\r\n    getTile(x, y) {\r\n        if (x < 0 || y < 0 || x >= this.columns || y >= this.rows) {\r\n            return null;\r\n        }\r\n        return this.tiles[x + y * this.columns];\r\n    }\r\n    /**\r\n     * Returns the [[Tile]] by testing a point in world coordinates,\r\n     * returns `null` if no Tile was found.\r\n     */\r\n    getTileByPoint(point) {\r\n        const x = Math.floor((point.x - this.pos.x) / (this.tileWidth * this.scale.x));\r\n        const y = Math.floor((point.y - this.pos.y) / (this.tileHeight * this.scale.y));\r\n        const tile = this.getTile(x, y);\r\n        if (x >= 0 && y >= 0 && x < this.columns && y < this.rows && tile) {\r\n            return tile;\r\n        }\r\n        return null;\r\n    }\r\n    getRows() {\r\n        return this._rows;\r\n    }\r\n    getColumns() {\r\n        return this._cols;\r\n    }\r\n    update(engine, delta) {\r\n        this.onPreUpdate(engine, delta);\r\n        this.emit('preupdate', new PreUpdateEvent(engine, delta, this));\r\n        if (!this._oldPos.equals(this.pos) ||\r\n            !this._oldScale.equals(this.scale)) {\r\n            this.flagCollidersDirty();\r\n            this.flagTilesDirty();\r\n        }\r\n        if (this._collidersDirty) {\r\n            this._collidersDirty = false;\r\n            this._updateColliders();\r\n        }\r\n        this._token++;\r\n        this.pos.clone(this._oldPos);\r\n        this.scale.clone(this._oldScale);\r\n        this._transform.pos = this.pos;\r\n        this.onPostUpdate(engine, delta);\r\n        this.emit('postupdate', new PostUpdateEvent(engine, delta, this));\r\n    }\r\n    /**\r\n     * Draws the tile map to the screen. Called by the [[Scene]].\r\n     * @param ctx ExcaliburGraphicsContext\r\n     * @param delta  The number of milliseconds since the last draw\r\n     */\r\n    draw(ctx, delta) {\r\n        this.emit('predraw', new PreDrawEvent(ctx, delta, this)); // TODO fix event\r\n        let worldBounds = this._engine.screen.getWorldBounds();\r\n        // TODO can we trim this down by using world bounds?\r\n        let x = 0;\r\n        const xEnd = this.columns;\r\n        let y = 0;\r\n        const yEnd = this.rows;\r\n        let graphics, graphicsIndex, graphicsLen;\r\n        const maybeParallax = this.get(ParallaxComponent);\r\n        if (maybeParallax) {\r\n            let pos = this.pos;\r\n            const oneMinusFactor = Vector.One.sub(maybeParallax.parallaxFactor);\r\n            const parallaxOffset = this._engine.currentScene.camera.pos.scale(oneMinusFactor);\r\n            pos = pos.sub(parallaxOffset);\r\n            // adjust world bounds by parallax factor\r\n            worldBounds = worldBounds.translate(pos);\r\n        }\r\n        let tile;\r\n        for (x; x < xEnd; x++) {\r\n            for (y; y < yEnd; y++) {\r\n                tile = this.getTile(x, y);\r\n                // fixme: This has a large perf impact, we iterate over every tile in the tilemap\r\n                // this probably requires a spatial data structure to do more efficiently\r\n                if (!worldBounds.overlaps(tile.bounds)) {\r\n                    continue;\r\n                }\r\n                // get non-negative tile sprites\r\n                graphics = this.getTile(x, y).getGraphics();\r\n                for (graphicsIndex = 0, graphicsLen = graphics.length; graphicsIndex < graphicsLen; graphicsIndex++) {\r\n                    // draw sprite, warning if sprite doesn't exist\r\n                    const graphic = graphics[graphicsIndex];\r\n                    if (graphic) {\r\n                        if (hasGraphicsTick(graphic)) {\r\n                            graphic === null || graphic === void 0 ? void 0 : graphic.tick(delta, this._token);\r\n                        }\r\n                        const offsetY = this.renderFromTopOfGraphic ? 0 : (graphic.height - this.tileHeight);\r\n                        graphic.draw(ctx, x * this.tileWidth, y * this.tileHeight - offsetY);\r\n                    }\r\n                }\r\n            }\r\n            y = 0;\r\n        }\r\n        this.emit('postdraw', new PostDrawEvent(ctx, delta, this));\r\n    }\r\n    debug(gfx) {\r\n        const width = this.tileWidth * this.columns;\r\n        const height = this.tileHeight * this.rows;\r\n        const pos = Vector.Zero;\r\n        for (let r = 0; r < this.rows + 1; r++) {\r\n            const yOffset = vec(0, r * this.tileHeight);\r\n            gfx.drawLine(pos.add(yOffset), pos.add(vec(width, yOffset.y)), Color.Red, 2);\r\n        }\r\n        for (let c = 0; c < this.columns + 1; c++) {\r\n            const xOffset = vec(c * this.tileWidth, 0);\r\n            gfx.drawLine(pos.add(xOffset), pos.add(vec(xOffset.x, height)), Color.Red, 2);\r\n        }\r\n        const colliders = this._composite.getColliders();\r\n        for (const collider of colliders) {\r\n            const grayish = Color.Gray;\r\n            grayish.a = 0.5;\r\n            const bounds = collider.localBounds;\r\n            const pos = collider.worldPos.sub(this.pos);\r\n            gfx.drawRectangle(pos, bounds.width, bounds.height, grayish);\r\n        }\r\n    }\r\n}\r\n/**\r\n * TileMap Tile\r\n *\r\n * A light-weight object that occupies a space in a collision map. Generally\r\n * created by a [[TileMap]].\r\n *\r\n * Tiles can draw multiple sprites. Note that the order of drawing is the order\r\n * of the sprites in the array so the last one will be drawn on top. You can\r\n * use transparency to create layers this way.\r\n */\r\nclass Tile extends Entity {\r\n    // private _transform: TransformComponent;\r\n    /**\r\n     * Return the world position of the top left corner of the tile\r\n     */\r\n    get pos() {\r\n        if (this._posDirty) {\r\n            this._recalculate();\r\n            this._posDirty = false;\r\n        }\r\n        return this._pos;\r\n    }\r\n    /**\r\n     * Width of the tile in pixels\r\n     */\r\n    get width() {\r\n        return this._width;\r\n    }\r\n    /**\r\n     * Height of the tile in pixels\r\n     */\r\n    get height() {\r\n        return this._height;\r\n    }\r\n    /**\r\n     * Wether this tile should be treated as solid by the tilemap\r\n     */\r\n    get solid() {\r\n        return this._solid;\r\n    }\r\n    /**\r\n     * Wether this tile should be treated as solid by the tilemap\r\n     */\r\n    set solid(val) {\r\n        var _a;\r\n        (_a = this.map) === null || _a === void 0 ? void 0 : _a.flagCollidersDirty();\r\n        this._solid = val;\r\n    }\r\n    /**\r\n     * Current list of graphics for this tile\r\n     */\r\n    getGraphics() {\r\n        return this._graphics;\r\n    }\r\n    /**\r\n     * Add another [[Graphic]] to this TileMap tile\r\n     * @param graphic\r\n     */\r\n    addGraphic(graphic) {\r\n        this._graphics.push(graphic);\r\n    }\r\n    /**\r\n     * Remove an instance of a [[Graphic]] from this tile\r\n     */\r\n    removeGraphic(graphic) {\r\n        removeItemFromArray(graphic, this._graphics);\r\n    }\r\n    /**\r\n     * Clear all graphics from this tile\r\n     */\r\n    clearGraphics() {\r\n        this._graphics.length = 0;\r\n    }\r\n    /**\r\n     * Returns the list of colliders\r\n     */\r\n    getColliders() {\r\n        return this._colliders;\r\n    }\r\n    /**\r\n     * Adds a custom collider to the [[Tile]] to use instead of it's bounds\r\n     *\r\n     * If no collider is set but [[Tile.solid]] is set, the tile bounds are used as a collider.\r\n     *\r\n     * **Note!** the [[Tile.solid]] must be set to true for it to act as a \"fixed\" collider\r\n     * @param collider\r\n     */\r\n    addCollider(collider) {\r\n        this._colliders.push(collider);\r\n        this.map.flagCollidersDirty();\r\n    }\r\n    /**\r\n     * Removes a collider from the [[Tile]]\r\n     * @param collider\r\n     */\r\n    removeCollider(collider) {\r\n        const index = this._colliders.indexOf(collider);\r\n        if (index > -1) {\r\n            this._colliders.splice(index, 1);\r\n        }\r\n        this.map.flagCollidersDirty();\r\n    }\r\n    /**\r\n     * Clears all colliders from the [[Tile]]\r\n     */\r\n    clearColliders() {\r\n        this._colliders.length = 0;\r\n        this.map.flagCollidersDirty();\r\n    }\r\n    constructor(options) {\r\n        var _a, _b;\r\n        super();\r\n        this._posDirty = false;\r\n        this._solid = false;\r\n        this._graphics = [];\r\n        /**\r\n         * Current list of colliders for this tile\r\n         */\r\n        this._colliders = [];\r\n        /**\r\n         * Arbitrary data storage per tile, useful for any game specific data\r\n         */\r\n        this.data = new Map();\r\n        this.x = options.x;\r\n        this.y = options.y;\r\n        this.map = options.map;\r\n        this._width = options.map.tileWidth * this.map.scale.x;\r\n        this._height = options.map.tileHeight * this.map.scale.y;\r\n        this.solid = (_a = options.solid) !== null && _a !== void 0 ? _a : this.solid;\r\n        this._graphics = (_b = options.graphics) !== null && _b !== void 0 ? _b : [];\r\n        this._recalculate();\r\n    }\r\n    flagDirty() {\r\n        return this._posDirty = true;\r\n    }\r\n    _recalculate() {\r\n        this._width = this.map.tileWidth * this.map.scale.x;\r\n        this._height = this.map.tileHeight * this.map.scale.y;\r\n        this._pos = this.map.pos.add(vec(this.x * this._width, this.y * this._height));\r\n        this._bounds = new BoundingBox(this._pos.x, this._pos.y, this._pos.x + this._width, this._pos.y + this._height);\r\n        this._posDirty = false;\r\n    }\r\n    /**\r\n     * Tile bounds in world space\r\n     */\r\n    get bounds() {\r\n        if (this._posDirty) {\r\n            this._recalculate();\r\n        }\r\n        return this._bounds;\r\n    }\r\n    /**\r\n     * Tile position in world space\r\n     */\r\n    get center() {\r\n        if (this._posDirty) {\r\n            this._recalculate();\r\n        }\r\n        return new Vector(this._pos.x + this._width / 2, this._pos.y + this._height / 2);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Camera.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Container to house convenience strategy methods\r\n * @internal\r\n */\r\nclass StrategyContainer {\r\n    constructor(camera) {\r\n        this.camera = camera;\r\n    }\r\n    /**\r\n     * Creates and adds the [[LockCameraToActorStrategy]] on the current camera.\r\n     * @param actor The actor to lock the camera to\r\n     */\r\n    lockToActor(actor) {\r\n        this.camera.addStrategy(new LockCameraToActorStrategy(actor));\r\n    }\r\n    /**\r\n     * Creates and adds the [[LockCameraToActorAxisStrategy]] on the current camera\r\n     * @param actor The actor to lock the camera to\r\n     * @param axis The axis to follow the actor on\r\n     */\r\n    lockToActorAxis(actor, axis) {\r\n        this.camera.addStrategy(new LockCameraToActorAxisStrategy(actor, axis));\r\n    }\r\n    /**\r\n     * Creates and adds the [[ElasticToActorStrategy]] on the current camera\r\n     * If cameraElasticity < cameraFriction < 1.0, the behavior will be a dampened spring that will slowly end at the target without bouncing\r\n     * If cameraFriction < cameraElasticity < 1.0, the behavior will be an oscillating spring that will over\r\n     * correct and bounce around the target\r\n     *\r\n     * @param actor Target actor to elastically follow\r\n     * @param cameraElasticity [0 - 1.0] The higher the elasticity the more force that will drive the camera towards the target\r\n     * @param cameraFriction [0 - 1.0] The higher the friction the more that the camera will resist motion towards the target\r\n     */\r\n    elasticToActor(actor, cameraElasticity, cameraFriction) {\r\n        this.camera.addStrategy(new ElasticToActorStrategy(actor, cameraElasticity, cameraFriction));\r\n    }\r\n    /**\r\n     * Creates and adds the [[RadiusAroundActorStrategy]] on the current camera\r\n     * @param actor Target actor to follow when it is \"radius\" pixels away\r\n     * @param radius Number of pixels away before the camera will follow\r\n     */\r\n    radiusAroundActor(actor, radius) {\r\n        this.camera.addStrategy(new RadiusAroundActorStrategy(actor, radius));\r\n    }\r\n    /**\r\n     * Creates and adds the [[LimitCameraBoundsStrategy]] on the current camera\r\n     * @param box The bounding box to limit the camera to.\r\n     */\r\n    limitCameraBounds(box) {\r\n        this.camera.addStrategy(new LimitCameraBoundsStrategy(box));\r\n    }\r\n}\r\n/**\r\n * Camera axis enum\r\n */\r\nvar Axis;\r\n(function (Axis) {\r\n    Axis[Axis[\"X\"] = 0] = \"X\";\r\n    Axis[Axis[\"Y\"] = 1] = \"Y\";\r\n})(Axis || (Axis = {}));\r\n/**\r\n * Lock a camera to the exact x/y position of an actor.\r\n */\r\nclass LockCameraToActorStrategy {\r\n    constructor(target) {\r\n        this.target = target;\r\n        this.action = (target, _cam, _eng, _delta) => {\r\n            const center = target.center;\r\n            return center;\r\n        };\r\n    }\r\n}\r\n/**\r\n * Lock a camera to a specific axis around an actor.\r\n */\r\nclass LockCameraToActorAxisStrategy {\r\n    constructor(target, axis) {\r\n        this.target = target;\r\n        this.axis = axis;\r\n        this.action = (target, cam, _eng, _delta) => {\r\n            const center = target.center;\r\n            const currentFocus = cam.getFocus();\r\n            if (this.axis === Axis.X) {\r\n                return new Vector(center.x, currentFocus.y);\r\n            }\r\n            else {\r\n                return new Vector(currentFocus.x, center.y);\r\n            }\r\n        };\r\n    }\r\n}\r\n/**\r\n * Using [Hook's law](https://en.wikipedia.org/wiki/Hooke's_law), elastically move the camera towards the target actor.\r\n */\r\nclass ElasticToActorStrategy {\r\n    /**\r\n     * If cameraElasticity < cameraFriction < 1.0, the behavior will be a dampened spring that will slowly end at the target without bouncing\r\n     * If cameraFriction < cameraElasticity < 1.0, the behavior will be an oscillating spring that will over\r\n     * correct and bounce around the target\r\n     *\r\n     * @param target Target actor to elastically follow\r\n     * @param cameraElasticity [0 - 1.0] The higher the elasticity the more force that will drive the camera towards the target\r\n     * @param cameraFriction [0 - 1.0] The higher the friction the more that the camera will resist motion towards the target\r\n     */\r\n    constructor(target, cameraElasticity, cameraFriction) {\r\n        this.target = target;\r\n        this.cameraElasticity = cameraElasticity;\r\n        this.cameraFriction = cameraFriction;\r\n        this.action = (target, cam, _eng, _delta) => {\r\n            const position = target.center;\r\n            let focus = cam.getFocus();\r\n            let cameraVel = cam.vel.clone();\r\n            // Calculate the stretch vector, using the spring equation\r\n            // F = kX\r\n            // https://en.wikipedia.org/wiki/Hooke's_law\r\n            // Apply to the current camera velocity\r\n            const stretch = position.sub(focus).scale(this.cameraElasticity); // stretch is X\r\n            cameraVel = cameraVel.add(stretch);\r\n            // Calculate the friction (-1 to apply a force in the opposition of motion)\r\n            // Apply to the current camera velocity\r\n            const friction = cameraVel.scale(-1).scale(this.cameraFriction);\r\n            cameraVel = cameraVel.add(friction);\r\n            // Update position by velocity deltas\r\n            focus = focus.add(cameraVel);\r\n            return focus;\r\n        };\r\n    }\r\n}\r\nclass RadiusAroundActorStrategy {\r\n    /**\r\n     *\r\n     * @param target Target actor to follow when it is \"radius\" pixels away\r\n     * @param radius Number of pixels away before the camera will follow\r\n     */\r\n    constructor(target, radius) {\r\n        this.target = target;\r\n        this.radius = radius;\r\n        this.action = (target, cam, _eng, _delta) => {\r\n            const position = target.center;\r\n            const focus = cam.getFocus();\r\n            const direction = position.sub(focus);\r\n            const distance = direction.size;\r\n            if (distance >= this.radius) {\r\n                const offset = distance - this.radius;\r\n                return focus.add(direction.normalize().scale(offset));\r\n            }\r\n            return focus;\r\n        };\r\n    }\r\n}\r\n/**\r\n * Prevent a camera from going beyond the given camera dimensions.\r\n */\r\nclass LimitCameraBoundsStrategy {\r\n    constructor(target) {\r\n        this.target = target;\r\n        /**\r\n         * Useful for limiting the camera to a [[TileMap]]'s dimensions, or a specific area inside the map.\r\n         *\r\n         * Note that this strategy does not perform any movement by itself.\r\n         * It only sets the camera position to within the given bounds when the camera has gone beyond them.\r\n         * Thus, it is a good idea to combine it with other camera strategies and set this strategy as the last one.\r\n         *\r\n         * Make sure that the camera bounds are at least as large as the viewport size.\r\n         *\r\n         * @param target The bounding box to limit the camera to\r\n         */\r\n        this.boundSizeChecked = false; // Check and warn only once\r\n        this.action = (target, cam, _eng, _delta) => {\r\n            const focus = cam.getFocus();\r\n            if (!this.boundSizeChecked) {\r\n                if (target.bottom - target.top < _eng.drawHeight || target.right - target.left < _eng.drawWidth) {\r\n                    Logger.getInstance().warn('Camera bounds should not be smaller than the engine viewport');\r\n                }\r\n                this.boundSizeChecked = true;\r\n            }\r\n            let focusX = focus.x;\r\n            let focusY = focus.y;\r\n            if (focus.x < target.left + _eng.halfDrawWidth) {\r\n                focusX = target.left + _eng.halfDrawWidth;\r\n            }\r\n            else if (focus.x > target.right - _eng.halfDrawWidth) {\r\n                focusX = target.right - _eng.halfDrawWidth;\r\n            }\r\n            if (focus.y < target.top + _eng.halfDrawHeight) {\r\n                focusY = target.top + _eng.halfDrawHeight;\r\n            }\r\n            else if (focus.y > target.bottom - _eng.halfDrawHeight) {\r\n                focusY = target.bottom - _eng.halfDrawHeight;\r\n            }\r\n            return vec(focusX, focusY);\r\n        };\r\n    }\r\n}\r\nconst CameraEvents = {\r\n    Initialize: 'initialize',\r\n    PreUpdate: 'preupdate',\r\n    PostUpdate: 'postupdate'\r\n};\r\n/**\r\n * Cameras\r\n *\r\n * [[Camera]] is the base class for all Excalibur cameras. Cameras are used\r\n * to move around your game and set focus. They are used to determine\r\n * what is \"off screen\" and can be used to scale the game.\r\n *\r\n */\r\nclass Camera {\r\n    constructor() {\r\n        this.events = new EventEmitter();\r\n        this.transform = AffineMatrix.identity();\r\n        this.inverse = AffineMatrix.identity();\r\n        this._cameraStrategies = [];\r\n        this.strategy = new StrategyContainer(this);\r\n        /**\r\n         * Get or set current zoom of the camera, defaults to 1\r\n         */\r\n        this._z = 1;\r\n        /**\r\n         * Get or set rate of change in zoom, defaults to 0\r\n         */\r\n        this.dz = 0;\r\n        /**\r\n         * Get or set zoom acceleration\r\n         */\r\n        this.az = 0;\r\n        /**\r\n         * Current rotation of the camera\r\n         */\r\n        this.rotation = 0;\r\n        this._angularVelocity = 0;\r\n        /**\r\n         * Get or set the camera's position\r\n         */\r\n        this._posChanged = false;\r\n        this._pos = watchAny(Vector.Zero, () => (this._posChanged = true));\r\n        /**\r\n         * Get or set the camera's velocity\r\n         */\r\n        this.vel = Vector.Zero;\r\n        /**\r\n         * Get or set the camera's acceleration\r\n         */\r\n        this.acc = Vector.Zero;\r\n        this._cameraMoving = false;\r\n        this._currentLerpTime = 0;\r\n        this._lerpDuration = 1000; // 1 second\r\n        this._lerpStart = null;\r\n        this._lerpEnd = null;\r\n        //camera effects\r\n        this._isShaking = false;\r\n        this._shakeMagnitudeX = 0;\r\n        this._shakeMagnitudeY = 0;\r\n        this._shakeDuration = 0;\r\n        this._elapsedShakeTime = 0;\r\n        this._xShake = 0;\r\n        this._yShake = 0;\r\n        this._isZooming = false;\r\n        this._zoomStart = 1;\r\n        this._zoomEnd = 1;\r\n        this._currentZoomTime = 0;\r\n        this._zoomDuration = 0;\r\n        this._zoomEasing = EasingFunctions.EaseInOutCubic;\r\n        this._easing = EasingFunctions.EaseInOutCubic;\r\n        this._halfWidth = 0;\r\n        this._halfHeight = 0;\r\n        this._viewport = null;\r\n        this._isInitialized = false;\r\n    }\r\n    get zoom() {\r\n        return this._z;\r\n    }\r\n    set zoom(val) {\r\n        this._z = val;\r\n        if (this._engine) {\r\n            this._halfWidth = this._engine.halfDrawWidth;\r\n            this._halfHeight = this._engine.halfDrawHeight;\r\n        }\r\n    }\r\n    /**\r\n     * Get or set the camera's angular velocity\r\n     */\r\n    get angularVelocity() {\r\n        return this._angularVelocity;\r\n    }\r\n    set angularVelocity(value) {\r\n        this._angularVelocity = value;\r\n    }\r\n    get pos() {\r\n        return this._pos;\r\n    }\r\n    set pos(vec) {\r\n        this._pos = watchAny(vec, () => (this._posChanged = true));\r\n        this._posChanged = true;\r\n    }\r\n    /**\r\n     * Get the camera's x position\r\n     */\r\n    get x() {\r\n        return this.pos.x;\r\n    }\r\n    /**\r\n     * Set the camera's x position (cannot be set when following an [[Actor]] or when moving)\r\n     */\r\n    set x(value) {\r\n        if (!this._follow && !this._cameraMoving) {\r\n            this.pos = vec(value, this.pos.y);\r\n        }\r\n    }\r\n    /**\r\n     * Get the camera's y position\r\n     */\r\n    get y() {\r\n        return this.pos.y;\r\n    }\r\n    /**\r\n     * Set the camera's y position (cannot be set when following an [[Actor]] or when moving)\r\n     */\r\n    set y(value) {\r\n        if (!this._follow && !this._cameraMoving) {\r\n            this.pos = vec(this.pos.x, value);\r\n        }\r\n    }\r\n    /**\r\n     * Get or set the camera's x velocity\r\n     */\r\n    get dx() {\r\n        return this.vel.x;\r\n    }\r\n    set dx(value) {\r\n        this.vel = vec(value, this.vel.y);\r\n    }\r\n    /**\r\n     * Get or set the camera's y velocity\r\n     */\r\n    get dy() {\r\n        return this.vel.y;\r\n    }\r\n    set dy(value) {\r\n        this.vel = vec(this.vel.x, value);\r\n    }\r\n    /**\r\n     * Get or set the camera's x acceleration\r\n     */\r\n    get ax() {\r\n        return this.acc.x;\r\n    }\r\n    set ax(value) {\r\n        this.acc = vec(value, this.acc.y);\r\n    }\r\n    /**\r\n     * Get or set the camera's y acceleration\r\n     */\r\n    get ay() {\r\n        return this.acc.y;\r\n    }\r\n    set ay(value) {\r\n        this.acc = vec(this.acc.x, value);\r\n    }\r\n    /**\r\n     * Returns the focal point of the camera, a new point giving the x and y position of the camera\r\n     */\r\n    getFocus() {\r\n        return this.pos;\r\n    }\r\n    /**\r\n     * This moves the camera focal point to the specified position using specified easing function. Cannot move when following an Actor.\r\n     *\r\n     * @param pos The target position to move to\r\n     * @param duration The duration in milliseconds the move should last\r\n     * @param [easingFn] An optional easing function ([[ex.EasingFunctions.EaseInOutCubic]] by default)\r\n     * @returns A [[Promise]] that resolves when movement is finished, including if it's interrupted.\r\n     *          The [[Promise]] value is the [[Vector]] of the target position. It will be rejected if a move cannot be made.\r\n     */\r\n    move(pos, duration, easingFn = EasingFunctions.EaseInOutCubic) {\r\n        if (typeof easingFn !== 'function') {\r\n            throw 'Please specify an EasingFunction';\r\n        }\r\n        // cannot move when following an actor\r\n        if (this._follow) {\r\n            return Promise.reject(pos);\r\n        }\r\n        // resolve existing promise, if any\r\n        if (this._lerpPromise && this._lerpResolve) {\r\n            this._lerpResolve(pos);\r\n        }\r\n        this._lerpPromise = new Promise((resolve) => {\r\n            this._lerpResolve = resolve;\r\n        });\r\n        this._lerpStart = this.getFocus().clone();\r\n        this._lerpDuration = duration;\r\n        this._lerpEnd = pos;\r\n        this._currentLerpTime = 0;\r\n        this._cameraMoving = true;\r\n        this._easing = easingFn;\r\n        return this._lerpPromise;\r\n    }\r\n    /**\r\n     * Sets the camera to shake at the specified magnitudes for the specified duration\r\n     * @param magnitudeX  The x magnitude of the shake\r\n     * @param magnitudeY  The y magnitude of the shake\r\n     * @param duration    The duration of the shake in milliseconds\r\n     */\r\n    shake(magnitudeX, magnitudeY, duration) {\r\n        this._isShaking = true;\r\n        this._shakeMagnitudeX = magnitudeX;\r\n        this._shakeMagnitudeY = magnitudeY;\r\n        this._shakeDuration = duration;\r\n    }\r\n    /**\r\n     * Zooms the camera in or out by the specified scale over the specified duration.\r\n     * If no duration is specified, it take effect immediately.\r\n     * @param scale    The scale of the zoom\r\n     * @param duration The duration of the zoom in milliseconds\r\n     */\r\n    zoomOverTime(scale, duration = 0, easingFn = EasingFunctions.EaseInOutCubic) {\r\n        this._zoomPromise = new Promise((resolve) => {\r\n            this._zoomResolve = resolve;\r\n        });\r\n        if (duration) {\r\n            this._isZooming = true;\r\n            this._zoomEasing = easingFn;\r\n            this._currentZoomTime = 0;\r\n            this._zoomDuration = duration;\r\n            this._zoomStart = this.zoom;\r\n            this._zoomEnd = scale;\r\n        }\r\n        else {\r\n            this._isZooming = false;\r\n            this.zoom = scale;\r\n            return Promise.resolve(true);\r\n        }\r\n        return this._zoomPromise;\r\n    }\r\n    /**\r\n     * Gets the bounding box of the viewport of this camera in world coordinates\r\n     */\r\n    get viewport() {\r\n        if (this._viewport) {\r\n            return this._viewport;\r\n        }\r\n        return new BoundingBox(0, 0, 0, 0);\r\n    }\r\n    /**\r\n     * Adds a new camera strategy to this camera\r\n     * @param cameraStrategy Instance of an [[CameraStrategy]]\r\n     */\r\n    addStrategy(cameraStrategy) {\r\n        this._cameraStrategies.push(cameraStrategy);\r\n    }\r\n    /**\r\n     * Removes a camera strategy by reference\r\n     * @param cameraStrategy Instance of an [[CameraStrategy]]\r\n     */\r\n    removeStrategy(cameraStrategy) {\r\n        removeItemFromArray(cameraStrategy, this._cameraStrategies);\r\n    }\r\n    /**\r\n     * Clears all camera strategies from the camera\r\n     */\r\n    clearAllStrategies() {\r\n        this._cameraStrategies.length = 0;\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPreUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _preupdate(engine, delta) {\r\n        this.events.emit('preupdate', new PreUpdateEvent(engine, delta, this));\r\n        this.onPreUpdate(engine, delta);\r\n    }\r\n    /**\r\n     * Safe to override onPreUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPreUpdate` is called directly before a scene is updated.\r\n     */\r\n    onPreUpdate(_engine, _delta) {\r\n        // Overridable\r\n    }\r\n    /**\r\n     *  It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPostUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _postupdate(engine, delta) {\r\n        this.events.emit('postupdate', new PostUpdateEvent(engine, delta, this));\r\n        this.onPostUpdate(engine, delta);\r\n    }\r\n    /**\r\n     * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPostUpdate` is called directly after a scene is updated.\r\n     */\r\n    onPostUpdate(_engine, _delta) {\r\n        // Overridable\r\n    }\r\n    get isInitialized() {\r\n        return this._isInitialized;\r\n    }\r\n    _initialize(_engine) {\r\n        if (!this.isInitialized) {\r\n            this._engine = _engine;\r\n            this._screen = _engine.screen;\r\n            const currentRes = this._screen.contentArea;\r\n            let center = vec(currentRes.width / 2, currentRes.height / 2);\r\n            if (!this._engine.loadingComplete) {\r\n                // If there was a loading screen, we peek the configured resolution\r\n                const res = this._screen.peekResolution();\r\n                if (res) {\r\n                    center = vec(res.width / 2, res.height / 2);\r\n                }\r\n            }\r\n            this._halfWidth = center.x;\r\n            this._halfHeight = center.y;\r\n            // If the user has not set the camera pos, apply default center screen position\r\n            if (!this._posChanged) {\r\n                this.pos = center;\r\n            }\r\n            // First frame bootstrap\r\n            // Ensure camera tx is correct\r\n            // Run update twice to ensure properties are init'd\r\n            this.updateTransform();\r\n            // Run strategies for first frame\r\n            this.runStrategies(_engine, _engine.clock.elapsed());\r\n            // Setup the first frame viewport\r\n            this.updateViewport();\r\n            // It's important to update the camera after strategies\r\n            // This prevents jitter\r\n            this.updateTransform();\r\n            this.onInitialize(_engine);\r\n            this.events.emit('initialize', new InitializeEvent(_engine, this));\r\n            this._isInitialized = true;\r\n        }\r\n    }\r\n    /**\r\n     * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPostUpdate` is called directly after a scene is updated.\r\n     */\r\n    onInitialize(_engine) {\r\n        // Overridable\r\n    }\r\n    emit(eventName, event) {\r\n        this.events.emit(eventName, event);\r\n    }\r\n    on(eventName, handler) {\r\n        return this.events.on(eventName, handler);\r\n    }\r\n    once(eventName, handler) {\r\n        return this.events.once(eventName, handler);\r\n    }\r\n    off(eventName, handler) {\r\n        this.events.off(eventName, handler);\r\n    }\r\n    runStrategies(engine, delta) {\r\n        for (const s of this._cameraStrategies) {\r\n            this.pos = s.action.call(s, s.target, this, engine, delta);\r\n        }\r\n    }\r\n    updateViewport() {\r\n        // recalc viewport\r\n        this._viewport = new BoundingBox(this.x - this._halfWidth, this.y - this._halfHeight, this.x + this._halfWidth, this.y + this._halfHeight);\r\n    }\r\n    update(_engine, delta) {\r\n        this._initialize(_engine);\r\n        this._preupdate(_engine, delta);\r\n        // Update placements based on linear algebra\r\n        this.pos = this.pos.add(this.vel.scale(delta / 1000));\r\n        this.zoom += (this.dz * delta) / 1000;\r\n        this.vel = this.vel.add(this.acc.scale(delta / 1000));\r\n        this.dz += (this.az * delta) / 1000;\r\n        this.rotation += (this.angularVelocity * delta) / 1000;\r\n        if (this._isZooming) {\r\n            if (this._currentZoomTime < this._zoomDuration) {\r\n                const zoomEasing = this._zoomEasing;\r\n                const newZoom = zoomEasing(this._currentZoomTime, this._zoomStart, this._zoomEnd, this._zoomDuration);\r\n                this.zoom = newZoom;\r\n                this._currentZoomTime += delta;\r\n            }\r\n            else {\r\n                this._isZooming = false;\r\n                this.zoom = this._zoomEnd;\r\n                this._currentZoomTime = 0;\r\n                this._zoomResolve(true);\r\n            }\r\n        }\r\n        if (this._cameraMoving) {\r\n            if (this._currentLerpTime < this._lerpDuration) {\r\n                const moveEasing = EasingFunctions.CreateVectorEasingFunction(this._easing);\r\n                const lerpPoint = moveEasing(this._currentLerpTime, this._lerpStart, this._lerpEnd, this._lerpDuration);\r\n                this.pos = lerpPoint;\r\n                this._currentLerpTime += delta;\r\n            }\r\n            else {\r\n                this.pos = this._lerpEnd;\r\n                const end = this._lerpEnd.clone();\r\n                this._lerpStart = null;\r\n                this._lerpEnd = null;\r\n                this._currentLerpTime = 0;\r\n                this._cameraMoving = false;\r\n                // Order matters here, resolve should be last so any chain promises have a clean slate\r\n                this._lerpResolve(end);\r\n            }\r\n        }\r\n        if (this._isDoneShaking()) {\r\n            this._isShaking = false;\r\n            this._elapsedShakeTime = 0;\r\n            this._shakeMagnitudeX = 0;\r\n            this._shakeMagnitudeY = 0;\r\n            this._shakeDuration = 0;\r\n            this._xShake = 0;\r\n            this._yShake = 0;\r\n        }\r\n        else {\r\n            this._elapsedShakeTime += delta;\r\n            this._xShake = ((Math.random() * this._shakeMagnitudeX) | 0) + 1;\r\n            this._yShake = ((Math.random() * this._shakeMagnitudeY) | 0) + 1;\r\n        }\r\n        this.runStrategies(_engine, delta);\r\n        this.updateViewport();\r\n        // It's important to update the camera after strategies\r\n        // This prevents jitter\r\n        this.updateTransform();\r\n        this._postupdate(_engine, delta);\r\n    }\r\n    /**\r\n     * Applies the relevant transformations to the game canvas to \"move\" or apply effects to the Camera\r\n     * @param ctx Canvas context to apply transformations\r\n     */\r\n    draw(ctx) {\r\n        ctx.multiply(this.transform);\r\n    }\r\n    updateTransform() {\r\n        // center the camera\r\n        const newCanvasWidth = this._screen.resolution.width / this.zoom;\r\n        const newCanvasHeight = this._screen.resolution.height / this.zoom;\r\n        const cameraPos = vec(-this.x + newCanvasWidth / 2 + this._xShake, -this.y + newCanvasHeight / 2 + this._yShake);\r\n        // Calculate camera transform\r\n        this.transform.reset();\r\n        this.transform.scale(this.zoom, this.zoom);\r\n        // rotate about the focus\r\n        this.transform.translate(newCanvasWidth / 2, newCanvasHeight / 2);\r\n        this.transform.rotate(this.rotation);\r\n        this.transform.translate(-newCanvasWidth / 2, -newCanvasHeight / 2);\r\n        this.transform.translate(cameraPos.x, cameraPos.y);\r\n        this.transform.inverse(this.inverse);\r\n    }\r\n    _isDoneShaking() {\r\n        return !this._isShaking || this._elapsedShakeTime >= this._shakeDuration;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Trigger.ts\n\r\n\r\n\r\n\r\n\r\nconst TriggerEvents = {\r\n    ExitTrigger: 'exittrigger',\r\n    EnterTrigger: 'entertrigger'\r\n};\r\nconst triggerDefaults = {\r\n    pos: Vector.Zero,\r\n    width: 10,\r\n    height: 10,\r\n    visible: false,\r\n    action: () => {\r\n        return;\r\n    },\r\n    filter: () => true,\r\n    repeat: -1\r\n};\r\n/**\r\n * Triggers are a method of firing arbitrary code on collision. These are useful\r\n * as 'buttons', 'switches', or to trigger effects in a game. By default triggers\r\n * are invisible, and can only be seen when [[Trigger.visible]] is set to `true`.\r\n */\r\nclass Trigger extends Actor {\r\n    /**\r\n     *\r\n     * @param opts Trigger options\r\n     */\r\n    constructor(opts) {\r\n        super({ x: opts.pos.x, y: opts.pos.y, width: opts.width, height: opts.height });\r\n        this.events = new EventEmitter();\r\n        /**\r\n         * Action to fire when triggered by collision\r\n         */\r\n        this.action = () => {\r\n            return;\r\n        };\r\n        /**\r\n         * Filter to add additional granularity to action dispatch, if a filter is specified the action will only fire when\r\n         * filter return true for the collided actor.\r\n         */\r\n        this.filter = () => true;\r\n        /**\r\n         * Number of times to repeat before killing the trigger,\r\n         */\r\n        this.repeat = -1;\r\n        opts = {\r\n            ...triggerDefaults,\r\n            ...opts\r\n        };\r\n        this.filter = opts.filter || this.filter;\r\n        this.repeat = opts.repeat || this.repeat;\r\n        this.action = opts.action || this.action;\r\n        if (opts.target) {\r\n            this.target = opts.target;\r\n        }\r\n        this.graphics.visible = opts.visible;\r\n        this.body.collisionType = CollisionType.Passive;\r\n        this.events.on('collisionstart', (evt) => {\r\n            if (this.filter(evt.other)) {\r\n                this.emit('enter', new EnterTriggerEvent(this, evt.other));\r\n                this._dispatchAction();\r\n                // remove trigger if its done, -1 repeat forever\r\n                if (this.repeat === 0) {\r\n                    this.kill();\r\n                }\r\n            }\r\n        });\r\n        this.events.on('collisionend', (evt) => {\r\n            if (this.filter(evt.other)) {\r\n                this.emit('exit', new ExitTriggerEvent(this, evt.other));\r\n            }\r\n        });\r\n    }\r\n    set target(target) {\r\n        this._target = target;\r\n        this.filter = (actor) => actor === target;\r\n    }\r\n    get target() {\r\n        return this._target;\r\n    }\r\n    _initialize(engine) {\r\n        super._initialize(engine);\r\n    }\r\n    _dispatchAction() {\r\n        if (this.repeat !== 0) {\r\n            this.action.call(this);\r\n            this.repeat--;\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/System.ts\n/**\r\n * Enum that determines whether to run the system in the update or draw phase\r\n */\r\nvar SystemType;\r\n(function (SystemType) {\r\n    SystemType[\"Update\"] = \"update\";\r\n    SystemType[\"Draw\"] = \"draw\";\r\n})(SystemType || (SystemType = {}));\r\n/**\r\n * An Excalibur [[System]] that updates entities of certain types.\r\n * Systems are scene specific\r\n *\r\n * Excalibur Systems currently require at least 1 Component type to operated\r\n *\r\n * Multiple types are declared as a type union\r\n * For example:\r\n *\r\n * ```typescript\r\n * class MySystem extends System<ComponentA | ComponentB> {\r\n *   public readonly types = ['a', 'b'] as const;\r\n *   public readonly systemType = SystemType.Update;\r\n *   public update(entities: Entity<ComponentA | ComponentB>) {\r\n *      ...\r\n *   }\r\n * }\r\n * ```\r\n */\r\nclass System {\r\n    constructor() {\r\n        /**\r\n         * System can execute in priority order, by default all systems are priority 0. Lower values indicated higher priority.\r\n         * For a system to execute before all other a lower priority value (-1 for example) must be set.\r\n         * For a system to execute after all other a higher priority value (10 for example) must be set.\r\n         */\r\n        this.priority = 0;\r\n    }\r\n    /**\r\n     * Systems observe when entities match their types or no longer match their types, override\r\n     * @param _entityAddedOrRemoved\r\n     */\r\n    notify(_entityAddedOrRemoved) {\r\n        // Override me\r\n    }\r\n}\r\n/**\r\n * An [[Entity]] with [[Component]] types that matches a [[System]] types exists in the current scene.\r\n */\r\nclass AddedEntity {\r\n    constructor(data) {\r\n        this.data = data;\r\n        this.type = 'Entity Added';\r\n    }\r\n}\r\n/**\r\n * Type guard to check for AddedEntity messages\r\n * @param x\r\n */\r\nfunction isAddedSystemEntity(x) {\r\n    return !!x && x.type === 'Entity Added';\r\n}\r\n/**\r\n * An [[Entity]] with [[Component]] types that no longer matches a [[System]] types exists in the current scene.\r\n */\r\nclass RemovedEntity {\r\n    constructor(data) {\r\n        this.data = data;\r\n        this.type = 'Entity Removed';\r\n    }\r\n}\r\n/**\r\n * type guard to check for the RemovedEntity message\r\n */\r\nfunction isRemoveSystemEntity(x) {\r\n    return !!x && x.type === 'Entity Removed';\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/EntityManager.ts\n\r\n\r\n// Add/Remove entities and components\r\nclass EntityManager {\r\n    constructor(_world) {\r\n        this._world = _world;\r\n        this.entities = [];\r\n        this._entityIndex = {};\r\n        this._entitiesToRemove = [];\r\n    }\r\n    /**\r\n     * Runs the entity lifecycle\r\n     * @param _context\r\n     */\r\n    updateEntities(_context, elapsed) {\r\n        for (const entity of this.entities) {\r\n            // TODO is this right?\r\n            entity.update(_context.engine, elapsed);\r\n            if (!entity.active) {\r\n                this.removeEntity(entity);\r\n            }\r\n        }\r\n    }\r\n    findEntitiesForRemoval() {\r\n        for (const entity of this.entities) {\r\n            if (!entity.active) {\r\n                this.removeEntity(entity);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * EntityManager observes changes on entities\r\n     * @param message\r\n     */\r\n    notify(message) {\r\n        if (isAddedComponent(message)) {\r\n            // we don't need the component, it's already on the entity\r\n            this._world.queryManager.addEntity(message.data.entity);\r\n        }\r\n        if (isRemovedComponent(message)) {\r\n            this._world.queryManager.removeComponent(message.data.entity, message.data.component);\r\n        }\r\n    }\r\n    /**\r\n     * Adds an entity to be tracked by the EntityManager\r\n     * @param entity\r\n     */\r\n    addEntity(entity) {\r\n        entity.active = true;\r\n        entity.scene = this._world.context;\r\n        if (entity && !this._entityIndex[entity.id]) {\r\n            this._entityIndex[entity.id] = entity;\r\n            this.entities.push(entity);\r\n            this._world.queryManager.addEntity(entity);\r\n            entity.componentAdded$.register(this);\r\n            entity.componentRemoved$.register(this);\r\n            // if entity has children\r\n            entity.children.forEach((c) => {\r\n                c.scene = entity.scene;\r\n                this.addEntity(c);\r\n            });\r\n            entity.childrenAdded$.register({\r\n                notify: (e) => {\r\n                    this.addEntity(e);\r\n                }\r\n            });\r\n            entity.childrenRemoved$.register({\r\n                notify: (e) => {\r\n                    this.removeEntity(e, false);\r\n                }\r\n            });\r\n        }\r\n    }\r\n    removeEntity(idOrEntity, deferred = true) {\r\n        var _a;\r\n        let id = 0;\r\n        if (idOrEntity instanceof Entity) {\r\n            id = idOrEntity.id;\r\n        }\r\n        else {\r\n            id = idOrEntity;\r\n        }\r\n        const entity = this._entityIndex[id];\r\n        if (entity && entity.active) {\r\n            entity.active = false;\r\n        }\r\n        if (entity && deferred) {\r\n            this._entitiesToRemove.push(entity);\r\n            return;\r\n        }\r\n        delete this._entityIndex[id];\r\n        if (entity) {\r\n            entity.scene = null;\r\n            removeItemFromArray(entity, this.entities);\r\n            this._world.queryManager.removeEntity(entity);\r\n            entity.componentAdded$.unregister(this);\r\n            entity.componentRemoved$.unregister(this);\r\n            // if entity has children\r\n            entity.children.forEach((c) => {\r\n                c.scene = null;\r\n                this.removeEntity(c, deferred);\r\n            });\r\n            entity.childrenAdded$.clear();\r\n            entity.childrenRemoved$.clear();\r\n            // stats\r\n            if ((_a = this._world.context) === null || _a === void 0 ? void 0 : _a.engine) {\r\n                this._world.context.engine.stats.currFrame.actors.killed++;\r\n            }\r\n        }\r\n    }\r\n    processEntityRemovals() {\r\n        for (const entity of this._entitiesToRemove) {\r\n            if (entity.active) {\r\n                continue;\r\n            }\r\n            this.removeEntity(entity, false);\r\n        }\r\n        this._entitiesToRemove.length = 0;\r\n    }\r\n    processComponentRemovals() {\r\n        for (const entity of this.entities) {\r\n            entity.processComponentRemoval();\r\n        }\r\n    }\r\n    getById(id) {\r\n        return this._entityIndex[id];\r\n    }\r\n    getByName(name) {\r\n        return this.entities.filter(e => e.name === name);\r\n    }\r\n    clear() {\r\n        for (const entity of this.entities) {\r\n            this.removeEntity(entity);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/Util.ts\nconst buildTypeKey = (types) => {\r\n    const key = [...types].sort((a, b) => a.localeCompare(b)).join('+');\r\n    return key;\r\n};\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/Query.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Represents query for entities that match a list of types that is cached and observable\r\n *\r\n * Queries can be strongly typed by supplying a type union in the optional type parameter\r\n * ```typescript\r\n * const queryAB = new ex.Query<ComponentTypeA | ComponentTypeB>(['A', 'B']);\r\n * ```\r\n */\r\nclass Query extends Observable {\r\n    get key() {\r\n        if (this._key) {\r\n            return this._key;\r\n        }\r\n        return (this._key = buildTypeKey(this.types));\r\n    }\r\n    constructor(types) {\r\n        super();\r\n        this._entities = [];\r\n        if (types[0] instanceof Function) {\r\n            this.types = types.map(T => (new T).type);\r\n        }\r\n        else {\r\n            this.types = types;\r\n        }\r\n    }\r\n    /**\r\n     * Returns a list of entities that match the query\r\n     *\r\n     * @param sort Optional sorting function to sort entities returned from the query\r\n     */\r\n    getEntities(sort) {\r\n        if (sort) {\r\n            this._entities.sort(sort);\r\n        }\r\n        return this._entities;\r\n    }\r\n    /**\r\n     * Add an entity to the query, will only be added if the entity matches the query types\r\n     * @param entity\r\n     */\r\n    addEntity(entity) {\r\n        if (!contains(this._entities, entity) && this.matches(entity)) {\r\n            this._entities.push(entity);\r\n            this.notifyAll(new AddedEntity(entity));\r\n        }\r\n    }\r\n    /**\r\n     * If the entity is part of the query it will be removed regardless of types\r\n     * @param entity\r\n     */\r\n    removeEntity(entity) {\r\n        if (removeItemFromArray(entity, this._entities)) {\r\n            this.notifyAll(new RemovedEntity(entity));\r\n        }\r\n    }\r\n    /**\r\n     * Removes all entities and observers from the query\r\n     */\r\n    clear() {\r\n        this._entities.length = 0;\r\n        for (const observer of this.observers) {\r\n            this.unregister(observer);\r\n        }\r\n    }\r\n    matches(typesOrEntity) {\r\n        let types = [];\r\n        if (typesOrEntity instanceof Entity) {\r\n            types = typesOrEntity.types;\r\n        }\r\n        else {\r\n            types = typesOrEntity;\r\n        }\r\n        let matches = true;\r\n        for (const type of this.types) {\r\n            matches = matches && types.indexOf(type) > -1;\r\n            if (!matches) {\r\n                return false;\r\n            }\r\n        }\r\n        return matches;\r\n    }\r\n    contain(type) {\r\n        return this.types.indexOf(type) > -1;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/QueryManager.ts\n\r\n\r\n/**\r\n * The query manager is responsible for updating all queries when entities/components change\r\n */\r\nclass QueryManager {\r\n    constructor(_world) {\r\n        this._world = _world;\r\n        this._queries = {};\r\n    }\r\n    /**\r\n     * Adds a query to the manager and populates with any entities that match\r\n     * @param query\r\n     */\r\n    _addQuery(query) {\r\n        this._queries[buildTypeKey(query.types)] = query;\r\n        for (const entity of this._world.entityManager.entities) {\r\n            query.addEntity(entity);\r\n        }\r\n    }\r\n    /**\r\n     * Removes the query if there are no observers left\r\n     * @param query\r\n     */\r\n    maybeRemoveQuery(query) {\r\n        if (query.observers.length === 0) {\r\n            query.clear();\r\n            delete this._queries[buildTypeKey(query.types)];\r\n        }\r\n    }\r\n    /**\r\n     * Adds the entity to any matching query in the query manage\r\n     * @param entity\r\n     */\r\n    addEntity(entity) {\r\n        for (const queryType in this._queries) {\r\n            if (this._queries[queryType]) {\r\n                this._queries[queryType].addEntity(entity);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Removes an entity from queries if the removed component disqualifies it\r\n     * @param entity\r\n     * @param component\r\n     */\r\n    removeComponent(entity, component) {\r\n        for (const queryType in this._queries) {\r\n            // If the component being removed from an entity is a part of a query,\r\n            // it is now disqualified from that query, remove it\r\n            if (this._queries[queryType].contain(component.type)) {\r\n                this._queries[queryType].removeEntity(entity);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Removes an entity from all queries it is currently a part of\r\n     * @param entity\r\n     */\r\n    removeEntity(entity) {\r\n        for (const queryType in this._queries) {\r\n            this._queries[queryType].removeEntity(entity);\r\n        }\r\n    }\r\n    /**\r\n     * Creates a populated query and returns, if the query already exists that will be returned instead of a new instance\r\n     * @param types\r\n     */\r\n    createQuery(types) {\r\n        const maybeExistingQuery = this.getQuery(types);\r\n        if (maybeExistingQuery) {\r\n            return maybeExistingQuery;\r\n        }\r\n        const query = new Query(types);\r\n        this._addQuery(query);\r\n        return query;\r\n    }\r\n    /**\r\n     * Retrieves an existing query by types if it exists otherwise returns null\r\n     * @param types\r\n     */\r\n    getQuery(types) {\r\n        const key = buildTypeKey(types);\r\n        if (this._queries[key]) {\r\n            return this._queries[key];\r\n        }\r\n        return null;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/SystemManager.ts\n\r\n/**\r\n * The SystemManager is responsible for keeping track of all systems in a scene.\r\n * Systems are scene specific\r\n */\r\nclass SystemManager {\r\n    constructor(_world) {\r\n        this._world = _world;\r\n        /**\r\n         * List of systems, to add a new system call [[SystemManager.addSystem]]\r\n         */\r\n        this.systems = [];\r\n        this.initialized = false;\r\n    }\r\n    /**\r\n     * Get a system registered in the manager by type\r\n     * @param systemType\r\n     */\r\n    get(systemType) {\r\n        return this.systems.find((s) => s instanceof systemType);\r\n    }\r\n    /**\r\n     * Adds a system to the manager, it will now be updated every frame\r\n     * @param system\r\n     */\r\n    addSystem(system) {\r\n        // validate system has types\r\n        if (!system.types || system.types.length === 0) {\r\n            throw new Error(`Attempted to add a System without any types`);\r\n        }\r\n        const query = this._world.queryManager.createQuery(system.types);\r\n        this.systems.push(system);\r\n        this.systems.sort((a, b) => a.priority - b.priority);\r\n        query.register(system);\r\n        // If systems are added and the manager has already been init'd\r\n        // then immediately init the system\r\n        if (this.initialized && system.initialize) {\r\n            system.initialize(this._world.context);\r\n        }\r\n    }\r\n    /**\r\n     * Removes a system from the manager, it will no longer be updated\r\n     * @param system\r\n     */\r\n    removeSystem(system) {\r\n        removeItemFromArray(system, this.systems);\r\n        const query = this._world.queryManager.getQuery(system.types);\r\n        if (query) {\r\n            query.unregister(system);\r\n            this._world.queryManager.maybeRemoveQuery(query);\r\n        }\r\n    }\r\n    /**\r\n     * Initialize all systems in the manager\r\n     *\r\n     * Systems added after initialize() will be initialized on add\r\n     */\r\n    initialize() {\r\n        if (!this.initialized) {\r\n            this.initialized = true;\r\n            for (const s of this.systems) {\r\n                if (s.initialize) {\r\n                    s.initialize(this._world.context);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Updates all systems\r\n     * @param type whether this is an update or draw system\r\n     * @param context context reference\r\n     * @param delta time in milliseconds\r\n     */\r\n    updateSystems(type, context, delta) {\r\n        const systems = this.systems.filter((s) => s.systemType === type);\r\n        for (const s of systems) {\r\n            if (s.preupdate) {\r\n                s.preupdate(context, delta);\r\n            }\r\n        }\r\n        for (const s of systems) {\r\n            // Get entities that match the system types, pre-sort\r\n            const entities = this._world.queryManager.getQuery(s.types).getEntities(s.sort);\r\n            // Initialize entities if needed\r\n            if (context instanceof Scene) {\r\n                for (const entity of entities) {\r\n                    entity._initialize(context === null || context === void 0 ? void 0 : context.engine);\r\n                }\r\n            }\r\n            s.update(entities, delta);\r\n        }\r\n        for (const s of systems) {\r\n            if (s.postupdate) {\r\n                s.postupdate(context, delta);\r\n            }\r\n        }\r\n    }\r\n    clear() {\r\n        for (const system of this.systems) {\r\n            this.removeSystem(system);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/World.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * The World is a self-contained entity component system for a particular context.\r\n */\r\nclass World {\r\n    /**\r\n     * The context type is passed to the system updates\r\n     * @param context\r\n     */\r\n    constructor(context) {\r\n        this.context = context;\r\n        this.queryManager = new QueryManager(this);\r\n        this.entityManager = new EntityManager(this);\r\n        this.systemManager = new SystemManager(this);\r\n    }\r\n    /**\r\n     * Update systems by type and time elapsed in milliseconds\r\n     */\r\n    update(type, delta) {\r\n        if (type === SystemType.Update) {\r\n            this.entityManager.updateEntities(this.context, delta);\r\n        }\r\n        this.systemManager.updateSystems(type, this.context, delta);\r\n        this.entityManager.findEntitiesForRemoval();\r\n        this.entityManager.processComponentRemovals();\r\n        this.entityManager.processEntityRemovals();\r\n    }\r\n    add(entityOrSystem) {\r\n        if (entityOrSystem instanceof Entity) {\r\n            this.entityManager.addEntity(entityOrSystem);\r\n        }\r\n        if (entityOrSystem instanceof System) {\r\n            this.systemManager.addSystem(entityOrSystem);\r\n        }\r\n    }\r\n    remove(entityOrSystem, deferred = true) {\r\n        if (entityOrSystem instanceof Entity) {\r\n            this.entityManager.removeEntity(entityOrSystem, deferred);\r\n        }\r\n        if (entityOrSystem instanceof System) {\r\n            this.systemManager.removeSystem(entityOrSystem);\r\n        }\r\n    }\r\n    clearEntities() {\r\n        this.entityManager.clear();\r\n    }\r\n    clearSystems() {\r\n        this.systemManager.clear();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Integrator.ts\n\r\nclass EulerIntegrator {\r\n    static integrate(transform, motion, totalAcc, elapsedMs) {\r\n        const seconds = elapsedMs / 1000;\r\n        // This code looks a little wild, but it's to avoid creating any new Vector instances\r\n        // integration is done in a tight loop so this is key to avoid GC'ing\r\n        motion.vel.addEqual(totalAcc.scale(seconds, EulerIntegrator._ACC));\r\n        transform.pos\r\n            .add(motion.vel.scale(seconds, EulerIntegrator._VEL), EulerIntegrator._POS)\r\n            .addEqual(totalAcc.scale(0.5 * seconds * seconds, EulerIntegrator._VEL_ACC));\r\n        motion.angularVelocity += motion.torque * (1.0 / motion.inertia) * seconds;\r\n        const rotation = transform.rotation + motion.angularVelocity * seconds;\r\n        transform.scale.add(motion.scaleFactor.scale(seconds, this._SCALE_FACTOR), EulerIntegrator._SCALE);\r\n        const tx = transform.get();\r\n        tx.setTransform(EulerIntegrator._POS, rotation, EulerIntegrator._SCALE);\r\n    }\r\n}\r\n// Scratch vectors to avoid allocation\r\nEulerIntegrator._POS = new Vector(0, 0);\r\nEulerIntegrator._SCALE = new Vector(1, 1);\r\nEulerIntegrator._ACC = new Vector(0, 0);\r\nEulerIntegrator._VEL = new Vector(0, 0);\r\nEulerIntegrator._VEL_ACC = new Vector(0, 0);\r\nEulerIntegrator._SCALE_FACTOR = new Vector(0, 0);\r\n\n;// CONCATENATED MODULE: ./Collision/MotionSystem.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass MotionSystem extends System {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.types = ['ex.transform', 'ex.motion'];\r\n        this.systemType = SystemType.Update;\r\n        this.priority = -1;\r\n    }\r\n    update(entities, elapsedMs) {\r\n        let transform;\r\n        let motion;\r\n        for (let i = 0; i < entities.length; i++) {\r\n            transform = entities[i].get(TransformComponent);\r\n            motion = entities[i].get(MotionComponent);\r\n            const optionalBody = entities[i].get(BodyComponent);\r\n            if (optionalBody === null || optionalBody === void 0 ? void 0 : optionalBody.sleeping) {\r\n                continue;\r\n            }\r\n            const totalAcc = motion.acc.clone();\r\n            if ((optionalBody === null || optionalBody === void 0 ? void 0 : optionalBody.collisionType) === CollisionType.Active && (optionalBody === null || optionalBody === void 0 ? void 0 : optionalBody.useGravity)) {\r\n                totalAcc.addEqual(Physics.gravity);\r\n            }\r\n            optionalBody === null || optionalBody === void 0 ? void 0 : optionalBody.captureOldTransform();\r\n            // Update transform and motion based on Euler linear algebra\r\n            EulerIntegrator.integrate(transform, motion, totalAcc, elapsedMs);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Solver/ArcadeSolver.ts\n\r\n\r\n\r\n\r\n/**\r\n * ArcadeSolver is the default in Excalibur. It solves collisions so that there is no overlap between contacts,\r\n * and negates velocity along the collision normal.\r\n *\r\n * This is usually the type of collisions used for 2D games that don't need a more realistic collision simulation.\r\n *\r\n */\r\nclass ArcadeSolver {\r\n    constructor() {\r\n        this.directionMap = new Map();\r\n        this.distanceMap = new Map();\r\n    }\r\n    solve(contacts) {\r\n        // Events and init\r\n        this.preSolve(contacts);\r\n        // Remove any canceled contacts\r\n        contacts = contacts.filter(c => !c.isCanceled());\r\n        // Sort contacts by distance to avoid artifacts with seams\r\n        // It's important to solve in a specific order\r\n        contacts.sort((a, b) => {\r\n            const aDist = this.distanceMap.get(a.id);\r\n            const bDist = this.distanceMap.get(b.id);\r\n            return aDist - bDist;\r\n        });\r\n        for (const contact of contacts) {\r\n            // Solve position first in arcade\r\n            this.solvePosition(contact);\r\n            // Solve velocity second in arcade\r\n            this.solveVelocity(contact);\r\n        }\r\n        // Events and any contact house-keeping the solver needs\r\n        this.postSolve(contacts);\r\n        return contacts;\r\n    }\r\n    preSolve(contacts) {\r\n        const epsilon = .0001;\r\n        for (const contact of contacts) {\r\n            if (Math.abs(contact.mtv.x) < epsilon && Math.abs(contact.mtv.y) < epsilon) {\r\n                // Cancel near 0 mtv collisions\r\n                contact.cancel();\r\n                continue;\r\n            }\r\n            const side = Side.fromDirection(contact.mtv);\r\n            const mtv = contact.mtv.negate();\r\n            const distance = contact.colliderA.worldPos.squareDistance(contact.colliderB.worldPos);\r\n            this.distanceMap.set(contact.id, distance);\r\n            // Publish collision events on both participants\r\n            contact.colliderA.events.emit('precollision', new PreCollisionEvent(contact.colliderA, contact.colliderB, side, mtv));\r\n            contact.colliderB.events.emit('precollision', new PreCollisionEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), mtv.negate()));\r\n        }\r\n    }\r\n    postSolve(contacts) {\r\n        var _a, _b;\r\n        for (const contact of contacts) {\r\n            if (contact.isCanceled()) {\r\n                continue;\r\n            }\r\n            const colliderA = contact.colliderA;\r\n            const colliderB = contact.colliderB;\r\n            const bodyA = (_a = colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n            const bodyB = (_b = colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n            if (bodyA && bodyB) {\r\n                if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\r\n                    continue;\r\n                }\r\n            }\r\n            const side = Side.fromDirection(contact.mtv);\r\n            const mtv = contact.mtv.negate();\r\n            // Publish collision events on both participants\r\n            contact.colliderA.events.emit('postcollision', new PostCollisionEvent(contact.colliderA, contact.colliderB, side, mtv));\r\n            contact.colliderB.events.emit('postcollision', new PostCollisionEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), mtv.negate()));\r\n        }\r\n    }\r\n    solvePosition(contact) {\r\n        var _a, _b;\r\n        const epsilon = .0001;\r\n        // if bounds no longer intersect skip to the next\r\n        // this removes jitter from overlapping/stacked solid tiles or a wall of solid tiles\r\n        if (!contact.colliderA.bounds.overlaps(contact.colliderB.bounds, epsilon)) {\r\n            // Cancel the contact to prevent and solving\r\n            contact.cancel();\r\n            return;\r\n        }\r\n        if (Math.abs(contact.mtv.x) < epsilon && Math.abs(contact.mtv.y) < epsilon) {\r\n            // Cancel near 0 mtv collisions\r\n            contact.cancel();\r\n            return;\r\n        }\r\n        let mtv = contact.mtv;\r\n        const colliderA = contact.colliderA;\r\n        const colliderB = contact.colliderB;\r\n        const bodyA = (_a = colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n        const bodyB = (_b = colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n        if (bodyA && bodyB) {\r\n            if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\r\n                return;\r\n            }\r\n            if (bodyA.collisionType === CollisionType.Active && bodyB.collisionType === CollisionType.Active) {\r\n                // split overlaps if both are Active\r\n                mtv = mtv.scale(0.5);\r\n            }\r\n            // Resolve overlaps\r\n            if (bodyA.collisionType === CollisionType.Active) {\r\n                bodyA.globalPos.x -= mtv.x;\r\n                bodyA.globalPos.y -= mtv.y;\r\n                colliderA.update(bodyA.transform.get());\r\n            }\r\n            if (bodyB.collisionType === CollisionType.Active) {\r\n                bodyB.globalPos.x += mtv.x;\r\n                bodyB.globalPos.y += mtv.y;\r\n                colliderB.update(bodyB.transform.get());\r\n            }\r\n        }\r\n    }\r\n    solveVelocity(contact) {\r\n        var _a, _b;\r\n        if (contact.isCanceled()) {\r\n            return;\r\n        }\r\n        const colliderA = contact.colliderA;\r\n        const colliderB = contact.colliderB;\r\n        const bodyA = (_a = colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n        const bodyB = (_b = colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n        if (bodyA && bodyB) {\r\n            if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\r\n                return;\r\n            }\r\n            const normal = contact.normal;\r\n            const opposite = normal.negate();\r\n            if (bodyA.collisionType === CollisionType.Active) {\r\n                // only adjust velocity if the contact normal is opposite to the current velocity\r\n                // this avoids catching edges on a platform when sliding off\r\n                if (bodyA.vel.normalize().dot(opposite) < 0) {\r\n                    // Cancel out velocity opposite direction of collision normal\r\n                    const velAdj = normal.scale(normal.dot(bodyA.vel.negate()));\r\n                    bodyA.vel = bodyA.vel.add(velAdj);\r\n                }\r\n            }\r\n            if (bodyB.collisionType === CollisionType.Active) {\r\n                // only adjust velocity if the contact normal is opposite to the current velocity\r\n                // this avoids catching edges on a platform\r\n                if (bodyB.vel.normalize().dot(normal) < 0) {\r\n                    const velAdj = opposite.scale(opposite.dot(bodyB.vel.negate()));\r\n                    bodyB.vel = bodyB.vel.add(velAdj);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Solver/ContactConstraintPoint.ts\n\r\n\r\n/**\r\n * Holds information about contact points, meant to be reused over multiple frames of contact\r\n */\r\nclass ContactConstraintPoint {\r\n    constructor(point, local, contact) {\r\n        this.point = point;\r\n        this.local = local;\r\n        this.contact = contact;\r\n        /**\r\n         * Impulse accumulated over time in normal direction\r\n         */\r\n        this.normalImpulse = 0;\r\n        /**\r\n         * Impulse accumulated over time in the tangent direction\r\n         */\r\n        this.tangentImpulse = 0;\r\n        /**\r\n         * Effective mass seen in the normal direction\r\n         */\r\n        this.normalMass = 0;\r\n        /**\r\n         * Effective mass seen in the tangent direction\r\n         */\r\n        this.tangentMass = 0;\r\n        /**\r\n         * Direction from center of mass of bodyA to contact point\r\n         */\r\n        this.aToContact = new Vector(0, 0);\r\n        /**\r\n         * Direction from center of mass of bodyB to contact point\r\n         */\r\n        this.bToContact = new Vector(0, 0);\r\n        /**\r\n         * Original contact velocity combined with bounciness\r\n         */\r\n        this.originalVelocityAndRestitution = 0;\r\n        this.update();\r\n    }\r\n    /**\r\n     * Updates the contact information\r\n     */\r\n    update() {\r\n        var _a, _b;\r\n        const bodyA = (_a = this.contact.colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n        const bodyB = (_b = this.contact.colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n        if (bodyA && bodyB) {\r\n            const normal = this.contact.normal;\r\n            const tangent = this.contact.tangent;\r\n            this.aToContact = this.point.sub(bodyA.globalPos);\r\n            this.bToContact = this.point.sub(bodyB.globalPos);\r\n            const aToContactNormal = this.aToContact.cross(normal);\r\n            const bToContactNormal = this.bToContact.cross(normal);\r\n            this.normalMass =\r\n                bodyA.inverseMass +\r\n                    bodyB.inverseMass +\r\n                    bodyA.inverseInertia * aToContactNormal * aToContactNormal +\r\n                    bodyB.inverseInertia * bToContactNormal * bToContactNormal;\r\n            const aToContactTangent = this.aToContact.cross(tangent);\r\n            const bToContactTangent = this.bToContact.cross(tangent);\r\n            this.tangentMass =\r\n                bodyA.inverseMass +\r\n                    bodyB.inverseMass +\r\n                    bodyA.inverseInertia * aToContactTangent * aToContactTangent +\r\n                    bodyB.inverseInertia * bToContactTangent * bToContactTangent;\r\n        }\r\n        return this;\r\n    }\r\n    /**\r\n     * Returns the relative velocity between bodyA and bodyB\r\n     */\r\n    getRelativeVelocity() {\r\n        var _a, _b;\r\n        const bodyA = (_a = this.contact.colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n        const bodyB = (_b = this.contact.colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n        if (bodyA && bodyB) {\r\n            // Relative velocity in linear terms\r\n            // Angular to linear velocity formula -> omega = velocity/radius so omega x radius = velocity\r\n            const velA = bodyA.vel.add(Vector.cross(bodyA.angularVelocity, this.aToContact));\r\n            const velB = bodyB.vel.add(Vector.cross(bodyB.angularVelocity, this.bToContact));\r\n            return velB.sub(velA);\r\n        }\r\n        return Vector.Zero;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/Solver/RealisticSolver.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass RealisticSolver {\r\n    constructor() {\r\n        this.lastFrameContacts = new Map();\r\n        // map contact id to contact points\r\n        this.idToContactConstraint = new Map();\r\n    }\r\n    getContactConstraints(id) {\r\n        var _a;\r\n        return (_a = this.idToContactConstraint.get(id)) !== null && _a !== void 0 ? _a : [];\r\n    }\r\n    solve(contacts) {\r\n        // Events and init\r\n        this.preSolve(contacts);\r\n        // Remove any canceled contacts\r\n        contacts = contacts.filter(c => !c.isCanceled());\r\n        // Solve velocity first\r\n        this.solveVelocity(contacts);\r\n        // Solve position last because non-overlap is the most important\r\n        this.solvePosition(contacts);\r\n        // Events and any contact house-keeping the solver needs\r\n        this.postSolve(contacts);\r\n        return contacts;\r\n    }\r\n    preSolve(contacts) {\r\n        var _a, _b, _c;\r\n        const epsilon = .0001;\r\n        for (const contact of contacts) {\r\n            if (Math.abs(contact.mtv.x) < epsilon && Math.abs(contact.mtv.y) < epsilon) {\r\n                // Cancel near 0 mtv collisions\r\n                contact.cancel();\r\n                continue;\r\n            }\r\n            // Publish collision events on both participants\r\n            const side = Side.fromDirection(contact.mtv);\r\n            contact.colliderA.events.emit('precollision', new PreCollisionEvent(contact.colliderA, contact.colliderB, side, contact.mtv));\r\n            contact.colliderA.events.emit('beforecollisionresolve', new CollisionPreSolveEvent(contact.colliderA, contact.colliderB, side, contact.mtv, contact));\r\n            contact.colliderB.events.emit('precollision', new PreCollisionEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), contact.mtv.negate()));\r\n            contact.colliderB.events.emit('beforecollisionresolve', new CollisionPreSolveEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), contact.mtv.negate(), contact));\r\n            // Match awake state for sleeping\r\n            contact.matchAwake();\r\n        }\r\n        // Keep track of contacts that done\r\n        const finishedContactIds = Array.from(this.idToContactConstraint.keys());\r\n        for (const contact of contacts) {\r\n            // Remove all current contacts that are not done\r\n            const index = finishedContactIds.indexOf(contact.id);\r\n            if (index > -1) {\r\n                finishedContactIds.splice(index, 1);\r\n            }\r\n            const contactPoints = (_a = this.idToContactConstraint.get(contact.id)) !== null && _a !== void 0 ? _a : [];\r\n            let pointIndex = 0;\r\n            const bodyA = contact.colliderA.owner.get(BodyComponent);\r\n            const bodyB = contact.colliderB.owner.get(BodyComponent);\r\n            if (bodyA && bodyB) {\r\n                for (const point of contact.points) {\r\n                    const normal = contact.normal;\r\n                    const tangent = contact.tangent;\r\n                    const aToContact = point.sub(bodyA.globalPos);\r\n                    const bToContact = point.sub(bodyB.globalPos);\r\n                    const aToContactNormal = aToContact.cross(normal);\r\n                    const bToContactNormal = bToContact.cross(normal);\r\n                    const normalMass = bodyA.inverseMass +\r\n                        bodyB.inverseMass +\r\n                        bodyA.inverseInertia * aToContactNormal * aToContactNormal +\r\n                        bodyB.inverseInertia * bToContactNormal * bToContactNormal;\r\n                    const aToContactTangent = aToContact.cross(tangent);\r\n                    const bToContactTangent = bToContact.cross(tangent);\r\n                    const tangentMass = bodyA.inverseMass +\r\n                        bodyB.inverseMass +\r\n                        bodyA.inverseInertia * aToContactTangent * aToContactTangent +\r\n                        bodyB.inverseInertia * bToContactTangent * bToContactTangent;\r\n                    // Preserve normal/tangent impulse by re-using the contact point if it's close\r\n                    if (contactPoints[pointIndex] && ((_c = (_b = contactPoints[pointIndex]) === null || _b === void 0 ? void 0 : _b.point) === null || _c === void 0 ? void 0 : _c.squareDistance(point)) < 4) {\r\n                        contactPoints[pointIndex].point = point;\r\n                        contactPoints[pointIndex].local = contact.localPoints[pointIndex];\r\n                    }\r\n                    else {\r\n                        // new contact if it's not close or doesn't exist\r\n                        contactPoints[pointIndex] = new ContactConstraintPoint(point, contact.localPoints[pointIndex], contact);\r\n                    }\r\n                    // Update contact point calculations\r\n                    contactPoints[pointIndex].aToContact = aToContact;\r\n                    contactPoints[pointIndex].bToContact = bToContact;\r\n                    contactPoints[pointIndex].normalMass = 1.0 / normalMass;\r\n                    contactPoints[pointIndex].tangentMass = 1.0 / tangentMass;\r\n                    // Calculate relative velocity before solving to accurately do restitution\r\n                    const restitution = bodyA.bounciness > bodyB.bounciness ? bodyA.bounciness : bodyB.bounciness;\r\n                    const relativeVelocity = contact.normal.dot(contactPoints[pointIndex].getRelativeVelocity());\r\n                    contactPoints[pointIndex].originalVelocityAndRestitution = 0;\r\n                    if (relativeVelocity < -0.1) { // TODO what's a good threshold here?\r\n                        contactPoints[pointIndex].originalVelocityAndRestitution = -restitution * relativeVelocity;\r\n                    }\r\n                    pointIndex++;\r\n                }\r\n            }\r\n            this.idToContactConstraint.set(contact.id, contactPoints);\r\n        }\r\n        // Clean up any contacts that did not occur last frame\r\n        for (const id of finishedContactIds) {\r\n            this.idToContactConstraint.delete(id);\r\n        }\r\n        // Warm contacts with accumulated impulse\r\n        // Useful for tall stacks\r\n        if (Physics.warmStart) {\r\n            this.warmStart(contacts);\r\n        }\r\n        else {\r\n            for (const contact of contacts) {\r\n                const contactPoints = this.getContactConstraints(contact.id);\r\n                for (const point of contactPoints) {\r\n                    point.normalImpulse = 0;\r\n                    point.tangentImpulse = 0;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    postSolve(contacts) {\r\n        for (const contact of contacts) {\r\n            const bodyA = contact.colliderA.owner.get(BodyComponent);\r\n            const bodyB = contact.colliderB.owner.get(BodyComponent);\r\n            if (bodyA && bodyB) {\r\n                // Skip post solve for active+passive collisions\r\n                if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\r\n                    continue;\r\n                }\r\n                // Update motion values for sleeping\r\n                bodyA.updateMotion();\r\n                bodyB.updateMotion();\r\n            }\r\n            // Publish collision events on both participants\r\n            const side = Side.fromDirection(contact.mtv);\r\n            contact.colliderA.events.emit('postcollision', new PostCollisionEvent(contact.colliderA, contact.colliderB, side, contact.mtv));\r\n            contact.colliderA.events.emit('aftercollisionresolve', new CollisionPostSolveEvent(contact.colliderA, contact.colliderB, side, contact.mtv, contact));\r\n            contact.colliderB.events.emit('postcollision', new PostCollisionEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), contact.mtv.negate()));\r\n            contact.colliderB.events.emit('aftercollisionresolve', new CollisionPostSolveEvent(contact.colliderB, contact.colliderA, Side.getOpposite(side), contact.mtv.negate(), contact));\r\n        }\r\n        // Store contacts\r\n        this.lastFrameContacts.clear();\r\n        for (const c of contacts) {\r\n            this.lastFrameContacts.set(c.id, c);\r\n        }\r\n    }\r\n    /**\r\n     * Warm up body's based on previous frame contact points\r\n     * @param contacts\r\n     */\r\n    warmStart(contacts) {\r\n        var _a, _b, _c;\r\n        for (const contact of contacts) {\r\n            const bodyA = (_a = contact.colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n            const bodyB = (_b = contact.colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n            if (bodyA && bodyB) {\r\n                const contactPoints = (_c = this.idToContactConstraint.get(contact.id)) !== null && _c !== void 0 ? _c : [];\r\n                for (const point of contactPoints) {\r\n                    if (Physics.warmStart) {\r\n                        const normalImpulse = contact.normal.scale(point.normalImpulse);\r\n                        const tangentImpulse = contact.tangent.scale(point.tangentImpulse);\r\n                        const impulse = normalImpulse.add(tangentImpulse);\r\n                        bodyA.applyImpulse(point.point, impulse.negate());\r\n                        bodyB.applyImpulse(point.point, impulse);\r\n                    }\r\n                    else {\r\n                        point.normalImpulse = 0;\r\n                        point.tangentImpulse = 0;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Iteratively solve the position overlap constraint\r\n     * @param contacts\r\n     */\r\n    solvePosition(contacts) {\r\n        var _a, _b, _c;\r\n        for (let i = 0; i < Physics.positionIterations; i++) {\r\n            for (const contact of contacts) {\r\n                const bodyA = (_a = contact.colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n                const bodyB = (_b = contact.colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n                if (bodyA && bodyB) {\r\n                    // Skip solving active+passive\r\n                    if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\r\n                        continue;\r\n                    }\r\n                    const constraints = (_c = this.idToContactConstraint.get(contact.id)) !== null && _c !== void 0 ? _c : [];\r\n                    for (const point of constraints) {\r\n                        const normal = contact.normal;\r\n                        const separation = CollisionJumpTable.FindContactSeparation(contact, point.local);\r\n                        const steeringConstant = Physics.steeringFactor; //0.2;\r\n                        const maxCorrection = -5;\r\n                        const slop = Physics.slop; //1;\r\n                        // Clamp to avoid over-correction\r\n                        // Remember that we are shooting for 0 overlap in the end\r\n                        const steeringForce = clamp(steeringConstant * (separation + slop), maxCorrection, 0);\r\n                        const impulse = normal.scale(-steeringForce * point.normalMass);\r\n                        // This is a pseudo impulse, meaning we aren't doing a real impulse calculation\r\n                        // We adjust position and rotation instead of doing the velocity\r\n                        if (bodyA.collisionType === CollisionType.Active) {\r\n                            // TODO make applyPseudoImpulse function?\r\n                            const impulseForce = impulse.negate().scale(bodyA.inverseMass);\r\n                            if (bodyA.limitDegreeOfFreedom.includes(DegreeOfFreedom.X)) {\r\n                                impulseForce.x = 0;\r\n                            }\r\n                            if (bodyA.limitDegreeOfFreedom.includes(DegreeOfFreedom.Y)) {\r\n                                impulseForce.y = 0;\r\n                            }\r\n                            bodyA.globalPos = bodyA.globalPos.add(impulseForce);\r\n                            if (!bodyA.limitDegreeOfFreedom.includes(DegreeOfFreedom.Rotation)) {\r\n                                bodyA.rotation -= point.aToContact.cross(impulse) * bodyA.inverseInertia;\r\n                            }\r\n                        }\r\n                        if (bodyB.collisionType === CollisionType.Active) {\r\n                            const impulseForce = impulse.scale(bodyB.inverseMass);\r\n                            if (bodyB.limitDegreeOfFreedom.includes(DegreeOfFreedom.X)) {\r\n                                impulseForce.x = 0;\r\n                            }\r\n                            if (bodyB.limitDegreeOfFreedom.includes(DegreeOfFreedom.Y)) {\r\n                                impulseForce.y = 0;\r\n                            }\r\n                            bodyB.globalPos = bodyB.globalPos.add(impulseForce);\r\n                            if (!bodyB.limitDegreeOfFreedom.includes(DegreeOfFreedom.Rotation)) {\r\n                                bodyB.rotation += point.bToContact.cross(impulse) * bodyB.inverseInertia;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    solveVelocity(contacts) {\r\n        var _a, _b, _c;\r\n        for (let i = 0; i < Physics.velocityIterations; i++) {\r\n            for (const contact of contacts) {\r\n                const bodyA = (_a = contact.colliderA.owner) === null || _a === void 0 ? void 0 : _a.get(BodyComponent);\r\n                const bodyB = (_b = contact.colliderB.owner) === null || _b === void 0 ? void 0 : _b.get(BodyComponent);\r\n                if (bodyA && bodyB) {\r\n                    // Skip solving active+passive\r\n                    if (bodyA.collisionType === CollisionType.Passive || bodyB.collisionType === CollisionType.Passive) {\r\n                        continue;\r\n                    }\r\n                    const friction = Math.min(bodyA.friction, bodyB.friction);\r\n                    const constraints = (_c = this.idToContactConstraint.get(contact.id)) !== null && _c !== void 0 ? _c : [];\r\n                    // Friction constraint\r\n                    for (const point of constraints) {\r\n                        const relativeVelocity = point.getRelativeVelocity();\r\n                        // Negate velocity in tangent direction to simulate friction\r\n                        const tangentVelocity = -relativeVelocity.dot(contact.tangent);\r\n                        let impulseDelta = tangentVelocity * point.tangentMass;\r\n                        // Clamping based in Erin Catto's GDC 2006 talk\r\n                        // Correct clamping https://github.com/erincatto/box2d-lite/blob/master/docs/GDC2006_Catto_Erin_PhysicsTutorial.pdf\r\n                        // Accumulated fiction impulse is always between -uMaxFriction < dT < uMaxFriction\r\n                        // But deltas can vary\r\n                        const maxFriction = friction * point.normalImpulse;\r\n                        const newImpulse = clamp(point.tangentImpulse + impulseDelta, -maxFriction, maxFriction);\r\n                        impulseDelta = newImpulse - point.tangentImpulse;\r\n                        point.tangentImpulse = newImpulse;\r\n                        const impulse = contact.tangent.scale(impulseDelta);\r\n                        bodyA.applyImpulse(point.point, impulse.negate());\r\n                        bodyB.applyImpulse(point.point, impulse);\r\n                    }\r\n                    // Bounce constraint\r\n                    for (const point of constraints) {\r\n                        // Need to recalc relative velocity because the previous step could have changed vel\r\n                        const relativeVelocity = point.getRelativeVelocity();\r\n                        // Compute impulse in normal direction\r\n                        const normalVelocity = relativeVelocity.dot(contact.normal);\r\n                        // Per Erin it is a mistake to apply the restitution inside the iteration\r\n                        // From Erin Catto's Box2D we keep original contact velocity and adjust by small impulses\r\n                        let impulseDelta = -point.normalMass * (normalVelocity - point.originalVelocityAndRestitution);\r\n                        // Clamping based in Erin Catto's GDC 2014 talk\r\n                        // Accumulated impulse stored in the contact is always positive (dV > 0)\r\n                        // But deltas can be negative\r\n                        const newImpulse = Math.max(point.normalImpulse + impulseDelta, 0);\r\n                        impulseDelta = newImpulse - point.normalImpulse;\r\n                        point.normalImpulse = newImpulse;\r\n                        const impulse = contact.normal.scale(impulseDelta);\r\n                        bodyA.applyImpulse(point.point, impulse.negate());\r\n                        bodyB.applyImpulse(point.point, impulse);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/CollisionSystem.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass CollisionSystem extends System {\r\n    constructor(physics) {\r\n        super();\r\n        this.types = ['ex.transform', 'ex.motion', 'ex.collider'];\r\n        this.systemType = SystemType.Update;\r\n        this.priority = -1;\r\n        this._realisticSolver = new RealisticSolver();\r\n        this._arcadeSolver = new ArcadeSolver();\r\n        this._lastFrameContacts = new Map();\r\n        this._currentFrameContacts = new Map();\r\n        this._processor = physics.collisionProcessor;\r\n        this._trackCollider = (c) => this._processor.track(c);\r\n        this._untrackCollider = (c) => this._processor.untrack(c);\r\n    }\r\n    notify(message) {\r\n        if (isAddedSystemEntity(message)) {\r\n            const colliderComponent = message.data.get(ColliderComponent);\r\n            colliderComponent.$colliderAdded.subscribe(this._trackCollider);\r\n            colliderComponent.$colliderRemoved.subscribe(this._untrackCollider);\r\n            const collider = colliderComponent.get();\r\n            if (collider) {\r\n                this._processor.track(collider);\r\n            }\r\n        }\r\n        else {\r\n            const colliderComponent = message.data.get(ColliderComponent);\r\n            const collider = colliderComponent.get();\r\n            if (colliderComponent && collider) {\r\n                this._processor.untrack(collider);\r\n            }\r\n        }\r\n    }\r\n    initialize(scene) {\r\n        this._engine = scene.engine;\r\n    }\r\n    update(entities, elapsedMs) {\r\n        var _a, _b, _c, _d;\r\n        if (!Physics.enabled) {\r\n            return;\r\n        }\r\n        // Collect up all the colliders and update them\r\n        let colliders = [];\r\n        for (const entity of entities) {\r\n            const colliderComp = entity.get(ColliderComponent);\r\n            const collider = colliderComp === null || colliderComp === void 0 ? void 0 : colliderComp.get();\r\n            if (colliderComp && ((_a = colliderComp.owner) === null || _a === void 0 ? void 0 : _a.active) && collider) {\r\n                colliderComp.update();\r\n                if (collider instanceof CompositeCollider) {\r\n                    const compositeColliders = collider.getColliders();\r\n                    colliders = colliders.concat(compositeColliders);\r\n                }\r\n                else {\r\n                    colliders.push(collider);\r\n                }\r\n            }\r\n        }\r\n        // Update the spatial partitioning data structures\r\n        // TODO if collider invalid it will break the processor\r\n        // TODO rename \"update\" to something more specific\r\n        this._processor.update(colliders);\r\n        // Run broadphase on all colliders and locates potential collisions\r\n        const pairs = this._processor.broadphase(colliders, elapsedMs);\r\n        this._currentFrameContacts.clear();\r\n        // Given possible pairs find actual contacts\r\n        let contacts = this._processor.narrowphase(pairs, (_d = (_c = (_b = this._engine) === null || _b === void 0 ? void 0 : _b.debug) === null || _c === void 0 ? void 0 : _c.stats) === null || _d === void 0 ? void 0 : _d.currFrame);\r\n        const solver = this.getSolver();\r\n        // Solve, this resolves the position/velocity so entities aren't overlapping\r\n        contacts = solver.solve(contacts);\r\n        // Record contacts for start/end\r\n        for (const contact of contacts) {\r\n            // Process composite ids, things with the same composite id are treated as the same collider for start/end\r\n            const index = contact.id.indexOf('|');\r\n            if (index > 0) {\r\n                const compositeId = contact.id.substring(index + 1);\r\n                this._currentFrameContacts.set(compositeId, contact);\r\n            }\r\n            else {\r\n                this._currentFrameContacts.set(contact.id, contact);\r\n            }\r\n        }\r\n        // Emit contact start/end events\r\n        this.runContactStartEnd();\r\n        // reset the last frame cache\r\n        this._lastFrameContacts.clear();\r\n        // Keep track of collisions contacts that have started or ended\r\n        this._lastFrameContacts = new Map(this._currentFrameContacts);\r\n    }\r\n    getSolver() {\r\n        return Physics.collisionResolutionStrategy === CollisionResolutionStrategy.Realistic ? this._realisticSolver : this._arcadeSolver;\r\n    }\r\n    debug(ex) {\r\n        this._processor.debug(ex);\r\n    }\r\n    runContactStartEnd() {\r\n        // Composite collider collisions may have a duplicate id because we want to treat those as a singular start/end\r\n        for (const [id, c] of this._currentFrameContacts) {\r\n            // find all new contacts\r\n            if (!this._lastFrameContacts.has(id)) {\r\n                const colliderA = c.colliderA;\r\n                const colliderB = c.colliderB;\r\n                colliderA.events.emit('collisionstart', new CollisionStartEvent(colliderA, colliderB, c));\r\n                colliderA.events.emit('contactstart', new ContactStartEvent(colliderA, colliderB, c));\r\n                colliderB.events.emit('collisionstart', new CollisionStartEvent(colliderB, colliderA, c));\r\n                colliderB.events.emit('contactstart', new ContactStartEvent(colliderB, colliderA, c));\r\n            }\r\n        }\r\n        // find all contacts that have ceased\r\n        for (const [id, c] of this._lastFrameContacts) {\r\n            if (!this._currentFrameContacts.has(id)) {\r\n                const colliderA = c.colliderA;\r\n                const colliderB = c.colliderB;\r\n                colliderA.events.emit('collisionend', new CollisionEndEvent(colliderA, colliderB));\r\n                colliderA.events.emit('contactend', new ContactEndEvent(colliderA, colliderB));\r\n                colliderB.events.emit('collisionend', new CollisionEndEvent(colliderB, colliderA));\r\n                colliderB.events.emit('contactend', new ContactEndEvent(colliderB, colliderA));\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Animation.ts\n\r\n\r\n\r\n\r\nvar AnimationDirection;\r\n(function (AnimationDirection) {\r\n    /**\r\n     * Animation is playing forwards\r\n     */\r\n    AnimationDirection[\"Forward\"] = \"forward\";\r\n    /**\r\n     * Animation is playing backwards\r\n     */\r\n    AnimationDirection[\"Backward\"] = \"backward\";\r\n})(AnimationDirection || (AnimationDirection = {}));\r\nvar AnimationStrategy;\r\n(function (AnimationStrategy) {\r\n    /**\r\n     * Animation ends without displaying anything\r\n     */\r\n    AnimationStrategy[\"End\"] = \"end\";\r\n    /**\r\n     * Animation loops to the first frame after the last frame\r\n     */\r\n    AnimationStrategy[\"Loop\"] = \"loop\";\r\n    /**\r\n     * Animation plays to the last frame, then backwards to the first frame, then repeats\r\n     */\r\n    AnimationStrategy[\"PingPong\"] = \"pingpong\";\r\n    /**\r\n     * Animation ends stopping on the last frame\r\n     */\r\n    AnimationStrategy[\"Freeze\"] = \"freeze\";\r\n})(AnimationStrategy || (AnimationStrategy = {}));\r\nconst AnimationEvents = {\r\n    Frame: 'frame',\r\n    Loop: 'loop',\r\n    Ended: 'ended'\r\n};\r\n/**\r\n * Create an Animation given a list of [[Frame|frames]] in [[AnimationOptions]]\r\n *\r\n * To create an Animation from a [[SpriteSheet]], use [[Animation.fromSpriteSheet]]\r\n */\r\nclass Animation extends Graphic {\r\n    constructor(options) {\r\n        var _a, _b;\r\n        super(options);\r\n        this.events = new EventEmitter();\r\n        this.frames = [];\r\n        this.strategy = AnimationStrategy.Loop;\r\n        this.frameDuration = 100;\r\n        this.timeScale = 1;\r\n        this._idempotencyToken = -1;\r\n        this._firstTick = true;\r\n        this._currentFrame = 0;\r\n        this._timeLeftInFrame = 0;\r\n        this._pingPongDirection = 1;\r\n        this._done = false;\r\n        this._playing = true;\r\n        this._reversed = false;\r\n        this.frames = options.frames;\r\n        this.strategy = (_a = options.strategy) !== null && _a !== void 0 ? _a : this.strategy;\r\n        this.frameDuration = options.totalDuration ? options.totalDuration / this.frames.length : (_b = options.frameDuration) !== null && _b !== void 0 ? _b : this.frameDuration;\r\n        if (options.reverse) {\r\n            this.reverse();\r\n        }\r\n        this.goToFrame(0);\r\n    }\r\n    clone() {\r\n        return new Animation({\r\n            frames: this.frames.map((f) => ({ ...f })),\r\n            frameDuration: this.frameDuration,\r\n            reverse: this._reversed,\r\n            strategy: this.strategy,\r\n            ...this.cloneGraphicOptions()\r\n        });\r\n    }\r\n    get width() {\r\n        const maybeFrame = this.currentFrame;\r\n        if (maybeFrame) {\r\n            return Math.abs(maybeFrame.graphic.width * this.scale.x);\r\n        }\r\n        return 0;\r\n    }\r\n    get height() {\r\n        const maybeFrame = this.currentFrame;\r\n        if (maybeFrame) {\r\n            return Math.abs(maybeFrame.graphic.height * this.scale.y);\r\n        }\r\n        return 0;\r\n    }\r\n    /**\r\n     * Create an Animation from a [[SpriteSheet]], a list of indices into the sprite sheet, a duration per frame\r\n     * and optional [[AnimationStrategy]]\r\n     *\r\n     * Example:\r\n     * ```typescript\r\n     * const spriteSheet = SpriteSheet.fromImageSource({...});\r\n     *\r\n     * const anim = Animation.fromSpriteSheet(spriteSheet, range(0, 5), 200, AnimationStrategy.Loop);\r\n     * ```\r\n     *\r\n     * @param spriteSheet\r\n     * @param frameIndices\r\n     * @param durationPerFrameMs\r\n     * @param strategy\r\n     */\r\n    static fromSpriteSheet(spriteSheet, frameIndices, durationPerFrameMs, strategy = AnimationStrategy.Loop) {\r\n        const maxIndex = spriteSheet.sprites.length - 1;\r\n        const invalidIndices = frameIndices.filter((index) => index < 0 || index > maxIndex);\r\n        if (invalidIndices.length) {\r\n            Animation._LOGGER.warn(`Indices into SpriteSheet were provided that don\\'t exist: ${invalidIndices.join(',')} no frame will be shown`);\r\n        }\r\n        return new Animation({\r\n            frames: spriteSheet.sprites\r\n                .filter((_, index) => frameIndices.indexOf(index) > -1)\r\n                .map((f) => ({\r\n                graphic: f,\r\n                duration: durationPerFrameMs\r\n            })),\r\n            strategy: strategy\r\n        });\r\n    }\r\n    /**\r\n     * Create an [[Animation]] from a [[SpriteSheet]] given a list of coordinates\r\n     *\r\n     * Example:\r\n     * ```typescript\r\n     * const spriteSheet = SpriteSheet.fromImageSource({...});\r\n     *\r\n     * const anim = Animation.fromSpriteSheetCoordinates({\r\n     *  spriteSheet,\r\n     *  frameCoordinates: [\r\n     *    {x: 0, y: 5, duration: 100},\r\n     *    {x: 1, y: 5, duration: 200},\r\n     *    {x: 2, y: 5, duration: 100},\r\n     *    {x: 3, y: 5, duration: 500}\r\n     *  ],\r\n     *  strategy: AnimationStrategy.PingPong\r\n     * });\r\n     * ```\r\n     *\r\n     * @param options\r\n     * @returns Animation\r\n     */\r\n    static fromSpriteSheetCoordinates(options) {\r\n        const { spriteSheet, frameCoordinates, durationPerFrameMs, strategy, reverse } = options;\r\n        const defaultDuration = durationPerFrameMs !== null && durationPerFrameMs !== void 0 ? durationPerFrameMs : 100;\r\n        const frames = [];\r\n        for (const coord of frameCoordinates) {\r\n            const { x, y, duration } = coord;\r\n            const sprite = spriteSheet.getSprite(x, y);\r\n            if (sprite) {\r\n                frames.push({\r\n                    graphic: sprite,\r\n                    duration: duration !== null && duration !== void 0 ? duration : defaultDuration\r\n                });\r\n            }\r\n            else {\r\n                Animation._LOGGER.warn(`Skipping frame! SpriteSheet does not have coordinate (${x}, ${y}), please check your SpriteSheet to confirm that sprite exists`);\r\n            }\r\n        }\r\n        return new Animation({\r\n            frames,\r\n            strategy,\r\n            reverse\r\n        });\r\n    }\r\n    /**\r\n     * Returns the current Frame of the animation\r\n     *\r\n     * Use [[Animation.currentFrameIndex]] to get the frame number and\r\n     * [[Animation.goToFrame]] to set the current frame index\r\n     */\r\n    get currentFrame() {\r\n        if (this._currentFrame >= 0 && this._currentFrame < this.frames.length) {\r\n            return this.frames[this._currentFrame];\r\n        }\r\n        return null;\r\n    }\r\n    /**\r\n     * Returns the current frame index of the animation\r\n     *\r\n     * Use [[Animation.currentFrame]] to grab the current [[Frame]] object\r\n     */\r\n    get currentFrameIndex() {\r\n        return this._currentFrame;\r\n    }\r\n    /**\r\n     * Returns `true` if the animation is playing\r\n     */\r\n    get isPlaying() {\r\n        return this._playing;\r\n    }\r\n    /**\r\n     * Reverses the play direction of the Animation, this preserves the current frame\r\n     */\r\n    reverse() {\r\n        // Don't mutate with the original frame list, create a copy\r\n        this.frames = this.frames.slice().reverse();\r\n        this._reversed = !this._reversed;\r\n    }\r\n    /**\r\n     * Returns the current play direction of the animation\r\n     */\r\n    get direction() {\r\n        // Keep logically consistent with ping-pong direction\r\n        // If ping-pong is forward = 1 and reversed is true then we are logically reversed\r\n        const reversed = (this._reversed && this._pingPongDirection === 1) ? true : false;\r\n        return reversed ? AnimationDirection.Backward : AnimationDirection.Forward;\r\n    }\r\n    /**\r\n     * Plays or resumes the animation from the current frame\r\n     */\r\n    play() {\r\n        this._playing = true;\r\n    }\r\n    /**\r\n     * Pauses the animation on the current frame\r\n     */\r\n    pause() {\r\n        this._playing = false;\r\n        this._firstTick = true; // firstTick must be set to emit the proper frame event\r\n    }\r\n    /**\r\n     * Reset the animation back to the beginning, including if the animation were done\r\n     */\r\n    reset() {\r\n        this._done = false;\r\n        this._firstTick = true;\r\n        this._currentFrame = 0;\r\n    }\r\n    /**\r\n     * Returns `true` if the animation can end\r\n     */\r\n    get canFinish() {\r\n        switch (this.strategy) {\r\n            case AnimationStrategy.End:\r\n            case AnimationStrategy.Freeze: {\r\n                return true;\r\n            }\r\n            default: {\r\n                return false;\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Returns `true` if the animation is done, for looping type animations\r\n     * `ex.AnimationStrategy.PingPong` and `ex.AnimationStrategy.Loop` this will always return `false`\r\n     *\r\n     * See the `ex.Animation.canFinish()` method to know if an animation type can end\r\n     */\r\n    get done() {\r\n        return this._done;\r\n    }\r\n    /**\r\n     * Jump the animation immediately to a specific frame if it exists\r\n     * @param frameNumber\r\n     */\r\n    goToFrame(frameNumber) {\r\n        this._currentFrame = frameNumber;\r\n        this._timeLeftInFrame = this.frameDuration;\r\n        const maybeFrame = this.frames[this._currentFrame];\r\n        if (maybeFrame && !this._done) {\r\n            this._timeLeftInFrame = (maybeFrame === null || maybeFrame === void 0 ? void 0 : maybeFrame.duration) || this.frameDuration;\r\n            this.events.emit('frame', { ...maybeFrame, frameIndex: this.currentFrameIndex });\r\n        }\r\n    }\r\n    _nextFrame() {\r\n        const currentFrame = this._currentFrame;\r\n        if (this._done) {\r\n            return currentFrame;\r\n        }\r\n        let next = -1;\r\n        switch (this.strategy) {\r\n            case AnimationStrategy.Loop: {\r\n                next = (currentFrame + 1) % this.frames.length;\r\n                if (next === 0) {\r\n                    this.events.emit('loop', this);\r\n                }\r\n                break;\r\n            }\r\n            case AnimationStrategy.End: {\r\n                next = currentFrame + 1;\r\n                if (next >= this.frames.length) {\r\n                    this._done = true;\r\n                    this._currentFrame = this.frames.length;\r\n                    this.events.emit('end', this);\r\n                }\r\n                break;\r\n            }\r\n            case AnimationStrategy.Freeze: {\r\n                next = clamp(currentFrame + 1, 0, this.frames.length - 1);\r\n                if (next >= this.frames.length - 1) {\r\n                    this._done = true;\r\n                    this.events.emit('end', this);\r\n                }\r\n                break;\r\n            }\r\n            case AnimationStrategy.PingPong: {\r\n                if (currentFrame + this._pingPongDirection >= this.frames.length) {\r\n                    this._pingPongDirection = -1;\r\n                    this.events.emit('loop', this);\r\n                }\r\n                if (currentFrame + this._pingPongDirection < 0) {\r\n                    this._pingPongDirection = 1;\r\n                    this.events.emit('loop', this);\r\n                }\r\n                next = currentFrame + (this._pingPongDirection % this.frames.length);\r\n                break;\r\n            }\r\n        }\r\n        return next;\r\n    }\r\n    /**\r\n     * Called internally by Excalibur to update the state of the animation potential update the current frame\r\n     * @param elapsedMilliseconds Milliseconds elapsed\r\n     * @param idempotencyToken Prevents double ticking in a frame by passing a unique token to the frame\r\n     */\r\n    tick(elapsedMilliseconds, idempotencyToken = 0) {\r\n        if (this._idempotencyToken === idempotencyToken) {\r\n            return;\r\n        }\r\n        this._idempotencyToken = idempotencyToken;\r\n        if (!this._playing) {\r\n            return;\r\n        }\r\n        // if it's the first frame emit frame event\r\n        if (this._firstTick) {\r\n            this._firstTick = false;\r\n            this.events.emit('frame', { ...this.currentFrame, frameIndex: this.currentFrameIndex });\r\n        }\r\n        this._timeLeftInFrame -= elapsedMilliseconds * this.timeScale;\r\n        if (this._timeLeftInFrame <= 0) {\r\n            this.goToFrame(this._nextFrame());\r\n        }\r\n    }\r\n    _drawImage(ctx, x, y) {\r\n        if (this.currentFrame) {\r\n            this.currentFrame.graphic.draw(ctx, x, y);\r\n        }\r\n    }\r\n}\r\nAnimation._LOGGER = Logger.getInstance();\r\n\n;// CONCATENATED MODULE: ./Graphics/GraphicsGroup.ts\n\r\n\r\n\r\nclass GraphicsGroup extends Graphic {\r\n    constructor(options) {\r\n        super(options);\r\n        this.members = [];\r\n        this.members = options.members;\r\n        this._updateDimensions();\r\n    }\r\n    clone() {\r\n        return new GraphicsGroup({\r\n            members: [...this.members],\r\n            ...this.cloneGraphicOptions()\r\n        });\r\n    }\r\n    _updateDimensions() {\r\n        let bb = new BoundingBox();\r\n        for (const { graphic, pos } of this.members) {\r\n            bb = graphic.localBounds.translate(pos).combine(bb);\r\n        }\r\n        this.width = bb.width;\r\n        this.height = bb.height;\r\n        return bb;\r\n    }\r\n    get localBounds() {\r\n        let bb = new BoundingBox();\r\n        for (const { graphic, pos } of this.members) {\r\n            bb = graphic.localBounds.translate(pos).combine(bb);\r\n        }\r\n        return bb;\r\n    }\r\n    _isAnimationOrGroup(graphic) {\r\n        return graphic instanceof Animation || graphic instanceof GraphicsGroup;\r\n    }\r\n    tick(elapsedMilliseconds, idempotencyToken) {\r\n        for (const member of this.members) {\r\n            const maybeAnimation = member.graphic;\r\n            if (this._isAnimationOrGroup(maybeAnimation)) {\r\n                maybeAnimation.tick(elapsedMilliseconds, idempotencyToken);\r\n            }\r\n        }\r\n    }\r\n    reset() {\r\n        for (const member of this.members) {\r\n            const maybeAnimation = member.graphic;\r\n            if (this._isAnimationOrGroup(maybeAnimation)) {\r\n                maybeAnimation.reset();\r\n            }\r\n        }\r\n    }\r\n    _preDraw(ex, x, y) {\r\n        this._updateDimensions();\r\n        super._preDraw(ex, x, y);\r\n    }\r\n    _drawImage(ex, x, y) {\r\n        for (const member of this.members) {\r\n            ex.save();\r\n            ex.translate(x, y);\r\n            member.graphic.draw(ex, member.pos.x, member.pos.y);\r\n            if (this.showDebug) {\r\n                /* istanbul ignore next */\r\n                ex.debug.drawRect(0, 0, this.width, this.height);\r\n            }\r\n            ex.restore();\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Configurable.ts\n/**\r\n * Configurable helper extends base type and makes all properties available as option bag arguments\r\n * @internal\r\n * @param base\r\n */\r\nfunction Configurable(base) {\r\n    return class extends base {\r\n        assign(props) {\r\n            //set the value of every property that was passed in,\r\n            //if the constructor previously set this value, it will be overridden here\r\n            for (const k in props) {\r\n                // eslint-disable-next-line\r\n                if (typeof this[k] !== 'function') {\r\n                    // eslint-disable-next-line\r\n                    this[k] = props[k];\r\n                }\r\n            }\r\n        }\r\n        constructor(...args) {\r\n            super(...args);\r\n            //get the number of arguments that aren't undefined. TS passes a value to all parameters\r\n            //of whatever ctor is the implementation, so args.length doesn't work here.\r\n            const size = args.filter(function (value) {\r\n                return value !== undefined;\r\n            }).length;\r\n            if (size === 1 && args[0] && typeof args[0] === 'object' && !(args[0] instanceof Array)) {\r\n                this.assign(args[0]);\r\n            }\r\n        }\r\n    };\r\n}\r\n\n;// CONCATENATED MODULE: ./Particles.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * An enum that represents the types of emitter nozzles\r\n */\r\nvar EmitterType;\r\n(function (EmitterType) {\r\n    /**\r\n     * Constant for the circular emitter type\r\n     */\r\n    EmitterType[EmitterType[\"Circle\"] = 0] = \"Circle\";\r\n    /**\r\n     * Constant for the rectangular emitter type\r\n     */\r\n    EmitterType[EmitterType[\"Rectangle\"] = 1] = \"Rectangle\";\r\n})(EmitterType || (EmitterType = {}));\r\n/**\r\n * @hidden\r\n */\r\nclass ParticleImpl extends Entity {\r\n    constructor(emitterOrConfig, life, opacity, beginColor, endColor, position, velocity, acceleration, startSize, endSize) {\r\n        super();\r\n        this.position = new Vector(0, 0);\r\n        this.velocity = new Vector(0, 0);\r\n        this.acceleration = new Vector(0, 0);\r\n        this.particleRotationalVelocity = 0;\r\n        this.currentRotation = 0;\r\n        this.focus = null;\r\n        this.focusAccel = 0;\r\n        this.opacity = 1;\r\n        this.beginColor = Color.White;\r\n        this.endColor = Color.White;\r\n        // Life is counted in ms\r\n        this.life = 300;\r\n        this.fadeFlag = false;\r\n        // Color transitions\r\n        this._rRate = 1;\r\n        this._gRate = 1;\r\n        this._bRate = 1;\r\n        this._aRate = 0;\r\n        this._currentColor = Color.White;\r\n        this.emitter = null;\r\n        this.particleSize = 5;\r\n        this.particleSprite = null;\r\n        this.sizeRate = 0;\r\n        this.elapsedMultiplier = 0;\r\n        this.visible = true;\r\n        this.isOffscreen = false;\r\n        let emitter = emitterOrConfig;\r\n        if (emitter && !(emitterOrConfig instanceof ParticleEmitter)) {\r\n            const config = emitterOrConfig;\r\n            emitter = config.emitter;\r\n            life = config.life;\r\n            opacity = config.opacity;\r\n            endColor = config.endColor;\r\n            beginColor = config.beginColor;\r\n            position = config.position;\r\n            velocity = config.velocity;\r\n            acceleration = config.acceleration;\r\n            startSize = config.startSize;\r\n            endSize = config.endSize;\r\n        }\r\n        this.emitter = emitter;\r\n        this.life = life || this.life;\r\n        this.opacity = opacity || this.opacity;\r\n        this.endColor = endColor || this.endColor.clone();\r\n        this.beginColor = beginColor || this.beginColor.clone();\r\n        this._currentColor = this.beginColor.clone();\r\n        if (this.emitter.particleTransform === ParticleTransform.Global) {\r\n            const globalPos = this.emitter.transform.globalPos;\r\n            this.position = (position || this.position).add(globalPos);\r\n            this.velocity = (velocity || this.velocity).rotate(this.emitter.transform.globalRotation);\r\n        }\r\n        else {\r\n            this.velocity = velocity || this.velocity;\r\n            this.position = (position || this.position);\r\n        }\r\n        this.acceleration = acceleration || this.acceleration;\r\n        this._rRate = (this.endColor.r - this.beginColor.r) / this.life;\r\n        this._gRate = (this.endColor.g - this.beginColor.g) / this.life;\r\n        this._bRate = (this.endColor.b - this.beginColor.b) / this.life;\r\n        this._aRate = this.opacity / this.life;\r\n        this.startSize = startSize || 0;\r\n        this.endSize = endSize || 0;\r\n        if (this.endSize > 0 && this.startSize > 0) {\r\n            this.sizeRate = (this.endSize - this.startSize) / this.life;\r\n            this.particleSize = this.startSize;\r\n        }\r\n        this.addComponent((this.transform = new TransformComponent()));\r\n        this.addComponent((this.graphics = new GraphicsComponent()));\r\n        this.transform.pos = this.position;\r\n        this.transform.rotation = this.currentRotation;\r\n        this.transform.scale = vec(1, 1); // TODO wut\r\n        if (this.particleSprite) {\r\n            this.graphics.opacity = this.opacity;\r\n            this.graphics.use(this.particleSprite);\r\n        }\r\n        else {\r\n            this.graphics.localBounds = BoundingBox.fromDimension(this.particleSize, this.particleSize, Vector.Half);\r\n            this.graphics.onPostDraw = (ctx) => {\r\n                ctx.save();\r\n                this.graphics.opacity = this.opacity;\r\n                const tmpColor = this._currentColor.clone();\r\n                tmpColor.a = 1;\r\n                ctx.debug.drawPoint(vec(0, 0), { color: tmpColor, size: this.particleSize });\r\n                ctx.restore();\r\n            };\r\n        }\r\n    }\r\n    kill() {\r\n        this.emitter.removeParticle(this);\r\n    }\r\n    update(_engine, delta) {\r\n        this.life = this.life - delta;\r\n        this.elapsedMultiplier = this.elapsedMultiplier + delta;\r\n        if (this.life < 0) {\r\n            this.kill();\r\n        }\r\n        if (this.fadeFlag) {\r\n            this.opacity = clamp(this._aRate * this.life, 0.0001, 1);\r\n        }\r\n        if (this.startSize > 0 && this.endSize > 0) {\r\n            this.particleSize = clamp(this.sizeRate * delta + this.particleSize, Math.min(this.startSize, this.endSize), Math.max(this.startSize, this.endSize));\r\n        }\r\n        this._currentColor.r = clamp(this._currentColor.r + this._rRate * delta, 0, 255);\r\n        this._currentColor.g = clamp(this._currentColor.g + this._gRate * delta, 0, 255);\r\n        this._currentColor.b = clamp(this._currentColor.b + this._bRate * delta, 0, 255);\r\n        this._currentColor.a = clamp(this.opacity, 0.0001, 1);\r\n        if (this.focus) {\r\n            const accel = this.focus\r\n                .sub(this.position)\r\n                .normalize()\r\n                .scale(this.focusAccel)\r\n                .scale(delta / 1000);\r\n            this.velocity = this.velocity.add(accel);\r\n        }\r\n        else {\r\n            this.velocity = this.velocity.add(this.acceleration.scale(delta / 1000));\r\n        }\r\n        this.position = this.position.add(this.velocity.scale(delta / 1000));\r\n        if (this.particleRotationalVelocity) {\r\n            this.currentRotation = (this.currentRotation + (this.particleRotationalVelocity * delta) / 1000) % (2 * Math.PI);\r\n        }\r\n        this.transform.pos = this.position;\r\n        this.transform.rotation = this.currentRotation;\r\n        this.transform.scale = vec(1, 1); // todo wut\r\n        this.graphics.opacity = this.opacity;\r\n    }\r\n}\r\n/**\r\n * Particle is used in a [[ParticleEmitter]]\r\n */\r\nclass Particle extends Configurable(ParticleImpl) {\r\n    constructor(emitterOrConfig, life, opacity, beginColor, endColor, position, velocity, acceleration, startSize, endSize) {\r\n        super(emitterOrConfig, life, opacity, beginColor, endColor, position, velocity, acceleration, startSize, endSize);\r\n    }\r\n}\r\nvar ParticleTransform;\r\n(function (ParticleTransform) {\r\n    /**\r\n     * [[ParticleTransform.Global]] is the default and emits particles as if\r\n     * they were world space objects, useful for most effects.\r\n     */\r\n    ParticleTransform[\"Global\"] = \"global\";\r\n    /**\r\n     * [[ParticleTransform.Local]] particles are children of the emitter and move relative to the emitter\r\n     * as they would in a parent/child actor relationship.\r\n     */\r\n    ParticleTransform[\"Local\"] = \"local\";\r\n})(ParticleTransform || (ParticleTransform = {}));\r\n/**\r\n * Using a particle emitter is a great way to create interesting effects\r\n * in your game, like smoke, fire, water, explosions, etc. `ParticleEmitter`\r\n * extend [[Actor]] allowing you to use all of the features that come with.\r\n */\r\nclass ParticleEmitter extends Actor {\r\n    /**\r\n     * Gets the opacity of each particle from 0 to 1.0\r\n     */\r\n    get opacity() {\r\n        return super.graphics.opacity;\r\n    }\r\n    /**\r\n     * Gets the opacity of each particle from 0 to 1.0\r\n     */\r\n    set opacity(opacity) {\r\n        super.graphics.opacity = opacity;\r\n    }\r\n    /**\r\n     * Gets or sets the sprite that a particle should use\r\n     */\r\n    get particleSprite() {\r\n        return this._sprite;\r\n    }\r\n    set particleSprite(val) {\r\n        if (val) {\r\n            this._sprite = val;\r\n        }\r\n    }\r\n    /**\r\n     * @param config particle emitter options bag\r\n     */\r\n    constructor(config) {\r\n        var _a, _b;\r\n        super({ width: (_a = config.width) !== null && _a !== void 0 ? _a : 0, height: (_b = config.height) !== null && _b !== void 0 ? _b : 0 });\r\n        this._particlesToEmit = 0;\r\n        this.numParticles = 0;\r\n        /**\r\n         * Gets or sets the isEmitting flag\r\n         */\r\n        this.isEmitting = true;\r\n        /**\r\n         * Gets or sets the backing particle collection\r\n         */\r\n        this.particles = [];\r\n        /**\r\n         * Gets or sets the backing deadParticle collection\r\n         */\r\n        this.deadParticles = [];\r\n        /**\r\n         * Gets or sets the minimum particle velocity\r\n         */\r\n        this.minVel = 0;\r\n        /**\r\n         * Gets or sets the maximum particle velocity\r\n         */\r\n        this.maxVel = 0;\r\n        /**\r\n         * Gets or sets the acceleration vector for all particles\r\n         */\r\n        this.acceleration = new Vector(0, 0);\r\n        /**\r\n         * Gets or sets the minimum angle in radians\r\n         */\r\n        this.minAngle = 0;\r\n        /**\r\n         * Gets or sets the maximum angle in radians\r\n         */\r\n        this.maxAngle = 0;\r\n        /**\r\n         * Gets or sets the emission rate for particles (particles/sec)\r\n         */\r\n        this.emitRate = 1; //particles/sec\r\n        /**\r\n         * Gets or sets the life of each particle in milliseconds\r\n         */\r\n        this.particleLife = 2000;\r\n        /**\r\n         * Gets or sets the fade flag which causes particles to gradually fade out over the course of their life.\r\n         */\r\n        this.fadeFlag = false;\r\n        /**\r\n         * Gets or sets the optional focus where all particles should accelerate towards\r\n         */\r\n        this.focus = null;\r\n        /**\r\n         * Gets or sets the acceleration for focusing particles if a focus has been specified\r\n         */\r\n        this.focusAccel = null;\r\n        /**\r\n         * Gets or sets the optional starting size for the particles\r\n         */\r\n        this.startSize = null;\r\n        /**\r\n         * Gets or sets the optional ending size for the particles\r\n         */\r\n        this.endSize = null;\r\n        /**\r\n         * Gets or sets the minimum size of all particles\r\n         */\r\n        this.minSize = 5;\r\n        /**\r\n         * Gets or sets the maximum size of all particles\r\n         */\r\n        this.maxSize = 5;\r\n        /**\r\n         * Gets or sets the beginning color of all particles\r\n         */\r\n        this.beginColor = Color.White;\r\n        /**\r\n         * Gets or sets the ending color of all particles\r\n         */\r\n        this.endColor = Color.White;\r\n        this._sprite = null;\r\n        /**\r\n         * Gets or sets the emitter type for the particle emitter\r\n         */\r\n        this.emitterType = EmitterType.Rectangle;\r\n        /**\r\n         * Gets or sets the emitter radius, only takes effect when the [[emitterType]] is [[EmitterType.Circle]]\r\n         */\r\n        this.radius = 0;\r\n        /**\r\n         * Gets or sets the particle rotational speed velocity\r\n         */\r\n        this.particleRotationalVelocity = 0;\r\n        /**\r\n         * Indicates whether particles should start with a random rotation\r\n         */\r\n        this.randomRotation = false;\r\n        /**\r\n         * Gets or sets the emitted particle transform style, [[ParticleTransform.Global]] is the default and emits particles as if\r\n         * they were world space objects, useful for most effects.\r\n         *\r\n         * If set to [[ParticleTransform.Local]] particles are children of the emitter and move relative to the emitter\r\n         * as they would in a parent/child actor relationship.\r\n         */\r\n        this.particleTransform = ParticleTransform.Global;\r\n        const { x, y, pos, isEmitting, minVel, maxVel, acceleration, minAngle, maxAngle, emitRate, particleLife, opacity, fadeFlag, focus, focusAccel, startSize, endSize, minSize, maxSize, beginColor, endColor, particleSprite, emitterType, radius, particleRotationalVelocity, particleTransform, randomRotation, random } = { ...config };\r\n        this.pos = pos !== null && pos !== void 0 ? pos : vec(x !== null && x !== void 0 ? x : 0, y !== null && y !== void 0 ? y : 0);\r\n        this.isEmitting = isEmitting !== null && isEmitting !== void 0 ? isEmitting : this.isEmitting;\r\n        this.minVel = minVel !== null && minVel !== void 0 ? minVel : this.minVel;\r\n        this.maxVel = maxVel !== null && maxVel !== void 0 ? maxVel : this.maxVel;\r\n        this.acceleration = acceleration !== null && acceleration !== void 0 ? acceleration : this.acceleration;\r\n        this.minAngle = minAngle !== null && minAngle !== void 0 ? minAngle : this.minAngle;\r\n        this.maxAngle = maxAngle !== null && maxAngle !== void 0 ? maxAngle : this.maxAngle;\r\n        this.emitRate = emitRate !== null && emitRate !== void 0 ? emitRate : this.emitRate;\r\n        this.particleLife = particleLife !== null && particleLife !== void 0 ? particleLife : this.particleLife;\r\n        this.opacity = opacity !== null && opacity !== void 0 ? opacity : this.opacity;\r\n        this.fadeFlag = fadeFlag !== null && fadeFlag !== void 0 ? fadeFlag : this.fadeFlag;\r\n        this.focus = focus !== null && focus !== void 0 ? focus : this.focus;\r\n        this.focusAccel = focusAccel !== null && focusAccel !== void 0 ? focusAccel : this.focusAccel;\r\n        this.startSize = startSize !== null && startSize !== void 0 ? startSize : this.startSize;\r\n        this.endSize = endSize !== null && endSize !== void 0 ? endSize : this.endSize;\r\n        this.minSize = minSize !== null && minSize !== void 0 ? minSize : this.minSize;\r\n        this.maxSize = maxSize !== null && maxSize !== void 0 ? maxSize : this.maxSize;\r\n        this.beginColor = beginColor !== null && beginColor !== void 0 ? beginColor : this.beginColor;\r\n        this.endColor = endColor !== null && endColor !== void 0 ? endColor : this.endColor;\r\n        this.particleSprite = particleSprite !== null && particleSprite !== void 0 ? particleSprite : this.particleSprite;\r\n        this.emitterType = emitterType !== null && emitterType !== void 0 ? emitterType : this.emitterType;\r\n        this.radius = radius !== null && radius !== void 0 ? radius : this.radius;\r\n        this.particleRotationalVelocity = particleRotationalVelocity !== null && particleRotationalVelocity !== void 0 ? particleRotationalVelocity : this.particleRotationalVelocity;\r\n        this.randomRotation = randomRotation !== null && randomRotation !== void 0 ? randomRotation : this.randomRotation;\r\n        this.particleTransform = particleTransform !== null && particleTransform !== void 0 ? particleTransform : this.particleTransform;\r\n        this.body.collisionType = CollisionType.PreventCollision;\r\n        this.random = random !== null && random !== void 0 ? random : new Random();\r\n    }\r\n    removeParticle(particle) {\r\n        this.deadParticles.push(particle);\r\n    }\r\n    /**\r\n     * Causes the emitter to emit particles\r\n     * @param particleCount  Number of particles to emit right now\r\n     */\r\n    emitParticles(particleCount) {\r\n        var _a;\r\n        for (let i = 0; i < particleCount; i++) {\r\n            const p = this._createParticle();\r\n            this.particles.push(p);\r\n            if ((_a = this === null || this === void 0 ? void 0 : this.scene) === null || _a === void 0 ? void 0 : _a.world) {\r\n                if (this.particleTransform === ParticleTransform.Global) {\r\n                    this.scene.world.add(p);\r\n                }\r\n                else {\r\n                    this.addChild(p);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    clearParticles() {\r\n        this.particles.length = 0;\r\n    }\r\n    // Creates a new particle given the constraints of the emitter\r\n    _createParticle() {\r\n        // todo implement emitter constraints;\r\n        let ranX = 0;\r\n        let ranY = 0;\r\n        const angle = randomInRange(this.minAngle, this.maxAngle, this.random);\r\n        const vel = randomInRange(this.minVel, this.maxVel, this.random);\r\n        const size = this.startSize || randomInRange(this.minSize, this.maxSize, this.random);\r\n        const dx = vel * Math.cos(angle);\r\n        const dy = vel * Math.sin(angle);\r\n        if (this.emitterType === EmitterType.Rectangle) {\r\n            ranX = randomInRange(0, this.width, this.random);\r\n            ranY = randomInRange(0, this.height, this.random);\r\n        }\r\n        else if (this.emitterType === EmitterType.Circle) {\r\n            const radius = randomInRange(0, this.radius, this.random);\r\n            ranX = radius * Math.cos(angle);\r\n            ranY = radius * Math.sin(angle);\r\n        }\r\n        const p = new Particle(this, this.particleLife, this.opacity, this.beginColor, this.endColor, new Vector(ranX, ranY), new Vector(dx, dy), this.acceleration, this.startSize, this.endSize);\r\n        p.fadeFlag = this.fadeFlag;\r\n        p.particleSize = size;\r\n        if (this.particleSprite) {\r\n            p.particleSprite = this.particleSprite;\r\n            p.graphics.opacity = this.opacity;\r\n            p.graphics.use(this._sprite);\r\n        }\r\n        p.particleRotationalVelocity = this.particleRotationalVelocity;\r\n        if (this.randomRotation) {\r\n            p.currentRotation = randomInRange(0, Math.PI * 2, this.random);\r\n        }\r\n        if (this.focus) {\r\n            p.focus = this.focus.add(new Vector(this.pos.x, this.pos.y));\r\n            p.focusAccel = this.focusAccel;\r\n        }\r\n        return p;\r\n    }\r\n    update(engine, delta) {\r\n        var _a;\r\n        super.update(engine, delta);\r\n        if (this.isEmitting) {\r\n            this._particlesToEmit += this.emitRate * (delta / 1000);\r\n            if (this._particlesToEmit > 1.0) {\r\n                this.emitParticles(Math.floor(this._particlesToEmit));\r\n                this._particlesToEmit = this._particlesToEmit - Math.floor(this._particlesToEmit);\r\n            }\r\n        }\r\n        // deferred removal\r\n        for (let i = 0; i < this.deadParticles.length; i++) {\r\n            removeItemFromArray(this.deadParticles[i], this.particles);\r\n            if ((_a = this === null || this === void 0 ? void 0 : this.scene) === null || _a === void 0 ? void 0 : _a.world) {\r\n                this.scene.world.remove(this.deadParticles[i], false);\r\n            }\r\n        }\r\n        this.deadParticles.length = 0;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/GraphicsSystem.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass GraphicsSystem extends System {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.types = ['ex.transform', 'ex.graphics'];\r\n        this.systemType = SystemType.Draw;\r\n        this.priority = 0;\r\n        this._token = 0;\r\n        this._sortedTransforms = [];\r\n        this._zHasChanged = false;\r\n        this._zIndexUpdate = () => {\r\n            this._zHasChanged = true;\r\n        };\r\n    }\r\n    get sortedTransforms() {\r\n        return this._sortedTransforms;\r\n    }\r\n    initialize(scene) {\r\n        this._camera = scene.camera;\r\n        this._engine = scene.engine;\r\n    }\r\n    preupdate() {\r\n        // Graphics context could be switched to fallback in a new frame\r\n        this._graphicsContext = this._engine.graphicsContext;\r\n        if (this._zHasChanged) {\r\n            this._sortedTransforms.sort((a, b) => {\r\n                return a.z - b.z;\r\n            });\r\n            this._zHasChanged = false;\r\n        }\r\n    }\r\n    notify(entityAddedOrRemoved) {\r\n        if (isAddedSystemEntity(entityAddedOrRemoved)) {\r\n            const tx = entityAddedOrRemoved.data.get(TransformComponent);\r\n            this._sortedTransforms.push(tx);\r\n            tx.zIndexChanged$.subscribe(this._zIndexUpdate);\r\n            this._zHasChanged = true;\r\n        }\r\n        else {\r\n            const tx = entityAddedOrRemoved.data.get(TransformComponent);\r\n            tx.zIndexChanged$.unsubscribe(this._zIndexUpdate);\r\n            const index = this._sortedTransforms.indexOf(tx);\r\n            if (index > -1) {\r\n                this._sortedTransforms.splice(index, 1);\r\n            }\r\n        }\r\n    }\r\n    update(_entities, delta) {\r\n        this._token++;\r\n        let graphics;\r\n        FontCache.checkAndClearCache();\r\n        // This is a performance enhancement, most things are in world space\r\n        // so if we can only do this once saves a ton of transform updates\r\n        this._graphicsContext.save();\r\n        if (this._camera) {\r\n            this._camera.draw(this._graphicsContext);\r\n        }\r\n        for (const transform of this._sortedTransforms) {\r\n            const entity = transform.owner;\r\n            // If the entity is offscreen skip\r\n            if (entity.hasTag('ex.offscreen')) {\r\n                continue;\r\n            }\r\n            graphics = entity.get(GraphicsComponent);\r\n            // Exit if graphics set to not visible\r\n            if (!graphics.visible) {\r\n                continue;\r\n            }\r\n            // This optionally sets our camera based on the entity coord plan (world vs. screen)\r\n            if (transform.coordPlane === CoordPlane.Screen) {\r\n                this._graphicsContext.restore();\r\n            }\r\n            this._graphicsContext.save();\r\n            if (transform.coordPlane === CoordPlane.Screen) {\r\n                this._graphicsContext.translate(this._engine.screen.contentArea.left, this._engine.screen.contentArea.top);\r\n            }\r\n            // Tick any graphics state (but only once) for animations and graphics groups\r\n            graphics.update(delta, this._token);\r\n            // Apply parallax\r\n            const parallax = entity.get(ParallaxComponent);\r\n            if (parallax) {\r\n                // We use the Tiled formula\r\n                // https://doc.mapeditor.org/en/latest/manual/layers/#parallax-scrolling-factor\r\n                // cameraPos * (1 - parallaxFactor)\r\n                const oneMinusFactor = Vector.One.sub(parallax.parallaxFactor);\r\n                const parallaxOffset = this._camera.pos.scale(oneMinusFactor);\r\n                this._graphicsContext.translate(parallaxOffset.x, parallaxOffset.y);\r\n            }\r\n            // Position the entity + estimate lag\r\n            this._applyTransform(entity);\r\n            // If there is a material enable it on the context\r\n            if (graphics.material) {\r\n                this._graphicsContext.material = graphics.material;\r\n            }\r\n            // Optionally run the onPreDraw graphics lifecycle draw\r\n            if (graphics.onPreDraw) {\r\n                graphics.onPreDraw(this._graphicsContext, delta);\r\n            }\r\n            // TODO remove this hack on the particle redo\r\n            const particleOpacity = (entity instanceof Particle) ? entity.opacity : 1;\r\n            this._graphicsContext.opacity *= graphics.opacity * particleOpacity;\r\n            // Draw the graphics component\r\n            this._drawGraphicsComponent(graphics);\r\n            // Optionally run the onPostDraw graphics lifecycle draw\r\n            if (graphics.onPostDraw) {\r\n                graphics.onPostDraw(this._graphicsContext, delta);\r\n            }\r\n            this._graphicsContext.restore();\r\n            // Reset the transform back to the original world space\r\n            if (transform.coordPlane === CoordPlane.Screen) {\r\n                this._graphicsContext.save();\r\n                if (this._camera) {\r\n                    this._camera.draw(this._graphicsContext);\r\n                }\r\n            }\r\n        }\r\n        this._graphicsContext.restore();\r\n    }\r\n    _drawGraphicsComponent(graphicsComponent) {\r\n        var _a, _b;\r\n        if (graphicsComponent.visible) {\r\n            const flipHorizontal = graphicsComponent.flipHorizontal;\r\n            const flipVertical = graphicsComponent.flipVertical;\r\n            for (const layer of graphicsComponent.layers.get()) {\r\n                for (const { graphic, options } of layer.graphics) {\r\n                    let anchor = graphicsComponent.anchor;\r\n                    let offset = graphicsComponent.offset;\r\n                    // handle layer specific overrides\r\n                    if (options === null || options === void 0 ? void 0 : options.anchor) {\r\n                        anchor = options.anchor;\r\n                    }\r\n                    if (options === null || options === void 0 ? void 0 : options.offset) {\r\n                        offset = options.offset;\r\n                    }\r\n                    // See https://github.com/excaliburjs/Excalibur/pull/619 for discussion on this formula\r\n                    const offsetX = -graphic.width * anchor.x + offset.x;\r\n                    const offsetY = -graphic.height * anchor.y + offset.y;\r\n                    const oldFlipHorizontal = graphic.flipHorizontal;\r\n                    const oldFlipVertical = graphic.flipVertical;\r\n                    if (flipHorizontal || flipVertical) {\r\n                        // flip any currently flipped graphics\r\n                        graphic.flipHorizontal = flipHorizontal ? !oldFlipHorizontal : oldFlipHorizontal;\r\n                        graphic.flipVertical = flipVertical ? !oldFlipVertical : oldFlipVertical;\r\n                    }\r\n                    graphic === null || graphic === void 0 ? void 0 : graphic.draw(this._graphicsContext, offsetX + layer.offset.x, offsetY + layer.offset.y);\r\n                    if (flipHorizontal || flipVertical) {\r\n                        graphic.flipHorizontal = oldFlipHorizontal;\r\n                        graphic.flipVertical = oldFlipVertical;\r\n                    }\r\n                    if (((_a = this._engine) === null || _a === void 0 ? void 0 : _a.isDebug) && this._engine.debug.graphics.showBounds) {\r\n                        const offset = vec(offsetX + layer.offset.x, offsetY + layer.offset.y);\r\n                        if (graphic instanceof GraphicsGroup) {\r\n                            for (const g of graphic.members) {\r\n                                (_b = g.graphic) === null || _b === void 0 ? void 0 : _b.localBounds.translate(offset.add(g.pos)).draw(this._graphicsContext, this._engine.debug.graphics.boundsColor);\r\n                            }\r\n                        }\r\n                        else {\r\n                            /* istanbul ignore next */\r\n                            graphic === null || graphic === void 0 ? void 0 : graphic.localBounds.translate(offset).draw(this._graphicsContext, this._engine.debug.graphics.boundsColor);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * This applies the current entity transform to the graphics context\r\n     * @param entity\r\n     */\r\n    _applyTransform(entity) {\r\n        const ancestors = entity.getAncestors();\r\n        for (const ancestor of ancestors) {\r\n            const transform = ancestor === null || ancestor === void 0 ? void 0 : ancestor.get(TransformComponent);\r\n            const optionalBody = ancestor === null || ancestor === void 0 ? void 0 : ancestor.get(BodyComponent);\r\n            let interpolatedPos = transform.pos;\r\n            let interpolatedScale = transform.scale;\r\n            let interpolatedRotation = transform.rotation;\r\n            if (optionalBody) {\r\n                if (this._engine.fixedUpdateFps &&\r\n                    optionalBody.__oldTransformCaptured &&\r\n                    optionalBody.enableFixedUpdateInterpolate) {\r\n                    // Interpolate graphics if needed\r\n                    const blend = this._engine.currentFrameLagMs / (1000 / this._engine.fixedUpdateFps);\r\n                    interpolatedPos = transform.pos.scale(blend).add(optionalBody.oldPos.scale(1.0 - blend));\r\n                    interpolatedScale = transform.scale.scale(blend).add(optionalBody.oldScale.scale(1.0 - blend));\r\n                    // Rotational lerp https://stackoverflow.com/a/30129248\r\n                    const cosine = (1.0 - blend) * Math.cos(optionalBody.oldRotation) + blend * Math.cos(transform.rotation);\r\n                    const sine = (1.0 - blend) * Math.sin(optionalBody.oldRotation) + blend * Math.sin(transform.rotation);\r\n                    interpolatedRotation = Math.atan2(sine, cosine);\r\n                }\r\n            }\r\n            if (transform) {\r\n                this._graphicsContext.z = transform.z;\r\n                this._graphicsContext.translate(interpolatedPos.x, interpolatedPos.y);\r\n                this._graphicsContext.scale(interpolatedScale.x, interpolatedScale.y);\r\n                this._graphicsContext.rotate(interpolatedRotation);\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Debug/DebugSystem.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass DebugSystem extends System {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.types = ['ex.transform'];\r\n        this.systemType = SystemType.Draw;\r\n        this.priority = 999; // lowest priority\r\n    }\r\n    initialize(scene) {\r\n        this._graphicsContext = scene.engine.graphicsContext;\r\n        this._camera = scene.camera;\r\n        this._engine = scene.engine;\r\n        this._collisionSystem = scene.world.systemManager.get(CollisionSystem);\r\n    }\r\n    update(entities, _delta) {\r\n        var _a;\r\n        if (!this._engine.isDebug) {\r\n            return;\r\n        }\r\n        const filterSettings = this._engine.debug.filter;\r\n        let id;\r\n        let name;\r\n        const entitySettings = this._engine.debug.entity;\r\n        let tx;\r\n        const txSettings = this._engine.debug.transform;\r\n        let motion;\r\n        const motionSettings = this._engine.debug.motion;\r\n        let colliderComp;\r\n        const colliderSettings = this._engine.debug.collider;\r\n        const physicsSettings = this._engine.debug.physics;\r\n        let graphics;\r\n        const graphicsSettings = this._engine.debug.graphics;\r\n        let debugDraw;\r\n        let body;\r\n        const bodySettings = this._engine.debug.body;\r\n        const cameraSettings = this._engine.debug.camera;\r\n        for (const entity of entities) {\r\n            if (entity.hasTag('offscreen')) {\r\n                // skip offscreen entities\r\n                continue;\r\n            }\r\n            if (entity instanceof Particle) {\r\n                // Particles crush the renderer :(\r\n                continue;\r\n            }\r\n            if (filterSettings.useFilter) {\r\n                const allIds = filterSettings.ids.length === 0;\r\n                const idMatch = allIds || filterSettings.ids.includes(entity.id);\r\n                if (!idMatch) {\r\n                    continue;\r\n                }\r\n                const allNames = filterSettings.nameQuery === '';\r\n                const nameMatch = allNames || entity.name.includes(filterSettings.nameQuery);\r\n                if (!nameMatch) {\r\n                    continue;\r\n                }\r\n            }\r\n            let cursor = Vector.Zero;\r\n            const lineHeight = vec(0, 16);\r\n            id = entity.id;\r\n            name = entity.name;\r\n            tx = entity.get(TransformComponent);\r\n            // This optionally sets our camera based on the entity coord plan (world vs. screen)\r\n            this._pushCameraTransform(tx);\r\n            this._graphicsContext.save();\r\n            this._applyTransform(entity);\r\n            if (tx) {\r\n                if (txSettings.showAll || txSettings.showPosition) {\r\n                    this._graphicsContext.debug.drawPoint(Vector.Zero, { size: 4, color: txSettings.positionColor });\r\n                }\r\n                if (txSettings.showAll || txSettings.showPositionLabel) {\r\n                    this._graphicsContext.debug.drawText(`pos${tx.pos.toString(2)}`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (txSettings.showAll || txSettings.showZIndex) {\r\n                    this._graphicsContext.debug.drawText(`z(${tx.z.toFixed(1)})`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (entitySettings.showAll || entitySettings.showId) {\r\n                    this._graphicsContext.debug.drawText(`id(${id}) ${entity.parent ? 'child of id(' + ((_a = entity.parent) === null || _a === void 0 ? void 0 : _a.id) + ')' : ''}`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (entitySettings.showAll || entitySettings.showName) {\r\n                    this._graphicsContext.debug.drawText(`name(${name})`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (txSettings.showAll || txSettings.showRotation) {\r\n                    this._graphicsContext.drawLine(Vector.Zero, Vector.fromAngle(tx.rotation).scale(50).add(Vector.Zero), txSettings.rotationColor, 2);\r\n                    this._graphicsContext.debug.drawText(`rot deg(${toDegrees(tx.rotation).toFixed(2)})`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (txSettings.showAll || txSettings.showScale) {\r\n                    this._graphicsContext.drawLine(Vector.Zero, tx.scale.add(Vector.Zero), txSettings.scaleColor, 2);\r\n                }\r\n            }\r\n            graphics = entity.get(GraphicsComponent);\r\n            if (graphics) {\r\n                if (graphicsSettings.showAll || graphicsSettings.showBounds) {\r\n                    const bounds = graphics.localBounds;\r\n                    bounds.draw(this._graphicsContext, graphicsSettings.boundsColor);\r\n                }\r\n            }\r\n            debugDraw = entity.get(DebugGraphicsComponent);\r\n            if (debugDraw) {\r\n                if (!debugDraw.useTransform) {\r\n                    this._graphicsContext.restore();\r\n                }\r\n                debugDraw.draw(this._graphicsContext);\r\n                if (!debugDraw.useTransform) {\r\n                    this._graphicsContext.save();\r\n                    this._applyTransform(entity);\r\n                }\r\n            }\r\n            body = entity.get(BodyComponent);\r\n            if (body) {\r\n                if (bodySettings.showAll || bodySettings.showCollisionGroup) {\r\n                    this._graphicsContext.debug.drawText(`collision group(${body.group.name})`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (bodySettings.showAll || bodySettings.showCollisionType) {\r\n                    this._graphicsContext.debug.drawText(`collision type(${body.collisionType})`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (bodySettings.showAll || bodySettings.showMass) {\r\n                    this._graphicsContext.debug.drawText(`mass(${body.mass})`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (bodySettings.showAll || bodySettings.showMotion) {\r\n                    this._graphicsContext.debug.drawText(`motion(${body.sleepMotion})`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (bodySettings.showAll || bodySettings.showSleeping) {\r\n                    this._graphicsContext.debug.drawText(`sleeping(${body.canSleep ? body.sleeping : 'cant sleep'})`, cursor);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n            }\r\n            this._graphicsContext.restore();\r\n            motion = entity.get(MotionComponent);\r\n            if (motion) {\r\n                if (motionSettings.showAll || motionSettings.showVelocity) {\r\n                    this._graphicsContext.debug.drawText(`vel${motion.vel.toString(2)}`, cursor.add(tx.globalPos));\r\n                    this._graphicsContext.drawLine(tx.globalPos, tx.globalPos.add(motion.vel), motionSettings.velocityColor, 2);\r\n                    cursor = cursor.add(lineHeight);\r\n                }\r\n                if (motionSettings.showAll || motionSettings.showAcceleration) {\r\n                    this._graphicsContext.drawLine(tx.globalPos, tx.globalPos.add(motion.acc), motionSettings.accelerationColor, 2);\r\n                }\r\n            }\r\n            // Colliders live in world space already so after the restore()\r\n            colliderComp = entity.get(ColliderComponent);\r\n            if (colliderComp) {\r\n                const collider = colliderComp.get();\r\n                if ((colliderSettings.showAll || colliderSettings.showGeometry) && collider) {\r\n                    collider.debug(this._graphicsContext, colliderSettings.geometryColor);\r\n                }\r\n                if (colliderSettings.showAll || colliderSettings.showBounds) {\r\n                    if (collider instanceof CompositeCollider) {\r\n                        const colliders = collider.getColliders();\r\n                        for (const collider of colliders) {\r\n                            const bounds = collider.bounds;\r\n                            const pos = vec(bounds.left, bounds.top);\r\n                            this._graphicsContext.debug.drawRect(pos.x, pos.y, bounds.width, bounds.height, { color: colliderSettings.boundsColor });\r\n                            if (colliderSettings.showAll || colliderSettings.showOwner) {\r\n                                this._graphicsContext.debug.drawText(`owner id(${collider.owner.id})`, pos);\r\n                            }\r\n                        }\r\n                        colliderComp.bounds.draw(this._graphicsContext, colliderSettings.boundsColor);\r\n                    }\r\n                    else if (collider) {\r\n                        const bounds = colliderComp.bounds;\r\n                        const pos = vec(bounds.left, bounds.top);\r\n                        this._graphicsContext.debug.drawRect(pos.x, pos.y, bounds.width, bounds.height, { color: colliderSettings.boundsColor });\r\n                        if (colliderSettings.showAll || colliderSettings.showOwner) {\r\n                            this._graphicsContext.debug.drawText(`owner id(${colliderComp.owner.id})`, pos);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            this._popCameraTransform(tx);\r\n        }\r\n        this._graphicsContext.save();\r\n        this._camera.draw(this._graphicsContext);\r\n        if (physicsSettings.showAll || physicsSettings.showBroadphaseSpacePartitionDebug) {\r\n            this._collisionSystem.debug(this._graphicsContext);\r\n        }\r\n        if (physicsSettings.showAll || physicsSettings.showCollisionContacts || physicsSettings.showCollisionNormals) {\r\n            for (const [_, contact] of this._engine.debug.stats.currFrame.physics.contacts) {\r\n                if (physicsSettings.showAll || physicsSettings.showCollisionContacts) {\r\n                    for (const point of contact.points) {\r\n                        this._graphicsContext.debug.drawPoint(point, { size: 5, color: physicsSettings.collisionContactColor });\r\n                    }\r\n                }\r\n                if (physicsSettings.showAll || physicsSettings.showCollisionNormals) {\r\n                    for (const point of contact.points) {\r\n                        this._graphicsContext.debug.drawLine(point, contact.normal.scale(30).add(point), {\r\n                            color: physicsSettings.collisionNormalColor\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        this._graphicsContext.restore();\r\n        if (cameraSettings) {\r\n            this._graphicsContext.save();\r\n            this._camera.draw(this._graphicsContext);\r\n            if (cameraSettings.showAll || cameraSettings.showFocus) {\r\n                this._graphicsContext.drawCircle(this._camera.pos, 4, cameraSettings.focusColor);\r\n            }\r\n            if (cameraSettings.showAll || cameraSettings.showZoom) {\r\n                this._graphicsContext.debug.drawText(`zoom(${this._camera.zoom})`, this._camera.pos);\r\n            }\r\n            this._graphicsContext.restore();\r\n        }\r\n        this._graphicsContext.flush();\r\n    }\r\n    /**\r\n     * This applies the current entity transform to the graphics context\r\n     * @param entity\r\n     */\r\n    _applyTransform(entity) {\r\n        const ancestors = entity.getAncestors();\r\n        for (const ancestor of ancestors) {\r\n            const transform = ancestor === null || ancestor === void 0 ? void 0 : ancestor.get(TransformComponent);\r\n            if (transform) {\r\n                this._graphicsContext.translate(transform.pos.x, transform.pos.y);\r\n                this._graphicsContext.scale(transform.scale.x, transform.scale.y);\r\n                this._graphicsContext.rotate(transform.rotation);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Applies the current camera transform if in world coordinates\r\n     * @param transform\r\n     */\r\n    _pushCameraTransform(transform) {\r\n        // Establish camera offset per entity\r\n        if (transform.coordPlane === CoordPlane.World) {\r\n            this._graphicsContext.save();\r\n            if (this._camera) {\r\n                this._camera.draw(this._graphicsContext);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Resets the current camera transform if in world coordinates\r\n     * @param transform\r\n     */\r\n    _popCameraTransform(transform) {\r\n        if (transform.coordPlane === CoordPlane.World) {\r\n            // Apply camera world offset\r\n            this._graphicsContext.restore();\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Input/PointerSystem.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * The PointerSystem is responsible for dispatching pointer events to entities\r\n * that need them.\r\n *\r\n * The PointerSystem can be optionally configured by the [[PointerComponent]], by default Entities use\r\n * the [[Collider]]'s shape for pointer events.\r\n */\r\nclass PointerSystem extends System {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.types = ['ex.transform', 'ex.pointer'];\r\n        this.systemType = SystemType.Update;\r\n        this.priority = -1;\r\n        /**\r\n         * Optionally override component configuration for all entities\r\n         */\r\n        this.overrideUseColliderShape = false;\r\n        /**\r\n         * Optionally override component configuration for all entities\r\n         */\r\n        this.overrideUseGraphicsBounds = false;\r\n        this.lastFrameEntityToPointers = new Map();\r\n        this.currentFrameEntityToPointers = new Map();\r\n        this._sortedTransforms = [];\r\n        this._sortedEntities = [];\r\n        this._zHasChanged = false;\r\n        this._zIndexUpdate = () => {\r\n            this._zHasChanged = true;\r\n        };\r\n    }\r\n    initialize(scene) {\r\n        this._engine = scene.engine;\r\n    }\r\n    preupdate() {\r\n        // event receiver might change per frame\r\n        this._receiver = this._engine.input.pointers;\r\n        if (this._zHasChanged) {\r\n            this._sortedTransforms.sort((a, b) => {\r\n                return b.z - a.z;\r\n            });\r\n            this._sortedEntities = this._sortedTransforms.map(t => t.owner);\r\n            this._zHasChanged = false;\r\n        }\r\n    }\r\n    notify(entityAddedOrRemoved) {\r\n        if (isAddedSystemEntity(entityAddedOrRemoved)) {\r\n            const tx = entityAddedOrRemoved.data.get(TransformComponent);\r\n            this._sortedTransforms.push(tx);\r\n            this._sortedEntities.push(tx.owner);\r\n            tx.zIndexChanged$.subscribe(this._zIndexUpdate);\r\n            this._zHasChanged = true;\r\n        }\r\n        else {\r\n            const tx = entityAddedOrRemoved.data.get(TransformComponent);\r\n            tx.zIndexChanged$.unsubscribe(this._zIndexUpdate);\r\n            const index = this._sortedTransforms.indexOf(tx);\r\n            if (index > -1) {\r\n                this._sortedTransforms.splice(index, 1);\r\n                this._sortedEntities.splice(index, 1);\r\n            }\r\n        }\r\n    }\r\n    entityCurrentlyUnderPointer(entity, pointerId) {\r\n        return this.currentFrameEntityToPointers.has(entity.id) &&\r\n            this.currentFrameEntityToPointers.get(entity.id).includes(pointerId);\r\n    }\r\n    entityWasUnderPointer(entity, pointerId) {\r\n        return this.lastFrameEntityToPointers.has(entity.id) &&\r\n            this.lastFrameEntityToPointers.get(entity.id).includes(pointerId);\r\n    }\r\n    entered(entity, pointerId) {\r\n        return this.entityCurrentlyUnderPointer(entity, pointerId) &&\r\n            !this.lastFrameEntityToPointers.has(entity.id);\r\n    }\r\n    left(entity, pointerId) {\r\n        return !this.currentFrameEntityToPointers.has(entity.id) &&\r\n            this.entityWasUnderPointer(entity, pointerId);\r\n    }\r\n    addPointerToEntity(entity, pointerId) {\r\n        if (!this.currentFrameEntityToPointers.has(entity.id)) {\r\n            this.currentFrameEntityToPointers.set(entity.id, [pointerId]);\r\n            return;\r\n        }\r\n        const pointers = this.currentFrameEntityToPointers.get(entity.id);\r\n        this.currentFrameEntityToPointers.set(entity.id, pointers.concat(pointerId));\r\n    }\r\n    update(_entities) {\r\n        // Locate all the pointer/entity mappings\r\n        this._processPointerToEntity(this._sortedEntities);\r\n        // Dispatch pointer events on entities\r\n        this._dispatchEvents(this._sortedEntities);\r\n        // Clear last frame's events\r\n        this._receiver.update();\r\n        this.lastFrameEntityToPointers.clear();\r\n        this.lastFrameEntityToPointers = new Map(this.currentFrameEntityToPointers);\r\n        this.currentFrameEntityToPointers.clear();\r\n        this._receiver.clear();\r\n    }\r\n    _processPointerToEntity(entities) {\r\n        var _a;\r\n        let transform;\r\n        let collider;\r\n        let graphics;\r\n        let pointer;\r\n        // TODO probably a spatial partition optimization here to quickly query bounds for pointer\r\n        // doesn't seem to cause issues tho for perf\r\n        // Pre-process find entities under pointers\r\n        for (const entity of entities) {\r\n            transform = entity.get(TransformComponent);\r\n            pointer = (_a = entity.get(PointerComponent)) !== null && _a !== void 0 ? _a : new PointerComponent;\r\n            // Check collider contains pointer\r\n            collider = entity.get(ColliderComponent);\r\n            if (collider && (pointer.useColliderShape || this.overrideUseColliderShape)) {\r\n                collider.update();\r\n                const geom = collider.get();\r\n                if (geom) {\r\n                    for (const [pointerId, pos] of this._receiver.currentFramePointerCoords.entries()) {\r\n                        if (geom.contains(transform.coordPlane === CoordPlane.World ? pos.worldPos : pos.screenPos)) {\r\n                            this.addPointerToEntity(entity, pointerId);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            // Check graphics contains pointer\r\n            graphics = entity.get(GraphicsComponent);\r\n            if (graphics && (pointer.useGraphicsBounds || this.overrideUseGraphicsBounds)) {\r\n                const graphicBounds = graphics.localBounds.transform(transform.get().matrix);\r\n                for (const [pointerId, pos] of this._receiver.currentFramePointerCoords.entries()) {\r\n                    if (graphicBounds.contains(transform.coordPlane === CoordPlane.World ? pos.worldPos : pos.screenPos)) {\r\n                        this.addPointerToEntity(entity, pointerId);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    _processDownAndEmit(entity) {\r\n        const lastDownPerPointer = new Map();\r\n        // Loop through down and dispatch to entities\r\n        for (const event of this._receiver.currentFrameDown) {\r\n            if (event.active && entity.active && this.entityCurrentlyUnderPointer(entity, event.pointerId)) {\r\n                entity.events.emit('pointerdown', event);\r\n                if (this._receiver.isDragStart(event.pointerId)) {\r\n                    entity.events.emit('pointerdragstart', event);\r\n                }\r\n            }\r\n            lastDownPerPointer.set(event.pointerId, event);\r\n        }\r\n        return lastDownPerPointer;\r\n    }\r\n    _processUpAndEmit(entity) {\r\n        const lastUpPerPointer = new Map();\r\n        // Loop through up and dispatch to entities\r\n        for (const event of this._receiver.currentFrameUp) {\r\n            if (event.active && entity.active && this.entityCurrentlyUnderPointer(entity, event.pointerId)) {\r\n                entity.events.emit('pointerup', event);\r\n                if (this._receiver.isDragEnd(event.pointerId)) {\r\n                    entity.events.emit('pointerdragend', event);\r\n                }\r\n            }\r\n            lastUpPerPointer.set(event.pointerId, event);\r\n        }\r\n        return lastUpPerPointer;\r\n    }\r\n    _processMoveAndEmit(entity) {\r\n        const lastMovePerPointer = new Map();\r\n        // Loop through move and dispatch to entities\r\n        for (const event of this._receiver.currentFrameMove) {\r\n            if (event.active && entity.active && this.entityCurrentlyUnderPointer(entity, event.pointerId)) {\r\n                // move\r\n                entity.events.emit('pointermove', event);\r\n                if (this._receiver.isDragging(event.pointerId)) {\r\n                    entity.events.emit('pointerdragmove', event);\r\n                }\r\n            }\r\n            lastMovePerPointer.set(event.pointerId, event);\r\n        }\r\n        return lastMovePerPointer;\r\n    }\r\n    _processEnterLeaveAndEmit(entity, lastUpDownMoveEvents) {\r\n        // up, down, and move are considered for enter and leave\r\n        for (const event of lastUpDownMoveEvents) {\r\n            // enter\r\n            if (event.active && entity.active && this.entered(entity, event.pointerId)) {\r\n                entity.events.emit('pointerenter', event);\r\n                if (this._receiver.isDragging(event.pointerId)) {\r\n                    entity.events.emit('pointerdragenter', event);\r\n                }\r\n                break;\r\n            }\r\n            if (event.active && entity.active &&\r\n                // leave can happen on move\r\n                (this.left(entity, event.pointerId) ||\r\n                    // or leave can happen on pointer up\r\n                    (this.entityCurrentlyUnderPointer(entity, event.pointerId) && event.type === 'up'))) {\r\n                entity.events.emit('pointerleave', event);\r\n                if (this._receiver.isDragging(event.pointerId)) {\r\n                    entity.events.emit('pointerdragleave', event);\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    _processCancelAndEmit(entity) {\r\n        // cancel\r\n        for (const event of this._receiver.currentFrameCancel) {\r\n            if (event.active && entity.active && this.entityCurrentlyUnderPointer(entity, event.pointerId)) {\r\n                entity.events.emit('pointercancel', event);\r\n            }\r\n        }\r\n    }\r\n    _processWheelAndEmit(entity) {\r\n        // wheel\r\n        for (const event of this._receiver.currentFrameWheel) {\r\n            // Currently the wheel only fires under the primary pointer '0'\r\n            if (event.active && entity.active && this.entityCurrentlyUnderPointer(entity, 0)) {\r\n                entity.events.emit('pointerwheel', event);\r\n            }\r\n        }\r\n    }\r\n    _dispatchEvents(entities) {\r\n        const lastFrameEntities = new Set(this.lastFrameEntityToPointers.keys());\r\n        const currentFrameEntities = new Set(this.currentFrameEntityToPointers.keys());\r\n        // Filter preserves z order\r\n        const entitiesWithEvents = entities.filter(e => lastFrameEntities.has(e.id) || currentFrameEntities.has(e.id));\r\n        let lastMovePerPointer;\r\n        let lastUpPerPointer;\r\n        let lastDownPerPointer;\r\n        // Dispatch events in entity z order\r\n        for (const entity of entitiesWithEvents) {\r\n            lastDownPerPointer = this._processDownAndEmit(entity);\r\n            lastUpPerPointer = this._processUpAndEmit(entity);\r\n            lastMovePerPointer = this._processMoveAndEmit(entity);\r\n            const lastUpDownMoveEvents = [\r\n                ...lastMovePerPointer.values(),\r\n                ...lastDownPerPointer.values(),\r\n                ...lastUpPerPointer.values()\r\n            ];\r\n            this._processEnterLeaveAndEmit(entity, lastUpDownMoveEvents);\r\n            this._processCancelAndEmit(entity);\r\n            this._processWheelAndEmit(entity);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/ActionsSystem.ts\n\r\n\r\nclass ActionsSystem extends System {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.types = ['ex.actions'];\r\n        this.systemType = SystemType.Update;\r\n        this.priority = -1;\r\n        this._actions = [];\r\n    }\r\n    notify(entityAddedOrRemoved) {\r\n        if (isAddedSystemEntity(entityAddedOrRemoved)) {\r\n            const action = entityAddedOrRemoved.data.get(ActionsComponent);\r\n            this._actions.push(action);\r\n        }\r\n        else {\r\n            const action = entityAddedOrRemoved.data.get(ActionsComponent);\r\n            const index = this._actions.indexOf(action);\r\n            if (index > -1) {\r\n                this._actions.splice(index, 1);\r\n            }\r\n        }\r\n    }\r\n    update(_entities, delta) {\r\n        for (const actions of this._actions) {\r\n            actions.update(delta);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./TileMap/IsometricEntityComponent.ts\n\r\nclass IsometricEntityComponent extends Component {\r\n    /**\r\n     * Specify the isometric map to use to position this entity's z-index\r\n     * @param map\r\n     */\r\n    constructor(map) {\r\n        super();\r\n        this.type = 'ex.isometricentity';\r\n        /**\r\n         * Vertical \"height\" in the isometric world\r\n         */\r\n        this.elevation = 0;\r\n        this.map = map;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./TileMap/IsometricEntitySystem.ts\n\r\n\r\n\r\nclass IsometricEntitySystem extends System {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.types = ['ex.transform', 'ex.isometricentity'];\r\n        this.systemType = SystemType.Update;\r\n        this.priority = 99;\r\n    }\r\n    update(entities, _delta) {\r\n        let transform;\r\n        let iso;\r\n        for (const entity of entities) {\r\n            transform = entity.get(TransformComponent);\r\n            iso = entity.get(IsometricEntityComponent);\r\n            const maxZindexPerElevation = Math.max(iso.map.columns * iso.map.tileWidth, iso.map.rows * iso.map.tileHeight);\r\n            const newZ = maxZindexPerElevation * iso.elevation + transform.pos.y;\r\n            transform.z = newZ;\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/OffscreenSystem.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass OffscreenSystem extends System {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.types = ['ex.transform', 'ex.graphics'];\r\n        this.systemType = SystemType.Draw;\r\n        this.priority = -1;\r\n    }\r\n    initialize(scene) {\r\n        this._camera = scene.camera;\r\n        this._screen = scene.engine.screen;\r\n    }\r\n    update(entities) {\r\n        this._worldBounds = this._screen.getWorldBounds();\r\n        let transform;\r\n        let graphics;\r\n        let maybeParallax;\r\n        for (const entity of entities) {\r\n            graphics = entity.get(GraphicsComponent);\r\n            transform = entity.get(TransformComponent);\r\n            maybeParallax = entity.get(ParallaxComponent);\r\n            let parallaxOffset;\r\n            if (maybeParallax) {\r\n                // We use the Tiled formula\r\n                // https://doc.mapeditor.org/en/latest/manual/layers/#parallax-scrolling-factor\r\n                // cameraPos * (1 - parallaxFactor)\r\n                const oneMinusFactor = Vector.One.sub(maybeParallax.parallaxFactor);\r\n                parallaxOffset = this._camera.pos.scale(oneMinusFactor);\r\n            }\r\n            // Figure out if entities are offscreen\r\n            const entityOffscreen = this._isOffscreen(transform, graphics, parallaxOffset);\r\n            if (entityOffscreen && !entity.hasTag('ex.offscreen')) {\r\n                entity.events.emit('exitviewport', new ExitViewPortEvent(entity));\r\n                entity.addTag('ex.offscreen');\r\n            }\r\n            if (!entityOffscreen && entity.hasTag('ex.offscreen')) {\r\n                entity.events.emit('enterviewport', new EnterViewPortEvent(entity));\r\n                entity.removeTag('ex.offscreen');\r\n            }\r\n        }\r\n    }\r\n    _isOffscreen(transform, graphics, parallaxOffset) {\r\n        if (transform.coordPlane === CoordPlane.World) {\r\n            let bounds = graphics.localBounds;\r\n            if (parallaxOffset) {\r\n                bounds = bounds.translate(parallaxOffset);\r\n            }\r\n            const transformedBounds = bounds.transform(transform.get().matrix);\r\n            const graphicsOffscreen = !this._worldBounds.overlaps(transformedBounds);\r\n            return graphicsOffscreen;\r\n        }\r\n        else {\r\n            // TODO screen coordinates\r\n            return false;\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Collision/PhysicsWorld.ts\n\r\nclass PhysicsWorld {\r\n    constructor() {\r\n        this.collisionProcessor = new DynamicTreeCollisionProcessor();\r\n    }\r\n    rayCast(ray, options) {\r\n        return this.collisionProcessor.rayCast(ray, options);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Scene.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst SceneEvents = {\r\n    Initialize: 'initialize',\r\n    Activate: 'activate',\r\n    Deactivate: 'deactivate',\r\n    PreUpdate: 'preupdate',\r\n    PostUpdate: 'postupdate',\r\n    PreDraw: 'predraw',\r\n    PostDraw: 'postdraw',\r\n    PreDebugDraw: 'predebugdraw',\r\n    PostDebugDraw: 'postdebugdraw'\r\n};\r\n/**\r\n * [[Actor|Actors]] are composed together into groupings called Scenes in\r\n * Excalibur. The metaphor models the same idea behind real world\r\n * actors in a scene. Only actors in scenes will be updated and drawn.\r\n *\r\n * Typical usages of a scene include: levels, menus, loading screens, etc.\r\n */\r\nclass Scene {\r\n    /**\r\n     * The actors in the current scene\r\n     */\r\n    get actors() {\r\n        return this.world.entityManager.entities.filter((e) => {\r\n            return e instanceof Actor;\r\n        });\r\n    }\r\n    /**\r\n     * The entities in the current scene\r\n     */\r\n    get entities() {\r\n        return this.world.entityManager.entities;\r\n    }\r\n    /**\r\n     * The triggers in the current scene\r\n     */\r\n    get triggers() {\r\n        return this.world.entityManager.entities.filter((e) => {\r\n            return e instanceof Trigger;\r\n        });\r\n    }\r\n    /**\r\n     * The [[TileMap]]s in the scene, if any\r\n     */\r\n    get tileMaps() {\r\n        return this.world.entityManager.entities.filter((e) => {\r\n            return e instanceof TileMap;\r\n        });\r\n    }\r\n    get timers() {\r\n        return this._timers;\r\n    }\r\n    constructor() {\r\n        // Initialize systems\r\n        this._logger = Logger.getInstance();\r\n        this.events = new EventEmitter();\r\n        /**\r\n         * Gets or sets the current camera for the scene\r\n         */\r\n        this.camera = new Camera();\r\n        /**\r\n         * The ECS world for the scene\r\n         */\r\n        this.world = new World(this);\r\n        /**\r\n         * The Excalibur physics world for the scene. Used to interact\r\n         * with colliders included in the scene.\r\n         *\r\n         * Can be used to perform scene ray casts, track colliders, broadphase, and narrowphase.\r\n         */\r\n        this.physics = new PhysicsWorld();\r\n        this._isInitialized = false;\r\n        this._timers = [];\r\n        this._cancelQueue = [];\r\n        // Update\r\n        this.world.add(new ActionsSystem());\r\n        this.world.add(new MotionSystem());\r\n        this.world.add(new CollisionSystem(this.physics));\r\n        this.world.add(new PointerSystem());\r\n        this.world.add(new IsometricEntitySystem());\r\n        // Draw\r\n        this.world.add(new OffscreenSystem());\r\n        this.world.add(new GraphicsSystem());\r\n        this.world.add(new DebugSystem());\r\n    }\r\n    emit(eventName, event) {\r\n        this.events.emit(eventName, event);\r\n    }\r\n    on(eventName, handler) {\r\n        return this.events.on(eventName, handler);\r\n    }\r\n    once(eventName, handler) {\r\n        return this.events.once(eventName, handler);\r\n    }\r\n    off(eventName, handler) {\r\n        this.events.off(eventName, handler);\r\n    }\r\n    /**\r\n     * This is called before the first update of the [[Scene]]. Initializes scene members like the camera. This method is meant to be\r\n     * overridden. This is where initialization of child actors should take place.\r\n     */\r\n    onInitialize(_engine) {\r\n        // will be overridden\r\n    }\r\n    /**\r\n     * This is called when the scene is made active and started. It is meant to be overridden,\r\n     * this is where you should setup any DOM UI or event handlers needed for the scene.\r\n     */\r\n    onActivate(_context) {\r\n        // will be overridden\r\n    }\r\n    /**\r\n     * This is called when the scene is made transitioned away from and stopped. It is meant to be overridden,\r\n     * this is where you should cleanup any DOM UI or event handlers needed for the scene.\r\n     */\r\n    onDeactivate(_context) {\r\n        // will be overridden\r\n    }\r\n    /**\r\n     * Safe to override onPreUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPreUpdate` is called directly before a scene is updated.\r\n     */\r\n    onPreUpdate(_engine, _delta) {\r\n        // will be overridden\r\n    }\r\n    /**\r\n     * Safe to override onPostUpdate lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPostUpdate` is called directly after a scene is updated.\r\n     */\r\n    onPostUpdate(_engine, _delta) {\r\n        // will be overridden\r\n    }\r\n    /**\r\n     * Safe to override onPreDraw lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPreDraw` is called directly before a scene is drawn.\r\n     *\r\n     */\r\n    onPreDraw(_ctx, _delta) {\r\n        // will be overridden\r\n    }\r\n    /**\r\n     * Safe to override onPostDraw lifecycle event handler. Synonymous with `.on('preupdate', (evt) =>{...})`\r\n     *\r\n     * `onPostDraw` is called directly after a scene is drawn.\r\n     *\r\n     */\r\n    onPostDraw(_ctx, _delta) {\r\n        // will be overridden\r\n    }\r\n    /**\r\n     * Initializes actors in the scene\r\n     */\r\n    _initializeChildren() {\r\n        for (const child of this.entities) {\r\n            child._initialize(this.engine);\r\n        }\r\n    }\r\n    /**\r\n     * Gets whether or not the [[Scene]] has been initialized\r\n     */\r\n    get isInitialized() {\r\n        return this._isInitialized;\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Initializes the scene before the first update, meant to be called by engine not by users of\r\n     * Excalibur\r\n     * @internal\r\n     */\r\n    _initialize(engine) {\r\n        if (!this.isInitialized) {\r\n            this.engine = engine;\r\n            // Initialize camera first\r\n            this.camera._initialize(engine);\r\n            this.world.systemManager.initialize();\r\n            // This order is important! we want to be sure any custom init that add actors\r\n            // fire before the actor init\r\n            this.onInitialize.call(this, engine);\r\n            this._initializeChildren();\r\n            this._logger.debug('Scene.onInitialize', this, engine);\r\n            this.events.emit('initialize', new InitializeEvent(engine, this));\r\n            this._isInitialized = true;\r\n        }\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Activates the scene with the base behavior, then calls the overridable `onActivate` implementation.\r\n     * @internal\r\n     */\r\n    _activate(context) {\r\n        this._logger.debug('Scene.onActivate', this);\r\n        this.onActivate(context);\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Deactivates the scene with the base behavior, then calls the overridable `onDeactivate` implementation.\r\n     * @internal\r\n     */\r\n    _deactivate(context) {\r\n        this._logger.debug('Scene.onDeactivate', this);\r\n        this.onDeactivate(context);\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPreUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _preupdate(_engine, delta) {\r\n        this.emit('preupdate', new PreUpdateEvent(_engine, delta, this));\r\n        this.onPreUpdate(_engine, delta);\r\n    }\r\n    /**\r\n     *  It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _preupdate handler for [[onPostUpdate]] lifecycle event\r\n     * @internal\r\n     */\r\n    _postupdate(_engine, delta) {\r\n        this.emit('postupdate', new PostUpdateEvent(_engine, delta, this));\r\n        this.onPostUpdate(_engine, delta);\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _predraw handler for [[onPreDraw]] lifecycle event\r\n     *\r\n     * @internal\r\n     */\r\n    _predraw(_ctx, _delta) {\r\n        this.emit('predraw', new PreDrawEvent(_ctx, _delta, this));\r\n        this.onPreDraw(_ctx, _delta);\r\n    }\r\n    /**\r\n     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.\r\n     *\r\n     * Internal _postdraw handler for [[onPostDraw]] lifecycle event\r\n     *\r\n     * @internal\r\n     */\r\n    _postdraw(_ctx, _delta) {\r\n        this.emit('postdraw', new PostDrawEvent(_ctx, _delta, this));\r\n        this.onPostDraw(_ctx, _delta);\r\n    }\r\n    /**\r\n     * Updates all the actors and timers in the scene. Called by the [[Engine]].\r\n     * @param engine  Reference to the current Engine\r\n     * @param delta   The number of milliseconds since the last update\r\n     */\r\n    update(engine, delta) {\r\n        this._preupdate(engine, delta);\r\n        // TODO differed entity removal for timers\r\n        let i, len;\r\n        // Remove timers in the cancel queue before updating them\r\n        for (i = 0, len = this._cancelQueue.length; i < len; i++) {\r\n            this.removeTimer(this._cancelQueue[i]);\r\n        }\r\n        this._cancelQueue.length = 0;\r\n        // Cycle through timers updating timers\r\n        for (const timer of this._timers) {\r\n            timer.update(delta);\r\n        }\r\n        this.world.update(SystemType.Update, delta);\r\n        // Camera last keeps renders smooth that are based on entity/actor\r\n        if (this.camera) {\r\n            this.camera.update(engine, delta);\r\n        }\r\n        this._collectActorStats(engine);\r\n        this._postupdate(engine, delta);\r\n    }\r\n    /**\r\n     * Draws all the actors in the Scene. Called by the [[Engine]].\r\n     *\r\n     * @param ctx    The current rendering context\r\n     * @param delta  The number of milliseconds since the last draw\r\n     */\r\n    draw(ctx, delta) {\r\n        var _a;\r\n        this._predraw(ctx, delta);\r\n        this.world.update(SystemType.Draw, delta);\r\n        if ((_a = this.engine) === null || _a === void 0 ? void 0 : _a.isDebug) {\r\n            this.debugDraw(ctx);\r\n        }\r\n        this._postdraw(ctx, delta);\r\n    }\r\n    /**\r\n     * Draws all the actors' debug information in the Scene. Called by the [[Engine]].\r\n     * @param ctx  The current rendering context\r\n     */\r\n    /* istanbul ignore next */\r\n    debugDraw(ctx) {\r\n        this.emit('predebugdraw', new PreDebugDrawEvent(ctx, this));\r\n        // pass\r\n        this.emit('postdebugdraw', new PostDebugDrawEvent(ctx, this));\r\n    }\r\n    /**\r\n     * Checks whether an actor is contained in this scene or not\r\n     */\r\n    contains(actor) {\r\n        return this.actors.indexOf(actor) > -1;\r\n    }\r\n    add(entity) {\r\n        this.emit('entityadded', { target: entity });\r\n        this.world.add(entity);\r\n        entity.scene = this;\r\n        if (entity instanceof Timer) {\r\n            if (!contains(this._timers, entity)) {\r\n                this.addTimer(entity);\r\n            }\r\n            return;\r\n        }\r\n    }\r\n    /**\r\n     * Removes an [[Entity]] (Actor, TileMap, Trigger, etc) or [[Timer]] from it's current scene\r\n     * and adds it to this scene.\r\n     *\r\n     * Useful if you want to have an object be present in only 1 scene at a time.\r\n     * @param entity\r\n     */\r\n    transfer(entity) {\r\n        let scene;\r\n        if (entity instanceof Entity && entity.scene && entity.scene !== this) {\r\n            scene = entity.scene;\r\n            entity.scene.world.remove(entity, false);\r\n        }\r\n        if (entity instanceof Timer && entity.scene) {\r\n            scene = entity.scene;\r\n            entity.scene.removeTimer(entity);\r\n        }\r\n        scene === null || scene === void 0 ? void 0 : scene.emit('entityremoved', { target: entity });\r\n        this.add(entity);\r\n    }\r\n    remove(entity) {\r\n        if (entity instanceof Entity) {\r\n            this.emit('entityremoved', { target: entity });\r\n            if (entity.active) {\r\n                entity.kill();\r\n            }\r\n            this.world.remove(entity);\r\n        }\r\n        if (entity instanceof Timer) {\r\n            this.removeTimer(entity);\r\n        }\r\n    }\r\n    /**\r\n     * Removes all entities and timers from the scene, optionally indicate whether deferred should or shouldn't be used.\r\n     *\r\n     * By default entities use deferred removal\r\n     * @param deferred\r\n     */\r\n    clear(deferred = true) {\r\n        for (const entity of this.entities) {\r\n            this.world.remove(entity, deferred);\r\n        }\r\n        for (const timer of this.timers) {\r\n            this.removeTimer(timer);\r\n        }\r\n    }\r\n    /**\r\n     * Adds a [[Timer]] to the scene\r\n     * @param timer  The timer to add\r\n     */\r\n    addTimer(timer) {\r\n        this._timers.push(timer);\r\n        timer.scene = this;\r\n        return timer;\r\n    }\r\n    /**\r\n     * Removes a [[Timer]] from the scene.\r\n     * @warning Can be dangerous, use [[cancelTimer]] instead\r\n     * @param timer  The timer to remove\r\n     */\r\n    removeTimer(timer) {\r\n        const i = this._timers.indexOf(timer);\r\n        if (i !== -1) {\r\n            this._timers.splice(i, 1);\r\n        }\r\n        return timer;\r\n    }\r\n    /**\r\n     * Cancels a [[Timer]], removing it from the scene nicely\r\n     * @param timer  The timer to cancel\r\n     */\r\n    cancelTimer(timer) {\r\n        this._cancelQueue.push(timer);\r\n        return timer;\r\n    }\r\n    /**\r\n     * Tests whether a [[Timer]] is active in the scene\r\n     */\r\n    isTimerActive(timer) {\r\n        return this._timers.indexOf(timer) > -1 && !timer.complete;\r\n    }\r\n    isCurrentScene() {\r\n        if (this.engine) {\r\n            return this.engine.currentScene === this;\r\n        }\r\n        return false;\r\n    }\r\n    _collectActorStats(engine) {\r\n        const screenElements = this.actors.filter((a) => a instanceof ScreenElement);\r\n        for (const _ui of screenElements) {\r\n            engine.stats.currFrame.actors.ui++;\r\n        }\r\n        for (const actor of this.actors) {\r\n            engine.stats.currFrame.actors.alive++;\r\n            for (const child of actor.children) {\r\n                if (isScreenElement(child)) {\r\n                    // TODO not true\r\n                    engine.stats.currFrame.actors.ui++;\r\n                }\r\n                else {\r\n                    engine.stats.currFrame.actors.alive++;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/PostProcessor/ColorBlindnessMode.ts\nvar ColorBlindnessMode;\r\n(function (ColorBlindnessMode) {\r\n    ColorBlindnessMode[\"Protanope\"] = \"Protanope\";\r\n    ColorBlindnessMode[\"Deuteranope\"] = \"Deuteranope\";\r\n    ColorBlindnessMode[\"Tritanope\"] = \"Tritanope\";\r\n})(ColorBlindnessMode || (ColorBlindnessMode = {}));\r\n\n;// CONCATENATED MODULE: ./Graphics/PostProcessor/color-blind-fragment.glsl\n/* harmony default export */ const color_blind_fragment = (\"#version 300 es\\r\\nprecision mediump float;\\r\\n// our texture\\r\\nuniform sampler2D u_image;\\r\\n// the texCoords passed in from the vertex shader.\\r\\nin vec2 v_texcoord;\\r\\n\\r\\n// color blind type\\r\\nuniform int u_type;\\r\\n\\r\\n// simulation?\\r\\nuniform bool u_simulate;\\r\\n\\r\\nout vec4 fragColor;\\r\\n\\r\\nvoid main() {\\r\\n  vec4 o =  texture(u_image, v_texcoord);\\r\\n  // RGB to LMS matrix conversion\\r\\n  float L = (17.8824 * o.r) + (43.5161 * o.g) + (4.11935 * o.b);\\r\\n  float M = (3.45565 * o.r) + (27.1554 * o.g) + (3.86714 * o.b);\\r\\n  float S = (0.0299566 * o.r) + (0.184309 * o.g) + (1.46709 * o.b);\\r\\n  // Simulate color blindness\\r\\n  float l;\\r\\n  float m;\\r\\n  float s;\\r\\n  //MODE CODE//\\r\\n  if (u_type == 0) {\\r\\n    // Protanope\\r\\n    l = 0.0 * L + 2.02344 * M + -2.52581 * S;\\r\\n    m = 0.0 * L + 1.0 * M + 0.0 * S;\\r\\n    s = 0.0 * L + 0.0 * M + 1.0 * S;;\\r\\n  } else if (u_type == 1) {\\r\\n    // Deuteranope\\r\\n    l = 1.0 * L + 0.0 * M + 0.0 * S;\\r\\n    m = 0.494207 * L + 0.0 * M + 1.24827 * S;\\r\\n    s = 0.0 * L + 0.0 * M + 1.0 * S;\\r\\n  } else if (u_type == 2) {\\r\\n    // Tritanope\\r\\n    l = 1.0 * L + 0.0 * M + 0.0 * S;\\r\\n    m = 0.0 * L + 1.0 * M + 0.0 * S;\\r\\n    s = -0.395913 * L + 0.801109 * M + 0.0 * S;\\r\\n  }\\r\\n\\r\\n  // LMS to RGB matrix conversion\\r\\n  vec4 error; // simulate the colors\\r\\n  error.r = (0.0809444479 * l) + (-0.130504409 * m) + (0.116721066 * s);\\r\\n  error.g = (-0.0102485335 * l) + (0.0540193266 * m) + (-0.113614708 * s);\\r\\n  error.b = (-0.000365296938 * l) + (-0.00412161469 * m) + (0.693511405 * s);\\r\\n  error.a = 1.0;\\r\\n  vec4 diff = o - error;\\r\\n  vec4 correction; // correct the colors\\r\\n  correction.r = 0.0;\\r\\n  correction.g =  (diff.r * 0.7) + (diff.g * 1.0);\\r\\n  correction.b =  (diff.r * 0.7) + (diff.b * 1.0);\\r\\n  correction = o + correction;\\r\\n  correction.a = o.a;\\r\\n  //SIMULATE//\\r\\n\\r\\n  // sim \\r\\n  if (u_simulate) {\\r\\n    fragColor = error.rgba;\\r\\n  } else {\\r\\n    fragColor = correction.rgba;\\r\\n  }\\r\\n}\");\n;// CONCATENATED MODULE: ./Graphics/PostProcessor/ScreenShader.ts\n\r\n\r\n\r\n/**\r\n * Helper that defines a whole screen renderer, just provide a fragment source!\r\n *\r\n * Currently supports 1 varying\r\n * - vec2 a_texcoord between 0-1 which corresponds to screen position\r\n */\r\nclass ScreenShader {\r\n    constructor(gl, fragmentSource) {\r\n        this._shader = new Shader({\r\n            gl,\r\n            vertexSource: `#version 300 es\r\n      in vec2 a_position;\r\n      in vec2 a_texcoord;\r\n      out vec2 v_texcoord;\r\n\r\n      void main() {\r\n        gl_Position = vec4(a_position, 0.0, 1.0);\r\n        // Pass the texcoord to the fragment shader.\r\n        v_texcoord = a_texcoord;\r\n      }`,\r\n            fragmentSource: fragmentSource\r\n        });\r\n        this._shader.compile();\r\n        // Setup memory layout\r\n        this._buffer = new VertexBuffer({\r\n            gl,\r\n            type: 'static',\r\n            // clip space quad + uv since we don't need a camera\r\n            data: new Float32Array([\r\n                -1, -1, 0, 0,\r\n                -1, 1, 0, 1,\r\n                1, -1, 1, 0,\r\n                1, -1, 1, 0,\r\n                -1, 1, 0, 1,\r\n                1, 1, 1, 1\r\n            ])\r\n        });\r\n        this._layout = new VertexLayout({\r\n            gl,\r\n            shader: this._shader,\r\n            vertexBuffer: this._buffer,\r\n            attributes: [\r\n                ['a_position', 2],\r\n                ['a_texcoord', 2]\r\n            ]\r\n        });\r\n        this._buffer.upload();\r\n    }\r\n    getShader() {\r\n        return this._shader;\r\n    }\r\n    getLayout() {\r\n        return this._layout;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/PostProcessor/ColorBlindnessPostProcessor.ts\n\r\n\r\n\r\nclass ColorBlindnessPostProcessor {\r\n    constructor(_colorBlindnessMode, simulate = false) {\r\n        this._colorBlindnessMode = _colorBlindnessMode;\r\n        this._simulate = false;\r\n        this._simulate = simulate;\r\n    }\r\n    initialize(gl) {\r\n        this._shader = new ScreenShader(gl, color_blind_fragment);\r\n        this.simulate = this._simulate;\r\n        this.colorBlindnessMode = this._colorBlindnessMode;\r\n    }\r\n    getShader() {\r\n        return this._shader.getShader();\r\n    }\r\n    getLayout() {\r\n        return this._shader.getLayout();\r\n    }\r\n    set colorBlindnessMode(colorBlindMode) {\r\n        this._colorBlindnessMode = colorBlindMode;\r\n        if (this._shader) {\r\n            const shader = this._shader.getShader();\r\n            shader.use();\r\n            if (this._colorBlindnessMode === ColorBlindnessMode.Protanope) {\r\n                shader.setUniformInt('u_type', 0);\r\n            }\r\n            else if (this._colorBlindnessMode === ColorBlindnessMode.Deuteranope) {\r\n                shader.setUniformInt('u_type', 1);\r\n            }\r\n            else if (this._colorBlindnessMode === ColorBlindnessMode.Tritanope) {\r\n                shader.setUniformInt('u_type', 2);\r\n            }\r\n        }\r\n    }\r\n    get colorBlindnessMode() {\r\n        return this._colorBlindnessMode;\r\n    }\r\n    set simulate(value) {\r\n        this._simulate = value;\r\n        if (this._shader) {\r\n            const shader = this._shader.getShader();\r\n            shader.use();\r\n            shader.setUniformBoolean('u_simulate', value);\r\n        }\r\n    }\r\n    get simulate() {\r\n        return this._simulate;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Debug/DebugFlags.ts\n\r\n\r\n\r\nclass ColorBlindFlags {\r\n    constructor(engine) {\r\n        this._engine = engine;\r\n        this._colorBlindPostProcessor = new ColorBlindnessPostProcessor(ColorBlindnessMode.Protanope);\r\n    }\r\n    /**\r\n     * Correct colors for a specified color blindness\r\n     * @param colorBlindness\r\n     */\r\n    correct(colorBlindness) {\r\n        if (this._engine.graphicsContext instanceof ExcaliburGraphicsContextWebGL) {\r\n            this.clear();\r\n            this._colorBlindPostProcessor.colorBlindnessMode = colorBlindness;\r\n            this._colorBlindPostProcessor.simulate = false;\r\n            this._engine.graphicsContext.addPostProcessor(this._colorBlindPostProcessor);\r\n        }\r\n    }\r\n    /**\r\n     * Simulate colors for a specified color blindness\r\n     * @param colorBlindness\r\n     */\r\n    simulate(colorBlindness) {\r\n        if (this._engine.graphicsContext instanceof ExcaliburGraphicsContextWebGL) {\r\n            this.clear();\r\n            this._colorBlindPostProcessor.colorBlindnessMode = colorBlindness;\r\n            this._colorBlindPostProcessor.simulate = true;\r\n            this._engine.graphicsContext.addPostProcessor(this._colorBlindPostProcessor);\r\n        }\r\n    }\r\n    /**\r\n     * Remove color blindness post processor\r\n     */\r\n    clear() {\r\n        this._engine.graphicsContext.removePostProcessor(this._colorBlindPostProcessor);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Debug/Debug.ts\n\r\n\r\n/**\r\n * Debug statistics and flags for Excalibur. If polling these values, it would be\r\n * best to do so on the `postupdate` event for [[Engine]], after all values have been\r\n * updated during a frame.\r\n */\r\nclass Debug {\r\n    constructor(engine) {\r\n        /**\r\n         * Performance statistics\r\n         */\r\n        this.stats = {\r\n            /**\r\n             * Current frame statistics. Engine reuses this instance, use [[FrameStats.clone]] to copy frame stats.\r\n             * Best accessed on [[postframe]] event. See [[FrameStats]]\r\n             */\r\n            currFrame: new FrameStats(),\r\n            /**\r\n             * Previous frame statistics. Engine reuses this instance, use [[FrameStats.clone]] to copy frame stats.\r\n             * Best accessed on [[preframe]] event. Best inspected on engine event `preframe`. See [[FrameStats]]\r\n             */\r\n            prevFrame: new FrameStats()\r\n        };\r\n        /**\r\n         * Filter debug context to named entities or entity ids\r\n         */\r\n        this.filter = {\r\n            /**\r\n             * Toggle filter on or off (default off) must be on for DebugDraw to use filters\r\n             */\r\n            useFilter: false,\r\n            /**\r\n             * Query for entities by name, if the entity name contains `nameQuery` it will be included\r\n             */\r\n            nameQuery: '',\r\n            /**\r\n             * Query for Entity ids, if the id matches it will be included\r\n             */\r\n            ids: []\r\n        };\r\n        /**\r\n         * Entity debug settings\r\n         */\r\n        this.entity = {\r\n            showAll: false,\r\n            showId: true,\r\n            showName: false\r\n        };\r\n        /**\r\n         * Transform component debug settings\r\n         */\r\n        this.transform = {\r\n            showAll: false,\r\n            showPosition: false,\r\n            showPositionLabel: false,\r\n            positionColor: Color.Yellow,\r\n            showZIndex: false,\r\n            showScale: false,\r\n            scaleColor: Color.Green,\r\n            showRotation: false,\r\n            rotationColor: Color.Blue\r\n        };\r\n        /**\r\n         * Graphics component debug settings\r\n         */\r\n        this.graphics = {\r\n            showAll: false,\r\n            showBounds: true,\r\n            boundsColor: Color.Yellow\r\n        };\r\n        /**\r\n         * Collider component debug settings\r\n         */\r\n        this.collider = {\r\n            showAll: false,\r\n            showBounds: true,\r\n            boundsColor: Color.Blue,\r\n            showOwner: false,\r\n            showGeometry: true,\r\n            geometryColor: Color.Green\r\n        };\r\n        /**\r\n         * Physics simulation debug settings\r\n         */\r\n        this.physics = {\r\n            showAll: false,\r\n            showBroadphaseSpacePartitionDebug: false,\r\n            showCollisionNormals: false,\r\n            collisionNormalColor: Color.Cyan,\r\n            showCollisionContacts: true,\r\n            collisionContactColor: Color.Red\r\n        };\r\n        /**\r\n         * Motion component debug settings\r\n         */\r\n        this.motion = {\r\n            showAll: false,\r\n            showVelocity: false,\r\n            velocityColor: Color.Yellow,\r\n            showAcceleration: false,\r\n            accelerationColor: Color.Red\r\n        };\r\n        /**\r\n         * Body component debug settings\r\n         */\r\n        this.body = {\r\n            showAll: false,\r\n            showCollisionGroup: false,\r\n            showCollisionType: false,\r\n            showSleeping: false,\r\n            showMotion: false,\r\n            showMass: false\r\n        };\r\n        /**\r\n         * Camera debug settings\r\n         */\r\n        this.camera = {\r\n            showAll: false,\r\n            showFocus: false,\r\n            focusColor: Color.Red,\r\n            showZoom: false\r\n        };\r\n        this._engine = engine;\r\n        this.colorBlindMode = new ColorBlindFlags(this._engine);\r\n    }\r\n    /**\r\n     * Switch the current excalibur clock with the [[TestClock]] and return\r\n     * it in the same running state.\r\n     *\r\n     * This is useful when you need to debug frame by frame.\r\n     */\r\n    useTestClock() {\r\n        const clock = this._engine.clock;\r\n        const wasRunning = clock.isRunning();\r\n        clock.stop();\r\n        const testClock = clock.toTestClock();\r\n        if (wasRunning) {\r\n            testClock.start();\r\n        }\r\n        this._engine.clock = testClock;\r\n        return testClock;\r\n    }\r\n    /**\r\n     * Switch the current excalibur clock with the [[StandardClock]] and\r\n     * return it in the same running state.\r\n     *\r\n     * This is useful when you need to switch back to normal mode after\r\n     * debugging.\r\n     */\r\n    useStandardClock() {\r\n        const currentClock = this._engine.clock;\r\n        const wasRunning = currentClock.isRunning();\r\n        currentClock.stop();\r\n        const standardClock = currentClock.toStandardClock();\r\n        if (wasRunning) {\r\n            standardClock.start();\r\n        }\r\n        this._engine.clock = standardClock;\r\n        return standardClock;\r\n    }\r\n}\r\n/**\r\n * Implementation of a frame's stats. Meant to have values copied via [[FrameStats.reset]], avoid\r\n * creating instances of this every frame.\r\n */\r\nclass FrameStats {\r\n    constructor() {\r\n        this._id = 0;\r\n        this._delta = 0;\r\n        this._fps = 0;\r\n        this._actorStats = {\r\n            alive: 0,\r\n            killed: 0,\r\n            ui: 0,\r\n            get remaining() {\r\n                return this.alive - this.killed;\r\n            },\r\n            get total() {\r\n                return this.remaining + this.ui;\r\n            }\r\n        };\r\n        this._durationStats = {\r\n            update: 0,\r\n            draw: 0,\r\n            get total() {\r\n                return this.update + this.draw;\r\n            }\r\n        };\r\n        this._physicsStats = new PhysicsStats();\r\n        this._graphicsStats = {\r\n            drawCalls: 0,\r\n            drawnImages: 0\r\n        };\r\n    }\r\n    /**\r\n     * Zero out values or clone other IFrameStat stats. Allows instance reuse.\r\n     *\r\n     * @param [otherStats] Optional stats to clone\r\n     */\r\n    reset(otherStats) {\r\n        if (otherStats) {\r\n            this.id = otherStats.id;\r\n            this.delta = otherStats.delta;\r\n            this.fps = otherStats.fps;\r\n            this.actors.alive = otherStats.actors.alive;\r\n            this.actors.killed = otherStats.actors.killed;\r\n            this.actors.ui = otherStats.actors.ui;\r\n            this.duration.update = otherStats.duration.update;\r\n            this.duration.draw = otherStats.duration.draw;\r\n            this._physicsStats.reset(otherStats.physics);\r\n            this.graphics.drawCalls = otherStats.graphics.drawCalls;\r\n            this.graphics.drawnImages = otherStats.graphics.drawnImages;\r\n        }\r\n        else {\r\n            this.id = this.delta = this.fps = 0;\r\n            this.actors.alive = this.actors.killed = this.actors.ui = 0;\r\n            this.duration.update = this.duration.draw = 0;\r\n            this._physicsStats.reset();\r\n            this.graphics.drawnImages = this.graphics.drawCalls = 0;\r\n        }\r\n    }\r\n    /**\r\n     * Provides a clone of this instance.\r\n     */\r\n    clone() {\r\n        const fs = new FrameStats();\r\n        fs.reset(this);\r\n        return fs;\r\n    }\r\n    /**\r\n     * Gets the frame's id\r\n     */\r\n    get id() {\r\n        return this._id;\r\n    }\r\n    /**\r\n     * Sets the frame's id\r\n     */\r\n    set id(value) {\r\n        this._id = value;\r\n    }\r\n    /**\r\n     * Gets the frame's delta (time since last frame)\r\n     */\r\n    get delta() {\r\n        return this._delta;\r\n    }\r\n    /**\r\n     * Sets the frame's delta (time since last frame). Internal use only.\r\n     * @internal\r\n     */\r\n    set delta(value) {\r\n        this._delta = value;\r\n    }\r\n    /**\r\n     * Gets the frame's frames-per-second (FPS)\r\n     */\r\n    get fps() {\r\n        return this._fps;\r\n    }\r\n    /**\r\n     * Sets the frame's frames-per-second (FPS). Internal use only.\r\n     * @internal\r\n     */\r\n    set fps(value) {\r\n        this._fps = value;\r\n    }\r\n    /**\r\n     * Gets the frame's actor statistics\r\n     */\r\n    get actors() {\r\n        return this._actorStats;\r\n    }\r\n    /**\r\n     * Gets the frame's duration statistics\r\n     */\r\n    get duration() {\r\n        return this._durationStats;\r\n    }\r\n    /**\r\n     * Gets the frame's physics statistics\r\n     */\r\n    get physics() {\r\n        return this._physicsStats;\r\n    }\r\n    /**\r\n     * Gets the frame's graphics statistics\r\n     */\r\n    get graphics() {\r\n        return this._graphicsStats;\r\n    }\r\n}\r\nclass PhysicsStats {\r\n    constructor() {\r\n        this._pairs = 0;\r\n        this._collisions = 0;\r\n        this._contacts = new Map();\r\n        this._fastBodies = 0;\r\n        this._fastBodyCollisions = 0;\r\n        this._broadphase = 0;\r\n        this._narrowphase = 0;\r\n    }\r\n    /**\r\n     * Zero out values or clone other IPhysicsStats stats. Allows instance reuse.\r\n     *\r\n     * @param [otherStats] Optional stats to clone\r\n     */\r\n    reset(otherStats) {\r\n        if (otherStats) {\r\n            this.pairs = otherStats.pairs;\r\n            this.collisions = otherStats.collisions;\r\n            this.contacts = otherStats.contacts;\r\n            this.fastBodies = otherStats.fastBodies;\r\n            this.fastBodyCollisions = otherStats.fastBodyCollisions;\r\n            this.broadphase = otherStats.broadphase;\r\n            this.narrowphase = otherStats.narrowphase;\r\n        }\r\n        else {\r\n            this.pairs = this.collisions = this.fastBodies = 0;\r\n            this.fastBodyCollisions = this.broadphase = this.narrowphase = 0;\r\n            this.contacts.clear();\r\n        }\r\n    }\r\n    /**\r\n     * Provides a clone of this instance.\r\n     */\r\n    clone() {\r\n        const ps = new PhysicsStats();\r\n        ps.reset(this);\r\n        return ps;\r\n    }\r\n    get pairs() {\r\n        return this._pairs;\r\n    }\r\n    set pairs(value) {\r\n        this._pairs = value;\r\n    }\r\n    get collisions() {\r\n        return this._collisions;\r\n    }\r\n    set collisions(value) {\r\n        this._collisions = value;\r\n    }\r\n    get contacts() {\r\n        return this._contacts;\r\n    }\r\n    set contacts(contacts) {\r\n        this._contacts = contacts;\r\n    }\r\n    get fastBodies() {\r\n        return this._fastBodies;\r\n    }\r\n    set fastBodies(value) {\r\n        this._fastBodies = value;\r\n    }\r\n    get fastBodyCollisions() {\r\n        return this._fastBodyCollisions;\r\n    }\r\n    set fastBodyCollisions(value) {\r\n        this._fastBodyCollisions = value;\r\n    }\r\n    get broadphase() {\r\n        return this._broadphase;\r\n    }\r\n    set broadphase(value) {\r\n        this._broadphase = value;\r\n    }\r\n    get narrowphase() {\r\n        return this._narrowphase;\r\n    }\r\n    set narrowphase(value) {\r\n        this._narrowphase = value;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Browser.ts\nclass BrowserComponent {\r\n    on(eventName, handler) {\r\n        if (this._nativeHandlers[eventName]) {\r\n            this.off(eventName, this._nativeHandlers[eventName]);\r\n        }\r\n        this._nativeHandlers[eventName] = this._decorate(handler);\r\n        this.nativeComponent.addEventListener(eventName, this._nativeHandlers[eventName]);\r\n    }\r\n    off(eventName, handler) {\r\n        if (!handler) {\r\n            handler = this._nativeHandlers[eventName];\r\n        }\r\n        this.nativeComponent.removeEventListener(eventName, handler);\r\n        this._nativeHandlers[eventName] = null;\r\n    }\r\n    _decorate(handler) {\r\n        return (evt) => {\r\n            if (!this._paused) {\r\n                handler(evt);\r\n            }\r\n        };\r\n    }\r\n    pause() {\r\n        this._paused = true;\r\n    }\r\n    resume() {\r\n        this._paused = false;\r\n    }\r\n    clear() {\r\n        for (const event in this._nativeHandlers) {\r\n            this.off(event);\r\n        }\r\n    }\r\n    constructor(nativeComponent) {\r\n        this.nativeComponent = nativeComponent;\r\n        this._paused = false;\r\n        this._nativeHandlers = {};\r\n    }\r\n}\r\nclass BrowserEvents {\r\n    constructor(_windowGlobal, _documentGlobal) {\r\n        this._windowGlobal = _windowGlobal;\r\n        this._documentGlobal = _documentGlobal;\r\n        this._windowComponent = new BrowserComponent(this._windowGlobal);\r\n        this._documentComponent = new BrowserComponent(this._documentGlobal);\r\n    }\r\n    get window() {\r\n        return this._windowComponent;\r\n    }\r\n    get document() {\r\n        return this._documentComponent;\r\n    }\r\n    pause() {\r\n        this.window.pause();\r\n        this.document.pause();\r\n    }\r\n    resume() {\r\n        this.window.resume();\r\n        this.document.resume();\r\n    }\r\n    clear() {\r\n        this.window.clear();\r\n        this.document.clear();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Math/global-coordinates.ts\n\r\nclass GlobalCoordinates {\r\n    static fromPagePosition(xOrPos, yOrEngine, engineOrUndefined) {\r\n        let pageX;\r\n        let pageY;\r\n        let pagePos;\r\n        let engine;\r\n        if (arguments.length === 3) {\r\n            pageX = xOrPos;\r\n            pageY = yOrEngine;\r\n            pagePos = new Vector(pageX, pageY);\r\n            engine = engineOrUndefined;\r\n        }\r\n        else {\r\n            pagePos = xOrPos;\r\n            pageX = pagePos.x;\r\n            pageY = pagePos.y;\r\n            engine = yOrEngine;\r\n        }\r\n        const screenPos = engine.screen.pageToScreenCoordinates(pagePos);\r\n        const worldPos = engine.screen.screenToWorldCoordinates(screenPos);\r\n        return new GlobalCoordinates(worldPos, pagePos, screenPos);\r\n    }\r\n    constructor(worldPos, pagePos, screenPos) {\r\n        this.worldPos = worldPos;\r\n        this.pagePos = pagePos;\r\n        this.screenPos = screenPos;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Input/PointerEvent.ts\nclass PointerEvent {\r\n    cancel() {\r\n        this.active = false;\r\n    }\r\n    get pagePos() {\r\n        return this.coordinates.pagePos;\r\n    }\r\n    get screenPos() {\r\n        return this.coordinates.screenPos;\r\n    }\r\n    get worldPos() {\r\n        return this.coordinates.worldPos;\r\n    }\r\n    constructor(type, pointerId, button, pointerType, coordinates, nativeEvent) {\r\n        this.type = type;\r\n        this.pointerId = pointerId;\r\n        this.button = button;\r\n        this.pointerType = pointerType;\r\n        this.coordinates = coordinates;\r\n        this.nativeEvent = nativeEvent;\r\n        this.active = true;\r\n    }\r\n    ;\r\n}\r\n\n;// CONCATENATED MODULE: ./Input/WheelEvent.ts\nclass WheelEvent {\r\n    cancel() {\r\n        this.active = false;\r\n    }\r\n    constructor(x, y, pageX, pageY, screenX, screenY, index, deltaX, deltaY, deltaZ, deltaMode, ev) {\r\n        this.x = x;\r\n        this.y = y;\r\n        this.pageX = pageX;\r\n        this.pageY = pageY;\r\n        this.screenX = screenX;\r\n        this.screenY = screenY;\r\n        this.index = index;\r\n        this.deltaX = deltaX;\r\n        this.deltaY = deltaY;\r\n        this.deltaZ = deltaZ;\r\n        this.deltaMode = deltaMode;\r\n        this.ev = ev;\r\n        this.active = true;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Input/PointerAbstraction.ts\n\r\n\r\nclass PointerAbstraction {\r\n    constructor() {\r\n        this.events = new EventEmitter();\r\n        /**\r\n         * The last position on the document this pointer was at. Can be `null` if pointer was never active.\r\n         */\r\n        this.lastPagePos = Vector.Zero;\r\n        /**\r\n         * The last position on the screen this pointer was at. Can be `null` if pointer was never active.\r\n         */\r\n        this.lastScreenPos = Vector.Zero;\r\n        /**\r\n         * The last position in the game world coordinates this pointer was at. Can be `null` if pointer was never active.\r\n         */\r\n        this.lastWorldPos = Vector.Zero;\r\n        this._onPointerMove = (ev) => {\r\n            this.lastPagePos = new Vector(ev.pagePos.x, ev.pagePos.y);\r\n            this.lastScreenPos = new Vector(ev.screenPos.x, ev.screenPos.y);\r\n            this.lastWorldPos = new Vector(ev.worldPos.x, ev.worldPos.y);\r\n        };\r\n        this._onPointerDown = (ev) => {\r\n            this.lastPagePos = new Vector(ev.pagePos.x, ev.pagePos.y);\r\n            this.lastScreenPos = new Vector(ev.screenPos.x, ev.screenPos.y);\r\n            this.lastWorldPos = new Vector(ev.worldPos.x, ev.worldPos.y);\r\n        };\r\n        this.on('move', this._onPointerMove);\r\n        this.on('down', this._onPointerDown);\r\n    }\r\n    emit(eventName, event) {\r\n        this.events.emit(eventName, event);\r\n    }\r\n    on(eventName, handler) {\r\n        return this.events.on(eventName, handler);\r\n    }\r\n    once(eventName, handler) {\r\n        return this.events.once(eventName, handler);\r\n    }\r\n    off(eventName, handler) {\r\n        this.events.off(eventName, handler);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Input/WheelDeltaMode.ts\nvar WheelDeltaMode;\r\n(function (WheelDeltaMode) {\r\n    WheelDeltaMode[\"Pixel\"] = \"Pixel\";\r\n    WheelDeltaMode[\"Line\"] = \"Line\";\r\n    WheelDeltaMode[\"Page\"] = \"Page\";\r\n})(WheelDeltaMode || (WheelDeltaMode = {}));\r\n\n;// CONCATENATED MODULE: ./Input/NativePointerButton.ts\n/**\r\n * Native browser button enumeration\r\n */\r\nvar NativePointerButton;\r\n(function (NativePointerButton) {\r\n    NativePointerButton[NativePointerButton[\"NoButton\"] = -1] = \"NoButton\";\r\n    NativePointerButton[NativePointerButton[\"Left\"] = 0] = \"Left\";\r\n    NativePointerButton[NativePointerButton[\"Middle\"] = 1] = \"Middle\";\r\n    NativePointerButton[NativePointerButton[\"Right\"] = 2] = \"Right\";\r\n    NativePointerButton[NativePointerButton[\"Unknown\"] = 3] = \"Unknown\";\r\n})(NativePointerButton || (NativePointerButton = {}));\r\n\n;// CONCATENATED MODULE: ./Input/PointerButton.ts\n/**\r\n * The mouse button being pressed.\r\n */\r\nvar PointerButton;\r\n(function (PointerButton) {\r\n    PointerButton[\"Left\"] = \"Left\";\r\n    PointerButton[\"Middle\"] = \"Middle\";\r\n    PointerButton[\"Right\"] = \"Right\";\r\n    PointerButton[\"Unknown\"] = \"Unknown\";\r\n    PointerButton[\"NoButton\"] = \"NoButton\";\r\n})(PointerButton || (PointerButton = {}));\r\n\n;// CONCATENATED MODULE: ./Input/PointerType.ts\n/**\r\n * The type of pointer for a [[PointerEvent]].\r\n */\r\nvar PointerType;\r\n(function (PointerType) {\r\n    PointerType[\"Touch\"] = \"Touch\";\r\n    PointerType[\"Mouse\"] = \"Mouse\";\r\n    PointerType[\"Pen\"] = \"Pen\";\r\n    PointerType[\"Unknown\"] = \"Unknown\";\r\n})(PointerType || (PointerType = {}));\r\n\n;// CONCATENATED MODULE: ./Input/PointerEventReceiver.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst PointerEvents = {\r\n    Move: 'move',\r\n    Down: 'down',\r\n    Up: 'up',\r\n    Wheel: 'wheel'\r\n};\r\n/**\r\n * Is this event a native touch event?\r\n */\r\nfunction isTouchEvent(value) {\r\n    // Guard for Safari <= 13.1\r\n    return globalThis.TouchEvent && value instanceof globalThis.TouchEvent;\r\n}\r\n/**\r\n * Is this event a native pointer event\r\n */\r\nfunction isPointerEvent(value) {\r\n    // Guard for Safari <= 13.1\r\n    return globalThis.PointerEvent && value instanceof globalThis.PointerEvent;\r\n}\r\n/**\r\n * The PointerEventProcessor is responsible for collecting all the events from the canvas and transforming them into GlobalCoordinates\r\n */\r\nclass PointerEventReceiver {\r\n    constructor(target, engine) {\r\n        this.target = target;\r\n        this.engine = engine;\r\n        this.events = new EventEmitter();\r\n        this.primary = new PointerAbstraction();\r\n        this._activeNativePointerIdsToNormalized = new Map();\r\n        this.lastFramePointerCoords = new Map();\r\n        this.currentFramePointerCoords = new Map();\r\n        this.currentFramePointerDown = new Map();\r\n        this.lastFramePointerDown = new Map();\r\n        this.currentFrameDown = [];\r\n        this.currentFrameUp = [];\r\n        this.currentFrameMove = [];\r\n        this.currentFrameCancel = [];\r\n        this.currentFrameWheel = [];\r\n        this._pointers = [this.primary];\r\n        this._boundHandle = this._handle.bind(this);\r\n        this._boundWheel = this._handleWheel.bind(this);\r\n    }\r\n    /**\r\n     * Creates a new PointerEventReceiver with a new target and engine while preserving existing pointer event\r\n     * handlers.\r\n     * @param target\r\n     * @param engine\r\n     */\r\n    recreate(target, engine) {\r\n        const eventReceiver = new PointerEventReceiver(target, engine);\r\n        eventReceiver.primary = this.primary;\r\n        eventReceiver._pointers = this._pointers;\r\n        return eventReceiver;\r\n    }\r\n    /**\r\n     * Locates a specific pointer by id, creates it if it doesn't exist\r\n     * @param index\r\n     */\r\n    at(index) {\r\n        if (index >= this._pointers.length) {\r\n            // Ensure there is a pointer to retrieve\r\n            for (let i = this._pointers.length - 1, max = index; i < max; i++) {\r\n                this._pointers.push(new PointerAbstraction());\r\n            }\r\n        }\r\n        return this._pointers[index];\r\n    }\r\n    /**\r\n     * The number of pointers currently being tracked by excalibur\r\n     */\r\n    count() {\r\n        return this._pointers.length;\r\n    }\r\n    /**\r\n     * Is the specified pointer id down this frame\r\n     * @param pointerId\r\n     */\r\n    isDown(pointerId) {\r\n        var _a;\r\n        return (_a = this.currentFramePointerDown.get(pointerId)) !== null && _a !== void 0 ? _a : false;\r\n    }\r\n    /**\r\n     * Was the specified pointer id down last frame\r\n     * @param pointerId\r\n     */\r\n    wasDown(pointerId) {\r\n        var _a;\r\n        return (_a = this.lastFramePointerDown.get(pointerId)) !== null && _a !== void 0 ? _a : false;\r\n    }\r\n    /**\r\n     * Whether the Pointer is currently dragging.\r\n     */\r\n    isDragging(pointerId) {\r\n        return this.isDown(pointerId);\r\n    }\r\n    /**\r\n     * Whether the Pointer just started dragging.\r\n     */\r\n    isDragStart(pointerId) {\r\n        return this.isDown(pointerId) && !this.wasDown(pointerId);\r\n    }\r\n    /**\r\n     * Whether the Pointer just ended dragging.\r\n     */\r\n    isDragEnd(pointerId) {\r\n        return !this.isDown(pointerId) && this.wasDown(pointerId);\r\n    }\r\n    emit(eventName, event) {\r\n        this.events.emit(eventName, event);\r\n    }\r\n    on(eventName, handler) {\r\n        return this.events.on(eventName, handler);\r\n    }\r\n    once(eventName, handler) {\r\n        return this.events.once(eventName, handler);\r\n    }\r\n    off(eventName, handler) {\r\n        this.events.off(eventName, handler);\r\n    }\r\n    /**\r\n     * Called internally by excalibur\r\n     *\r\n     * Updates the current frame pointer info and emits raw pointer events\r\n     *\r\n     * This does not emit events to entities, see PointerSystem\r\n     */\r\n    update() {\r\n        this.lastFramePointerDown = new Map(this.currentFramePointerDown);\r\n        this.lastFramePointerCoords = new Map(this.currentFramePointerCoords);\r\n        for (const event of this.currentFrameDown) {\r\n            this.emit('down', event);\r\n            const pointer = this.at(event.pointerId);\r\n            pointer.emit('down', event);\r\n            this.primary.emit('pointerdown', event);\r\n        }\r\n        for (const event of this.currentFrameUp) {\r\n            this.emit('up', event);\r\n            const pointer = this.at(event.pointerId);\r\n            pointer.emit('up', event);\r\n        }\r\n        for (const event of this.currentFrameMove) {\r\n            this.emit('move', event);\r\n            const pointer = this.at(event.pointerId);\r\n            pointer.emit('move', event);\r\n        }\r\n        for (const event of this.currentFrameCancel) {\r\n            this.emit('cancel', event);\r\n            const pointer = this.at(event.pointerId);\r\n            pointer.emit('cancel', event);\r\n        }\r\n        for (const event of this.currentFrameWheel) {\r\n            this.emit('wheel', event);\r\n            this.primary.emit('pointerwheel', event);\r\n        }\r\n    }\r\n    /**\r\n     * Clears the current frame event and pointer data\r\n     */\r\n    clear() {\r\n        for (const event of this.currentFrameUp) {\r\n            this.currentFramePointerCoords.delete(event.pointerId);\r\n            const ids = this._activeNativePointerIdsToNormalized.entries();\r\n            for (const [native, normalized] of ids) {\r\n                if (normalized === event.pointerId) {\r\n                    this._activeNativePointerIdsToNormalized.delete(native);\r\n                }\r\n            }\r\n        }\r\n        this.currentFrameDown.length = 0;\r\n        this.currentFrameUp.length = 0;\r\n        this.currentFrameMove.length = 0;\r\n        this.currentFrameCancel.length = 0;\r\n        this.currentFrameWheel.length = 0;\r\n    }\r\n    /**\r\n     * Initializes the pointer event receiver so that it can start listening to native\r\n     * browser events.\r\n     */\r\n    init(options) {\r\n        var _a;\r\n        // Disabling the touch action avoids browser/platform gestures from firing on the canvas\r\n        // It is important on mobile to have touch action 'none'\r\n        // https://stackoverflow.com/questions/48124372/pointermove-event-not-working-with-touch-why-not\r\n        if (this.target === this.engine.canvas) {\r\n            this.engine.canvas.style.touchAction = 'none';\r\n        }\r\n        else {\r\n            document.body.style.touchAction = 'none';\r\n        }\r\n        // Preferred pointer events\r\n        if (window.PointerEvent) {\r\n            this.target.addEventListener('pointerdown', this._boundHandle);\r\n            this.target.addEventListener('pointerup', this._boundHandle);\r\n            this.target.addEventListener('pointermove', this._boundHandle);\r\n            this.target.addEventListener('pointercancel', this._boundHandle);\r\n        }\r\n        else {\r\n            // Touch Events\r\n            this.target.addEventListener('touchstart', this._boundHandle);\r\n            this.target.addEventListener('touchend', this._boundHandle);\r\n            this.target.addEventListener('touchmove', this._boundHandle);\r\n            this.target.addEventListener('touchcancel', this._boundHandle);\r\n            // Mouse Events\r\n            this.target.addEventListener('mousedown', this._boundHandle);\r\n            this.target.addEventListener('mouseup', this._boundHandle);\r\n            this.target.addEventListener('mousemove', this._boundHandle);\r\n        }\r\n        // MDN MouseWheelEvent\r\n        const wheelOptions = {\r\n            passive: !(this.engine.pageScrollPreventionMode === ScrollPreventionMode.All ||\r\n                this.engine.pageScrollPreventionMode === ScrollPreventionMode.Canvas)\r\n        };\r\n        if ('onwheel' in document.createElement('div')) {\r\n            // Modern Browsers\r\n            this.target.addEventListener('wheel', this._boundWheel, wheelOptions);\r\n        }\r\n        else if (document.onmousewheel !== undefined) {\r\n            // Webkit and IE\r\n            this.target.addEventListener('mousewheel', this._boundWheel, wheelOptions);\r\n        }\r\n        else {\r\n            // Remaining browser and older Firefox\r\n            this.target.addEventListener('MozMousePixelScroll', this._boundWheel, wheelOptions);\r\n        }\r\n        const grabWindowFocus = (_a = options === null || options === void 0 ? void 0 : options.grabWindowFocus) !== null && _a !== void 0 ? _a : true;\r\n        // Handle cross origin iframe\r\n        if (grabWindowFocus && isCrossOriginIframe()) {\r\n            const grabFocus = () => {\r\n                window.focus();\r\n            };\r\n            // Preferred pointer events\r\n            if (window.PointerEvent) {\r\n                this.target.addEventListener('pointerdown', grabFocus);\r\n            }\r\n            else {\r\n                // Touch Events\r\n                this.target.addEventListener('touchstart', grabFocus);\r\n                // Mouse Events\r\n                this.target.addEventListener('mousedown', grabFocus);\r\n            }\r\n        }\r\n    }\r\n    detach() {\r\n        // Preferred pointer events\r\n        if (window.PointerEvent) {\r\n            this.target.removeEventListener('pointerdown', this._boundHandle);\r\n            this.target.removeEventListener('pointerup', this._boundHandle);\r\n            this.target.removeEventListener('pointermove', this._boundHandle);\r\n            this.target.removeEventListener('pointercancel', this._boundHandle);\r\n        }\r\n        else {\r\n            // Touch Events\r\n            this.target.removeEventListener('touchstart', this._boundHandle);\r\n            this.target.removeEventListener('touchend', this._boundHandle);\r\n            this.target.removeEventListener('touchmove', this._boundHandle);\r\n            this.target.removeEventListener('touchcancel', this._boundHandle);\r\n            // Mouse Events\r\n            this.target.removeEventListener('mousedown', this._boundHandle);\r\n            this.target.removeEventListener('mouseup', this._boundHandle);\r\n            this.target.removeEventListener('mousemove', this._boundHandle);\r\n        }\r\n        if ('onwheel' in document.createElement('div')) {\r\n            // Modern Browsers\r\n            this.target.removeEventListener('wheel', this._boundWheel);\r\n        }\r\n        else if (document.onmousewheel !== undefined) {\r\n            // Webkit and IE\r\n            this.target.addEventListener('mousewheel', this._boundWheel);\r\n        }\r\n        else {\r\n            // Remaining browser and older Firefox\r\n            this.target.addEventListener('MozMousePixelScroll', this._boundWheel);\r\n        }\r\n    }\r\n    /**\r\n     * Take native pointer id and map it to index in active pointers\r\n     * @param nativePointerId\r\n     */\r\n    _normalizePointerId(nativePointerId) {\r\n        // Add to the the native pointer set id\r\n        this._activeNativePointerIdsToNormalized.set(nativePointerId, -1);\r\n        // Native pointer ids in ascending order\r\n        const currentPointerIds = Array.from(this._activeNativePointerIdsToNormalized.keys()).sort((a, b) => a - b);\r\n        // The index into sorted ids will be the new id, will always have an id\r\n        const id = currentPointerIds.findIndex(p => p === nativePointerId);\r\n        // Save the mapping so we can reverse it later\r\n        this._activeNativePointerIdsToNormalized.set(nativePointerId, id);\r\n        // ignore pointer because game isn't watching\r\n        return id;\r\n    }\r\n    /**\r\n     * Responsible for handling and parsing pointer events\r\n     */\r\n    _handle(ev) {\r\n        ev.preventDefault();\r\n        const eventCoords = new Map();\r\n        let button;\r\n        let pointerType;\r\n        if (isTouchEvent(ev)) {\r\n            button = PointerButton.Unknown;\r\n            pointerType = PointerType.Touch;\r\n            // https://developer.mozilla.org/en-US/docs/Web/API/TouchEvent\r\n            for (let i = 0; i < ev.changedTouches.length; i++) {\r\n                const touch = ev.changedTouches[i];\r\n                const coordinates = GlobalCoordinates.fromPagePosition(touch.pageX, touch.pageY, this.engine);\r\n                const nativePointerId = i + 1;\r\n                const pointerId = this._normalizePointerId(nativePointerId);\r\n                this.currentFramePointerCoords.set(pointerId, coordinates);\r\n                eventCoords.set(pointerId, coordinates);\r\n            }\r\n        }\r\n        else {\r\n            button = this._nativeButtonToPointerButton(ev.button);\r\n            pointerType = PointerType.Mouse;\r\n            const coordinates = GlobalCoordinates.fromPagePosition(ev.pageX, ev.pageY, this.engine);\r\n            let nativePointerId = 1;\r\n            if (isPointerEvent(ev)) {\r\n                nativePointerId = ev.pointerId;\r\n                pointerType = this._stringToPointerType(ev.pointerType);\r\n            }\r\n            const pointerId = this._normalizePointerId(nativePointerId);\r\n            this.currentFramePointerCoords.set(pointerId, coordinates);\r\n            eventCoords.set(pointerId, coordinates);\r\n        }\r\n        for (const [pointerId, coord] of eventCoords.entries()) {\r\n            switch (ev.type) {\r\n                case 'mousedown':\r\n                case 'pointerdown':\r\n                case 'touchstart':\r\n                    this.currentFrameDown.push(new PointerEvent('down', pointerId, button, pointerType, coord, ev));\r\n                    this.currentFramePointerDown.set(pointerId, true);\r\n                    break;\r\n                case 'mouseup':\r\n                case 'pointerup':\r\n                case 'touchend':\r\n                    this.currentFrameUp.push(new PointerEvent('up', pointerId, button, pointerType, coord, ev));\r\n                    this.currentFramePointerDown.set(pointerId, false);\r\n                    break;\r\n                case 'mousemove':\r\n                case 'pointermove':\r\n                case 'touchmove':\r\n                    this.currentFrameMove.push(new PointerEvent('move', pointerId, button, pointerType, coord, ev));\r\n                    break;\r\n                case 'touchcancel':\r\n                case 'pointercancel':\r\n                    this.currentFrameCancel.push(new PointerEvent('cancel', pointerId, button, pointerType, coord, ev));\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n    _handleWheel(ev) {\r\n        // Should we prevent page scroll because of this event\r\n        if (this.engine.pageScrollPreventionMode === ScrollPreventionMode.All ||\r\n            (this.engine.pageScrollPreventionMode === ScrollPreventionMode.Canvas && ev.target === this.engine.canvas)) {\r\n            ev.preventDefault();\r\n        }\r\n        const screen = this.engine.screen.pageToScreenCoordinates(vec(ev.pageX, ev.pageY));\r\n        const world = this.engine.screen.screenToWorldCoordinates(screen);\r\n        /**\r\n         * A constant used to normalize wheel events across different browsers\r\n         *\r\n         * This normalization factor is pulled from\r\n         * https://developer.mozilla.org/en-US/docs/Web/Events/wheel#Listening_to_this_event_across_browser\r\n         */\r\n        const ScrollWheelNormalizationFactor = -1 / 40;\r\n        const deltaX = ev.deltaX || ev.wheelDeltaX * ScrollWheelNormalizationFactor || 0;\r\n        const deltaY = ev.deltaY || ev.wheelDeltaY * ScrollWheelNormalizationFactor || ev.wheelDelta * ScrollWheelNormalizationFactor || ev.detail || 0;\r\n        const deltaZ = ev.deltaZ || 0;\r\n        let deltaMode = WheelDeltaMode.Pixel;\r\n        if (ev.deltaMode) {\r\n            if (ev.deltaMode === 1) {\r\n                deltaMode = WheelDeltaMode.Line;\r\n            }\r\n            else if (ev.deltaMode === 2) {\r\n                deltaMode = WheelDeltaMode.Page;\r\n            }\r\n        }\r\n        const we = new WheelEvent(world.x, world.y, ev.pageX, ev.pageY, screen.x, screen.y, 0, deltaX, deltaY, deltaZ, deltaMode, ev);\r\n        this.currentFrameWheel.push(we);\r\n    }\r\n    /**\r\n     * Triggers an excalibur pointer event in a world space pos\r\n     *\r\n     * Useful for testing pointers in excalibur\r\n     * @param type\r\n     * @param pos\r\n     */\r\n    triggerEvent(type, pos) {\r\n        const page = this.engine.screen.worldToPageCoordinates(pos);\r\n        // Send an event to the event receiver\r\n        if (window.PointerEvent) {\r\n            this._handle(new window.PointerEvent('pointer' + type, {\r\n                pointerId: 0,\r\n                clientX: page.x,\r\n                clientY: page.y\r\n            }));\r\n        }\r\n        else {\r\n            // Safari hack\r\n            this._handle(new window.MouseEvent('mouse' + type, {\r\n                clientX: page.x,\r\n                clientY: page.y\r\n            }));\r\n        }\r\n        // Force update pointer system\r\n        const pointerSystem = this.engine.currentScene.world.systemManager.get(PointerSystem);\r\n        const transformEntities = this.engine.currentScene.world.queryManager.createQuery(pointerSystem.types);\r\n        pointerSystem.preupdate();\r\n        pointerSystem.update(transformEntities.getEntities());\r\n    }\r\n    _nativeButtonToPointerButton(s) {\r\n        switch (s) {\r\n            case NativePointerButton.NoButton:\r\n                return PointerButton.NoButton;\r\n            case NativePointerButton.Left:\r\n                return PointerButton.Left;\r\n            case NativePointerButton.Middle:\r\n                return PointerButton.Middle;\r\n            case NativePointerButton.Right:\r\n                return PointerButton.Right;\r\n            case NativePointerButton.Unknown:\r\n                return PointerButton.Unknown;\r\n            default:\r\n                return fail(s);\r\n        }\r\n    }\r\n    _stringToPointerType(s) {\r\n        switch (s) {\r\n            case 'touch':\r\n                return PointerType.Touch;\r\n            case 'mouse':\r\n                return PointerType.Mouse;\r\n            case 'pen':\r\n                return PointerType.Pen;\r\n            default:\r\n                return PointerType.Unknown;\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Fps.ts\nclass FpsSampler {\r\n    constructor(options) {\r\n        var _a;\r\n        this._samplePeriod = 100;\r\n        this._currentFrameTime = 0;\r\n        this._frames = 0;\r\n        this._previousSampleTime = 0;\r\n        this._beginFrameTime = 0;\r\n        this._fps = options.initialFps;\r\n        this._samplePeriod = (_a = options.samplePeriod) !== null && _a !== void 0 ? _a : this._samplePeriod;\r\n        this._currentFrameTime = 1000 / options.initialFps;\r\n        this._nowFn = options.nowFn;\r\n        this._previousSampleTime = this._nowFn();\r\n    }\r\n    /**\r\n     * Start of code block to sample FPS for\r\n     */\r\n    start() {\r\n        this._beginFrameTime = this._nowFn();\r\n    }\r\n    /**\r\n     * End of code block to sample FPS for\r\n     */\r\n    end() {\r\n        this._frames++;\r\n        const time = this._nowFn();\r\n        this._currentFrameTime = time - this._beginFrameTime;\r\n        if (time >= this._previousSampleTime + this._samplePeriod) {\r\n            this._fps = (this._frames * 1000) / (time - this._previousSampleTime);\r\n            this._previousSampleTime = time;\r\n            this._frames = 0;\r\n        }\r\n    }\r\n    /**\r\n     * Return the currently sampled fps over the last sample period, by default every 100ms\r\n     */\r\n    get fps() {\r\n        return this._fps;\r\n    }\r\n    /**\r\n     * Return the instantaneous fps, this can be less useful because it will fluctuate given the current frames time\r\n     */\r\n    get instant() {\r\n        return 1000 / this._currentFrameTime;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Util/Clock.ts\n\r\n\r\n/**\r\n * Abstract Clock is the base type of all Clocks\r\n *\r\n * It has a few opinions\r\n * 1. It manages the calculation of what \"elapsed\" time means and thus maximum fps\r\n * 2. The default timing api is implemented in now()\r\n *\r\n * To implement your own clock, extend Clock and override start/stop to start and stop the clock, then call update() with whatever\r\n * method is unique to your clock implementation.\r\n */\r\nclass Clock {\r\n    constructor(options) {\r\n        var _a, _b, _c;\r\n        this._onFatalException = () => { };\r\n        this._maxFps = Infinity;\r\n        this._lastTime = 0;\r\n        this._elapsed = 1;\r\n        this._scheduledCbs = [];\r\n        this._totalElapsed = 0;\r\n        this._options = options;\r\n        this.tick = options.tick;\r\n        this._lastTime = (_a = this.now()) !== null && _a !== void 0 ? _a : 0;\r\n        this._maxFps = (_b = options.maxFps) !== null && _b !== void 0 ? _b : this._maxFps;\r\n        this._onFatalException = (_c = options.onFatalException) !== null && _c !== void 0 ? _c : this._onFatalException;\r\n        this.fpsSampler = new FpsSampler({\r\n            initialFps: 60,\r\n            nowFn: () => this.now()\r\n        });\r\n    }\r\n    /**\r\n     * Get the elapsed time for the last completed frame\r\n     */\r\n    elapsed() {\r\n        return this._elapsed;\r\n    }\r\n    /**\r\n     * Get the current time in milliseconds\r\n     */\r\n    now() {\r\n        return performance.now();\r\n    }\r\n    toTestClock() {\r\n        const testClock = new TestClock({\r\n            ...this._options,\r\n            defaultUpdateMs: 16.6\r\n        });\r\n        return testClock;\r\n    }\r\n    toStandardClock() {\r\n        const clock = new StandardClock({\r\n            ...this._options\r\n        });\r\n        return clock;\r\n    }\r\n    setFatalExceptionHandler(handler) {\r\n        this._onFatalException = handler;\r\n    }\r\n    /**\r\n     * Schedule a callback to fire given a timeout in milliseconds using the excalibur [[Clock]]\r\n     *\r\n     * This is useful to use over the built in browser `setTimeout` because callbacks will be tied to the\r\n     * excalibur update clock, instead of browser time, this means that callbacks wont fire if the game is\r\n     * stopped or paused.\r\n     *\r\n     * @param cb callback to fire\r\n     * @param timeoutMs Optionally specify a timeout in milliseconds from now, default is 0ms which means the next possible tick\r\n     */\r\n    schedule(cb, timeoutMs = 0) {\r\n        // Scheduled based on internal elapsed time\r\n        const scheduledTime = this._totalElapsed + timeoutMs;\r\n        this._scheduledCbs.push([cb, scheduledTime]);\r\n    }\r\n    _runScheduledCbs() {\r\n        // walk backwards to delete items as we loop\r\n        for (let i = this._scheduledCbs.length - 1; i > -1; i--) {\r\n            if (this._scheduledCbs[i][1] <= this._totalElapsed) {\r\n                this._scheduledCbs[i][0]();\r\n                this._scheduledCbs.splice(i, 1);\r\n            }\r\n        }\r\n    }\r\n    update(overrideUpdateMs) {\r\n        try {\r\n            this.fpsSampler.start();\r\n            // Get the time to calculate time-elapsed\r\n            const now = this.now();\r\n            let elapsed = now - this._lastTime || 1; // first frame\r\n            // Constrain fps\r\n            const fpsInterval = (1000 / this._maxFps);\r\n            // only run frame if enough time has elapsed\r\n            if (elapsed >= fpsInterval) {\r\n                let leftover = 0;\r\n                if (fpsInterval !== 0) {\r\n                    leftover = (elapsed % fpsInterval);\r\n                    elapsed = elapsed - leftover; // shift elapsed to be \"in phase\" with the current loop fps\r\n                }\r\n                // Resolves issue #138 if the game has been paused, or blurred for\r\n                // more than a 200 milliseconds, reset elapsed time to 1. This improves reliability\r\n                // and provides more expected behavior when the engine comes back\r\n                // into focus\r\n                if (elapsed > 200) {\r\n                    elapsed = 1;\r\n                }\r\n                // tick the mainloop and run scheduled callbacks\r\n                this._elapsed = overrideUpdateMs || elapsed;\r\n                this._totalElapsed += this._elapsed;\r\n                this._runScheduledCbs();\r\n                this.tick(overrideUpdateMs || elapsed);\r\n                if (fpsInterval !== 0) {\r\n                    this._lastTime = now - leftover;\r\n                }\r\n                else {\r\n                    this._lastTime = now;\r\n                }\r\n                this.fpsSampler.end();\r\n            }\r\n        }\r\n        catch (e) {\r\n            this._onFatalException(e);\r\n            this.stop();\r\n        }\r\n    }\r\n}\r\n/**\r\n * The [[StandardClock]] implements the requestAnimationFrame browser api to run the tick()\r\n */\r\nclass StandardClock extends Clock {\r\n    constructor(options) {\r\n        super(options);\r\n        this._running = false;\r\n    }\r\n    isRunning() {\r\n        return this._running;\r\n    }\r\n    start() {\r\n        if (this._running) {\r\n            return;\r\n        }\r\n        this._running = true;\r\n        const mainloop = () => {\r\n            // stop the loop\r\n            if (!this._running) {\r\n                return;\r\n            }\r\n            try {\r\n                // request next loop\r\n                this._requestId = window.requestAnimationFrame(mainloop);\r\n                this.update();\r\n            }\r\n            catch (e) {\r\n                window.cancelAnimationFrame(this._requestId);\r\n                throw e;\r\n            }\r\n        };\r\n        // begin the first frame\r\n        mainloop();\r\n    }\r\n    stop() {\r\n        this._running = false;\r\n    }\r\n}\r\n/**\r\n * The TestClock is meant for debugging interactions in excalibur that require precise timing to replicate or test\r\n */\r\nclass TestClock extends Clock {\r\n    constructor(options) {\r\n        super({\r\n            ...options\r\n        });\r\n        this._logger = Logger.getInstance();\r\n        this._running = false;\r\n        this._currentTime = 0;\r\n        this._updateMs = options.defaultUpdateMs;\r\n    }\r\n    /**\r\n     * Get the current time in milliseconds\r\n     */\r\n    now() {\r\n        var _a;\r\n        return (_a = this._currentTime) !== null && _a !== void 0 ? _a : 0;\r\n    }\r\n    isRunning() {\r\n        return this._running;\r\n    }\r\n    start() {\r\n        this._running = true;\r\n    }\r\n    stop() {\r\n        this._running = false;\r\n    }\r\n    /**\r\n     * Manually step the clock forward 1 tick, optionally specify an elapsed time in milliseconds\r\n     * @param overrideUpdateMs\r\n     */\r\n    step(overrideUpdateMs) {\r\n        const time = overrideUpdateMs !== null && overrideUpdateMs !== void 0 ? overrideUpdateMs : this._updateMs;\r\n        if (this._running) {\r\n            // to be comparable to RAF this needs to be a full blown Task\r\n            // For example, images cannot decode synchronously in a single step\r\n            this.update(time);\r\n            this._currentTime += time;\r\n        }\r\n        else {\r\n            this._logger.warn('The clock is not running, no step will be performed');\r\n        }\r\n    }\r\n    /**\r\n     * Run a number of steps that tick the clock, optionally specify an elapsed time in milliseconds\r\n     * @param numberOfSteps\r\n     * @param overrideUpdateMs\r\n     */\r\n    run(numberOfSteps, overrideUpdateMs) {\r\n        for (let i = 0; i < numberOfSteps; i++) {\r\n            this.step(overrideUpdateMs !== null && overrideUpdateMs !== void 0 ? overrideUpdateMs : this._updateMs);\r\n        }\r\n    }\r\n}\r\n\n// EXTERNAL MODULE: ./Util/Toaster.css\nvar Util_Toaster = __webpack_require__(7379);\n;// CONCATENATED MODULE: ./Util/Toaster.ts\n\r\n/**\r\n * The Toaster is only meant to be called from inside Excalibur to display messages to players\r\n */\r\nclass Toaster {\r\n    constructor() {\r\n        this._toasterCss = Util_Toaster/* default */.Z.toString();\r\n        this._isInitialized = false;\r\n    }\r\n    _initialize() {\r\n        if (!this._isInitialized) {\r\n            this._container = document.createElement('div');\r\n            this._container.id = 'ex-toast-container';\r\n            document.body.appendChild(this._container);\r\n            this._isInitialized = true;\r\n            this._styleBlock = document.createElement('style');\r\n            this._styleBlock.textContent = this._toasterCss;\r\n            document.head.appendChild(this._styleBlock);\r\n        }\r\n    }\r\n    dispose() {\r\n        this._container.parentElement.removeChild(this._container);\r\n        this._styleBlock.parentElement.removeChild(this._styleBlock);\r\n        this._isInitialized = false;\r\n    }\r\n    _createFragment(message) {\r\n        const toastMessage = document.createElement('span');\r\n        toastMessage.innerText = message;\r\n        return toastMessage;\r\n    }\r\n    /**\r\n     * Display a toast message to a player\r\n     * @param message Text of the message, messages may have a single \"[LINK]\" to influence placement\r\n     * @param linkTarget Optionally specify a link location\r\n     * @param linkName Optionally specify a name for that link location\r\n     */\r\n    toast(message, linkTarget, linkName) {\r\n        this._initialize();\r\n        const toast = document.createElement('div');\r\n        toast.className = 'ex-toast-message';\r\n        const messageFragments = message.split('[LINK]').map(message => this._createFragment(message));\r\n        if (linkTarget) {\r\n            const link = document.createElement('a');\r\n            link.href = linkTarget;\r\n            if (linkName) {\r\n                link.innerText = linkName;\r\n            }\r\n            else {\r\n                link.innerText = linkTarget;\r\n            }\r\n            messageFragments.splice(1, 0, link);\r\n        }\r\n        // Assembly message\r\n        const finalMessage = document.createElement('div');\r\n        messageFragments.forEach(message => {\r\n            finalMessage.appendChild(message);\r\n        });\r\n        toast.appendChild(finalMessage);\r\n        // Dismiss button\r\n        const dismissBtn = document.createElement('button');\r\n        dismissBtn.innerText = 'x';\r\n        dismissBtn.addEventListener('click', () => {\r\n            this._container.removeChild(toast);\r\n        });\r\n        toast.appendChild(dismissBtn);\r\n        // Escape to dismiss\r\n        const keydownHandler = (evt) => {\r\n            if (evt.key === 'Escape') {\r\n                try {\r\n                    this._container.removeChild(toast);\r\n                }\r\n                catch (_a) {\r\n                    // pass\r\n                }\r\n            }\r\n            document.removeEventListener('keydown', keydownHandler);\r\n        };\r\n        document.addEventListener('keydown', keydownHandler);\r\n        // Insert into container\r\n        const first = this._container.firstChild;\r\n        this._container.insertBefore(toast, first);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Input/InputMapper.ts\n/**\r\n * This allows you to map multiple inputs to specific commands! This is especially useful when\r\n * you need to allow multiple input sources to control a specific action.\r\n */\r\nclass InputMapper {\r\n    constructor(inputs) {\r\n        this.inputs = inputs;\r\n        this._handlers = new Map();\r\n    }\r\n    /**\r\n     * Executes the input map, called internally by Excalibur\r\n     */\r\n    execute() {\r\n        for (const [input, command] of this._handlers.entries()) {\r\n            const results = input(this.inputs);\r\n            if (results) {\r\n                command(results);\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * This allows you to map multiple inputs to specific commands! This is useful\r\n     *\r\n     * The inputHandler should return a truthy value if you wish the commandHandler to fire.\r\n     *\r\n     * Example:\r\n     * ```typescript\r\n     * const moveRight = (amount: number) => { actor.vel.x = 100 * amount }\r\n     * const moveLeft = (amount: number) => { actor.vel.x = -100 * amount }\r\n     * const moveUp = (amount: number) => { actor.vel.y = -100 * amount }\r\n     * const moveDown = (amount: number) => { actor.vel.y = 100 * amount }\r\n     *\r\n     * engine.inputMapper.on(({keyboard}) => keyboard.isHeld(ex.Keys.ArrowRight) ? 1 : 0, moveRight);\r\n     * engine.inputMapper.on(({gamepads}) => gamepads.at(0).isButtonPressed(ex.Buttons.DpadRight) ? 1 : 0, moveRight);\r\n     * engine.inputMapper.on(({gamepads}) => gamepads.at(0).getAxes(ex.Axes.LeftStickX) > 0 ?\r\n     *  gamepads.at(0).getAxes(ex.Axes.LeftStickX) : 0, moveRight);\r\n     * ```\r\n     * @param inputHandler\r\n     * @param commandHandler\r\n     */\r\n    on(inputHandler, commandHandler) {\r\n        this._handlers.set(inputHandler, commandHandler);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Engine.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\npolyfill();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nconst EngineEvents = {\r\n    FallbackGraphicsContext: 'fallbackgraphicscontext',\r\n    Initialize: 'initialize',\r\n    Visible: 'visible',\r\n    Hidden: 'hidden',\r\n    Start: 'start',\r\n    Stop: 'stop',\r\n    PreUpdate: 'preupdate',\r\n    PostUpdate: 'postupdate',\r\n    PreFrame: 'preframe',\r\n    PostFrame: 'postframe',\r\n    PreDraw: 'predraw',\r\n    PostDraw: 'postdraw'\r\n};\r\n/**\r\n * Enum representing the different mousewheel event bubble prevention\r\n */\r\nvar ScrollPreventionMode;\r\n(function (ScrollPreventionMode) {\r\n    /**\r\n     * Do not prevent any page scrolling\r\n     */\r\n    ScrollPreventionMode[ScrollPreventionMode[\"None\"] = 0] = \"None\";\r\n    /**\r\n     * Prevent page scroll if mouse is over the game canvas\r\n     */\r\n    ScrollPreventionMode[ScrollPreventionMode[\"Canvas\"] = 1] = \"Canvas\";\r\n    /**\r\n     * Prevent all page scrolling via mouse wheel\r\n     */\r\n    ScrollPreventionMode[ScrollPreventionMode[\"All\"] = 2] = \"All\";\r\n})(ScrollPreventionMode || (ScrollPreventionMode = {}));\r\n/**\r\n * The Excalibur Engine\r\n *\r\n * The [[Engine]] is the main driver for a game. It is responsible for\r\n * starting/stopping the game, maintaining state, transmitting events,\r\n * loading resources, and managing the scene.\r\n */\r\nclass Engine {\r\n    /**\r\n     * The width of the game canvas in pixels (physical width component of the\r\n     * resolution of the canvas element)\r\n     */\r\n    get canvasWidth() {\r\n        return this.screen.canvasWidth;\r\n    }\r\n    /**\r\n     * Returns half width of the game canvas in pixels (half physical width component)\r\n     */\r\n    get halfCanvasWidth() {\r\n        return this.screen.halfCanvasWidth;\r\n    }\r\n    /**\r\n     * The height of the game canvas in pixels, (physical height component of\r\n     * the resolution of the canvas element)\r\n     */\r\n    get canvasHeight() {\r\n        return this.screen.canvasHeight;\r\n    }\r\n    /**\r\n     * Returns half height of the game canvas in pixels (half physical height component)\r\n     */\r\n    get halfCanvasHeight() {\r\n        return this.screen.halfCanvasHeight;\r\n    }\r\n    /**\r\n     * Returns the width of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get drawWidth() {\r\n        return this.screen.drawWidth;\r\n    }\r\n    /**\r\n     * Returns half the width of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get halfDrawWidth() {\r\n        return this.screen.halfDrawWidth;\r\n    }\r\n    /**\r\n     * Returns the height of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get drawHeight() {\r\n        return this.screen.drawHeight;\r\n    }\r\n    /**\r\n     * Returns half the height of the engine's visible drawing surface in pixels including zoom and device pixel ratio.\r\n     */\r\n    get halfDrawHeight() {\r\n        return this.screen.halfDrawHeight;\r\n    }\r\n    /**\r\n     * Returns whether excalibur detects the current screen to be HiDPI\r\n     */\r\n    get isHiDpi() {\r\n        return this.screen.isHiDpi;\r\n    }\r\n    /**\r\n     * Access [[stats]] that holds frame statistics.\r\n     */\r\n    get stats() {\r\n        return this.debug.stats;\r\n    }\r\n    /**\r\n     * Indicates whether the engine is set to fullscreen or not\r\n     */\r\n    get isFullscreen() {\r\n        return this.screen.isFullScreen;\r\n    }\r\n    /**\r\n     * Indicates the current [[DisplayMode]] of the engine.\r\n     */\r\n    get displayMode() {\r\n        return this.screen.displayMode;\r\n    }\r\n    /**\r\n     * Returns the calculated pixel ration for use in rendering\r\n     */\r\n    get pixelRatio() {\r\n        return this.screen.pixelRatio;\r\n    }\r\n    get isDebug() {\r\n        return this._isDebug;\r\n    }\r\n    /**\r\n     * Hints the graphics context to truncate fractional world space coordinates\r\n     */\r\n    get snapToPixel() {\r\n        return this.graphicsContext.snapToPixel;\r\n    }\r\n    ;\r\n    set snapToPixel(shouldSnapToPixel) {\r\n        this.graphicsContext.snapToPixel = shouldSnapToPixel;\r\n    }\r\n    ;\r\n    emit(eventName, event) {\r\n        this.events.emit(eventName, event);\r\n    }\r\n    on(eventName, handler) {\r\n        return this.events.on(eventName, handler);\r\n    }\r\n    once(eventName, handler) {\r\n        return this.events.once(eventName, handler);\r\n    }\r\n    off(eventName, handler) {\r\n        this.events.off(eventName, handler);\r\n    }\r\n    /**\r\n     * Creates a new game using the given [[EngineOptions]]. By default, if no options are provided,\r\n     * the game will be rendered full screen (taking up all available browser window space).\r\n     * You can customize the game rendering through [[EngineOptions]].\r\n     *\r\n     * Example:\r\n     *\r\n     * ```js\r\n     * var game = new ex.Engine({\r\n     *   width: 0, // the width of the canvas\r\n     *   height: 0, // the height of the canvas\r\n     *   enableCanvasTransparency: true, // the transparencySection of the canvas\r\n     *   canvasElementId: '', // the DOM canvas element ID, if you are providing your own\r\n     *   displayMode: ex.DisplayMode.FullScreen, // the display mode\r\n     *   pointerScope: ex.PointerScope.Document, // the scope of capturing pointer (mouse/touch) events\r\n     *   backgroundColor: ex.Color.fromHex('#2185d0') // background color of the engine\r\n     * });\r\n     *\r\n     * // call game.start, which is a Promise\r\n     * game.start().then(function () {\r\n     *   // ready, set, go!\r\n     * });\r\n     * ```\r\n     */\r\n    constructor(options) {\r\n        var _a, _b, _c, _d, _e, _f;\r\n        /**\r\n         * Listen to and emit events on the Engine\r\n         */\r\n        this.events = new EventEmitter();\r\n        /**\r\n         * Optionally set the maximum fps if not set Excalibur will go as fast as the device allows.\r\n         *\r\n         * You may want to constrain max fps if your game cannot maintain fps consistently, it can look and feel better to have a 30fps game than\r\n         * one that bounces between 30fps and 60fps\r\n         */\r\n        this.maxFps = Number.POSITIVE_INFINITY;\r\n        /**\r\n         * Contains all the scenes currently registered with Excalibur\r\n         */\r\n        this.scenes = {};\r\n        this._suppressPlayButton = false;\r\n        /**\r\n         * Indicates whether audio should be paused when the game is no longer visible.\r\n         */\r\n        this.pauseAudioWhenHidden = true;\r\n        /**\r\n         * Indicates whether the engine should draw with debug information\r\n         */\r\n        this._isDebug = false;\r\n        /**\r\n         * Sets the Transparency for the engine.\r\n         */\r\n        this.enableCanvasTransparency = true;\r\n        /**\r\n         * The action to take when a fatal exception is thrown\r\n         */\r\n        this.onFatalException = (e) => {\r\n            Logger.getInstance().fatal(e);\r\n        };\r\n        this._toaster = new Toaster();\r\n        this._timescale = 1.0;\r\n        this._isInitialized = false;\r\n        this._deferredGoTo = null;\r\n        this._originalOptions = {};\r\n        this._performanceThresholdTriggered = false;\r\n        this._fpsSamples = [];\r\n        this._loadingComplete = false;\r\n        this._isReady = false;\r\n        this._isReadyPromise = new Promise(resolve => {\r\n            this._isReadyResolve = resolve;\r\n        });\r\n        /**\r\n         * Returns the current frames elapsed milliseconds\r\n         */\r\n        this.currentFrameElapsedMs = 0;\r\n        /**\r\n         * Returns the current frame lag when in fixed update mode\r\n         */\r\n        this.currentFrameLagMs = 0;\r\n        this._lagMs = 0;\r\n        this._screenShotRequests = [];\r\n        options = { ...Engine._DEFAULT_ENGINE_OPTIONS, ...options };\r\n        this._originalOptions = options;\r\n        Flags.freeze();\r\n        // Initialize browser events facade\r\n        this.browser = new BrowserEvents(window, document);\r\n        // Check compatibility\r\n        const detector = new Detector();\r\n        if (!options.suppressMinimumBrowserFeatureDetection && !(this._compatible = detector.test())) {\r\n            const message = document.createElement('div');\r\n            message.innerText = 'Sorry, your browser does not support all the features needed for Excalibur';\r\n            document.body.appendChild(message);\r\n            detector.failedTests.forEach(function (test) {\r\n                const testMessage = document.createElement('div');\r\n                testMessage.innerText = 'Browser feature missing ' + test;\r\n                document.body.appendChild(testMessage);\r\n            });\r\n            if (options.canvasElementId) {\r\n                const canvas = document.getElementById(options.canvasElementId);\r\n                if (canvas) {\r\n                    canvas.parentElement.removeChild(canvas);\r\n                }\r\n            }\r\n            return;\r\n        }\r\n        else {\r\n            this._compatible = true;\r\n        }\r\n        // Use native console API for color fun\r\n        // eslint-disable-next-line no-console\r\n        if (console.log && !options.suppressConsoleBootMessage) {\r\n            // eslint-disable-next-line no-console\r\n            console.log(`%cPowered by Excalibur.js (v${EX_VERSION})`, 'background: #176BAA; color: white; border-radius: 5px; padding: 15px; font-size: 1.5em; line-height: 80px;');\r\n            // eslint-disable-next-line no-console\r\n            console.log('\\n\\\r\n      /| ________________\\n\\\r\nO|===|* >________________>\\n\\\r\n      \\\\|');\r\n            // eslint-disable-next-line no-console\r\n            console.log('Visit', 'http://excaliburjs.com', 'for more information');\r\n        }\r\n        // Suppress play button\r\n        if (options.suppressPlayButton) {\r\n            this._suppressPlayButton = true;\r\n        }\r\n        this._logger = Logger.getInstance();\r\n        // If debug is enabled, let's log browser features to the console.\r\n        if (this._logger.defaultLevel === LogLevel.Debug) {\r\n            detector.logBrowserFeatures();\r\n        }\r\n        this._logger.debug('Building engine...');\r\n        this.canvasElementId = options.canvasElementId;\r\n        if (options.canvasElementId) {\r\n            this._logger.debug('Using Canvas element specified: ' + options.canvasElementId);\r\n            this.canvas = document.getElementById(options.canvasElementId);\r\n        }\r\n        else if (options.canvasElement) {\r\n            this._logger.debug('Using Canvas element specified:', options.canvasElement);\r\n            this.canvas = options.canvasElement;\r\n        }\r\n        else {\r\n            this._logger.debug('Using generated canvas element');\r\n            this.canvas = document.createElement('canvas');\r\n        }\r\n        let displayMode = (_a = options.displayMode) !== null && _a !== void 0 ? _a : DisplayMode.Fixed;\r\n        if ((options.width && options.height) || options.viewport) {\r\n            if (options.displayMode === undefined) {\r\n                displayMode = DisplayMode.Fixed;\r\n            }\r\n            this._logger.debug('Engine viewport is size ' + options.width + ' x ' + options.height);\r\n        }\r\n        else if (!options.displayMode) {\r\n            this._logger.debug('Engine viewport is fit');\r\n            displayMode = DisplayMode.FitScreen;\r\n        }\r\n        this._originalDisplayMode = displayMode;\r\n        // Canvas 2D fallback can be flagged on\r\n        let useCanvasGraphicsContext = Flags.isEnabled('use-canvas-context');\r\n        if (!useCanvasGraphicsContext) {\r\n            // Attempt webgl first\r\n            try {\r\n                this.graphicsContext = new ExcaliburGraphicsContextWebGL({\r\n                    canvasElement: this.canvas,\r\n                    enableTransparency: this.enableCanvasTransparency,\r\n                    smoothing: options.antialiasing,\r\n                    backgroundColor: options.backgroundColor,\r\n                    snapToPixel: options.snapToPixel,\r\n                    useDrawSorting: options.useDrawSorting\r\n                });\r\n            }\r\n            catch (e) {\r\n                this._logger.warn(`Excalibur could not load webgl for some reason (${e.message}) and loaded a Canvas 2D fallback. ` +\r\n                    `Some features of Excalibur will not work in this mode. \\n\\n` +\r\n                    'Read more about this issue at https://excaliburjs.com/docs/webgl');\r\n                // fallback to canvas in case of failure\r\n                useCanvasGraphicsContext = true;\r\n            }\r\n        }\r\n        if (useCanvasGraphicsContext) {\r\n            this.graphicsContext = new ExcaliburGraphicsContext2DCanvas({\r\n                canvasElement: this.canvas,\r\n                enableTransparency: this.enableCanvasTransparency,\r\n                smoothing: options.antialiasing,\r\n                backgroundColor: options.backgroundColor,\r\n                snapToPixel: options.snapToPixel,\r\n                useDrawSorting: options.useDrawSorting\r\n            });\r\n        }\r\n        this.screen = new Screen({\r\n            canvas: this.canvas,\r\n            context: this.graphicsContext,\r\n            antialiasing: (_b = options.antialiasing) !== null && _b !== void 0 ? _b : true,\r\n            browser: this.browser,\r\n            viewport: (_c = options.viewport) !== null && _c !== void 0 ? _c : (options.width && options.height ? { width: options.width, height: options.height } : Resolution.SVGA),\r\n            resolution: options.resolution,\r\n            displayMode,\r\n            pixelRatio: options.suppressHiDPIScaling ? 1 : ((_d = options.pixelRatio) !== null && _d !== void 0 ? _d : null)\r\n        });\r\n        // Set default filtering based on antialiasing\r\n        TextureLoader.filtering = options.antialiasing ? ImageFiltering.Blended : ImageFiltering.Pixel;\r\n        if (options.backgroundColor) {\r\n            this.backgroundColor = options.backgroundColor.clone();\r\n        }\r\n        this.maxFps = (_e = options.maxFps) !== null && _e !== void 0 ? _e : this.maxFps;\r\n        this.fixedUpdateFps = (_f = options.fixedUpdateFps) !== null && _f !== void 0 ? _f : this.fixedUpdateFps;\r\n        this.clock = new StandardClock({\r\n            maxFps: this.maxFps,\r\n            tick: this._mainloop.bind(this),\r\n            onFatalException: (e) => this.onFatalException(e)\r\n        });\r\n        this.enableCanvasTransparency = options.enableCanvasTransparency;\r\n        this._loader = new Loader();\r\n        this._loader.wireEngine(this);\r\n        this.debug = new Debug(this);\r\n        this._initialize(options);\r\n        this.rootScene = this.currentScene = new Scene();\r\n        this.addScene('root', this.rootScene);\r\n        window.___EXCALIBUR_DEVTOOL = this;\r\n    }\r\n    _monitorPerformanceThresholdAndTriggerFallback() {\r\n        const { allow } = this._originalOptions.configurePerformanceCanvas2DFallback;\r\n        let { threshold, showPlayerMessage } = this._originalOptions.configurePerformanceCanvas2DFallback;\r\n        if (threshold === undefined) {\r\n            threshold = Engine._DEFAULT_ENGINE_OPTIONS.configurePerformanceCanvas2DFallback.threshold;\r\n        }\r\n        if (showPlayerMessage === undefined) {\r\n            showPlayerMessage = Engine._DEFAULT_ENGINE_OPTIONS.configurePerformanceCanvas2DFallback.showPlayerMessage;\r\n        }\r\n        if (!Flags.isEnabled('use-canvas-context') && allow && this.ready && !this._performanceThresholdTriggered) {\r\n            // Calculate Average fps for last X number of frames after start\r\n            if (this._fpsSamples.length === threshold.numberOfFrames) {\r\n                this._fpsSamples.splice(0, 1);\r\n            }\r\n            this._fpsSamples.push(this.clock.fpsSampler.fps);\r\n            let total = 0;\r\n            for (let i = 0; i < this._fpsSamples.length; i++) {\r\n                total += this._fpsSamples[i];\r\n            }\r\n            const average = total / this._fpsSamples.length;\r\n            if (this._fpsSamples.length === threshold.numberOfFrames) {\r\n                if (average <= threshold.fps) {\r\n                    this._performanceThresholdTriggered = true;\r\n                    this._logger.warn(`Switching to browser 2D Canvas fallback due to performance. Some features of Excalibur will not work in this mode.\\n` +\r\n                        'this might mean your browser doesn\\'t have webgl enabled or hardware acceleration is unavailable.\\n\\n' +\r\n                        'If in Chrome:\\n' +\r\n                        '  * Visit Settings > Advanced > System, and ensure \"Use Hardware Acceleration\" is checked.\\n' +\r\n                        '  * Visit chrome://flags/#ignore-gpu-blocklist and ensure \"Override software rendering list\" is \"enabled\"\\n' +\r\n                        'If in Firefox, visit about:config\\n' +\r\n                        '  * Ensure webgl.disabled = false\\n' +\r\n                        '  * Ensure webgl.force-enabled = true\\n' +\r\n                        '  * Ensure layers.acceleration.force-enabled = true\\n\\n' +\r\n                        'Read more about this issue at https://excaliburjs.com/docs/performance');\r\n                    if (showPlayerMessage) {\r\n                        this._toaster.toast('Excalibur is encountering performance issues. ' +\r\n                            'It\\'s possible that your browser doesn\\'t have hardware acceleration enabled. ' +\r\n                            'Visit [LINK] for more information and potential solutions.', 'https://excaliburjs.com/docs/performance');\r\n                    }\r\n                    this.useCanvas2DFallback();\r\n                    this.emit('fallbackgraphicscontext', this.graphicsContext);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Switches the engine's graphics context to the 2D Canvas.\r\n     * @warning Some features of Excalibur will not work in this mode.\r\n     */\r\n    useCanvas2DFallback() {\r\n        var _a, _b, _c;\r\n        // Swap out the canvas\r\n        const newCanvas = this.canvas.cloneNode(false);\r\n        this.canvas.parentNode.replaceChild(newCanvas, this.canvas);\r\n        this.canvas = newCanvas;\r\n        const options = this._originalOptions;\r\n        const displayMode = this._originalDisplayMode;\r\n        // New graphics context\r\n        this.graphicsContext = new ExcaliburGraphicsContext2DCanvas({\r\n            canvasElement: this.canvas,\r\n            enableTransparency: this.enableCanvasTransparency,\r\n            smoothing: options.antialiasing,\r\n            backgroundColor: options.backgroundColor,\r\n            snapToPixel: options.snapToPixel,\r\n            useDrawSorting: options.useDrawSorting\r\n        });\r\n        // Reset screen\r\n        if (this.screen) {\r\n            this.screen.dispose();\r\n        }\r\n        this.screen = new Screen({\r\n            canvas: this.canvas,\r\n            context: this.graphicsContext,\r\n            antialiasing: (_a = options.antialiasing) !== null && _a !== void 0 ? _a : true,\r\n            browser: this.browser,\r\n            viewport: (_b = options.viewport) !== null && _b !== void 0 ? _b : (options.width && options.height ? { width: options.width, height: options.height } : Resolution.SVGA),\r\n            resolution: options.resolution,\r\n            displayMode,\r\n            pixelRatio: options.suppressHiDPIScaling ? 1 : ((_c = options.pixelRatio) !== null && _c !== void 0 ? _c : null)\r\n        });\r\n        this.screen.setCurrentCamera(this.currentScene.camera);\r\n        // Reset pointers\r\n        this.input.pointers.detach();\r\n        const pointerTarget = options && options.pointerScope === PointerScope.Document ? document : this.canvas;\r\n        this.input.pointers = this.input.pointers.recreate(pointerTarget, this);\r\n        this.input.pointers.init();\r\n    }\r\n    /**\r\n     * Returns a BoundingBox of the top left corner of the screen\r\n     * and the bottom right corner of the screen.\r\n     */\r\n    getWorldBounds() {\r\n        return this.screen.getWorldBounds();\r\n    }\r\n    /**\r\n     * Gets the current engine timescale factor (default is 1.0 which is 1:1 time)\r\n     */\r\n    get timescale() {\r\n        return this._timescale;\r\n    }\r\n    /**\r\n     * Sets the current engine timescale factor. Useful for creating slow-motion effects or fast-forward effects\r\n     * when using time-based movement.\r\n     */\r\n    set timescale(value) {\r\n        if (value <= 0) {\r\n            Logger.getInstance().error('Cannot set engine.timescale to a value of 0 or less than 0.');\r\n            return;\r\n        }\r\n        this._timescale = value;\r\n    }\r\n    /**\r\n     * Adds a [[Timer]] to the [[currentScene]].\r\n     * @param timer  The timer to add to the [[currentScene]].\r\n     */\r\n    addTimer(timer) {\r\n        return this.currentScene.addTimer(timer);\r\n    }\r\n    /**\r\n     * Removes a [[Timer]] from the [[currentScene]].\r\n     * @param timer  The timer to remove to the [[currentScene]].\r\n     */\r\n    removeTimer(timer) {\r\n        return this.currentScene.removeTimer(timer);\r\n    }\r\n    /**\r\n     * Adds a [[Scene]] to the engine, think of scenes in Excalibur as you\r\n     * would levels or menus.\r\n     *\r\n     * @param key  The name of the scene, must be unique\r\n     * @param scene The scene to add to the engine\r\n     */\r\n    addScene(key, scene) {\r\n        if (this.scenes[key]) {\r\n            this._logger.warn('Scene', key, 'already exists overwriting');\r\n        }\r\n        this.scenes[key] = scene;\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    removeScene(entity) {\r\n        if (entity instanceof Scene) {\r\n            // remove scene\r\n            for (const key in this.scenes) {\r\n                if (this.scenes.hasOwnProperty(key)) {\r\n                    if (this.scenes[key] === entity) {\r\n                        delete this.scenes[key];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (typeof entity === 'string') {\r\n            // remove scene\r\n            delete this.scenes[entity];\r\n        }\r\n    }\r\n    add(entity) {\r\n        if (arguments.length === 2) {\r\n            this.addScene(arguments[0], arguments[1]);\r\n            return;\r\n        }\r\n        if (this._deferredGoTo && this.scenes[this._deferredGoTo]) {\r\n            this.scenes[this._deferredGoTo].add(entity);\r\n        }\r\n        else {\r\n            this.currentScene.add(entity);\r\n        }\r\n    }\r\n    remove(entity) {\r\n        if (entity instanceof Entity) {\r\n            this.currentScene.remove(entity);\r\n        }\r\n        if (entity instanceof Scene) {\r\n            this.removeScene(entity);\r\n        }\r\n        if (typeof entity === 'string') {\r\n            this.removeScene(entity);\r\n        }\r\n    }\r\n    /**\r\n     * Changes the currently updating and drawing scene to a different,\r\n     * named scene. Calls the [[Scene]] lifecycle events.\r\n     * @param key  The key of the scene to transition to.\r\n     * @param data Optional data to send to the scene's onActivate method\r\n     */\r\n    goToScene(key, data) {\r\n        // if not yet initialized defer goToScene\r\n        if (!this.isInitialized) {\r\n            this._deferredGoTo = key;\r\n            return;\r\n        }\r\n        if (this.scenes[key]) {\r\n            const previousScene = this.currentScene;\r\n            const nextScene = this.scenes[key];\r\n            this._logger.debug('Going to scene:', key);\r\n            // only deactivate when initialized\r\n            if (this.currentScene.isInitialized) {\r\n                const context = { engine: this, previousScene, nextScene };\r\n                this.currentScene._deactivate.apply(this.currentScene, [context, nextScene]);\r\n                this.currentScene.events.emit('deactivate', new DeactivateEvent(context, this.currentScene));\r\n            }\r\n            // set current scene to new one\r\n            this.currentScene = nextScene;\r\n            this.screen.setCurrentCamera(nextScene.camera);\r\n            // initialize the current scene if has not been already\r\n            this.currentScene._initialize(this);\r\n            const context = { engine: this, previousScene, nextScene, data };\r\n            this.currentScene._activate.apply(this.currentScene, [context, nextScene]);\r\n            this.currentScene.events.emit('activate', new ActivateEvent(context, this.currentScene));\r\n        }\r\n        else {\r\n            this._logger.error('Scene', key, 'does not exist!');\r\n        }\r\n    }\r\n    /**\r\n     * Transforms the current x, y from screen coordinates to world coordinates\r\n     * @param point  Screen coordinate to convert\r\n     */\r\n    screenToWorldCoordinates(point) {\r\n        return this.screen.screenToWorldCoordinates(point);\r\n    }\r\n    /**\r\n     * Transforms a world coordinate, to a screen coordinate\r\n     * @param point  World coordinate to convert\r\n     */\r\n    worldToScreenCoordinates(point) {\r\n        return this.screen.worldToScreenCoordinates(point);\r\n    }\r\n    /**\r\n     * Initializes the internal canvas, rendering context, display mode, and native event listeners\r\n     */\r\n    _initialize(options) {\r\n        var _a, _b, _c, _d;\r\n        this.pageScrollPreventionMode = options.scrollPreventionMode;\r\n        // initialize inputs\r\n        const pointerTarget = options && options.pointerScope === PointerScope.Document ? document : this.canvas;\r\n        this.input = {\r\n            keyboard: new Keyboard(),\r\n            pointers: new PointerEventReceiver(pointerTarget, this),\r\n            gamepads: new Gamepads()\r\n        };\r\n        this.input.keyboard.init({\r\n            grabWindowFocus: (_b = (_a = this._originalOptions) === null || _a === void 0 ? void 0 : _a.grabWindowFocus) !== null && _b !== void 0 ? _b : true\r\n        });\r\n        this.input.pointers.init({\r\n            grabWindowFocus: (_d = (_c = this._originalOptions) === null || _c === void 0 ? void 0 : _c.grabWindowFocus) !== null && _d !== void 0 ? _d : true\r\n        });\r\n        this.input.gamepads.init();\r\n        this.inputMapper = new InputMapper(this.input);\r\n        // Issue #385 make use of the visibility api\r\n        // https://developer.mozilla.org/en-US/docs/Web/Guide/User_experience/Using_the_Page_Visibility_API\r\n        this.browser.document.on('visibilitychange', () => {\r\n            if (document.visibilityState === 'hidden') {\r\n                this.events.emit('hidden', new HiddenEvent(this));\r\n                this._logger.debug('Window hidden');\r\n            }\r\n            else if (document.visibilityState === 'visible') {\r\n                this.events.emit('visible', new VisibleEvent(this));\r\n                this._logger.debug('Window visible');\r\n            }\r\n        });\r\n        if (!this.canvasElementId && !options.canvasElement) {\r\n            document.body.appendChild(this.canvas);\r\n        }\r\n    }\r\n    onInitialize(_engine) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * If supported by the browser, this will set the antialiasing flag on the\r\n     * canvas. Set this to `false` if you want a 'jagged' pixel art look to your\r\n     * image resources.\r\n     * @param isSmooth  Set smoothing to true or false\r\n     */\r\n    setAntialiasing(isSmooth) {\r\n        this.screen.antialiasing = isSmooth;\r\n    }\r\n    /**\r\n     * Return the current smoothing status of the canvas\r\n     */\r\n    getAntialiasing() {\r\n        return this.screen.antialiasing;\r\n    }\r\n    /**\r\n     * Gets whether the actor is Initialized\r\n     */\r\n    get isInitialized() {\r\n        return this._isInitialized;\r\n    }\r\n    _overrideInitialize(engine) {\r\n        if (!this.isInitialized) {\r\n            this.onInitialize(engine);\r\n            this.events.emit('initialize', new InitializeEvent(engine, this));\r\n            this._isInitialized = true;\r\n            if (this._deferredGoTo) {\r\n                const deferredScene = this._deferredGoTo;\r\n                this._deferredGoTo = null;\r\n                this.goToScene(deferredScene);\r\n            }\r\n            else {\r\n                this.goToScene('root');\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Updates the entire state of the game\r\n     * @param delta  Number of milliseconds elapsed since the last update.\r\n     */\r\n    _update(delta) {\r\n        if (!this.ready) {\r\n            // suspend updates until loading is finished\r\n            this._loader.update(this, delta);\r\n            // Update input listeners\r\n            this.input.keyboard.update();\r\n            this.input.gamepads.update();\r\n            this.inputMapper.execute();\r\n            return;\r\n        }\r\n        // Publish preupdate events\r\n        this._preupdate(delta);\r\n        // process engine level events\r\n        this.currentScene.update(this, delta);\r\n        // Update graphics postprocessors\r\n        this.graphicsContext.updatePostProcessors(delta);\r\n        // Publish update event\r\n        this._postupdate(delta);\r\n        // Update input listeners\r\n        this.input.keyboard.update();\r\n        this.input.gamepads.update();\r\n        this.inputMapper.execute();\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    _preupdate(delta) {\r\n        this.emit('preupdate', new PreUpdateEvent(this, delta, this));\r\n        this.onPreUpdate(this, delta);\r\n    }\r\n    onPreUpdate(_engine, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    _postupdate(delta) {\r\n        this.emit('postupdate', new PostUpdateEvent(this, delta, this));\r\n        this.onPostUpdate(this, delta);\r\n    }\r\n    onPostUpdate(_engine, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * Draws the entire game\r\n     * @param delta  Number of milliseconds elapsed since the last draw.\r\n     */\r\n    _draw(delta) {\r\n        this.graphicsContext.beginDrawLifecycle();\r\n        this.graphicsContext.clear();\r\n        this._predraw(this.graphicsContext, delta);\r\n        // Drawing nothing else while loading\r\n        if (!this._isReady) {\r\n            this._loader.canvas.draw(this.graphicsContext, 0, 0);\r\n            this.graphicsContext.flush();\r\n            return;\r\n        }\r\n        this.graphicsContext.backgroundColor = this.backgroundColor;\r\n        this.currentScene.draw(this.graphicsContext, delta);\r\n        this._postdraw(this.graphicsContext, delta);\r\n        // Flush any pending drawings\r\n        this.graphicsContext.flush();\r\n        this.graphicsContext.endDrawLifecycle();\r\n        this._checkForScreenShots();\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    _predraw(_ctx, delta) {\r\n        this.emit('predraw', new PreDrawEvent(_ctx, delta, this));\r\n        this.onPreDraw(_ctx, delta);\r\n    }\r\n    onPreDraw(_ctx, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * @internal\r\n     */\r\n    _postdraw(_ctx, delta) {\r\n        this.emit('postdraw', new PostDrawEvent(_ctx, delta, this));\r\n        this.onPostDraw(_ctx, delta);\r\n    }\r\n    onPostDraw(_ctx, _delta) {\r\n        // Override me\r\n    }\r\n    /**\r\n     * Enable or disable Excalibur debugging functionality.\r\n     * @param toggle a value that debug drawing will be changed to\r\n     */\r\n    showDebug(toggle) {\r\n        this._isDebug = toggle;\r\n    }\r\n    /**\r\n     * Toggle Excalibur debugging functionality.\r\n     */\r\n    toggleDebug() {\r\n        this._isDebug = !this._isDebug;\r\n        return this._isDebug;\r\n    }\r\n    /**\r\n     * Returns true when loading is totally complete and the player has clicked start\r\n     */\r\n    get loadingComplete() {\r\n        return this._loadingComplete;\r\n    }\r\n    get ready() {\r\n        return this._isReady;\r\n    }\r\n    isReady() {\r\n        return this._isReadyPromise;\r\n    }\r\n    /**\r\n     * Starts the internal game loop for Excalibur after loading\r\n     * any provided assets.\r\n     * @param loader  Optional [[Loader]] to use to load resources. The default loader is [[Loader]], override to provide your own\r\n     * custom loader.\r\n     *\r\n     * Note: start() only resolves AFTER the user has clicked the play button\r\n     */\r\n    async start(loader) {\r\n        if (!this._compatible) {\r\n            throw new Error('Excalibur is incompatible with your browser');\r\n        }\r\n        // Wire loader if we have it\r\n        if (loader) {\r\n            // Push the current user entered resolution/viewport\r\n            this.screen.pushResolutionAndViewport();\r\n            // Configure resolution for loader, it expects resolution === viewport\r\n            this.screen.resolution = this.screen.viewport;\r\n            this.screen.applyResolutionAndViewport();\r\n            this._loader = loader;\r\n            this._loader.suppressPlayButton = this._suppressPlayButton || this._loader.suppressPlayButton;\r\n            this._loader.wireEngine(this);\r\n        }\r\n        // Start the excalibur clock which drives the mainloop\r\n        // has started is a slight misnomer, it's really mainloop started\r\n        this._logger.debug('Starting game clock...');\r\n        this.browser.resume();\r\n        this.clock.start();\r\n        this._logger.debug('Game clock started');\r\n        if (loader) {\r\n            await this.load(this._loader);\r\n            this._loadingComplete = true;\r\n            // reset back to previous user resolution/viewport\r\n            this.screen.popResolutionAndViewport();\r\n            this.screen.applyResolutionAndViewport();\r\n        }\r\n        this._loadingComplete = true;\r\n        // Initialize before ready\r\n        this._overrideInitialize(this);\r\n        this._isReady = true;\r\n        this._isReadyResolve();\r\n        this.emit('start', new GameStartEvent(this));\r\n        return this._isReadyPromise;\r\n    }\r\n    _mainloop(elapsed) {\r\n        this.emit('preframe', new PreFrameEvent(this, this.stats.prevFrame));\r\n        const delta = elapsed * this.timescale;\r\n        this.currentFrameElapsedMs = delta;\r\n        // reset frame stats (reuse existing instances)\r\n        const frameId = this.stats.prevFrame.id + 1;\r\n        this.stats.currFrame.reset();\r\n        this.stats.currFrame.id = frameId;\r\n        this.stats.currFrame.delta = delta;\r\n        this.stats.currFrame.fps = this.clock.fpsSampler.fps;\r\n        GraphicsDiagnostics.clear();\r\n        const beforeUpdate = this.clock.now();\r\n        const fixedTimestepMs = 1000 / this.fixedUpdateFps;\r\n        if (this.fixedUpdateFps) {\r\n            this._lagMs += delta;\r\n            while (this._lagMs >= fixedTimestepMs) {\r\n                this._update(fixedTimestepMs);\r\n                this._lagMs -= fixedTimestepMs;\r\n            }\r\n        }\r\n        else {\r\n            this._update(delta);\r\n        }\r\n        const afterUpdate = this.clock.now();\r\n        this.currentFrameLagMs = this._lagMs;\r\n        this._draw(delta);\r\n        const afterDraw = this.clock.now();\r\n        this.stats.currFrame.duration.update = afterUpdate - beforeUpdate;\r\n        this.stats.currFrame.duration.draw = afterDraw - afterUpdate;\r\n        this.stats.currFrame.graphics.drawnImages = GraphicsDiagnostics.DrawnImagesCount;\r\n        this.stats.currFrame.graphics.drawCalls = GraphicsDiagnostics.DrawCallCount;\r\n        this.emit('postframe', new PostFrameEvent(this, this.stats.currFrame));\r\n        this.stats.prevFrame.reset(this.stats.currFrame);\r\n        this._monitorPerformanceThresholdAndTriggerFallback();\r\n    }\r\n    /**\r\n     * Stops Excalibur's main loop, useful for pausing the game.\r\n     */\r\n    stop() {\r\n        if (this.clock.isRunning()) {\r\n            this.emit('stop', new GameStopEvent(this));\r\n            this.browser.pause();\r\n            this.clock.stop();\r\n            this._logger.debug('Game stopped');\r\n        }\r\n    }\r\n    /**\r\n     * Returns the Engine's running status, Useful for checking whether engine is running or paused.\r\n     */\r\n    isRunning() {\r\n        return this.clock.isRunning();\r\n    }\r\n    /**\r\n     * Takes a screen shot of the current viewport and returns it as an\r\n     * HTML Image Element.\r\n     * @param preserveHiDPIResolution in the case of HiDPI return the full scaled backing image, by default false\r\n     */\r\n    screenshot(preserveHiDPIResolution = false) {\r\n        const screenShotPromise = new Promise((resolve) => {\r\n            this._screenShotRequests.push({ preserveHiDPIResolution, resolve });\r\n        });\r\n        return screenShotPromise;\r\n    }\r\n    _checkForScreenShots() {\r\n        // We must grab the draw buffer before we yield to the browser\r\n        // the draw buffer is cleared after compositing\r\n        // the reason for the asynchrony is setting `preserveDrawingBuffer: true`\r\n        // forces the browser to copy buffers which can have a mass perf impact on mobile\r\n        for (const request of this._screenShotRequests) {\r\n            const finalWidth = request.preserveHiDPIResolution ? this.canvas.width : this.screen.resolution.width;\r\n            const finalHeight = request.preserveHiDPIResolution ? this.canvas.height : this.screen.resolution.height;\r\n            const screenshot = document.createElement('canvas');\r\n            screenshot.width = finalWidth;\r\n            screenshot.height = finalHeight;\r\n            const ctx = screenshot.getContext('2d');\r\n            ctx.imageSmoothingEnabled = this.screen.antialiasing;\r\n            ctx.drawImage(this.canvas, 0, 0, finalWidth, finalHeight);\r\n            const result = new Image();\r\n            const raw = screenshot.toDataURL('image/png');\r\n            result.src = raw;\r\n            request.resolve(result);\r\n        }\r\n        // Reset state\r\n        this._screenShotRequests.length = 0;\r\n    }\r\n    /**\r\n     * Another option available to you to load resources into the game.\r\n     * Immediately after calling this the game will pause and the loading screen\r\n     * will appear.\r\n     * @param loader  Some [[Loadable]] such as a [[Loader]] collection, [[Sound]], or [[Texture]].\r\n     */\r\n    async load(loader) {\r\n        try {\r\n            await loader.load();\r\n        }\r\n        catch (e) {\r\n            this._logger.error('Error loading resources, things may not behave properly', e);\r\n            await Promise.resolve();\r\n        }\r\n    }\r\n}\r\n/**\r\n * Default [[EngineOptions]]\r\n */\r\nEngine._DEFAULT_ENGINE_OPTIONS = {\r\n    width: 0,\r\n    height: 0,\r\n    enableCanvasTransparency: true,\r\n    useDrawSorting: true,\r\n    configurePerformanceCanvas2DFallback: {\r\n        allow: true,\r\n        showPlayerMessage: false,\r\n        threshold: { fps: 20, numberOfFrames: 100 }\r\n    },\r\n    canvasElementId: '',\r\n    canvasElement: undefined,\r\n    snapToPixel: false,\r\n    pointerScope: PointerScope.Canvas,\r\n    suppressConsoleBootMessage: null,\r\n    suppressMinimumBrowserFeatureDetection: null,\r\n    suppressHiDPIScaling: null,\r\n    suppressPlayButton: null,\r\n    grabWindowFocus: true,\r\n    scrollPreventionMode: ScrollPreventionMode.Canvas,\r\n    backgroundColor: Color.fromHex('#2185d0') // Excalibur blue\r\n};\r\n\n;// CONCATENATED MODULE: ./Math/Index.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Debug/index.ts\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./EventDispatcher.ts\n\r\n/**\r\n * @deprecated Use [[EventEmitter]] will be removed in v0.29.0\r\n */\r\nclass EventDispatcher {\r\n    constructor() {\r\n        this._handlers = {};\r\n        this._wiredEventDispatchers = [];\r\n        this._deferedHandlerRemovals = [];\r\n    }\r\n    /**\r\n     * Clears any existing handlers or wired event dispatchers on this event dispatcher\r\n     */\r\n    clear() {\r\n        this._handlers = {};\r\n        this._wiredEventDispatchers = [];\r\n    }\r\n    _processDeferredHandlerRemovals() {\r\n        for (const eventHandler of this._deferedHandlerRemovals) {\r\n            this._removeHandler(eventHandler.name, eventHandler.handler);\r\n        }\r\n        this._deferedHandlerRemovals.length = 0;\r\n    }\r\n    /**\r\n     * Emits an event for target\r\n     * @param eventName  The name of the event to publish\r\n     * @param event      Optionally pass an event data object to the handler\r\n     */\r\n    emit(eventName, event) {\r\n        this._processDeferredHandlerRemovals();\r\n        if (!eventName) {\r\n            // key not mapped\r\n            return;\r\n        }\r\n        eventName = eventName.toLowerCase();\r\n        if (typeof event === 'undefined' || event === null) {\r\n            event = new GameEvent();\r\n        }\r\n        let i, len;\r\n        if (this._handlers[eventName]) {\r\n            i = 0;\r\n            len = this._handlers[eventName].length;\r\n            for (i; i < len; i++) {\r\n                this._handlers[eventName][i](event);\r\n            }\r\n        }\r\n        i = 0;\r\n        len = this._wiredEventDispatchers.length;\r\n        for (i; i < len; i++) {\r\n            this._wiredEventDispatchers[i].emit(eventName, event);\r\n        }\r\n    }\r\n    /**\r\n     * Subscribe an event handler to a particular event name, multiple handlers per event name are allowed.\r\n     * @param eventName  The name of the event to subscribe to\r\n     * @param handler    The handler callback to fire on this event\r\n     */\r\n    on(eventName, handler) {\r\n        this._processDeferredHandlerRemovals();\r\n        eventName = eventName.toLowerCase();\r\n        if (!this._handlers[eventName]) {\r\n            this._handlers[eventName] = [];\r\n        }\r\n        this._handlers[eventName].push(handler);\r\n    }\r\n    /**\r\n     * Unsubscribe an event handler(s) from an event. If a specific handler\r\n     * is specified for an event, only that handler will be unsubscribed.\r\n     * Otherwise all handlers will be unsubscribed for that event.\r\n     *\r\n     * @param eventName  The name of the event to unsubscribe\r\n     * @param handler    Optionally the specific handler to unsubscribe\r\n     */\r\n    off(eventName, handler) {\r\n        this._deferedHandlerRemovals.push({ name: eventName, handler });\r\n    }\r\n    _removeHandler(eventName, handler) {\r\n        eventName = eventName.toLowerCase();\r\n        const eventHandlers = this._handlers[eventName];\r\n        if (eventHandlers) {\r\n            // if no explicit handler is give with the event name clear all handlers\r\n            if (!handler) {\r\n                this._handlers[eventName].length = 0;\r\n            }\r\n            else {\r\n                const index = eventHandlers.indexOf(handler);\r\n                if (index > -1) {\r\n                    this._handlers[eventName].splice(index, 1);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Once listens to an event one time, then unsubscribes from that event\r\n     *\r\n     * @param eventName The name of the event to subscribe to once\r\n     * @param handler   The handler of the event that will be auto unsubscribed\r\n     */\r\n    once(eventName, handler) {\r\n        this._processDeferredHandlerRemovals();\r\n        const metaHandler = (event) => {\r\n            const ev = event || new GameEvent();\r\n            this.off(eventName, metaHandler);\r\n            handler(ev);\r\n        };\r\n        this.on(eventName, metaHandler);\r\n    }\r\n    /**\r\n     * Wires this event dispatcher to also receive events from another\r\n     */\r\n    wire(eventDispatcher) {\r\n        eventDispatcher._wiredEventDispatchers.push(this);\r\n    }\r\n    /**\r\n     * Unwires this event dispatcher from another\r\n     */\r\n    unwire(eventDispatcher) {\r\n        const index = eventDispatcher._wiredEventDispatchers.indexOf(this);\r\n        if (index > -1) {\r\n            eventDispatcher._wiredEventDispatchers.splice(index, 1);\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Label.ts\n\r\n\r\n\r\n\r\n\r\n/**\r\n * Labels are the way to draw small amounts of text to the screen. They are\r\n * actors and inherit all of the benefits and capabilities.\r\n */\r\nclass Label extends Actor {\r\n    get font() {\r\n        return this._font;\r\n    }\r\n    set font(newFont) {\r\n        this._font = newFont;\r\n        this._text.font = newFont;\r\n    }\r\n    /**\r\n     * The text to draw.\r\n     */\r\n    get text() {\r\n        return this._text.text;\r\n    }\r\n    set text(text) {\r\n        this._text.text = text;\r\n    }\r\n    get color() {\r\n        return this._text.color;\r\n    }\r\n    set color(color) {\r\n        if (this._text) {\r\n            this._text.color = color;\r\n        }\r\n    }\r\n    get opacity() {\r\n        return this._text.opacity;\r\n    }\r\n    set opacity(opacity) {\r\n        this._text.opacity = opacity;\r\n    }\r\n    /**\r\n     * The [[SpriteFont]] to use, if any. Overrides [[Font|font]] if present.\r\n     */\r\n    get spriteFont() {\r\n        return this._spriteFont;\r\n    }\r\n    set spriteFont(sf) {\r\n        if (sf) {\r\n            this._spriteFont = sf;\r\n            this._text.font = this._spriteFont;\r\n        }\r\n    }\r\n    /**\r\n     * Build a new label\r\n     * @param options\r\n     */\r\n    constructor(options) {\r\n        super(options);\r\n        this._font = new Font();\r\n        this._text = new Text({ text: '', font: this._font });\r\n        const { text, pos, x, y, spriteFont, font, color } = options;\r\n        this.pos = pos !== null && pos !== void 0 ? pos : (x && y ? vec(x, y) : this.pos);\r\n        this.text = text !== null && text !== void 0 ? text : this.text;\r\n        this.font = font !== null && font !== void 0 ? font : this.font;\r\n        this.spriteFont = spriteFont !== null && spriteFont !== void 0 ? spriteFont : this.spriteFont;\r\n        this._text.color = color !== null && color !== void 0 ? color : this.color;\r\n        const gfx = this.get(GraphicsComponent);\r\n        gfx.anchor = Vector.Zero;\r\n        gfx.use(this._text);\r\n    }\r\n    _initialize(engine) {\r\n        super._initialize(engine);\r\n    }\r\n    /**\r\n     * Returns the width of the text in the label (in pixels);\r\n     */\r\n    getTextWidth() {\r\n        return this._text.width;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./TileMap/IsometricMap.ts\n\r\n\r\n\r\n\r\n\r\nclass IsometricTile extends Entity {\r\n    getGraphics() {\r\n        return this._graphics;\r\n    }\r\n    /**\r\n     * Tile graphics\r\n     */\r\n    addGraphic(graphic) {\r\n        this._graphics.push(graphic);\r\n        this._gfx.visible = true;\r\n        this._gfx.localBounds = this._recalculateBounds();\r\n    }\r\n    _recalculateBounds() {\r\n        let bounds = this._tileBounds.clone();\r\n        for (const graphic of this._graphics) {\r\n            const offset = vec(this.map.graphicsOffset.x - this.map.tileWidth / 2, this.map.graphicsOffset.y - (this.map.renderFromTopOfGraphic ? 0 : (graphic.height - this.map.tileHeight)));\r\n            bounds = bounds.combine(graphic.localBounds.translate(offset));\r\n        }\r\n        return bounds;\r\n    }\r\n    removeGraphic(graphic) {\r\n        const index = this._graphics.indexOf(graphic);\r\n        if (index > -1) {\r\n            this._graphics.splice(index, 1);\r\n        }\r\n        this._gfx.localBounds = this._recalculateBounds();\r\n    }\r\n    clearGraphics() {\r\n        this._graphics.length = 0;\r\n        this._gfx.visible = false;\r\n        this._gfx.localBounds = this._recalculateBounds();\r\n    }\r\n    getColliders() {\r\n        return this._colliders;\r\n    }\r\n    /**\r\n     * Adds a collider to the IsometricTile\r\n     *\r\n     * **Note!** the [[Tile.solid]] must be set to true for it to act as a \"fixed\" collider\r\n     * @param collider\r\n     */\r\n    addCollider(collider) {\r\n        this._colliders.push(collider);\r\n        this.map.flagCollidersDirty();\r\n    }\r\n    /**\r\n     * Removes a collider from the IsometricTile\r\n     * @param collider\r\n     */\r\n    removeCollider(collider) {\r\n        const index = this._colliders.indexOf(collider);\r\n        if (index > -1) {\r\n            this._colliders.splice(index, 1);\r\n        }\r\n        this.map.flagCollidersDirty();\r\n    }\r\n    /**\r\n     * Clears all colliders from the IsometricTile\r\n     */\r\n    clearColliders() {\r\n        this._colliders.length = 0;\r\n        this.map.flagCollidersDirty();\r\n    }\r\n    /**\r\n     * Returns the top left corner of the [[IsometricTile]] in world space\r\n     */\r\n    get pos() {\r\n        return this.map.tileToWorld(vec(this.x, this.y));\r\n    }\r\n    /**\r\n     * Returns the center of the [[IsometricTile]]\r\n     */\r\n    get center() {\r\n        return this.pos.add(vec(0, this.map.tileHeight / 2));\r\n    }\r\n    /**\r\n     * Construct a new IsometricTile\r\n     * @param x tile coordinate in x (not world position)\r\n     * @param y tile coordinate in y (not world position)\r\n     * @param graphicsOffset offset that tile should be shifted by (default (0, 0))\r\n     * @param map reference to owning IsometricMap\r\n     */\r\n    constructor(x, y, graphicsOffset, map) {\r\n        super([\r\n            new TransformComponent(),\r\n            new GraphicsComponent({\r\n                offset: graphicsOffset !== null && graphicsOffset !== void 0 ? graphicsOffset : Vector.Zero,\r\n                onPostDraw: (gfx, elapsed) => this.draw(gfx, elapsed)\r\n            }),\r\n            new IsometricEntityComponent(map)\r\n        ]);\r\n        /**\r\n         * Indicates whether this tile is solid\r\n         */\r\n        this.solid = false;\r\n        this._tileBounds = new BoundingBox();\r\n        this._graphics = [];\r\n        /**\r\n         * Tile colliders\r\n         */\r\n        this._colliders = [];\r\n        this.x = x;\r\n        this.y = y;\r\n        this.map = map;\r\n        this._transform = this.get(TransformComponent);\r\n        this._isometricEntityComponent = this.get(IsometricEntityComponent);\r\n        const halfTileWidth = this.map.tileWidth / 2;\r\n        const halfTileHeight = this.map.tileHeight / 2;\r\n        // See https://clintbellanger.net/articles/isometric_math/ for formula\r\n        // The x position shifts left with every y step\r\n        const xPos = (this.x - this.y) * halfTileWidth;\r\n        // The y position needs to go down with every x step\r\n        const yPos = (this.x + this.y) * halfTileHeight;\r\n        this._transform.pos = vec(xPos, yPos);\r\n        this._isometricEntityComponent.elevation = 0;\r\n        this._gfx = this.get(GraphicsComponent);\r\n        this._gfx.visible = false; // start not visible\r\n        const totalWidth = this.map.tileWidth;\r\n        const totalHeight = this.map.tileHeight;\r\n        // initial guess at gfx bounds based on the tile\r\n        const offset = vec(0, (this.map.renderFromTopOfGraphic ? totalHeight : 0));\r\n        this._gfx.localBounds = this._tileBounds = new BoundingBox({\r\n            left: -totalWidth / 2,\r\n            top: -totalHeight,\r\n            right: totalWidth / 2,\r\n            bottom: totalHeight\r\n        }).translate(offset);\r\n    }\r\n    draw(gfx, _elapsed) {\r\n        const halfTileWidth = this.map.tileWidth / 2;\r\n        gfx.save();\r\n        // shift left origin to corner of map, not the left corner of the first sprite\r\n        gfx.translate(-halfTileWidth, 0);\r\n        for (const graphic of this._graphics) {\r\n            graphic.draw(gfx, this.map.graphicsOffset.x, this.map.graphicsOffset.y - (this.map.renderFromTopOfGraphic ? 0 : (graphic.height - this.map.tileHeight)));\r\n        }\r\n        gfx.restore();\r\n    }\r\n}\r\n/**\r\n * The IsometricMap is a special tile map that provides isometric rendering support to Excalibur\r\n *\r\n * The tileWidth and tileHeight should be the height and width in pixels of the parallelogram of the base of the tile art asset.\r\n * The tileWidth and tileHeight is not necessarily the same as your graphic pixel width and height.\r\n *\r\n * Please refer to the docs https://excaliburjs.com for more details calculating what your tile width and height should be given\r\n * your art assets.\r\n */\r\nclass IsometricMap extends Entity {\r\n    constructor(options) {\r\n        super([\r\n            new TransformComponent(),\r\n            new BodyComponent({\r\n                type: CollisionType.Fixed\r\n            }),\r\n            new ColliderComponent(),\r\n            new DebugGraphicsComponent((ctx) => this.debug(ctx), false)\r\n        ], options.name);\r\n        /**\r\n         * Render the tile graphic from the top instead of the bottom\r\n         *\r\n         * default is `false` meaning rendering from the bottom\r\n         */\r\n        this.renderFromTopOfGraphic = false;\r\n        this.graphicsOffset = vec(0, 0);\r\n        this._collidersDirty = false;\r\n        this._originalOffsets = new WeakMap();\r\n        const { pos, tileWidth, tileHeight, columns: width, rows: height, renderFromTopOfGraphic, graphicsOffset } = options;\r\n        this.transform = this.get(TransformComponent);\r\n        if (pos) {\r\n            this.transform.pos = pos;\r\n        }\r\n        this.collider = this.get(ColliderComponent);\r\n        if (this.collider) {\r\n            this.collider.set(this._composite = new CompositeCollider([]));\r\n        }\r\n        this.renderFromTopOfGraphic = renderFromTopOfGraphic !== null && renderFromTopOfGraphic !== void 0 ? renderFromTopOfGraphic : this.renderFromTopOfGraphic;\r\n        this.graphicsOffset = graphicsOffset !== null && graphicsOffset !== void 0 ? graphicsOffset : this.graphicsOffset;\r\n        this.tileWidth = tileWidth;\r\n        this.tileHeight = tileHeight;\r\n        this.columns = width;\r\n        this.rows = height;\r\n        this.tiles = new Array(width * height);\r\n        // build up tile representation\r\n        for (let y = 0; y < height; y++) {\r\n            for (let x = 0; x < width; x++) {\r\n                const tile = new IsometricTile(x, y, this.graphicsOffset, this);\r\n                this.tiles[x + y * width] = tile;\r\n                this.addChild(tile);\r\n                // TODO row/columns helpers\r\n            }\r\n        }\r\n    }\r\n    update() {\r\n        if (this._collidersDirty) {\r\n            this.updateColliders();\r\n            this._collidersDirty = false;\r\n        }\r\n    }\r\n    flagCollidersDirty() {\r\n        this._collidersDirty = true;\r\n    }\r\n    _getOrSetColliderOriginalOffset(collider) {\r\n        if (!this._originalOffsets.has(collider)) {\r\n            const originalOffset = collider.offset;\r\n            this._originalOffsets.set(collider, originalOffset);\r\n            return originalOffset;\r\n        }\r\n        else {\r\n            return this._originalOffsets.get(collider);\r\n        }\r\n    }\r\n    updateColliders() {\r\n        this._composite.clearColliders();\r\n        const pos = this.get(TransformComponent).pos;\r\n        for (const tile of this.tiles) {\r\n            if (tile.solid) {\r\n                for (const collider of tile.getColliders()) {\r\n                    const originalOffset = this._getOrSetColliderOriginalOffset(collider);\r\n                    collider.offset = this.tileToWorld(vec(tile.x, tile.y))\r\n                        .sub(pos)\r\n                        .add(originalOffset)\r\n                        .sub(vec(this.tileWidth / 2, this.tileHeight)); // We need to unshift height based on drawing\r\n                    collider.owner = this;\r\n                    this._composite.addCollider(collider);\r\n                }\r\n            }\r\n        }\r\n        this.collider.update();\r\n    }\r\n    /**\r\n     * Convert world space coordinates to the tile x, y coordinate\r\n     * @param worldCoordinate\r\n     */\r\n    worldToTile(worldCoordinate) {\r\n        worldCoordinate = worldCoordinate.sub(this.transform.globalPos);\r\n        const halfTileWidth = this.tileWidth / 2;\r\n        const halfTileHeight = this.tileHeight / 2;\r\n        // See https://clintbellanger.net/articles/isometric_math/ for formula\r\n        return vec(~~((worldCoordinate.x / halfTileWidth + (worldCoordinate.y / halfTileHeight)) / 2), ~~((worldCoordinate.y / halfTileHeight - (worldCoordinate.x / halfTileWidth)) / 2));\r\n    }\r\n    /**\r\n     * Given a tile coordinate, return the top left corner in world space\r\n     * @param tileCoordinate\r\n     */\r\n    tileToWorld(tileCoordinate) {\r\n        const halfTileWidth = this.tileWidth / 2;\r\n        const halfTileHeight = this.tileHeight / 2;\r\n        // The x position shifts left with every y step\r\n        const xPos = (tileCoordinate.x - tileCoordinate.y) * halfTileWidth;\r\n        // The y position needs to go down with every x step\r\n        const yPos = (tileCoordinate.x + tileCoordinate.y) * halfTileHeight;\r\n        return vec(xPos, yPos).add(this.transform.pos);\r\n    }\r\n    /**\r\n     * Returns the [[IsometricTile]] by its x and y coordinates\r\n     */\r\n    getTile(x, y) {\r\n        if (x < 0 || y < 0 || x >= this.columns || y >= this.rows) {\r\n            return null;\r\n        }\r\n        return this.tiles[x + y * this.columns];\r\n    }\r\n    /**\r\n     * Returns the [[IsometricTile]] by testing a point in world coordinates,\r\n     * returns `null` if no Tile was found.\r\n     */\r\n    getTileByPoint(point) {\r\n        const tileCoord = this.worldToTile(point);\r\n        const tile = this.getTile(tileCoord.x, tileCoord.y);\r\n        return tile;\r\n    }\r\n    _getMaxZIndex() {\r\n        let maxZ = Number.NEGATIVE_INFINITY;\r\n        for (const tile of this.tiles) {\r\n            const currentZ = tile.get(TransformComponent).z;\r\n            if (currentZ > maxZ) {\r\n                maxZ = currentZ;\r\n            }\r\n        }\r\n        return maxZ;\r\n    }\r\n    /**\r\n     * Debug draw for IsometricMap, called internally by excalibur when debug mode is toggled on\r\n     * @param gfx\r\n     */\r\n    debug(gfx) {\r\n        gfx.save();\r\n        gfx.z = this._getMaxZIndex() + 0.5;\r\n        for (let y = 0; y < this.rows + 1; y++) {\r\n            const left = this.tileToWorld(vec(0, y));\r\n            const right = this.tileToWorld(vec(this.columns, y));\r\n            gfx.drawLine(left, right, Color.Red, 2);\r\n        }\r\n        for (let x = 0; x < this.columns + 1; x++) {\r\n            const top = this.tileToWorld(vec(x, 0));\r\n            const bottom = this.tileToWorld(vec(x, this.rows));\r\n            gfx.drawLine(top, bottom, Color.Red, 2);\r\n        }\r\n        for (const tile of this.tiles) {\r\n            gfx.drawCircle(this.tileToWorld(vec(tile.x, tile.y)), 3, Color.Yellow);\r\n        }\r\n        gfx.restore();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./TileMap/index.ts\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Actions/Action/ActionSequence.ts\n\r\n/**\r\n * Action that can represent a sequence of actions, this can be useful in conjunction with\r\n * [[ParallelActions]] to run multiple sequences in parallel.\r\n */\r\nclass ActionSequence {\r\n    constructor(entity, actionBuilder) {\r\n        this._stopped = false;\r\n        this._sequenceBuilder = actionBuilder;\r\n        this._sequenceContext = new ActionContext(entity);\r\n        this._actionQueue = this._sequenceContext.getQueue();\r\n        this._sequenceBuilder(this._sequenceContext);\r\n    }\r\n    update(delta) {\r\n        this._actionQueue.update(delta);\r\n    }\r\n    isComplete() {\r\n        return this._stopped || this._actionQueue.isComplete();\r\n    }\r\n    stop() {\r\n        this._stopped = true;\r\n    }\r\n    reset() {\r\n        this._stopped = false;\r\n        this._actionQueue.reset();\r\n    }\r\n    clone(entity) {\r\n        return new ActionSequence(entity, this._sequenceBuilder);\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Action/ParallelActions.ts\n/**\r\n * Action that can run multiple [[Action]]s or [[ActionSequence]]s at the same time\r\n */\r\nclass ParallelActions {\r\n    constructor(parallelActions) {\r\n        this._actions = parallelActions;\r\n    }\r\n    update(delta) {\r\n        for (let i = 0; i < this._actions.length; i++) {\r\n            this._actions[i].update(delta);\r\n        }\r\n    }\r\n    isComplete(entity) {\r\n        return this._actions.every(a => a.isComplete(entity));\r\n    }\r\n    reset() {\r\n        this._actions.forEach(a => a.reset());\r\n    }\r\n    stop() {\r\n        this._actions.forEach(a => a.stop());\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Actions/Index.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Collision/Group/CollisionGroupManager.ts\n\r\n/**\r\n * Static class for managing collision groups in excalibur, there is a maximum of 32 collision groups possible in excalibur\r\n */\r\nclass CollisionGroupManager {\r\n    /**\r\n     * Create a new named collision group up to a max of 32.\r\n     * @param name Name for the collision group\r\n     * @param mask Optionally provide your own 32-bit mask, if none is provide the manager will generate one\r\n     */\r\n    static create(name, mask) {\r\n        if (this._CURRENT_GROUP > this._MAX_GROUPS) {\r\n            throw new Error(`Cannot have more than ${this._MAX_GROUPS} collision groups`);\r\n        }\r\n        if (this._GROUPS.get(name)) {\r\n            throw new Error(`Collision group ${name} already exists`);\r\n        }\r\n        const group = new CollisionGroup(name, this._CURRENT_BIT, mask !== undefined ? mask : ~this._CURRENT_BIT);\r\n        this._CURRENT_BIT = (this._CURRENT_BIT << 1) | 0;\r\n        this._CURRENT_GROUP++;\r\n        this._GROUPS.set(name, group);\r\n        return group;\r\n    }\r\n    /**\r\n     * Get all collision groups currently tracked by excalibur\r\n     */\r\n    static get groups() {\r\n        return Array.from(this._GROUPS.values());\r\n    }\r\n    /**\r\n     * Get a collision group by it's name\r\n     * @param name\r\n     */\r\n    static groupByName(name) {\r\n        return this._GROUPS.get(name);\r\n    }\r\n    /**\r\n     * Resets the managers internal group management state\r\n     */\r\n    static reset() {\r\n        this._GROUPS = new Map();\r\n        this._CURRENT_BIT = this._STARTING_BIT;\r\n        this._CURRENT_GROUP = 1;\r\n    }\r\n}\r\n// using bitmasking the maximum number of groups is 32, because that is the highest 32bit integer that JS can present.\r\nCollisionGroupManager._STARTING_BIT = 0b1 | 0;\r\nCollisionGroupManager._MAX_GROUPS = 32;\r\nCollisionGroupManager._CURRENT_GROUP = 1;\r\nCollisionGroupManager._CURRENT_BIT = CollisionGroupManager._STARTING_BIT;\r\nCollisionGroupManager._GROUPS = new Map();\r\n\n;// CONCATENATED MODULE: ./Collision/Index.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Interfaces/LifecycleEvents.ts\n/**\r\n * Type guard checking for internal initialize method\r\n * @internal\r\n * @param a\r\n */\r\nfunction has_initialize(a) {\r\n    return !!a._initialize;\r\n}\r\n/**\r\n *\r\n */\r\nfunction hasOnInitialize(a) {\r\n    return !!a.onInitialize;\r\n}\r\n/**\r\n *\r\n */\r\nfunction has_preupdate(a) {\r\n    return !!a._preupdate;\r\n}\r\n/**\r\n *\r\n */\r\nfunction hasOnPreUpdate(a) {\r\n    return !!a.onPreUpdate;\r\n}\r\n/**\r\n *\r\n */\r\nfunction has_postupdate(a) {\r\n    return !!a.onPostUpdate;\r\n}\r\n/**\r\n *\r\n */\r\nfunction hasOnPostUpdate(a) {\r\n    return !!a.onPostUpdate;\r\n}\r\n/**\r\n *\r\n */\r\nfunction hasPreDraw(a) {\r\n    return !!a.onPreDraw;\r\n}\r\n/**\r\n *\r\n */\r\nfunction hasPostDraw(a) {\r\n    return !!a.onPostDraw;\r\n}\r\n\n;// CONCATENATED MODULE: ./Interfaces/Index.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Resources/Sound/Index.ts\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Resources/Gif.ts\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * The [[Texture]] object allows games built in Excalibur to load image resources.\r\n * [[Texture]] is an [[Loadable]] which means it can be passed to a [[Loader]]\r\n * to pre-load before starting a level or game.\r\n */\r\nclass Gif {\r\n    /**\r\n     * @param path       Path to the image resource\r\n     * @param color      Optionally set the color to treat as transparent the gif, by default [[Color.Magenta]]\r\n     * @param bustCache  Optionally load texture with cache busting\r\n     */\r\n    constructor(path, color = Color.Magenta, bustCache = false) {\r\n        this.path = path;\r\n        this.color = color;\r\n        this._stream = null;\r\n        this._gif = null;\r\n        this._textures = [];\r\n        this._animation = null;\r\n        this._transparentColor = null;\r\n        this._resource = new Resource(path, 'arraybuffer', bustCache);\r\n        this._transparentColor = color;\r\n    }\r\n    /**\r\n     * Should excalibur add a cache busting querystring? By default false.\r\n     * Must be set before loading\r\n     */\r\n    get bustCache() {\r\n        return this._resource.bustCache;\r\n    }\r\n    set bustCache(val) {\r\n        this._resource.bustCache = val;\r\n    }\r\n    /**\r\n     * Begins loading the texture and returns a promise to be resolved on completion\r\n     */\r\n    async load() {\r\n        const arraybuffer = await this._resource.load();\r\n        this._stream = new Stream(arraybuffer);\r\n        this._gif = new ParseGif(this._stream, this._transparentColor);\r\n        const images = this._gif.images.map(i => new ImageSource(i.src, false));\r\n        // Load all textures\r\n        await Promise.all(images.map(t => t.load()));\r\n        return this.data = this._textures = images;\r\n    }\r\n    isLoaded() {\r\n        return !!this.data;\r\n    }\r\n    /**\r\n     * Return a frame of the gif as a sprite by id\r\n     * @param id\r\n     */\r\n    toSprite(id = 0) {\r\n        const sprite = this._textures[id].toSprite();\r\n        return sprite;\r\n    }\r\n    /**\r\n     * Return the gif as a spritesheet\r\n     */\r\n    toSpriteSheet() {\r\n        const sprites = this._textures.map((image) => {\r\n            return image.toSprite();\r\n        });\r\n        return new SpriteSheet({ sprites });\r\n    }\r\n    /**\r\n     * Transform the GIF into an animation with duration per frame\r\n     */\r\n    toAnimation(durationPerFrameMs) {\r\n        const spriteSheet = this.toSpriteSheet();\r\n        const length = spriteSheet.sprites.length;\r\n        this._animation = Animation.fromSpriteSheet(spriteSheet, range(0, length), durationPerFrameMs);\r\n        return this._animation;\r\n    }\r\n    get readCheckBytes() {\r\n        return this._gif.checkBytes;\r\n    }\r\n}\r\nconst bitsToNum = (ba) => {\r\n    return ba.reduce(function (s, n) {\r\n        return s * 2 + n;\r\n    }, 0);\r\n};\r\nconst byteToBitArr = (bite) => {\r\n    const a = [];\r\n    for (let i = 7; i >= 0; i--) {\r\n        a.push(!!(bite & (1 << i)));\r\n    }\r\n    return a;\r\n};\r\nclass Stream {\r\n    constructor(dataArray) {\r\n        this.data = null;\r\n        this.len = 0;\r\n        this.position = 0;\r\n        this.readByte = () => {\r\n            if (this.position >= this.data.byteLength) {\r\n                throw new Error('Attempted to read past end of stream.');\r\n            }\r\n            return this.data[this.position++];\r\n        };\r\n        this.readBytes = (n) => {\r\n            const bytes = [];\r\n            for (let i = 0; i < n; i++) {\r\n                bytes.push(this.readByte());\r\n            }\r\n            return bytes;\r\n        };\r\n        this.read = (n) => {\r\n            let s = '';\r\n            for (let i = 0; i < n; i++) {\r\n                s += String.fromCharCode(this.readByte());\r\n            }\r\n            return s;\r\n        };\r\n        this.readUnsigned = () => {\r\n            // Little-endian.\r\n            const a = this.readBytes(2);\r\n            return (a[1] << 8) + a[0];\r\n        };\r\n        this.data = new Uint8Array(dataArray);\r\n        this.len = this.data.byteLength;\r\n        if (this.len === 0) {\r\n            throw new Error('No data loaded from file');\r\n        }\r\n    }\r\n}\r\nconst lzwDecode = function (minCodeSize, data) {\r\n    // TODO: Now that the GIF parser is a bit different, maybe this should get an array of bytes instead of a String?\r\n    let pos = 0; // Maybe this streaming thing should be merged with the Stream?\r\n    const readCode = function (size) {\r\n        let code = 0;\r\n        for (let i = 0; i < size; i++) {\r\n            if (data.charCodeAt(pos >> 3) & (1 << (pos & 7))) {\r\n                code |= 1 << i;\r\n            }\r\n            pos++;\r\n        }\r\n        return code;\r\n    };\r\n    const output = [];\r\n    const clearCode = 1 << minCodeSize;\r\n    const eoiCode = clearCode + 1;\r\n    let codeSize = minCodeSize + 1;\r\n    let dict = [];\r\n    const clear = function () {\r\n        dict = [];\r\n        codeSize = minCodeSize + 1;\r\n        for (let i = 0; i < clearCode; i++) {\r\n            dict[i] = [i];\r\n        }\r\n        dict[clearCode] = [];\r\n        dict[eoiCode] = null;\r\n    };\r\n    let code;\r\n    let last;\r\n    while (true) {\r\n        last = code;\r\n        code = readCode(codeSize);\r\n        if (code === clearCode) {\r\n            clear();\r\n            continue;\r\n        }\r\n        if (code === eoiCode) {\r\n            break;\r\n        }\r\n        if (code < dict.length) {\r\n            if (last !== clearCode) {\r\n                dict.push(dict[last].concat(dict[code][0]));\r\n            }\r\n        }\r\n        else {\r\n            if (code !== dict.length) {\r\n                throw new Error('Invalid LZW code.');\r\n            }\r\n            dict.push(dict[last].concat(dict[last][0]));\r\n        }\r\n        output.push.apply(output, dict[code]);\r\n        if (dict.length === 1 << codeSize && codeSize < 12) {\r\n            // If we're at the last code and codeSize is 12, the next code will be a clearCode, and it'll be 12 bits long.\r\n            codeSize++;\r\n        }\r\n    }\r\n    // I don't know if this is technically an error, but some GIFs do it.\r\n    //if (Math.ceil(pos / 8) !== data.length) throw new Error('Extraneous LZW bytes.');\r\n    return output;\r\n};\r\n// The actual parsing; returns an object with properties.\r\nclass ParseGif {\r\n    constructor(stream, color = Color.Magenta) {\r\n        this._st = null;\r\n        this._handler = {};\r\n        this._transparentColor = null;\r\n        this.frames = [];\r\n        this.images = [];\r\n        this.globalColorTable = [];\r\n        this.checkBytes = [];\r\n        // LZW (GIF-specific)\r\n        this.parseColorTable = (entries) => {\r\n            // Each entry is 3 bytes, for RGB.\r\n            const ct = [];\r\n            for (let i = 0; i < entries; i++) {\r\n                const rgb = this._st.readBytes(3);\r\n                const rgba = '#' +\r\n                    rgb\r\n                        .map((x) => {\r\n                        const hex = x.toString(16);\r\n                        return hex.length === 1 ? '0' + hex : hex;\r\n                    })\r\n                        .join('');\r\n                ct.push(rgba);\r\n            }\r\n            return ct;\r\n        };\r\n        this.readSubBlocks = () => {\r\n            let size, data;\r\n            data = '';\r\n            do {\r\n                size = this._st.readByte();\r\n                data += this._st.read(size);\r\n            } while (size !== 0);\r\n            return data;\r\n        };\r\n        this.parseHeader = () => {\r\n            const hdr = {\r\n                sig: null,\r\n                ver: null,\r\n                width: null,\r\n                height: null,\r\n                colorRes: null,\r\n                globalColorTableSize: null,\r\n                gctFlag: null,\r\n                sorted: null,\r\n                globalColorTable: [],\r\n                bgColor: null,\r\n                pixelAspectRatio: null // if not 0, aspectRatio = (pixelAspectRatio + 15) / 64\r\n            };\r\n            hdr.sig = this._st.read(3);\r\n            hdr.ver = this._st.read(3);\r\n            if (hdr.sig !== 'GIF') {\r\n                throw new Error('Not a GIF file.'); // XXX: This should probably be handled more nicely.\r\n            }\r\n            hdr.width = this._st.readUnsigned();\r\n            hdr.height = this._st.readUnsigned();\r\n            const bits = byteToBitArr(this._st.readByte());\r\n            hdr.gctFlag = bits.shift();\r\n            hdr.colorRes = bitsToNum(bits.splice(0, 3));\r\n            hdr.sorted = bits.shift();\r\n            hdr.globalColorTableSize = bitsToNum(bits.splice(0, 3));\r\n            hdr.bgColor = this._st.readByte();\r\n            hdr.pixelAspectRatio = this._st.readByte(); // if not 0, aspectRatio = (pixelAspectRatio + 15) / 64\r\n            if (hdr.gctFlag) {\r\n                hdr.globalColorTable = this.parseColorTable(1 << (hdr.globalColorTableSize + 1));\r\n                this.globalColorTable = hdr.globalColorTable;\r\n            }\r\n            if (this._handler.hdr && this._handler.hdr(hdr)) {\r\n                this.checkBytes.push(this._handler.hdr);\r\n            }\r\n        };\r\n        this.parseExt = (block) => {\r\n            const parseGCExt = (block) => {\r\n                this.checkBytes.push(this._st.readByte()); // Always 4\r\n                const bits = byteToBitArr(this._st.readByte());\r\n                block.reserved = bits.splice(0, 3); // Reserved; should be 000.\r\n                block.disposalMethod = bitsToNum(bits.splice(0, 3));\r\n                block.userInput = bits.shift();\r\n                block.transparencyGiven = bits.shift();\r\n                block.delayTime = this._st.readUnsigned();\r\n                block.transparencyIndex = this._st.readByte();\r\n                block.terminator = this._st.readByte();\r\n                if (this._handler.gce && this._handler.gce(block)) {\r\n                    this.checkBytes.push(this._handler.gce);\r\n                }\r\n            };\r\n            const parseComExt = (block) => {\r\n                block.comment = this.readSubBlocks();\r\n                if (this._handler.com && this._handler.com(block)) {\r\n                    this.checkBytes.push(this._handler.com);\r\n                }\r\n            };\r\n            const parsePTExt = (block) => {\r\n                this.checkBytes.push(this._st.readByte()); // Always 12\r\n                block.ptHeader = this._st.readBytes(12);\r\n                block.ptData = this.readSubBlocks();\r\n                if (this._handler.pte && this._handler.pte(block)) {\r\n                    this.checkBytes.push(this._handler.pte);\r\n                }\r\n            };\r\n            const parseAppExt = (block) => {\r\n                const parseNetscapeExt = (block) => {\r\n                    this.checkBytes.push(this._st.readByte()); // Always 3\r\n                    block.unknown = this._st.readByte(); // Q: Always 1? What is this?\r\n                    block.iterations = this._st.readUnsigned();\r\n                    block.terminator = this._st.readByte();\r\n                    if (this._handler.app && this._handler.app.NETSCAPE && this._handler.app.NETSCAPE(block)) {\r\n                        this.checkBytes.push(this._handler.app);\r\n                    }\r\n                };\r\n                const parseUnknownAppExt = (block) => {\r\n                    block.appData = this.readSubBlocks();\r\n                    // FIXME: This won't work if a handler wants to match on any identifier.\r\n                    if (this._handler.app && this._handler.app[block.identifier] && this._handler.app[block.identifier](block)) {\r\n                        this.checkBytes.push(this._handler.app[block.identifier]);\r\n                    }\r\n                };\r\n                this.checkBytes.push(this._st.readByte()); // Always 11\r\n                block.identifier = this._st.read(8);\r\n                block.authCode = this._st.read(3);\r\n                switch (block.identifier) {\r\n                    case 'NETSCAPE':\r\n                        parseNetscapeExt(block);\r\n                        break;\r\n                    default:\r\n                        parseUnknownAppExt(block);\r\n                        break;\r\n                }\r\n            };\r\n            const parseUnknownExt = (block) => {\r\n                block.data = this.readSubBlocks();\r\n                if (this._handler.unknown && this._handler.unknown(block)) {\r\n                    this.checkBytes.push(this._handler.unknown);\r\n                }\r\n            };\r\n            block.label = this._st.readByte();\r\n            switch (block.label) {\r\n                case 0xf9:\r\n                    block.extType = 'gce';\r\n                    parseGCExt(block);\r\n                    break;\r\n                case 0xfe:\r\n                    block.extType = 'com';\r\n                    parseComExt(block);\r\n                    break;\r\n                case 0x01:\r\n                    block.extType = 'pte';\r\n                    parsePTExt(block);\r\n                    break;\r\n                case 0xff:\r\n                    block.extType = 'app';\r\n                    parseAppExt(block);\r\n                    break;\r\n                default:\r\n                    block.extType = 'unknown';\r\n                    parseUnknownExt(block);\r\n                    break;\r\n            }\r\n        };\r\n        this.parseImg = (img) => {\r\n            const deinterlace = (pixels, width) => {\r\n                // Of course this defeats the purpose of interlacing. And it's *probably*\r\n                // the least efficient way it's ever been implemented. But nevertheless...\r\n                const newPixels = new Array(pixels.length);\r\n                const rows = pixels.length / width;\r\n                const cpRow = (toRow, fromRow) => {\r\n                    const fromPixels = pixels.slice(fromRow * width, (fromRow + 1) * width);\r\n                    newPixels.splice.apply(newPixels, [toRow * width, width].concat(fromPixels));\r\n                };\r\n                const offsets = [0, 4, 2, 1];\r\n                const steps = [8, 8, 4, 2];\r\n                let fromRow = 0;\r\n                for (let pass = 0; pass < 4; pass++) {\r\n                    for (let toRow = offsets[pass]; toRow < rows; toRow += steps[pass]) {\r\n                        cpRow(toRow, fromRow);\r\n                        fromRow++;\r\n                    }\r\n                }\r\n                return newPixels;\r\n            };\r\n            img.leftPos = this._st.readUnsigned();\r\n            img.topPos = this._st.readUnsigned();\r\n            img.width = this._st.readUnsigned();\r\n            img.height = this._st.readUnsigned();\r\n            const bits = byteToBitArr(this._st.readByte());\r\n            img.lctFlag = bits.shift();\r\n            img.interlaced = bits.shift();\r\n            img.sorted = bits.shift();\r\n            img.reserved = bits.splice(0, 2);\r\n            img.lctSize = bitsToNum(bits.splice(0, 3));\r\n            if (img.lctFlag) {\r\n                img.lct = this.parseColorTable(1 << (img.lctSize + 1));\r\n            }\r\n            img.lzwMinCodeSize = this._st.readByte();\r\n            const lzwData = this.readSubBlocks();\r\n            img.pixels = lzwDecode(img.lzwMinCodeSize, lzwData);\r\n            if (img.interlaced) {\r\n                // Move\r\n                img.pixels = deinterlace(img.pixels, img.width);\r\n            }\r\n            this.frames.push(img);\r\n            this.arrayToImage(img);\r\n            if (this._handler.img && this._handler.img(img)) {\r\n                this.checkBytes.push(this._handler);\r\n            }\r\n        };\r\n        this.parseBlock = () => {\r\n            const block = {\r\n                sentinel: this._st.readByte(),\r\n                type: ''\r\n            };\r\n            const blockChar = String.fromCharCode(block.sentinel);\r\n            switch (blockChar) {\r\n                case '!':\r\n                    block.type = 'ext';\r\n                    this.parseExt(block);\r\n                    break;\r\n                case ',':\r\n                    block.type = 'img';\r\n                    this.parseImg(block);\r\n                    break;\r\n                case ';':\r\n                    block.type = 'eof';\r\n                    if (this._handler.eof && this._handler.eof(block)) {\r\n                        this.checkBytes.push(this._handler.eof);\r\n                    }\r\n                    break;\r\n                default:\r\n                    throw new Error('Unknown block: 0x' + block.sentinel.toString(16));\r\n            }\r\n            if (block.type !== 'eof') {\r\n                this.parseBlock();\r\n            }\r\n        };\r\n        this.arrayToImage = (frame) => {\r\n            let count = 0;\r\n            const c = document.createElement('canvas');\r\n            c.id = count.toString();\r\n            c.width = frame.width;\r\n            c.height = frame.height;\r\n            count++;\r\n            const context = c.getContext('2d');\r\n            const pixSize = 1;\r\n            let y = 0;\r\n            let x = 0;\r\n            for (let i = 0; i < frame.pixels.length; i++) {\r\n                if (x % frame.width === 0) {\r\n                    y++;\r\n                    x = 0;\r\n                }\r\n                if (this.globalColorTable[frame.pixels[i]] === this._transparentColor.toHex()) {\r\n                    context.fillStyle = `rgba(0, 0, 0, 0)`;\r\n                }\r\n                else {\r\n                    context.fillStyle = this.globalColorTable[frame.pixels[i]];\r\n                }\r\n                context.fillRect(x, y, pixSize, pixSize);\r\n                x++;\r\n            }\r\n            const img = new Image();\r\n            img.src = c.toDataURL();\r\n            this.images.push(img);\r\n        };\r\n        this._st = stream;\r\n        this._handler = {};\r\n        this._transparentColor = color;\r\n        this.parseHeader();\r\n        this.parseBlock();\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Resources/Index.ts\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./EntityComponentSystem/index.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Graphics/Line.ts\n\r\n\r\n\r\nclass Line extends Graphic {\r\n    constructor(options) {\r\n        super();\r\n        this.color = Color.Black;\r\n        this.thickness = 1;\r\n        const { start, end, color, thickness } = options;\r\n        this.start = start;\r\n        this.end = end;\r\n        this.color = color !== null && color !== void 0 ? color : this.color;\r\n        this.thickness = thickness !== null && thickness !== void 0 ? thickness : this.thickness;\r\n        const { width, height } = BoundingBox.fromPoints([start, end]);\r\n        this.width = width;\r\n        this.height = height;\r\n    }\r\n    _drawImage(ctx, _x, _y) {\r\n        ctx.drawLine(this.start, this.end, this.color, this.thickness);\r\n    }\r\n    clone() {\r\n        return new Line({\r\n            start: this.start,\r\n            end: this.end,\r\n            color: this.color,\r\n            thickness: this.thickness\r\n        });\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/Polygon.ts\n\r\n\r\n\r\n/**\r\n * A polygon [[Graphic]] for drawing arbitrary polygons to the [[ExcaliburGraphicsContext]]\r\n *\r\n * Polygons default to [[ImageFiltering.Blended]]\r\n */\r\nclass Polygon extends Raster {\r\n    get points() {\r\n        return this._points;\r\n    }\r\n    set points(points) {\r\n        this._points = points;\r\n        const min = this.minPoint;\r\n        this.width = this._points.reduce((max, p) => Math.max(p.x, max), 0) - min.x;\r\n        this.height = this._points.reduce((max, p) => Math.max(p.y, max), 0) - min.y;\r\n        this.flagDirty();\r\n    }\r\n    get minPoint() {\r\n        const minX = this._points.reduce((min, p) => Math.min(p.x, min), Infinity);\r\n        const minY = this._points.reduce((min, p) => Math.min(p.y, min), Infinity);\r\n        return vec(minX, minY);\r\n    }\r\n    constructor(options) {\r\n        super(options);\r\n        this.points = options.points;\r\n        this.filtering = ImageFiltering.Blended;\r\n        this.rasterize();\r\n    }\r\n    clone() {\r\n        return new Polygon({\r\n            points: this.points.map((p) => p.clone()),\r\n            ...this.cloneGraphicOptions(),\r\n            ...this.cloneRasterOptions()\r\n        });\r\n    }\r\n    execute(ctx) {\r\n        if (this.points && this.points.length) {\r\n            ctx.beginPath();\r\n            // Iterate through the supplied points and construct a 'polygon'\r\n            const min = this.minPoint.negate();\r\n            const firstPoint = this.points[0].add(min);\r\n            ctx.moveTo(firstPoint.x, firstPoint.y);\r\n            this.points.forEach((point) => {\r\n                ctx.lineTo(point.x + min.x, point.y + min.y);\r\n            });\r\n            ctx.lineTo(firstPoint.x, firstPoint.y);\r\n            ctx.closePath();\r\n            if (this.color) {\r\n                ctx.fill();\r\n            }\r\n            if (this.strokeColor) {\r\n                ctx.stroke();\r\n            }\r\n        }\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./Graphics/index.ts\n// Graphics\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// Graphics ECS\r\n\r\n\r\n\r\n\r\n\r\n// Raster graphics\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// Post Processor\r\n\r\n\r\n\r\n\r\n\r\n\r\n// Rendering\r\n\r\n\r\n\r\n\r\n\r\n// Util\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Input/Index.ts\n// This import site is deprecated\r\n// TODO remove deprecated exports in v0.29.0\r\n/**\r\n * @module\r\n * Provides support for mice, keyboards, and controllers.\r\n */\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// Re-export hack to deprecate import site gently\r\n\r\n\n;// CONCATENATED MODULE: ./Util/Index.ts\n\r\n\r\n\r\n\r\n\r\n\r\n\n;// CONCATENATED MODULE: ./Util/Semaphore.ts\n\r\nclass AsyncWaitQueue {\r\n    constructor() {\r\n        // Code from StephenCleary https://gist.github.com/StephenCleary/ba50b2da419c03b9cba1d20cb4654d5e\r\n        this._queue = [];\r\n    }\r\n    get length() {\r\n        return this._queue.length;\r\n    }\r\n    enqueue() {\r\n        const future = new Future();\r\n        this._queue.push(future);\r\n        return future.promise;\r\n    }\r\n    dequeue(value) {\r\n        const future = this._queue.shift();\r\n        future.resolve(value);\r\n    }\r\n}\r\n/**\r\n * Semaphore allows you to limit the amount of async calls happening between `enter()` and `exit()`\r\n *\r\n * This can be useful when limiting the number of http calls, browser api calls, etc either for performance or to work\r\n * around browser limitations like max Image.decode() calls in chromium being 256.\r\n */\r\nclass Semaphore {\r\n    constructor(_count) {\r\n        this._count = _count;\r\n        this._waitQueue = new AsyncWaitQueue();\r\n    }\r\n    get count() {\r\n        return this._count;\r\n    }\r\n    get waiting() {\r\n        return this._waitQueue.length;\r\n    }\r\n    async enter() {\r\n        if (this._count !== 0) {\r\n            this._count--;\r\n            return Promise.resolve();\r\n        }\r\n        return this._waitQueue.enqueue();\r\n    }\r\n    exit(count = 1) {\r\n        if (count === 0) {\r\n            return;\r\n        }\r\n        while (count !== 0 && this._waitQueue.length !== 0) {\r\n            this._waitQueue.dequeue(null);\r\n            count--;\r\n        }\r\n        this._count += count;\r\n    }\r\n}\r\n\n;// CONCATENATED MODULE: ./index.ts\n/**\r\n * The current Excalibur version string\r\n * @description `process.env.__EX_VERSION` gets replaced by Webpack on build\r\n */\r\nconst EX_VERSION = \"0.28.0\";\r\n\r\npolyfill();\r\n// This file is used as the bundle entry point and exports everything\r\n// that will be exposed as the `ex` global variable.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// ex.Events namespace\r\n\r\n\r\n// ex.Input namespace\r\n// TODO deprecated import site remove in v0.29.0\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// ex.Util namespaces\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// ex.Deprecated\r\n// import * as deprecated from './Deprecated';\r\n// export { deprecated as Deprecated };\r\n// export * from './Deprecated';\r\n\n})();\n\nvar __webpack_exports__ActionContext = __webpack_exports__.fWn;\nvar __webpack_exports__ActionQueue = __webpack_exports__.Ia8;\nvar __webpack_exports__ActionSequence = __webpack_exports__.rqv;\nvar __webpack_exports__ActionsComponent = __webpack_exports__.hLI;\nvar __webpack_exports__ActionsSystem = __webpack_exports__.yyv;\nvar __webpack_exports__ActivateEvent = __webpack_exports__.tX5;\nvar __webpack_exports__Actor = __webpack_exports__.vtX;\nvar __webpack_exports__AddedComponent = __webpack_exports__.r7K;\nvar __webpack_exports__AddedEntity = __webpack_exports__.lCh;\nvar __webpack_exports__AffineMatrix = __webpack_exports__.cE4;\nvar __webpack_exports__Animation = __webpack_exports__.fwF;\nvar __webpack_exports__AnimationDirection = __webpack_exports__.sce;\nvar __webpack_exports__AnimationEvents = __webpack_exports__.AQ6;\nvar __webpack_exports__AnimationStrategy = __webpack_exports__._c7;\nvar __webpack_exports__ArcadeSolver = __webpack_exports__.KUs;\nvar __webpack_exports__AudioContextFactory = __webpack_exports__.Ajp;\nvar __webpack_exports__Axes = __webpack_exports__.dkO;\nvar __webpack_exports__Axis = __webpack_exports__.RDh;\nvar __webpack_exports__BaseAlign = __webpack_exports__._H9;\nvar __webpack_exports__Blink = __webpack_exports__.mxs;\nvar __webpack_exports__BodyComponent = __webpack_exports__.OmD;\nvar __webpack_exports__BoundingBox = __webpack_exports__.kBf;\nvar __webpack_exports__BroadphaseStrategy = __webpack_exports__.C4F;\nvar __webpack_exports__BrowserComponent = __webpack_exports__.NQt;\nvar __webpack_exports__BrowserEvents = __webpack_exports__.JjN;\nvar __webpack_exports__Buttons = __webpack_exports__.EK_;\nvar __webpack_exports__Camera = __webpack_exports__.V1s;\nvar __webpack_exports__CameraEvents = __webpack_exports__.xHm;\nvar __webpack_exports__Canvas = __webpack_exports__.Xz7;\nvar __webpack_exports__Circle = __webpack_exports__.Cdc;\nvar __webpack_exports__CircleCollider = __webpack_exports__.FKn;\nvar __webpack_exports__Clock = __webpack_exports__.SUY;\nvar __webpack_exports__ClosestLine = __webpack_exports__.ab2;\nvar __webpack_exports__ClosestLineJumpTable = __webpack_exports__.GfZ;\nvar __webpack_exports__Collider = __webpack_exports__.YMS;\nvar __webpack_exports__ColliderComponent = __webpack_exports__.oyv;\nvar __webpack_exports__CollisionContact = __webpack_exports__.aUb;\nvar __webpack_exports__CollisionEndEvent = __webpack_exports__.SdD;\nvar __webpack_exports__CollisionGroup = __webpack_exports__.JUv;\nvar __webpack_exports__CollisionGroupManager = __webpack_exports__.jEj;\nvar __webpack_exports__CollisionJumpTable = __webpack_exports__.TFq;\nvar __webpack_exports__CollisionPostSolveEvent = __webpack_exports__.HDU;\nvar __webpack_exports__CollisionPreSolveEvent = __webpack_exports__.R_y;\nvar __webpack_exports__CollisionResolutionStrategy = __webpack_exports__.ydN;\nvar __webpack_exports__CollisionStartEvent = __webpack_exports__.t50;\nvar __webpack_exports__CollisionSystem = __webpack_exports__.s$$;\nvar __webpack_exports__CollisionType = __webpack_exports__.v2G;\nvar __webpack_exports__Color = __webpack_exports__.Ilk;\nvar __webpack_exports__ColorBlindFlags = __webpack_exports__.s9i;\nvar __webpack_exports__ColorBlindnessMode = __webpack_exports__.dxL;\nvar __webpack_exports__ColorBlindnessPostProcessor = __webpack_exports__.LLX;\nvar __webpack_exports__Component = __webpack_exports__.wA2;\nvar __webpack_exports__CompositeCollider = __webpack_exports__.R_p;\nvar __webpack_exports__Configurable = __webpack_exports__.IQ$;\nvar __webpack_exports__ConsoleAppender = __webpack_exports__.I5F;\nvar __webpack_exports__ContactConstraintPoint = __webpack_exports__.X8$;\nvar __webpack_exports__ContactEndEvent = __webpack_exports__.FR6;\nvar __webpack_exports__ContactStartEvent = __webpack_exports__.U8o;\nvar __webpack_exports__CoordPlane = __webpack_exports__.kbG;\nvar __webpack_exports__DeactivateEvent = __webpack_exports__.iS_;\nvar __webpack_exports__Debug = __webpack_exports__.cGG;\nvar __webpack_exports__DebugGraphicsComponent = __webpack_exports__.RPN;\nvar __webpack_exports__DebugSystem = __webpack_exports__.skb;\nvar __webpack_exports__DebugText = __webpack_exports__.SLU;\nvar __webpack_exports__DegreeOfFreedom = __webpack_exports__.RdJ;\nvar __webpack_exports__Delay = __webpack_exports__.cNu;\nvar __webpack_exports__Detector = __webpack_exports__.gU7;\nvar __webpack_exports__Die = __webpack_exports__.LSk;\nvar __webpack_exports__Direction = __webpack_exports__.Nmp;\nvar __webpack_exports__DisplayMode = __webpack_exports__.d1Y;\nvar __webpack_exports__DynamicTree = __webpack_exports__.xrL;\nvar __webpack_exports__DynamicTreeCollisionProcessor = __webpack_exports__.sRW;\nvar __webpack_exports__EX_VERSION = __webpack_exports__.cmV;\nvar __webpack_exports__EaseBy = __webpack_exports__.qWz;\nvar __webpack_exports__EaseTo = __webpack_exports__.N0Q;\nvar __webpack_exports__EasingFunctions = __webpack_exports__.q8b;\nvar __webpack_exports__EdgeCollider = __webpack_exports__.ynB;\nvar __webpack_exports__ElasticToActorStrategy = __webpack_exports__.jT9;\nvar __webpack_exports__EmitterType = __webpack_exports__.wAz;\nvar __webpack_exports__Engine = __webpack_exports__.D4V;\nvar __webpack_exports__EngineEvents = __webpack_exports__.NLr;\nvar __webpack_exports__EnterTriggerEvent = __webpack_exports__.N6H;\nvar __webpack_exports__EnterViewPortEvent = __webpack_exports__.W1A;\nvar __webpack_exports__Entity = __webpack_exports__.JHW;\nvar __webpack_exports__EntityEvents = __webpack_exports__.ZZ$;\nvar __webpack_exports__EntityManager = __webpack_exports__.v2K;\nvar __webpack_exports__EventDispatcher = __webpack_exports__.pBf;\nvar __webpack_exports__EventEmitter = __webpack_exports__.vpe;\nvar __webpack_exports__EventTypes = __webpack_exports__.GMl;\nvar __webpack_exports__Events = __webpack_exports__.zW2;\nvar __webpack_exports__ExResponse = __webpack_exports__.B0K;\nvar __webpack_exports__ExcaliburGraphicsContext2DCanvas = __webpack_exports__.Nv7;\nvar __webpack_exports__ExcaliburGraphicsContextWebGL = __webpack_exports__.C_p;\nvar __webpack_exports__ExitTriggerEvent = __webpack_exports__.MUA;\nvar __webpack_exports__ExitViewPortEvent = __webpack_exports__.xqU;\nvar __webpack_exports__Fade = __webpack_exports__.pTp;\nvar __webpack_exports__Flags = __webpack_exports__.vUK;\nvar __webpack_exports__Follow = __webpack_exports__.j9l;\nvar __webpack_exports__Font = __webpack_exports__.Zxw;\nvar __webpack_exports__FontCache = __webpack_exports__.v51;\nvar __webpack_exports__FontStyle = __webpack_exports__.Hdx;\nvar __webpack_exports__FontUnit = __webpack_exports__.Z$d;\nvar __webpack_exports__FpsSampler = __webpack_exports__.iqV;\nvar __webpack_exports__FrameStats = __webpack_exports__.o$7;\nvar __webpack_exports__Future = __webpack_exports__.olM;\nvar __webpack_exports__GameEvent = __webpack_exports__.Zm$;\nvar __webpack_exports__GameStartEvent = __webpack_exports__.$QH;\nvar __webpack_exports__GameStopEvent = __webpack_exports__.i78;\nvar __webpack_exports__Gamepad = __webpack_exports__.nJg;\nvar __webpack_exports__GamepadAxisEvent = __webpack_exports__.h6u;\nvar __webpack_exports__GamepadButtonEvent = __webpack_exports__.hts;\nvar __webpack_exports__GamepadConnectEvent = __webpack_exports__.j88;\nvar __webpack_exports__GamepadDisconnectEvent = __webpack_exports__.VME;\nvar __webpack_exports__Gamepads = __webpack_exports__.fy2;\nvar __webpack_exports__Gif = __webpack_exports__.nt;\nvar __webpack_exports__GlobalCoordinates = __webpack_exports__.Ukr;\nvar __webpack_exports__Graphic = __webpack_exports__.zsu;\nvar __webpack_exports__GraphicsComponent = __webpack_exports__.oA6;\nvar __webpack_exports__GraphicsGroup = __webpack_exports__.TVh;\nvar __webpack_exports__GraphicsLayer = __webpack_exports__.TwZ;\nvar __webpack_exports__GraphicsLayers = __webpack_exports__.GTT;\nvar __webpack_exports__GraphicsSystem = __webpack_exports__.xxj;\nvar __webpack_exports__HiddenEvent = __webpack_exports__.XdK;\nvar __webpack_exports__ImageFiltering = __webpack_exports__.Jmb;\nvar __webpack_exports__ImageSource = __webpack_exports__.cXo;\nvar __webpack_exports__InitializeEvent = __webpack_exports__.Dm5;\nvar __webpack_exports__Input = __webpack_exports__.IIB;\nvar __webpack_exports__InputMapper = __webpack_exports__.ebW;\nvar __webpack_exports__Integrator = __webpack_exports__.zI0;\nvar __webpack_exports__IsometricEntityComponent = __webpack_exports__.LYD;\nvar __webpack_exports__IsometricEntitySystem = __webpack_exports__.cEG;\nvar __webpack_exports__IsometricMap = __webpack_exports__.SEl;\nvar __webpack_exports__IsometricTile = __webpack_exports__.t9V;\nvar __webpack_exports__KeyEvent = __webpack_exports__.ez5;\nvar __webpack_exports__Keyboard = __webpack_exports__.N1d;\nvar __webpack_exports__Keys = __webpack_exports__.R8U;\nvar __webpack_exports__KillEvent = __webpack_exports__.SKZ;\nvar __webpack_exports__Label = __webpack_exports__.__J;\nvar __webpack_exports__LimitCameraBoundsStrategy = __webpack_exports__.RI$;\nvar __webpack_exports__Line = __webpack_exports__.x12;\nvar __webpack_exports__LineSegment = __webpack_exports__.ccz;\nvar __webpack_exports__Loader = __webpack_exports__.aNw;\nvar __webpack_exports__LoaderEvents = __webpack_exports__.XrL;\nvar __webpack_exports__LockCameraToActorAxisStrategy = __webpack_exports__.xwn;\nvar __webpack_exports__LockCameraToActorStrategy = __webpack_exports__.dNK;\nvar __webpack_exports__LogLevel = __webpack_exports__.ini;\nvar __webpack_exports__Logger = __webpack_exports__.YdH;\nvar __webpack_exports__Material = __webpack_exports__.F5T;\nvar __webpack_exports__Matrix = __webpack_exports__.y3G;\nvar __webpack_exports__MatrixLocations = __webpack_exports__.l57;\nvar __webpack_exports__MediaEvent = __webpack_exports__.xn0;\nvar __webpack_exports__Meet = __webpack_exports__.t2V;\nvar __webpack_exports__MotionComponent = __webpack_exports__.uxB;\nvar __webpack_exports__MotionSystem = __webpack_exports__.cpd;\nvar __webpack_exports__MoveBy = __webpack_exports__.fiy;\nvar __webpack_exports__MoveTo = __webpack_exports__.$XZ;\nvar __webpack_exports__NativePointerButton = __webpack_exports__.UG6;\nvar __webpack_exports__NativeSoundEvent = __webpack_exports__.uqK;\nvar __webpack_exports__NativeSoundProcessedEvent = __webpack_exports__.STE;\nvar __webpack_exports__Observable = __webpack_exports__.y$z;\nvar __webpack_exports__OffscreenSystem = __webpack_exports__.mAD;\nvar __webpack_exports__Pair = __webpack_exports__.sOq;\nvar __webpack_exports__ParallaxComponent = __webpack_exports__.hUw;\nvar __webpack_exports__ParallelActions = __webpack_exports__._0G;\nvar __webpack_exports__ParseGif = __webpack_exports__.Sqs;\nvar __webpack_exports__Particle = __webpack_exports__.hpZ;\nvar __webpack_exports__ParticleEmitter = __webpack_exports__.Vol;\nvar __webpack_exports__ParticleTransform = __webpack_exports__.vYX;\nvar __webpack_exports__Physics = __webpack_exports__.wIZ;\nvar __webpack_exports__PhysicsStats = __webpack_exports__.cBi;\nvar __webpack_exports__PhysicsWorld = __webpack_exports__.c30;\nvar __webpack_exports__PointerButton = __webpack_exports__.MPV;\nvar __webpack_exports__PointerComponent = __webpack_exports__.RFv;\nvar __webpack_exports__PointerEvent = __webpack_exports__.Ux6;\nvar __webpack_exports__PointerEventReceiver = __webpack_exports__.rxy;\nvar __webpack_exports__PointerScope = __webpack_exports__.I$c;\nvar __webpack_exports__PointerSystem = __webpack_exports__.kfC;\nvar __webpack_exports__PointerType = __webpack_exports__.VjY;\nvar __webpack_exports__Polygon = __webpack_exports__.mgq;\nvar __webpack_exports__PolygonCollider = __webpack_exports__.YVA;\nvar __webpack_exports__Pool = __webpack_exports__.Kgp;\nvar __webpack_exports__PostCollisionEvent = __webpack_exports__.HH$;\nvar __webpack_exports__PostDebugDrawEvent = __webpack_exports__.M_d;\nvar __webpack_exports__PostDrawEvent = __webpack_exports__.rgh;\nvar __webpack_exports__PostFrameEvent = __webpack_exports__.Ra6;\nvar __webpack_exports__PostKillEvent = __webpack_exports__.KhR;\nvar __webpack_exports__PostUpdateEvent = __webpack_exports__.BS5;\nvar __webpack_exports__PreCollisionEvent = __webpack_exports__.xhz;\nvar __webpack_exports__PreDebugDrawEvent = __webpack_exports__.xOq;\nvar __webpack_exports__PreDrawEvent = __webpack_exports__.a9j;\nvar __webpack_exports__PreFrameEvent = __webpack_exports__.bHk;\nvar __webpack_exports__PreKillEvent = __webpack_exports__.CgK;\nvar __webpack_exports__PreUpdateEvent = __webpack_exports__.cuY;\nvar __webpack_exports__Projection = __webpack_exports__.kvE;\nvar __webpack_exports__QuadIndexBuffer = __webpack_exports__.SBu;\nvar __webpack_exports__Query = __webpack_exports__.AE_;\nvar __webpack_exports__QueryManager = __webpack_exports__.ctO;\nvar __webpack_exports__RadiusAroundActorStrategy = __webpack_exports__.OLH;\nvar __webpack_exports__Random = __webpack_exports__.kky;\nvar __webpack_exports__Raster = __webpack_exports__.nSF;\nvar __webpack_exports__Ray = __webpack_exports__.zHn;\nvar __webpack_exports__RealisticSolver = __webpack_exports__.zwx;\nvar __webpack_exports__Rectangle = __webpack_exports__.AeJ;\nvar __webpack_exports__RemovedComponent = __webpack_exports__.hLz;\nvar __webpack_exports__RemovedEntity = __webpack_exports__.D9g;\nvar __webpack_exports__Repeat = __webpack_exports__.wA;\nvar __webpack_exports__RepeatForever = __webpack_exports__.jhr;\nvar __webpack_exports__Resolution = __webpack_exports__.GVs;\nvar __webpack_exports__Resource = __webpack_exports__._zO;\nvar __webpack_exports__ResourceEvents = __webpack_exports__.LXZ;\nvar __webpack_exports__RotateBy = __webpack_exports__.w6$;\nvar __webpack_exports__RotateTo = __webpack_exports__.mhV;\nvar __webpack_exports__RotationType = __webpack_exports__.MOD;\nvar __webpack_exports__ScaleBy = __webpack_exports__.kwd;\nvar __webpack_exports__ScaleTo = __webpack_exports__.Lmr;\nvar __webpack_exports__Scene = __webpack_exports__.xsS;\nvar __webpack_exports__SceneEvents = __webpack_exports__.K5l;\nvar __webpack_exports__Screen = __webpack_exports__.lLr;\nvar __webpack_exports__ScreenAppender = __webpack_exports__.Z$r;\nvar __webpack_exports__ScreenElement = __webpack_exports__.IXb;\nvar __webpack_exports__ScreenShader = __webpack_exports__.SGH;\nvar __webpack_exports__ScrollPreventionMode = __webpack_exports__.SMj;\nvar __webpack_exports__Semaphore = __webpack_exports__.L34;\nvar __webpack_exports__Shader = __webpack_exports__.exe;\nvar __webpack_exports__Shape = __webpack_exports__.bnF;\nvar __webpack_exports__Side = __webpack_exports__.MFA;\nvar __webpack_exports__Sound = __webpack_exports__.$uU;\nvar __webpack_exports__SoundEvents = __webpack_exports__.Sap;\nvar __webpack_exports__Sprite = __webpack_exports__.jyi;\nvar __webpack_exports__SpriteFont = __webpack_exports__.E03;\nvar __webpack_exports__SpriteSheet = __webpack_exports__.V6q;\nvar __webpack_exports__StandardClock = __webpack_exports__.rg2;\nvar __webpack_exports__StateMachine = __webpack_exports__.DVW;\nvar __webpack_exports__StrategyContainer = __webpack_exports__.nVo;\nvar __webpack_exports__Stream = __webpack_exports__.F6N;\nvar __webpack_exports__System = __webpack_exports__.xP7;\nvar __webpack_exports__SystemManager = __webpack_exports__.Odq;\nvar __webpack_exports__SystemType = __webpack_exports__.Zif;\nvar __webpack_exports__TagComponent = __webpack_exports__.ZGJ;\nvar __webpack_exports__TestClock = __webpack_exports__.MJk;\nvar __webpack_exports__Text = __webpack_exports__.xvT;\nvar __webpack_exports__TextAlign = __webpack_exports__.PHM;\nvar __webpack_exports__TextureLoader = __webpack_exports__.dpR;\nvar __webpack_exports__Tile = __webpack_exports__.n9L;\nvar __webpack_exports__TileMap = __webpack_exports__.KwO;\nvar __webpack_exports__TileMapEvents = __webpack_exports__.SxM;\nvar __webpack_exports__Timer = __webpack_exports__.B7y;\nvar __webpack_exports__Toaster = __webpack_exports__.x7r;\nvar __webpack_exports__Transform = __webpack_exports__.wx7;\nvar __webpack_exports__TransformComponent = __webpack_exports__.Uvn;\nvar __webpack_exports__TreeNode = __webpack_exports__.OFT;\nvar __webpack_exports__Trigger = __webpack_exports__.xzN;\nvar __webpack_exports__TriggerEvents = __webpack_exports__.CcZ;\nvar __webpack_exports__TwoPI = __webpack_exports__.M5Z;\nvar __webpack_exports__Util = __webpack_exports__.ZrN;\nvar __webpack_exports__Vector = __webpack_exports__.OWs;\nvar __webpack_exports__VectorView = __webpack_exports__.dF9;\nvar __webpack_exports__VertexBuffer = __webpack_exports__.oZy;\nvar __webpack_exports__VertexLayout = __webpack_exports__.rD2;\nvar __webpack_exports__VisibleEvent = __webpack_exports__.VHo;\nvar __webpack_exports__WebAudio = __webpack_exports__.ohE;\nvar __webpack_exports__WebAudioInstance = __webpack_exports__.R$E;\nvar __webpack_exports__WheelDeltaMode = __webpack_exports__.xQN;\nvar __webpack_exports__WheelEvent = __webpack_exports__.AdJ;\nvar __webpack_exports__World = __webpack_exports__.q3I;\nvar __webpack_exports__canonicalizeAngle = __webpack_exports__.Pab;\nvar __webpack_exports__clamp = __webpack_exports__.uZ5;\nvar __webpack_exports__createId = __webpack_exports__.McK;\nvar __webpack_exports__frac = __webpack_exports__.F9c;\nvar __webpack_exports__hasGraphicsTick = __webpack_exports__.k0b;\nvar __webpack_exports__hasOnInitialize = __webpack_exports__.hnT;\nvar __webpack_exports__hasOnPostUpdate = __webpack_exports__.RSJ;\nvar __webpack_exports__hasOnPreUpdate = __webpack_exports__.Mku;\nvar __webpack_exports__hasPostDraw = __webpack_exports__.h90;\nvar __webpack_exports__hasPreDraw = __webpack_exports__.rms;\nvar __webpack_exports__has_initialize = __webpack_exports__.ErP;\nvar __webpack_exports__has_postupdate = __webpack_exports__.aVg;\nvar __webpack_exports__has_preupdate = __webpack_exports__.lPc;\nvar __webpack_exports__isAddedComponent = __webpack_exports__.Z8E;\nvar __webpack_exports__isAddedSystemEntity = __webpack_exports__._N2;\nvar __webpack_exports__isRemoveSystemEntity = __webpack_exports__.yFn;\nvar __webpack_exports__isRemovedComponent = __webpack_exports__.lNv;\nvar __webpack_exports__isScreenElement = __webpack_exports__.cu9;\nvar __webpack_exports__maxMessages = __webpack_exports__.MZQ;\nvar __webpack_exports__obsolete = __webpack_exports__.FUM;\nvar __webpack_exports__pixelSnapEpsilon = __webpack_exports__.BxR;\nvar __webpack_exports__randomInRange = __webpack_exports__.vdf;\nvar __webpack_exports__randomIntInRange = __webpack_exports__.iaL;\nvar __webpack_exports__range = __webpack_exports__.w6H;\nvar __webpack_exports__resetObsoleteCounter = __webpack_exports__.Q4c;\nvar __webpack_exports__sign = __webpack_exports__.Xxe;\nvar __webpack_exports__toDegrees = __webpack_exports__.Uxb;\nvar __webpack_exports__toRadians = __webpack_exports__.Yr5;\nvar __webpack_exports__vec = __webpack_exports__.Bhw;\nvar __webpack_exports__webgl = __webpack_exports__.yOA;\nexport { __webpack_exports__ActionContext as ActionContext, __webpack_exports__ActionQueue as ActionQueue, __webpack_exports__ActionSequence as ActionSequence, __webpack_exports__ActionsComponent as ActionsComponent, __webpack_exports__ActionsSystem as ActionsSystem, __webpack_exports__ActivateEvent as ActivateEvent, __webpack_exports__Actor as Actor, __webpack_exports__AddedComponent as AddedComponent, __webpack_exports__AddedEntity as AddedEntity, __webpack_exports__AffineMatrix as AffineMatrix, __webpack_exports__Animation as Animation, __webpack_exports__AnimationDirection as AnimationDirection, __webpack_exports__AnimationEvents as AnimationEvents, __webpack_exports__AnimationStrategy as AnimationStrategy, __webpack_exports__ArcadeSolver as ArcadeSolver, __webpack_exports__AudioContextFactory as AudioContextFactory, __webpack_exports__Axes as Axes, __webpack_exports__Axis as Axis, __webpack_exports__BaseAlign as BaseAlign, __webpack_exports__Blink as Blink, __webpack_exports__BodyComponent as BodyComponent, __webpack_exports__BoundingBox as BoundingBox, __webpack_exports__BroadphaseStrategy as BroadphaseStrategy, __webpack_exports__BrowserComponent as BrowserComponent, __webpack_exports__BrowserEvents as BrowserEvents, __webpack_exports__Buttons as Buttons, __webpack_exports__Camera as Camera, __webpack_exports__CameraEvents as CameraEvents, __webpack_exports__Canvas as Canvas, __webpack_exports__Circle as Circle, __webpack_exports__CircleCollider as CircleCollider, __webpack_exports__Clock as Clock, __webpack_exports__ClosestLine as ClosestLine, __webpack_exports__ClosestLineJumpTable as ClosestLineJumpTable, __webpack_exports__Collider as Collider, __webpack_exports__ColliderComponent as ColliderComponent, __webpack_exports__CollisionContact as CollisionContact, __webpack_exports__CollisionEndEvent as CollisionEndEvent, __webpack_exports__CollisionGroup as CollisionGroup, __webpack_exports__CollisionGroupManager as CollisionGroupManager, __webpack_exports__CollisionJumpTable as CollisionJumpTable, __webpack_exports__CollisionPostSolveEvent as CollisionPostSolveEvent, __webpack_exports__CollisionPreSolveEvent as CollisionPreSolveEvent, __webpack_exports__CollisionResolutionStrategy as CollisionResolutionStrategy, __webpack_exports__CollisionStartEvent as CollisionStartEvent, __webpack_exports__CollisionSystem as CollisionSystem, __webpack_exports__CollisionType as CollisionType, __webpack_exports__Color as Color, __webpack_exports__ColorBlindFlags as ColorBlindFlags, __webpack_exports__ColorBlindnessMode as ColorBlindnessMode, __webpack_exports__ColorBlindnessPostProcessor as ColorBlindnessPostProcessor, __webpack_exports__Component as Component, __webpack_exports__CompositeCollider as CompositeCollider, __webpack_exports__Configurable as Configurable, __webpack_exports__ConsoleAppender as ConsoleAppender, __webpack_exports__ContactConstraintPoint as ContactConstraintPoint, __webpack_exports__ContactEndEvent as ContactEndEvent, __webpack_exports__ContactStartEvent as ContactStartEvent, __webpack_exports__CoordPlane as CoordPlane, __webpack_exports__DeactivateEvent as DeactivateEvent, __webpack_exports__Debug as Debug, __webpack_exports__DebugGraphicsComponent as DebugGraphicsComponent, __webpack_exports__DebugSystem as DebugSystem, __webpack_exports__DebugText as DebugText, __webpack_exports__DegreeOfFreedom as DegreeOfFreedom, __webpack_exports__Delay as Delay, __webpack_exports__Detector as Detector, __webpack_exports__Die as Die, __webpack_exports__Direction as Direction, __webpack_exports__DisplayMode as DisplayMode, __webpack_exports__DynamicTree as DynamicTree, __webpack_exports__DynamicTreeCollisionProcessor as DynamicTreeCollisionProcessor, __webpack_exports__EX_VERSION as EX_VERSION, __webpack_exports__EaseBy as EaseBy, __webpack_exports__EaseTo as EaseTo, __webpack_exports__EasingFunctions as EasingFunctions, __webpack_exports__EdgeCollider as EdgeCollider, __webpack_exports__ElasticToActorStrategy as ElasticToActorStrategy, __webpack_exports__EmitterType as EmitterType, __webpack_exports__Engine as Engine, __webpack_exports__EngineEvents as EngineEvents, __webpack_exports__EnterTriggerEvent as EnterTriggerEvent, __webpack_exports__EnterViewPortEvent as EnterViewPortEvent, __webpack_exports__Entity as Entity, __webpack_exports__EntityEvents as EntityEvents, __webpack_exports__EntityManager as EntityManager, __webpack_exports__EventDispatcher as EventDispatcher, __webpack_exports__EventEmitter as EventEmitter, __webpack_exports__EventTypes as EventTypes, __webpack_exports__Events as Events, __webpack_exports__ExResponse as ExResponse, __webpack_exports__ExcaliburGraphicsContext2DCanvas as ExcaliburGraphicsContext2DCanvas, __webpack_exports__ExcaliburGraphicsContextWebGL as ExcaliburGraphicsContextWebGL, __webpack_exports__ExitTriggerEvent as ExitTriggerEvent, __webpack_exports__ExitViewPortEvent as ExitViewPortEvent, __webpack_exports__Fade as Fade, __webpack_exports__Flags as Flags, __webpack_exports__Follow as Follow, __webpack_exports__Font as Font, __webpack_exports__FontCache as FontCache, __webpack_exports__FontStyle as FontStyle, __webpack_exports__FontUnit as FontUnit, __webpack_exports__FpsSampler as FpsSampler, __webpack_exports__FrameStats as FrameStats, __webpack_exports__Future as Future, __webpack_exports__GameEvent as GameEvent, __webpack_exports__GameStartEvent as GameStartEvent, __webpack_exports__GameStopEvent as GameStopEvent, __webpack_exports__Gamepad as Gamepad, __webpack_exports__GamepadAxisEvent as GamepadAxisEvent, __webpack_exports__GamepadButtonEvent as GamepadButtonEvent, __webpack_exports__GamepadConnectEvent as GamepadConnectEvent, __webpack_exports__GamepadDisconnectEvent as GamepadDisconnectEvent, __webpack_exports__Gamepads as Gamepads, __webpack_exports__Gif as Gif, __webpack_exports__GlobalCoordinates as GlobalCoordinates, __webpack_exports__Graphic as Graphic, __webpack_exports__GraphicsComponent as GraphicsComponent, __webpack_exports__GraphicsGroup as GraphicsGroup, __webpack_exports__GraphicsLayer as GraphicsLayer, __webpack_exports__GraphicsLayers as GraphicsLayers, __webpack_exports__GraphicsSystem as GraphicsSystem, __webpack_exports__HiddenEvent as HiddenEvent, __webpack_exports__ImageFiltering as ImageFiltering, __webpack_exports__ImageSource as ImageSource, __webpack_exports__InitializeEvent as InitializeEvent, __webpack_exports__Input as Input, __webpack_exports__InputMapper as InputMapper, __webpack_exports__Integrator as Integrator, __webpack_exports__IsometricEntityComponent as IsometricEntityComponent, __webpack_exports__IsometricEntitySystem as IsometricEntitySystem, __webpack_exports__IsometricMap as IsometricMap, __webpack_exports__IsometricTile as IsometricTile, __webpack_exports__KeyEvent as KeyEvent, __webpack_exports__Keyboard as Keyboard, __webpack_exports__Keys as Keys, __webpack_exports__KillEvent as KillEvent, __webpack_exports__Label as Label, __webpack_exports__LimitCameraBoundsStrategy as LimitCameraBoundsStrategy, __webpack_exports__Line as Line, __webpack_exports__LineSegment as LineSegment, __webpack_exports__Loader as Loader, __webpack_exports__LoaderEvents as LoaderEvents, __webpack_exports__LockCameraToActorAxisStrategy as LockCameraToActorAxisStrategy, __webpack_exports__LockCameraToActorStrategy as LockCameraToActorStrategy, __webpack_exports__LogLevel as LogLevel, __webpack_exports__Logger as Logger, __webpack_exports__Material as Material, __webpack_exports__Matrix as Matrix, __webpack_exports__MatrixLocations as MatrixLocations, __webpack_exports__MediaEvent as MediaEvent, __webpack_exports__Meet as Meet, __webpack_exports__MotionComponent as MotionComponent, __webpack_exports__MotionSystem as MotionSystem, __webpack_exports__MoveBy as MoveBy, __webpack_exports__MoveTo as MoveTo, __webpack_exports__NativePointerButton as NativePointerButton, __webpack_exports__NativeSoundEvent as NativeSoundEvent, __webpack_exports__NativeSoundProcessedEvent as NativeSoundProcessedEvent, __webpack_exports__Observable as Observable, __webpack_exports__OffscreenSystem as OffscreenSystem, __webpack_exports__Pair as Pair, __webpack_exports__ParallaxComponent as ParallaxComponent, __webpack_exports__ParallelActions as ParallelActions, __webpack_exports__ParseGif as ParseGif, __webpack_exports__Particle as Particle, __webpack_exports__ParticleEmitter as ParticleEmitter, __webpack_exports__ParticleTransform as ParticleTransform, __webpack_exports__Physics as Physics, __webpack_exports__PhysicsStats as PhysicsStats, __webpack_exports__PhysicsWorld as PhysicsWorld, __webpack_exports__PointerButton as PointerButton, __webpack_exports__PointerComponent as PointerComponent, __webpack_exports__PointerEvent as PointerEvent, __webpack_exports__PointerEventReceiver as PointerEventReceiver, __webpack_exports__PointerScope as PointerScope, __webpack_exports__PointerSystem as PointerSystem, __webpack_exports__PointerType as PointerType, __webpack_exports__Polygon as Polygon, __webpack_exports__PolygonCollider as PolygonCollider, __webpack_exports__Pool as Pool, __webpack_exports__PostCollisionEvent as PostCollisionEvent, __webpack_exports__PostDebugDrawEvent as PostDebugDrawEvent, __webpack_exports__PostDrawEvent as PostDrawEvent, __webpack_exports__PostFrameEvent as PostFrameEvent, __webpack_exports__PostKillEvent as PostKillEvent, __webpack_exports__PostUpdateEvent as PostUpdateEvent, __webpack_exports__PreCollisionEvent as PreCollisionEvent, __webpack_exports__PreDebugDrawEvent as PreDebugDrawEvent, __webpack_exports__PreDrawEvent as PreDrawEvent, __webpack_exports__PreFrameEvent as PreFrameEvent, __webpack_exports__PreKillEvent as PreKillEvent, __webpack_exports__PreUpdateEvent as PreUpdateEvent, __webpack_exports__Projection as Projection, __webpack_exports__QuadIndexBuffer as QuadIndexBuffer, __webpack_exports__Query as Query, __webpack_exports__QueryManager as QueryManager, __webpack_exports__RadiusAroundActorStrategy as RadiusAroundActorStrategy, __webpack_exports__Random as Random, __webpack_exports__Raster as Raster, __webpack_exports__Ray as Ray, __webpack_exports__RealisticSolver as RealisticSolver, __webpack_exports__Rectangle as Rectangle, __webpack_exports__RemovedComponent as RemovedComponent, __webpack_exports__RemovedEntity as RemovedEntity, __webpack_exports__Repeat as Repeat, __webpack_exports__RepeatForever as RepeatForever, __webpack_exports__Resolution as Resolution, __webpack_exports__Resource as Resource, __webpack_exports__ResourceEvents as ResourceEvents, __webpack_exports__RotateBy as RotateBy, __webpack_exports__RotateTo as RotateTo, __webpack_exports__RotationType as RotationType, __webpack_exports__ScaleBy as ScaleBy, __webpack_exports__ScaleTo as ScaleTo, __webpack_exports__Scene as Scene, __webpack_exports__SceneEvents as SceneEvents, __webpack_exports__Screen as Screen, __webpack_exports__ScreenAppender as ScreenAppender, __webpack_exports__ScreenElement as ScreenElement, __webpack_exports__ScreenShader as ScreenShader, __webpack_exports__ScrollPreventionMode as ScrollPreventionMode, __webpack_exports__Semaphore as Semaphore, __webpack_exports__Shader as Shader, __webpack_exports__Shape as Shape, __webpack_exports__Side as Side, __webpack_exports__Sound as Sound, __webpack_exports__SoundEvents as SoundEvents, __webpack_exports__Sprite as Sprite, __webpack_exports__SpriteFont as SpriteFont, __webpack_exports__SpriteSheet as SpriteSheet, __webpack_exports__StandardClock as StandardClock, __webpack_exports__StateMachine as StateMachine, __webpack_exports__StrategyContainer as StrategyContainer, __webpack_exports__Stream as Stream, __webpack_exports__System as System, __webpack_exports__SystemManager as SystemManager, __webpack_exports__SystemType as SystemType, __webpack_exports__TagComponent as TagComponent, __webpack_exports__TestClock as TestClock, __webpack_exports__Text as Text, __webpack_exports__TextAlign as TextAlign, __webpack_exports__TextureLoader as TextureLoader, __webpack_exports__Tile as Tile, __webpack_exports__TileMap as TileMap, __webpack_exports__TileMapEvents as TileMapEvents, __webpack_exports__Timer as Timer, __webpack_exports__Toaster as Toaster, __webpack_exports__Transform as Transform, __webpack_exports__TransformComponent as TransformComponent, __webpack_exports__TreeNode as TreeNode, __webpack_exports__Trigger as Trigger, __webpack_exports__TriggerEvents as TriggerEvents, __webpack_exports__TwoPI as TwoPI, __webpack_exports__Util as Util, __webpack_exports__Vector as Vector, __webpack_exports__VectorView as VectorView, __webpack_exports__VertexBuffer as VertexBuffer, __webpack_exports__VertexLayout as VertexLayout, __webpack_exports__VisibleEvent as VisibleEvent, __webpack_exports__WebAudio as WebAudio, __webpack_exports__WebAudioInstance as WebAudioInstance, __webpack_exports__WheelDeltaMode as WheelDeltaMode, __webpack_exports__WheelEvent as WheelEvent, __webpack_exports__World as World, __webpack_exports__canonicalizeAngle as canonicalizeAngle, __webpack_exports__clamp as clamp, __webpack_exports__createId as createId, __webpack_exports__frac as frac, __webpack_exports__hasGraphicsTick as hasGraphicsTick, __webpack_exports__hasOnInitialize as hasOnInitialize, __webpack_exports__hasOnPostUpdate as hasOnPostUpdate, __webpack_exports__hasOnPreUpdate as hasOnPreUpdate, __webpack_exports__hasPostDraw as hasPostDraw, __webpack_exports__hasPreDraw as hasPreDraw, __webpack_exports__has_initialize as has_initialize, __webpack_exports__has_postupdate as has_postupdate, __webpack_exports__has_preupdate as has_preupdate, __webpack_exports__isAddedComponent as isAddedComponent, __webpack_exports__isAddedSystemEntity as isAddedSystemEntity, __webpack_exports__isRemoveSystemEntity as isRemoveSystemEntity, __webpack_exports__isRemovedComponent as isRemovedComponent, __webpack_exports__isScreenElement as isScreenElement, __webpack_exports__maxMessages as maxMessages, __webpack_exports__obsolete as obsolete, __webpack_exports__pixelSnapEpsilon as pixelSnapEpsilon, __webpack_exports__randomInRange as randomInRange, __webpack_exports__randomIntInRange as randomIntInRange, __webpack_exports__range as range, __webpack_exports__resetObsoleteCounter as resetObsoleteCounter, __webpack_exports__sign as sign, __webpack_exports__toDegrees as toDegrees, __webpack_exports__toRadians as toRadians, __webpack_exports__vec as vec, __webpack_exports__webgl as webgl };\n\n//# sourceMappingURL=excalibur.js.map","import * as ex from 'excalibur';\nimport { baddieSpriteSheet, Resources } from \"./resources\";\nimport { Bot } from './bot';\n\nexport class Baddie extends ex.Actor {\n    constructor(x: number, y: number, public dir: number) {\n        super({\n            name: 'Baddie',\n            pos: new ex.Vector(x, y),\n            collisionGroup: ex.CollisionGroupManager.groupByName(\"enemy\"),\n            collisionType: ex.CollisionType.Active,\n            collider: ex.Shape.Box(32, 50, ex.Vector.Half, ex.vec(0, -1)) \n        });\n    }\n\n    // OnInitialize is called before the 1st actor update\n    onInitialize(engine: ex.Engine) {\n        // Initialize actor\n\n        // Setup visuals\n        const left = ex.Animation.fromSpriteSheet(baddieSpriteSheet, [2, 3, 4, 5], 100);\n        left.scale = new ex.Vector(2, 2);\n        const right = ex.Animation.fromSpriteSheet(baddieSpriteSheet, [2, 3, 4, 5], 100);\n        right.scale = new ex.Vector(2, 2);\n        right.flipHorizontal = true;\n\n        // Register animation\n        this.graphics.add(\"left\", left)\n        this.graphics.add(\"right\", right);\n        this.graphics.use(\"left\");\n\n        if ((window as any).__TESTING) {\n            left.pause();\n        }\n\n        // Setup patroling behavior\n\n        // For the test harness to be predicable\n        if (!(window as any).__TESTING) {\n            this.actions.delay(1000)\n                        .repeatForever(ctx => ctx\n                            .moveBy(400 * this.dir, 0, 100)\n                            .moveBy(-400 * this.dir, 0, 100));\n        }\n\n        // Handle being stomped by the player\n        this.on('postcollision', (evt) => this.onPostCollision(evt));\n    }\n\n    onPostCollision(evt: ex.PostCollisionEvent) {\n        if (evt.other instanceof Bot && evt.side === ex.Side.Top) {\n            Resources.gotEm.play(.1);\n            // Clear patrolling\n            this.actions.clearActions();\n            // Remove ability to collide\n            this.body.collisionType = ex.CollisionType.PreventCollision;\n\n            // Launch into air with rotation\n            this.vel = new ex.Vector(0, -300);\n            this.acc = ex.Physics.acc;\n            this.angularVelocity = 2;\n        }\n    }\n\n    // Change animation based on velocity \n    onPostUpdate() {\n        if (this.vel.x < 0) {\n            this.graphics.use(\"left\");\n        } else if (this.vel.x > 0) {\n            this.graphics.use(\"right\");\n        }\n    }\n    \n}","import * as ex from 'excalibur';\nimport { botSpriteSheet, Resources } from './resources';\nimport { Baddie } from './baddie';\n\nexport class Bot extends ex.Actor {\n    public onGround = true;\n    public jumped = false;\n    public hurt = false;\n    public hurtTime: number = 0;\n    constructor(x: number, y: number) {\n        super({\n            name: 'Bot',\n            pos: new ex.Vector(x, y),\n            collisionType: ex.CollisionType.Active,\n            collisionGroup: ex.CollisionGroupManager.groupByName(\"player\"),\n            collider: ex.Shape.Box(32, 50, ex.Vector.Half, ex.vec(0, 3))\n        });\n    }\n\n    // OnInitialize is called before the 1st actor update\n    onInitialize(engine: ex.Engine) {\n        // Initialize actor\n\n        // Setup visuals\n        const hurtleft = ex.Animation.fromSpriteSheet(botSpriteSheet, [0, 1, 0, 1, 0, 1], 150);\n        hurtleft.scale = new ex.Vector(2, 2);\n\n        const hurtright = ex.Animation.fromSpriteSheet(botSpriteSheet, [0, 1, 0, 1, 0, 1], 150);\n        hurtright.scale = new ex.Vector(2, 2);\n        hurtright.flipHorizontal = true;\n\n        const idle = ex.Animation.fromSpriteSheet(botSpriteSheet, [2, 3], 800);\n        idle.scale = new ex.Vector(2, 2);\n\n        const left = ex.Animation.fromSpriteSheet(botSpriteSheet, [3, 4, 5, 6, 7], 100);\n        left.scale = new ex.Vector(2, 2);\n\n        const right = ex.Animation.fromSpriteSheet(botSpriteSheet, [3, 4, 5, 6, 7], 100);\n        right.scale = new ex.Vector(2, 2);\n        right.flipHorizontal = true;;\n\n        // Register animations with actor\n        this.graphics.add(\"hurtleft\", hurtleft);\n        this.graphics.add(\"hurtright\", hurtright);\n        this.graphics.add(\"idle\", idle);\n        this.graphics.add(\"left\", left);\n        this.graphics.add(\"right\", right);\n\n        // onPostCollision is an event, not a lifecycle meaning it can be subscribed to by other things\n        this.on('postcollision', (evt) => this.onPostCollision(evt));\n    }\n\n    onPostCollision(evt: ex.PostCollisionEvent) {\n        // Bot has collided with it's Top of another collider\n        console.log(evt.other.name);\n        if (evt.side === ex.Side.Bottom) {\n            this.onGround = true;\n        }\n\n        // Bot has collided on the side, display hurt animation\n        if ((evt.side === ex.Side.Left ||\n             evt.side === ex.Side.Right) &&\n            evt.other instanceof Baddie) {\n            if (this.vel.x < 0 && !this.hurt) {\n                this.graphics.use(\"hurtleft\");\n            } \n            if (this.vel.x >= 0 && !this.hurt) {\n                this.graphics.use(\"hurtright\");\n            }\n            this.hurt = true;\n            this.hurtTime = 1000;\n            Resources.hit.play(.1);\n        }\n    }\n\n    // After main update, once per frame execute this code\n    onPreUpdate(engine: ex.Engine, delta: number) {\n        // If hurt, count down\n        if (this.hurtTime >= 0 && this.hurt) {\n            this.hurtTime -= delta;\n            if (this.hurtTime < 0) {\n                this.hurt = false;\n            }\n        }\n\n        // Reset x velocity\n        this.vel.x = 0;\n\n        // Player input\n        if(engine.input.keyboard.isHeld(ex.Input.Keys.Left)) {\n            this.vel.x = -150;\n        }\n\n        if(engine.input.keyboard.isHeld(ex.Input.Keys.Right)) {\n            this.vel.x = 150;\n        }\n\n        if(engine.input.keyboard.isHeld(ex.Input.Keys.Up) && this.onGround) {\n            this.vel.y = -400;\n            this.onGround = false;\n            Resources.jump.play(.1);\n        }\n\n        // Change animation based on velocity\n        if (this.vel.x < 0 && !this.hurt) {\n            this.graphics.use(\"left\");\n        } \n        if (this.vel.x > 0 && !this.hurt) {\n            this.graphics.use(\"right\");\n        }\n        if (this.vel.x === 0 && !this.hurt){\n            this.graphics.use(\"idle\")\n        }\n    }\n}","import * as ex from 'excalibur';\nimport { ExcaliburGraphicsContext } from 'excalibur';\nimport { blockSprite } from './resources';\n\nexport class Floor extends ex.Actor {\n    constructor(x: number, y: number, public cols: number, public rows: number) {\n        super({\n            name: 'Floor',\n            pos: new ex.Vector(x, y),\n            scale: new ex.Vector(2, 2),\n            anchor: ex.Vector.Zero,\n            collider: ex.Shape.Box(20 * cols, 15 * rows, ex.Vector.Zero),\n            collisionType: ex.CollisionType.Fixed,\n            collisionGroup: ex.CollisionGroupManager.groupByName(\"floor\"),\n        });\n\n        for (let i = 0; i < this.cols; i++) {\n            for (let j = 0; j < this.rows; j++) {\n                this.graphics.show(blockSprite, { \n                    anchor: ex.Vector.Zero,\n                    offset: ex.vec(i * blockSprite.width, j * blockSprite.height)\n                })\n            }\n        }\n    }\n}\n","import * as ex from 'excalibur';\nimport { Baddie } from './baddie';\nimport { Bot } from './bot';\nimport { Floor } from './floor';\nimport { NPC } from './npc';\n\nexport class Level extends ex.Scene {\n    constructor() {\n        super();\n    }\n\n    onInitialize(engine: ex.Engine) {\n\n        // Create collision groups for the game\n        ex.CollisionGroupManager.create(\"player\");\n        ex.CollisionGroupManager.create(\"enemy\");\n        ex.CollisionGroupManager.create(\"floor\");\n\n        // Compose actors in scene\n        const actor = new Bot(engine.halfDrawWidth + 100, engine.halfDrawHeight - 100);\n\n        const baddie = new Baddie(engine.halfDrawWidth - 200, 300 - 30, 1);\n        const baddie2 = new Baddie(engine.halfDrawWidth + 200, 300 - 30, -1);\n\n        const npc = new NPC(400, 170);\n        \n        const floor = new Floor(0, 300, 15, 1);\n        const otherFloor = new Floor(engine.halfDrawWidth + 50, 200, 5, 1);\n\n        engine.add(actor);\n        engine.add(npc);\n        engine.add(baddie);\n        engine.add(baddie2);\n        engine.add(floor);\n        engine.add(otherFloor);\n\n        // For the test harness to be predicable\n        if (!(window as any).__TESTING) {\n            // Create camera strategy\n            this.camera.clearAllStrategies();\n            this.camera.strategy.elasticToActor(actor, 0.05, 0.1);\n        }\n    }\n}","import * as ex from 'excalibur';\nimport { loader } from './resources';\nimport { Level } from './level';\n\nconst engine = new ex.Engine({\n    backgroundColor: ex.Color.fromHex('#5fcde4'),\n    width: 600,\n    height: 400,\n    fixedUpdateFps: 60,\n    // Turn off anti-aliasing for pixel art graphics\n    antialiasing: false\n});\n\n// Set global gravity, 800 pixels/sec^2\nex.Physics.acc = new ex.Vector(0, 800);\n\n// Setup first level as a custom scene\nconst level = new Level();\nengine.add('level', level);\nengine.goToScene('level');\n\n// Game events to handle\nengine.on('hidden', () => {\n    console.log('pause');\n    engine.stop();\n});\nengine.on('visible', () => {\n    console.log('start');\n    engine.start();\n});\n\n// Start the engine\nengine.start(loader).then(() => {\n    console.log('game start');\n});\n\n// For test hook\n(window as any).engine = engine;\n(window as any).level = level;","import * as ex from 'excalibur';\nimport { botRedSpriteSheet, Resources, npcSprite } from './resources';\n\nexport class NPC extends ex.Actor {\n    public onGround = true;\n    public hurt = false;\n    public hurtTime: number = 0;\n    constructor(x: number, y: number) {\n        super({\n            pos: new ex.Vector(x, y),\n            collisionType: ex.CollisionType.Active,\n            collisionGroup: ex.CollisionGroupManager.groupByName(\"player\"),\n            collider: ex.Shape.Box(32, 50, ex.Vector.Half, ex.vec(0, 3))\n        });\n    }\n\n    // OnInitialize is called before the 1st actor update\n    onInitialize(engine: ex.Engine) {\n        // Initialize actor\n\n        // Set the z-index to be behind everything\n        this.z = -1;\n\n        // Setup visuals\n        const hurtleft = ex.Animation.fromSpriteSheet(botRedSpriteSheet, [0, 1, 0, 1, 0, 1], 150);\n        hurtleft.scale = new ex.Vector(2, 2);\n\n        const hurtright = ex.Animation.fromSpriteSheet(botRedSpriteSheet, [0, 1, 0, 1, 0, 1], 150);\n        hurtright.scale = new ex.Vector(2, 2);\n        hurtright.flipHorizontal = true;\n\n        const idle = ex.Animation.fromSpriteSheet(botRedSpriteSheet, [2, 3], 800);\n        idle.scale = new ex.Vector(2, 2);\n\n        const left = ex.Animation.fromSpriteSheet(botRedSpriteSheet, [3, 4, 5, 6, 7], 100);\n        left.scale = new ex.Vector(2, 2);\n\n        const right = ex.Animation.fromSpriteSheet(botRedSpriteSheet, [3, 4, 5, 6, 7], 100);\n        right.scale = new ex.Vector(2, 2);\n        right.flipHorizontal = true;\n\n        // Register drawings\n        this.graphics.add(\"hurtleft\", hurtleft);\n        this.graphics.add(\"hurtright\", hurtright);\n        this.graphics.add(\"idle\", idle);\n        this.graphics.add(\"left\", left);\n        this.graphics.add(\"right\", right);\n\n        // Setup patroling behavior\n\n        // For the test harness to be predicable\n        if (!(window as any).__TESTING) {\n            this.actions.delay(1000)\n                        .repeatForever(ctx => ctx\n                            .moveBy(100, 0, 20)\n                            .moveBy(-100, 0, 20));\n        }\n\n\n        // Custom draw after local tranform, draws word bubble\n        this.graphics.onPostDraw = (ctx) => {\n            npcSprite.draw(ctx, -10, -100);\n        }\n\n    }\n\n    onPostUpdate(engine: ex.Engine, delta: number) {\n        if (this.vel.x < 0) {\n            this.graphics.use(\"left\");\n        }\n        if (this.vel.x > 0) {\n            this.graphics.use(\"right\");\n        }\n        if (this.vel.x === 0) {\n            this.graphics.use(\"idle\")\n        }\n    }\n}","import * as ex from 'excalibur';\n\nconst botFile = require('../res/excalibot.png');\nconst botRedFile = require('../res/excalibot-red.png');\nconst baddieFile = require('../res/baddie.png');\nconst blockFile = require('../res/block.png');\nconst npcFile = require('../res/npc.png');\nconst jumpSound = require('../res/jump.wav');\nconst hitSound = require('../res/hurt.wav');\nconst gotEmSound = require('../res/gottem.wav');\n\nconst Resources = {\n    bot: new ex.ImageSource(botFile),\n    botRed: new ex.ImageSource(botRedFile),\n    baddie: new ex.ImageSource(baddieFile),\n    block: new ex.ImageSource(blockFile),\n    npc: new ex.ImageSource(npcFile),\n    jump: new ex.Sound(jumpSound),\n    hit: new ex.Sound(hitSound),\n    gotEm: new ex.Sound(gotEmSound)\n}\n\nconst loader = new ex.Loader();\n\nconst botSpriteSheet = ex.SpriteSheet.fromImageSource({\n    image:Resources.bot, \n    grid: { \n        columns: 8,\n        rows: 1, \n        spriteWidth: 32,\n        spriteHeight: 32\n    }\n});\nconst botRedSpriteSheet = ex.SpriteSheet.fromImageSource({\n    image: Resources.botRed,\n    grid: {\n        columns: 8, \n        rows: 1,\n        spriteWidth: 32,\n        spriteHeight: 32\n    }\n});\nconst baddieSpriteSheet = ex.SpriteSheet.fromImageSource({\n    image: Resources.baddie,\n    grid: {\n        columns: 6, \n        rows: 1,\n        spriteWidth: 32,\n        spriteHeight: 32\n    }\n});\nconst blockSprite = Resources.block.toSprite();\nconst npcSprite = Resources.npc.toSprite();\n\nfor (const res in Resources) {\n    loader.addResource((Resources as any)[res]);\n}\n\nexport { Resources, loader, botSpriteSheet, botRedSpriteSheet, baddieSpriteSheet, blockSprite, npcSprite }","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript)\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && !scriptUrl) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(519);\n"],"names":["__webpack_modules__","module","__unused_webpack_exports","entryUnbind","exports","path","Object","keys","isCallable","tryToString","$TypeError","TypeError","argument","isObject","$String","String","toIndexedObject","toAbsoluteIndex","lengthOfArrayLike","createMethod","IS_INCLUDES","$this","el","fromIndex","value","O","length","index","includes","indexOf","fails","METHOD_NAME","method","call","createProperty","$Array","Array","max","Math","start","end","k","fin","undefined","result","n","arraySlice","floor","mergeSort","array","comparefn","middle","insertionSort","merge","element","j","i","left","right","llength","rlength","lindex","rindex","uncurryThis","toString","stringSlice","slice","it","TO_STRING_TAG_SUPPORT","classofRaw","TO_STRING_TAG","wellKnownSymbol","$Object","CORRECT_ARGUMENTS","arguments","tag","key","error","tryGet","callee","hasOwn","ownKeys","getOwnPropertyDescriptorModule","definePropertyModule","target","source","exceptions","defineProperty","f","getOwnPropertyDescriptor","DESCRIPTORS","createPropertyDescriptor","object","bitmap","enumerable","configurable","writable","toPropertyKey","propertyKey","makeBuiltIn","defineGlobalProperty","options","simple","name","global","unsafe","nonConfigurable","nonWritable","P","get","documentAll","document","all","IS_HTMLDDA","EXISTS","createElement","firefox","match","UA","test","navigator","userAgent","version","process","Deno","versions","v8","split","webkit","CONSTRUCTOR","METHOD","prototype","createNonEnumerableProperty","defineBuiltIn","copyConstructorProperties","isForced","targetProperty","sourceProperty","descriptor","TARGET","GLOBAL","STATIC","stat","dontCallGetSet","forced","sham","exec","bind","hasOwnProperty","NATIVE_BIND","Function","apply","FunctionPrototype","getDescriptor","PROPER","CONFIGURABLE","uncurryThisWithBind","fn","namespace","aCallable","isNullOrUndefined","V","func","check","globalThis","window","self","g","this","toObject","a","classof","propertyIsEnumerable","store","functionToString","inspectSource","set","has","NATIVE_WEAK_MAP","shared","sharedKey","hiddenKeys","OBJECT_ALREADY_INITIALIZED","WeakMap","state","metadata","facade","STATE","enforce","getterFor","TYPE","type","$documentAll","replacement","feature","detection","data","normalize","POLYFILL","NATIVE","string","replace","toLowerCase","getBuiltIn","isPrototypeOf","USE_SYMBOL_AS_UID","$Symbol","toLength","obj","CONFIGURABLE_FUNCTION_NAME","InternalStateModule","enforceInternalState","getInternalState","join","CONFIGURABLE_LENGTH","TEMPLATE","getter","setter","arity","constructor","ceil","trunc","x","__unused_webpack_module","IE8_DOM_DEFINE","V8_PROTOTYPE_DEFINE_BUG","anObject","$defineProperty","$getOwnPropertyDescriptor","ENUMERABLE","WRITABLE","Attributes","current","propertyIsEnumerableModule","internalObjectKeys","concat","getOwnPropertyNames","getOwnPropertySymbols","push","names","enumBugKeys","$propertyIsEnumerable","NASHORN_BUG","input","pref","val","valueOf","getOwnPropertyNamesModule","getOwnPropertySymbolsModule","uid","SHARED","IS_PURE","mode","copyright","license","V8_VERSION","symbol","Symbol","toIntegerOrInfinity","min","integer","IndexedObject","requireObjectCoercible","number","isSymbol","getMethod","ordinaryToPrimitive","TO_PRIMITIVE","exoticToPrim","toPrimitive","id","postfix","random","NATIVE_SYMBOL","iterator","WellKnownSymbolsStore","createWellKnownSymbol","withoutSetter","$","deletePropertyOrThrow","internalSort","arrayMethodIsStrict","FF","IE_OR_EDGE","V8","WEBKIT","nativeSort","sort","FAILS_ON_UNDEFINED","FAILS_ON_NULL","STRICT_METHOD","STABLE_SORT","code","chr","fromCharCode","v","b","charAt","proto","itemsLength","items","arrayLength","y","getSortCompare","nativeKeys","d","Z","_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__","_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default","_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__","___CSS_LOADER_EXPORT___","_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1___default","__WEBPACK_DEFAULT_EXPORT__","cssWithMappingToString","list","map","item","content","needLayer","modules","media","dedupe","supports","layer","alreadyImportedModules","_k","cssMapping","btoa","base64","unescape","encodeURIComponent","JSON","stringify","sourceMapping","__webpack_module_cache__","moduleId","cachedModule","__esModule","definition","o","e","prop","r","toStringTag","fWn","Ia8","rqv","hLI","yyv","tX5","vtX","r7K","lCh","cE4","fwF","sce","AQ6","_c7","KUs","Ajp","dkO","RDh","_H9","mxs","OmD","kBf","C4F","NQt","JjN","EK_","V1s","xHm","Xz7","Cdc","FKn","SUY","ab2","GfZ","YMS","oyv","aUb","SdD","JUv","jEj","TFq","HDU","R_y","ydN","t50","s$$","v2G","Ilk","s9i","dxL","LLX","wA2","R_p","IQ$","I5F","X8$","FR6","U8o","kbG","iS_","cGG","RPN","skb","SLU","RdJ","cNu","gU7","LSk","Nmp","d1Y","xrL","sRW","cmV","qWz","N0Q","q8b","ynB","jT9","wAz","D4V","NLr","N6H","W1A","JHW","ZZ$","v2K","pBf","vpe","GMl","zW2","B0K","Nv7","C_p","MUA","xqU","pTp","vUK","j9l","Zxw","v51","Hdx","Z$d","iqV","o$7","olM","Zm$","$QH","i78","nJg","h6u","hts","j88","VME","fy2","nt","Ukr","zsu","oA6","TVh","TwZ","GTT","xxj","XdK","Jmb","cXo","Dm5","IIB","ebW","zI0","LYD","cEG","SEl","t9V","ez5","N1d","R8U","SKZ","__J","RI$","x12","ccz","aNw","XrL","xwn","dNK","ini","YdH","F5T","y3G","l57","xn0","t2V","uxB","cpd","fiy","$XZ","UG6","uqK","STE","y$z","mAD","sOq","hUw","_0G","Sqs","hpZ","Vol","vYX","wIZ","cBi","c30","MPV","RFv","Ux6","rxy","I$c","kfC","VjY","mgq","YVA","Kgp","HH$","M_d","rgh","Ra6","KhR","BS5","xhz","xOq","a9j","bHk","CgK","cuY","kvE","SBu","AE_","ctO","OLH","kky","nSF","zHn","zwx","AeJ","hLz","D9g","wA","jhr","GVs","_zO","LXZ","w6$","mhV","MOD","kwd","Lmr","xsS","K5l","lLr","Z$r","IXb","SGH","SMj","L34","exe","bnF","MFA","$uU","Sap","jyi","E03","V6q","rg2","DVW","nVo","F6N","xP7","Odq","Zif","ZGJ","MJk","xvT","PHM","dpR","n9L","KwO","SxM","B7y","x7r","wx7","Uvn","OFT","xzN","CcZ","M5Z","ZrN","OWs","dF9","oZy","rD2","VHo","ohE","R$E","xQN","AdJ","q3I","Pab","uZ5","McK","F9c","k0b","hnT","RSJ","Mku","h90","rms","ErP","aVg","lPc","Z8E","_N2","yFn","lNv","cu9","MZQ","FUM","BxR","vdf","iaL","w6H","Q4c","Xxe","Uxb","Yr5","Bhw","yOA","Events_namespaceObject","ActivateEvent","CollisionEndEvent","CollisionPostSolveEvent","CollisionPreSolveEvent","CollisionStartEvent","ContactEndEvent","ContactStartEvent","DeactivateEvent","EnterTriggerEvent","EnterViewPortEvent","EventTypes","ExitTriggerEvent","ExitViewPortEvent","GameEvent","GameStartEvent","GameStopEvent","GamepadAxisEvent","GamepadButtonEvent","GamepadConnectEvent","GamepadDisconnectEvent","HiddenEvent","InitializeEvent","KillEvent","PostCollisionEvent","PostDebugDrawEvent","PostDrawEvent","PostFrameEvent","PostKillEvent","PostUpdateEvent","PreCollisionEvent","PreDebugDrawEvent","PreDrawEvent","PreFrameEvent","PreKillEvent","PreUpdateEvent","VisibleEvent","webgl_util_namespaceObject","getAttributeComponentSize","getAttributePointerType","getGlTypeSizeBytes","DrawUtil_namespaceObject","circle","line","point","roundRect","vector","Input_Index_namespaceObject","Axes","Buttons","Gamepad","Gamepads","KeyEvent","Keyboard","Keys","NativePointerButton","PointerButton","PointerComponent","PointerEvent","PointerEventReceiver","PointerScope","PointerSystem","PointerType","WheelDeltaMode","WheelEvent","LogLevel","Util_Index_namespaceObject","polyfill","audioContext","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","callback","setInterval","cancelAnimationFrame","webkitCancelAnimationFrame","mozCancelAnimationFrame","AudioContext","webkitAudioContext","replaceMe","decodeAudioData","arrayBuffer","Promise","resolve","reject","mozAudioContext","msAudioContext","oAudioContext","devicePixelRatio","ConsoleAppender","DrawUtil","EasingFunctions","Logger","Observable","ScreenAppender","addItemToArray","contains","delay","fail","getPosition","removeItemFromArray","Flags","useCanvasGraphicsContext","enable","freeze","_FROZEN","_reset","_FLAGS","flagName","Error","disable","isEnabled","show","createId","EventEmitter","_paused","_listeners","_listenersOnce","_pipes","clear","on","eventName","handler","_a","close","off","once","_b","_c","_d","listenerIndex","splice","onceIndex","emit","event","forEach","onces","pipe","emitter","unpipe","pause","unpause","_bubbles","bubbles","stopPropagation","super","ctx","delta","engine","prevStats","stats","gamepad","button","axis","actor","other","side","intersection","contact","context","events","enabled","supported","getGamepads","_gamePadTimeStamps","_oldPads","_pads","_initSuccess","_navigator","_minimumConfiguration","init","_clonePads","setMinimumGamepadConfiguration","config","_enableAndUpdate","update","_isGamepadValid","pad","axesLength","axes","filter","buttonLength","buttons","connected","gamepads","at","timestamp","bi","ai","navigatorGamepad","getButton","pressed","updateButton","getAxes","updateAxes","_clonePad","getValidGamepads","count","p","pads","arr","len","clonedPad","MinAxisMoveThreshold","_axes","_buttons","_buttonsUp","_buttonsDown","isButtonPressed","threshold","isButtonHeld","wasButtonPressed","wasButtonReleased","Boolean","abs","buttonIndex","axesIndex","_appenders","defaultLevel","Info","_INSTANCE","addAppender","getInstance","appender","clearAppenders","_log","level","args","log","debug","Debug","info","warn","Warn","fatal","Fatal","console","consoleArgs","unshift","width","height","_messages","_canvas","innerWidth","innerHeight","style","position","_ctx","getContext","body","appendChild","message","clearRect","pos","opacity","fillStyle","toFixed","fillText","isCrossOriginIframe","noop","top","addEventListener","removeEventListener","originalEvent","_keys","_keysUp","_keysDown","_releaseAllKeys","ev","keyEvent","from","Set","_handleKeyDown","metaKey","MetaLeft","MetaRight","_handleKeyUp","keyboardOptions","grabWindowFocus","focus","getKeys","wasPressed","isHeld","wasReleased","triggerEvent","character","KeyboardEvent","BITMASK32","Random","seed","_lowerMask","_upperMask","_w","_n","_m","_u","_s","_t","_l","_f","_mt","Date","now","s","_index","_twist","mag01","nextInt","next","floating","bool","likelihood","pickOne","pickSet","numPicks","allowDuplicates","_pickSetWithDuplicates","_pickSetWithoutDuplicates","currentPick","tempArray","shuffle","swap","randomIndex","range","d4","d6","d8","d10","d12","d20","TwoPI","PI","frac","sign","clamp","canonicalizeAngle","angle","tmpAngle","toDegrees","radians","toRadians","degrees","to","_x","randomInRange","randomIntInRange","round","Vector","Zero","One","Half","Up","Down","Left","Right","fromAngle","cos","sin","isValid","vec","isNaN","Infinity","distance","vec1","vec2","sqrt","pow","_y","setTo","equals","tolerance","deltaX","deltaY","squareDistance","clampMagnitude","magnitude","newSize","size","newLength","scale","average","add","sizeOrScale","dest","sub","addEqual","subEqual","scaleEqual","dot","cross","num","perpendicular","normal","negate","toAngle","atan2","rotate","anchor","sinAngle","cosAngle","clone","fixed","Color","fromRGB","fromRGBString","parseInt","parseFloat","fromHex","hex","fromHSL","h","l","HSLColor","toRGBA","lighten","factor","temp","fromRGBA","darken","saturate","desaturate","multiply","color","newR","newG","newB","newA","screen","color1","invert","color2","equal","format","toHSLA","toHex","_componentToHex","c","Black","White","Gray","LightGray","DarkGray","Yellow","Orange","Red","Vermilion","Rose","Magenta","Violet","Blue","Azure","Cyan","Viridian","Green","Chartreuse","Transparent","ExcaliburBlue","hue2rgb","q","t","Side","MatrixLocations","getOpposite","Top","Bottom","None","fromDirection","direction","directions","directionEnum","Number","MAX_VALUE","maxIndex","BoundingBox","leftOrOptions","bottom","getSideFromIntersection","fromPoints","points","minX","minY","maxX","maxY","fromDimension","hasZeroDimensions","center","translate","getPoints","shifted","transform","matrix","xa1","xa2","xb1","xb2","ya1","ya2","yb1","yb2","matrixPos","getPerimeter","results","rayCast","ray","farClipDistance","tmin","tmax","xinv","dir","yinv","tx1","tx2","ty1","ty2","rayCastTime","combine","dimensions","overlaps","epsilon","totalBoundingBox","intersect","overlapX","overlapY","intersectWithSide","bb","draw","ex","drawRect","Future","_isCompleted","promise","_resolver","_rejecter","isCompleted","oLeft","oTop","calcOffsetLeft","parent","offsetLeft","offsetParent","calcOffsetTop","offsetTop","milliseconds","clock","future","schedule","setTimeout","Matrix","Float32Array","_scaleX","_scaleSignX","_scaleY","_scaleSignY","ortho","near","far","mat","toDOMMatrix","DOMMatrix","fromFloat32Array","identity","reset","translation","sx","sy","rotation","angleRadians","vectorOrMatrix","resultX","resultY","a11","a21","a31","a41","a12","a22","a32","a42","a13","a23","a33","a43","a14","a24","a34","a44","b11","b21","b31","b41","b12","b22","b32","b42","b13","b23","b33","b43","b14","b24","b34","b44","getScale","setPosition","sine","cosine","setRotation","currentScale","getRotation","getScaleY","getScaleX","xscale","yscale","setScaleX","setScaleY","setScale","getBasisDeterminant","getAffineInverse","inverseDet","m","tx","ty","isIdentity","AffineMatrix","Float64Array","_scale","determinant","inverse","to4x4","TransformStack","_transforms","_currentTransform","save","restore","pop","StateStack","_states","_currentState","_getDefaultState","z","tint","material","_cloneState","ResourceEvents","Complete","Load","LoadStart","Progress","Resource","responseType","bustCache","logger","isLoaded","_cacheBust","uri","load","request","XMLHttpRequest","open","status","response","statusText","send","watch","change","__isProxy","Proxy","watchAny","Graphic","isStale","_transformStale","flipHorizontal","_flipHorizontal","flipVertical","_flipVertical","_rotation","origin","_origin","_e","_ID","showDebug","_width","_height","cloneGraphicOptions","localBounds","_preDraw","_drawImage","_postDraw","_rotate","_flip","scaleDirX","scaleDirY","Sprite","image","_logger","_dirty","_logNotLoadedWarning","sourceView","destSize","_updateSpriteDimensions","ready","then","newWidth","newHeight","nativeWidth","nativeHeight","drawImage","ImageFiltering","TextureLoader","gl","_textureMap","Map","_gl","_MAX_TEXTURE_SIZE","getParameter","MAX_TEXTURE_SIZE","filtering","forceUpdate","tex","bindTexture","TEXTURE_2D","texImage2D","RGBA","UNSIGNED_BYTE","createTexture","checkImageSizeSupportedAndLog","pixelStorei","UNPACK_PREMULTIPLY_ALPHA_WEBGL","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","filterMode","TEXTURE_MIN_FILTER","Pixel","NEAREST","LINEAR","TEXTURE_MAG_FILTER","deleteTexture","originalSrc","dataset","_LOGGER","Blended","ImageSource","naturalWidth","naturalHeight","_src","src","Image","_readyFuture","_resource","endsWith","url","blob","URL","createObjectURL","loadedFuture","onload","setAttribute","toSprite","unload","SpriteSheet","sprites","rows","columns","getSprite","spriteIndex","fromImageSourceWithSourceViews","sourceViews","fromImageSource","spacing","grid","cols","spriteWidth","spriteHeight","originOffset","margin","offsetDefaults","marginDefaults","sprite","SpriteFont","_text","alphabet","shadow","caseInsensitive","_alreadyWarnedAlphabet","_alreadyWarnedSpriteSheet","spriteSheet","_getCharacterSprites","text","textToRender","toLocaleLowerCase","letterIndex","letter","letterSprite","measureText","maxWidth","lines","_getLinesFromText","maxWidthLine","reduce","xCursor","yCursor","render","_color","bounds","offset","_cachedText","_cachedRenderWidth","_cachedLines","newLine","DebugText","fontSheet","_imageSource","_spriteSheet","_spriteFont","write","RenderSource","_texture","use","activeTexture","TEXTURE0","RenderTarget","_setupFramebuffer","setResolution","_frameTexture","frameBuffer","_frameBuffer","frameTexture","attachmentPoint","COLOR_ATTACHMENT0","createFramebuffer","bindFramebuffer","FRAMEBUFFER","framebufferTexture2D","toRenderSource","viewport","FLOAT","SHORT","UNSIGNED_SHORT","BYTE","LOW_FLOAT","HIGH_FLOAT","FLOAT_VEC2","FLOAT_VEC3","FLOAT_VEC4","Shader","compiled","_compiled","uniforms","attributes","vertexSource","fragmentSource","useProgram","program","_ACTIVE_SHADER_INSTANCE","isCurrentlyBound","compile","vertexShader","_compileShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","_createProgram","getAttributes","attribute","getUniforms","uniform","uniformCount","getProgramParameter","ACTIVE_UNIFORMS","getActiveUniform","uniformLocation","getUniformLocation","glType","location","attributeCount","ACTIVE_ATTRIBUTES","getActiveAttrib","attributeLocation","getAttribLocation","normalized","setTexture","slotNumber","texture","setUniformInt","setUniform","trySetUniformInt","trySetUniform","setUniformIntArray","trySetUniformIntArray","setUniformBoolean","trySetUniformBoolean","setUniformFloat","trySetUniformFloat","setUniformFloatArray","trySetUniformFloatArray","setUniformFloatVector","trySetUniformFloatVector","setUniformFloatColor","trySetUniformFloatColor","setUniformMatrix","trySetUniformMatrix","uniformType","createProgram","attachShader","linkProgram","LINK_STATUS","getProgramInfoLog","typeName","shader","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","errorInfo","getShaderInfoLog","_processSourceForError","errorLineStart","search","errorLineEnd","_","error2","VertexBuffer","buffer","createBuffer","bufferData","bindBuffer","ARRAY_BUFFER","STATIC_DRAW","DYNAMIC_DRAW","upload","bufferSubData","VertexLayout","vertexBuffer","_vertexBuffer","_attributes","_layout","_vertexTotalSizeBytes","_shader","initialize","totalVertexSizeBytes","shaderAttributes","attrib","componentsPerVertex","vertAttribute","typeSize","uploadBuffer","vert","vertexAttribPointer","enableVertexAttribArray","GraphicsDiagnostics","DrawCallCount","DrawnImagesCount","LineRenderer","priority","_maxLines","_vertexIndex","_lineCount","_context","_isFull","flush","getTransform","finalStart","finalEnd","hasPendingDraws","drawArrays","LINES","PointRenderer","_maxPoints","_pointCount","_buffer","snapToPixel","finalPoint","pixelSnapEpsilon","POINTS","ScreenPassPainter","renderWithPostProcessor","postprocessor","getShader","getLayout","TRIANGLES","renderToScreen","QuadIndexBuffer","numberOfQuads","useUint16","ELEMENT_ARRAY_BUFFER","totalVertices","maxUint16","maxUint16Index","bufferGlType","Uint16Array","Uint32Array","currentQuad","ImageRenderer","_maxImages","_maxTextures","_imageCount","_textures","MAX_TEXTURE_IMAGE_UNITS","transformedFrag","_transformFragmentSource","_quads","maxTextures","newSource","texturePickerBuilder","_addImageAsTexture","maybeFiltering","getAttribute","force","textureLoader","removeAttribute","_bindTextures","_getTextureIdForImage","maybeTexture","swidth","sheight","dx","dy","dwidth","dheight","view","sw","sh","topLeft","topRight","bottomLeft","bottomRight","textureId","imageWidth","imageHeight","uvx0","uvy0","uvx1","uvy1","drawElements","RectangleRenderer","_maxRectangles","_rectangleCount","drawLine","drawRectangle","thickness","halfThick","startTop","startBottom","endTop","endBottom","stroke","strokeThickness","CircleRenderer","_maxCircles","_circleCount","radius","Pool","builder","recycler","maxObjects","totalAllocations","objects","disableWarnings","preallocate","using","done","borrow","poolIndex","DrawCall","Material","_initialized","_name","_vertexSource","_fragmentSource","MaterialRenderer","vertexIndex","ExcaliburGraphicsContextWebGLDebug","_webglCtx","_debugText","rectOptions","lineOptions","drawPoint","pointOptions","drawText","ExcaliburGraphicsContextWebGL","_state","__gl","canvas","_ortho","checkIfResolutionSupported","dim","_renderers","_isDrawLifecycle","useDrawSorting","_drawCallPool","instance","renderer","_drawCalls","_postProcessTargets","_postprocessors","_transform","smoothing","backgroundColor","_alreadyWarnedDrawLifecycle","_totalPostProcessorTime","canvasElement","enableTransparency","antialias","premultipliedAlpha","alpha","depth","powerPreference","_init","clearColor","COLOR_BUFFER_BIT","BLEND","blendEquation","FUNC_ADD","blendFunc","ONE","ONE_MINUS_SRC_ALPHA","blendEquationSeparate","blendFuncSeparate","register","_screenRenderer","_renderTarget","rendererName","_isCurrentRenderer","_currentRenderer","beginDrawLifecycle","endDrawLifecycle","drawCall","resetTransform","updateViewport","resolution","trace","drawCircle","addPostProcessor","removePostProcessor","clearPostProcessors","updatePostProcessors","find","u","onUpdate","createMaterial","originalSort","firstIndex","findIndex","dc","zIndex","originalSortOrder","oldTransform","oldState","currentRendererName","currentRenderer","values","ExcaliburGraphicsContext2DCanvas_pixelSnapEpsilon","ExcaliburGraphicsContext2DCanvasDebug","_ex","__ctx","strokeStyle","strokeRect","beginPath","moveTo","lineTo","lineWidth","closePath","arc","fill","ExcaliburGraphicsContext2DCanvas","imageSmoothingEnabled","_resolution","globalAlpha","fillRect","setTransform","_postprocessor","_delta","_options","DisplayMode","Resolution","SVGA","Standard","Atari2600","GameBoy","GameBoyAdvance","NintendoDS","NES","SNES","Screen","_antialiasing","_resolutionStack","_viewportStack","_pixelRatioOverride","_isFullScreen","_isDisposed","_fullscreenChangeHandler","_pixelRatioChangeHandler","_listenForPixelRatio","_devicePixelRatio","_calculateDevicePixelRatio","applyResolutionAndViewport","_resizeHandler","_setResolutionAndViewportByDisplayMode","_alreadyWarned","_contentArea","_contentResolution","_displayMode","displayMode","Fixed","graphicsContext","antialiasing","_browser","browser","pixelRatio","_applyDisplayMode","_mediaQueryList","removeListener","nativeComponent","matchMedia","addListener","dispose","_resizeObserver","disconnect","isHiDpi","FillContainer","FitContainer","FitContainerAndFill","FitContainerAndZoom","parentElement","_viewport","aspectRatio","scaledWidth","scaledHeight","setCurrentCamera","camera","_camera","pushResolutionAndViewport","peekViewport","peekResolution","popResolutionAndViewport","imageRendering","isSmooth","isFullScreen","goFullScreen","elementId","maybeElement","getElementById","requestFullscreen","exitFullScreen","exitFullscreen","pageToScreenCoordinates","newX","newY","screenHeight","screenWidth","screenToPageCoordinates","screenMarginY","screenMarginX","screenToWorldCoordinates","worldToScreenCoordinates","pageToWorldCoordinates","worldToPageCoordinates","getWorldBounds","zoom","canvasWidth","halfCanvasWidth","canvasHeight","halfCanvasHeight","drawWidth","halfDrawWidth","drawHeight","halfDrawHeight","contentArea","_computeFit","overflow","aspect","adjustedWidth","adjustedHeight","_computeFitScreenAndFill","vw","vh","_computeFitAndFill","_computeFitContainerAndFill","clientWidth","clientHeight","clip","_computeFitScreenAndZoom","_computeFitAndZoom","_computeFitContainerAndZoom","scaleX","scaleY","maxScaleFactor","zoomedWidth","zoomedHeight","_computeFitContainer","Window","ResizeObserver","observe","FillScreen","FitScreen","FitScreenAndFill","FitScreenAndZoom","AudioContextFactory","create","WebAudio","unlock","_UNLOCKED","unlockTimeoutTimer","resume","createBufferSource","ended","connect","destination","onended","playbackState","isLegacyWebAudioSource","currentTime","PLAYING_STATE","FINISHED_STATE","clearTimeout","isUnlocked","x1","y1","x2","y2","cap","lineCap","br","tl","tr","bl","defaultRadius","quadraticCurveTo","Loader_0","Raster","_g","_h","_j","quality","_smoothing","flagDirty","_lineWidth","_lineDash","_padding","strokeColor","lineDash","padding","_bitmap","bitmapWidth","bitmapHeight","maybeCtx","cloneRasterOptions","dirty","_getTotalWidth","_originalWidth","_getTotalHeight","_originalHeight","_strokeColor","rasterize","_applyRasterProperties","execute","setLineDash","getLineDash","Canvas","cache","ExResponse","any","json","arraybuffer","StateMachine","states","currentState","machineDescription","machine","stateName","transitionState","transitions","startState","go","eventData","potentialNewState","onExit","onEnter","onState","elapsedMs","saveKey","localStorage","setItem","parse","getItem","WebAudioInstance","_createNewBufferSource","_instance","_audioContext","loop","playbackRate","_playbackRate","_volumeNode","_handleEnd","_playingResolve","_loop","volume","_volume","_stateMachine","in","gain","setTargetAtTime","duration","_duration","getTotalPlaybackDuration","createGain","_playingPromise","PLAYING","pausedAt","startedAt","_playStarted","stop","SEEK","STOPPED","PAUSED","isPlaying","isPaused","play","playStarted","seek","getPlaybackPosition","MediaEvent","_value","_path","_val","action","propagate","layPath","_actor","NativeSoundEvent","track","NativeSoundProcessedEvent","_processedData","canPlayFile","file","Audio","filetype","canPlayType","SoundEvents","VolumeChange","Processed","Pause","Stop","PlaybackEnd","Resume","PlaybackStart","Sound","_tracks","instances","paths","_isStopped","_wasPlayingOnHidden","audiobuffer","decodeAudio","wireEngine","_engine","pauseAudioWhenHidden","instanceCount","some","_resumePlayback","_startPlayback","trackId","_getTrackInstance","getTrackId","resumed","complete","newTrack","LoaderEvents","Loader","_image","_imageElement","logo","playButtonRootElement","_playButtonRootElement","playButtonElement","_playButtonElement","_playButton","existingRoot","_styleBlock","textContent","_playButtonStyles","head","startButtonFactory","loadables","_resourceList","_playButtonShown","_resourceCount","_numLoaded","_progressCounts","_totalCounts","logoWidth","logoHeight","loadingBarColor","suppressPlayButton","playButtonText","buttonElement","display","_loadingFuture","addResources","addResource","loadable","showPlayButton","resizeHandler","_positionPlayButton","evt","click","playButtonClicked","startButtonHandler","hidePlayButton","removeChild","areResourcesLoaded","decode","async","finally","resource","markResourceComplete","progress","buttonWidth","buttonHeight","playButtonPosition","logoY","logoX","logoPosition","oldAntialias","getAntialiasing","setAntialiasing","loadingX","loadingY","loadingBarPosition","progressWidth","REPORTED_FEATURES","webgl","webaudio","gamepadapi","Detector","_features","failedTests","_criticalTests","canvasSupport","elem","arrayBufferSupport","xhr","dataUrlSupport","toDataURL","objectUrlSupport","rgbaSupport","cssText","_warningTest","webAudioSupport","webglSupport","_loadBrowserFeatures","getBrowserFeatures","logBrowserFeatures","msg","dataurl","objecturl","rgba","failedCritical","warning","CollisionType","maxMessages","obsoleteMessage","resetObsoleteCounter","logMessage","suppressObsoleteMessages","showStackTrace","obsolete","alternateMethod","property","SyntaxError","DecoratedClass","CollisionResolutionStrategy","BroadphaseStrategy","Integrator","CoordPlane","Physics","gravity","acc","useArcadePhysics","collisionResolutionStrategy","Arcade","useRealisticPhysics","Realistic","dynamicTreeVelocityMultiplyer","dynamicTreeVelocityMultiplier","broadphaseStrategy","DynamicAABBTree","defaultMass","integrator","Euler","boundsPadding","positionIterations","velocityIterations","slop","steeringFactor","warmStart","bodiesCanSleepByDefault","surfaceEpsilon","sleepEpsilon","wakeThreshold","sleepBias","checkForFastBodies","disableMinimumSpeedForFastBody","decorators","desc","Reflect","decorate","__decorate","VectorView","_getX","getX","_getY","getY","_setX","setX","_setY","setY","WatchVector","original","Transform","_parent","_children","_pos","_isDirty","_isInverseDirty","_matrix","_inverse","children","globalPos","localPos","canonRotation","globalRotation","inverseRotation","globalScale","inverseScale","globalScaleX","globalScaleY","_calculateMatrix","applyInverse","Component","owner","newComponent","TagComponent","observers","subscriptions","observer","subscribe","unregister","unsubscribe","notifyAll","observersLength","notify","subscriptionsLength","TransformComponent","_addChildTransform","child","childTxComponent","zIndexChanged$","_z","coordPlane","World","onAdd","childrenAdded$","childrenRemoved$","onRemove","_previousOwner","oldz","component","MotionComponent","vel","scaleFactor","angularVelocity","torque","inertia","CollisionGroup","category","mask","_category","_mask","canCollide","collisionGroups","combinedName","combinedCategory","collidesWith","All","Pair","colliderA","colliderB","calculatePairHash","bodyA","BodyComponent","bodyB","group","collisionType","PreventCollision","active","collide","hasCollider","collider","idA","idB","Projection","projection","getOverlap","TreeNode","isLeaf","DynamicTree","worldBounds","root","nodes","_insert","leaf","leafAABB","currentRoot","area","combinedArea","cost","inheritanceCost","leftCost","leftCombined","newArea","oldArea","rightCost","rightCombined","oldParent","newParent","currentNode","_balance","_remove","grandParent","sibling","trackCollider","node","updateCollider","untrackCollider","multdx","multdy","balance","getHeight","query","helper","rayCastQuery","getNodes","Ray","numerator","begin","getSlope","divisor","getLength","intersectPoint","time","getPoint","DynamicTreeCollisionProcessor","_dynamicCollisionTree","_pairs","_collisionPairCache","_colliders","getColliders","maxDistance","collisionGroup","searchAllColliders","maybeBody","hit","CompositeCollider","colliders","untrack","_pairExists","hash","broadphase","targets","seconds","potentialColliders","pair","physics","pairs","Active","updateDistance","minDimension","fastBodies","updateVec","oldPos","centerPoint","furthestPoint","getFurthestPoint","minCollider","minTranslate","hitPoint","shift","fastBodyCollisions","narrowphase","contacts","newContacts","collisions","updated","Collider","__compositeColliderId","touching","_collisionProcessor","_dynamicAABBTree","addCollider","clearColliders","removeCollider","worldPos","furthestPoints","bestPoint","getInertia","mass","totalInertia","otherColliders","potentialCollider","getClosestLineBetween","maybeLine","minLength","minLine","minPoint","minDistance","project","projs","proj","newProjection","LineSegment","slope","intercept","_normal","_dir","_slope","getEdge","_length","midpoint","flip","below","sideVector","clipTime","distanceToPoint","signed","x0","y0","findVectorToPoint","aMinusP","findPoint","hasPoint","currPoint","dxc","dyc","dx1","dy1","ClosestLine","p0","q0","w0","denom","sDenom","tDenom","tClosestParallel","sClosest","tClosest","ClosestLineJumpTable","PolygonPolygonClosestLine","polygonA","polygonB","otherWorldPos","otherDirection","thisDirection","rayTowardsOther","rayTowardsThis","thisPoint","otherPoint","thisFace","getClosestFace","otherFace","face","PolygonEdgeClosestLine","polygon","edge","edgeLine","asLine","PolygonCircleClosestLine","circlex","circley","CircleCircleClosestLine","circleA","circleB","CircleEdgeClosestLine","circleWorlPos","EdgeEdgeClosestLine","edgeA","edgeB","edgeLineA","edgeLineB","CircleCollider","_globalMatrix","_naturalRadius","orig","discriminant","toi","toi1","toi2","positiveToi","mintoi","shape","PolygonCollider","EdgeCollider","CollisionJumpTable","CollideCircleCircle","CollideCirclePolygon","CollideCircleEdge","getFurthestLocalPoint","scalars","dotProduct","CollisionContact","mtv","tangent","localPoints","_canceled","matchAwake","sleeping","sleepMotion","setSleeping","isCanceled","cancel","SeparatingAxis","findPolygonPolygonSeparation","polyA","polyB","bestSeparation","bestSide","bestAxis","bestSideIndex","bestOtherPoint","sides","getSides","localSides","getLocalSides","vertB","vertSeparation","separation","localSide","sideId","localPoint","findCirclePolygonSeparation","polyDir","closestPointOnPoly","minOverlap","minAxis","minIndex","proj1","proj2","overlap","circleAPos","circleBPos","combinedRadius","mvt","local","samedir","findSide","findLocalSide","cc","edgeWorld","asLocalLine","da","dda","db","ddb","den","pointOnEdge","dd","CollideEdgeEdge","CollidePolygonEdge","pc","linePoly","CollidePolygonPolygon","separationA","separationB","incident","reference","refDir","clipRight","clipLeft","xf","FindContactSeparation","shapeA","txA","shapeB","txB","worldPoint","circlePoint","dist","_getTransformedBegin","_getTransformedEnd","transformedBegin","transformedEnd","_boundsFromBeginEnd","edgeNormal","_localBoundsDirty","_localSidesDirty","_sidesDirty","_points","_transformedPoints","_sides","_localSides","_transformedPointsDirty","_isCounterClockwiseWinding","reverse","isConvex","_calculateTransformation","sum","oldPoint","newPoint","oldDirection","orientation","angleSum","entries","tessellate","polygons","Shape","Polygon","triangulate","isPointInTriangle","ab","bc","ca","ap","bp","cp","cross1","cross2","cross3","triangles","vertices","indices","va","vb","vc","leftArm","isEar","vertIndex","getTransformedPoints","currentSide","mostDirection","testRay","accum","pts","POSITIVE_INFINITY","faceIndex","_localBounds","_cachedMass","_cachedInertia","denominator","iplusone","crossTerm","minContactTime","contactIndex","contactTime","scalar","firstPoint","Box","Circle","Edge","Capsule","ColliderComponent","$colliderAdded","$colliderRemoved","_collider","flipped","entity","precollision","postcollision","useBoxCollider","usePolygonCollider","poly","useCircleCollider","useEdgeCollider","useCompositeCollider","DegreeOfFreedom","dependencies","_oldTransform","__oldTransformCaptured","enableFixedUpdateInterpolate","_mass","canSleep","_sleeping","bounciness","friction","useGravity","limitDegreeOfFreedom","oldVel","oldAcc","newMass","_cachedInverseInertia","inverseMass","updateMotion","currentMotion","bias","maybeCollider","inverseInertia","motion","oldRotation","oldScale","applyImpulse","impulse","finalImpulse","X","Y","Rotation","distanceFromCenter","applyLinearImpulse","applyAngularImpulse","captureOldTransform","AddedComponent","isAddedComponent","RemovedComponent","isRemovedComponent","EntityEvents","Initialize","PreUpdate","PostUpdate","Entity","components","scene","_componentsToRemove","_componentTypeToInstance","_componentStringToInstance","_tagsMemo","_typesMemo","componentAdded$","componentRemoved$","_isInitialized","_setName","addComponent","kill","unparent","isKilled","tags","hasTag","addTag","removeTag","removeComponent","types","_rebuildMemos","getComponents","_notifyAddComponent","added","_notifyRemoveComponent","removed","addChild","getAncestors","removeAllChildren","getDescendants","queue","curr","newEntity","addTemplate","templateEntity","ctor","constuctorType","componentOrType","_removeComponentByType","clearComponents","delete","processComponentRemoval","isInitialized","_initialize","onInitialize","_preupdate","onPreUpdate","_postupdate","onPostUpdate","hasGraphicsTick","graphic","tick","GraphicsLayer","_graphics","graphics","hide","nameOrGraphic","gfx","getGraphic","recalculateBounds","copyGraphics","getNames","order","currentKeys","graphicsComponent","GraphicsLayers","_component","_layers","_layerMap","default","_maybeAddLayer","_getLayer","graphicsLayerKeys","layers","GraphicsComponent","visible","onPreDraw","onPostDraw","graphicToSet","offsetX","offsetY","elapsed","idempotencyToken","Rectangle","_radius","useColliderShape","useGraphicsBounds","CreateReversibleEasingFunction","easing","CreateVectorEasingFunction","Linear","startValue","endValue","EaseInQuad","EaseOutQuad","EaseInOutQuad","EaseInCubic","EaseOutCubic","EaseInOutCubic","ActionQueue","_actions","_completedActions","_entity","remove","clearActions","_currentAction","getActions","hasNext","isComplete","Repeat","repeatBuilder","repeat","_stopped","_repeatBuilder","_repeatContext","ActionContext","_actionQueue","getQueue","_repeat","_originalRepeat","RepeatForever","MoveBy","speed","_started","_tx","_motion","_speed","_offset","_start","_end","_distance","MoveTo","destx","desty","RotationType","FontUnit","TextAlign","BaseAlign","FontStyle","Direction","RotateTo","rotationType","_rotationType","ShortestPath","_currentNonCannonAngle","distance1","distance2","_shortDistance","_longDistance","_shortestPathIsPositive","_direction","LongestPath","Clockwise","CounterClockwise","distanceTraveled","RotateBy","angleRadiansOffset","ScaleTo","speedX","speedY","_endX","_endY","_speedX","_speedY","_startX","_startY","_distanceX","_distanceY","directionX","directionY","ScaleBy","scaleOffsetX","scaleOffsetY","_startScale","_endScale","_directionX","_directionY","CallMethod","_method","_hasBeenCalled","EaseTo","easingFcn","_currentLerpTime","_lerpDuration","_lerpStart","_lerpEnd","EaseBy","Blink","timeVisible","timeNotVisible","numBlinks","_timeVisible","_timeNotVisible","_elapsedTime","_totalTime","Fade","endOpacity","_multiplier","_endOpacity","_ogspeed","Delay","_delay","Die","ActionsComponent","Follow","entityToFollow","followDistance","_followTx","_followMotion","_current","_maximumDistance","_distanceBetween","actorToFollowSpeed","Meet","actorToMeet","_speedWasSpecified","_meetTx","_meetMotion","actorToMeetSpeed","_queue","runAction","easeTo","easeBy","xOrPos","yOrSpeed","speedOrUndefined","moveBy","xOffsetOrVector","yOffsetOrSpeed","xOffset","yOffset","rotateTo","rotateBy","scaleTo","sizeXOrVector","sizeYOrSpeed","speedXOrUndefined","speedYOrUndefined","sizeX","sizeY","scaleBy","sizeOffsetXOrVector","sizeOffsetYOrSpeed","sizeOffsetX","sizeOffsetY","blink","fade","die","callMethod","times","repeatForever","follow","meet","toPromise","FontTextInstance","font","_textFragments","disposed","_setDimension","_lastHashCode","getHashCode","_applyFont","metrics","textHeight","actualBoundingBoxAscent","actualBoundingBoxDescent","lineAdjustedHeight","bottomBounds","actualBoundingBoxLeft","actualBoundingBoxRight","textBounds","fontString","textAlign","baseAlign","includeColor","textBaseline","shadowColor","shadowBlur","blur","shadowOffsetX","shadowOffsetY","_drawText","lineHeight","strokeText","_splitTextBitmap","textImages","currentX","currentY","hashCode","frag","_chachedText","_chachedLines","FontCache","_MEASURE_CACHE","measurement","measureTextWithoutCache","getTextInstance","textInstance","_TEXT_CACHE","_TEXT_USAGE","performance","checkAndClearCache","deferred","currentHashCodes","newTextMeasurementCache","cacheSize","clearCache","Font","_o","_p","_q","_r","family","Normal","bold","unit","Px","Alphabetic","LeftToRight","_textBounds","_textMeasurement","colorOverride","Text","_textWidth","_textHeight","_calculateDimension","_font","Actor","pointer","actions","thePos","theVel","theAcc","theAngle","_anchor","_handleAnchorChange","isOffScreen","draggable","_draggable","isDraggable","_pointerDragStartHandler","_pointerDragEndHandler","_pointerDragMoveHandler","_pointerDragLeaveHandler","currentGraphic","_dragging","pe","defaults","Passive","_prekill","_scene","onPreKill","_postkill","onPostKill","unkill","newZ","getGlobalPos","localCenter","getGlobalScale","getGlobalRotation","recurse","geom","containment","within","otherCollider","me","isScreenElement","ScreenElement","useWorld","coords","Timer","_complete","fcn","interval","repeats","numberOfRepeats","randomRange","_totalTimeAlive","_running","_numberOfTicks","maxNumberOfRepeats","_baseInterval","_generateRandomInterval","_MAX_ID","_callbacks","newInterval","newNumberOfRepeats","timesRepeated","getTimeRunning","timeToNextAction","timeElapsedTowardNextAction","isRunning","cancelTimer","ParallaxComponent","parallaxFactor","DebugGraphicsComponent","useTransform","TileMapEvents","PreDraw","PostDraw","TileMap","flagCollidersDirty","_collidersDirty","flagTilesDirty","tiles","_token","_rows","_cols","renderFromTopOfGraphic","_originalOffsets","_composite","_oldPos","_oldScale","tileWidth","tileHeight","currentCol","cd","Tile","_getOrSetColliderOriginalOffset","originalOffset","_updateColliders","tile","solid","prev","getTileByIndex","getTile","getTileByPoint","getRows","getColumns","xEnd","yEnd","graphicsIndex","graphicsLen","maybeParallax","oneMinusFactor","parallaxOffset","currentScene","getGraphics","grayish","_posDirty","_recalculate","_solid","addGraphic","removeGraphic","clearGraphics","_bounds","StrategyContainer","lockToActor","addStrategy","LockCameraToActorStrategy","lockToActorAxis","LockCameraToActorAxisStrategy","elasticToActor","cameraElasticity","cameraFriction","ElasticToActorStrategy","radiusAroundActor","RadiusAroundActorStrategy","limitCameraBounds","box","LimitCameraBoundsStrategy","Axis","_cam","_eng","cam","currentFocus","getFocus","cameraVel","stretch","boundSizeChecked","focusX","focusY","CameraEvents","Camera","_cameraStrategies","strategy","dz","az","_angularVelocity","_posChanged","_cameraMoving","_isShaking","_shakeMagnitudeX","_shakeMagnitudeY","_shakeDuration","_elapsedShakeTime","_xShake","_yShake","_isZooming","_zoomStart","_zoomEnd","_currentZoomTime","_zoomDuration","_zoomEasing","_easing","_halfWidth","_halfHeight","_follow","ax","ay","move","easingFn","_lerpPromise","_lerpResolve","shake","magnitudeX","magnitudeY","zoomOverTime","_zoomPromise","_zoomResolve","cameraStrategy","removeStrategy","clearAllStrategies","_screen","currentRes","loadingComplete","res","updateTransform","runStrategies","newZoom","zoomEasing","lerpPoint","moveEasing","_isDoneShaking","newCanvasWidth","newCanvasHeight","cameraPos","TriggerEvents","ExitTrigger","EnterTrigger","triggerDefaults","Trigger","opts","_dispatchAction","_target","SystemType","System","_entityAddedOrRemoved","AddedEntity","isAddedSystemEntity","RemovedEntity","isRemoveSystemEntity","EntityManager","_world","entities","_entityIndex","_entitiesToRemove","updateEntities","removeEntity","findEntitiesForRemoval","queryManager","addEntity","idOrEntity","currFrame","actors","killed","processEntityRemovals","processComponentRemovals","getById","getByName","buildTypeKey","localeCompare","Query","_key","_entities","T","getEntities","matches","typesOrEntity","contain","QueryManager","_queries","_addQuery","entityManager","maybeRemoveQuery","queryType","createQuery","maybeExistingQuery","getQuery","SystemManager","systems","initialized","systemType","addSystem","system","removeSystem","updateSystems","preupdate","Scene","postupdate","systemManager","Update","entityOrSystem","clearEntities","clearSystems","EulerIntegrator","integrate","totalAcc","_ACC","_VEL","_POS","_VEL_ACC","_SCALE_FACTOR","_SCALE","MotionSystem","optionalBody","ArcadeSolver","directionMap","distanceMap","solve","preSolve","solvePosition","solveVelocity","postSolve","opposite","velAdj","ContactConstraintPoint","normalImpulse","tangentImpulse","normalMass","tangentMass","aToContact","bToContact","originalVelocityAndRestitution","aToContactNormal","bToContactNormal","aToContactTangent","bToContactTangent","getRelativeVelocity","velA","RealisticSolver","lastFrameContacts","idToContactConstraint","getContactConstraints","finishedContactIds","contactPoints","pointIndex","restitution","relativeVelocity","constraints","maxCorrection","steeringForce","impulseForce","impulseDelta","maxFriction","newImpulse","normalVelocity","CollisionSystem","_realisticSolver","_arcadeSolver","_lastFrameContacts","_currentFrameContacts","_processor","collisionProcessor","_trackCollider","_untrackCollider","colliderComponent","colliderComp","compositeColliders","getSolver","compositeId","substring","runContactStartEnd","AnimationDirection","AnimationStrategy","AnimationEvents","Frame","Loop","Ended","Animation","frames","frameDuration","timeScale","_idempotencyToken","_firstTick","_currentFrame","_timeLeftInFrame","_pingPongDirection","_done","_playing","_reversed","totalDuration","goToFrame","maybeFrame","currentFrame","fromSpriteSheet","frameIndices","durationPerFrameMs","invalidIndices","fromSpriteSheetCoordinates","frameCoordinates","defaultDuration","coord","currentFrameIndex","Backward","Forward","canFinish","End","Freeze","frameNumber","frameIndex","_nextFrame","PingPong","elapsedMilliseconds","GraphicsGroup","members","_updateDimensions","_isAnimationOrGroup","member","maybeAnimation","Configurable","base","assign","props","EmitterType","ParticleTransform","ParticleImpl","emitterOrConfig","life","beginColor","endColor","velocity","acceleration","startSize","endSize","particleRotationalVelocity","currentRotation","focusAccel","fadeFlag","_rRate","_gRate","_bRate","_aRate","_currentColor","particleSize","particleSprite","sizeRate","elapsedMultiplier","isOffscreen","ParticleEmitter","particleTransform","Global","tmpColor","removeParticle","accel","Particle","_sprite","_particlesToEmit","numParticles","isEmitting","particles","deadParticles","minVel","maxVel","minAngle","maxAngle","emitRate","particleLife","minSize","maxSize","emitterType","randomRotation","particle","emitParticles","particleCount","_createParticle","world","clearParticles","ranX","ranY","GraphicsSystem","Draw","_sortedTransforms","_zHasChanged","_zIndexUpdate","sortedTransforms","_graphicsContext","entityAddedOrRemoved","parallax","_applyTransform","particleOpacity","_drawGraphicsComponent","oldFlipHorizontal","oldFlipVertical","isDebug","showBounds","boundsColor","ancestors","ancestor","interpolatedPos","interpolatedScale","interpolatedRotation","fixedUpdateFps","blend","currentFrameLagMs","DebugSystem","_collisionSystem","filterSettings","entitySettings","txSettings","motionSettings","colliderSettings","physicsSettings","graphicsSettings","debugDraw","bodySettings","cameraSettings","useFilter","ids","nameQuery","cursor","_pushCameraTransform","showAll","showPosition","positionColor","showPositionLabel","showZIndex","showId","showName","showRotation","rotationColor","showScale","scaleColor","showCollisionGroup","showCollisionType","showMass","showMotion","showSleeping","showVelocity","velocityColor","showAcceleration","accelerationColor","showGeometry","geometryColor","showOwner","_popCameraTransform","showBroadphaseSpacePartitionDebug","showCollisionContacts","showCollisionNormals","collisionContactColor","collisionNormalColor","showFocus","focusColor","showZoom","overrideUseColliderShape","overrideUseGraphicsBounds","lastFrameEntityToPointers","currentFrameEntityToPointers","_sortedEntities","_receiver","pointers","entityCurrentlyUnderPointer","pointerId","entityWasUnderPointer","entered","addPointerToEntity","_processPointerToEntity","_dispatchEvents","currentFramePointerCoords","screenPos","graphicBounds","_processDownAndEmit","lastDownPerPointer","currentFrameDown","isDragStart","_processUpAndEmit","lastUpPerPointer","currentFrameUp","isDragEnd","_processMoveAndEmit","lastMovePerPointer","currentFrameMove","isDragging","_processEnterLeaveAndEmit","lastUpDownMoveEvents","_processCancelAndEmit","currentFrameCancel","_processWheelAndEmit","currentFrameWheel","lastFrameEntities","currentFrameEntities","entitiesWithEvents","ActionsSystem","IsometricEntityComponent","elevation","IsometricEntitySystem","iso","OffscreenSystem","_worldBounds","entityOffscreen","_isOffscreen","transformedBounds","PhysicsWorld","SceneEvents","Activate","Deactivate","PreDebugDraw","PostDebugDraw","triggers","tileMaps","timers","_timers","_cancelQueue","onActivate","onDeactivate","_initializeChildren","_activate","_deactivate","_predraw","_postdraw","removeTimer","timer","_collectActorStats","addTimer","transfer","isTimerActive","isCurrentScene","screenElements","_ui","ui","alive","ColorBlindnessMode","ScreenShader","ColorBlindnessPostProcessor","_colorBlindnessMode","simulate","_simulate","colorBlindnessMode","colorBlindMode","Protanope","Deuteranope","Tritanope","ColorBlindFlags","_colorBlindPostProcessor","correct","colorBlindness","FrameStats","prevFrame","useTestClock","wasRunning","testClock","toTestClock","useStandardClock","currentClock","standardClock","toStandardClock","_id","_fps","_actorStats","remaining","total","_durationStats","_physicsStats","PhysicsStats","_graphicsStats","drawCalls","drawnImages","otherStats","fps","fs","_collisions","_contacts","_fastBodies","_fastBodyCollisions","_broadphase","_narrowphase","ps","BrowserComponent","_nativeHandlers","_decorate","BrowserEvents","_windowGlobal","_documentGlobal","_windowComponent","_documentComponent","GlobalCoordinates","fromPagePosition","yOrEngine","engineOrUndefined","pageX","pageY","pagePos","coordinates","pointerType","nativeEvent","screenX","screenY","deltaZ","deltaMode","PointerAbstraction","lastPagePos","lastScreenPos","lastWorldPos","_onPointerMove","_onPointerDown","primary","_activeNativePointerIdsToNormalized","lastFramePointerCoords","currentFramePointerDown","lastFramePointerDown","_pointers","_boundHandle","_handle","_boundWheel","_handleWheel","recreate","eventReceiver","isDown","wasDown","native","touchAction","wheelOptions","passive","pageScrollPreventionMode","ScrollPreventionMode","onmousewheel","grabFocus","detach","_normalizePointerId","nativePointerId","preventDefault","eventCoords","TouchEvent","Unknown","Touch","changedTouches","touch","_nativeButtonToPointerButton","Mouse","isPointerEvent","_stringToPointerType","ScrollWheelNormalizationFactor","wheelDeltaX","wheelDeltaY","wheelDelta","detail","Line","Page","we","page","clientX","clientY","MouseEvent","pointerSystem","transformEntities","NoButton","Middle","Pen","FpsSampler","_samplePeriod","_currentFrameTime","_frames","_previousSampleTime","_beginFrameTime","initialFps","samplePeriod","_nowFn","nowFn","instant","Clock","_onFatalException","_maxFps","_lastTime","_elapsed","_scheduledCbs","_totalElapsed","maxFps","onFatalException","fpsSampler","TestClock","defaultUpdateMs","StandardClock","setFatalExceptionHandler","cb","timeoutMs","scheduledTime","_runScheduledCbs","overrideUpdateMs","fpsInterval","leftover","mainloop","_requestId","_currentTime","_updateMs","step","run","numberOfSteps","Util_Toaster","Toaster","_toasterCss","_container","_createFragment","toastMessage","innerText","toast","linkTarget","linkName","className","messageFragments","link","href","finalMessage","dismissBtn","keydownHandler","first","firstChild","insertBefore","InputMapper","inputs","_handlers","command","inputHandler","commandHandler","EngineEvents","FallbackGraphicsContext","Visible","Hidden","Start","PreFrame","PostFrame","Engine","isFullscreen","_isDebug","shouldSnapToPixel","scenes","_suppressPlayButton","enableCanvasTransparency","_toaster","_timescale","_deferredGoTo","_originalOptions","_performanceThresholdTriggered","_fpsSamples","_loadingComplete","_isReady","_isReadyPromise","_isReadyResolve","currentFrameElapsedMs","_lagMs","_screenShotRequests","_DEFAULT_ENGINE_OPTIONS","detector","suppressMinimumBrowserFeatureDetection","_compatible","testMessage","canvasElementId","suppressConsoleBootMessage","EX_VERSION","_originalDisplayMode","suppressHiDPIScaling","_mainloop","_loader","rootScene","addScene","___EXCALIBUR_DEVTOOL","_monitorPerformanceThresholdAndTriggerFallback","allow","configurePerformanceCanvas2DFallback","showPlayerMessage","numberOfFrames","useCanvas2DFallback","newCanvas","cloneNode","parentNode","replaceChild","pointerTarget","pointerScope","Document","timescale","removeScene","goToScene","previousScene","nextScene","scrollPreventionMode","keyboard","inputMapper","visibilityState","_overrideInitialize","deferredScene","_update","_draw","_checkForScreenShots","toggle","toggleDebug","isReady","loader","frameId","beforeUpdate","fixedTimestepMs","afterUpdate","afterDraw","screenshot","preserveHiDPIResolution","finalWidth","finalHeight","raw","EventDispatcher","_wiredEventDispatchers","_deferedHandlerRemovals","_processDeferredHandlerRemovals","eventHandler","_removeHandler","eventHandlers","metaHandler","wire","eventDispatcher","unwire","Label","newFont","spriteFont","sf","getTextWidth","IsometricTile","_gfx","_recalculateBounds","_tileBounds","graphicsOffset","tileToWorld","_isometricEntityComponent","halfTileWidth","halfTileHeight","xPos","yPos","totalWidth","totalHeight","IsometricMap","updateColliders","worldToTile","worldCoordinate","tileCoordinate","tileCoord","_getMaxZIndex","maxZ","NEGATIVE_INFINITY","currentZ","ActionSequence","actionBuilder","_sequenceBuilder","_sequenceContext","ParallelActions","parallelActions","every","CollisionGroupManager","_CURRENT_GROUP","_MAX_GROUPS","_GROUPS","_CURRENT_BIT","groups","groupByName","_STARTING_BIT","has_initialize","hasOnInitialize","has_preupdate","hasOnPreUpdate","has_postupdate","hasOnPostUpdate","hasPreDraw","hasPostDraw","Gif","_stream","_gif","_animation","_transparentColor","Stream","ParseGif","images","toSpriteSheet","toAnimation","readCheckBytes","checkBytes","bitsToNum","ba","byteToBitArr","bite","dataArray","readByte","byteLength","readBytes","bytes","read","readUnsigned","Uint8Array","stream","_st","_handler","globalColorTable","parseColorTable","ct","readSubBlocks","parseHeader","hdr","sig","ver","colorRes","globalColorTableSize","gctFlag","sorted","bgColor","pixelAspectRatio","bits","parseExt","block","parseGCExt","reserved","disposalMethod","userInput","transparencyGiven","delayTime","transparencyIndex","terminator","gce","parseComExt","comment","com","parsePTExt","ptHeader","ptData","pte","parseAppExt","identifier","authCode","unknown","iterations","app","NETSCAPE","parseNetscapeExt","appData","parseUnknownAppExt","parseUnknownExt","label","extType","parseImg","img","leftPos","topPos","lctFlag","interlaced","lctSize","lct","lzwMinCodeSize","lzwData","pixels","minCodeSize","readCode","charCodeAt","output","clearCode","eoiCode","codeSize","dict","last","lzwDecode","newPixels","cpRow","toRow","fromRow","fromPixels","offsets","steps","pass","deinterlace","arrayToImage","parseBlock","sentinel","eof","frame","AsyncWaitQueue","enqueue","dequeue","Semaphore","_count","_waitQueue","waiting","enter","exit","__webpack_exports__ActionContext","__webpack_exports__ActionQueue","__webpack_exports__ActionSequence","__webpack_exports__ActionsComponent","__webpack_exports__ActionsSystem","__webpack_exports__ActivateEvent","__webpack_exports__Actor","__webpack_exports__AddedComponent","__webpack_exports__AddedEntity","__webpack_exports__AffineMatrix","__webpack_exports__Animation","__webpack_exports__AnimationDirection","__webpack_exports__AnimationEvents","__webpack_exports__AnimationStrategy","__webpack_exports__ArcadeSolver","__webpack_exports__AudioContextFactory","__webpack_exports__Axes","__webpack_exports__Axis","__webpack_exports__BaseAlign","__webpack_exports__Blink","__webpack_exports__BodyComponent","__webpack_exports__BoundingBox","__webpack_exports__BroadphaseStrategy","__webpack_exports__BrowserComponent","__webpack_exports__BrowserEvents","__webpack_exports__Buttons","__webpack_exports__Camera","__webpack_exports__CameraEvents","__webpack_exports__Canvas","__webpack_exports__Circle","__webpack_exports__CircleCollider","__webpack_exports__Clock","__webpack_exports__ClosestLine","__webpack_exports__ClosestLineJumpTable","__webpack_exports__Collider","__webpack_exports__ColliderComponent","__webpack_exports__CollisionContact","__webpack_exports__CollisionEndEvent","__webpack_exports__CollisionGroup","__webpack_exports__CollisionGroupManager","__webpack_exports__CollisionJumpTable","__webpack_exports__CollisionPostSolveEvent","__webpack_exports__CollisionPreSolveEvent","__webpack_exports__CollisionResolutionStrategy","__webpack_exports__CollisionStartEvent","__webpack_exports__CollisionSystem","__webpack_exports__CollisionType","__webpack_exports__Color","__webpack_exports__ColorBlindFlags","__webpack_exports__ColorBlindnessMode","__webpack_exports__ColorBlindnessPostProcessor","__webpack_exports__Component","__webpack_exports__CompositeCollider","__webpack_exports__Configurable","__webpack_exports__ConsoleAppender","__webpack_exports__ContactConstraintPoint","__webpack_exports__ContactEndEvent","__webpack_exports__ContactStartEvent","__webpack_exports__CoordPlane","__webpack_exports__DeactivateEvent","__webpack_exports__Debug","__webpack_exports__DebugGraphicsComponent","__webpack_exports__DebugSystem","__webpack_exports__DebugText","__webpack_exports__DegreeOfFreedom","__webpack_exports__Delay","__webpack_exports__Detector","__webpack_exports__Die","__webpack_exports__Direction","__webpack_exports__DisplayMode","__webpack_exports__DynamicTree","__webpack_exports__DynamicTreeCollisionProcessor","__webpack_exports__EX_VERSION","__webpack_exports__EaseBy","__webpack_exports__EaseTo","__webpack_exports__EasingFunctions","__webpack_exports__EdgeCollider","__webpack_exports__ElasticToActorStrategy","__webpack_exports__EmitterType","__webpack_exports__Engine","__webpack_exports__EngineEvents","__webpack_exports__EnterTriggerEvent","__webpack_exports__EnterViewPortEvent","__webpack_exports__Entity","__webpack_exports__EntityEvents","__webpack_exports__EntityManager","__webpack_exports__EventDispatcher","__webpack_exports__EventEmitter","__webpack_exports__EventTypes","__webpack_exports__Events","__webpack_exports__ExResponse","__webpack_exports__ExcaliburGraphicsContext2DCanvas","__webpack_exports__ExcaliburGraphicsContextWebGL","__webpack_exports__ExitTriggerEvent","__webpack_exports__ExitViewPortEvent","__webpack_exports__Fade","__webpack_exports__Flags","__webpack_exports__Follow","__webpack_exports__Font","__webpack_exports__FontCache","__webpack_exports__FontStyle","__webpack_exports__FontUnit","__webpack_exports__FpsSampler","__webpack_exports__FrameStats","__webpack_exports__Future","__webpack_exports__GameEvent","__webpack_exports__GameStartEvent","__webpack_exports__GameStopEvent","__webpack_exports__Gamepad","__webpack_exports__GamepadAxisEvent","__webpack_exports__GamepadButtonEvent","__webpack_exports__GamepadConnectEvent","__webpack_exports__GamepadDisconnectEvent","__webpack_exports__Gamepads","__webpack_exports__Gif","__webpack_exports__GlobalCoordinates","__webpack_exports__Graphic","__webpack_exports__GraphicsComponent","__webpack_exports__GraphicsGroup","__webpack_exports__GraphicsLayer","__webpack_exports__GraphicsLayers","__webpack_exports__GraphicsSystem","__webpack_exports__HiddenEvent","__webpack_exports__ImageFiltering","__webpack_exports__ImageSource","__webpack_exports__InitializeEvent","__webpack_exports__Input","__webpack_exports__InputMapper","__webpack_exports__Integrator","__webpack_exports__IsometricEntityComponent","__webpack_exports__IsometricEntitySystem","__webpack_exports__IsometricMap","__webpack_exports__IsometricTile","__webpack_exports__KeyEvent","__webpack_exports__Keyboard","__webpack_exports__Keys","__webpack_exports__KillEvent","__webpack_exports__Label","__webpack_exports__LimitCameraBoundsStrategy","__webpack_exports__Line","__webpack_exports__LineSegment","__webpack_exports__Loader","__webpack_exports__LoaderEvents","__webpack_exports__LockCameraToActorAxisStrategy","__webpack_exports__LockCameraToActorStrategy","__webpack_exports__LogLevel","__webpack_exports__Logger","__webpack_exports__Material","__webpack_exports__Matrix","__webpack_exports__MatrixLocations","__webpack_exports__MediaEvent","__webpack_exports__Meet","__webpack_exports__MotionComponent","__webpack_exports__MotionSystem","__webpack_exports__MoveBy","__webpack_exports__MoveTo","__webpack_exports__NativePointerButton","__webpack_exports__NativeSoundEvent","__webpack_exports__NativeSoundProcessedEvent","__webpack_exports__Observable","__webpack_exports__OffscreenSystem","__webpack_exports__Pair","__webpack_exports__ParallaxComponent","__webpack_exports__ParallelActions","__webpack_exports__ParseGif","__webpack_exports__Particle","__webpack_exports__ParticleEmitter","__webpack_exports__ParticleTransform","__webpack_exports__Physics","__webpack_exports__PhysicsStats","__webpack_exports__PhysicsWorld","__webpack_exports__PointerButton","__webpack_exports__PointerComponent","__webpack_exports__PointerEvent","__webpack_exports__PointerEventReceiver","__webpack_exports__PointerScope","__webpack_exports__PointerSystem","__webpack_exports__PointerType","__webpack_exports__Polygon","__webpack_exports__PolygonCollider","__webpack_exports__Pool","__webpack_exports__PostCollisionEvent","__webpack_exports__PostDebugDrawEvent","__webpack_exports__PostDrawEvent","__webpack_exports__PostFrameEvent","__webpack_exports__PostKillEvent","__webpack_exports__PostUpdateEvent","__webpack_exports__PreCollisionEvent","__webpack_exports__PreDebugDrawEvent","__webpack_exports__PreDrawEvent","__webpack_exports__PreFrameEvent","__webpack_exports__PreKillEvent","__webpack_exports__PreUpdateEvent","__webpack_exports__Projection","__webpack_exports__QuadIndexBuffer","__webpack_exports__Query","__webpack_exports__QueryManager","__webpack_exports__RadiusAroundActorStrategy","__webpack_exports__Random","__webpack_exports__Raster","__webpack_exports__Ray","__webpack_exports__RealisticSolver","__webpack_exports__Rectangle","__webpack_exports__RemovedComponent","__webpack_exports__RemovedEntity","__webpack_exports__Repeat","__webpack_exports__RepeatForever","__webpack_exports__Resolution","__webpack_exports__Resource","__webpack_exports__ResourceEvents","__webpack_exports__RotateBy","__webpack_exports__RotateTo","__webpack_exports__RotationType","__webpack_exports__ScaleBy","__webpack_exports__ScaleTo","__webpack_exports__Scene","__webpack_exports__SceneEvents","__webpack_exports__Screen","__webpack_exports__ScreenAppender","__webpack_exports__ScreenElement","__webpack_exports__ScreenShader","__webpack_exports__ScrollPreventionMode","__webpack_exports__Semaphore","__webpack_exports__Shader","__webpack_exports__Shape","__webpack_exports__Side","__webpack_exports__Sound","__webpack_exports__SoundEvents","__webpack_exports__Sprite","__webpack_exports__SpriteFont","__webpack_exports__SpriteSheet","__webpack_exports__StandardClock","__webpack_exports__StateMachine","__webpack_exports__StrategyContainer","__webpack_exports__Stream","__webpack_exports__System","__webpack_exports__SystemManager","__webpack_exports__SystemType","__webpack_exports__TagComponent","__webpack_exports__TestClock","__webpack_exports__Text","__webpack_exports__TextAlign","__webpack_exports__TextureLoader","__webpack_exports__Tile","__webpack_exports__TileMap","__webpack_exports__TileMapEvents","__webpack_exports__Timer","__webpack_exports__Toaster","__webpack_exports__Transform","__webpack_exports__TransformComponent","__webpack_exports__TreeNode","__webpack_exports__Trigger","__webpack_exports__TriggerEvents","__webpack_exports__TwoPI","__webpack_exports__Util","__webpack_exports__Vector","__webpack_exports__VectorView","__webpack_exports__VertexBuffer","__webpack_exports__VertexLayout","__webpack_exports__VisibleEvent","__webpack_exports__WebAudio","__webpack_exports__WebAudioInstance","__webpack_exports__WheelDeltaMode","__webpack_exports__WheelEvent","__webpack_exports__World","__webpack_exports__canonicalizeAngle","__webpack_exports__clamp","__webpack_exports__createId","__webpack_exports__frac","__webpack_exports__hasGraphicsTick","__webpack_exports__hasOnInitialize","__webpack_exports__hasOnPostUpdate","__webpack_exports__hasOnPreUpdate","__webpack_exports__hasPostDraw","__webpack_exports__hasPreDraw","__webpack_exports__has_initialize","__webpack_exports__has_postupdate","__webpack_exports__has_preupdate","__webpack_exports__isAddedComponent","__webpack_exports__isAddedSystemEntity","__webpack_exports__isRemoveSystemEntity","__webpack_exports__isRemovedComponent","__webpack_exports__isScreenElement","__webpack_exports__maxMessages","__webpack_exports__obsolete","__webpack_exports__pixelSnapEpsilon","__webpack_exports__randomInRange","__webpack_exports__randomIntInRange","__webpack_exports__range","__webpack_exports__resetObsoleteCounter","__webpack_exports__sign","__webpack_exports__toDegrees","__webpack_exports__toRadians","__webpack_exports__vec","__webpack_exports__webgl","Baddie","baddieSpriteSheet","__TESTING","onPostCollision","Bot","Resources","gotEm","onGround","jumped","hurt","hurtTime","hurtleft","botSpriteSheet","hurtright","idle","Input","jump","Floor","blockSprite","Level","baddie","baddie2","npc","NPC","otherFloor","botRedSpriteSheet","npcSprite","botFile","botRedFile","baddieFile","blockFile","npcFile","jumpSound","hitSound","gotEmSound","bot","botRed","__webpack_require__","scriptUrl","importScripts","currentScript","scripts","getElementsByTagName"],"sourceRoot":""}